var BK=Object.defineProperty;var FK=(t,n,s)=>n in t?BK(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var Ew=(t,n,s)=>FK(t,typeof n!="symbol"?n+"":n,s);function YR(t,n){for(var s=0;s<n.length;s++){const r=n[s];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const l=Object.getOwnPropertyDescriptor(r,i);l&&Object.defineProperty(t,i,l.get?l:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();var tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ii(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var XR={exports:{}},eb={},QR={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cx=Symbol.for("react.element"),$K=Symbol.for("react.portal"),zK=Symbol.for("react.fragment"),UK=Symbol.for("react.strict_mode"),VK=Symbol.for("react.profiler"),HK=Symbol.for("react.provider"),WK=Symbol.for("react.context"),qK=Symbol.for("react.forward_ref"),GK=Symbol.for("react.suspense"),KK=Symbol.for("react.memo"),YK=Symbol.for("react.lazy"),v5=Symbol.iterator;function XK(t){return t===null||typeof t!="object"?null:(t=v5&&t[v5]||t["@@iterator"],typeof t=="function"?t:null)}var ZR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},JR=Object.assign,e6={};function ph(t,n,s){this.props=t,this.context=n,this.refs=e6,this.updater=s||ZR}ph.prototype.isReactComponent={};ph.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")};ph.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function t6(){}t6.prototype=ph.prototype;function dC(t,n,s){this.props=t,this.context=n,this.refs=e6,this.updater=s||ZR}var uC=dC.prototype=new t6;uC.constructor=dC;JR(uC,ph.prototype);uC.isPureReactComponent=!0;var w5=Array.isArray,n6=Object.prototype.hasOwnProperty,fC={current:null},s6={key:!0,ref:!0,__self:!0,__source:!0};function r6(t,n,s){var r,i={},l=null,o=null;if(n!=null)for(r in n.ref!==void 0&&(o=n.ref),n.key!==void 0&&(l=""+n.key),n)n6.call(n,r)&&!s6.hasOwnProperty(r)&&(i[r]=n[r]);var c=arguments.length-2;if(c===1)i.children=s;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];i.children=d}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)i[r]===void 0&&(i[r]=c[r]);return{$$typeof:cx,type:t,key:l,ref:o,props:i,_owner:fC.current}}function QK(t,n){return{$$typeof:cx,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function hC(t){return typeof t=="object"&&t!==null&&t.$$typeof===cx}function ZK(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return n[s]})}var N5=/\/+/g;function Tw(t,n){return typeof t=="object"&&t!==null&&t.key!=null?ZK(""+t.key):n.toString(36)}function gg(t,n,s,r,i){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case cx:case $K:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Tw(o,0):r,w5(i)?(s="",t!=null&&(s=t.replace(N5,"$&/")+"/"),gg(i,n,s,"",function(u){return u})):i!=null&&(hC(i)&&(i=QK(i,s+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(N5,"$&/")+"/")+t)),n.push(i)),1;if(o=0,r=r===""?".":r+":",w5(t))for(var c=0;c<t.length;c++){l=t[c];var d=r+Tw(l,c);o+=gg(l,n,s,d,i)}else if(d=XK(t),typeof d=="function")for(t=d.call(t),c=0;!(l=t.next()).done;)l=l.value,d=r+Tw(l,c++),o+=gg(l,n,s,d,i);else if(l==="object")throw n=String(t),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return o}function e0(t,n,s){if(t==null)return t;var r=[],i=0;return gg(t,r,"","",function(l){return n.call(s,l,i++)}),r}function JK(t){if(t._status===-1){var n=t._result;n=n(),n.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=n)}if(t._status===1)return t._result.default;throw t._result}var ia={current:null},yg={transition:null},eY={ReactCurrentDispatcher:ia,ReactCurrentBatchConfig:yg,ReactCurrentOwner:fC};function a6(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:e0,forEach:function(t,n,s){e0(t,function(){n.apply(this,arguments)},s)},count:function(t){var n=0;return e0(t,function(){n++}),n},toArray:function(t){return e0(t,function(n){return n})||[]},only:function(t){if(!hC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Zt.Component=ph;Zt.Fragment=zK;Zt.Profiler=VK;Zt.PureComponent=dC;Zt.StrictMode=UK;Zt.Suspense=GK;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eY;Zt.act=a6;Zt.cloneElement=function(t,n,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=JR({},t.props),i=t.key,l=t.ref,o=t._owner;if(n!=null){if(n.ref!==void 0&&(l=n.ref,o=fC.current),n.key!==void 0&&(i=""+n.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in n)n6.call(n,d)&&!s6.hasOwnProperty(d)&&(r[d]=n[d]===void 0&&c!==void 0?c[d]:n[d])}var d=arguments.length-2;if(d===1)r.children=s;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:cx,type:t.type,key:i,ref:l,props:r,_owner:o}};Zt.createContext=function(t){return t={$$typeof:WK,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:HK,_context:t},t.Consumer=t};Zt.createElement=r6;Zt.createFactory=function(t){var n=r6.bind(null,t);return n.type=t,n};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(t){return{$$typeof:qK,render:t}};Zt.isValidElement=hC;Zt.lazy=function(t){return{$$typeof:YK,_payload:{_status:-1,_result:t},_init:JK}};Zt.memo=function(t,n){return{$$typeof:KK,type:t,compare:n===void 0?null:n}};Zt.startTransition=function(t){var n=yg.transition;yg.transition={};try{t()}finally{yg.transition=n}};Zt.unstable_act=a6;Zt.useCallback=function(t,n){return ia.current.useCallback(t,n)};Zt.useContext=function(t){return ia.current.useContext(t)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(t){return ia.current.useDeferredValue(t)};Zt.useEffect=function(t,n){return ia.current.useEffect(t,n)};Zt.useId=function(){return ia.current.useId()};Zt.useImperativeHandle=function(t,n,s){return ia.current.useImperativeHandle(t,n,s)};Zt.useInsertionEffect=function(t,n){return ia.current.useInsertionEffect(t,n)};Zt.useLayoutEffect=function(t,n){return ia.current.useLayoutEffect(t,n)};Zt.useMemo=function(t,n){return ia.current.useMemo(t,n)};Zt.useReducer=function(t,n,s){return ia.current.useReducer(t,n,s)};Zt.useRef=function(t){return ia.current.useRef(t)};Zt.useState=function(t){return ia.current.useState(t)};Zt.useSyncExternalStore=function(t,n,s){return ia.current.useSyncExternalStore(t,n,s)};Zt.useTransition=function(){return ia.current.useTransition()};Zt.version="18.3.1";QR.exports=Zt;var y=QR.exports;const Ge=Ii(y),tb=YR({__proto__:null,default:Ge},[y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tY=y,nY=Symbol.for("react.element"),sY=Symbol.for("react.fragment"),rY=Object.prototype.hasOwnProperty,aY=tY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iY={key:!0,ref:!0,__self:!0,__source:!0};function i6(t,n,s){var r,i={},l=null,o=null;s!==void 0&&(l=""+s),n.key!==void 0&&(l=""+n.key),n.ref!==void 0&&(o=n.ref);for(r in n)rY.call(n,r)&&!iY.hasOwnProperty(r)&&(i[r]=n[r]);if(t&&t.defaultProps)for(r in n=t.defaultProps,n)i[r]===void 0&&(i[r]=n[r]);return{$$typeof:nY,type:t,key:l,ref:o,props:i,_owner:aY.current}}eb.Fragment=sY;eb.jsx=i6;eb.jsxs=i6;XR.exports=eb;var a=XR.exports,ej={},l6={exports:{}},Ja={},o6={exports:{}},c6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function n(G,J){var ee=G.length;G.push(J);e:for(;0<ee;){var ye=ee-1>>>1,ie=G[ye];if(0<i(ie,J))G[ye]=J,G[ee]=ie,ee=ye;else break e}}function s(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var J=G[0],ee=G.pop();if(ee!==J){G[0]=ee;e:for(var ye=0,ie=G.length,he=ie>>>1;ye<he;){var be=2*(ye+1)-1,we=G[be],Z=be+1,ce=G[Z];if(0>i(we,ee))Z<ie&&0>i(ce,we)?(G[ye]=ce,G[Z]=ee,ye=Z):(G[ye]=we,G[be]=ee,ye=be);else if(Z<ie&&0>i(ce,ee))G[ye]=ce,G[Z]=ee,ye=Z;else break e}}return J}function i(G,J){var ee=G.sortIndex-J.sortIndex;return ee!==0?ee:G.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],u=[],h=1,m=null,x=3,b=!1,w=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(G){for(var J=s(u);J!==null;){if(J.callback===null)r(u);else if(J.startTime<=G)r(u),J.sortIndex=J.expirationTime,n(d,J);else break;J=s(u)}}function T(G){if(j=!1,k(G),!w)if(s(d)!==null)w=!0,H(I);else{var J=s(u);J!==null&&Y(T,J.startTime-G)}}function I(G,J){w=!1,j&&(j=!1,C(R),R=-1),b=!0;var ee=x;try{for(k(J),m=s(d);m!==null&&(!(m.expirationTime>J)||G&&!$());){var ye=m.callback;if(typeof ye=="function"){m.callback=null,x=m.priorityLevel;var ie=ye(m.expirationTime<=J);J=t.unstable_now(),typeof ie=="function"?m.callback=ie:m===s(d)&&r(d),k(J)}else r(d);m=s(d)}if(m!==null)var he=!0;else{var be=s(u);be!==null&&Y(T,be.startTime-J),he=!1}return he}finally{m=null,x=ee,b=!1}}var D=!1,O=null,R=-1,P=5,L=-1;function $(){return!(t.unstable_now()-L<P)}function B(){if(O!==null){var G=t.unstable_now();L=G;var J=!0;try{J=O(!0,G)}finally{J?V():(D=!1,O=null)}}else D=!1}var V;if(typeof A=="function")V=function(){A(B)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,z=K.port2;K.port1.onmessage=B,V=function(){z.postMessage(null)}}else V=function(){S(B,0)};function H(G){O=G,D||(D=!0,V())}function Y(G,J){R=S(function(){G(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){w||b||(w=!0,H(I))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return s(d)},t.unstable_next=function(G){switch(x){case 1:case 2:case 3:var J=3;break;default:J=x}var ee=x;x=J;try{return G()}finally{x=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ee=x;x=G;try{return J()}finally{x=ee}},t.unstable_scheduleCallback=function(G,J,ee){var ye=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ye+ee:ye):ee=ye,G){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=ee+ie,G={id:h++,callback:J,priorityLevel:G,startTime:ee,expirationTime:ie,sortIndex:-1},ee>ye?(G.sortIndex=ee,n(u,G),s(d)===null&&G===s(u)&&(j?(C(R),R=-1):j=!0,Y(T,ee-ye))):(G.sortIndex=ie,n(d,G),w||b||(w=!0,H(I))),G},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(G){var J=x;return function(){var ee=x;x=J;try{return G.apply(this,arguments)}finally{x=ee}}}})(c6);o6.exports=c6;var lY=o6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oY=y,Ka=lY;function He(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d6=new Set,rp={};function ku(t,n){zf(t,n),zf(t+"Capture",n)}function zf(t,n){for(rp[t]=n,t=0;t<n.length;t++)d6.add(n[t])}var yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tj=Object.prototype.hasOwnProperty,cY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j5={},S5={};function dY(t){return tj.call(S5,t)?!0:tj.call(j5,t)?!1:cY.test(t)?S5[t]=!0:(j5[t]=!0,!1)}function uY(t,n,s,r){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return r?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fY(t,n,s,r){if(n===null||typeof n>"u"||uY(t,n,s,r))return!0;if(r)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function la(t,n,s,r,i,l,o){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=s,this.propertyName=t,this.type=n,this.sanitizeURL=l,this.removeEmptyString=o}var Er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Er[t]=new la(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];Er[n]=new la(n,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Er[t]=new la(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Er[t]=new la(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Er[t]=new la(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Er[t]=new la(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Er[t]=new la(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Er[t]=new la(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Er[t]=new la(t,5,!1,t.toLowerCase(),null,!1,!1)});var mC=/[\-:]([a-z])/g;function pC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(mC,pC);Er[n]=new la(n,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(mC,pC);Er[n]=new la(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(mC,pC);Er[n]=new la(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Er[t]=new la(t,1,!1,t.toLowerCase(),null,!1,!1)});Er.xlinkHref=new la("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Er[t]=new la(t,1,!1,t.toLowerCase(),null,!0,!0)});function xC(t,n,s,r){var i=Er.hasOwnProperty(n)?Er[n]:null;(i!==null?i.type!==0:r||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(fY(n,s,i,r)&&(s=null),r||i===null?dY(n)&&(s===null?t.removeAttribute(n):t.setAttribute(n,""+s)):i.mustUseProperty?t[i.propertyName]=s===null?i.type===3?!1:"":s:(n=i.attributeName,r=i.attributeNamespace,s===null?t.removeAttribute(n):(i=i.type,s=i===3||i===4&&s===!0?"":""+s,r?t.setAttributeNS(r,n,s):t.setAttribute(n,s))))}var Do=oY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,t0=Symbol.for("react.element"),af=Symbol.for("react.portal"),lf=Symbol.for("react.fragment"),gC=Symbol.for("react.strict_mode"),nj=Symbol.for("react.profiler"),u6=Symbol.for("react.provider"),f6=Symbol.for("react.context"),yC=Symbol.for("react.forward_ref"),sj=Symbol.for("react.suspense"),rj=Symbol.for("react.suspense_list"),bC=Symbol.for("react.memo"),ac=Symbol.for("react.lazy"),h6=Symbol.for("react.offscreen"),_5=Symbol.iterator;function nm(t){return t===null||typeof t!="object"?null:(t=_5&&t[_5]||t["@@iterator"],typeof t=="function"?t:null)}var as=Object.assign,Iw;function Am(t){if(Iw===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);Iw=n&&n[1]||""}return`
`+Iw+t}var Pw=!1;function Mw(t,n){if(!t||Pw)return"";Pw=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(u){var r=u}Reflect.construct(t,[],n)}else{try{n.call()}catch(u){r=u}t.call(n.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),l=r.stack.split(`
`),o=i.length-1,c=l.length-1;1<=o&&0<=c&&i[o]!==l[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==l[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==l[c]){var d=`
`+i[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=c);break}}}finally{Pw=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?Am(t):""}function hY(t){switch(t.tag){case 5:return Am(t.type);case 16:return Am("Lazy");case 13:return Am("Suspense");case 19:return Am("SuspenseList");case 0:case 2:case 15:return t=Mw(t.type,!1),t;case 11:return t=Mw(t.type.render,!1),t;case 1:return t=Mw(t.type,!0),t;default:return""}}function aj(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case lf:return"Fragment";case af:return"Portal";case nj:return"Profiler";case gC:return"StrictMode";case sj:return"Suspense";case rj:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case f6:return(t.displayName||"Context")+".Consumer";case u6:return(t._context.displayName||"Context")+".Provider";case yC:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bC:return n=t.displayName||null,n!==null?n:aj(t.type)||"Memo";case ac:n=t._payload,t=t._init;try{return aj(t(n))}catch{}}return null}function mY(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return aj(n);case 8:return n===gC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Oc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function m6(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function pY(t){var n=m6(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),r=""+t[n];if(!t.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,l=s.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,l.call(this,o)}}),Object.defineProperty(t,n,{enumerable:s.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function n0(t){t._valueTracker||(t._valueTracker=pY(t))}function p6(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var s=n.getValue(),r="";return t&&(r=m6(t)?t.checked?"true":"false":t.value),t=r,t!==s?(n.setValue(t),!0):!1}function s1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ij(t,n){var s=n.checked;return as({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function C5(t,n){var s=n.defaultValue==null?"":n.defaultValue,r=n.checked!=null?n.checked:n.defaultChecked;s=Oc(n.value!=null?n.value:s),t._wrapperState={initialChecked:r,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function x6(t,n){n=n.checked,n!=null&&xC(t,"checked",n,!1)}function lj(t,n){x6(t,n);var s=Oc(n.value),r=n.type;if(s!=null)r==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?oj(t,n.type,s):n.hasOwnProperty("defaultValue")&&oj(t,n.type,Oc(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function A5(t,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var r=n.type;if(!(r!=="submit"&&r!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,s||n===t.value||(t.value=n),t.defaultValue=n}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function oj(t,n,s){(n!=="number"||s1(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var km=Array.isArray;function kf(t,n,s,r){if(t=t.options,n){n={};for(var i=0;i<s.length;i++)n["$"+s[i]]=!0;for(s=0;s<t.length;s++)i=n.hasOwnProperty("$"+t[s].value),t[s].selected!==i&&(t[s].selected=i),i&&r&&(t[s].defaultSelected=!0)}else{for(s=""+Oc(s),n=null,i=0;i<t.length;i++){if(t[i].value===s){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}n!==null||t[i].disabled||(n=t[i])}n!==null&&(n.selected=!0)}}function cj(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(He(91));return as({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function k5(t,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(He(92));if(km(s)){if(1<s.length)throw Error(He(93));s=s[0]}n=s}n==null&&(n=""),s=n}t._wrapperState={initialValue:Oc(s)}}function g6(t,n){var s=Oc(n.value),r=Oc(n.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),n.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),r!=null&&(t.defaultValue=""+r)}function E5(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function y6(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dj(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?y6(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var s0,b6=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,r,i){MSApp.execUnsafeLocalFunction(function(){return t(n,s,r,i)})}:t}(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(s0=s0||document.createElement("div"),s0.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=s0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function ap(t,n){if(n){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=n;return}}t.textContent=n}var Bm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xY=["Webkit","ms","Moz","O"];Object.keys(Bm).forEach(function(t){xY.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),Bm[n]=Bm[t]})});function v6(t,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||Bm.hasOwnProperty(t)&&Bm[t]?(""+n).trim():n+"px"}function w6(t,n){t=t.style;for(var s in n)if(n.hasOwnProperty(s)){var r=s.indexOf("--")===0,i=v6(s,n[s],r);s==="float"&&(s="cssFloat"),r?t.setProperty(s,i):t[s]=i}}var gY=as({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uj(t,n){if(n){if(gY[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(He(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(He(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(He(61))}if(n.style!=null&&typeof n.style!="object")throw Error(He(62))}}function fj(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hj=null;function vC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mj=null,Ef=null,Tf=null;function T5(t){if(t=fx(t)){if(typeof mj!="function")throw Error(He(280));var n=t.stateNode;n&&(n=ib(n),mj(t.stateNode,t.type,n))}}function N6(t){Ef?Tf?Tf.push(t):Tf=[t]:Ef=t}function j6(){if(Ef){var t=Ef,n=Tf;if(Tf=Ef=null,T5(t),n)for(t=0;t<n.length;t++)T5(n[t])}}function S6(t,n){return t(n)}function _6(){}var Ow=!1;function C6(t,n,s){if(Ow)return t(n,s);Ow=!0;try{return S6(t,n,s)}finally{Ow=!1,(Ef!==null||Tf!==null)&&(_6(),j6())}}function ip(t,n){var s=t.stateNode;if(s===null)return null;var r=ib(s);if(r===null)return null;s=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(He(231,n,typeof s));return s}var pj=!1;if(yo)try{var sm={};Object.defineProperty(sm,"passive",{get:function(){pj=!0}}),window.addEventListener("test",sm,sm),window.removeEventListener("test",sm,sm)}catch{pj=!1}function yY(t,n,s,r,i,l,o,c,d){var u=Array.prototype.slice.call(arguments,3);try{n.apply(s,u)}catch(h){this.onError(h)}}var Fm=!1,r1=null,a1=!1,xj=null,bY={onError:function(t){Fm=!0,r1=t}};function vY(t,n,s,r,i,l,o,c,d){Fm=!1,r1=null,yY.apply(bY,arguments)}function wY(t,n,s,r,i,l,o,c,d){if(vY.apply(this,arguments),Fm){if(Fm){var u=r1;Fm=!1,r1=null}else throw Error(He(198));a1||(a1=!0,xj=u)}}function Eu(t){var n=t,s=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,n.flags&4098&&(s=n.return),t=n.return;while(t)}return n.tag===3?s:null}function A6(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function I5(t){if(Eu(t)!==t)throw Error(He(188))}function NY(t){var n=t.alternate;if(!n){if(n=Eu(t),n===null)throw Error(He(188));return n!==t?null:t}for(var s=t,r=n;;){var i=s.return;if(i===null)break;var l=i.alternate;if(l===null){if(r=i.return,r!==null){s=r;continue}break}if(i.child===l.child){for(l=i.child;l;){if(l===s)return I5(i),t;if(l===r)return I5(i),n;l=l.sibling}throw Error(He(188))}if(s.return!==r.return)s=i,r=l;else{for(var o=!1,c=i.child;c;){if(c===s){o=!0,s=i,r=l;break}if(c===r){o=!0,r=i,s=l;break}c=c.sibling}if(!o){for(c=l.child;c;){if(c===s){o=!0,s=l,r=i;break}if(c===r){o=!0,r=l,s=i;break}c=c.sibling}if(!o)throw Error(He(189))}}if(s.alternate!==r)throw Error(He(190))}if(s.tag!==3)throw Error(He(188));return s.stateNode.current===s?t:n}function k6(t){return t=NY(t),t!==null?E6(t):null}function E6(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=E6(t);if(n!==null)return n;t=t.sibling}return null}var T6=Ka.unstable_scheduleCallback,P5=Ka.unstable_cancelCallback,jY=Ka.unstable_shouldYield,SY=Ka.unstable_requestPaint,vs=Ka.unstable_now,_Y=Ka.unstable_getCurrentPriorityLevel,wC=Ka.unstable_ImmediatePriority,I6=Ka.unstable_UserBlockingPriority,i1=Ka.unstable_NormalPriority,CY=Ka.unstable_LowPriority,P6=Ka.unstable_IdlePriority,nb=null,El=null;function AY(t){if(El&&typeof El.onCommitFiberRoot=="function")try{El.onCommitFiberRoot(nb,t,void 0,(t.current.flags&128)===128)}catch{}}var Yi=Math.clz32?Math.clz32:TY,kY=Math.log,EY=Math.LN2;function TY(t){return t>>>=0,t===0?32:31-(kY(t)/EY|0)|0}var r0=64,a0=4194304;function Em(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function l1(t,n){var s=t.pendingLanes;if(s===0)return 0;var r=0,i=t.suspendedLanes,l=t.pingedLanes,o=s&268435455;if(o!==0){var c=o&~i;c!==0?r=Em(c):(l&=o,l!==0&&(r=Em(l)))}else o=s&~i,o!==0?r=Em(o):l!==0&&(r=Em(l));if(r===0)return 0;if(n!==0&&n!==r&&!(n&i)&&(i=r&-r,l=n&-n,i>=l||i===16&&(l&4194240)!==0))return n;if(r&4&&(r|=s&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=r;0<n;)s=31-Yi(n),i=1<<s,r|=t[s],n&=~i;return r}function IY(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PY(t,n){for(var s=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,l=t.pendingLanes;0<l;){var o=31-Yi(l),c=1<<o,d=i[o];d===-1?(!(c&s)||c&r)&&(i[o]=IY(c,n)):d<=n&&(t.expiredLanes|=c),l&=~c}}function gj(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function M6(){var t=r0;return r0<<=1,!(r0&4194240)&&(r0=64),t}function Dw(t){for(var n=[],s=0;31>s;s++)n.push(t);return n}function dx(t,n,s){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-Yi(n),t[n]=s}function MY(t,n){var s=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<s;){var i=31-Yi(s),l=1<<i;n[i]=0,r[i]=-1,t[i]=-1,s&=~l}}function NC(t,n){var s=t.entangledLanes|=n;for(t=t.entanglements;s;){var r=31-Yi(s),i=1<<r;i&n|t[r]&n&&(t[r]|=n),s&=~i}}var xn=0;function O6(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var D6,jC,R6,L6,B6,yj=!1,i0=[],wc=null,Nc=null,jc=null,lp=new Map,op=new Map,uc=[],OY="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M5(t,n){switch(t){case"focusin":case"focusout":wc=null;break;case"dragenter":case"dragleave":Nc=null;break;case"mouseover":case"mouseout":jc=null;break;case"pointerover":case"pointerout":lp.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":op.delete(n.pointerId)}}function rm(t,n,s,r,i,l){return t===null||t.nativeEvent!==l?(t={blockedOn:n,domEventName:s,eventSystemFlags:r,nativeEvent:l,targetContainers:[i]},n!==null&&(n=fx(n),n!==null&&jC(n)),t):(t.eventSystemFlags|=r,n=t.targetContainers,i!==null&&n.indexOf(i)===-1&&n.push(i),t)}function DY(t,n,s,r,i){switch(n){case"focusin":return wc=rm(wc,t,n,s,r,i),!0;case"dragenter":return Nc=rm(Nc,t,n,s,r,i),!0;case"mouseover":return jc=rm(jc,t,n,s,r,i),!0;case"pointerover":var l=i.pointerId;return lp.set(l,rm(lp.get(l)||null,t,n,s,r,i)),!0;case"gotpointercapture":return l=i.pointerId,op.set(l,rm(op.get(l)||null,t,n,s,r,i)),!0}return!1}function F6(t){var n=Td(t.target);if(n!==null){var s=Eu(n);if(s!==null){if(n=s.tag,n===13){if(n=A6(s),n!==null){t.blockedOn=n,B6(t.priority,function(){R6(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function bg(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var s=bj(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var r=new s.constructor(s.type,s);hj=r,s.target.dispatchEvent(r),hj=null}else return n=fx(s),n!==null&&jC(n),t.blockedOn=s,!1;n.shift()}return!0}function O5(t,n,s){bg(t)&&s.delete(n)}function RY(){yj=!1,wc!==null&&bg(wc)&&(wc=null),Nc!==null&&bg(Nc)&&(Nc=null),jc!==null&&bg(jc)&&(jc=null),lp.forEach(O5),op.forEach(O5)}function am(t,n){t.blockedOn===n&&(t.blockedOn=null,yj||(yj=!0,Ka.unstable_scheduleCallback(Ka.unstable_NormalPriority,RY)))}function cp(t){function n(i){return am(i,t)}if(0<i0.length){am(i0[0],t);for(var s=1;s<i0.length;s++){var r=i0[s];r.blockedOn===t&&(r.blockedOn=null)}}for(wc!==null&&am(wc,t),Nc!==null&&am(Nc,t),jc!==null&&am(jc,t),lp.forEach(n),op.forEach(n),s=0;s<uc.length;s++)r=uc[s],r.blockedOn===t&&(r.blockedOn=null);for(;0<uc.length&&(s=uc[0],s.blockedOn===null);)F6(s),s.blockedOn===null&&uc.shift()}var If=Do.ReactCurrentBatchConfig,o1=!0;function LY(t,n,s,r){var i=xn,l=If.transition;If.transition=null;try{xn=1,SC(t,n,s,r)}finally{xn=i,If.transition=l}}function BY(t,n,s,r){var i=xn,l=If.transition;If.transition=null;try{xn=4,SC(t,n,s,r)}finally{xn=i,If.transition=l}}function SC(t,n,s,r){if(o1){var i=bj(t,n,s,r);if(i===null)Ww(t,n,r,c1,s),M5(t,r);else if(DY(i,t,n,s,r))r.stopPropagation();else if(M5(t,r),n&4&&-1<OY.indexOf(t)){for(;i!==null;){var l=fx(i);if(l!==null&&D6(l),l=bj(t,n,s,r),l===null&&Ww(t,n,r,c1,s),l===i)break;i=l}i!==null&&r.stopPropagation()}else Ww(t,n,r,null,s)}}var c1=null;function bj(t,n,s,r){if(c1=null,t=vC(r),t=Td(t),t!==null)if(n=Eu(t),n===null)t=null;else if(s=n.tag,s===13){if(t=A6(n),t!==null)return t;t=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return c1=t,null}function $6(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_Y()){case wC:return 1;case I6:return 4;case i1:case CY:return 16;case P6:return 536870912;default:return 16}default:return 16}}var pc=null,_C=null,vg=null;function z6(){if(vg)return vg;var t,n=_C,s=n.length,r,i="value"in pc?pc.value:pc.textContent,l=i.length;for(t=0;t<s&&n[t]===i[t];t++);var o=s-t;for(r=1;r<=o&&n[s-r]===i[l-r];r++);return vg=i.slice(t,1<r?1-r:void 0)}function wg(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function l0(){return!0}function D5(){return!1}function ei(t){function n(s,r,i,l,o){this._reactName=s,this._targetInst=i,this.type=r,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(s=t[c],this[c]=s?s(l):l[c]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?l0:D5,this.isPropagationStopped=D5,this}return as(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=l0)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=l0)},persist:function(){},isPersistent:l0}),n}var xh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},CC=ei(xh),ux=as({},xh,{view:0,detail:0}),FY=ei(ux),Rw,Lw,im,sb=as({},ux,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:AC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==im&&(im&&t.type==="mousemove"?(Rw=t.screenX-im.screenX,Lw=t.screenY-im.screenY):Lw=Rw=0,im=t),Rw)},movementY:function(t){return"movementY"in t?t.movementY:Lw}}),R5=ei(sb),$Y=as({},sb,{dataTransfer:0}),zY=ei($Y),UY=as({},ux,{relatedTarget:0}),Bw=ei(UY),VY=as({},xh,{animationName:0,elapsedTime:0,pseudoElement:0}),HY=ei(VY),WY=as({},xh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qY=ei(WY),GY=as({},xh,{data:0}),L5=ei(GY),KY={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},YY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},XY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function QY(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=XY[t])?!!n[t]:!1}function AC(){return QY}var ZY=as({},ux,{key:function(t){if(t.key){var n=KY[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=wg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?YY[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:AC,charCode:function(t){return t.type==="keypress"?wg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),JY=ei(ZY),eX=as({},sb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),B5=ei(eX),tX=as({},ux,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:AC}),nX=ei(tX),sX=as({},xh,{propertyName:0,elapsedTime:0,pseudoElement:0}),rX=ei(sX),aX=as({},sb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),iX=ei(aX),lX=[9,13,27,32],kC=yo&&"CompositionEvent"in window,$m=null;yo&&"documentMode"in document&&($m=document.documentMode);var oX=yo&&"TextEvent"in window&&!$m,U6=yo&&(!kC||$m&&8<$m&&11>=$m),F5=" ",$5=!1;function V6(t,n){switch(t){case"keyup":return lX.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function H6(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var of=!1;function cX(t,n){switch(t){case"compositionend":return H6(n);case"keypress":return n.which!==32?null:($5=!0,F5);case"textInput":return t=n.data,t===F5&&$5?null:t;default:return null}}function dX(t,n){if(of)return t==="compositionend"||!kC&&V6(t,n)?(t=z6(),vg=_C=pc=null,of=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return U6&&n.locale!=="ko"?null:n.data;default:return null}}var uX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z5(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!uX[t.type]:n==="textarea"}function W6(t,n,s,r){N6(r),n=d1(n,"onChange"),0<n.length&&(s=new CC("onChange","change",null,s,r),t.push({event:s,listeners:n}))}var zm=null,dp=null;function fX(t){n8(t,0)}function rb(t){var n=uf(t);if(p6(n))return t}function hX(t,n){if(t==="change")return n}var q6=!1;if(yo){var Fw;if(yo){var $w="oninput"in document;if(!$w){var U5=document.createElement("div");U5.setAttribute("oninput","return;"),$w=typeof U5.oninput=="function"}Fw=$w}else Fw=!1;q6=Fw&&(!document.documentMode||9<document.documentMode)}function V5(){zm&&(zm.detachEvent("onpropertychange",G6),dp=zm=null)}function G6(t){if(t.propertyName==="value"&&rb(dp)){var n=[];W6(n,dp,t,vC(t)),C6(fX,n)}}function mX(t,n,s){t==="focusin"?(V5(),zm=n,dp=s,zm.attachEvent("onpropertychange",G6)):t==="focusout"&&V5()}function pX(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rb(dp)}function xX(t,n){if(t==="click")return rb(n)}function gX(t,n){if(t==="input"||t==="change")return rb(n)}function yX(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Qi=typeof Object.is=="function"?Object.is:yX;function up(t,n){if(Qi(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var s=Object.keys(t),r=Object.keys(n);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var i=s[r];if(!tj.call(n,i)||!Qi(t[i],n[i]))return!1}return!0}function H5(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function W5(t,n){var s=H5(t);t=0;for(var r;s;){if(s.nodeType===3){if(r=t+s.textContent.length,t<=n&&r>=n)return{node:s,offset:n-t};t=r}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=H5(s)}}function K6(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?K6(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function Y6(){for(var t=window,n=s1();n instanceof t.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)t=n.contentWindow;else break;n=s1(t.document)}return n}function EC(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function bX(t){var n=Y6(),s=t.focusedElem,r=t.selectionRange;if(n!==s&&s&&s.ownerDocument&&K6(s.ownerDocument.documentElement,s)){if(r!==null&&EC(s)){if(n=r.start,t=r.end,t===void 0&&(t=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(t,s.value.length);else if(t=(n=s.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var i=s.textContent.length,l=Math.min(r.start,i);r=r.end===void 0?l:Math.min(r.end,i),!t.extend&&l>r&&(i=r,r=l,l=i),i=W5(s,l);var o=W5(s,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(n=n.createRange(),n.setStart(i.node,i.offset),t.removeAllRanges(),l>r?(t.addRange(n),t.extend(o.node,o.offset)):(n.setEnd(o.node,o.offset),t.addRange(n)))}}for(n=[],t=s;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)t=n[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var vX=yo&&"documentMode"in document&&11>=document.documentMode,cf=null,vj=null,Um=null,wj=!1;function q5(t,n,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;wj||cf==null||cf!==s1(r)||(r=cf,"selectionStart"in r&&EC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Um&&up(Um,r)||(Um=r,r=d1(vj,"onSelect"),0<r.length&&(n=new CC("onSelect","select",null,n,s),t.push({event:n,listeners:r}),n.target=cf)))}function o0(t,n){var s={};return s[t.toLowerCase()]=n.toLowerCase(),s["Webkit"+t]="webkit"+n,s["Moz"+t]="moz"+n,s}var df={animationend:o0("Animation","AnimationEnd"),animationiteration:o0("Animation","AnimationIteration"),animationstart:o0("Animation","AnimationStart"),transitionend:o0("Transition","TransitionEnd")},zw={},X6={};yo&&(X6=document.createElement("div").style,"AnimationEvent"in window||(delete df.animationend.animation,delete df.animationiteration.animation,delete df.animationstart.animation),"TransitionEvent"in window||delete df.transitionend.transition);function ab(t){if(zw[t])return zw[t];if(!df[t])return t;var n=df[t],s;for(s in n)if(n.hasOwnProperty(s)&&s in X6)return zw[t]=n[s];return t}var Q6=ab("animationend"),Z6=ab("animationiteration"),J6=ab("animationstart"),e8=ab("transitionend"),t8=new Map,G5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yc(t,n){t8.set(t,n),ku(n,[t])}for(var Uw=0;Uw<G5.length;Uw++){var Vw=G5[Uw],wX=Vw.toLowerCase(),NX=Vw[0].toUpperCase()+Vw.slice(1);Yc(wX,"on"+NX)}Yc(Q6,"onAnimationEnd");Yc(Z6,"onAnimationIteration");Yc(J6,"onAnimationStart");Yc("dblclick","onDoubleClick");Yc("focusin","onFocus");Yc("focusout","onBlur");Yc(e8,"onTransitionEnd");zf("onMouseEnter",["mouseout","mouseover"]);zf("onMouseLeave",["mouseout","mouseover"]);zf("onPointerEnter",["pointerout","pointerover"]);zf("onPointerLeave",["pointerout","pointerover"]);ku("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ku("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ku("onBeforeInput",["compositionend","keypress","textInput","paste"]);ku("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ku("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ku("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jX=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tm));function K5(t,n,s){var r=t.type||"unknown-event";t.currentTarget=s,wY(r,n,void 0,t),t.currentTarget=null}function n8(t,n){n=(n&4)!==0;for(var s=0;s<t.length;s++){var r=t[s],i=r.event;r=r.listeners;e:{var l=void 0;if(n)for(var o=r.length-1;0<=o;o--){var c=r[o],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==l&&i.isPropagationStopped())break e;K5(i,c,u),l=d}else for(o=0;o<r.length;o++){if(c=r[o],d=c.instance,u=c.currentTarget,c=c.listener,d!==l&&i.isPropagationStopped())break e;K5(i,c,u),l=d}}}if(a1)throw t=xj,a1=!1,xj=null,t}function Bn(t,n){var s=n[Cj];s===void 0&&(s=n[Cj]=new Set);var r=t+"__bubble";s.has(r)||(s8(n,t,2,!1),s.add(r))}function Hw(t,n,s){var r=0;n&&(r|=4),s8(s,t,r,n)}var c0="_reactListening"+Math.random().toString(36).slice(2);function fp(t){if(!t[c0]){t[c0]=!0,d6.forEach(function(s){s!=="selectionchange"&&(jX.has(s)||Hw(s,!1,t),Hw(s,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[c0]||(n[c0]=!0,Hw("selectionchange",!1,n))}}function s8(t,n,s,r){switch($6(n)){case 1:var i=LY;break;case 4:i=BY;break;default:i=SC}s=i.bind(null,n,s,t),i=void 0,!pj||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(n,s,{capture:!0,passive:i}):t.addEventListener(n,s,!0):i!==void 0?t.addEventListener(n,s,{passive:i}):t.addEventListener(n,s,!1)}function Ww(t,n,s,r,i){var l=r;if(!(n&1)&&!(n&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;o=o.return}for(;c!==null;){if(o=Td(c),o===null)return;if(d=o.tag,d===5||d===6){r=l=o;continue e}c=c.parentNode}}r=r.return}C6(function(){var u=l,h=vC(s),m=[];e:{var x=t8.get(t);if(x!==void 0){var b=CC,w=t;switch(t){case"keypress":if(wg(s)===0)break e;case"keydown":case"keyup":b=JY;break;case"focusin":w="focus",b=Bw;break;case"focusout":w="blur",b=Bw;break;case"beforeblur":case"afterblur":b=Bw;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=R5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=zY;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=nX;break;case Q6:case Z6:case J6:b=HY;break;case e8:b=rX;break;case"scroll":b=FY;break;case"wheel":b=iX;break;case"copy":case"cut":case"paste":b=qY;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=B5}var j=(n&4)!==0,S=!j&&t==="scroll",C=j?x!==null?x+"Capture":null:x;j=[];for(var A=u,k;A!==null;){k=A;var T=k.stateNode;if(k.tag===5&&T!==null&&(k=T,C!==null&&(T=ip(A,C),T!=null&&j.push(hp(A,T,k)))),S)break;A=A.return}0<j.length&&(x=new b(x,w,null,s,h),m.push({event:x,listeners:j}))}}if(!(n&7)){e:{if(x=t==="mouseover"||t==="pointerover",b=t==="mouseout"||t==="pointerout",x&&s!==hj&&(w=s.relatedTarget||s.fromElement)&&(Td(w)||w[bo]))break e;if((b||x)&&(x=h.window===h?h:(x=h.ownerDocument)?x.defaultView||x.parentWindow:window,b?(w=s.relatedTarget||s.toElement,b=u,w=w?Td(w):null,w!==null&&(S=Eu(w),w!==S||w.tag!==5&&w.tag!==6)&&(w=null)):(b=null,w=u),b!==w)){if(j=R5,T="onMouseLeave",C="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(j=B5,T="onPointerLeave",C="onPointerEnter",A="pointer"),S=b==null?x:uf(b),k=w==null?x:uf(w),x=new j(T,A+"leave",b,s,h),x.target=S,x.relatedTarget=k,T=null,Td(h)===u&&(j=new j(C,A+"enter",w,s,h),j.target=k,j.relatedTarget=S,T=j),S=T,b&&w)t:{for(j=b,C=w,A=0,k=j;k;k=Gu(k))A++;for(k=0,T=C;T;T=Gu(T))k++;for(;0<A-k;)j=Gu(j),A--;for(;0<k-A;)C=Gu(C),k--;for(;A--;){if(j===C||C!==null&&j===C.alternate)break t;j=Gu(j),C=Gu(C)}j=null}else j=null;b!==null&&Y5(m,x,b,j,!1),w!==null&&S!==null&&Y5(m,S,w,j,!0)}}e:{if(x=u?uf(u):window,b=x.nodeName&&x.nodeName.toLowerCase(),b==="select"||b==="input"&&x.type==="file")var I=hX;else if(z5(x))if(q6)I=gX;else{I=pX;var D=mX}else(b=x.nodeName)&&b.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(I=xX);if(I&&(I=I(t,u))){W6(m,I,s,h);break e}D&&D(t,x,u),t==="focusout"&&(D=x._wrapperState)&&D.controlled&&x.type==="number"&&oj(x,"number",x.value)}switch(D=u?uf(u):window,t){case"focusin":(z5(D)||D.contentEditable==="true")&&(cf=D,vj=u,Um=null);break;case"focusout":Um=vj=cf=null;break;case"mousedown":wj=!0;break;case"contextmenu":case"mouseup":case"dragend":wj=!1,q5(m,s,h);break;case"selectionchange":if(vX)break;case"keydown":case"keyup":q5(m,s,h)}var O;if(kC)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else of?V6(t,s)&&(R="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(R="onCompositionStart");R&&(U6&&s.locale!=="ko"&&(of||R!=="onCompositionStart"?R==="onCompositionEnd"&&of&&(O=z6()):(pc=h,_C="value"in pc?pc.value:pc.textContent,of=!0)),D=d1(u,R),0<D.length&&(R=new L5(R,t,null,s,h),m.push({event:R,listeners:D}),O?R.data=O:(O=H6(s),O!==null&&(R.data=O)))),(O=oX?cX(t,s):dX(t,s))&&(u=d1(u,"onBeforeInput"),0<u.length&&(h=new L5("onBeforeInput","beforeinput",null,s,h),m.push({event:h,listeners:u}),h.data=O))}n8(m,n)})}function hp(t,n,s){return{instance:t,listener:n,currentTarget:s}}function d1(t,n){for(var s=n+"Capture",r=[];t!==null;){var i=t,l=i.stateNode;i.tag===5&&l!==null&&(i=l,l=ip(t,s),l!=null&&r.unshift(hp(t,l,i)),l=ip(t,n),l!=null&&r.push(hp(t,l,i))),t=t.return}return r}function Gu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Y5(t,n,s,r,i){for(var l=n._reactName,o=[];s!==null&&s!==r;){var c=s,d=c.alternate,u=c.stateNode;if(d!==null&&d===r)break;c.tag===5&&u!==null&&(c=u,i?(d=ip(s,l),d!=null&&o.unshift(hp(s,d,c))):i||(d=ip(s,l),d!=null&&o.push(hp(s,d,c)))),s=s.return}o.length!==0&&t.push({event:n,listeners:o})}var SX=/\r\n?/g,_X=/\u0000|\uFFFD/g;function X5(t){return(typeof t=="string"?t:""+t).replace(SX,`
`).replace(_X,"")}function d0(t,n,s){if(n=X5(n),X5(t)!==n&&s)throw Error(He(425))}function u1(){}var Nj=null,jj=null;function Sj(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var _j=typeof setTimeout=="function"?setTimeout:void 0,CX=typeof clearTimeout=="function"?clearTimeout:void 0,Q5=typeof Promise=="function"?Promise:void 0,AX=typeof queueMicrotask=="function"?queueMicrotask:typeof Q5<"u"?function(t){return Q5.resolve(null).then(t).catch(kX)}:_j;function kX(t){setTimeout(function(){throw t})}function qw(t,n){var s=n,r=0;do{var i=s.nextSibling;if(t.removeChild(s),i&&i.nodeType===8)if(s=i.data,s==="/$"){if(r===0){t.removeChild(i),cp(n);return}r--}else s!=="$"&&s!=="$?"&&s!=="$!"||r++;s=i}while(s);cp(n)}function Sc(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function Z5(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return t;n--}else s==="/$"&&n++}t=t.previousSibling}return null}var gh=Math.random().toString(36).slice(2),jl="__reactFiber$"+gh,mp="__reactProps$"+gh,bo="__reactContainer$"+gh,Cj="__reactEvents$"+gh,EX="__reactListeners$"+gh,TX="__reactHandles$"+gh;function Td(t){var n=t[jl];if(n)return n;for(var s=t.parentNode;s;){if(n=s[bo]||s[jl]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(t=Z5(t);t!==null;){if(s=t[jl])return s;t=Z5(t)}return n}t=s,s=t.parentNode}return null}function fx(t){return t=t[jl]||t[bo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function uf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(He(33))}function ib(t){return t[mp]||null}var Aj=[],ff=-1;function Xc(t){return{current:t}}function zn(t){0>ff||(t.current=Aj[ff],Aj[ff]=null,ff--)}function Dn(t,n){ff++,Aj[ff]=t.current,t.current=n}var Dc={},Hr=Xc(Dc),ba=Xc(!1),su=Dc;function Uf(t,n){var s=t.type.contextTypes;if(!s)return Dc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===n)return r.__reactInternalMemoizedMaskedChildContext;var i={},l;for(l in s)i[l]=n[l];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=i),i}function va(t){return t=t.childContextTypes,t!=null}function f1(){zn(ba),zn(Hr)}function J5(t,n,s){if(Hr.current!==Dc)throw Error(He(168));Dn(Hr,n),Dn(ba,s)}function r8(t,n,s){var r=t.stateNode;if(n=n.childContextTypes,typeof r.getChildContext!="function")return s;r=r.getChildContext();for(var i in r)if(!(i in n))throw Error(He(108,mY(t)||"Unknown",i));return as({},s,r)}function h1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Dc,su=Hr.current,Dn(Hr,t),Dn(ba,ba.current),!0}function eT(t,n,s){var r=t.stateNode;if(!r)throw Error(He(169));s?(t=r8(t,n,su),r.__reactInternalMemoizedMergedChildContext=t,zn(ba),zn(Hr),Dn(Hr,t)):zn(ba),Dn(ba,s)}var ao=null,lb=!1,Gw=!1;function a8(t){ao===null?ao=[t]:ao.push(t)}function IX(t){lb=!0,a8(t)}function Qc(){if(!Gw&&ao!==null){Gw=!0;var t=0,n=xn;try{var s=ao;for(xn=1;t<s.length;t++){var r=s[t];do r=r(!0);while(r!==null)}ao=null,lb=!1}catch(i){throw ao!==null&&(ao=ao.slice(t+1)),T6(wC,Qc),i}finally{xn=n,Gw=!1}}return null}var hf=[],mf=0,m1=null,p1=0,xi=[],gi=0,ru=null,co=1,uo="";function yd(t,n){hf[mf++]=p1,hf[mf++]=m1,m1=t,p1=n}function i8(t,n,s){xi[gi++]=co,xi[gi++]=uo,xi[gi++]=ru,ru=t;var r=co;t=uo;var i=32-Yi(r)-1;r&=~(1<<i),s+=1;var l=32-Yi(n)+i;if(30<l){var o=i-i%5;l=(r&(1<<o)-1).toString(32),r>>=o,i-=o,co=1<<32-Yi(n)+i|s<<i|r,uo=l+t}else co=1<<l|s<<i|r,uo=t}function TC(t){t.return!==null&&(yd(t,1),i8(t,1,0))}function IC(t){for(;t===m1;)m1=hf[--mf],hf[mf]=null,p1=hf[--mf],hf[mf]=null;for(;t===ru;)ru=xi[--gi],xi[gi]=null,uo=xi[--gi],xi[gi]=null,co=xi[--gi],xi[gi]=null}var Ha=null,Ua=null,Wn=!1,Hi=null;function l8(t,n){var s=yi(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=t,n=t.deletions,n===null?(t.deletions=[s],t.flags|=16):n.push(s)}function tT(t,n){switch(t.tag){case 5:var s=t.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Ha=t,Ua=Sc(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Ha=t,Ua=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=ru!==null?{id:co,overflow:uo}:null,t.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=yi(18,null,null,0),s.stateNode=n,s.return=t,t.child=s,Ha=t,Ua=null,!0):!1;default:return!1}}function kj(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ej(t){if(Wn){var n=Ua;if(n){var s=n;if(!tT(t,n)){if(kj(t))throw Error(He(418));n=Sc(s.nextSibling);var r=Ha;n&&tT(t,n)?l8(r,s):(t.flags=t.flags&-4097|2,Wn=!1,Ha=t)}}else{if(kj(t))throw Error(He(418));t.flags=t.flags&-4097|2,Wn=!1,Ha=t}}}function nT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ha=t}function u0(t){if(t!==Ha)return!1;if(!Wn)return nT(t),Wn=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!Sj(t.type,t.memoizedProps)),n&&(n=Ua)){if(kj(t))throw o8(),Error(He(418));for(;n;)l8(t,n),n=Sc(n.nextSibling)}if(nT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(He(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(n===0){Ua=Sc(t.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}t=t.nextSibling}Ua=null}}else Ua=Ha?Sc(t.stateNode.nextSibling):null;return!0}function o8(){for(var t=Ua;t;)t=Sc(t.nextSibling)}function Vf(){Ua=Ha=null,Wn=!1}function PC(t){Hi===null?Hi=[t]:Hi.push(t)}var PX=Do.ReactCurrentBatchConfig;function lm(t,n,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(He(309));var r=s.stateNode}if(!r)throw Error(He(147,t));var i=r,l=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===l?n.ref:(n=function(o){var c=i.refs;o===null?delete c[l]:c[l]=o},n._stringRef=l,n)}if(typeof t!="string")throw Error(He(284));if(!s._owner)throw Error(He(290,t))}return t}function f0(t,n){throw t=Object.prototype.toString.call(n),Error(He(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function sT(t){var n=t._init;return n(t._payload)}function c8(t){function n(C,A){if(t){var k=C.deletions;k===null?(C.deletions=[A],C.flags|=16):k.push(A)}}function s(C,A){if(!t)return null;for(;A!==null;)n(C,A),A=A.sibling;return null}function r(C,A){for(C=new Map;A!==null;)A.key!==null?C.set(A.key,A):C.set(A.index,A),A=A.sibling;return C}function i(C,A){return C=kc(C,A),C.index=0,C.sibling=null,C}function l(C,A,k){return C.index=k,t?(k=C.alternate,k!==null?(k=k.index,k<A?(C.flags|=2,A):k):(C.flags|=2,A)):(C.flags|=1048576,A)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function c(C,A,k,T){return A===null||A.tag!==6?(A=eN(k,C.mode,T),A.return=C,A):(A=i(A,k),A.return=C,A)}function d(C,A,k,T){var I=k.type;return I===lf?h(C,A,k.props.children,T,k.key):A!==null&&(A.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ac&&sT(I)===A.type)?(T=i(A,k.props),T.ref=lm(C,A,k),T.return=C,T):(T=kg(k.type,k.key,k.props,null,C.mode,T),T.ref=lm(C,A,k),T.return=C,T)}function u(C,A,k,T){return A===null||A.tag!==4||A.stateNode.containerInfo!==k.containerInfo||A.stateNode.implementation!==k.implementation?(A=tN(k,C.mode,T),A.return=C,A):(A=i(A,k.children||[]),A.return=C,A)}function h(C,A,k,T,I){return A===null||A.tag!==7?(A=Vd(k,C.mode,T,I),A.return=C,A):(A=i(A,k),A.return=C,A)}function m(C,A,k){if(typeof A=="string"&&A!==""||typeof A=="number")return A=eN(""+A,C.mode,k),A.return=C,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case t0:return k=kg(A.type,A.key,A.props,null,C.mode,k),k.ref=lm(C,null,A),k.return=C,k;case af:return A=tN(A,C.mode,k),A.return=C,A;case ac:var T=A._init;return m(C,T(A._payload),k)}if(km(A)||nm(A))return A=Vd(A,C.mode,k,null),A.return=C,A;f0(C,A)}return null}function x(C,A,k,T){var I=A!==null?A.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return I!==null?null:c(C,A,""+k,T);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case t0:return k.key===I?d(C,A,k,T):null;case af:return k.key===I?u(C,A,k,T):null;case ac:return I=k._init,x(C,A,I(k._payload),T)}if(km(k)||nm(k))return I!==null?null:h(C,A,k,T,null);f0(C,k)}return null}function b(C,A,k,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return C=C.get(k)||null,c(A,C,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case t0:return C=C.get(T.key===null?k:T.key)||null,d(A,C,T,I);case af:return C=C.get(T.key===null?k:T.key)||null,u(A,C,T,I);case ac:var D=T._init;return b(C,A,k,D(T._payload),I)}if(km(T)||nm(T))return C=C.get(k)||null,h(A,C,T,I,null);f0(A,T)}return null}function w(C,A,k,T){for(var I=null,D=null,O=A,R=A=0,P=null;O!==null&&R<k.length;R++){O.index>R?(P=O,O=null):P=O.sibling;var L=x(C,O,k[R],T);if(L===null){O===null&&(O=P);break}t&&O&&L.alternate===null&&n(C,O),A=l(L,A,R),D===null?I=L:D.sibling=L,D=L,O=P}if(R===k.length)return s(C,O),Wn&&yd(C,R),I;if(O===null){for(;R<k.length;R++)O=m(C,k[R],T),O!==null&&(A=l(O,A,R),D===null?I=O:D.sibling=O,D=O);return Wn&&yd(C,R),I}for(O=r(C,O);R<k.length;R++)P=b(O,C,R,k[R],T),P!==null&&(t&&P.alternate!==null&&O.delete(P.key===null?R:P.key),A=l(P,A,R),D===null?I=P:D.sibling=P,D=P);return t&&O.forEach(function($){return n(C,$)}),Wn&&yd(C,R),I}function j(C,A,k,T){var I=nm(k);if(typeof I!="function")throw Error(He(150));if(k=I.call(k),k==null)throw Error(He(151));for(var D=I=null,O=A,R=A=0,P=null,L=k.next();O!==null&&!L.done;R++,L=k.next()){O.index>R?(P=O,O=null):P=O.sibling;var $=x(C,O,L.value,T);if($===null){O===null&&(O=P);break}t&&O&&$.alternate===null&&n(C,O),A=l($,A,R),D===null?I=$:D.sibling=$,D=$,O=P}if(L.done)return s(C,O),Wn&&yd(C,R),I;if(O===null){for(;!L.done;R++,L=k.next())L=m(C,L.value,T),L!==null&&(A=l(L,A,R),D===null?I=L:D.sibling=L,D=L);return Wn&&yd(C,R),I}for(O=r(C,O);!L.done;R++,L=k.next())L=b(O,C,R,L.value,T),L!==null&&(t&&L.alternate!==null&&O.delete(L.key===null?R:L.key),A=l(L,A,R),D===null?I=L:D.sibling=L,D=L);return t&&O.forEach(function(B){return n(C,B)}),Wn&&yd(C,R),I}function S(C,A,k,T){if(typeof k=="object"&&k!==null&&k.type===lf&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case t0:e:{for(var I=k.key,D=A;D!==null;){if(D.key===I){if(I=k.type,I===lf){if(D.tag===7){s(C,D.sibling),A=i(D,k.props.children),A.return=C,C=A;break e}}else if(D.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===ac&&sT(I)===D.type){s(C,D.sibling),A=i(D,k.props),A.ref=lm(C,D,k),A.return=C,C=A;break e}s(C,D);break}else n(C,D);D=D.sibling}k.type===lf?(A=Vd(k.props.children,C.mode,T,k.key),A.return=C,C=A):(T=kg(k.type,k.key,k.props,null,C.mode,T),T.ref=lm(C,A,k),T.return=C,C=T)}return o(C);case af:e:{for(D=k.key;A!==null;){if(A.key===D)if(A.tag===4&&A.stateNode.containerInfo===k.containerInfo&&A.stateNode.implementation===k.implementation){s(C,A.sibling),A=i(A,k.children||[]),A.return=C,C=A;break e}else{s(C,A);break}else n(C,A);A=A.sibling}A=tN(k,C.mode,T),A.return=C,C=A}return o(C);case ac:return D=k._init,S(C,A,D(k._payload),T)}if(km(k))return w(C,A,k,T);if(nm(k))return j(C,A,k,T);f0(C,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,A!==null&&A.tag===6?(s(C,A.sibling),A=i(A,k),A.return=C,C=A):(s(C,A),A=eN(k,C.mode,T),A.return=C,C=A),o(C)):s(C,A)}return S}var Hf=c8(!0),d8=c8(!1),x1=Xc(null),g1=null,pf=null,MC=null;function OC(){MC=pf=g1=null}function DC(t){var n=x1.current;zn(x1),t._currentValue=n}function Tj(t,n,s){for(;t!==null;){var r=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,r!==null&&(r.childLanes|=n)):r!==null&&(r.childLanes&n)!==n&&(r.childLanes|=n),t===s)break;t=t.return}}function Pf(t,n){g1=t,MC=pf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&n&&(xa=!0),t.firstContext=null)}function _i(t){var n=t._currentValue;if(MC!==t)if(t={context:t,memoizedValue:n,next:null},pf===null){if(g1===null)throw Error(He(308));pf=t,g1.dependencies={lanes:0,firstContext:t}}else pf=pf.next=t;return n}var Id=null;function RC(t){Id===null?Id=[t]:Id.push(t)}function u8(t,n,s,r){var i=n.interleaved;return i===null?(s.next=s,RC(n)):(s.next=i.next,i.next=s),n.interleaved=s,vo(t,r)}function vo(t,n){t.lanes|=n;var s=t.alternate;for(s!==null&&(s.lanes|=n),s=t,t=t.return;t!==null;)t.childLanes|=n,s=t.alternate,s!==null&&(s.childLanes|=n),s=t,t=t.return;return s.tag===3?s.stateNode:null}var ic=!1;function LC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function f8(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function po(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function _c(t,n,s){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,an&2){var i=r.pending;return i===null?n.next=n:(n.next=i.next,i.next=n),r.pending=n,vo(t,s)}return i=r.interleaved,i===null?(n.next=n,RC(r)):(n.next=i.next,i.next=n),r.interleaved=n,vo(t,s)}function Ng(t,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var r=n.lanes;r&=t.pendingLanes,s|=r,n.lanes=s,NC(t,s)}}function rT(t,n){var s=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var i=null,l=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};l===null?i=l=o:l=l.next=o,s=s.next}while(s!==null);l===null?i=l=n:l=l.next=n}else i=l=n;s={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:l,shared:r.shared,effects:r.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=n:t.next=n,s.lastBaseUpdate=n}function y1(t,n,s,r){var i=t.updateQueue;ic=!1;var l=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var d=c,u=d.next;d.next=null,o===null?l=u:o.next=u,o=d;var h=t.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==o&&(c===null?h.firstBaseUpdate=u:c.next=u,h.lastBaseUpdate=d))}if(l!==null){var m=i.baseState;o=0,h=u=d=null,c=l;do{var x=c.lane,b=c.eventTime;if((r&x)===x){h!==null&&(h=h.next={eventTime:b,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=t,j=c;switch(x=n,b=s,j.tag){case 1:if(w=j.payload,typeof w=="function"){m=w.call(b,m,x);break e}m=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=j.payload,x=typeof w=="function"?w.call(b,m,x):w,x==null)break e;m=as({},m,x);break e;case 2:ic=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[c]:x.push(c))}else b={eventTime:b,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(u=h=b,d=m):h=h.next=b,o|=x;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;x=c,c=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(!0);if(h===null&&(d=m),i.baseState=d,i.firstBaseUpdate=u,i.lastBaseUpdate=h,n=i.shared.interleaved,n!==null){i=n;do o|=i.lane,i=i.next;while(i!==n)}else l===null&&(i.shared.lanes=0);iu|=o,t.lanes=o,t.memoizedState=m}}function aT(t,n,s){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var r=t[n],i=r.callback;if(i!==null){if(r.callback=null,r=s,typeof i!="function")throw Error(He(191,i));i.call(r)}}}var hx={},Tl=Xc(hx),pp=Xc(hx),xp=Xc(hx);function Pd(t){if(t===hx)throw Error(He(174));return t}function BC(t,n){switch(Dn(xp,n),Dn(pp,t),Dn(Tl,hx),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:dj(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=dj(n,t)}zn(Tl),Dn(Tl,n)}function Wf(){zn(Tl),zn(pp),zn(xp)}function h8(t){Pd(xp.current);var n=Pd(Tl.current),s=dj(n,t.type);n!==s&&(Dn(pp,t),Dn(Tl,s))}function FC(t){pp.current===t&&(zn(Tl),zn(pp))}var es=Xc(0);function b1(t){for(var n=t;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Kw=[];function $C(){for(var t=0;t<Kw.length;t++)Kw[t]._workInProgressVersionPrimary=null;Kw.length=0}var jg=Do.ReactCurrentDispatcher,Yw=Do.ReactCurrentBatchConfig,au=0,ss=null,Us=null,ir=null,v1=!1,Vm=!1,gp=0,MX=0;function Pr(){throw Error(He(321))}function zC(t,n){if(n===null)return!1;for(var s=0;s<n.length&&s<t.length;s++)if(!Qi(t[s],n[s]))return!1;return!0}function UC(t,n,s,r,i,l){if(au=l,ss=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,jg.current=t===null||t.memoizedState===null?LX:BX,t=s(r,i),Vm){l=0;do{if(Vm=!1,gp=0,25<=l)throw Error(He(301));l+=1,ir=Us=null,n.updateQueue=null,jg.current=FX,t=s(r,i)}while(Vm)}if(jg.current=w1,n=Us!==null&&Us.next!==null,au=0,ir=Us=ss=null,v1=!1,n)throw Error(He(300));return t}function VC(){var t=gp!==0;return gp=0,t}function wl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ir===null?ss.memoizedState=ir=t:ir=ir.next=t,ir}function Ci(){if(Us===null){var t=ss.alternate;t=t!==null?t.memoizedState:null}else t=Us.next;var n=ir===null?ss.memoizedState:ir.next;if(n!==null)ir=n,Us=t;else{if(t===null)throw Error(He(310));Us=t,t={memoizedState:Us.memoizedState,baseState:Us.baseState,baseQueue:Us.baseQueue,queue:Us.queue,next:null},ir===null?ss.memoizedState=ir=t:ir=ir.next=t}return ir}function yp(t,n){return typeof n=="function"?n(t):n}function Xw(t){var n=Ci(),s=n.queue;if(s===null)throw Error(He(311));s.lastRenderedReducer=t;var r=Us,i=r.baseQueue,l=s.pending;if(l!==null){if(i!==null){var o=i.next;i.next=l.next,l.next=o}r.baseQueue=i=l,s.pending=null}if(i!==null){l=i.next,r=r.baseState;var c=o=null,d=null,u=l;do{var h=u.lane;if((au&h)===h)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=m,o=r):d=d.next=m,ss.lanes|=h,iu|=h}u=u.next}while(u!==null&&u!==l);d===null?o=r:d.next=c,Qi(r,n.memoizedState)||(xa=!0),n.memoizedState=r,n.baseState=o,n.baseQueue=d,s.lastRenderedState=r}if(t=s.interleaved,t!==null){i=t;do l=i.lane,ss.lanes|=l,iu|=l,i=i.next;while(i!==t)}else i===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function Qw(t){var n=Ci(),s=n.queue;if(s===null)throw Error(He(311));s.lastRenderedReducer=t;var r=s.dispatch,i=s.pending,l=n.memoizedState;if(i!==null){s.pending=null;var o=i=i.next;do l=t(l,o.action),o=o.next;while(o!==i);Qi(l,n.memoizedState)||(xa=!0),n.memoizedState=l,n.baseQueue===null&&(n.baseState=l),s.lastRenderedState=l}return[l,r]}function m8(){}function p8(t,n){var s=ss,r=Ci(),i=n(),l=!Qi(r.memoizedState,i);if(l&&(r.memoizedState=i,xa=!0),r=r.queue,HC(y8.bind(null,s,r,t),[t]),r.getSnapshot!==n||l||ir!==null&&ir.memoizedState.tag&1){if(s.flags|=2048,bp(9,g8.bind(null,s,r,i,n),void 0,null),lr===null)throw Error(He(349));au&30||x8(s,n,i)}return i}function x8(t,n,s){t.flags|=16384,t={getSnapshot:n,value:s},n=ss.updateQueue,n===null?(n={lastEffect:null,stores:null},ss.updateQueue=n,n.stores=[t]):(s=n.stores,s===null?n.stores=[t]:s.push(t))}function g8(t,n,s,r){n.value=s,n.getSnapshot=r,b8(n)&&v8(t)}function y8(t,n,s){return s(function(){b8(n)&&v8(t)})}function b8(t){var n=t.getSnapshot;t=t.value;try{var s=n();return!Qi(t,s)}catch{return!0}}function v8(t){var n=vo(t,1);n!==null&&Xi(n,t,1,-1)}function iT(t){var n=wl();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yp,lastRenderedState:t},n.queue=t,t=t.dispatch=RX.bind(null,ss,t),[n.memoizedState,t]}function bp(t,n,s,r){return t={tag:t,create:n,destroy:s,deps:r,next:null},n=ss.updateQueue,n===null?(n={lastEffect:null,stores:null},ss.updateQueue=n,n.lastEffect=t.next=t):(s=n.lastEffect,s===null?n.lastEffect=t.next=t:(r=s.next,s.next=t,t.next=r,n.lastEffect=t)),t}function w8(){return Ci().memoizedState}function Sg(t,n,s,r){var i=wl();ss.flags|=t,i.memoizedState=bp(1|n,s,void 0,r===void 0?null:r)}function ob(t,n,s,r){var i=Ci();r=r===void 0?null:r;var l=void 0;if(Us!==null){var o=Us.memoizedState;if(l=o.destroy,r!==null&&zC(r,o.deps)){i.memoizedState=bp(n,s,l,r);return}}ss.flags|=t,i.memoizedState=bp(1|n,s,l,r)}function lT(t,n){return Sg(8390656,8,t,n)}function HC(t,n){return ob(2048,8,t,n)}function N8(t,n){return ob(4,2,t,n)}function j8(t,n){return ob(4,4,t,n)}function S8(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function _8(t,n,s){return s=s!=null?s.concat([t]):null,ob(4,4,S8.bind(null,n,t),s)}function WC(){}function C8(t,n){var s=Ci();n=n===void 0?null:n;var r=s.memoizedState;return r!==null&&n!==null&&zC(n,r[1])?r[0]:(s.memoizedState=[t,n],t)}function A8(t,n){var s=Ci();n=n===void 0?null:n;var r=s.memoizedState;return r!==null&&n!==null&&zC(n,r[1])?r[0]:(t=t(),s.memoizedState=[t,n],t)}function k8(t,n,s){return au&21?(Qi(s,n)||(s=M6(),ss.lanes|=s,iu|=s,t.baseState=!0),n):(t.baseState&&(t.baseState=!1,xa=!0),t.memoizedState=s)}function OX(t,n){var s=xn;xn=s!==0&&4>s?s:4,t(!0);var r=Yw.transition;Yw.transition={};try{t(!1),n()}finally{xn=s,Yw.transition=r}}function E8(){return Ci().memoizedState}function DX(t,n,s){var r=Ac(t);if(s={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null},T8(t))I8(n,s);else if(s=u8(t,n,s,r),s!==null){var i=sa();Xi(s,t,r,i),P8(s,n,r)}}function RX(t,n,s){var r=Ac(t),i={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null};if(T8(t))I8(n,i);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=n.lastRenderedReducer,l!==null))try{var o=n.lastRenderedState,c=l(o,s);if(i.hasEagerState=!0,i.eagerState=c,Qi(c,o)){var d=n.interleaved;d===null?(i.next=i,RC(n)):(i.next=d.next,d.next=i),n.interleaved=i;return}}catch{}finally{}s=u8(t,n,i,r),s!==null&&(i=sa(),Xi(s,t,r,i),P8(s,n,r))}}function T8(t){var n=t.alternate;return t===ss||n!==null&&n===ss}function I8(t,n){Vm=v1=!0;var s=t.pending;s===null?n.next=n:(n.next=s.next,s.next=n),t.pending=n}function P8(t,n,s){if(s&4194240){var r=n.lanes;r&=t.pendingLanes,s|=r,n.lanes=s,NC(t,s)}}var w1={readContext:_i,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},LX={readContext:_i,useCallback:function(t,n){return wl().memoizedState=[t,n===void 0?null:n],t},useContext:_i,useEffect:lT,useImperativeHandle:function(t,n,s){return s=s!=null?s.concat([t]):null,Sg(4194308,4,S8.bind(null,n,t),s)},useLayoutEffect:function(t,n){return Sg(4194308,4,t,n)},useInsertionEffect:function(t,n){return Sg(4,2,t,n)},useMemo:function(t,n){var s=wl();return n=n===void 0?null:n,t=t(),s.memoizedState=[t,n],t},useReducer:function(t,n,s){var r=wl();return n=s!==void 0?s(n):n,r.memoizedState=r.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},r.queue=t,t=t.dispatch=DX.bind(null,ss,t),[r.memoizedState,t]},useRef:function(t){var n=wl();return t={current:t},n.memoizedState=t},useState:iT,useDebugValue:WC,useDeferredValue:function(t){return wl().memoizedState=t},useTransition:function(){var t=iT(!1),n=t[0];return t=OX.bind(null,t[1]),wl().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,s){var r=ss,i=wl();if(Wn){if(s===void 0)throw Error(He(407));s=s()}else{if(s=n(),lr===null)throw Error(He(349));au&30||x8(r,n,s)}i.memoizedState=s;var l={value:s,getSnapshot:n};return i.queue=l,lT(y8.bind(null,r,l,t),[t]),r.flags|=2048,bp(9,g8.bind(null,r,l,s,n),void 0,null),s},useId:function(){var t=wl(),n=lr.identifierPrefix;if(Wn){var s=uo,r=co;s=(r&~(1<<32-Yi(r)-1)).toString(32)+s,n=":"+n+"R"+s,s=gp++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=MX++,n=":"+n+"r"+s.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},BX={readContext:_i,useCallback:C8,useContext:_i,useEffect:HC,useImperativeHandle:_8,useInsertionEffect:N8,useLayoutEffect:j8,useMemo:A8,useReducer:Xw,useRef:w8,useState:function(){return Xw(yp)},useDebugValue:WC,useDeferredValue:function(t){var n=Ci();return k8(n,Us.memoizedState,t)},useTransition:function(){var t=Xw(yp)[0],n=Ci().memoizedState;return[t,n]},useMutableSource:m8,useSyncExternalStore:p8,useId:E8,unstable_isNewReconciler:!1},FX={readContext:_i,useCallback:C8,useContext:_i,useEffect:HC,useImperativeHandle:_8,useInsertionEffect:N8,useLayoutEffect:j8,useMemo:A8,useReducer:Qw,useRef:w8,useState:function(){return Qw(yp)},useDebugValue:WC,useDeferredValue:function(t){var n=Ci();return Us===null?n.memoizedState=t:k8(n,Us.memoizedState,t)},useTransition:function(){var t=Qw(yp)[0],n=Ci().memoizedState;return[t,n]},useMutableSource:m8,useSyncExternalStore:p8,useId:E8,unstable_isNewReconciler:!1};function zi(t,n){if(t&&t.defaultProps){n=as({},n),t=t.defaultProps;for(var s in t)n[s]===void 0&&(n[s]=t[s]);return n}return n}function Ij(t,n,s,r){n=t.memoizedState,s=s(r,n),s=s==null?n:as({},n,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var cb={isMounted:function(t){return(t=t._reactInternals)?Eu(t)===t:!1},enqueueSetState:function(t,n,s){t=t._reactInternals;var r=sa(),i=Ac(t),l=po(r,i);l.payload=n,s!=null&&(l.callback=s),n=_c(t,l,i),n!==null&&(Xi(n,t,i,r),Ng(n,t,i))},enqueueReplaceState:function(t,n,s){t=t._reactInternals;var r=sa(),i=Ac(t),l=po(r,i);l.tag=1,l.payload=n,s!=null&&(l.callback=s),n=_c(t,l,i),n!==null&&(Xi(n,t,i,r),Ng(n,t,i))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var s=sa(),r=Ac(t),i=po(s,r);i.tag=2,n!=null&&(i.callback=n),n=_c(t,i,r),n!==null&&(Xi(n,t,r,s),Ng(n,t,r))}};function oT(t,n,s,r,i,l,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,l,o):n.prototype&&n.prototype.isPureReactComponent?!up(s,r)||!up(i,l):!0}function M8(t,n,s){var r=!1,i=Dc,l=n.contextType;return typeof l=="object"&&l!==null?l=_i(l):(i=va(n)?su:Hr.current,r=n.contextTypes,l=(r=r!=null)?Uf(t,i):Dc),n=new n(s,l),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=cb,t.stateNode=n,n._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=l),n}function cT(t,n,s,r){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,r),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,r),n.state!==t&&cb.enqueueReplaceState(n,n.state,null)}function Pj(t,n,s,r){var i=t.stateNode;i.props=s,i.state=t.memoizedState,i.refs={},LC(t);var l=n.contextType;typeof l=="object"&&l!==null?i.context=_i(l):(l=va(n)?su:Hr.current,i.context=Uf(t,l)),i.state=t.memoizedState,l=n.getDerivedStateFromProps,typeof l=="function"&&(Ij(t,n,l,s),i.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(n=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),n!==i.state&&cb.enqueueReplaceState(i,i.state,null),y1(t,s,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function qf(t,n){try{var s="",r=n;do s+=hY(r),r=r.return;while(r);var i=s}catch(l){i=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:n,stack:i,digest:null}}function Zw(t,n,s){return{value:t,source:null,stack:s??null,digest:n??null}}function Mj(t,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var $X=typeof WeakMap=="function"?WeakMap:Map;function O8(t,n,s){s=po(-1,s),s.tag=3,s.payload={element:null};var r=n.value;return s.callback=function(){j1||(j1=!0,Vj=r),Mj(t,n)},s}function D8(t,n,s){s=po(-1,s),s.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=n.value;s.payload=function(){return r(i)},s.callback=function(){Mj(t,n)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(s.callback=function(){Mj(t,n),typeof r!="function"&&(Cc===null?Cc=new Set([this]):Cc.add(this));var o=n.stack;this.componentDidCatch(n.value,{componentStack:o!==null?o:""})}),s}function dT(t,n,s){var r=t.pingCache;if(r===null){r=t.pingCache=new $X;var i=new Set;r.set(n,i)}else i=r.get(n),i===void 0&&(i=new Set,r.set(n,i));i.has(s)||(i.add(s),t=eQ.bind(null,t,n,s),n.then(t,t))}function uT(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function fT(t,n,s,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===n?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=po(-1,1),n.tag=2,_c(s,n,1))),s.lanes|=1),t)}var zX=Do.ReactCurrentOwner,xa=!1;function Qr(t,n,s,r){n.child=t===null?d8(n,null,s,r):Hf(n,t.child,s,r)}function hT(t,n,s,r,i){s=s.render;var l=n.ref;return Pf(n,i),r=UC(t,n,s,r,l,i),s=VC(),t!==null&&!xa?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~i,wo(t,n,i)):(Wn&&s&&TC(n),n.flags|=1,Qr(t,n,r,i),n.child)}function mT(t,n,s,r,i){if(t===null){var l=s.type;return typeof l=="function"&&!JC(l)&&l.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=l,R8(t,n,l,r,i)):(t=kg(s.type,null,r,n,n.mode,i),t.ref=n.ref,t.return=n,n.child=t)}if(l=t.child,!(t.lanes&i)){var o=l.memoizedProps;if(s=s.compare,s=s!==null?s:up,s(o,r)&&t.ref===n.ref)return wo(t,n,i)}return n.flags|=1,t=kc(l,r),t.ref=n.ref,t.return=n,n.child=t}function R8(t,n,s,r,i){if(t!==null){var l=t.memoizedProps;if(up(l,r)&&t.ref===n.ref)if(xa=!1,n.pendingProps=r=l,(t.lanes&i)!==0)t.flags&131072&&(xa=!0);else return n.lanes=t.lanes,wo(t,n,i)}return Oj(t,n,s,r,i)}function L8(t,n,s){var r=n.pendingProps,i=r.children,l=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dn(gf,Da),Da|=s;else{if(!(s&1073741824))return t=l!==null?l.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,Dn(gf,Da),Da|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:s,Dn(gf,Da),Da|=r}else l!==null?(r=l.baseLanes|s,n.memoizedState=null):r=s,Dn(gf,Da),Da|=r;return Qr(t,n,i,s),n.child}function B8(t,n){var s=n.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function Oj(t,n,s,r,i){var l=va(s)?su:Hr.current;return l=Uf(n,l),Pf(n,i),s=UC(t,n,s,r,l,i),r=VC(),t!==null&&!xa?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~i,wo(t,n,i)):(Wn&&r&&TC(n),n.flags|=1,Qr(t,n,s,i),n.child)}function pT(t,n,s,r,i){if(va(s)){var l=!0;h1(n)}else l=!1;if(Pf(n,i),n.stateNode===null)_g(t,n),M8(n,s,r),Pj(n,s,r,i),r=!0;else if(t===null){var o=n.stateNode,c=n.memoizedProps;o.props=c;var d=o.context,u=s.contextType;typeof u=="object"&&u!==null?u=_i(u):(u=va(s)?su:Hr.current,u=Uf(n,u));var h=s.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||d!==u)&&cT(n,o,r,u),ic=!1;var x=n.memoizedState;o.state=x,y1(n,r,o,i),d=n.memoizedState,c!==r||x!==d||ba.current||ic?(typeof h=="function"&&(Ij(n,s,h,r),d=n.memoizedState),(c=ic||oT(n,s,c,r,x,d,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(n.flags|=4194308)):(typeof o.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):(typeof o.componentDidMount=="function"&&(n.flags|=4194308),r=!1)}else{o=n.stateNode,f8(t,n),c=n.memoizedProps,u=n.type===n.elementType?c:zi(n.type,c),o.props=u,m=n.pendingProps,x=o.context,d=s.contextType,typeof d=="object"&&d!==null?d=_i(d):(d=va(s)?su:Hr.current,d=Uf(n,d));var b=s.getDerivedStateFromProps;(h=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==m||x!==d)&&cT(n,o,r,d),ic=!1,x=n.memoizedState,o.state=x,y1(n,r,o,i);var w=n.memoizedState;c!==m||x!==w||ba.current||ic?(typeof b=="function"&&(Ij(n,s,b,r),w=n.memoizedState),(u=ic||oT(n,s,u,r,x,w,d)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,d)),typeof o.componentDidUpdate=="function"&&(n.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(n.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=w),o.props=r,o.state=w,o.context=d,r=u):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(n.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(n.flags|=1024),r=!1)}return Dj(t,n,s,r,l,i)}function Dj(t,n,s,r,i,l){B8(t,n);var o=(n.flags&128)!==0;if(!r&&!o)return i&&eT(n,s,!1),wo(t,n,l);r=n.stateNode,zX.current=n;var c=o&&typeof s.getDerivedStateFromError!="function"?null:r.render();return n.flags|=1,t!==null&&o?(n.child=Hf(n,t.child,null,l),n.child=Hf(n,null,c,l)):Qr(t,n,c,l),n.memoizedState=r.state,i&&eT(n,s,!0),n.child}function F8(t){var n=t.stateNode;n.pendingContext?J5(t,n.pendingContext,n.pendingContext!==n.context):n.context&&J5(t,n.context,!1),BC(t,n.containerInfo)}function xT(t,n,s,r,i){return Vf(),PC(i),n.flags|=256,Qr(t,n,s,r),n.child}var Rj={dehydrated:null,treeContext:null,retryLane:0};function Lj(t){return{baseLanes:t,cachePool:null,transitions:null}}function $8(t,n,s){var r=n.pendingProps,i=es.current,l=!1,o=(n.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(l=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Dn(es,i&1),t===null)return Ej(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(n.mode&1?t.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(o=r.children,t=r.fallback,l?(r=n.mode,l=n.child,o={mode:"hidden",children:o},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=fb(o,r,0,null),t=Vd(t,r,s,null),l.return=n,t.return=n,l.sibling=t,n.child=l,n.child.memoizedState=Lj(s),n.memoizedState=Rj,t):qC(n,o));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return UX(t,n,o,r,c,i,s);if(l){l=r.fallback,o=n.mode,i=t.child,c=i.sibling;var d={mode:"hidden",children:r.children};return!(o&1)&&n.child!==i?(r=n.child,r.childLanes=0,r.pendingProps=d,n.deletions=null):(r=kc(i,d),r.subtreeFlags=i.subtreeFlags&14680064),c!==null?l=kc(c,l):(l=Vd(l,o,s,null),l.flags|=2),l.return=n,r.return=n,r.sibling=l,n.child=r,r=l,l=n.child,o=t.child.memoizedState,o=o===null?Lj(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=t.childLanes&~s,n.memoizedState=Rj,r}return l=t.child,t=l.sibling,r=kc(l,{mode:"visible",children:r.children}),!(n.mode&1)&&(r.lanes=s),r.return=n,r.sibling=null,t!==null&&(s=n.deletions,s===null?(n.deletions=[t],n.flags|=16):s.push(t)),n.child=r,n.memoizedState=null,r}function qC(t,n){return n=fb({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function h0(t,n,s,r){return r!==null&&PC(r),Hf(n,t.child,null,s),t=qC(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function UX(t,n,s,r,i,l,o){if(s)return n.flags&256?(n.flags&=-257,r=Zw(Error(He(422))),h0(t,n,o,r)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(l=r.fallback,i=n.mode,r=fb({mode:"visible",children:r.children},i,0,null),l=Vd(l,i,o,null),l.flags|=2,r.return=n,l.return=n,r.sibling=l,n.child=r,n.mode&1&&Hf(n,t.child,null,o),n.child.memoizedState=Lj(o),n.memoizedState=Rj,l);if(!(n.mode&1))return h0(t,n,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var c=r.dgst;return r=c,l=Error(He(419)),r=Zw(l,r,void 0),h0(t,n,o,r)}if(c=(o&t.childLanes)!==0,xa||c){if(r=lr,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==l.retryLane&&(l.retryLane=i,vo(t,i),Xi(r,t,i,-1))}return ZC(),r=Zw(Error(He(421))),h0(t,n,o,r)}return i.data==="$?"?(n.flags|=128,n.child=t.child,n=tQ.bind(null,t),i._reactRetry=n,null):(t=l.treeContext,Ua=Sc(i.nextSibling),Ha=n,Wn=!0,Hi=null,t!==null&&(xi[gi++]=co,xi[gi++]=uo,xi[gi++]=ru,co=t.id,uo=t.overflow,ru=n),n=qC(n,r.children),n.flags|=4096,n)}function gT(t,n,s){t.lanes|=n;var r=t.alternate;r!==null&&(r.lanes|=n),Tj(t.return,n,s)}function Jw(t,n,s,r,i){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:i}:(l.isBackwards=n,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=s,l.tailMode=i)}function z8(t,n,s){var r=n.pendingProps,i=r.revealOrder,l=r.tail;if(Qr(t,n,r.children,s),r=es.current,r&2)r=r&1|2,n.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gT(t,s,n);else if(t.tag===19)gT(t,s,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Dn(es,r),!(n.mode&1))n.memoizedState=null;else switch(i){case"forwards":for(s=n.child,i=null;s!==null;)t=s.alternate,t!==null&&b1(t)===null&&(i=s),s=s.sibling;s=i,s===null?(i=n.child,n.child=null):(i=s.sibling,s.sibling=null),Jw(n,!1,i,s,l);break;case"backwards":for(s=null,i=n.child,n.child=null;i!==null;){if(t=i.alternate,t!==null&&b1(t)===null){n.child=i;break}t=i.sibling,i.sibling=s,s=i,i=t}Jw(n,!0,s,null,l);break;case"together":Jw(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function _g(t,n){!(n.mode&1)&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function wo(t,n,s){if(t!==null&&(n.dependencies=t.dependencies),iu|=n.lanes,!(s&n.childLanes))return null;if(t!==null&&n.child!==t.child)throw Error(He(153));if(n.child!==null){for(t=n.child,s=kc(t,t.pendingProps),n.child=s,s.return=n;t.sibling!==null;)t=t.sibling,s=s.sibling=kc(t,t.pendingProps),s.return=n;s.sibling=null}return n.child}function VX(t,n,s){switch(n.tag){case 3:F8(n),Vf();break;case 5:h8(n);break;case 1:va(n.type)&&h1(n);break;case 4:BC(n,n.stateNode.containerInfo);break;case 10:var r=n.type._context,i=n.memoizedProps.value;Dn(x1,r._currentValue),r._currentValue=i;break;case 13:if(r=n.memoizedState,r!==null)return r.dehydrated!==null?(Dn(es,es.current&1),n.flags|=128,null):s&n.child.childLanes?$8(t,n,s):(Dn(es,es.current&1),t=wo(t,n,s),t!==null?t.sibling:null);Dn(es,es.current&1);break;case 19:if(r=(s&n.childLanes)!==0,t.flags&128){if(r)return z8(t,n,s);n.flags|=128}if(i=n.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Dn(es,es.current),r)break;return null;case 22:case 23:return n.lanes=0,L8(t,n,s)}return wo(t,n,s)}var U8,Bj,V8,H8;U8=function(t,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Bj=function(){};V8=function(t,n,s,r){var i=t.memoizedProps;if(i!==r){t=n.stateNode,Pd(Tl.current);var l=null;switch(s){case"input":i=ij(t,i),r=ij(t,r),l=[];break;case"select":i=as({},i,{value:void 0}),r=as({},r,{value:void 0}),l=[];break;case"textarea":i=cj(t,i),r=cj(t,r),l=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=u1)}uj(s,r);var o;s=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var c=i[u];for(o in c)c.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(rp.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var d=r[u];if(c=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(s||(s={}),s[o]=d[o])}else s||(l||(l=[]),l.push(u,s)),s=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(l=l||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(l=l||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(rp.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&Bn("scroll",t),l||c===d||(l=[])):(l=l||[]).push(u,d))}s&&(l=l||[]).push("style",s);var u=l;(n.updateQueue=u)&&(n.flags|=4)}};H8=function(t,n,s,r){s!==r&&(n.flags|=4)};function om(t,n){if(!Wn)switch(t.tailMode){case"hidden":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Mr(t){var n=t.alternate!==null&&t.alternate.child===t.child,s=0,r=0;if(n)for(var i=t.child;i!==null;)s|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)s|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=s,n}function HX(t,n,s){var r=n.pendingProps;switch(IC(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mr(n),null;case 1:return va(n.type)&&f1(),Mr(n),null;case 3:return r=n.stateNode,Wf(),zn(ba),zn(Hr),$C(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(u0(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Hi!==null&&(qj(Hi),Hi=null))),Bj(t,n),Mr(n),null;case 5:FC(n);var i=Pd(xp.current);if(s=n.type,t!==null&&n.stateNode!=null)V8(t,n,s,r,i),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!r){if(n.stateNode===null)throw Error(He(166));return Mr(n),null}if(t=Pd(Tl.current),u0(n)){r=n.stateNode,s=n.type;var l=n.memoizedProps;switch(r[jl]=n,r[mp]=l,t=(n.mode&1)!==0,s){case"dialog":Bn("cancel",r),Bn("close",r);break;case"iframe":case"object":case"embed":Bn("load",r);break;case"video":case"audio":for(i=0;i<Tm.length;i++)Bn(Tm[i],r);break;case"source":Bn("error",r);break;case"img":case"image":case"link":Bn("error",r),Bn("load",r);break;case"details":Bn("toggle",r);break;case"input":C5(r,l),Bn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Bn("invalid",r);break;case"textarea":k5(r,l),Bn("invalid",r)}uj(s,l),i=null;for(var o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="children"?typeof c=="string"?r.textContent!==c&&(l.suppressHydrationWarning!==!0&&d0(r.textContent,c,t),i=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(l.suppressHydrationWarning!==!0&&d0(r.textContent,c,t),i=["children",""+c]):rp.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Bn("scroll",r)}switch(s){case"input":n0(r),A5(r,l,!0);break;case"textarea":n0(r),E5(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=u1)}r=i,n.updateQueue=r,r!==null&&(n.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=y6(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(s,{is:r.is}):(t=o.createElement(s),s==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,s),t[jl]=n,t[mp]=r,U8(t,n,!1,!1),n.stateNode=t;e:{switch(o=fj(s,r),s){case"dialog":Bn("cancel",t),Bn("close",t),i=r;break;case"iframe":case"object":case"embed":Bn("load",t),i=r;break;case"video":case"audio":for(i=0;i<Tm.length;i++)Bn(Tm[i],t);i=r;break;case"source":Bn("error",t),i=r;break;case"img":case"image":case"link":Bn("error",t),Bn("load",t),i=r;break;case"details":Bn("toggle",t),i=r;break;case"input":C5(t,r),i=ij(t,r),Bn("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=as({},r,{value:void 0}),Bn("invalid",t);break;case"textarea":k5(t,r),i=cj(t,r),Bn("invalid",t);break;default:i=r}uj(s,i),c=i;for(l in c)if(c.hasOwnProperty(l)){var d=c[l];l==="style"?w6(t,d):l==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&b6(t,d)):l==="children"?typeof d=="string"?(s!=="textarea"||d!=="")&&ap(t,d):typeof d=="number"&&ap(t,""+d):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(rp.hasOwnProperty(l)?d!=null&&l==="onScroll"&&Bn("scroll",t):d!=null&&xC(t,l,d,o))}switch(s){case"input":n0(t),A5(t,r,!1);break;case"textarea":n0(t),E5(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Oc(r.value));break;case"select":t.multiple=!!r.multiple,l=r.value,l!=null?kf(t,!!r.multiple,l,!1):r.defaultValue!=null&&kf(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=u1)}switch(s){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Mr(n),null;case 6:if(t&&n.stateNode!=null)H8(t,n,t.memoizedProps,r);else{if(typeof r!="string"&&n.stateNode===null)throw Error(He(166));if(s=Pd(xp.current),Pd(Tl.current),u0(n)){if(r=n.stateNode,s=n.memoizedProps,r[jl]=n,(l=r.nodeValue!==s)&&(t=Ha,t!==null))switch(t.tag){case 3:d0(r.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&d0(r.nodeValue,s,(t.mode&1)!==0)}l&&(n.flags|=4)}else r=(s.nodeType===9?s:s.ownerDocument).createTextNode(r),r[jl]=n,n.stateNode=r}return Mr(n),null;case 13:if(zn(es),r=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Wn&&Ua!==null&&n.mode&1&&!(n.flags&128))o8(),Vf(),n.flags|=98560,l=!1;else if(l=u0(n),r!==null&&r.dehydrated!==null){if(t===null){if(!l)throw Error(He(318));if(l=n.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(He(317));l[jl]=n}else Vf(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Mr(n),l=!1}else Hi!==null&&(qj(Hi),Hi=null),l=!0;if(!l)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(n.child.flags|=8192,n.mode&1&&(t===null||es.current&1?Ks===0&&(Ks=3):ZC())),n.updateQueue!==null&&(n.flags|=4),Mr(n),null);case 4:return Wf(),Bj(t,n),t===null&&fp(n.stateNode.containerInfo),Mr(n),null;case 10:return DC(n.type._context),Mr(n),null;case 17:return va(n.type)&&f1(),Mr(n),null;case 19:if(zn(es),l=n.memoizedState,l===null)return Mr(n),null;if(r=(n.flags&128)!==0,o=l.rendering,o===null)if(r)om(l,!1);else{if(Ks!==0||t!==null&&t.flags&128)for(t=n.child;t!==null;){if(o=b1(t),o!==null){for(n.flags|=128,om(l,!1),r=o.updateQueue,r!==null&&(n.updateQueue=r,n.flags|=4),n.subtreeFlags=0,r=s,s=n.child;s!==null;)l=s,t=r,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,t=o.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return Dn(es,es.current&1|2),n.child}t=t.sibling}l.tail!==null&&vs()>Gf&&(n.flags|=128,r=!0,om(l,!1),n.lanes=4194304)}else{if(!r)if(t=b1(o),t!==null){if(n.flags|=128,r=!0,s=t.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),om(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!Wn)return Mr(n),null}else 2*vs()-l.renderingStartTime>Gf&&s!==1073741824&&(n.flags|=128,r=!0,om(l,!1),n.lanes=4194304);l.isBackwards?(o.sibling=n.child,n.child=o):(s=l.last,s!==null?s.sibling=o:n.child=o,l.last=o)}return l.tail!==null?(n=l.tail,l.rendering=n,l.tail=n.sibling,l.renderingStartTime=vs(),n.sibling=null,s=es.current,Dn(es,r?s&1|2:s&1),n):(Mr(n),null);case 22:case 23:return QC(),r=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(n.flags|=8192),r&&n.mode&1?Da&1073741824&&(Mr(n),n.subtreeFlags&6&&(n.flags|=8192)):Mr(n),null;case 24:return null;case 25:return null}throw Error(He(156,n.tag))}function WX(t,n){switch(IC(n),n.tag){case 1:return va(n.type)&&f1(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Wf(),zn(ba),zn(Hr),$C(),t=n.flags,t&65536&&!(t&128)?(n.flags=t&-65537|128,n):null;case 5:return FC(n),null;case 13:if(zn(es),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(He(340));Vf()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return zn(es),null;case 4:return Wf(),null;case 10:return DC(n.type._context),null;case 22:case 23:return QC(),null;case 24:return null;default:return null}}var m0=!1,Rr=!1,qX=typeof WeakSet=="function"?WeakSet:Set,ut=null;function xf(t,n){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(r){fs(t,n,r)}else s.current=null}function Fj(t,n,s){try{s()}catch(r){fs(t,n,r)}}var yT=!1;function GX(t,n){if(Nj=o1,t=Y6(),EC(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var i=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{s.nodeType,l.nodeType}catch{s=null;break e}var o=0,c=-1,d=-1,u=0,h=0,m=t,x=null;t:for(;;){for(var b;m!==s||i!==0&&m.nodeType!==3||(c=o+i),m!==l||r!==0&&m.nodeType!==3||(d=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(b=m.firstChild)!==null;)x=m,m=b;for(;;){if(m===t)break t;if(x===s&&++u===i&&(c=o),x===l&&++h===r&&(d=o),(b=m.nextSibling)!==null)break;m=x,x=m.parentNode}m=b}s=c===-1||d===-1?null:{start:c,end:d}}else s=null}s=s||{start:0,end:0}}else s=null;for(jj={focusedElem:t,selectionRange:s},o1=!1,ut=n;ut!==null;)if(n=ut,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,ut=t;else for(;ut!==null;){n=ut;try{var w=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var j=w.memoizedProps,S=w.memoizedState,C=n.stateNode,A=C.getSnapshotBeforeUpdate(n.elementType===n.type?j:zi(n.type,j),S);C.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var k=n.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(He(163))}}catch(T){fs(n,n.return,T)}if(t=n.sibling,t!==null){t.return=n.return,ut=t;break}ut=n.return}return w=yT,yT=!1,w}function Hm(t,n,s){var r=n.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var l=i.destroy;i.destroy=void 0,l!==void 0&&Fj(n,s,l)}i=i.next}while(i!==r)}}function db(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var r=s.create;s.destroy=r()}s=s.next}while(s!==n)}}function $j(t){var n=t.ref;if(n!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof n=="function"?n(t):n.current=t}}function W8(t){var n=t.alternate;n!==null&&(t.alternate=null,W8(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[jl],delete n[mp],delete n[Cj],delete n[EX],delete n[TX])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function q8(t){return t.tag===5||t.tag===3||t.tag===4}function bT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||q8(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zj(t,n,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(t,n):s.insertBefore(t,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(t,s)):(n=s,n.appendChild(t)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=u1));else if(r!==4&&(t=t.child,t!==null))for(zj(t,n,s),t=t.sibling;t!==null;)zj(t,n,s),t=t.sibling}function Uj(t,n,s){var r=t.tag;if(r===5||r===6)t=t.stateNode,n?s.insertBefore(t,n):s.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Uj(t,n,s),t=t.sibling;t!==null;)Uj(t,n,s),t=t.sibling}var wr=null,Ui=!1;function Xo(t,n,s){for(s=s.child;s!==null;)G8(t,n,s),s=s.sibling}function G8(t,n,s){if(El&&typeof El.onCommitFiberUnmount=="function")try{El.onCommitFiberUnmount(nb,s)}catch{}switch(s.tag){case 5:Rr||xf(s,n);case 6:var r=wr,i=Ui;wr=null,Xo(t,n,s),wr=r,Ui=i,wr!==null&&(Ui?(t=wr,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):wr.removeChild(s.stateNode));break;case 18:wr!==null&&(Ui?(t=wr,s=s.stateNode,t.nodeType===8?qw(t.parentNode,s):t.nodeType===1&&qw(t,s),cp(t)):qw(wr,s.stateNode));break;case 4:r=wr,i=Ui,wr=s.stateNode.containerInfo,Ui=!0,Xo(t,n,s),wr=r,Ui=i;break;case 0:case 11:case 14:case 15:if(!Rr&&(r=s.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var l=i,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&Fj(s,n,o),i=i.next}while(i!==r)}Xo(t,n,s);break;case 1:if(!Rr&&(xf(s,n),r=s.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=s.memoizedProps,r.state=s.memoizedState,r.componentWillUnmount()}catch(c){fs(s,n,c)}Xo(t,n,s);break;case 21:Xo(t,n,s);break;case 22:s.mode&1?(Rr=(r=Rr)||s.memoizedState!==null,Xo(t,n,s),Rr=r):Xo(t,n,s);break;default:Xo(t,n,s)}}function vT(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new qX),n.forEach(function(r){var i=nQ.bind(null,t,r);s.has(r)||(s.add(r),r.then(i,i))})}}function Li(t,n){var s=n.deletions;if(s!==null)for(var r=0;r<s.length;r++){var i=s[r];try{var l=t,o=n,c=o;e:for(;c!==null;){switch(c.tag){case 5:wr=c.stateNode,Ui=!1;break e;case 3:wr=c.stateNode.containerInfo,Ui=!0;break e;case 4:wr=c.stateNode.containerInfo,Ui=!0;break e}c=c.return}if(wr===null)throw Error(He(160));G8(l,o,i),wr=null,Ui=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(u){fs(i,n,u)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)K8(n,t),n=n.sibling}function K8(t,n){var s=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Li(n,t),pl(t),r&4){try{Hm(3,t,t.return),db(3,t)}catch(j){fs(t,t.return,j)}try{Hm(5,t,t.return)}catch(j){fs(t,t.return,j)}}break;case 1:Li(n,t),pl(t),r&512&&s!==null&&xf(s,s.return);break;case 5:if(Li(n,t),pl(t),r&512&&s!==null&&xf(s,s.return),t.flags&32){var i=t.stateNode;try{ap(i,"")}catch(j){fs(t,t.return,j)}}if(r&4&&(i=t.stateNode,i!=null)){var l=t.memoizedProps,o=s!==null?s.memoizedProps:l,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&l.type==="radio"&&l.name!=null&&x6(i,l),fj(c,o);var u=fj(c,l);for(o=0;o<d.length;o+=2){var h=d[o],m=d[o+1];h==="style"?w6(i,m):h==="dangerouslySetInnerHTML"?b6(i,m):h==="children"?ap(i,m):xC(i,h,m,u)}switch(c){case"input":lj(i,l);break;case"textarea":g6(i,l);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!l.multiple;var b=l.value;b!=null?kf(i,!!l.multiple,b,!1):x!==!!l.multiple&&(l.defaultValue!=null?kf(i,!!l.multiple,l.defaultValue,!0):kf(i,!!l.multiple,l.multiple?[]:"",!1))}i[mp]=l}catch(j){fs(t,t.return,j)}}break;case 6:if(Li(n,t),pl(t),r&4){if(t.stateNode===null)throw Error(He(162));i=t.stateNode,l=t.memoizedProps;try{i.nodeValue=l}catch(j){fs(t,t.return,j)}}break;case 3:if(Li(n,t),pl(t),r&4&&s!==null&&s.memoizedState.isDehydrated)try{cp(n.containerInfo)}catch(j){fs(t,t.return,j)}break;case 4:Li(n,t),pl(t);break;case 13:Li(n,t),pl(t),i=t.child,i.flags&8192&&(l=i.memoizedState!==null,i.stateNode.isHidden=l,!l||i.alternate!==null&&i.alternate.memoizedState!==null||(YC=vs())),r&4&&vT(t);break;case 22:if(h=s!==null&&s.memoizedState!==null,t.mode&1?(Rr=(u=Rr)||h,Li(n,t),Rr=u):Li(n,t),pl(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(ut=t,h=t.child;h!==null;){for(m=ut=h;ut!==null;){switch(x=ut,b=x.child,x.tag){case 0:case 11:case 14:case 15:Hm(4,x,x.return);break;case 1:xf(x,x.return);var w=x.stateNode;if(typeof w.componentWillUnmount=="function"){r=x,s=x.return;try{n=r,w.props=n.memoizedProps,w.state=n.memoizedState,w.componentWillUnmount()}catch(j){fs(r,s,j)}}break;case 5:xf(x,x.return);break;case 22:if(x.memoizedState!==null){NT(m);continue}}b!==null?(b.return=x,ut=b):NT(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{i=m.stateNode,u?(l=i.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(c=m.stateNode,d=m.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=v6("display",o))}catch(j){fs(t,t.return,j)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(j){fs(t,t.return,j)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Li(n,t),pl(t),r&4&&vT(t);break;case 21:break;default:Li(n,t),pl(t)}}function pl(t){var n=t.flags;if(n&2){try{e:{for(var s=t.return;s!==null;){if(q8(s)){var r=s;break e}s=s.return}throw Error(He(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ap(i,""),r.flags&=-33);var l=bT(t);Uj(t,l,i);break;case 3:case 4:var o=r.stateNode.containerInfo,c=bT(t);zj(t,c,o);break;default:throw Error(He(161))}}catch(d){fs(t,t.return,d)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function KX(t,n,s){ut=t,Y8(t)}function Y8(t,n,s){for(var r=(t.mode&1)!==0;ut!==null;){var i=ut,l=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||m0;if(!o){var c=i.alternate,d=c!==null&&c.memoizedState!==null||Rr;c=m0;var u=Rr;if(m0=o,(Rr=d)&&!u)for(ut=i;ut!==null;)o=ut,d=o.child,o.tag===22&&o.memoizedState!==null?jT(i):d!==null?(d.return=o,ut=d):jT(i);for(;l!==null;)ut=l,Y8(l),l=l.sibling;ut=i,m0=c,Rr=u}wT(t)}else i.subtreeFlags&8772&&l!==null?(l.return=i,ut=l):wT(t)}}function wT(t){for(;ut!==null;){var n=ut;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Rr||db(5,n);break;case 1:var r=n.stateNode;if(n.flags&4&&!Rr)if(s===null)r.componentDidMount();else{var i=n.elementType===n.type?s.memoizedProps:zi(n.type,s.memoizedProps);r.componentDidUpdate(i,s.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=n.updateQueue;l!==null&&aT(n,l,r);break;case 3:var o=n.updateQueue;if(o!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}aT(n,o,s)}break;case 5:var c=n.stateNode;if(s===null&&n.flags&4){s=c;var d=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&s.focus();break;case"img":d.src&&(s.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var u=n.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&cp(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(He(163))}Rr||n.flags&512&&$j(n)}catch(x){fs(n,n.return,x)}}if(n===t){ut=null;break}if(s=n.sibling,s!==null){s.return=n.return,ut=s;break}ut=n.return}}function NT(t){for(;ut!==null;){var n=ut;if(n===t){ut=null;break}var s=n.sibling;if(s!==null){s.return=n.return,ut=s;break}ut=n.return}}function jT(t){for(;ut!==null;){var n=ut;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{db(4,n)}catch(d){fs(n,s,d)}break;case 1:var r=n.stateNode;if(typeof r.componentDidMount=="function"){var i=n.return;try{r.componentDidMount()}catch(d){fs(n,i,d)}}var l=n.return;try{$j(n)}catch(d){fs(n,l,d)}break;case 5:var o=n.return;try{$j(n)}catch(d){fs(n,o,d)}}}catch(d){fs(n,n.return,d)}if(n===t){ut=null;break}var c=n.sibling;if(c!==null){c.return=n.return,ut=c;break}ut=n.return}}var YX=Math.ceil,N1=Do.ReactCurrentDispatcher,GC=Do.ReactCurrentOwner,wi=Do.ReactCurrentBatchConfig,an=0,lr=null,Es=null,Ar=0,Da=0,gf=Xc(0),Ks=0,vp=null,iu=0,ub=0,KC=0,Wm=null,ma=null,YC=0,Gf=1/0,ro=null,j1=!1,Vj=null,Cc=null,p0=!1,xc=null,S1=0,qm=0,Hj=null,Cg=-1,Ag=0;function sa(){return an&6?vs():Cg!==-1?Cg:Cg=vs()}function Ac(t){return t.mode&1?an&2&&Ar!==0?Ar&-Ar:PX.transition!==null?(Ag===0&&(Ag=M6()),Ag):(t=xn,t!==0||(t=window.event,t=t===void 0?16:$6(t.type)),t):1}function Xi(t,n,s,r){if(50<qm)throw qm=0,Hj=null,Error(He(185));dx(t,s,r),(!(an&2)||t!==lr)&&(t===lr&&(!(an&2)&&(ub|=s),Ks===4&&fc(t,Ar)),wa(t,r),s===1&&an===0&&!(n.mode&1)&&(Gf=vs()+500,lb&&Qc()))}function wa(t,n){var s=t.callbackNode;PY(t,n);var r=l1(t,t===lr?Ar:0);if(r===0)s!==null&&P5(s),t.callbackNode=null,t.callbackPriority=0;else if(n=r&-r,t.callbackPriority!==n){if(s!=null&&P5(s),n===1)t.tag===0?IX(ST.bind(null,t)):a8(ST.bind(null,t)),AX(function(){!(an&6)&&Qc()}),s=null;else{switch(O6(r)){case 1:s=wC;break;case 4:s=I6;break;case 16:s=i1;break;case 536870912:s=P6;break;default:s=i1}s=sL(s,X8.bind(null,t))}t.callbackPriority=n,t.callbackNode=s}}function X8(t,n){if(Cg=-1,Ag=0,an&6)throw Error(He(327));var s=t.callbackNode;if(Mf()&&t.callbackNode!==s)return null;var r=l1(t,t===lr?Ar:0);if(r===0)return null;if(r&30||r&t.expiredLanes||n)n=_1(t,r);else{n=r;var i=an;an|=2;var l=Z8();(lr!==t||Ar!==n)&&(ro=null,Gf=vs()+500,Ud(t,n));do try{ZX();break}catch(c){Q8(t,c)}while(!0);OC(),N1.current=l,an=i,Es!==null?n=0:(lr=null,Ar=0,n=Ks)}if(n!==0){if(n===2&&(i=gj(t),i!==0&&(r=i,n=Wj(t,i))),n===1)throw s=vp,Ud(t,0),fc(t,r),wa(t,vs()),s;if(n===6)fc(t,r);else{if(i=t.current.alternate,!(r&30)&&!XX(i)&&(n=_1(t,r),n===2&&(l=gj(t),l!==0&&(r=l,n=Wj(t,l))),n===1))throw s=vp,Ud(t,0),fc(t,r),wa(t,vs()),s;switch(t.finishedWork=i,t.finishedLanes=r,n){case 0:case 1:throw Error(He(345));case 2:bd(t,ma,ro);break;case 3:if(fc(t,r),(r&130023424)===r&&(n=YC+500-vs(),10<n)){if(l1(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){sa(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=_j(bd.bind(null,t,ma,ro),n);break}bd(t,ma,ro);break;case 4:if(fc(t,r),(r&4194240)===r)break;for(n=t.eventTimes,i=-1;0<r;){var o=31-Yi(r);l=1<<o,o=n[o],o>i&&(i=o),r&=~l}if(r=i,r=vs()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*YX(r/1960))-r,10<r){t.timeoutHandle=_j(bd.bind(null,t,ma,ro),r);break}bd(t,ma,ro);break;case 5:bd(t,ma,ro);break;default:throw Error(He(329))}}}return wa(t,vs()),t.callbackNode===s?X8.bind(null,t):null}function Wj(t,n){var s=Wm;return t.current.memoizedState.isDehydrated&&(Ud(t,n).flags|=256),t=_1(t,n),t!==2&&(n=ma,ma=s,n!==null&&qj(n)),t}function qj(t){ma===null?ma=t:ma.push.apply(ma,t)}function XX(t){for(var n=t;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var r=0;r<s.length;r++){var i=s[r],l=i.getSnapshot;i=i.value;try{if(!Qi(l(),i))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function fc(t,n){for(n&=~KC,n&=~ub,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var s=31-Yi(n),r=1<<s;t[s]=-1,n&=~r}}function ST(t){if(an&6)throw Error(He(327));Mf();var n=l1(t,0);if(!(n&1))return wa(t,vs()),null;var s=_1(t,n);if(t.tag!==0&&s===2){var r=gj(t);r!==0&&(n=r,s=Wj(t,r))}if(s===1)throw s=vp,Ud(t,0),fc(t,n),wa(t,vs()),s;if(s===6)throw Error(He(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,bd(t,ma,ro),wa(t,vs()),null}function XC(t,n){var s=an;an|=1;try{return t(n)}finally{an=s,an===0&&(Gf=vs()+500,lb&&Qc())}}function lu(t){xc!==null&&xc.tag===0&&!(an&6)&&Mf();var n=an;an|=1;var s=wi.transition,r=xn;try{if(wi.transition=null,xn=1,t)return t()}finally{xn=r,wi.transition=s,an=n,!(an&6)&&Qc()}}function QC(){Da=gf.current,zn(gf)}function Ud(t,n){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,CX(s)),Es!==null)for(s=Es.return;s!==null;){var r=s;switch(IC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&f1();break;case 3:Wf(),zn(ba),zn(Hr),$C();break;case 5:FC(r);break;case 4:Wf();break;case 13:zn(es);break;case 19:zn(es);break;case 10:DC(r.type._context);break;case 22:case 23:QC()}s=s.return}if(lr=t,Es=t=kc(t.current,null),Ar=Da=n,Ks=0,vp=null,KC=ub=iu=0,ma=Wm=null,Id!==null){for(n=0;n<Id.length;n++)if(s=Id[n],r=s.interleaved,r!==null){s.interleaved=null;var i=r.next,l=s.pending;if(l!==null){var o=l.next;l.next=i,r.next=o}s.pending=r}Id=null}return t}function Q8(t,n){do{var s=Es;try{if(OC(),jg.current=w1,v1){for(var r=ss.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}v1=!1}if(au=0,ir=Us=ss=null,Vm=!1,gp=0,GC.current=null,s===null||s.return===null){Ks=1,vp=n,Es=null;break}e:{var l=t,o=s.return,c=s,d=n;if(n=Ar,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,h=c,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var x=h.alternate;x?(h.updateQueue=x.updateQueue,h.memoizedState=x.memoizedState,h.lanes=x.lanes):(h.updateQueue=null,h.memoizedState=null)}var b=uT(o);if(b!==null){b.flags&=-257,fT(b,o,c,l,n),b.mode&1&&dT(l,u,n),n=b,d=u;var w=n.updateQueue;if(w===null){var j=new Set;j.add(d),n.updateQueue=j}else w.add(d);break e}else{if(!(n&1)){dT(l,u,n),ZC();break e}d=Error(He(426))}}else if(Wn&&c.mode&1){var S=uT(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),fT(S,o,c,l,n),PC(qf(d,c));break e}}l=d=qf(d,c),Ks!==4&&(Ks=2),Wm===null?Wm=[l]:Wm.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,n&=-n,l.lanes|=n;var C=O8(l,d,n);rT(l,C);break e;case 1:c=d;var A=l.type,k=l.stateNode;if(!(l.flags&128)&&(typeof A.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Cc===null||!Cc.has(k)))){l.flags|=65536,n&=-n,l.lanes|=n;var T=D8(l,c,n);rT(l,T);break e}}l=l.return}while(l!==null)}eL(s)}catch(I){n=I,Es===s&&s!==null&&(Es=s=s.return);continue}break}while(!0)}function Z8(){var t=N1.current;return N1.current=w1,t===null?w1:t}function ZC(){(Ks===0||Ks===3||Ks===2)&&(Ks=4),lr===null||!(iu&268435455)&&!(ub&268435455)||fc(lr,Ar)}function _1(t,n){var s=an;an|=2;var r=Z8();(lr!==t||Ar!==n)&&(ro=null,Ud(t,n));do try{QX();break}catch(i){Q8(t,i)}while(!0);if(OC(),an=s,N1.current=r,Es!==null)throw Error(He(261));return lr=null,Ar=0,Ks}function QX(){for(;Es!==null;)J8(Es)}function ZX(){for(;Es!==null&&!jY();)J8(Es)}function J8(t){var n=nL(t.alternate,t,Da);t.memoizedProps=t.pendingProps,n===null?eL(t):Es=n,GC.current=null}function eL(t){var n=t;do{var s=n.alternate;if(t=n.return,n.flags&32768){if(s=WX(s,n),s!==null){s.flags&=32767,Es=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ks=6,Es=null;return}}else if(s=HX(s,n,Da),s!==null){Es=s;return}if(n=n.sibling,n!==null){Es=n;return}Es=n=t}while(n!==null);Ks===0&&(Ks=5)}function bd(t,n,s){var r=xn,i=wi.transition;try{wi.transition=null,xn=1,JX(t,n,s,r)}finally{wi.transition=i,xn=r}return null}function JX(t,n,s,r){do Mf();while(xc!==null);if(an&6)throw Error(He(327));s=t.finishedWork;var i=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(He(177));t.callbackNode=null,t.callbackPriority=0;var l=s.lanes|s.childLanes;if(MY(t,l),t===lr&&(Es=lr=null,Ar=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||p0||(p0=!0,sL(i1,function(){return Mf(),null})),l=(s.flags&15990)!==0,s.subtreeFlags&15990||l){l=wi.transition,wi.transition=null;var o=xn;xn=1;var c=an;an|=4,GC.current=null,GX(t,s),K8(s,t),bX(jj),o1=!!Nj,jj=Nj=null,t.current=s,KX(s),SY(),an=c,xn=o,wi.transition=l}else t.current=s;if(p0&&(p0=!1,xc=t,S1=i),l=t.pendingLanes,l===0&&(Cc=null),AY(s.stateNode),wa(t,vs()),n!==null)for(r=t.onRecoverableError,s=0;s<n.length;s++)i=n[s],r(i.value,{componentStack:i.stack,digest:i.digest});if(j1)throw j1=!1,t=Vj,Vj=null,t;return S1&1&&t.tag!==0&&Mf(),l=t.pendingLanes,l&1?t===Hj?qm++:(qm=0,Hj=t):qm=0,Qc(),null}function Mf(){if(xc!==null){var t=O6(S1),n=wi.transition,s=xn;try{if(wi.transition=null,xn=16>t?16:t,xc===null)var r=!1;else{if(t=xc,xc=null,S1=0,an&6)throw Error(He(331));var i=an;for(an|=4,ut=t.current;ut!==null;){var l=ut,o=l.child;if(ut.flags&16){var c=l.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(ut=u;ut!==null;){var h=ut;switch(h.tag){case 0:case 11:case 15:Hm(8,h,l)}var m=h.child;if(m!==null)m.return=h,ut=m;else for(;ut!==null;){h=ut;var x=h.sibling,b=h.return;if(W8(h),h===u){ut=null;break}if(x!==null){x.return=b,ut=x;break}ut=b}}}var w=l.alternate;if(w!==null){var j=w.child;if(j!==null){w.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}ut=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,ut=o;else e:for(;ut!==null;){if(l=ut,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Hm(9,l,l.return)}var C=l.sibling;if(C!==null){C.return=l.return,ut=C;break e}ut=l.return}}var A=t.current;for(ut=A;ut!==null;){o=ut;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,ut=k;else e:for(o=A;ut!==null;){if(c=ut,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:db(9,c)}}catch(I){fs(c,c.return,I)}if(c===o){ut=null;break e}var T=c.sibling;if(T!==null){T.return=c.return,ut=T;break e}ut=c.return}}if(an=i,Qc(),El&&typeof El.onPostCommitFiberRoot=="function")try{El.onPostCommitFiberRoot(nb,t)}catch{}r=!0}return r}finally{xn=s,wi.transition=n}}return!1}function _T(t,n,s){n=qf(s,n),n=O8(t,n,1),t=_c(t,n,1),n=sa(),t!==null&&(dx(t,1,n),wa(t,n))}function fs(t,n,s){if(t.tag===3)_T(t,t,s);else for(;n!==null;){if(n.tag===3){_T(n,t,s);break}else if(n.tag===1){var r=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cc===null||!Cc.has(r))){t=qf(s,t),t=D8(n,t,1),n=_c(n,t,1),t=sa(),n!==null&&(dx(n,1,t),wa(n,t));break}}n=n.return}}function eQ(t,n,s){var r=t.pingCache;r!==null&&r.delete(n),n=sa(),t.pingedLanes|=t.suspendedLanes&s,lr===t&&(Ar&s)===s&&(Ks===4||Ks===3&&(Ar&130023424)===Ar&&500>vs()-YC?Ud(t,0):KC|=s),wa(t,n)}function tL(t,n){n===0&&(t.mode&1?(n=a0,a0<<=1,!(a0&130023424)&&(a0=4194304)):n=1);var s=sa();t=vo(t,n),t!==null&&(dx(t,n,s),wa(t,s))}function tQ(t){var n=t.memoizedState,s=0;n!==null&&(s=n.retryLane),tL(t,s)}function nQ(t,n){var s=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(s=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(He(314))}r!==null&&r.delete(n),tL(t,s)}var nL;nL=function(t,n,s){if(t!==null)if(t.memoizedProps!==n.pendingProps||ba.current)xa=!0;else{if(!(t.lanes&s)&&!(n.flags&128))return xa=!1,VX(t,n,s);xa=!!(t.flags&131072)}else xa=!1,Wn&&n.flags&1048576&&i8(n,p1,n.index);switch(n.lanes=0,n.tag){case 2:var r=n.type;_g(t,n),t=n.pendingProps;var i=Uf(n,Hr.current);Pf(n,s),i=UC(null,n,r,t,i,s);var l=VC();return n.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,va(r)?(l=!0,h1(n)):l=!1,n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,LC(n),i.updater=cb,n.stateNode=i,i._reactInternals=n,Pj(n,r,t,s),n=Dj(null,n,r,!0,l,s)):(n.tag=0,Wn&&l&&TC(n),Qr(null,n,i,s),n=n.child),n;case 16:r=n.elementType;e:{switch(_g(t,n),t=n.pendingProps,i=r._init,r=i(r._payload),n.type=r,i=n.tag=rQ(r),t=zi(r,t),i){case 0:n=Oj(null,n,r,t,s);break e;case 1:n=pT(null,n,r,t,s);break e;case 11:n=hT(null,n,r,t,s);break e;case 14:n=mT(null,n,r,zi(r.type,t),s);break e}throw Error(He(306,r,""))}return n;case 0:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:zi(r,i),Oj(t,n,r,i,s);case 1:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:zi(r,i),pT(t,n,r,i,s);case 3:e:{if(F8(n),t===null)throw Error(He(387));r=n.pendingProps,l=n.memoizedState,i=l.element,f8(t,n),y1(n,r,null,s);var o=n.memoizedState;if(r=o.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},n.updateQueue.baseState=l,n.memoizedState=l,n.flags&256){i=qf(Error(He(423)),n),n=xT(t,n,r,s,i);break e}else if(r!==i){i=qf(Error(He(424)),n),n=xT(t,n,r,s,i);break e}else for(Ua=Sc(n.stateNode.containerInfo.firstChild),Ha=n,Wn=!0,Hi=null,s=d8(n,null,r,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Vf(),r===i){n=wo(t,n,s);break e}Qr(t,n,r,s)}n=n.child}return n;case 5:return h8(n),t===null&&Ej(n),r=n.type,i=n.pendingProps,l=t!==null?t.memoizedProps:null,o=i.children,Sj(r,i)?o=null:l!==null&&Sj(r,l)&&(n.flags|=32),B8(t,n),Qr(t,n,o,s),n.child;case 6:return t===null&&Ej(n),null;case 13:return $8(t,n,s);case 4:return BC(n,n.stateNode.containerInfo),r=n.pendingProps,t===null?n.child=Hf(n,null,r,s):Qr(t,n,r,s),n.child;case 11:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:zi(r,i),hT(t,n,r,i,s);case 7:return Qr(t,n,n.pendingProps,s),n.child;case 8:return Qr(t,n,n.pendingProps.children,s),n.child;case 12:return Qr(t,n,n.pendingProps.children,s),n.child;case 10:e:{if(r=n.type._context,i=n.pendingProps,l=n.memoizedProps,o=i.value,Dn(x1,r._currentValue),r._currentValue=o,l!==null)if(Qi(l.value,o)){if(l.children===i.children&&!ba.current){n=wo(t,n,s);break e}}else for(l=n.child,l!==null&&(l.return=n);l!==null;){var c=l.dependencies;if(c!==null){o=l.child;for(var d=c.firstContext;d!==null;){if(d.context===r){if(l.tag===1){d=po(-1,s&-s),d.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?d.next=d:(d.next=h.next,h.next=d),u.pending=d}}l.lanes|=s,d=l.alternate,d!==null&&(d.lanes|=s),Tj(l.return,s,n),c.lanes|=s;break}d=d.next}}else if(l.tag===10)o=l.type===n.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(He(341));o.lanes|=s,c=o.alternate,c!==null&&(c.lanes|=s),Tj(o,s,n),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===n){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}Qr(t,n,i.children,s),n=n.child}return n;case 9:return i=n.type,r=n.pendingProps.children,Pf(n,s),i=_i(i),r=r(i),n.flags|=1,Qr(t,n,r,s),n.child;case 14:return r=n.type,i=zi(r,n.pendingProps),i=zi(r.type,i),mT(t,n,r,i,s);case 15:return R8(t,n,n.type,n.pendingProps,s);case 17:return r=n.type,i=n.pendingProps,i=n.elementType===r?i:zi(r,i),_g(t,n),n.tag=1,va(r)?(t=!0,h1(n)):t=!1,Pf(n,s),M8(n,r,i),Pj(n,r,i,s),Dj(null,n,r,!0,t,s);case 19:return z8(t,n,s);case 22:return L8(t,n,s)}throw Error(He(156,n.tag))};function sL(t,n){return T6(t,n)}function sQ(t,n,s,r){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yi(t,n,s,r){return new sQ(t,n,s,r)}function JC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rQ(t){if(typeof t=="function")return JC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===yC)return 11;if(t===bC)return 14}return 2}function kc(t,n){var s=t.alternate;return s===null?(s=yi(t.tag,n,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=n,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,n=t.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function kg(t,n,s,r,i,l){var o=2;if(r=t,typeof t=="function")JC(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case lf:return Vd(s.children,i,l,n);case gC:o=8,i|=8;break;case nj:return t=yi(12,s,n,i|2),t.elementType=nj,t.lanes=l,t;case sj:return t=yi(13,s,n,i),t.elementType=sj,t.lanes=l,t;case rj:return t=yi(19,s,n,i),t.elementType=rj,t.lanes=l,t;case h6:return fb(s,i,l,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case u6:o=10;break e;case f6:o=9;break e;case yC:o=11;break e;case bC:o=14;break e;case ac:o=16,r=null;break e}throw Error(He(130,t==null?t:typeof t,""))}return n=yi(o,s,n,i),n.elementType=t,n.type=r,n.lanes=l,n}function Vd(t,n,s,r){return t=yi(7,t,r,n),t.lanes=s,t}function fb(t,n,s,r){return t=yi(22,t,r,n),t.elementType=h6,t.lanes=s,t.stateNode={isHidden:!1},t}function eN(t,n,s){return t=yi(6,t,null,n),t.lanes=s,t}function tN(t,n,s){return n=yi(4,t.children!==null?t.children:[],t.key,n),n.lanes=s,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function aQ(t,n,s,r,i){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dw(0),this.expirationTimes=Dw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dw(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function e3(t,n,s,r,i,l,o,c,d){return t=new aQ(t,n,s,c,d),n===1?(n=1,l===!0&&(n|=8)):n=0,l=yi(3,null,null,n),t.current=l,l.stateNode=t,l.memoizedState={element:r,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},LC(l),t}function iQ(t,n,s){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:af,key:r==null?null:""+r,children:t,containerInfo:n,implementation:s}}function rL(t){if(!t)return Dc;t=t._reactInternals;e:{if(Eu(t)!==t||t.tag!==1)throw Error(He(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(va(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(He(171))}if(t.tag===1){var s=t.type;if(va(s))return r8(t,s,n)}return n}function aL(t,n,s,r,i,l,o,c,d){return t=e3(s,r,!0,t,i,l,o,c,d),t.context=rL(null),s=t.current,r=sa(),i=Ac(s),l=po(r,i),l.callback=n??null,_c(s,l,i),t.current.lanes=i,dx(t,i,r),wa(t,r),t}function hb(t,n,s,r){var i=n.current,l=sa(),o=Ac(i);return s=rL(s),n.context===null?n.context=s:n.pendingContext=s,n=po(l,o),n.payload={element:t},r=r===void 0?null:r,r!==null&&(n.callback=r),t=_c(i,n,o),t!==null&&(Xi(t,i,o,l),Ng(t,i,o)),o}function C1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function CT(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<n?s:n}}function t3(t,n){CT(t,n),(t=t.alternate)&&CT(t,n)}function lQ(){return null}var iL=typeof reportError=="function"?reportError:function(t){console.error(t)};function n3(t){this._internalRoot=t}mb.prototype.render=n3.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(He(409));hb(t,n,null,null)};mb.prototype.unmount=n3.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;lu(function(){hb(null,t,null,null)}),n[bo]=null}};function mb(t){this._internalRoot=t}mb.prototype.unstable_scheduleHydration=function(t){if(t){var n=L6();t={blockedOn:null,target:t,priority:n};for(var s=0;s<uc.length&&n!==0&&n<uc[s].priority;s++);uc.splice(s,0,t),s===0&&F6(t)}};function s3(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function AT(){}function oQ(t,n,s,r,i){if(i){if(typeof r=="function"){var l=r;r=function(){var u=C1(o);l.call(u)}}var o=aL(n,r,t,0,null,!1,!1,"",AT);return t._reactRootContainer=o,t[bo]=o.current,fp(t.nodeType===8?t.parentNode:t),lu(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var c=r;r=function(){var u=C1(d);c.call(u)}}var d=e3(t,0,!1,null,null,!1,!1,"",AT);return t._reactRootContainer=d,t[bo]=d.current,fp(t.nodeType===8?t.parentNode:t),lu(function(){hb(n,d,s,r)}),d}function xb(t,n,s,r,i){var l=s._reactRootContainer;if(l){var o=l;if(typeof i=="function"){var c=i;i=function(){var d=C1(o);c.call(d)}}hb(n,o,t,i)}else o=oQ(s,n,t,i,r);return C1(o)}D6=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var s=Em(n.pendingLanes);s!==0&&(NC(n,s|1),wa(n,vs()),!(an&6)&&(Gf=vs()+500,Qc()))}break;case 13:lu(function(){var r=vo(t,1);if(r!==null){var i=sa();Xi(r,t,1,i)}}),t3(t,1)}};jC=function(t){if(t.tag===13){var n=vo(t,134217728);if(n!==null){var s=sa();Xi(n,t,134217728,s)}t3(t,134217728)}};R6=function(t){if(t.tag===13){var n=Ac(t),s=vo(t,n);if(s!==null){var r=sa();Xi(s,t,n,r)}t3(t,n)}};L6=function(){return xn};B6=function(t,n){var s=xn;try{return xn=t,n()}finally{xn=s}};mj=function(t,n,s){switch(n){case"input":if(lj(t,s),n=s.name,s.type==="radio"&&n!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var r=s[n];if(r!==t&&r.form===t.form){var i=ib(r);if(!i)throw Error(He(90));p6(r),lj(r,i)}}}break;case"textarea":g6(t,s);break;case"select":n=s.value,n!=null&&kf(t,!!s.multiple,n,!1)}};S6=XC;_6=lu;var cQ={usingClientEntryPoint:!1,Events:[fx,uf,ib,N6,j6,XC]},cm={findFiberByHostInstance:Td,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dQ={bundleType:cm.bundleType,version:cm.version,rendererPackageName:cm.rendererPackageName,rendererConfig:cm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Do.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=k6(t),t===null?null:t.stateNode},findFiberByHostInstance:cm.findFiberByHostInstance||lQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x0.isDisabled&&x0.supportsFiber)try{nb=x0.inject(dQ),El=x0}catch{}}Ja.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cQ;Ja.createPortal=function(t,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!s3(n))throw Error(He(200));return iQ(t,n,null,s)};Ja.createRoot=function(t,n){if(!s3(t))throw Error(He(299));var s=!1,r="",i=iL;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),n=e3(t,1,!1,null,null,s,!1,r,i),t[bo]=n.current,fp(t.nodeType===8?t.parentNode:t),new n3(n)};Ja.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(He(188)):(t=Object.keys(t).join(","),Error(He(268,t)));return t=k6(n),t=t===null?null:t.stateNode,t};Ja.flushSync=function(t){return lu(t)};Ja.hydrate=function(t,n,s){if(!pb(n))throw Error(He(200));return xb(null,t,n,!0,s)};Ja.hydrateRoot=function(t,n,s){if(!s3(t))throw Error(He(405));var r=s!=null&&s.hydratedSources||null,i=!1,l="",o=iL;if(s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(l=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),n=aL(n,null,t,1,s??null,i,!1,l,o),t[bo]=n.current,fp(t),r)for(t=0;t<r.length;t++)s=r[t],i=s._getVersion,i=i(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,i]:n.mutableSourceEagerHydrationData.push(s,i);return new mb(n)};Ja.render=function(t,n,s){if(!pb(n))throw Error(He(200));return xb(null,t,n,!1,s)};Ja.unmountComponentAtNode=function(t){if(!pb(t))throw Error(He(40));return t._reactRootContainer?(lu(function(){xb(null,null,t,!1,function(){t._reactRootContainer=null,t[bo]=null})}),!0):!1};Ja.unstable_batchedUpdates=XC;Ja.unstable_renderSubtreeIntoContainer=function(t,n,s,r){if(!pb(s))throw Error(He(200));if(t==null||t._reactInternals===void 0)throw Error(He(38));return xb(t,n,s,!1,r)};Ja.version="18.3.1-next-f1338f8080-20240426";function lL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lL)}catch(t){console.error(t)}}lL(),l6.exports=Ja;var Zc=l6.exports;const oL=Ii(Zc);var kT=Zc;ej.createRoot=kT.createRoot,ej.hydrateRoot=kT.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wp(){return wp=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},wp.apply(this,arguments)}var gc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gc||(gc={}));const ET="popstate";function uQ(t){t===void 0&&(t={});function n(r,i){let{pathname:l,search:o,hash:c}=r.location;return Gj("",{pathname:l,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(r,i){return typeof i=="string"?i:A1(i)}return hQ(n,s,null,t)}function rs(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function cL(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function fQ(){return Math.random().toString(36).substr(2,8)}function TT(t,n){return{usr:t.state,key:t.key,idx:n}}function Gj(t,n,s,r){return s===void 0&&(s=null),wp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof n=="string"?yh(n):n,{state:s,key:n&&n.key||r||fQ()})}function A1(t){let{pathname:n="/",search:s="",hash:r=""}=t;return s&&s!=="?"&&(n+=s.charAt(0)==="?"?s:"?"+s),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function yh(t){let n={};if(t){let s=t.indexOf("#");s>=0&&(n.hash=t.substr(s),t=t.substr(0,s));let r=t.indexOf("?");r>=0&&(n.search=t.substr(r),t=t.substr(0,r)),t&&(n.pathname=t)}return n}function hQ(t,n,s,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:l=!1}=r,o=i.history,c=gc.Pop,d=null,u=h();u==null&&(u=0,o.replaceState(wp({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function m(){c=gc.Pop;let S=h(),C=S==null?null:S-u;u=S,d&&d({action:c,location:j.location,delta:C})}function x(S,C){c=gc.Push;let A=Gj(j.location,S,C);u=h()+1;let k=TT(A,u),T=j.createHref(A);try{o.pushState(k,"",T)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;i.location.assign(T)}l&&d&&d({action:c,location:j.location,delta:1})}function b(S,C){c=gc.Replace;let A=Gj(j.location,S,C);u=h();let k=TT(A,u),T=j.createHref(A);o.replaceState(k,"",T),l&&d&&d({action:c,location:j.location,delta:0})}function w(S){let C=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof S=="string"?S:A1(S);return A=A.replace(/ $/,"%20"),rs(C,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,C)}let j={get action(){return c},get location(){return t(i,o)},listen(S){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(ET,m),d=S,()=>{i.removeEventListener(ET,m),d=null}},createHref(S){return n(i,S)},createURL:w,encodeLocation(S){let C=w(S);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:b,go(S){return o.go(S)}};return j}var IT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(IT||(IT={}));function mQ(t,n,s){return s===void 0&&(s="/"),pQ(t,n,s)}function pQ(t,n,s,r){let i=typeof n=="string"?yh(n):n,l=Kf(i.pathname||"/",s);if(l==null)return null;let o=dL(t);xQ(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=AQ(l);c=_Q(o[d],u)}return c}function dL(t,n,s,r){n===void 0&&(n=[]),s===void 0&&(s=[]),r===void 0&&(r="");let i=(l,o,c)=>{let d={relativePath:c===void 0?l.path||"":c,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};d.relativePath.startsWith("/")&&(rs(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let u=Ec([r,d.relativePath]),h=s.concat(d);l.children&&l.children.length>0&&(rs(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),dL(l.children,n,h,u)),!(l.path==null&&!l.index)&&n.push({path:u,score:jQ(u,l.index),routesMeta:h})};return t.forEach((l,o)=>{var c;if(l.path===""||!((c=l.path)!=null&&c.includes("?")))i(l,o);else for(let d of uL(l.path))i(l,o,d)}),n}function uL(t){let n=t.split("/");if(n.length===0)return[];let[s,...r]=n,i=s.endsWith("?"),l=s.replace(/\?$/,"");if(r.length===0)return i?[l,""]:[l];let o=uL(r.join("/")),c=[];return c.push(...o.map(d=>d===""?l:[l,d].join("/"))),i&&c.push(...o),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function xQ(t){t.sort((n,s)=>n.score!==s.score?s.score-n.score:SQ(n.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}const gQ=/^:[\w-]+$/,yQ=3,bQ=2,vQ=1,wQ=10,NQ=-2,PT=t=>t==="*";function jQ(t,n){let s=t.split("/"),r=s.length;return s.some(PT)&&(r+=NQ),n&&(r+=bQ),s.filter(i=>!PT(i)).reduce((i,l)=>i+(gQ.test(l)?yQ:l===""?vQ:wQ),r)}function SQ(t,n){return t.length===n.length&&t.slice(0,-1).every((r,i)=>r===n[i])?t[t.length-1]-n[n.length-1]:0}function _Q(t,n,s){let{routesMeta:r}=t,i={},l="/",o=[];for(let c=0;c<r.length;++c){let d=r[c],u=c===r.length-1,h=l==="/"?n:n.slice(l.length)||"/",m=Kj({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),x=d.route;if(!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:Ec([l,m.pathname]),pathnameBase:IQ(Ec([l,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(l=Ec([l,m.pathnameBase]))}return o}function Kj(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=CQ(t.path,t.caseSensitive,t.end),i=n.match(s);if(!i)return null;let l=i[0],o=l.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((u,h,m)=>{let{paramName:x,isOptional:b}=h;if(x==="*"){let j=c[m]||"";o=l.slice(0,l.length-j.length).replace(/(.)\/+$/,"$1")}const w=c[m];return b&&!w?u[x]=void 0:u[x]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:l,pathnameBase:o,pattern:t}}function CQ(t,n,s){n===void 0&&(n=!1),s===void 0&&(s=!0),cL(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,n?void 0:"i"),r]}function AQ(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return cL(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),t}}function Kf(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}function kQ(t,n){n===void 0&&(n="/");let{pathname:s,search:r="",hash:i=""}=typeof t=="string"?yh(t):t;return{pathname:s?s.startsWith("/")?s:EQ(s,n):n,search:PQ(r),hash:MQ(i)}}function EQ(t,n){let s=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function nN(t,n,s,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function TQ(t){return t.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function r3(t,n){let s=TQ(t);return n?s.map((r,i)=>i===s.length-1?r.pathname:r.pathnameBase):s.map(r=>r.pathnameBase)}function a3(t,n,s,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=yh(t):(i=wp({},t),rs(!i.pathname||!i.pathname.includes("?"),nN("?","pathname","search",i)),rs(!i.pathname||!i.pathname.includes("#"),nN("#","pathname","hash",i)),rs(!i.search||!i.search.includes("#"),nN("#","search","hash",i)));let l=t===""||i.pathname==="",o=l?"/":i.pathname,c;if(o==null)c=s;else{let m=n.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),m-=1;i.pathname=x.join("/")}c=m>=0?n[m]:"/"}let d=kQ(i,c),u=o&&o!=="/"&&o.endsWith("/"),h=(l||o===".")&&s.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}const Ec=t=>t.join("/").replace(/\/\/+/g,"/"),IQ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),PQ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,MQ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function OQ(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const fL=["post","put","patch","delete"];new Set(fL);const DQ=["get",...fL];new Set(DQ);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Np(){return Np=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Np.apply(this,arguments)}const gb=y.createContext(null),hL=y.createContext(null),Ro=y.createContext(null),yb=y.createContext(null),Vl=y.createContext({outlet:null,matches:[],isDataRoute:!1}),mL=y.createContext(null);function RQ(t,n){let{relative:s}=n===void 0?{}:n;bh()||rs(!1);let{basename:r,navigator:i}=y.useContext(Ro),{hash:l,pathname:o,search:c}=bb(t,{relative:s}),d=o;return r!=="/"&&(d=o==="/"?r:Ec([r,o])),i.createHref({pathname:d,search:c,hash:l})}function bh(){return y.useContext(yb)!=null}function sl(){return bh()||rs(!1),y.useContext(yb).location}function pL(t){y.useContext(Ro).static||y.useLayoutEffect(t)}function Aa(){let{isDataRoute:t}=y.useContext(Vl);return t?QQ():LQ()}function LQ(){bh()||rs(!1);let t=y.useContext(gb),{basename:n,future:s,navigator:r}=y.useContext(Ro),{matches:i}=y.useContext(Vl),{pathname:l}=sl(),o=JSON.stringify(r3(i,s.v7_relativeSplatPath)),c=y.useRef(!1);return pL(()=>{c.current=!0}),y.useCallback(function(u,h){if(h===void 0&&(h={}),!c.current)return;if(typeof u=="number"){r.go(u);return}let m=a3(u,JSON.parse(o),l,h.relative==="path");t==null&&n!=="/"&&(m.pathname=m.pathname==="/"?n:Ec([n,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[n,r,o,l,t])}const BQ=y.createContext(null);function FQ(t){let n=y.useContext(Vl).outlet;return n&&y.createElement(BQ.Provider,{value:t},n)}function Tu(){let{matches:t}=y.useContext(Vl),n=t[t.length-1];return n?n.params:{}}function bb(t,n){let{relative:s}=n===void 0?{}:n,{future:r}=y.useContext(Ro),{matches:i}=y.useContext(Vl),{pathname:l}=sl(),o=JSON.stringify(r3(i,r.v7_relativeSplatPath));return y.useMemo(()=>a3(t,JSON.parse(o),l,s==="path"),[t,o,l,s])}function $Q(t,n){return zQ(t,n)}function zQ(t,n,s,r){bh()||rs(!1);let{navigator:i}=y.useContext(Ro),{matches:l}=y.useContext(Vl),o=l[l.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=sl(),h;if(n){var m;let S=typeof n=="string"?yh(n):n;d==="/"||(m=S.pathname)!=null&&m.startsWith(d)||rs(!1),h=S}else h=u;let x=h.pathname||"/",b=x;if(d!=="/"){let S=d.replace(/^\//,"").split("/");b="/"+x.replace(/^\//,"").split("/").slice(S.length).join("/")}let w=mQ(t,{pathname:b}),j=qQ(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},c,S.params),pathname:Ec([d,i.encodeLocation?i.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?d:Ec([d,i.encodeLocation?i.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),l,s,r);return n&&j?y.createElement(yb.Provider,{value:{location:Np({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:gc.Pop}},j):j}function UQ(){let t=XQ(),n=OQ(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},n),s?y.createElement("pre",{style:i},s):null,null)}const VQ=y.createElement(UQ,null);class HQ extends y.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,s){return s.location!==n.location||s.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:s.error,location:s.location,revalidation:n.revalidation||s.revalidation}}componentDidCatch(n,s){console.error("React Router caught the following error during render",n,s)}render(){return this.state.error!==void 0?y.createElement(Vl.Provider,{value:this.props.routeContext},y.createElement(mL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function WQ(t){let{routeContext:n,match:s,children:r}=t,i=y.useContext(gb);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),y.createElement(Vl.Provider,{value:n},r)}function qQ(t,n,s,r){var i;if(n===void 0&&(n=[]),s===void 0&&(s=null),r===void 0&&(r=null),t==null){var l;if(!s)return null;if(s.errors)t=s.matches;else if((l=r)!=null&&l.v7_partialHydration&&n.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let o=t,c=(i=s)==null?void 0:i.errors;if(c!=null){let h=o.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);h>=0||rs(!1),o=o.slice(0,Math.min(o.length,h+1))}let d=!1,u=-1;if(s&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let m=o[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=h),m.route.id){let{loaderData:x,errors:b}=s,w=m.route.loader&&x[m.route.id]===void 0&&(!b||b[m.route.id]===void 0);if(m.route.lazy||w){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,m,x)=>{let b,w=!1,j=null,S=null;s&&(b=c&&m.route.id?c[m.route.id]:void 0,j=m.route.errorElement||VQ,d&&(u<0&&x===0?(ZQ("route-fallback"),w=!0,S=null):u===x&&(w=!0,S=m.route.hydrateFallbackElement||null)));let C=n.concat(o.slice(0,x+1)),A=()=>{let k;return b?k=j:w?k=S:m.route.Component?k=y.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=h,y.createElement(WQ,{match:m,routeContext:{outlet:h,matches:C,isDataRoute:s!=null},children:k})};return s&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?y.createElement(HQ,{location:s.location,revalidation:s.revalidation,component:j,error:b,children:A(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):A()},null)}var xL=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(xL||{}),gL=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(gL||{});function GQ(t){let n=y.useContext(gb);return n||rs(!1),n}function KQ(t){let n=y.useContext(hL);return n||rs(!1),n}function YQ(t){let n=y.useContext(Vl);return n||rs(!1),n}function yL(t){let n=YQ(),s=n.matches[n.matches.length-1];return s.route.id||rs(!1),s.route.id}function XQ(){var t;let n=y.useContext(mL),s=KQ(),r=yL();return n!==void 0?n:(t=s.errors)==null?void 0:t[r]}function QQ(){let{router:t}=GQ(xL.UseNavigateStable),n=yL(gL.UseNavigateStable),s=y.useRef(!1);return pL(()=>{s.current=!0}),y.useCallback(function(i,l){l===void 0&&(l={}),s.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Np({fromRouteId:n},l)))},[t,n])}const MT={};function ZQ(t,n,s){MT[t]||(MT[t]=!0)}function JQ(t,n){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function bL(t){let{to:n,replace:s,state:r,relative:i}=t;bh()||rs(!1);let{future:l,static:o}=y.useContext(Ro),{matches:c}=y.useContext(Vl),{pathname:d}=sl(),u=Aa(),h=a3(n,r3(c,l.v7_relativeSplatPath),d,i==="path"),m=JSON.stringify(h);return y.useEffect(()=>u(JSON.parse(m),{replace:s,state:r,relative:i}),[u,m,i,s,r]),null}function vL(t){return FQ(t.context)}function dt(t){rs(!1)}function eZ(t){let{basename:n="/",children:s=null,location:r,navigationType:i=gc.Pop,navigator:l,static:o=!1,future:c}=t;bh()&&rs(!1);let d=n.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:d,navigator:l,static:o,future:Np({v7_relativeSplatPath:!1},c)}),[d,c,l,o]);typeof r=="string"&&(r=yh(r));let{pathname:h="/",search:m="",hash:x="",state:b=null,key:w="default"}=r,j=y.useMemo(()=>{let S=Kf(h,d);return S==null?null:{location:{pathname:S,search:m,hash:x,state:b,key:w},navigationType:i}},[d,h,m,x,b,w,i]);return j==null?null:y.createElement(Ro.Provider,{value:u},y.createElement(yb.Provider,{children:s,value:j}))}function tZ(t){let{children:n,location:s}=t;return $Q(Yj(n),s)}new Promise(()=>{});function Yj(t,n){n===void 0&&(n=[]);let s=[];return y.Children.forEach(t,(r,i)=>{if(!y.isValidElement(r))return;let l=[...n,i];if(r.type===y.Fragment){s.push.apply(s,Yj(r.props.children,l));return}r.type!==dt&&rs(!1),!r.props.index||!r.props.children||rs(!1);let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Yj(r.props.children,l)),s.push(o)}),s}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k1(){return k1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},k1.apply(this,arguments)}function wL(t,n){if(t==null)return{};var s={},r=Object.keys(t),i,l;for(l=0;l<r.length;l++)i=r[l],!(n.indexOf(i)>=0)&&(s[i]=t[i]);return s}function nZ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function sZ(t,n){return t.button===0&&(!n||n==="_self")&&!nZ(t)}const rZ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],aZ=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],iZ="6";try{window.__reactRouterVersion=iZ}catch{}const lZ=y.createContext({isTransitioning:!1}),oZ="startTransition",OT=tb[oZ];function cZ(t){let{basename:n,children:s,future:r,window:i}=t,l=y.useRef();l.current==null&&(l.current=uQ({window:i,v5Compat:!0}));let o=l.current,[c,d]=y.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},h=y.useCallback(m=>{u&&OT?OT(()=>d(m)):d(m)},[d,u]);return y.useLayoutEffect(()=>o.listen(h),[o,h]),y.useEffect(()=>JQ(r),[r]),y.createElement(eZ,{basename:n,children:s,location:c.location,navigationType:c.action,navigator:o,future:r})}const dZ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uZ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zi=y.forwardRef(function(n,s){let{onClick:r,relative:i,reloadDocument:l,replace:o,state:c,target:d,to:u,preventScrollReset:h,viewTransition:m}=n,x=wL(n,rZ),{basename:b}=y.useContext(Ro),w,j=!1;if(typeof u=="string"&&uZ.test(u)&&(w=u,dZ))try{let k=new URL(window.location.href),T=u.startsWith("//")?new URL(k.protocol+u):new URL(u),I=Kf(T.pathname,b);T.origin===k.origin&&I!=null?u=I+T.search+T.hash:j=!0}catch{}let S=RQ(u,{relative:i}),C=hZ(u,{replace:o,state:c,target:d,preventScrollReset:h,relative:i,viewTransition:m});function A(k){r&&r(k),k.defaultPrevented||C(k)}return y.createElement("a",k1({},x,{href:w||S,onClick:j||l?r:A,ref:s,target:d}))}),DT=y.forwardRef(function(n,s){let{"aria-current":r="page",caseSensitive:i=!1,className:l="",end:o=!1,style:c,to:d,viewTransition:u,children:h}=n,m=wL(n,aZ),x=bb(d,{relative:m.relative}),b=sl(),w=y.useContext(hL),{navigator:j,basename:S}=y.useContext(Ro),C=w!=null&&mZ(x)&&u===!0,A=j.encodeLocation?j.encodeLocation(x).pathname:x.pathname,k=b.pathname,T=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;i||(k=k.toLowerCase(),T=T?T.toLowerCase():null,A=A.toLowerCase()),T&&S&&(T=Kf(T,S)||T);const I=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let D=k===A||!o&&k.startsWith(A)&&k.charAt(I)==="/",O=T!=null&&(T===A||!o&&T.startsWith(A)&&T.charAt(A.length)==="/"),R={isActive:D,isPending:O,isTransitioning:C},P=D?r:void 0,L;typeof l=="function"?L=l(R):L=[l,D?"active":null,O?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let $=typeof c=="function"?c(R):c;return y.createElement(Zi,k1({},m,{"aria-current":P,className:L,ref:s,style:$,to:d,viewTransition:u}),typeof h=="function"?h(R):h)});var Xj;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Xj||(Xj={}));var RT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(RT||(RT={}));function fZ(t){let n=y.useContext(gb);return n||rs(!1),n}function hZ(t,n){let{target:s,replace:r,state:i,preventScrollReset:l,relative:o,viewTransition:c}=n===void 0?{}:n,d=Aa(),u=sl(),h=bb(t,{relative:o});return y.useCallback(m=>{if(sZ(m,s)){m.preventDefault();let x=r!==void 0?r:A1(u)===A1(h);d(t,{replace:x,state:i,preventScrollReset:l,relative:o,viewTransition:c})}},[u,d,h,r,i,s,t,l,o,c])}function mZ(t,n){n===void 0&&(n={});let s=y.useContext(lZ);s==null&&rs(!1);let{basename:r}=fZ(Xj.useViewTransitionState),i=bb(t,{relative:n.relative});if(!s.isTransitioning)return!1;let l=Kf(s.currentLocation.pathname,r)||s.currentLocation.pathname,o=Kf(s.nextLocation.pathname,r)||s.nextLocation.pathname;return Kj(i.pathname,o)!=null||Kj(i.pathname,l)!=null}function NL(t,n){return function(){return t.apply(n,arguments)}}const{toString:pZ}=Object.prototype,{getPrototypeOf:i3}=Object,{iterator:vb,toStringTag:jL}=Symbol,wb=(t=>n=>{const s=pZ.call(n);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),rl=t=>(t=t.toLowerCase(),n=>wb(n)===t),Nb=t=>n=>typeof n===t,{isArray:vh}=Array,Yf=Nb("undefined");function mx(t){return t!==null&&!Yf(t)&&t.constructor!==null&&!Yf(t.constructor)&&Na(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const SL=rl("ArrayBuffer");function xZ(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&SL(t.buffer),n}const gZ=Nb("string"),Na=Nb("function"),_L=Nb("number"),px=t=>t!==null&&typeof t=="object",yZ=t=>t===!0||t===!1,Eg=t=>{if(wb(t)!=="object")return!1;const n=i3(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(jL in t)&&!(vb in t)},bZ=t=>{if(!px(t)||mx(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},vZ=rl("Date"),wZ=rl("File"),NZ=rl("Blob"),jZ=rl("FileList"),SZ=t=>px(t)&&Na(t.pipe),_Z=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||Na(t.append)&&((n=wb(t))==="formdata"||n==="object"&&Na(t.toString)&&t.toString()==="[object FormData]"))},CZ=rl("URLSearchParams"),[AZ,kZ,EZ,TZ]=["ReadableStream","Request","Response","Headers"].map(rl),IZ=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xx(t,n,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),vh(t))for(r=0,i=t.length;r<i;r++)n.call(null,t[r],r,t);else{if(mx(t))return;const l=s?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let c;for(r=0;r<o;r++)c=l[r],n.call(null,t[c],c,t)}}function CL(t,n){if(mx(t))return null;n=n.toLowerCase();const s=Object.keys(t);let r=s.length,i;for(;r-- >0;)if(i=s[r],n===i.toLowerCase())return i;return null}const Md=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,AL=t=>!Yf(t)&&t!==Md;function Qj(){const{caseless:t,skipUndefined:n}=AL(this)&&this||{},s={},r=(i,l)=>{const o=t&&CL(s,l)||l;Eg(s[o])&&Eg(i)?s[o]=Qj(s[o],i):Eg(i)?s[o]=Qj({},i):vh(i)?s[o]=i.slice():(!n||!Yf(i))&&(s[o]=i)};for(let i=0,l=arguments.length;i<l;i++)arguments[i]&&xx(arguments[i],r);return s}const PZ=(t,n,s,{allOwnKeys:r}={})=>(xx(n,(i,l)=>{s&&Na(i)?t[l]=NL(i,s):t[l]=i},{allOwnKeys:r}),t),MZ=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),OZ=(t,n,s,r)=>{t.prototype=Object.create(n.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),s&&Object.assign(t.prototype,s)},DZ=(t,n,s,r)=>{let i,l,o;const c={};if(n=n||{},t==null)return n;do{for(i=Object.getOwnPropertyNames(t),l=i.length;l-- >0;)o=i[l],(!r||r(o,t,n))&&!c[o]&&(n[o]=t[o],c[o]=!0);t=s!==!1&&i3(t)}while(t&&(!s||s(t,n))&&t!==Object.prototype);return n},RZ=(t,n,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=n.length;const r=t.indexOf(n,s);return r!==-1&&r===s},LZ=t=>{if(!t)return null;if(vh(t))return t;let n=t.length;if(!_L(n))return null;const s=new Array(n);for(;n-- >0;)s[n]=t[n];return s},BZ=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&i3(Uint8Array)),FZ=(t,n)=>{const r=(t&&t[vb]).call(t);let i;for(;(i=r.next())&&!i.done;){const l=i.value;n.call(t,l[0],l[1])}},$Z=(t,n)=>{let s;const r=[];for(;(s=t.exec(n))!==null;)r.push(s);return r},zZ=rl("HTMLFormElement"),UZ=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,i){return r.toUpperCase()+i}),LT=(({hasOwnProperty:t})=>(n,s)=>t.call(n,s))(Object.prototype),VZ=rl("RegExp"),kL=(t,n)=>{const s=Object.getOwnPropertyDescriptors(t),r={};xx(s,(i,l)=>{let o;(o=n(i,l,t))!==!1&&(r[l]=o||i)}),Object.defineProperties(t,r)},HZ=t=>{kL(t,(n,s)=>{if(Na(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=t[s];if(Na(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},WZ=(t,n)=>{const s={},r=i=>{i.forEach(l=>{s[l]=!0})};return vh(t)?r(t):r(String(t).split(n)),s},qZ=()=>{},GZ=(t,n)=>t!=null&&Number.isFinite(t=+t)?t:n;function KZ(t){return!!(t&&Na(t.append)&&t[jL]==="FormData"&&t[vb])}const YZ=t=>{const n=new Array(10),s=(r,i)=>{if(px(r)){if(n.indexOf(r)>=0)return;if(mx(r))return r;if(!("toJSON"in r)){n[i]=r;const l=vh(r)?[]:{};return xx(r,(o,c)=>{const d=s(o,i+1);!Yf(d)&&(l[c]=d)}),n[i]=void 0,l}}return r};return s(t,0)},XZ=rl("AsyncFunction"),QZ=t=>t&&(px(t)||Na(t))&&Na(t.then)&&Na(t.catch),EL=((t,n)=>t?setImmediate:n?((s,r)=>(Md.addEventListener("message",({source:i,data:l})=>{i===Md&&l===s&&r.length&&r.shift()()},!1),i=>{r.push(i),Md.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Na(Md.postMessage)),ZZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Md):typeof process<"u"&&process.nextTick||EL,JZ=t=>t!=null&&Na(t[vb]),Ee={isArray:vh,isArrayBuffer:SL,isBuffer:mx,isFormData:_Z,isArrayBufferView:xZ,isString:gZ,isNumber:_L,isBoolean:yZ,isObject:px,isPlainObject:Eg,isEmptyObject:bZ,isReadableStream:AZ,isRequest:kZ,isResponse:EZ,isHeaders:TZ,isUndefined:Yf,isDate:vZ,isFile:wZ,isBlob:NZ,isRegExp:VZ,isFunction:Na,isStream:SZ,isURLSearchParams:CZ,isTypedArray:BZ,isFileList:jZ,forEach:xx,merge:Qj,extend:PZ,trim:IZ,stripBOM:MZ,inherits:OZ,toFlatObject:DZ,kindOf:wb,kindOfTest:rl,endsWith:RZ,toArray:LZ,forEachEntry:FZ,matchAll:$Z,isHTMLForm:zZ,hasOwnProperty:LT,hasOwnProp:LT,reduceDescriptors:kL,freezeMethods:HZ,toObjectSet:WZ,toCamelCase:UZ,noop:qZ,toFiniteNumber:GZ,findKey:CL,global:Md,isContextDefined:AL,isSpecCompliantForm:KZ,toJSONObject:YZ,isAsyncFn:XZ,isThenable:QZ,setImmediate:EL,asap:ZZ,isIterable:JZ};function zt(t,n,s,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),s&&(this.config=s),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Ee.inherits(zt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ee.toJSONObject(this.config),code:this.code,status:this.status}}});const TL=zt.prototype,IL={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{IL[t]={value:t}});Object.defineProperties(zt,IL);Object.defineProperty(TL,"isAxiosError",{value:!0});zt.from=(t,n,s,r,i,l)=>{const o=Object.create(TL);Ee.toFlatObject(t,o,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const c=t&&t.message?t.message:"Error",d=n==null&&t?t.code:n;return zt.call(o,c,d,s,r,i),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",l&&Object.assign(o,l),o};const eJ=null;function Zj(t){return Ee.isPlainObject(t)||Ee.isArray(t)}function PL(t){return Ee.endsWith(t,"[]")?t.slice(0,-2):t}function BT(t,n,s){return t?t.concat(n).map(function(i,l){return i=PL(i),!s&&l?"["+i+"]":i}).join(s?".":""):n}function tJ(t){return Ee.isArray(t)&&!t.some(Zj)}const nJ=Ee.toFlatObject(Ee,{},null,function(n){return/^is[A-Z]/.test(n)});function jb(t,n,s){if(!Ee.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,s=Ee.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,S){return!Ee.isUndefined(S[j])});const r=s.metaTokens,i=s.visitor||h,l=s.dots,o=s.indexes,d=(s.Blob||typeof Blob<"u"&&Blob)&&Ee.isSpecCompliantForm(n);if(!Ee.isFunction(i))throw new TypeError("visitor must be a function");function u(w){if(w===null)return"";if(Ee.isDate(w))return w.toISOString();if(Ee.isBoolean(w))return w.toString();if(!d&&Ee.isBlob(w))throw new zt("Blob is not supported. Use a Buffer instead.");return Ee.isArrayBuffer(w)||Ee.isTypedArray(w)?d&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function h(w,j,S){let C=w;if(w&&!S&&typeof w=="object"){if(Ee.endsWith(j,"{}"))j=r?j:j.slice(0,-2),w=JSON.stringify(w);else if(Ee.isArray(w)&&tJ(w)||(Ee.isFileList(w)||Ee.endsWith(j,"[]"))&&(C=Ee.toArray(w)))return j=PL(j),C.forEach(function(k,T){!(Ee.isUndefined(k)||k===null)&&n.append(o===!0?BT([j],T,l):o===null?j:j+"[]",u(k))}),!1}return Zj(w)?!0:(n.append(BT(S,j,l),u(w)),!1)}const m=[],x=Object.assign(nJ,{defaultVisitor:h,convertValue:u,isVisitable:Zj});function b(w,j){if(!Ee.isUndefined(w)){if(m.indexOf(w)!==-1)throw Error("Circular reference detected in "+j.join("."));m.push(w),Ee.forEach(w,function(C,A){(!(Ee.isUndefined(C)||C===null)&&i.call(n,C,Ee.isString(A)?A.trim():A,j,x))===!0&&b(C,j?j.concat(A):[A])}),m.pop()}}if(!Ee.isObject(t))throw new TypeError("data must be an object");return b(t),n}function FT(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function l3(t,n){this._pairs=[],t&&jb(t,this,n)}const ML=l3.prototype;ML.append=function(n,s){this._pairs.push([n,s])};ML.toString=function(n){const s=n?function(r){return n.call(this,r,FT)}:FT;return this._pairs.map(function(i){return s(i[0])+"="+s(i[1])},"").join("&")};function sJ(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function OL(t,n,s){if(!n)return t;const r=s&&s.encode||sJ;Ee.isFunction(s)&&(s={serialize:s});const i=s&&s.serialize;let l;if(i?l=i(n,s):l=Ee.isURLSearchParams(n)?n.toString():new l3(n,s).toString(r),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class $T{constructor(){this.handlers=[]}use(n,s,r){return this.handlers.push({fulfilled:n,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ee.forEach(this.handlers,function(r){r!==null&&n(r)})}}const DL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},rJ=typeof URLSearchParams<"u"?URLSearchParams:l3,aJ=typeof FormData<"u"?FormData:null,iJ=typeof Blob<"u"?Blob:null,lJ={isBrowser:!0,classes:{URLSearchParams:rJ,FormData:aJ,Blob:iJ},protocols:["http","https","file","blob","url","data"]},o3=typeof window<"u"&&typeof document<"u",Jj=typeof navigator=="object"&&navigator||void 0,oJ=o3&&(!Jj||["ReactNative","NativeScript","NS"].indexOf(Jj.product)<0),cJ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",dJ=o3&&window.location.href||"http://localhost",uJ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:o3,hasStandardBrowserEnv:oJ,hasStandardBrowserWebWorkerEnv:cJ,navigator:Jj,origin:dJ},Symbol.toStringTag,{value:"Module"})),Lr={...uJ,...lJ};function fJ(t,n){return jb(t,new Lr.classes.URLSearchParams,{visitor:function(s,r,i,l){return Lr.isNode&&Ee.isBuffer(s)?(this.append(r,s.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...n})}function hJ(t){return Ee.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function mJ(t){const n={},s=Object.keys(t);let r;const i=s.length;let l;for(r=0;r<i;r++)l=s[r],n[l]=t[l];return n}function RL(t){function n(s,r,i,l){let o=s[l++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),d=l>=s.length;return o=!o&&Ee.isArray(i)?i.length:o,d?(Ee.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!c):((!i[o]||!Ee.isObject(i[o]))&&(i[o]=[]),n(s,r,i[o],l)&&Ee.isArray(i[o])&&(i[o]=mJ(i[o])),!c)}if(Ee.isFormData(t)&&Ee.isFunction(t.entries)){const s={};return Ee.forEachEntry(t,(r,i)=>{n(hJ(r),i,s,0)}),s}return null}function pJ(t,n,s){if(Ee.isString(t))try{return(n||JSON.parse)(t),Ee.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(t)}const gx={transitional:DL,adapter:["xhr","http","fetch"],transformRequest:[function(n,s){const r=s.getContentType()||"",i=r.indexOf("application/json")>-1,l=Ee.isObject(n);if(l&&Ee.isHTMLForm(n)&&(n=new FormData(n)),Ee.isFormData(n))return i?JSON.stringify(RL(n)):n;if(Ee.isArrayBuffer(n)||Ee.isBuffer(n)||Ee.isStream(n)||Ee.isFile(n)||Ee.isBlob(n)||Ee.isReadableStream(n))return n;if(Ee.isArrayBufferView(n))return n.buffer;if(Ee.isURLSearchParams(n))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let c;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return fJ(n,this.formSerializer).toString();if((c=Ee.isFileList(n))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return jb(c?{"files[]":n}:n,d&&new d,this.formSerializer)}}return l||i?(s.setContentType("application/json",!1),pJ(n)):n}],transformResponse:[function(n){const s=this.transitional||gx.transitional,r=s&&s.forcedJSONParsing,i=this.responseType==="json";if(Ee.isResponse(n)||Ee.isReadableStream(n))return n;if(n&&Ee.isString(n)&&(r&&!this.responseType||i)){const o=!(s&&s.silentJSONParsing)&&i;try{return JSON.parse(n,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?zt.from(c,zt.ERR_BAD_RESPONSE,this,null,this.response):c}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Lr.classes.FormData,Blob:Lr.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ee.forEach(["delete","get","head","post","put","patch"],t=>{gx.headers[t]={}});const xJ=Ee.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),gJ=t=>{const n={};let s,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),s=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!s||n[s]&&xJ[s])&&(s==="set-cookie"?n[s]?n[s].push(r):n[s]=[r]:n[s]=n[s]?n[s]+", "+r:r)}),n},zT=Symbol("internals");function dm(t){return t&&String(t).trim().toLowerCase()}function Tg(t){return t===!1||t==null?t:Ee.isArray(t)?t.map(Tg):String(t)}function yJ(t){const n=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(t);)n[r[1]]=r[2];return n}const bJ=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function sN(t,n,s,r,i){if(Ee.isFunction(r))return r.call(this,n,s);if(i&&(n=s),!!Ee.isString(n)){if(Ee.isString(r))return n.indexOf(r)!==-1;if(Ee.isRegExp(r))return r.test(n)}}function vJ(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,s,r)=>s.toUpperCase()+r)}function wJ(t,n){const s=Ee.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+s,{value:function(i,l,o){return this[r].call(this,n,i,l,o)},configurable:!0})})}let ja=class{constructor(n){n&&this.set(n)}set(n,s,r){const i=this;function l(c,d,u){const h=dm(d);if(!h)throw new Error("header name must be a non-empty string");const m=Ee.findKey(i,h);(!m||i[m]===void 0||u===!0||u===void 0&&i[m]!==!1)&&(i[m||d]=Tg(c))}const o=(c,d)=>Ee.forEach(c,(u,h)=>l(u,h,d));if(Ee.isPlainObject(n)||n instanceof this.constructor)o(n,s);else if(Ee.isString(n)&&(n=n.trim())&&!bJ(n))o(gJ(n),s);else if(Ee.isObject(n)&&Ee.isIterable(n)){let c={},d,u;for(const h of n){if(!Ee.isArray(h))throw TypeError("Object iterator must return a key-value pair");c[u=h[0]]=(d=c[u])?Ee.isArray(d)?[...d,h[1]]:[d,h[1]]:h[1]}o(c,s)}else n!=null&&l(s,n,r);return this}get(n,s){if(n=dm(n),n){const r=Ee.findKey(this,n);if(r){const i=this[r];if(!s)return i;if(s===!0)return yJ(i);if(Ee.isFunction(s))return s.call(this,i,r);if(Ee.isRegExp(s))return s.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,s){if(n=dm(n),n){const r=Ee.findKey(this,n);return!!(r&&this[r]!==void 0&&(!s||sN(this,this[r],r,s)))}return!1}delete(n,s){const r=this;let i=!1;function l(o){if(o=dm(o),o){const c=Ee.findKey(r,o);c&&(!s||sN(r,r[c],c,s))&&(delete r[c],i=!0)}}return Ee.isArray(n)?n.forEach(l):l(n),i}clear(n){const s=Object.keys(this);let r=s.length,i=!1;for(;r--;){const l=s[r];(!n||sN(this,this[l],l,n,!0))&&(delete this[l],i=!0)}return i}normalize(n){const s=this,r={};return Ee.forEach(this,(i,l)=>{const o=Ee.findKey(r,l);if(o){s[o]=Tg(i),delete s[l];return}const c=n?vJ(l):String(l).trim();c!==l&&delete s[l],s[c]=Tg(i),r[c]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const s=Object.create(null);return Ee.forEach(this,(r,i)=>{r!=null&&r!==!1&&(s[i]=n&&Ee.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,s])=>n+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...s){const r=new this(n);return s.forEach(i=>r.set(i)),r}static accessor(n){const r=(this[zT]=this[zT]={accessors:{}}).accessors,i=this.prototype;function l(o){const c=dm(o);r[c]||(wJ(i,o),r[c]=!0)}return Ee.isArray(n)?n.forEach(l):l(n),this}};ja.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ee.reduceDescriptors(ja.prototype,({value:t},n)=>{let s=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(r){this[s]=r}}});Ee.freezeMethods(ja);function rN(t,n){const s=this||gx,r=n||s,i=ja.from(r.headers);let l=r.data;return Ee.forEach(t,function(c){l=c.call(s,l,i.normalize(),n?n.status:void 0)}),i.normalize(),l}function LL(t){return!!(t&&t.__CANCEL__)}function wh(t,n,s){zt.call(this,t??"canceled",zt.ERR_CANCELED,n,s),this.name="CanceledError"}Ee.inherits(wh,zt,{__CANCEL__:!0});function BL(t,n,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?t(s):n(new zt("Request failed with status code "+s.status,[zt.ERR_BAD_REQUEST,zt.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function NJ(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function jJ(t,n){t=t||10;const s=new Array(t),r=new Array(t);let i=0,l=0,o;return n=n!==void 0?n:1e3,function(d){const u=Date.now(),h=r[l];o||(o=u),s[i]=d,r[i]=u;let m=l,x=0;for(;m!==i;)x+=s[m++],m=m%t;if(i=(i+1)%t,i===l&&(l=(l+1)%t),u-o<n)return;const b=h&&u-h;return b?Math.round(x*1e3/b):void 0}}function SJ(t,n){let s=0,r=1e3/n,i,l;const o=(u,h=Date.now())=>{s=h,i=null,l&&(clearTimeout(l),l=null),t(...u)};return[(...u)=>{const h=Date.now(),m=h-s;m>=r?o(u,h):(i=u,l||(l=setTimeout(()=>{l=null,o(i)},r-m)))},()=>i&&o(i)]}const E1=(t,n,s=3)=>{let r=0;const i=jJ(50,250);return SJ(l=>{const o=l.loaded,c=l.lengthComputable?l.total:void 0,d=o-r,u=i(d),h=o<=c;r=o;const m={loaded:o,total:c,progress:c?o/c:void 0,bytes:d,rate:u||void 0,estimated:u&&c&&h?(c-o)/u:void 0,event:l,lengthComputable:c!=null,[n?"download":"upload"]:!0};t(m)},s)},UT=(t,n)=>{const s=t!=null;return[r=>n[0]({lengthComputable:s,total:t,loaded:r}),n[1]]},VT=t=>(...n)=>Ee.asap(()=>t(...n)),_J=Lr.hasStandardBrowserEnv?((t,n)=>s=>(s=new URL(s,Lr.origin),t.protocol===s.protocol&&t.host===s.host&&(n||t.port===s.port)))(new URL(Lr.origin),Lr.navigator&&/(msie|trident)/i.test(Lr.navigator.userAgent)):()=>!0,CJ=Lr.hasStandardBrowserEnv?{write(t,n,s,r,i,l){const o=[t+"="+encodeURIComponent(n)];Ee.isNumber(s)&&o.push("expires="+new Date(s).toGMTString()),Ee.isString(r)&&o.push("path="+r),Ee.isString(i)&&o.push("domain="+i),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function AJ(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function kJ(t,n){return n?t.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):t}function FL(t,n,s){let r=!AJ(n);return t&&(r||s==!1)?kJ(t,n):n}const HT=t=>t instanceof ja?{...t}:t;function ou(t,n){n=n||{};const s={};function r(u,h,m,x){return Ee.isPlainObject(u)&&Ee.isPlainObject(h)?Ee.merge.call({caseless:x},u,h):Ee.isPlainObject(h)?Ee.merge({},h):Ee.isArray(h)?h.slice():h}function i(u,h,m,x){if(Ee.isUndefined(h)){if(!Ee.isUndefined(u))return r(void 0,u,m,x)}else return r(u,h,m,x)}function l(u,h){if(!Ee.isUndefined(h))return r(void 0,h)}function o(u,h){if(Ee.isUndefined(h)){if(!Ee.isUndefined(u))return r(void 0,u)}else return r(void 0,h)}function c(u,h,m){if(m in n)return r(u,h);if(m in t)return r(void 0,u)}const d={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(u,h,m)=>i(HT(u),HT(h),m,!0)};return Ee.forEach(Object.keys({...t,...n}),function(h){const m=d[h]||i,x=m(t[h],n[h],h);Ee.isUndefined(x)&&m!==c||(s[h]=x)}),s}const $L=t=>{const n=ou({},t);let{data:s,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:l,headers:o,auth:c}=n;if(n.headers=o=ja.from(o),n.url=OL(FL(n.baseURL,n.url,n.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Ee.isFormData(s)){if(Lr.hasStandardBrowserEnv||Lr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Ee.isFunction(s.getHeaders)){const d=s.getHeaders(),u=["content-type","content-length"];Object.entries(d).forEach(([h,m])=>{u.includes(h.toLowerCase())&&o.set(h,m)})}}if(Lr.hasStandardBrowserEnv&&(r&&Ee.isFunction(r)&&(r=r(n)),r||r!==!1&&_J(n.url))){const d=i&&l&&CJ.read(l);d&&o.set(i,d)}return n},EJ=typeof XMLHttpRequest<"u",TJ=EJ&&function(t){return new Promise(function(s,r){const i=$L(t);let l=i.data;const o=ja.from(i.headers).normalize();let{responseType:c,onUploadProgress:d,onDownloadProgress:u}=i,h,m,x,b,w;function j(){b&&b(),w&&w(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let S=new XMLHttpRequest;S.open(i.method.toUpperCase(),i.url,!0),S.timeout=i.timeout;function C(){if(!S)return;const k=ja.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),I={data:!c||c==="text"||c==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:k,config:t,request:S};BL(function(O){s(O),j()},function(O){r(O),j()},I),S=null}"onloadend"in S?S.onloadend=C:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(C)},S.onabort=function(){S&&(r(new zt("Request aborted",zt.ECONNABORTED,t,S)),S=null)},S.onerror=function(T){const I=T&&T.message?T.message:"Network Error",D=new zt(I,zt.ERR_NETWORK,t,S);D.event=T||null,r(D),S=null},S.ontimeout=function(){let T=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const I=i.transitional||DL;i.timeoutErrorMessage&&(T=i.timeoutErrorMessage),r(new zt(T,I.clarifyTimeoutError?zt.ETIMEDOUT:zt.ECONNABORTED,t,S)),S=null},l===void 0&&o.setContentType(null),"setRequestHeader"in S&&Ee.forEach(o.toJSON(),function(T,I){S.setRequestHeader(I,T)}),Ee.isUndefined(i.withCredentials)||(S.withCredentials=!!i.withCredentials),c&&c!=="json"&&(S.responseType=i.responseType),u&&([x,w]=E1(u,!0),S.addEventListener("progress",x)),d&&S.upload&&([m,b]=E1(d),S.upload.addEventListener("progress",m),S.upload.addEventListener("loadend",b)),(i.cancelToken||i.signal)&&(h=k=>{S&&(r(!k||k.type?new wh(null,t,S):k),S.abort(),S=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const A=NJ(i.url);if(A&&Lr.protocols.indexOf(A)===-1){r(new zt("Unsupported protocol "+A+":",zt.ERR_BAD_REQUEST,t));return}S.send(l||null)})},IJ=(t,n)=>{const{length:s}=t=t?t.filter(Boolean):[];if(n||s){let r=new AbortController,i;const l=function(u){if(!i){i=!0,c();const h=u instanceof Error?u:this.reason;r.abort(h instanceof zt?h:new wh(h instanceof Error?h.message:h))}};let o=n&&setTimeout(()=>{o=null,l(new zt(`timeout ${n} of ms exceeded`,zt.ETIMEDOUT))},n);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(l):u.removeEventListener("abort",l)}),t=null)};t.forEach(u=>u.addEventListener("abort",l));const{signal:d}=r;return d.unsubscribe=()=>Ee.asap(c),d}},PJ=function*(t,n){let s=t.byteLength;if(s<n){yield t;return}let r=0,i;for(;r<s;)i=r+n,yield t.slice(r,i),r=i},MJ=async function*(t,n){for await(const s of OJ(t))yield*PJ(s,n)},OJ=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const n=t.getReader();try{for(;;){const{done:s,value:r}=await n.read();if(s)break;yield r}}finally{await n.cancel()}},WT=(t,n,s,r)=>{const i=MJ(t,n);let l=0,o,c=d=>{o||(o=!0,r&&r(d))};return new ReadableStream({async pull(d){try{const{done:u,value:h}=await i.next();if(u){c(),d.close();return}let m=h.byteLength;if(s){let x=l+=m;s(x)}d.enqueue(new Uint8Array(h))}catch(u){throw c(u),u}},cancel(d){return c(d),i.return()}},{highWaterMark:2})},qT=64*1024,{isFunction:g0}=Ee,DJ=(({Request:t,Response:n})=>({Request:t,Response:n}))(Ee.global),{ReadableStream:GT,TextEncoder:KT}=Ee.global,YT=(t,...n)=>{try{return!!t(...n)}catch{return!1}},RJ=t=>{t=Ee.merge.call({skipUndefined:!0},DJ,t);const{fetch:n,Request:s,Response:r}=t,i=n?g0(n):typeof fetch=="function",l=g0(s),o=g0(r);if(!i)return!1;const c=i&&g0(GT),d=i&&(typeof KT=="function"?(w=>j=>w.encode(j))(new KT):async w=>new Uint8Array(await new s(w).arrayBuffer())),u=l&&c&&YT(()=>{let w=!1;const j=new s(Lr.origin,{body:new GT,method:"POST",get duplex(){return w=!0,"half"}}).headers.has("Content-Type");return w&&!j}),h=o&&c&&YT(()=>Ee.isReadableStream(new r("").body)),m={stream:h&&(w=>w.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(w=>{!m[w]&&(m[w]=(j,S)=>{let C=j&&j[w];if(C)return C.call(j);throw new zt(`Response type '${w}' is not supported`,zt.ERR_NOT_SUPPORT,S)})});const x=async w=>{if(w==null)return 0;if(Ee.isBlob(w))return w.size;if(Ee.isSpecCompliantForm(w))return(await new s(Lr.origin,{method:"POST",body:w}).arrayBuffer()).byteLength;if(Ee.isArrayBufferView(w)||Ee.isArrayBuffer(w))return w.byteLength;if(Ee.isURLSearchParams(w)&&(w=w+""),Ee.isString(w))return(await d(w)).byteLength},b=async(w,j)=>{const S=Ee.toFiniteNumber(w.getContentLength());return S??x(j)};return async w=>{let{url:j,method:S,data:C,signal:A,cancelToken:k,timeout:T,onDownloadProgress:I,onUploadProgress:D,responseType:O,headers:R,withCredentials:P="same-origin",fetchOptions:L}=$L(w),$=n||fetch;O=O?(O+"").toLowerCase():"text";let B=IJ([A,k&&k.toAbortSignal()],T),V=null;const K=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let z;try{if(D&&u&&S!=="get"&&S!=="head"&&(z=await b(R,C))!==0){let ye=new s(j,{method:"POST",body:C,duplex:"half"}),ie;if(Ee.isFormData(C)&&(ie=ye.headers.get("content-type"))&&R.setContentType(ie),ye.body){const[he,be]=UT(z,E1(VT(D)));C=WT(ye.body,qT,he,be)}}Ee.isString(P)||(P=P?"include":"omit");const H=l&&"credentials"in s.prototype,Y={...L,signal:B,method:S.toUpperCase(),headers:R.normalize().toJSON(),body:C,duplex:"half",credentials:H?P:void 0};V=l&&new s(j,Y);let G=await(l?$(V,L):$(j,Y));const J=h&&(O==="stream"||O==="response");if(h&&(I||J&&K)){const ye={};["status","statusText","headers"].forEach(we=>{ye[we]=G[we]});const ie=Ee.toFiniteNumber(G.headers.get("content-length")),[he,be]=I&&UT(ie,E1(VT(I),!0))||[];G=new r(WT(G.body,qT,he,()=>{be&&be(),K&&K()}),ye)}O=O||"text";let ee=await m[Ee.findKey(m,O)||"text"](G,w);return!J&&K&&K(),await new Promise((ye,ie)=>{BL(ye,ie,{data:ee,headers:ja.from(G.headers),status:G.status,statusText:G.statusText,config:w,request:V})})}catch(H){throw K&&K(),H&&H.name==="TypeError"&&/Load failed|fetch/i.test(H.message)?Object.assign(new zt("Network Error",zt.ERR_NETWORK,w,V),{cause:H.cause||H}):zt.from(H,H&&H.code,w,V)}}},LJ=new Map,zL=t=>{let n=t?t.env:{};const{fetch:s,Request:r,Response:i}=n,l=[r,i,s];let o=l.length,c=o,d,u,h=LJ;for(;c--;)d=l[c],u=h.get(d),u===void 0&&h.set(d,u=c?new Map:RJ(n)),h=u;return u};zL();const eS={http:eJ,xhr:TJ,fetch:{get:zL}};Ee.forEach(eS,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const XT=t=>`- ${t}`,BJ=t=>Ee.isFunction(t)||t===null||t===!1,UL={getAdapter:(t,n)=>{t=Ee.isArray(t)?t:[t];const{length:s}=t;let r,i;const l={};for(let o=0;o<s;o++){r=t[o];let c;if(i=r,!BJ(r)&&(i=eS[(c=String(r)).toLowerCase()],i===void 0))throw new zt(`Unknown adapter '${c}'`);if(i&&(Ee.isFunction(i)||(i=i.get(n))))break;l[c||"#"+o]=i}if(!i){const o=Object.entries(l).map(([d,u])=>`adapter ${d} `+(u===!1?"is not supported by the environment":"is not available in the build"));let c=s?o.length>1?`since :
`+o.map(XT).join(`
`):" "+XT(o[0]):"as no adapter specified";throw new zt("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return i},adapters:eS};function aN(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new wh(null,t)}function QT(t){return aN(t),t.headers=ja.from(t.headers),t.data=rN.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),UL.getAdapter(t.adapter||gx.adapter,t)(t).then(function(r){return aN(t),r.data=rN.call(t,t.transformResponse,r),r.headers=ja.from(r.headers),r},function(r){return LL(r)||(aN(t),r&&r.response&&(r.response.data=rN.call(t,t.transformResponse,r.response),r.response.headers=ja.from(r.response.headers))),Promise.reject(r)})}const VL="1.12.2",Sb={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{Sb[t]=function(r){return typeof r===t||"a"+(n<1?"n ":" ")+t}});const ZT={};Sb.transitional=function(n,s,r){function i(l,o){return"[Axios v"+VL+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,c)=>{if(n===!1)throw new zt(i(o," has been removed"+(s?" in "+s:"")),zt.ERR_DEPRECATED);return s&&!ZT[o]&&(ZT[o]=!0,console.warn(i(o," has been deprecated since v"+s+" and will be removed in the near future"))),n?n(l,o,c):!0}};Sb.spelling=function(n){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function FJ(t,n,s){if(typeof t!="object")throw new zt("options must be an object",zt.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const l=r[i],o=n[l];if(o){const c=t[l],d=c===void 0||o(c,l,t);if(d!==!0)throw new zt("option "+l+" must be "+d,zt.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new zt("Unknown option "+l,zt.ERR_BAD_OPTION)}}const Ig={assertOptions:FJ,validators:Sb},xl=Ig.validators;let Hd=class{constructor(n){this.defaults=n||{},this.interceptors={request:new $T,response:new $T}}async request(n,s){try{return await this._request(n,s)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const l=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(n,s){typeof n=="string"?(s=s||{},s.url=n):s=n||{},s=ou(this.defaults,s);const{transitional:r,paramsSerializer:i,headers:l}=s;r!==void 0&&Ig.assertOptions(r,{silentJSONParsing:xl.transitional(xl.boolean),forcedJSONParsing:xl.transitional(xl.boolean),clarifyTimeoutError:xl.transitional(xl.boolean)},!1),i!=null&&(Ee.isFunction(i)?s.paramsSerializer={serialize:i}:Ig.assertOptions(i,{encode:xl.function,serialize:xl.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Ig.assertOptions(s,{baseUrl:xl.spelling("baseURL"),withXsrfToken:xl.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let o=l&&Ee.merge(l.common,l[s.method]);l&&Ee.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),s.headers=ja.concat(o,l);const c=[];let d=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(s)===!1||(d=d&&j.synchronous,c.unshift(j.fulfilled,j.rejected))});const u=[];this.interceptors.response.forEach(function(j){u.push(j.fulfilled,j.rejected)});let h,m=0,x;if(!d){const w=[QT.bind(this),void 0];for(w.unshift(...c),w.push(...u),x=w.length,h=Promise.resolve(s);m<x;)h=h.then(w[m++],w[m++]);return h}x=c.length;let b=s;for(;m<x;){const w=c[m++],j=c[m++];try{b=w(b)}catch(S){j.call(this,S);break}}try{h=QT.call(this,b)}catch(w){return Promise.reject(w)}for(m=0,x=u.length;m<x;)h=h.then(u[m++],u[m++]);return h}getUri(n){n=ou(this.defaults,n);const s=FL(n.baseURL,n.url,n.allowAbsoluteUrls);return OL(s,n.params,n.paramsSerializer)}};Ee.forEach(["delete","get","head","options"],function(n){Hd.prototype[n]=function(s,r){return this.request(ou(r||{},{method:n,url:s,data:(r||{}).data}))}});Ee.forEach(["post","put","patch"],function(n){function s(r){return function(l,o,c){return this.request(ou(c||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Hd.prototype[n]=s(),Hd.prototype[n+"Form"]=s(!0)});let $J=class HL{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(l){s=l});const r=this;this.promise.then(i=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](i);r._listeners=null}),this.promise.then=i=>{let l;const o=new Promise(c=>{r.subscribe(c),l=c}).then(i);return o.cancel=function(){r.unsubscribe(l)},o},n(function(l,o,c){r.reason||(r.reason=new wh(l,o,c),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const s=this._listeners.indexOf(n);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const n=new AbortController,s=r=>{n.abort(r)};return this.subscribe(s),n.signal.unsubscribe=()=>this.unsubscribe(s),n.signal}static source(){let n;return{token:new HL(function(i){n=i}),cancel:n}}};function zJ(t){return function(s){return t.apply(null,s)}}function UJ(t){return Ee.isObject(t)&&t.isAxiosError===!0}const tS={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(tS).forEach(([t,n])=>{tS[n]=t});function WL(t){const n=new Hd(t),s=NL(Hd.prototype.request,n);return Ee.extend(s,Hd.prototype,n,{allOwnKeys:!0}),Ee.extend(s,n,null,{allOwnKeys:!0}),s.create=function(i){return WL(ou(t,i))},s}const ws=WL(gx);ws.Axios=Hd;ws.CanceledError=wh;ws.CancelToken=$J;ws.isCancel=LL;ws.VERSION=VL;ws.toFormData=jb;ws.AxiosError=zt;ws.Cancel=ws.CanceledError;ws.all=function(n){return Promise.all(n)};ws.spread=zJ;ws.isAxiosError=UJ;ws.mergeConfig=ou;ws.AxiosHeaders=ja;ws.formToJSON=t=>RL(Ee.isHTMLForm(t)?new FormData(t):t);ws.getAdapter=UL.getAdapter;ws.HttpStatusCode=tS;ws.default=ws;const{Axios:yLe,AxiosError:bLe,CanceledError:vLe,isCancel:wLe,CancelToken:NLe,VERSION:jLe,all:SLe,Cancel:_Le,isAxiosError:CLe,spread:ALe,toFormData:kLe,AxiosHeaders:ELe,HttpStatusCode:TLe,formToJSON:ILe,getAdapter:PLe,mergeConfig:MLe}=ws;function VJ(t){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}const HJ=t=>{switch(t){case"success":return GJ;case"info":return YJ;case"warning":return KJ;case"error":return XJ;default:return null}},WJ=Array(12).fill(0),qJ=({visible:t,className:n})=>Ge.createElement("div",{className:["sonner-loading-wrapper",n].filter(Boolean).join(" "),"data-visible":t},Ge.createElement("div",{className:"sonner-spinner"},WJ.map((s,r)=>Ge.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),GJ=Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),KJ=Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ge.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),YJ=Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),XJ=Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),QJ=Ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ge.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ge.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),ZJ=()=>{const[t,n]=Ge.useState(document.hidden);return Ge.useEffect(()=>{const s=()=>{n(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),t};let nS=1;class JJ{constructor(){this.subscribe=n=>(this.subscribers.push(n),()=>{const s=this.subscribers.indexOf(n);this.subscribers.splice(s,1)}),this.publish=n=>{this.subscribers.forEach(s=>s(n))},this.addToast=n=>{this.publish(n),this.toasts=[...this.toasts,n]},this.create=n=>{var s;const{message:r,...i}=n,l=typeof(n==null?void 0:n.id)=="number"||((s=n.id)==null?void 0:s.length)>0?n.id:nS++,o=this.toasts.find(d=>d.id===l),c=n.dismissible===void 0?!0:n.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),o?this.toasts=this.toasts.map(d=>d.id===l?(this.publish({...d,...n,id:l,title:r}),{...d,...n,id:l,dismissible:c,title:r}):d):this.addToast({title:r,...i,dismissible:c,id:l}),l},this.dismiss=n=>(n?(this.dismissedToasts.add(n),requestAnimationFrame(()=>this.subscribers.forEach(s=>s({id:n,dismiss:!0})))):this.toasts.forEach(s=>{this.subscribers.forEach(r=>r({id:s.id,dismiss:!0}))}),n),this.message=(n,s)=>this.create({...s,message:n}),this.error=(n,s)=>this.create({...s,message:n,type:"error"}),this.success=(n,s)=>this.create({...s,type:"success",message:n}),this.info=(n,s)=>this.create({...s,type:"info",message:n}),this.warning=(n,s)=>this.create({...s,type:"warning",message:n}),this.loading=(n,s)=>this.create({...s,type:"loading",message:n}),this.promise=(n,s)=>{if(!s)return;let r;s.loading!==void 0&&(r=this.create({...s,promise:n,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));const i=Promise.resolve(n instanceof Function?n():n);let l=r!==void 0,o;const c=i.then(async u=>{if(o=["resolve",u],Ge.isValidElement(u))l=!1,this.create({id:r,type:"default",message:u});else if(tee(u)&&!u.ok){l=!1;const m=typeof s.error=="function"?await s.error(`HTTP error! status: ${u.status}`):s.error,x=typeof s.description=="function"?await s.description(`HTTP error! status: ${u.status}`):s.description,w=typeof m=="object"&&!Ge.isValidElement(m)?m:{message:m};this.create({id:r,type:"error",description:x,...w})}else if(u instanceof Error){l=!1;const m=typeof s.error=="function"?await s.error(u):s.error,x=typeof s.description=="function"?await s.description(u):s.description,w=typeof m=="object"&&!Ge.isValidElement(m)?m:{message:m};this.create({id:r,type:"error",description:x,...w})}else if(s.success!==void 0){l=!1;const m=typeof s.success=="function"?await s.success(u):s.success,x=typeof s.description=="function"?await s.description(u):s.description,w=typeof m=="object"&&!Ge.isValidElement(m)?m:{message:m};this.create({id:r,type:"success",description:x,...w})}}).catch(async u=>{if(o=["reject",u],s.error!==void 0){l=!1;const h=typeof s.error=="function"?await s.error(u):s.error,m=typeof s.description=="function"?await s.description(u):s.description,b=typeof h=="object"&&!Ge.isValidElement(h)?h:{message:h};this.create({id:r,type:"error",description:m,...b})}}).finally(()=>{l&&(this.dismiss(r),r=void 0),s.finally==null||s.finally.call(s)}),d=()=>new Promise((u,h)=>c.then(()=>o[0]==="reject"?h(o[1]):u(o[1])).catch(h));return typeof r!="string"&&typeof r!="number"?{unwrap:d}:Object.assign(r,{unwrap:d})},this.custom=(n,s)=>{const r=(s==null?void 0:s.id)||nS++;return this.create({jsx:n(r),id:r,...s}),r},this.getActiveToasts=()=>this.toasts.filter(n=>!this.dismissedToasts.has(n.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const fa=new JJ,eee=(t,n)=>{const s=(n==null?void 0:n.id)||nS++;return fa.addToast({title:t,...n,id:s}),s},tee=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",nee=eee,see=()=>fa.toasts,ree=()=>fa.getActiveToasts(),xe=Object.assign(nee,{success:fa.success,info:fa.info,warning:fa.warning,error:fa.error,custom:fa.custom,message:fa.message,promise:fa.promise,dismiss:fa.dismiss,loading:fa.loading},{getHistory:see,getToasts:ree});VJ("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function y0(t){return t.label!==void 0}const aee=3,iee="24px",lee="16px",JT=4e3,oee=356,cee=14,dee=45,uee=200;function gl(...t){return t.filter(Boolean).join(" ")}function fee(t){const[n,s]=t.split("-"),r=[];return n&&r.push(n),s&&r.push(s),r}const hee=t=>{var n,s,r,i,l,o,c,d,u;const{invert:h,toast:m,unstyled:x,interacting:b,setHeights:w,visibleToasts:j,heights:S,index:C,toasts:A,expanded:k,removeToast:T,defaultRichColors:I,closeButton:D,style:O,cancelButtonStyle:R,actionButtonStyle:P,className:L="",descriptionClassName:$="",duration:B,position:V,gap:K,expandByDefault:z,classNames:H,icons:Y,closeButtonAriaLabel:G="Close toast"}=t,[J,ee]=Ge.useState(null),[ye,ie]=Ge.useState(null),[he,be]=Ge.useState(!1),[we,Z]=Ge.useState(!1),[ce,Te]=Ge.useState(!1),[le,de]=Ge.useState(!1),[ge,ae]=Ge.useState(!1),[Ve,nt]=Ge.useState(0),[wt,jt]=Ge.useState(0),ct=Ge.useRef(m.duration||B||JT),Me=Ge.useRef(null),qe=Ge.useRef(null),oe=C===0,ue=C+1<=j,De=m.type,St=m.dismissible!==!1,tn=m.className||"",Lt=m.descriptionClassName||"",Dt=Ge.useMemo(()=>S.findIndex(Tt=>Tt.toastId===m.id)||0,[S,m.id]),Un=Ge.useMemo(()=>{var Tt;return(Tt=m.closeButton)!=null?Tt:D},[m.closeButton,D]),yn=Ge.useMemo(()=>m.duration||B||JT,[m.duration,B]),re=Ge.useRef(0),Ce=Ge.useRef(0),Ue=Ge.useRef(0),Qe=Ge.useRef(null),[ht,$e]=V.split("-"),Xt=Ge.useMemo(()=>S.reduce((Tt,pe,at)=>at>=Dt?Tt:Tt+pe.height,0),[S,Dt]),Ut=ZJ(),en=m.invert||h,Tn=De==="loading";Ce.current=Ge.useMemo(()=>Dt*K+Xt,[Dt,Xt]),Ge.useEffect(()=>{ct.current=yn},[yn]),Ge.useEffect(()=>{be(!0)},[]),Ge.useEffect(()=>{const Tt=qe.current;if(Tt){const pe=Tt.getBoundingClientRect().height;return jt(pe),w(at=>[{toastId:m.id,height:pe,position:m.position},...at]),()=>w(at=>at.filter(lt=>lt.toastId!==m.id))}},[w,m.id]),Ge.useLayoutEffect(()=>{if(!he)return;const Tt=qe.current,pe=Tt.style.height;Tt.style.height="auto";const at=Tt.getBoundingClientRect().height;Tt.style.height=pe,jt(at),w(lt=>lt.find(Rt=>Rt.toastId===m.id)?lt.map(Rt=>Rt.toastId===m.id?{...Rt,height:at}:Rt):[{toastId:m.id,height:at,position:m.position},...lt])},[he,m.title,m.description,w,m.id,m.jsx,m.action,m.cancel]);const Rs=Ge.useCallback(()=>{Z(!0),nt(Ce.current),w(Tt=>Tt.filter(pe=>pe.toastId!==m.id)),setTimeout(()=>{T(m)},uee)},[m,T,w,Ce]);Ge.useEffect(()=>{if(m.promise&&De==="loading"||m.duration===1/0||m.type==="loading")return;let Tt;return k||b||Ut?(()=>{if(Ue.current<re.current){const lt=new Date().getTime()-re.current;ct.current=ct.current-lt}Ue.current=new Date().getTime()})():(()=>{ct.current!==1/0&&(re.current=new Date().getTime(),Tt=setTimeout(()=>{m.onAutoClose==null||m.onAutoClose.call(m,m),Rs()},ct.current))})(),()=>clearTimeout(Tt)},[k,b,m,De,Ut,Rs]),Ge.useEffect(()=>{m.delete&&(Rs(),m.onDismiss==null||m.onDismiss.call(m,m))},[Rs,m.delete]);function Xl(){var Tt;if(Y!=null&&Y.loading){var pe;return Ge.createElement("div",{className:gl(H==null?void 0:H.loader,m==null||(pe=m.classNames)==null?void 0:pe.loader,"sonner-loader"),"data-visible":De==="loading"},Y.loading)}return Ge.createElement(qJ,{className:gl(H==null?void 0:H.loader,m==null||(Tt=m.classNames)==null?void 0:Tt.loader),visible:De==="loading"})}const Bt=m.icon||(Y==null?void 0:Y[De])||HJ(De);var Wt,si;return Ge.createElement("li",{tabIndex:0,ref:qe,className:gl(L,tn,H==null?void 0:H.toast,m==null||(n=m.classNames)==null?void 0:n.toast,H==null?void 0:H.default,H==null?void 0:H[De],m==null||(s=m.classNames)==null?void 0:s[De]),"data-sonner-toast":"","data-rich-colors":(Wt=m.richColors)!=null?Wt:I,"data-styled":!(m.jsx||m.unstyled||x),"data-mounted":he,"data-promise":!!m.promise,"data-swiped":ge,"data-removed":we,"data-visible":ue,"data-y-position":ht,"data-x-position":$e,"data-index":C,"data-front":oe,"data-swiping":ce,"data-dismissible":St,"data-type":De,"data-invert":en,"data-swipe-out":le,"data-swipe-direction":ye,"data-expanded":!!(k||z&&he),"data-testid":m.testId,style:{"--index":C,"--toasts-before":C,"--z-index":A.length-C,"--offset":`${we?Ve:Ce.current}px`,"--initial-height":z?"auto":`${wt}px`,...O,...m.style},onDragEnd:()=>{Te(!1),ee(null),Qe.current=null},onPointerDown:Tt=>{Tt.button!==2&&(Tn||!St||(Me.current=new Date,nt(Ce.current),Tt.target.setPointerCapture(Tt.pointerId),Tt.target.tagName!=="BUTTON"&&(Te(!0),Qe.current={x:Tt.clientX,y:Tt.clientY})))},onPointerUp:()=>{var Tt,pe,at;if(le||!St)return;Qe.current=null;const lt=Number(((Tt=qe.current)==null?void 0:Tt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),qt=Number(((pe=qe.current)==null?void 0:pe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Rt=new Date().getTime()-((at=Me.current)==null?void 0:at.getTime()),Ft=J==="x"?lt:qt,Qn=Math.abs(Ft)/Rt;if(Math.abs(Ft)>=dee||Qn>.11){nt(Ce.current),m.onDismiss==null||m.onDismiss.call(m,m),ie(J==="x"?lt>0?"right":"left":qt>0?"down":"up"),Rs(),de(!0);return}else{var bn,Ls;(bn=qe.current)==null||bn.style.setProperty("--swipe-amount-x","0px"),(Ls=qe.current)==null||Ls.style.setProperty("--swipe-amount-y","0px")}ae(!1),Te(!1),ee(null)},onPointerMove:Tt=>{var pe,at,lt;if(!Qe.current||!St||((pe=window.getSelection())==null?void 0:pe.toString().length)>0)return;const Rt=Tt.clientY-Qe.current.y,Ft=Tt.clientX-Qe.current.x;var Qn;const bn=(Qn=t.swipeDirections)!=null?Qn:fee(V);!J&&(Math.abs(Ft)>1||Math.abs(Rt)>1)&&ee(Math.abs(Ft)>Math.abs(Rt)?"x":"y");let Ls={x:0,y:0};const ls=Bs=>1/(1.5+Math.abs(Bs)/20);if(J==="y"){if(bn.includes("top")||bn.includes("bottom"))if(bn.includes("top")&&Rt<0||bn.includes("bottom")&&Rt>0)Ls.y=Rt;else{const Bs=Rt*ls(Rt);Ls.y=Math.abs(Bs)<Math.abs(Rt)?Bs:Rt}}else if(J==="x"&&(bn.includes("left")||bn.includes("right")))if(bn.includes("left")&&Ft<0||bn.includes("right")&&Ft>0)Ls.x=Ft;else{const Bs=Ft*ls(Ft);Ls.x=Math.abs(Bs)<Math.abs(Ft)?Bs:Ft}(Math.abs(Ls.x)>0||Math.abs(Ls.y)>0)&&ae(!0),(at=qe.current)==null||at.style.setProperty("--swipe-amount-x",`${Ls.x}px`),(lt=qe.current)==null||lt.style.setProperty("--swipe-amount-y",`${Ls.y}px`)}},Un&&!m.jsx&&De!=="loading"?Ge.createElement("button",{"aria-label":G,"data-disabled":Tn,"data-close-button":!0,onClick:Tn||!St?()=>{}:()=>{Rs(),m.onDismiss==null||m.onDismiss.call(m,m)},className:gl(H==null?void 0:H.closeButton,m==null||(r=m.classNames)==null?void 0:r.closeButton)},(si=Y==null?void 0:Y.close)!=null?si:QJ):null,(De||m.icon||m.promise)&&m.icon!==null&&((Y==null?void 0:Y[De])!==null||m.icon)?Ge.createElement("div",{"data-icon":"",className:gl(H==null?void 0:H.icon,m==null||(i=m.classNames)==null?void 0:i.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||Xl():null,m.type!=="loading"?Bt:null):null,Ge.createElement("div",{"data-content":"",className:gl(H==null?void 0:H.content,m==null||(l=m.classNames)==null?void 0:l.content)},Ge.createElement("div",{"data-title":"",className:gl(H==null?void 0:H.title,m==null||(o=m.classNames)==null?void 0:o.title)},m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title),m.description?Ge.createElement("div",{"data-description":"",className:gl($,Lt,H==null?void 0:H.description,m==null||(c=m.classNames)==null?void 0:c.description)},typeof m.description=="function"?m.description():m.description):null),Ge.isValidElement(m.cancel)?m.cancel:m.cancel&&y0(m.cancel)?Ge.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||R,onClick:Tt=>{y0(m.cancel)&&St&&(m.cancel.onClick==null||m.cancel.onClick.call(m.cancel,Tt),Rs())},className:gl(H==null?void 0:H.cancelButton,m==null||(d=m.classNames)==null?void 0:d.cancelButton)},m.cancel.label):null,Ge.isValidElement(m.action)?m.action:m.action&&y0(m.action)?Ge.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||P,onClick:Tt=>{y0(m.action)&&(m.action.onClick==null||m.action.onClick.call(m.action,Tt),!Tt.defaultPrevented&&Rs())},className:gl(H==null?void 0:H.actionButton,m==null||(u=m.classNames)==null?void 0:u.actionButton)},m.action.label):null)};function e4(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function mee(t,n){const s={};return[t,n].forEach((r,i)=>{const l=i===1,o=l?"--mobile-offset":"--offset",c=l?lee:iee;function d(u){["top","right","bottom","left"].forEach(h=>{s[`${o}-${h}`]=typeof u=="number"?`${u}px`:u})}typeof r=="number"||typeof r=="string"?d(r):typeof r=="object"?["top","right","bottom","left"].forEach(u=>{r[u]===void 0?s[`${o}-${u}`]=c:s[`${o}-${u}`]=typeof r[u]=="number"?`${r[u]}px`:r[u]}):d(c)}),s}const pee=Ge.forwardRef(function(n,s){const{id:r,invert:i,position:l="bottom-right",hotkey:o=["altKey","KeyT"],expand:c,closeButton:d,className:u,offset:h,mobileOffset:m,theme:x="light",richColors:b,duration:w,style:j,visibleToasts:S=aee,toastOptions:C,dir:A=e4(),gap:k=cee,icons:T,containerAriaLabel:I="Notifications"}=n,[D,O]=Ge.useState([]),R=Ge.useMemo(()=>r?D.filter(he=>he.toasterId===r):D.filter(he=>!he.toasterId),[D,r]),P=Ge.useMemo(()=>Array.from(new Set([l].concat(R.filter(he=>he.position).map(he=>he.position)))),[R,l]),[L,$]=Ge.useState([]),[B,V]=Ge.useState(!1),[K,z]=Ge.useState(!1),[H,Y]=Ge.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),G=Ge.useRef(null),J=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),ee=Ge.useRef(null),ye=Ge.useRef(!1),ie=Ge.useCallback(he=>{O(be=>{var we;return(we=be.find(Z=>Z.id===he.id))!=null&&we.delete||fa.dismiss(he.id),be.filter(({id:Z})=>Z!==he.id)})},[]);return Ge.useEffect(()=>fa.subscribe(he=>{if(he.dismiss){requestAnimationFrame(()=>{O(be=>be.map(we=>we.id===he.id?{...we,delete:!0}:we))});return}setTimeout(()=>{oL.flushSync(()=>{O(be=>{const we=be.findIndex(Z=>Z.id===he.id);return we!==-1?[...be.slice(0,we),{...be[we],...he},...be.slice(we+1)]:[he,...be]})})})}),[D]),Ge.useEffect(()=>{if(x!=="system"){Y(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Y("dark"):Y("light")),typeof window>"u")return;const he=window.matchMedia("(prefers-color-scheme: dark)");try{he.addEventListener("change",({matches:be})=>{Y(be?"dark":"light")})}catch{he.addListener(({matches:we})=>{try{Y(we?"dark":"light")}catch(Z){console.error(Z)}})}},[x]),Ge.useEffect(()=>{D.length<=1&&V(!1)},[D]),Ge.useEffect(()=>{const he=be=>{var we;if(o.every(Te=>be[Te]||be.code===Te)){var ce;V(!0),(ce=G.current)==null||ce.focus()}be.code==="Escape"&&(document.activeElement===G.current||(we=G.current)!=null&&we.contains(document.activeElement))&&V(!1)};return document.addEventListener("keydown",he),()=>document.removeEventListener("keydown",he)},[o]),Ge.useEffect(()=>{if(G.current)return()=>{ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null,ye.current=!1)}},[G.current]),Ge.createElement("section",{ref:s,"aria-label":`${I} ${J}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},P.map((he,be)=>{var we;const[Z,ce]=he.split("-");return R.length?Ge.createElement("ol",{key:he,dir:A==="auto"?e4():A,tabIndex:-1,ref:G,className:u,"data-sonner-toaster":!0,"data-sonner-theme":H,"data-y-position":Z,"data-x-position":ce,style:{"--front-toast-height":`${((we=L[0])==null?void 0:we.height)||0}px`,"--width":`${oee}px`,"--gap":`${k}px`,...j,...mee(h,m)},onBlur:Te=>{ye.current&&!Te.currentTarget.contains(Te.relatedTarget)&&(ye.current=!1,ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null))},onFocus:Te=>{Te.target instanceof HTMLElement&&Te.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,ee.current=Te.relatedTarget)},onMouseEnter:()=>V(!0),onMouseMove:()=>V(!0),onMouseLeave:()=>{K||V(!1)},onDragEnd:()=>V(!1),onPointerDown:Te=>{Te.target instanceof HTMLElement&&Te.target.dataset.dismissible==="false"||z(!0)},onPointerUp:()=>z(!1)},R.filter(Te=>!Te.position&&be===0||Te.position===he).map((Te,le)=>{var de,ge;return Ge.createElement(hee,{key:Te.id,icons:T,index:le,toast:Te,defaultRichColors:b,duration:(de=C==null?void 0:C.duration)!=null?de:w,className:C==null?void 0:C.className,descriptionClassName:C==null?void 0:C.descriptionClassName,invert:i,visibleToasts:S,closeButton:(ge=C==null?void 0:C.closeButton)!=null?ge:d,interacting:K,position:he,style:C==null?void 0:C.style,unstyled:C==null?void 0:C.unstyled,classNames:C==null?void 0:C.classNames,cancelButtonStyle:C==null?void 0:C.cancelButtonStyle,actionButtonStyle:C==null?void 0:C.actionButtonStyle,closeButtonAriaLabel:C==null?void 0:C.closeButtonAriaLabel,removeToast:ie,toasts:R.filter(ae=>ae.position==Te.position),heights:L.filter(ae=>ae.position==Te.position),setHeights:$,expandByDefault:c,gap:k,expanded:B,swipeDirections:n.swipeDirections})})):null}))}),c3="https://api.nutryah.com/api",ne=ws.create({baseURL:c3,withCredentials:!0});ne.interceptors.request.use(t=>{const n=localStorage.getItem("access_token"),s=localStorage.getItem("tenant_code");return n&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${n}`),s&&(t.headers=t.headers||{},t.headers["X-Tenant-Code"]=s),t});async function xee(t,n){var s,r,i,l,o,c;try{const d=localStorage.getItem("tenant_code")||null;let u=null;try{(s=t==null?void 0:t.config)!=null&&s.data&&(u=typeof t.config.data=="string"?JSON.parse(t.config.data):t.config.data)}catch{u={raw:(r=t==null?void 0:t.config)==null?void 0:r.data}}const h={message:n,page_url:window.location.href,request_url:((i=t==null?void 0:t.config)==null?void 0:i.url)||null,request_method:((l=t==null?void 0:t.config)==null?void 0:l.method)||null,http_status:((o=t==null?void 0:t.response)==null?void 0:o.status)||null,request_payload:u,response_payload:((c=t==null?void 0:t.response)==null?void 0:c.data)||null,stack_trace:(t==null?void 0:t.stack)||null,tenant_code:d,user_agent:navigator.userAgent,extra:{network:navigator.onLine?"online":"offline"}};await fetch(`${c3}/system/client-error`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h),keepalive:!0})}catch(d){console.error("Failed to report client error",d)}}let um=null;async function qL(){if(um)return um;const t=localStorage.getItem("tenant_code")||null;return um=(async()=>{try{const n=await fetch(`${c3}/auth/refresh`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...t?{"X-Tenant-Code":t}:{}}});if(!n.ok)throw new Error(`Refresh failed with status ${n.status}`);const s=await n.json();return s!=null&&s.access_token&&localStorage.setItem("access_token",s.access_token),(s==null?void 0:s.access_token)||null}finally{um=null}})(),um}ne.interceptors.response.use(t=>t,async t=>{var o,c,d,u;const n=(o=t==null?void 0:t.response)==null?void 0:o.status,s=(c=t==null?void 0:t.response)==null?void 0:c.data,r=t.config||{};if(n===401&&!r._retry){r._retry=!0;try{const h=await qL();if(h)return r.headers=r.headers||{},r.headers.Authorization=`Bearer ${h}`,ne(r)}catch(h){console.error("Refresh token flow failed",h)}localStorage.clear(),(u=(d=ne.defaults.headers)==null?void 0:d.common)==null||delete u.Authorization}const i=s==null?void 0:s.detail;let l="Unexpected error";return Array.isArray(i)?l=i.map(h=>`${Array.isArray(h.loc)?h.loc.join("."):h.loc}: ${h.msg}`).join(`
`):typeof i=="string"?l=i:typeof(s==null?void 0:s.message)=="string"?l=s.message:t!=null&&t.message&&(l=t.message),console.error("API error:",n,s),xe.error(l),xee(t,l),Promise.reject(t)});const gee={},t4=t=>{let n;const s=new Set,r=(h,m)=>{const x=typeof h=="function"?h(n):h;if(!Object.is(x,n)){const b=n;n=m??(typeof x!="object"||x===null)?x:Object.assign({},n,x),s.forEach(w=>w(n,b))}},i=()=>n,d={setState:r,getState:i,getInitialState:()=>u,subscribe:h=>(s.add(h),()=>s.delete(h)),destroy:()=>{(gee?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},u=n=t(r,i,d);return d},yee=t=>t?t4(t):t4;var GL={exports:{}},KL={},YL={exports:{}},XL={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xf=y;function bee(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var vee=typeof Object.is=="function"?Object.is:bee,wee=Xf.useState,Nee=Xf.useEffect,jee=Xf.useLayoutEffect,See=Xf.useDebugValue;function _ee(t,n){var s=n(),r=wee({inst:{value:s,getSnapshot:n}}),i=r[0].inst,l=r[1];return jee(function(){i.value=s,i.getSnapshot=n,iN(i)&&l({inst:i})},[t,s,n]),Nee(function(){return iN(i)&&l({inst:i}),t(function(){iN(i)&&l({inst:i})})},[t]),See(s),s}function iN(t){var n=t.getSnapshot;t=t.value;try{var s=n();return!vee(t,s)}catch{return!0}}function Cee(t,n){return n()}var Aee=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Cee:_ee;XL.useSyncExternalStore=Xf.useSyncExternalStore!==void 0?Xf.useSyncExternalStore:Aee;YL.exports=XL;var kee=YL.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b=y,Eee=kee;function Tee(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Iee=typeof Object.is=="function"?Object.is:Tee,Pee=Eee.useSyncExternalStore,Mee=_b.useRef,Oee=_b.useEffect,Dee=_b.useMemo,Ree=_b.useDebugValue;KL.useSyncExternalStoreWithSelector=function(t,n,s,r,i){var l=Mee(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=Dee(function(){function d(b){if(!u){if(u=!0,h=b,b=r(b),i!==void 0&&o.hasValue){var w=o.value;if(i(w,b))return m=w}return m=b}if(w=m,Iee(h,b))return w;var j=r(b);return i!==void 0&&i(w,j)?(h=b,w):(h=b,m=j)}var u=!1,h,m,x=s===void 0?null:s;return[function(){return d(n())},x===null?void 0:function(){return d(x())}]},[n,s,r,i]);var c=Pee(t,l[0],l[1]);return Oee(function(){o.hasValue=!0,o.value=c},[c]),Ree(c),c};GL.exports=KL;var QL=GL.exports;const Lee=Ii(QL),ZL={},{useDebugValue:Bee}=Ge,{useSyncExternalStoreWithSelector:Fee}=Lee;let n4=!1;const $ee=t=>t;function zee(t,n=$ee,s){(ZL?"production":void 0)!=="production"&&s&&!n4&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),n4=!0);const r=Fee(t.subscribe,t.getState,t.getServerState||t.getInitialState,n,s);return Bee(r),r}const s4=t=>{(ZL?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const n=typeof t=="function"?yee(t):t,s=(r,i)=>zee(n,r,i);return Object.assign(s,n),s},JL=t=>t?s4(t):s4,kr=JL((t,n)=>({user:null,modules:{},loading:!1,tenantCode:localStorage.getItem("tenant_code")||"",setTenantCode:s=>{s?localStorage.setItem("tenant_code",s):localStorage.removeItem("tenant_code"),t({tenantCode:s})},registerAdmin:async s=>{var l;const r=await ne.post("/auth/register-admin",s),i=(l=r==null?void 0:r.data)==null?void 0:l.tenant_code;return i&&(localStorage.setItem("tenant_code",i),t({tenantCode:i})),r},login:async({tenant_code:s,email:r,password:i})=>{const l={tenant_code:s==null?void 0:s.trim(),email:r,password:i},{data:o}=await ne.post("/auth/login",l);return s&&(localStorage.setItem("tenant_code",s.trim()),t({tenantCode:s.trim()})),o},verifyOtp:async({tenant_code:s,email:r,otp:i})=>{const l={tenant_code:s==null?void 0:s.trim(),email:r,otp:i},{data:o}=await ne.post("/auth/verify-otp",l);return localStorage.setItem("access_token",o.access_token),localStorage.setItem("refresh_token",o.refresh_token),ne.defaults.headers.common.Authorization=`Bearer ${o.access_token}`,s&&(localStorage.setItem("tenant_code",s.trim()),t({tenantCode:s.trim()})),o},fetchProfile:async()=>{var s;try{t({loading:!0});const r=await ne.get("/auth/me"),i=await ne.get("/auth/me/permissions"),l=(s=r==null?void 0:r.data)==null?void 0:s.tenant_code;l&&localStorage.setItem("tenant_code",l),t({user:r.data,modules:i.data.modules||{},tenantCode:l||n().tenantCode})}finally{t({loading:!1})}},logout:()=>{localStorage.clear(),delete ne.defaults.headers.common.Authorization,t({user:null,modules:{},tenantCode:""})}}));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uee=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Vee=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,s,r)=>r?r.toUpperCase():s.toLowerCase()),r4=t=>{const n=Vee(t);return n.charAt(0).toUpperCase()+n.slice(1)},e7=(...t)=>t.filter((n,s,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===s).join(" ").trim(),Hee=t=>{for(const n in t)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Wee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=y.forwardRef(({color:t="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:i="",children:l,iconNode:o,...c},d)=>y.createElement("svg",{ref:d,...Wee,width:n,height:n,stroke:t,strokeWidth:r?Number(s)*24/Number(n):s,className:e7("lucide",i),...!l&&!Hee(c)&&{"aria-hidden":"true"},...c},[...o.map(([u,h])=>y.createElement(u,h)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=(t,n)=>{const s=y.forwardRef(({className:r,...i},l)=>y.createElement(qee,{ref:l,iconNode:n,className:e7(`lucide-${Uee(r4(t))}`,`lucide-${t}`,r),...i}));return s.displayName=r4(t),s};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],or=Be("activity",Gee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kee=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],Yee=Be("arrow-left-right",Kee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Cb=Be("arrow-left",Xee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],Zee=Be("beaker",Qee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],Ps=Be("bed-double",Jee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],tte=Be("bell",ete);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],ste=Be("boxes",nte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Ya=Be("building-2",rte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ate=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],a4=Be("calendar-clock",ate);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Gs=Be("calendar-days",ite);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],yf=Be("calendar-range",lte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ote=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],sS=Be("calendar",ote);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],i4=Be("camera",cte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],ute=Be("camera-off",dte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Im=Be("chart-column",fte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],mte=Be("chart-no-axes-column",hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],d3=Be("check",pte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],u3=Be("chevron-down",xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gte=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yx=Be("chevron-left",gte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Nh=Be("chevron-right",yte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bte=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],vte=Be("chevron-up",bte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ms=Be("circle-alert",wte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nte=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],zr=Be("circle-check",Nte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jte=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ste=Be("circle-play",jte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ab=Be("circle-x",_te);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],Ate=Be("clipboard-check",Cte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],_r=Be("clipboard-list",kte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ete=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ys=Be("clock-3",Ete);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ni=Be("clock",Tte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],fm=Be("cloud-upload",Ite);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=[["path",{d:"M10 12h.01",key:"1kxr2c"}],["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14",key:"36qu9e"}],["path",{d:"M2 20h20",key:"owomy5"}]],t7=Be("door-closed",Pte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mte=[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]],b0=Be("dot",Mte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Wd=Be("download",Ote);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dte=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],Rte=Be("droplet",Dte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Bte=Be("droplets",Lte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fte=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],$te=Be("eye-off",Fte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gm=Be("eye",zte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]],Vte=Be("file-plus-2",Ute);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Wte=Be("file-spreadsheet",Hte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Rc=Be("file-text",qte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Lc=Be("flask-conical",Gte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kte=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ai=Be("funnel",Kte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],l4=Be("hash",Yte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xte=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],jp=Be("heart-pulse",Xte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qte=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Zte=Be("history",Qte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jte=[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]],lN=Be("hospital",Jte);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ene=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],_l=Be("indian-rupee",ene);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Sp=Be("info",tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nne=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],io=Be("key-round",nne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sne=[["rect",{width:"18",height:"12",x:"3",y:"4",rx:"2",ry:"2",key:"1qhy41"}],["line",{x1:"2",x2:"22",y1:"20",y2:"20",key:"ni3hll"}]],rne=Be("laptop-minimal",sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ane=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],v0=Be("layout-dashboard",ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ine=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],n7=Be("layers",ine);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lne=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],one=Be("layout-template",lne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cne=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],dne=Be("list-checks",cne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const une=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],nn=Be("loader-circle",une);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fne=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],hne=Be("log-out",fne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mne=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],pne=Be("lock",mne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xne=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],_p=Be("mail",xne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gne=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],s7=Be("map-pin",gne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yne=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],o4=Be("notebook-pen",yne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bne=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],vne=Be("package-open",bne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wne=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],r7=Be("package",wne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nne=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],jne=Be("paperclip",Nne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sne=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],a7=Be("pen",Sne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ne=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Xa=Be("pencil",_ne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cne=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Ur=Be("pill",Cne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ane=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Nn=Be("plus",Ane);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kne=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],rS=Be("printer",kne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ene=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],oN=Be("qr-code",Ene);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tne=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M8 7h8",key:"i86dvs"}],["path",{d:"M12 17.5 8 15h1a4 4 0 0 0 0-8",key:"grpkl4"}],["path",{d:"M8 11h8",key:"vwpz6n"}]],cN=Be("receipt-indian-rupee",Tne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ine=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],aS=Be("receipt",Ine);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pne=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],cu=Be("refresh-ccw",Pne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mne=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],dN=Be("refresh-cw",Mne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const One=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ji=Be("rotate-ccw",One);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dne=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],c4=Be("save",Dne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]],d4=Be("scan-barcode",Rne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],T1=Be("scan-line",Lne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bne=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],Pg=Be("scan",Bne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fne=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],i7=Be("scissors",Fne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ne=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],jn=Be("search",$ne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zne=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Une=Be("settings-2",zne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vne=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hne=Be("settings",Vne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],qne=Be("shield-alert",Wne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ji=Be("shield-check",Gne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kne=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]],Yne=Be("shield-plus",Kne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xne=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],I1=Be("shopping-cart",Xne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qne=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],kb=Be("sparkles",Qne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zne=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],un=Be("stethoscope",Zne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jne=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],u4=Be("syringe",Jne);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ese=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],w0=Be("tag",ese);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tse=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],f3=Be("thermometer",tse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nse=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Wr=Be("trash-2",nse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sse=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],rse=Be("trending-up",sse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ase=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],No=Be("triangle-alert",ase);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ise=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],lse=Be("truck",ise);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ose=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],iS=Be("upload",ose);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cse=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],dse=Be("user-plus",cse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const use=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],Cp=Be("user-round",use);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fse=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ap=Be("users",fse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hse=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ps=Be("user",hse);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mse=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Os=Be("x",mse);function pse(){var b,w;const t=sl(),n=Aa(),s=kr(j=>j.login),[r,i]=y.useState({tenant_code:((b=t.state)==null?void 0:b.tenant_code)||localStorage.getItem("tenant_code")||localStorage.getItem("pending_tenant_code")||"",email:((w=t.state)==null?void 0:w.email)||localStorage.getItem("pending_email")||"",password:""}),[l,o]=y.useState(""),[c,d]=y.useState(!1),[u,h]=y.useState(!1),m=y.useMemo(()=>r.tenant_code.trim()&&r.email.trim()&&r.password.trim()&&!c,[r,c]),x=async j=>{var S,C;if(j.preventDefault(),!!m){o(""),d(!0);try{await s({tenant_code:r.tenant_code.trim(),email:r.email.trim(),password:r.password}),localStorage.setItem("pending_email",r.email.trim()),localStorage.setItem("pending_tenant_code",r.tenant_code.trim()),n("/auth/verify",{state:{email:r.email.trim(),tenant_code:r.tenant_code.trim()}})}catch(A){o(((C=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:C.detail)||"Invalid credentials")}finally{d(!1)}}};return a.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),a.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),a.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-10",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[a.jsx("div",{className:"pointer-events-none absolute -right-12 -top-12 h-32 w-32 rotate-45 bg-gradient-to-br from-blue-50 to-indigo-50"}),a.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:a.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"NUTRYAH's HIMS & EMR"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Multi-tenant login with Hospital Code + Email + OTP"})]})]}),a.jsx(Ji,{className:"h-6 w-6 text-emerald-600"})]}),a.jsxs("form",{onSubmit:x,className:"space-y-4","aria-busy":c,children:[a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Hospital Code"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(Ya,{className:"h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400 uppercase",placeholder:"KGH001",value:r.tenant_code,onChange:j=>i(S=>({...S,tenant_code:j.target.value.toUpperCase()})),required:!0,disabled:c})]}),a.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"Hospital / Clinic code assigned by NUTRYAH (Tenant Code)."})]}),a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Email"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(_p,{className:"h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"you@hospital.org",type:"email",autoComplete:"email",value:r.email,onChange:j=>i(S=>({...S,email:j.target.value})),required:!0,disabled:c})]})]}),a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"mb-1 block text-sm text-gray-600",children:"Password"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(pne,{className:"h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-gray-400",placeholder:"",type:u?"text":"password",autoComplete:"current-password",value:r.password,onChange:j=>i(S=>({...S,password:j.target.value})),required:!0,disabled:c}),a.jsx("button",{type:"button",onClick:()=>h(j=>!j),className:"rounded-lg p-1.5 text-gray-500 hover:bg-gray-50","aria-label":u?"Hide password":"Show password",tabIndex:-1,disabled:c,children:u?a.jsx($te,{className:"h-4 w-4"}):a.jsx(Gm,{className:"h-4 w-4"})})]})]}),a.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!m,type:"submit",children:c?a.jsxs(a.Fragment,{children:[a.jsx(nn,{className:"h-5 w-5 animate-spin"}),a.jsx("span",{children:"Sending OTP"})]}):a.jsx(a.Fragment,{children:"Send OTP"})}),l&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:l}),a.jsx("p",{className:"text-center text-xs text-gray-500",children:"Tip: You'll receive a 6-digit OTP in your email. Keep this tab open."})]}),c&&a.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:a.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin text-blue-600"}),"Sending OTP"]}),a.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:a.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.2s_infinite] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})}),a.jsxs("div",{className:"mt-3 flex items-center justify-center gap-1",children:[a.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.2s]"}),a.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500 [animation-delay:-0.1s]"}),a.jsx("span",{className:"h-2 w-2 animate-bounce rounded-full bg-blue-500"})]})]})})]}),a.jsxs("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:[" ",new Date().getFullYear()," NUTRYAH  Multi-tenant Secure Access"]})]})}),a.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}function xse(){const[t,n]=y.useState({tenant_name:"",tenant_code:"",hospital_address:"",contact_person:"",contact_phone:"",subscription_plan:"standard",admin_name:"",email:"",password:"",confirm_password:""}),[s,r]=y.useState(!1),[i,l]=y.useState(""),o=kr(h=>h.registerAdmin),c=Aa(),d=h=>m=>n(x=>({...x,[h]:m.target.value})),u=async h=>{var m,x;if(h.preventDefault(),!s){if(l(""),t.password!==t.confirm_password){l("Passwords do not match");return}r(!0);try{const b=await o(t),{tenant_code:w}=b.data||{};alert(`Hospital onboarded successfully.
Tenant Code: ${w||t.tenant_code||"Generated"}

Please login with Hospital Code + Admin email.`),c("/auth/login",{replace:!0,state:{email:t.email,tenant_code:w||t.tenant_code}})}catch(b){l(((x=(m=b==null?void 0:b.response)==null?void 0:m.data)==null?void 0:x.detail)||"Failed to register tenant admin")}finally{r(!1)}}};return a.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-slate-50 to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl"}),a.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl"})]}),a.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:a.jsxs("div",{className:"w-full max-w-2xl",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-center gap-3",children:[a.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:a.jsx("span",{className:"text-sm font-bold tracking-tight",children:"NDH"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Onboard a New Hospital / Clinic"}),a.jsx("p",{className:"text-xs text-slate-500",children:"This will create a dedicated NABH HIMS & EMR tenant with its own database."})]})]}),a.jsxs("form",{onSubmit:u,className:"space-y-5 rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm backdrop-blur",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital / Clinic Name"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 focus-within:ring-2 focus-within:ring-blue-200",children:[a.jsx(Ya,{className:"h-4 w-4 text-slate-400"}),a.jsx("input",{className:"w-full bg-transparent outline-none placeholder:text-slate-400",placeholder:"Kovai Multispeciality Hospital",value:t.tenant_name,onChange:d("tenant_name"),required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Code (Tenant Code)"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"KGH001",value:t.tenant_code,onChange:h=>n(m=>({...m,tenant_code:h.target.value.toUpperCase()}))}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Optional. If empty, the system will generate a code from the name."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Person"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Dr. Admin / IT Head",value:t.contact_person,onChange:d("contact_person"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Contact Phone"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"+91 9XXXXXXXXX",value:t.contact_phone,onChange:d("contact_phone")})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Hospital Address"}),a.jsx("textarea",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Address, City, State, Pincode",rows:2,value:t.hospital_address,onChange:d("hospital_address")})]})]}),a.jsxs("div",{className:"space-y-3 rounded-2xl border border-slate-100 bg-slate-50/70 p-4",children:[a.jsxs("div",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-slate-800",children:[a.jsx(Sp,{className:"h-4 w-4 text-blue-600"}),"Subscription & License Period"]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm text-slate-700",children:"Subscription Plan"}),a.jsxs("select",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.subscription_plan,onChange:d("subscription_plan"),children:[a.jsx("option",{value:"basic",children:"Basic (Monthly)"}),a.jsx("option",{value:"standard",children:"Standard (6 Months)"}),a.jsx("option",{value:"premium",children:"Premium (1 Year)"})]})]}),a.jsxs("div",{className:"text-xs text-slate-600 space-y-1",children:[a.jsx("p",{className:"font-medium text-slate-700",children:"License Duration (auto-calculated):"}),a.jsxs("ul",{className:"list-disc pl-4 space-y-0.5",children:[a.jsx("li",{children:"Basic  30 days from registration"}),a.jsx("li",{children:"Standard  6 months from registration"}),a.jsx("li",{children:"Premium  1 year from registration"})]}),a.jsx("p",{className:"pt-1 text-[11px] text-slate-500",children:"AMC, subscription amount, and renewals are configured by NUTRYAH admin in the master console. They are not editable from this screen."})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/80 p-4",children:[a.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm font-medium text-slate-800",children:[a.jsx(Yne,{className:"h-4 w-4 text-blue-600"}),"Admin Login for this Tenant"]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Name"}),a.jsx("input",{className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"Super Admin",value:t.admin_name,onChange:d("admin_name"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Admin Email"}),a.jsx("input",{type:"email",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none placeholder:text-slate-400 focus:ring-2 focus:ring-blue-200",placeholder:"admin@hospital.org",value:t.email,onChange:d("email"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Password"}),a.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.password,onChange:d("password"),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-600",children:"Confirm Password"}),a.jsx("input",{type:"password",className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-blue-200",value:t.confirm_password,onChange:d("confirm_password"),required:!0})]})]})]}),i&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:i}),a.jsx("button",{type:"submit",disabled:s,className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-medium text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",children:s?a.jsxs(a.Fragment,{children:[a.jsx(nn,{className:"h-4 w-4 animate-spin"}),"Creating Tenant"]}):"Create Tenant & Admin"}),a.jsx("p",{className:"text-center text-[11px] text-slate-500",children:"After this step, use the Hospital Code + Admin Email to login and access the dedicated HIMS database."})]})]})})]})}function gse(){var P,L;const t=sl(),n=Aa(),s=kr($=>$.verifyOtp),r=kr($=>$.fetchProfile),[i]=y.useState(((P=t.state)==null?void 0:P.email)||localStorage.getItem("pending_email")||""),[l]=y.useState(((L=t.state)==null?void 0:L.tenant_code)||localStorage.getItem("pending_tenant_code")||localStorage.getItem("tenant_code")||""),[o,c]=y.useState(["","","","","",""]),[d,u]=y.useState(""),[h,m]=y.useState(!1),[x,b]=y.useState(60),[w,j]=y.useState(!1),S=y.useRef([]);y.useEffect(()=>{(!i||!l)&&n("/auth/login",{replace:!0})},[i,l,n]),y.useEffect(()=>{if(x<=0)return;const $=setInterval(()=>b(B=>B-1),1e3);return()=>clearInterval($)},[x]);const C=y.useMemo(()=>o.join(""),[o]),A=C.length===6&&!o.includes("")&&!h,k=($,B)=>{var K;const V=(B||"").replace(/\D/g,"").slice(-1);c(z=>{const H=[...z];return H[$]=V,H}),V&&$<5&&((K=S.current[$+1])==null||K.focus())},T=($,B)=>{var V,K,z;B.key==="Backspace"?o[$]?c(H=>{const Y=[...H];return Y[$]="",Y}):$>0&&((V=S.current[$-1])==null||V.focus(),c(H=>{const Y=[...H];return Y[$-1]="",Y})):B.key==="ArrowLeft"&&$>0?(K=S.current[$-1])==null||K.focus():B.key==="ArrowRight"&&$<5&&((z=S.current[$+1])==null||z.focus())},I=$=>{var K;$.preventDefault();const B=($.clipboardData.getData("text")||"").replace(/\D/g,"").slice(0,6);if(!B)return;const V=B.split("");c([V[0]||"",V[1]||"",V[2]||"",V[3]||"",V[4]||"",V[5]||""]),(K=S.current[Math.min(B.length,5)])==null||K.focus()},D=async $=>{var B,V;if($.preventDefault(),!!A){u(""),m(!0);try{await s({tenant_code:l,email:i,otp:C}),await r(),j(!0),setTimeout(()=>{const K=kr.getState().user;K!=null&&K.is_admin?n("/admin",{replace:!0}):n("/dashboard",{replace:!0})},400)}catch(K){u(((V=(B=K==null?void 0:K.response)==null?void 0:B.data)==null?void 0:V.detail)||"Invalid or expired OTP")}finally{m(!1)}}},O=()=>{n("/auth/login",{state:{email:i,tenant_code:l},replace:!0})},R=()=>{O()};return a.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-b from-gray-50 to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[a.jsx("div",{className:"absolute -left-24 -top-24 h-64 w-64 rounded-full bg-blue-100 blur-3xl animate-pulse"}),a.jsx("div",{className:"absolute -right-24 -bottom-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl animate-pulse"})]}),a.jsx("div",{className:"relative z-10 grid min-h-screen place-items-center px-4 py-8",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-100 bg-white/80 p-6 shadow-sm backdrop-blur",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-blue-600 text-white ring-8 ring-blue-50",children:a.jsx("span",{className:"text-sm font-bold",children:"NDH"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"Verify OTP"}),a.jsx("p",{className:"text-xs text-gray-500",children:"We sent a 6-digit code to your email"})]})]}),a.jsx(Ji,{className:"h-6 w-6 text-emerald-600"})]}),a.jsxs("div",{className:"mb-4 space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[a.jsx(_p,{className:"h-4 w-4 text-gray-400"}),a.jsx("span",{className:"truncate",children:i}),a.jsx("button",{type:"button",onClick:O,className:"ml-auto text-xs text-blue-700 underline-offset-2 hover:underline",children:"Change"})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-gray-100 bg-gray-50 px-3 py-2 text-gray-700",children:[a.jsx(Ya,{className:"h-4 w-4 text-gray-400"}),a.jsxs("span",{className:"text-xs font-medium uppercase",children:["Hospital Code: ",l]})]})]}),a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-6 gap-2 sm:gap-3",onPaste:I,children:o.map(($,B)=>a.jsx("input",{ref:V=>S.current[B]=V,value:$,inputMode:"numeric",pattern:"[0-9]*",maxLength:1,autoFocus:B===0,onChange:V=>k(B,V.target.value),onKeyDown:V=>T(B,V),className:`h-12 rounded-xl border border-gray-200 text-center text-lg tracking-[0.2em] outline-none transition\r
                               focus:border-blue-400 focus:ring-2 focus:ring-blue-200 sm:h-14`,"aria-label":`OTP digit ${B+1}`},B))}),a.jsx("button",{className:"inline-flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2.5 text-white shadow-sm transition active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-60",disabled:!A,type:"submit",children:h?a.jsxs(a.Fragment,{children:[a.jsx(nn,{className:"h-5 w-5 animate-spin"}),"Verifying"]}):w?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"h-5 w-5"}),"Verified"]}):"Verify & Continue"}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[a.jsxs("button",{type:"button",onClick:O,className:"inline-flex items-center gap-1 rounded-lg px-2 py-1 hover:bg-gray-50",children:[a.jsx(Cb,{className:"h-3.5 w-3.5"}),"Back to login"]}),a.jsx("div",{className:"flex items-center gap-2",children:x>0?a.jsxs("span",{className:"rounded-lg bg-gray-50 px-2 py-1 tabular-nums",children:["Resend in ",x,"s"]}):a.jsx("button",{type:"button",onClick:R,className:"rounded-lg bg-gray-900 px-2 py-1 text-white hover:bg-gray-800",children:"Resend OTP"})})]}),d&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",role:"alert","aria-live":"polite",children:d})]}),h&&a.jsx("div",{className:"absolute inset-0 grid place-items-center rounded-2xl bg-white/70 backdrop-blur-sm",children:a.jsxs("div",{className:"w-full max-w-xs rounded-xl border border-gray-100 bg-white p-4 shadow-md",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-700",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin text-blue-600"}),"Verifying"]}),a.jsx("div",{className:"relative h-2 overflow-hidden rounded-full bg-gray-100",children:a.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 animate-[progress_1.1s_infinite_linear] rounded-full bg-gradient-to-r from-blue-500 to-indigo-500"})})]})})]}),a.jsx("div",{className:"mx-auto mt-6 text-center text-xs text-gray-500",children:"Didnt receive the mail? Check Spam/Junk folder."})]})}),a.jsx("style",{children:`
        @keyframes progress {
          0% { transform: translateX(-120%); }
          100% { transform: translateX(300%); }
        }
      `})]})}const h3=y.createContext({});function m3(t){const n=y.useRef(null);return n.current===null&&(n.current=t()),n.current}const p3=typeof window<"u",l7=p3?y.useLayoutEffect:y.useEffect,Eb=y.createContext(null);function x3(t,n){t.indexOf(n)===-1&&t.push(n)}function g3(t,n){const s=t.indexOf(n);s>-1&&t.splice(s,1)}const jo=(t,n,s)=>s>n?n:s<t?t:s;let y3=()=>{};const So={},o7=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function c7(t){return typeof t=="object"&&t!==null}const d7=t=>/^0[^.\s]+$/u.test(t);function b3(t){let n;return()=>(n===void 0&&(n=t()),n)}const Si=t=>t,yse=(t,n)=>s=>n(t(s)),bx=(...t)=>t.reduce(yse),kp=(t,n,s)=>{const r=n-t;return r===0?1:(s-t)/r};class v3{constructor(){this.subscriptions=[]}add(n){return x3(this.subscriptions,n),()=>g3(this.subscriptions,n)}notify(n,s,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](n,s,r);else for(let l=0;l<i;l++){const o=this.subscriptions[l];o&&o(n,s,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Il=t=>t*1e3,bi=t=>t/1e3;function u7(t,n){return n?t*(1e3/n):0}const f7=(t,n,s)=>(((1-3*s+3*n)*t+(3*s-6*n))*t+3*n)*t,bse=1e-7,vse=12;function wse(t,n,s,r,i){let l,o,c=0;do o=n+(s-n)/2,l=f7(o,r,i)-t,l>0?s=o:n=o;while(Math.abs(l)>bse&&++c<vse);return o}function vx(t,n,s,r){if(t===n&&s===r)return Si;const i=l=>wse(l,0,1,t,s);return l=>l===0||l===1?l:f7(i(l),n,r)}const h7=t=>n=>n<=.5?t(2*n)/2:(2-t(2*(1-n)))/2,m7=t=>n=>1-t(1-n),p7=vx(.33,1.53,.69,.99),w3=m7(p7),x7=h7(w3),g7=t=>(t*=2)<1?.5*w3(t):.5*(2-Math.pow(2,-10*(t-1))),N3=t=>1-Math.sin(Math.acos(t)),y7=m7(N3),b7=h7(N3),Nse=vx(.42,0,1,1),jse=vx(0,0,.58,1),v7=vx(.42,0,.58,1),Sse=t=>Array.isArray(t)&&typeof t[0]!="number",w7=t=>Array.isArray(t)&&typeof t[0]=="number",_se={linear:Si,easeIn:Nse,easeInOut:v7,easeOut:jse,circIn:N3,circInOut:b7,circOut:y7,backIn:w3,backInOut:x7,backOut:p7,anticipate:g7},Cse=t=>typeof t=="string",f4=t=>{if(w7(t)){y3(t.length===4);const[n,s,r,i]=t;return vx(n,s,r,i)}else if(Cse(t))return _se[t];return t},N0=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Ase(t,n){let s=new Set,r=new Set,i=!1,l=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function d(h){o.has(h)&&(u.schedule(h),t()),h(c)}const u={schedule:(h,m=!1,x=!1)=>{const w=x&&i?s:r;return m&&o.add(h),w.has(h)||w.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){l=!0;return}i=!0,[s,r]=[r,s],s.forEach(d),s.clear(),i=!1,l&&(l=!1,u.process(h))}};return u}const kse=40;function N7(t,n){let s=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},l=()=>s=!0,o=N0.reduce((k,T)=>(k[T]=Ase(l),k),{}),{setup:c,read:d,resolveKeyframes:u,preUpdate:h,update:m,preRender:x,render:b,postRender:w}=o,j=()=>{const k=So.useManualTiming?i.timestamp:performance.now();s=!1,So.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(k-i.timestamp,kse),1)),i.timestamp=k,i.isProcessing=!0,c.process(i),d.process(i),u.process(i),h.process(i),m.process(i),x.process(i),b.process(i),w.process(i),i.isProcessing=!1,s&&n&&(r=!1,t(j))},S=()=>{s=!0,r=!0,i.isProcessing||t(j)};return{schedule:N0.reduce((k,T)=>{const I=o[T];return k[T]=(D,O=!1,R=!1)=>(s||S(),I.schedule(D,O,R)),k},{}),cancel:k=>{for(let T=0;T<N0.length;T++)o[N0[T]].cancel(k)},state:i,steps:o}}const{schedule:Gn,cancel:Bc,state:jr,steps:uN}=N7(typeof requestAnimationFrame<"u"?requestAnimationFrame:Si,!0);let Mg;function Ese(){Mg=void 0}const ga={now:()=>(Mg===void 0&&ga.set(jr.isProcessing||So.useManualTiming?jr.timestamp:performance.now()),Mg),set:t=>{Mg=t,queueMicrotask(Ese)}},j7=t=>n=>typeof n=="string"&&n.startsWith(t),j3=j7("--"),Tse=j7("var(--"),S3=t=>Tse(t)?Ise.test(t.split("/*")[0].trim()):!1,Ise=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,jh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ep={...jh,transform:t=>jo(0,1,t)},j0={...jh,default:1},Km=t=>Math.round(t*1e5)/1e5,_3=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Pse(t){return t==null}const Mse=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,C3=(t,n)=>s=>!!(typeof s=="string"&&Mse.test(s)&&s.startsWith(t)||n&&!Pse(s)&&Object.prototype.hasOwnProperty.call(s,n)),S7=(t,n,s)=>r=>{if(typeof r!="string")return r;const[i,l,o,c]=r.match(_3);return{[t]:parseFloat(i),[n]:parseFloat(l),[s]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},Ose=t=>jo(0,255,t),fN={...jh,transform:t=>Math.round(Ose(t))},Od={test:C3("rgb","red"),parse:S7("red","green","blue"),transform:({red:t,green:n,blue:s,alpha:r=1})=>"rgba("+fN.transform(t)+", "+fN.transform(n)+", "+fN.transform(s)+", "+Km(Ep.transform(r))+")"};function Dse(t){let n="",s="",r="",i="";return t.length>5?(n=t.substring(1,3),s=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(n=t.substring(1,2),s=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),n+=n,s+=s,r+=r,i+=i),{red:parseInt(n,16),green:parseInt(s,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const lS={test:C3("#"),parse:Dse,transform:Od.transform},wx=t=>({test:n=>typeof n=="string"&&n.endsWith(t)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${t}`}),sc=wx("deg"),Pl=wx("%"),Mt=wx("px"),Rse=wx("vh"),Lse=wx("vw"),h4={...Pl,parse:t=>Pl.parse(t)/100,transform:t=>Pl.transform(t*100)},bf={test:C3("hsl","hue"),parse:S7("hue","saturation","lightness"),transform:({hue:t,saturation:n,lightness:s,alpha:r=1})=>"hsla("+Math.round(t)+", "+Pl.transform(Km(n))+", "+Pl.transform(Km(s))+", "+Km(Ep.transform(r))+")"},As={test:t=>Od.test(t)||lS.test(t)||bf.test(t),parse:t=>Od.test(t)?Od.parse(t):bf.test(t)?bf.parse(t):lS.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Od.transform(t):bf.transform(t),getAnimatableNone:t=>{const n=As.parse(t);return n.alpha=0,As.transform(n)}},Bse=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Fse(t){var n,s;return isNaN(t)&&typeof t=="string"&&(((n=t.match(_3))==null?void 0:n.length)||0)+(((s=t.match(Bse))==null?void 0:s.length)||0)>0}const _7="number",C7="color",$se="var",zse="var(",m4="${}",Use=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Tp(t){const n=t.toString(),s=[],r={color:[],number:[],var:[]},i=[];let l=0;const c=n.replace(Use,d=>(As.test(d)?(r.color.push(l),i.push(C7),s.push(As.parse(d))):d.startsWith(zse)?(r.var.push(l),i.push($se),s.push(d)):(r.number.push(l),i.push(_7),s.push(parseFloat(d))),++l,m4)).split(m4);return{values:s,split:c,indexes:r,types:i}}function A7(t){return Tp(t).values}function k7(t){const{split:n,types:s}=Tp(t),r=n.length;return i=>{let l="";for(let o=0;o<r;o++)if(l+=n[o],i[o]!==void 0){const c=s[o];c===_7?l+=Km(i[o]):c===C7?l+=As.transform(i[o]):l+=i[o]}return l}}const Vse=t=>typeof t=="number"?0:As.test(t)?As.getAnimatableNone(t):t;function Hse(t){const n=A7(t);return k7(t)(n.map(Vse))}const Fc={test:Fse,parse:A7,createTransformer:k7,getAnimatableNone:Hse};function hN(t,n,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+(n-t)*6*s:s<1/2?n:s<2/3?t+(n-t)*(2/3-s)*6:t}function Wse({hue:t,saturation:n,lightness:s,alpha:r}){t/=360,n/=100,s/=100;let i=0,l=0,o=0;if(!n)i=l=o=s;else{const c=s<.5?s*(1+n):s+n-s*n,d=2*s-c;i=hN(d,c,t+1/3),l=hN(d,c,t),o=hN(d,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(l*255),blue:Math.round(o*255),alpha:r}}function P1(t,n){return s=>s>0?n:t}const ts=(t,n,s)=>t+(n-t)*s,mN=(t,n,s)=>{const r=t*t,i=s*(n*n-r)+r;return i<0?0:Math.sqrt(i)},qse=[lS,Od,bf],Gse=t=>qse.find(n=>n.test(t));function p4(t){const n=Gse(t);if(!n)return!1;let s=n.parse(t);return n===bf&&(s=Wse(s)),s}const x4=(t,n)=>{const s=p4(t),r=p4(n);if(!s||!r)return P1(t,n);const i={...s};return l=>(i.red=mN(s.red,r.red,l),i.green=mN(s.green,r.green,l),i.blue=mN(s.blue,r.blue,l),i.alpha=ts(s.alpha,r.alpha,l),Od.transform(i))},oS=new Set(["none","hidden"]);function Kse(t,n){return oS.has(t)?s=>s<=0?t:n:s=>s>=1?n:t}function Yse(t,n){return s=>ts(t,n,s)}function A3(t){return typeof t=="number"?Yse:typeof t=="string"?S3(t)?P1:As.test(t)?x4:Zse:Array.isArray(t)?E7:typeof t=="object"?As.test(t)?x4:Xse:P1}function E7(t,n){const s=[...t],r=s.length,i=t.map((l,o)=>A3(l)(l,n[o]));return l=>{for(let o=0;o<r;o++)s[o]=i[o](l);return s}}function Xse(t,n){const s={...t,...n},r={};for(const i in s)t[i]!==void 0&&n[i]!==void 0&&(r[i]=A3(t[i])(t[i],n[i]));return i=>{for(const l in r)s[l]=r[l](i);return s}}function Qse(t,n){const s=[],r={color:0,var:0,number:0};for(let i=0;i<n.values.length;i++){const l=n.types[i],o=t.indexes[l][r[l]],c=t.values[o]??0;s[i]=c,r[l]++}return s}const Zse=(t,n)=>{const s=Fc.createTransformer(n),r=Tp(t),i=Tp(n);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?oS.has(t)&&!i.values.length||oS.has(n)&&!r.values.length?Kse(t,n):bx(E7(Qse(r,i),i.values),s):P1(t,n)};function T7(t,n,s){return typeof t=="number"&&typeof n=="number"&&typeof s=="number"?ts(t,n,s):A3(t)(t,n)}const Jse=t=>{const n=({timestamp:s})=>t(s);return{start:(s=!0)=>Gn.update(n,s),stop:()=>Bc(n),now:()=>jr.isProcessing?jr.timestamp:ga.now()}},I7=(t,n,s=10)=>{let r="";const i=Math.max(Math.round(n/s),2);for(let l=0;l<i;l++)r+=Math.round(t(l/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},M1=2e4;function k3(t){let n=0;const s=50;let r=t.next(n);for(;!r.done&&n<M1;)n+=s,r=t.next(n);return n>=M1?1/0:n}function ere(t,n=100,s){const r=s({...t,keyframes:[0,n]}),i=Math.min(k3(r),M1);return{type:"keyframes",ease:l=>r.next(i*l).value/n,duration:bi(i)}}const tre=5;function P7(t,n,s){const r=Math.max(n-tre,0);return u7(s-t(r),n-r)}const us={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},pN=.001;function nre({duration:t=us.duration,bounce:n=us.bounce,velocity:s=us.velocity,mass:r=us.mass}){let i,l,o=1-n;o=jo(us.minDamping,us.maxDamping,o),t=jo(us.minDuration,us.maxDuration,bi(t)),o<1?(i=u=>{const h=u*o,m=h*t,x=h-s,b=cS(u,o),w=Math.exp(-m);return pN-x/b*w},l=u=>{const m=u*o*t,x=m*s+s,b=Math.pow(o,2)*Math.pow(u,2)*t,w=Math.exp(-m),j=cS(Math.pow(u,2),o);return(-i(u)+pN>0?-1:1)*((x-b)*w)/j}):(i=u=>{const h=Math.exp(-u*t),m=(u-s)*t+1;return-pN+h*m},l=u=>{const h=Math.exp(-u*t),m=(s-u)*(t*t);return h*m});const c=5/t,d=rre(i,l,c);if(t=Il(t),isNaN(d))return{stiffness:us.stiffness,damping:us.damping,duration:t};{const u=Math.pow(d,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const sre=12;function rre(t,n,s){let r=s;for(let i=1;i<sre;i++)r=r-t(r)/n(r);return r}function cS(t,n){return t*Math.sqrt(1-n*n)}const are=["duration","bounce"],ire=["stiffness","damping","mass"];function g4(t,n){return n.some(s=>t[s]!==void 0)}function lre(t){let n={velocity:us.velocity,stiffness:us.stiffness,damping:us.damping,mass:us.mass,isResolvedFromDuration:!1,...t};if(!g4(t,ire)&&g4(t,are))if(t.visualDuration){const s=t.visualDuration,r=2*Math.PI/(s*1.2),i=r*r,l=2*jo(.05,1,1-(t.bounce||0))*Math.sqrt(i);n={...n,mass:us.mass,stiffness:i,damping:l}}else{const s=nre(t);n={...n,...s,mass:us.mass},n.isResolvedFromDuration=!0}return n}function O1(t=us.visualDuration,n=us.bounce){const s=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:n}:t;let{restSpeed:r,restDelta:i}=s;const l=s.keyframes[0],o=s.keyframes[s.keyframes.length-1],c={done:!1,value:l},{stiffness:d,damping:u,mass:h,duration:m,velocity:x,isResolvedFromDuration:b}=lre({...s,velocity:-bi(s.velocity||0)}),w=x||0,j=u/(2*Math.sqrt(d*h)),S=o-l,C=bi(Math.sqrt(d/h)),A=Math.abs(S)<5;r||(r=A?us.restSpeed.granular:us.restSpeed.default),i||(i=A?us.restDelta.granular:us.restDelta.default);let k;if(j<1){const I=cS(C,j);k=D=>{const O=Math.exp(-j*C*D);return o-O*((w+j*C*S)/I*Math.sin(I*D)+S*Math.cos(I*D))}}else if(j===1)k=I=>o-Math.exp(-C*I)*(S+(w+C*S)*I);else{const I=C*Math.sqrt(j*j-1);k=D=>{const O=Math.exp(-j*C*D),R=Math.min(I*D,300);return o-O*((w+j*C*S)*Math.sinh(R)+I*S*Math.cosh(R))/I}}const T={calculatedDuration:b&&m||null,next:I=>{const D=k(I);if(b)c.done=I>=m;else{let O=I===0?w:0;j<1&&(O=I===0?Il(w):P7(k,I,D));const R=Math.abs(O)<=r,P=Math.abs(o-D)<=i;c.done=R&&P}return c.value=c.done?o:D,c},toString:()=>{const I=Math.min(k3(T),M1),D=I7(O=>T.next(I*O).value,I,30);return I+"ms "+D},toTransition:()=>{}};return T}O1.applyToOptions=t=>{const n=ere(t,100,O1);return t.ease=n.ease,t.duration=Il(n.duration),t.type="keyframes",t};function dS({keyframes:t,velocity:n=0,power:s=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:l=500,modifyTarget:o,min:c,max:d,restDelta:u=.5,restSpeed:h}){const m=t[0],x={done:!1,value:m},b=R=>c!==void 0&&R<c||d!==void 0&&R>d,w=R=>c===void 0?d:d===void 0||Math.abs(c-R)<Math.abs(d-R)?c:d;let j=s*n;const S=m+j,C=o===void 0?S:o(S);C!==S&&(j=C-m);const A=R=>-j*Math.exp(-R/r),k=R=>C+A(R),T=R=>{const P=A(R),L=k(R);x.done=Math.abs(P)<=u,x.value=x.done?C:L};let I,D;const O=R=>{b(x.value)&&(I=R,D=O1({keyframes:[x.value,w(x.value)],velocity:P7(k,R,x.value),damping:i,stiffness:l,restDelta:u,restSpeed:h}))};return O(0),{calculatedDuration:null,next:R=>{let P=!1;return!D&&I===void 0&&(P=!0,T(R),O(R)),I!==void 0&&R>=I?D.next(R-I):(!P&&T(R),x)}}}function ore(t,n,s){const r=[],i=s||So.mix||T7,l=t.length-1;for(let o=0;o<l;o++){let c=i(t[o],t[o+1]);if(n){const d=Array.isArray(n)?n[o]||Si:n;c=bx(d,c)}r.push(c)}return r}function cre(t,n,{clamp:s=!0,ease:r,mixer:i}={}){const l=t.length;if(y3(l===n.length),l===1)return()=>n[0];if(l===2&&n[0]===n[1])return()=>n[1];const o=t[0]===t[1];t[0]>t[l-1]&&(t=[...t].reverse(),n=[...n].reverse());const c=ore(n,r,i),d=c.length,u=h=>{if(o&&h<t[0])return n[0];let m=0;if(d>1)for(;m<t.length-2&&!(h<t[m+1]);m++);const x=kp(t[m],t[m+1],h);return c[m](x)};return s?h=>u(jo(t[0],t[l-1],h)):u}function dre(t,n){const s=t[t.length-1];for(let r=1;r<=n;r++){const i=kp(0,n,r);t.push(ts(s,1,i))}}function ure(t){const n=[0];return dre(n,t.length-1),n}function fre(t,n){return t.map(s=>s*n)}function hre(t,n){return t.map(()=>n||v7).splice(0,t.length-1)}function Ym({duration:t=300,keyframes:n,times:s,ease:r="easeInOut"}){const i=Sse(r)?r.map(f4):f4(r),l={done:!1,value:n[0]},o=fre(s&&s.length===n.length?s:ure(n),t),c=cre(o,n,{ease:Array.isArray(i)?i:hre(n,i)});return{calculatedDuration:t,next:d=>(l.value=c(d),l.done=d>=t,l)}}const mre=t=>t!==null;function E3(t,{repeat:n,repeatType:s="loop"},r,i=1){const l=t.filter(mre),c=i<0||n&&s!=="loop"&&n%2===1?0:l.length-1;return!c||r===void 0?l[c]:r}const pre={decay:dS,inertia:dS,tween:Ym,keyframes:Ym,spring:O1};function M7(t){typeof t.type=="string"&&(t.type=pre[t.type])}class T3{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(n=>{this.resolve=n})}notifyFinished(){this.resolve()}then(n,s){return this.finished.then(n,s)}}const xre=t=>t/100;class I3 extends T3{constructor(n){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,i;const{motionValue:s}=this.options;s&&s.updatedAt!==ga.now()&&this.tick(ga.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(r=this.options).onStop)==null||i.call(r))},this.options=n,this.initAnimation(),this.play(),n.autoplay===!1&&this.pause()}initAnimation(){const{options:n}=this;M7(n);const{type:s=Ym,repeat:r=0,repeatDelay:i=0,repeatType:l,velocity:o=0}=n;let{keyframes:c}=n;const d=s||Ym;d!==Ym&&typeof c[0]!="number"&&(this.mixKeyframes=bx(xre,T7(c[0],c[1])),c=[0,100]);const u=d({...n,keyframes:c});l==="mirror"&&(this.mirroredGenerator=d({...n,keyframes:[...c].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=k3(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=u}updateTime(n){const s=Math.round(n-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=s}tick(n,s=!1){const{generator:r,totalDuration:i,mixKeyframes:l,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:d}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:h,repeat:m,repeatType:x,repeatDelay:b,type:w,onUpdate:j,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-i/this.speed,this.startTime)),s?this.currentTime=n:this.updateTime(n);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?C<0:C>i;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let k=this.currentTime,T=r;if(m){const R=Math.min(this.currentTime,i)/c;let P=Math.floor(R),L=R%1;!L&&R>=1&&(L=1),L===1&&P--,P=Math.min(P,m+1),!!(P%2)&&(x==="reverse"?(L=1-L,b&&(L-=b/c)):x==="mirror"&&(T=o)),k=jo(0,1,L)*c}const I=A?{done:!1,value:h[0]}:T.next(k);l&&(I.value=l(I.value));let{done:D}=I;!A&&d!==null&&(D=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const O=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&D);return O&&w!==dS&&(I.value=E3(h,this.options,S,this.speed)),j&&j(I.value),O&&this.finish(),I}then(n,s){return this.finished.then(n,s)}get duration(){return bi(this.calculatedDuration)}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+bi(n)}get time(){return bi(this.currentTime)}set time(n){var s;n=Il(n),this.currentTime=n,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.playbackSpeed),(s=this.driver)==null||s.start(!1)}get speed(){return this.playbackSpeed}set speed(n){this.updateTime(ga.now());const s=this.playbackSpeed!==n;this.playbackSpeed=n,s&&(this.time=bi(this.currentTime))}play(){var i,l;if(this.isStopped)return;const{driver:n=Jse,startTime:s}=this.options;this.driver||(this.driver=n(o=>this.tick(o))),(l=(i=this.options).onPlay)==null||l.call(i);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=s??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ga.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var n,s;this.notifyFinished(),this.teardown(),this.state="finished",(s=(n=this.options).onComplete)==null||s.call(n)}cancel(){var n,s;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(s=(n=this.options).onCancel)==null||s.call(n)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}attachTimeline(n){var s;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(s=this.driver)==null||s.stop(),n.observe(this)}}function gre(t){for(let n=1;n<t.length;n++)t[n]??(t[n]=t[n-1])}const Dd=t=>t*180/Math.PI,uS=t=>{const n=Dd(Math.atan2(t[1],t[0]));return fS(n)},yre={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:uS,rotateZ:uS,skewX:t=>Dd(Math.atan(t[1])),skewY:t=>Dd(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},fS=t=>(t=t%360,t<0&&(t+=360),t),y4=uS,b4=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),v4=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),bre={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:b4,scaleY:v4,scale:t=>(b4(t)+v4(t))/2,rotateX:t=>fS(Dd(Math.atan2(t[6],t[5]))),rotateY:t=>fS(Dd(Math.atan2(-t[2],t[0]))),rotateZ:y4,rotate:y4,skewX:t=>Dd(Math.atan(t[4])),skewY:t=>Dd(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function hS(t){return t.includes("scale")?1:0}function mS(t,n){if(!t||t==="none")return hS(n);const s=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(s)r=bre,i=s;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=yre,i=c}if(!i)return hS(n);const l=r[n],o=i[1].split(",").map(wre);return typeof l=="function"?l(o):o[l]}const vre=(t,n)=>{const{transform:s="none"}=getComputedStyle(t);return mS(s,n)};function wre(t){return parseFloat(t.trim())}const Sh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_h=new Set(Sh),w4=t=>t===jh||t===Mt,Nre=new Set(["x","y","z"]),jre=Sh.filter(t=>!Nre.has(t));function Sre(t){const n=[];return jre.forEach(s=>{const r=t.getValue(s);r!==void 0&&(n.push([s,r.get()]),r.set(s.startsWith("scale")?1:0))}),n}const qd={width:({x:t},{paddingLeft:n="0",paddingRight:s="0"})=>t.max-t.min-parseFloat(n)-parseFloat(s),height:({y:t},{paddingTop:n="0",paddingBottom:s="0"})=>t.max-t.min-parseFloat(n)-parseFloat(s),top:(t,{top:n})=>parseFloat(n),left:(t,{left:n})=>parseFloat(n),bottom:({y:t},{top:n})=>parseFloat(n)+(t.max-t.min),right:({x:t},{left:n})=>parseFloat(n)+(t.max-t.min),x:(t,{transform:n})=>mS(n,"x"),y:(t,{transform:n})=>mS(n,"y")};qd.translateX=qd.x;qd.translateY=qd.y;const Gd=new Set;let pS=!1,xS=!1,gS=!1;function O7(){if(xS){const t=Array.from(Gd).filter(r=>r.needsMeasurement),n=new Set(t.map(r=>r.element)),s=new Map;n.forEach(r=>{const i=Sre(r);i.length&&(s.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),n.forEach(r=>{r.render();const i=s.get(r);i&&i.forEach(([l,o])=>{var c;(c=r.getValue(l))==null||c.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}xS=!1,pS=!1,Gd.forEach(t=>t.complete(gS)),Gd.clear()}function D7(){Gd.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(xS=!0)})}function _re(){gS=!0,D7(),O7(),gS=!1}class P3{constructor(n,s,r,i,l,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...n],this.onComplete=s,this.name=r,this.motionValue=i,this.element=l,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Gd.add(this),pS||(pS=!0,Gn.read(D7),Gn.resolveKeyframes(O7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:s,element:r,motionValue:i}=this;if(n[0]===null){const l=i==null?void 0:i.get(),o=n[n.length-1];if(l!==void 0)n[0]=l;else if(r&&s){const c=r.readValue(s,o);c!=null&&(n[0]=c)}n[0]===void 0&&(n[0]=o),i&&l===void 0&&i.set(n[0])}gre(n)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(n=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,n),Gd.delete(this)}cancel(){this.state==="scheduled"&&(Gd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Cre=t=>t.startsWith("--");function Are(t,n,s){Cre(n)?t.style.setProperty(n,s):t.style[n]=s}const kre=b3(()=>window.ScrollTimeline!==void 0),Ere={};function Tre(t,n){const s=b3(t);return()=>Ere[n]??s()}const R7=Tre(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Pm=([t,n,s,r])=>`cubic-bezier(${t}, ${n}, ${s}, ${r})`,N4={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Pm([0,.65,.55,1]),circOut:Pm([.55,0,1,.45]),backIn:Pm([.31,.01,.66,-.59]),backOut:Pm([.33,1.53,.69,.99])};function L7(t,n){if(t)return typeof t=="function"?R7()?I7(t,n):"ease-out":w7(t)?Pm(t):Array.isArray(t)?t.map(s=>L7(s,n)||N4.easeOut):N4[t]}function Ire(t,n,s,{delay:r=0,duration:i=300,repeat:l=0,repeatType:o="loop",ease:c="easeOut",times:d}={},u=void 0){const h={[n]:s};d&&(h.offset=d);const m=L7(c,i);Array.isArray(m)&&(h.easing=m);const x={delay:r,duration:i,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:l+1,direction:o==="reverse"?"alternate":"normal"};return u&&(x.pseudoElement=u),t.animate(h,x)}function B7(t){return typeof t=="function"&&"applyToOptions"in t}function Pre({type:t,...n}){return B7(t)&&R7()?t.applyToOptions(n):(n.duration??(n.duration=300),n.ease??(n.ease="easeOut"),n)}class Mre extends T3{constructor(n){if(super(),this.finishedTime=null,this.isStopped=!1,!n)return;const{element:s,name:r,keyframes:i,pseudoElement:l,allowFlatten:o=!1,finalKeyframe:c,onComplete:d}=n;this.isPseudoElement=!!l,this.allowFlatten=o,this.options=n,y3(typeof n.type!="string");const u=Pre(n);this.animation=Ire(s,r,i,u,l),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const h=E3(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):Are(s,r,h),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var n,s;(s=(n=this.animation).finish)==null||s.call(n)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:n}=this;n==="idle"||n==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var n,s;this.isPseudoElement||(s=(n=this.animation).commitStyles)==null||s.call(n)}get duration(){var s,r;const n=((r=(s=this.animation.effect)==null?void 0:s.getComputedTiming)==null?void 0:r.call(s).duration)||0;return bi(Number(n))}get iterationDuration(){const{delay:n=0}=this.options||{};return this.duration+bi(n)}get time(){return bi(Number(this.animation.currentTime)||0)}set time(n){this.finishedTime=null,this.animation.currentTime=Il(n)}get speed(){return this.animation.playbackRate}set speed(n){n<0&&(this.finishedTime=null),this.animation.playbackRate=n}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(n){this.animation.startTime=n}attachTimeline({timeline:n,observe:s}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,n&&kre()?(this.animation.timeline=n,Si):s(this)}}const F7={anticipate:g7,backInOut:x7,circInOut:b7};function Ore(t){return t in F7}function Dre(t){typeof t.ease=="string"&&Ore(t.ease)&&(t.ease=F7[t.ease])}const j4=10;class Rre extends Mre{constructor(n){Dre(n),M7(n),super(n),n.startTime&&(this.startTime=n.startTime),this.options=n}updateMotionValue(n){const{motionValue:s,onUpdate:r,onComplete:i,element:l,...o}=this.options;if(!s)return;if(n!==void 0){s.set(n);return}const c=new I3({...o,autoplay:!1}),d=Il(this.finishedTime??this.time);s.setWithVelocity(c.sample(d-j4).value,c.sample(d).value,j4),c.stop()}}const S4=(t,n)=>n==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Fc.test(t)||t==="0")&&!t.startsWith("url("));function Lre(t){const n=t[0];if(t.length===1)return!0;for(let s=0;s<t.length;s++)if(t[s]!==n)return!0}function Bre(t,n,s,r){const i=t[0];if(i===null)return!1;if(n==="display"||n==="visibility")return!0;const l=t[t.length-1],o=S4(i,n),c=S4(l,n);return!o||!c?!1:Lre(t)||(s==="spring"||B7(s))&&r}function yS(t){t.duration=0,t.type="keyframes"}const Fre=new Set(["opacity","clipPath","filter","transform"]),$re=b3(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function zre(t){var h;const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:l,type:o}=t;if(!(((h=n==null?void 0:n.owner)==null?void 0:h.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:u}=n.owner.getProps();return $re()&&s&&Fre.has(s)&&(s!=="transform"||!u)&&!d&&!r&&i!=="mirror"&&l!==0&&o!=="inertia"}const Ure=40;class Vre extends T3{constructor({autoplay:n=!0,delay:s=0,type:r="keyframes",repeat:i=0,repeatDelay:l=0,repeatType:o="loop",keyframes:c,name:d,motionValue:u,element:h,...m}){var w;super(),this.stop=()=>{var j,S;this._animation&&(this._animation.stop(),(j=this.stopTimeline)==null||j.call(this)),(S=this.keyframeResolver)==null||S.cancel()},this.createdAt=ga.now();const x={autoplay:n,delay:s,type:r,repeat:i,repeatDelay:l,repeatType:o,name:d,motionValue:u,element:h,...m},b=(h==null?void 0:h.KeyframeResolver)||P3;this.keyframeResolver=new b(c,(j,S,C)=>this.onKeyframesResolved(j,S,x,!C),d,u,h),(w=this.keyframeResolver)==null||w.scheduleResolve()}onKeyframesResolved(n,s,r,i){this.keyframeResolver=void 0;const{name:l,type:o,velocity:c,delay:d,isHandoff:u,onUpdate:h}=r;this.resolvedAt=ga.now(),Bre(n,l,o,c)||((So.instantAnimations||!d)&&(h==null||h(E3(n,r,s))),n[0]=n[n.length-1],yS(r),r.repeat=0);const x={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Ure?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:s,...r,keyframes:n},b=!u&&zre(x)?new Rre({...x,element:x.motionValue.owner.current}):new I3(x);b.finished.then(()=>this.notifyFinished()).catch(Si),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(n,s){return this.finished.finally(n).then(()=>{})}get animation(){var n;return this._animation||((n=this.keyframeResolver)==null||n.resume(),_re()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(n){this.animation.time=n}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(n){this.animation.speed=n}get startTime(){return this.animation.startTime}attachTimeline(n){return this._animation?this.stopTimeline=this.animation.attachTimeline(n):this.pendingTimeline=n,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var n;this._animation&&this.animation.cancel(),(n=this.keyframeResolver)==null||n.cancel()}}const Hre=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Wre(t){const n=Hre.exec(t);if(!n)return[,];const[,s,r,i]=n;return[`--${s??r}`,i]}function $7(t,n,s=1){const[r,i]=Wre(t);if(!r)return;const l=window.getComputedStyle(n).getPropertyValue(r);if(l){const o=l.trim();return o7(o)?parseFloat(o):o}return S3(i)?$7(i,n,s+1):i}function M3(t,n){return(t==null?void 0:t[n])??(t==null?void 0:t.default)??t}const z7=new Set(["width","height","top","left","right","bottom",...Sh]),qre={test:t=>t==="auto",parse:t=>t},U7=t=>n=>n.test(t),V7=[jh,Mt,Pl,sc,Lse,Rse,qre],_4=t=>V7.find(U7(t));function Gre(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||d7(t):!0}const Kre=new Set(["brightness","contrast","saturate","opacity"]);function Yre(t){const[n,s]=t.slice(0,-1).split("(");if(n==="drop-shadow")return t;const[r]=s.match(_3)||[];if(!r)return t;const i=s.replace(r,"");let l=Kre.has(n)?1:0;return r!==s&&(l*=100),n+"("+l+i+")"}const Xre=/\b([a-z-]*)\(.*?\)/gu,bS={...Fc,getAnimatableNone:t=>{const n=t.match(Xre);return n?n.map(Yre).join(" "):t}},C4={...jh,transform:Math.round},Qre={rotate:sc,rotateX:sc,rotateY:sc,rotateZ:sc,scale:j0,scaleX:j0,scaleY:j0,scaleZ:j0,skew:sc,skewX:sc,skewY:sc,distance:Mt,translateX:Mt,translateY:Mt,translateZ:Mt,x:Mt,y:Mt,z:Mt,perspective:Mt,transformPerspective:Mt,opacity:Ep,originX:h4,originY:h4,originZ:Mt},O3={borderWidth:Mt,borderTopWidth:Mt,borderRightWidth:Mt,borderBottomWidth:Mt,borderLeftWidth:Mt,borderRadius:Mt,radius:Mt,borderTopLeftRadius:Mt,borderTopRightRadius:Mt,borderBottomRightRadius:Mt,borderBottomLeftRadius:Mt,width:Mt,maxWidth:Mt,height:Mt,maxHeight:Mt,top:Mt,right:Mt,bottom:Mt,left:Mt,padding:Mt,paddingTop:Mt,paddingRight:Mt,paddingBottom:Mt,paddingLeft:Mt,margin:Mt,marginTop:Mt,marginRight:Mt,marginBottom:Mt,marginLeft:Mt,backgroundPositionX:Mt,backgroundPositionY:Mt,...Qre,zIndex:C4,fillOpacity:Ep,strokeOpacity:Ep,numOctaves:C4},Zre={...O3,color:As,backgroundColor:As,outlineColor:As,fill:As,stroke:As,borderColor:As,borderTopColor:As,borderRightColor:As,borderBottomColor:As,borderLeftColor:As,filter:bS,WebkitFilter:bS},H7=t=>Zre[t];function W7(t,n){let s=H7(t);return s!==bS&&(s=Fc),s.getAnimatableNone?s.getAnimatableNone(n):void 0}const Jre=new Set(["auto","none","0"]);function eae(t,n,s){let r=0,i;for(;r<t.length&&!i;){const l=t[r];typeof l=="string"&&!Jre.has(l)&&Tp(l).values.length&&(i=t[r]),r++}if(i&&s)for(const l of n)t[l]=W7(s,i)}class tae extends P3{constructor(n,s,r,i,l){super(n,s,r,i,l,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:s,name:r}=this;if(!s||!s.current)return;super.readKeyframes();for(let d=0;d<n.length;d++){let u=n[d];if(typeof u=="string"&&(u=u.trim(),S3(u))){const h=$7(u,s.current);h!==void 0&&(n[d]=h),d===n.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!z7.has(r)||n.length!==2)return;const[i,l]=n,o=_4(i),c=_4(l);if(o!==c)if(w4(o)&&w4(c))for(let d=0;d<n.length;d++){const u=n[d];typeof u=="string"&&(n[d]=parseFloat(u))}else qd[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:s}=this,r=[];for(let i=0;i<n.length;i++)(n[i]===null||Gre(n[i]))&&r.push(i);r.length&&eae(n,r,s)}measureInitialState(){const{element:n,unresolvedKeyframes:s,name:r}=this;if(!n||!n.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qd[r](n.measureViewportBox(),window.getComputedStyle(n.current)),s[0]=this.measuredOrigin;const i=s[s.length-1];i!==void 0&&n.getValue(r,i).jump(i,!1)}measureEndState(){var c;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const l=r.length-1,o=r[l];r[l]=qd[s](n.measureViewportBox(),window.getComputedStyle(n.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([d,u])=>{n.getValue(d).set(u)}),this.resolveNoneKeyframes()}}function nae(t,n,s){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const i=(s==null?void 0:s[t])??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const q7=(t,n)=>n&&typeof t=="number"?n.transform(t):t;function G7(t){return c7(t)&&"offsetHeight"in t}const A4=30,sae=t=>!isNaN(parseFloat(t));class rae{constructor(n,s={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var l;const i=ga.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(n),this.owner=s.owner}setCurrent(n){this.current=n,this.updatedAt=ga.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=sae(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,s){this.events[n]||(this.events[n]=new v3);const r=this.events[n].add(s);return n==="change"?()=>{r(),Gn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,s){this.passiveEffect=n,this.stopPassiveEffect=s}set(n){this.passiveEffect?this.passiveEffect(n,this.updateAndNotify):this.updateAndNotify(n)}setWithVelocity(n,s,r){this.set(s),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-r}jump(n,s=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var n;(n=this.events.change)==null||n.notify(this.current)}addDependent(n){this.dependents||(this.dependents=new Set),this.dependents.add(n)}removeDependent(n){this.dependents&&this.dependents.delete(n)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=ga.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>A4)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,A4);return u7(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(n){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=n(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var n,s;(n=this.dependents)==null||n.clear(),(s=this.events.destroy)==null||s.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Qf(t,n){return new rae(t,n)}const{schedule:D3}=N7(queueMicrotask,!1),Fi={x:!1,y:!1};function K7(){return Fi.x||Fi.y}function aae(t){return t==="x"||t==="y"?Fi[t]?null:(Fi[t]=!0,()=>{Fi[t]=!1}):Fi.x||Fi.y?null:(Fi.x=Fi.y=!0,()=>{Fi.x=Fi.y=!1})}function Y7(t,n){const s=nae(t),r=new AbortController,i={passive:!0,...n,signal:r.signal};return[s,i,()=>r.abort()]}function k4(t){return!(t.pointerType==="touch"||K7())}function iae(t,n,s={}){const[r,i,l]=Y7(t,s),o=c=>{if(!k4(c))return;const{target:d}=c,u=n(d,c);if(typeof u!="function"||!d)return;const h=m=>{k4(m)&&(u(m),d.removeEventListener("pointerleave",h))};d.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),l}const X7=(t,n)=>n?t===n?!0:X7(t,n.parentElement):!1,R3=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,lae=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function oae(t){return lae.has(t.tagName)||t.tabIndex!==-1}const Og=new WeakSet;function E4(t){return n=>{n.key==="Enter"&&t(n)}}function xN(t,n){t.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const cae=(t,n)=>{const s=t.currentTarget;if(!s)return;const r=E4(()=>{if(Og.has(s))return;xN(s,"down");const i=E4(()=>{xN(s,"up")}),l=()=>xN(s,"cancel");s.addEventListener("keyup",i,n),s.addEventListener("blur",l,n)});s.addEventListener("keydown",r,n),s.addEventListener("blur",()=>s.removeEventListener("keydown",r),n)};function T4(t){return R3(t)&&!K7()}function dae(t,n,s={}){const[r,i,l]=Y7(t,s),o=c=>{const d=c.currentTarget;if(!T4(c))return;Og.add(d);const u=n(d,c),h=(b,w)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",x),Og.has(d)&&Og.delete(d),T4(b)&&typeof u=="function"&&u(b,{success:w})},m=b=>{h(b,d===window||d===document||s.useGlobalTarget||X7(d,b.target))},x=b=>{h(b,!1)};window.addEventListener("pointerup",m,i),window.addEventListener("pointercancel",x,i)};return r.forEach(c=>{(s.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),G7(c)&&(c.addEventListener("focus",u=>cae(u,i)),!oae(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),l}function Q7(t){return c7(t)&&"ownerSVGElement"in t}function uae(t){return Q7(t)&&t.tagName==="svg"}const Br=t=>!!(t&&t.getVelocity),fae=[...V7,As,Fc],hae=t=>fae.find(U7(t)),L3=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function I4(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function mae(...t){return n=>{let s=!1;const r=t.map(i=>{const l=I4(i,n);return!s&&typeof l=="function"&&(s=!0),l});if(s)return()=>{for(let i=0;i<r.length;i++){const l=r[i];typeof l=="function"?l():I4(t[i],null)}}}}function pae(...t){return y.useCallback(mae(...t),t)}class xae extends y.Component{getSnapshotBeforeUpdate(n){const s=this.props.childRef.current;if(s&&n.isPresent&&!this.props.isPresent){const r=s.offsetParent,i=G7(r)&&r.offsetWidth||0,l=this.props.sizeRef.current;l.height=s.offsetHeight||0,l.width=s.offsetWidth||0,l.top=s.offsetTop,l.left=s.offsetLeft,l.right=i-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function gae({children:t,isPresent:n,anchorX:s,root:r}){const i=y.useId(),l=y.useRef(null),o=y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=y.useContext(L3),d=pae(l,t==null?void 0:t.ref);return y.useInsertionEffect(()=>{const{width:u,height:h,top:m,left:x,right:b}=o.current;if(n||!l.current||!u||!h)return;const w=s==="left"?`left: ${x}`:`right: ${b}`;l.current.dataset.motionPopId=i;const j=document.createElement("style");c&&(j.nonce=c);const S=r??document.head;return S.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${h}px !important;
            ${w}px !important;
            top: ${m}px !important;
          }
        `),()=>{S.contains(j)&&S.removeChild(j)}},[n]),a.jsx(xae,{isPresent:n,childRef:l,sizeRef:o,children:y.cloneElement(t,{ref:d})})}const yae=({children:t,initial:n,isPresent:s,onExitComplete:r,custom:i,presenceAffectsLayout:l,mode:o,anchorX:c,root:d})=>{const u=m3(bae),h=y.useId();let m=!0,x=y.useMemo(()=>(m=!1,{id:h,initial:n,isPresent:s,custom:i,onExitComplete:b=>{u.set(b,!0);for(const w of u.values())if(!w)return;r&&r()},register:b=>(u.set(b,!1),()=>u.delete(b))}),[s,u,r]);return l&&m&&(x={...x}),y.useMemo(()=>{u.forEach((b,w)=>u.set(w,!1))},[s]),y.useEffect(()=>{!s&&!u.size&&r&&r()},[s]),o==="popLayout"&&(t=a.jsx(gae,{isPresent:s,anchorX:c,root:d,children:t})),a.jsx(Eb.Provider,{value:x,children:t})};function bae(){return new Map}function Z7(t=!0){const n=y.useContext(Eb);if(n===null)return[!0,null];const{isPresent:s,onExitComplete:r,register:i}=n,l=y.useId();y.useEffect(()=>{if(t)return i(l)},[t]);const o=y.useCallback(()=>t&&r&&r(l),[l,r,t]);return!s&&r?[!1,o]:[!0]}const S0=t=>t.key||"";function P4(t){const n=[];return y.Children.forEach(t,s=>{y.isValidElement(s)&&n.push(s)}),n}const du=({children:t,custom:n,initial:s=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:l="sync",propagate:o=!1,anchorX:c="left",root:d})=>{const[u,h]=Z7(o),m=y.useMemo(()=>P4(t),[t]),x=o&&!u?[]:m.map(S0),b=y.useRef(!0),w=y.useRef(m),j=m3(()=>new Map),[S,C]=y.useState(m),[A,k]=y.useState(m);l7(()=>{b.current=!1,w.current=m;for(let D=0;D<A.length;D++){const O=S0(A[D]);x.includes(O)?j.delete(O):j.get(O)!==!0&&j.set(O,!1)}},[A,x.length,x.join("-")]);const T=[];if(m!==S){let D=[...m];for(let O=0;O<A.length;O++){const R=A[O],P=S0(R);x.includes(P)||(D.splice(O,0,R),T.push(R))}return l==="wait"&&T.length&&(D=T),k(P4(D)),C(m),null}const{forceRender:I}=y.useContext(h3);return a.jsx(a.Fragment,{children:A.map(D=>{const O=S0(D),R=o&&!u?!1:m===A||x.includes(O),P=()=>{if(j.has(O))j.set(O,!0);else return;let L=!0;j.forEach($=>{$||(L=!1)}),L&&(I==null||I(),k(w.current),o&&(h==null||h()),r&&r())};return a.jsx(yae,{isPresent:R,initial:!b.current||s?void 0:!1,custom:n,presenceAffectsLayout:i,mode:l,root:d,onExitComplete:R?void 0:P,anchorX:c,children:D},O)})})},J7=y.createContext({strict:!1}),M4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Zf={};for(const t in M4)Zf[t]={isEnabled:n=>M4[t].some(s=>!!n[s])};function vae(t){for(const n in t)Zf[n]={...Zf[n],...t[n]}}const wae=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function D1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||wae.has(t)}let eB=t=>!D1(t);function Nae(t){typeof t=="function"&&(eB=n=>n.startsWith("on")?!D1(n):t(n))}try{Nae(require("@emotion/is-prop-valid").default)}catch{}function jae(t,n,s){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(eB(i)||s===!0&&D1(i)||!n&&!D1(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}const Tb=y.createContext({});function Ib(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Ip(t){return typeof t=="string"||Array.isArray(t)}const B3=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],F3=["initial",...B3];function Pb(t){return Ib(t.animate)||F3.some(n=>Ip(t[n]))}function tB(t){return!!(Pb(t)||t.variants)}function Sae(t,n){if(Pb(t)){const{initial:s,animate:r}=t;return{initial:s===!1||Ip(s)?s:void 0,animate:Ip(r)?r:void 0}}return t.inherit!==!1?n:{}}function _ae(t){const{initial:n,animate:s}=Sae(t,y.useContext(Tb));return y.useMemo(()=>({initial:n,animate:s}),[O4(n),O4(s)])}function O4(t){return Array.isArray(t)?t.join(" "):t}const Pp={};function Cae(t){for(const n in t)Pp[n]=t[n],j3(n)&&(Pp[n].isCSSVariable=!0)}function nB(t,{layout:n,layoutId:s}){return _h.has(t)||t.startsWith("origin")||(n||s!==void 0)&&(!!Pp[t]||t==="opacity")}const Aae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},kae=Sh.length;function Eae(t,n,s){let r="",i=!0;for(let l=0;l<kae;l++){const o=Sh[l],c=t[o];if(c===void 0)continue;let d=!0;if(typeof c=="number"?d=c===(o.startsWith("scale")?1:0):d=parseFloat(c)===0,!d||s){const u=q7(c,O3[o]);if(!d){i=!1;const h=Aae[o]||o;r+=`${h}(${u}) `}s&&(n[o]=u)}}return r=r.trim(),s?r=s(n,i?"":r):i&&(r="none"),r}function $3(t,n,s){const{style:r,vars:i,transformOrigin:l}=t;let o=!1,c=!1;for(const d in n){const u=n[d];if(_h.has(d)){o=!0;continue}else if(j3(d)){i[d]=u;continue}else{const h=q7(u,O3[d]);d.startsWith("origin")?(c=!0,l[d]=h):r[d]=h}}if(n.transform||(o||s?r.transform=Eae(n,t.transform,s):r.transform&&(r.transform="none")),c){const{originX:d="50%",originY:u="50%",originZ:h=0}=l;r.transformOrigin=`${d} ${u} ${h}`}}const z3=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function sB(t,n,s){for(const r in n)!Br(n[r])&&!nB(r,s)&&(t[r]=n[r])}function Tae({transformTemplate:t},n){return y.useMemo(()=>{const s=z3();return $3(s,n,t),Object.assign({},s.vars,s.style)},[n])}function Iae(t,n){const s=t.style||{},r={};return sB(r,s,t),Object.assign(r,Tae(t,n)),r}function Pae(t,n){const s={},r=Iae(t,n);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=r,s}const Mae={offset:"stroke-dashoffset",array:"stroke-dasharray"},Oae={offset:"strokeDashoffset",array:"strokeDasharray"};function Dae(t,n,s=1,r=0,i=!0){t.pathLength=1;const l=i?Mae:Oae;t[l.offset]=Mt.transform(-r);const o=Mt.transform(n),c=Mt.transform(s);t[l.array]=`${o} ${c}`}function rB(t,{attrX:n,attrY:s,attrScale:r,pathLength:i,pathSpacing:l=1,pathOffset:o=0,...c},d,u,h){if($3(t,c,u),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:x}=t;m.transform&&(x.transform=m.transform,delete m.transform),(x.transform||m.transformOrigin)&&(x.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),x.transform&&(x.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete m.transformBox),n!==void 0&&(m.x=n),s!==void 0&&(m.y=s),r!==void 0&&(m.scale=r),i!==void 0&&Dae(m,i,l,o,!1)}const aB=()=>({...z3(),attrs:{}}),iB=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Rae(t,n,s,r){const i=y.useMemo(()=>{const l=aB();return rB(l,n,iB(r),t.transformTemplate,t.style),{...l.attrs,style:{...l.style}}},[n]);if(t.style){const l={};sB(l,t.style,t),i.style={...l,...i.style}}return i}const Lae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function U3(t){return typeof t!="string"||t.includes("-")?!1:!!(Lae.indexOf(t)>-1||/[A-Z]/u.test(t))}function Bae(t,n,s,{latestValues:r},i,l=!1){const c=(U3(t)?Rae:Pae)(n,r,i,t),d=jae(n,typeof t=="string",l),u=t!==y.Fragment?{...d,...c,ref:s}:{},{children:h}=n,m=y.useMemo(()=>Br(h)?h.get():h,[h]);return y.createElement(t,{...u,children:m})}function D4(t){const n=[{},{}];return t==null||t.values.forEach((s,r)=>{n[0][r]=s.get(),n[1][r]=s.getVelocity()}),n}function V3(t,n,s,r){if(typeof n=="function"){const[i,l]=D4(r);n=n(s!==void 0?s:t.custom,i,l)}if(typeof n=="string"&&(n=t.variants&&t.variants[n]),typeof n=="function"){const[i,l]=D4(r);n=n(s!==void 0?s:t.custom,i,l)}return n}function Dg(t){return Br(t)?t.get():t}function Fae({scrapeMotionValuesFromProps:t,createRenderState:n},s,r,i){return{latestValues:$ae(s,r,i,t),renderState:n()}}function $ae(t,n,s,r){const i={},l=r(t,{});for(const x in l)i[x]=Dg(l[x]);let{initial:o,animate:c}=t;const d=Pb(t),u=tB(t);n&&u&&!d&&t.inherit!==!1&&(o===void 0&&(o=n.initial),c===void 0&&(c=n.animate));let h=s?s.initial===!1:!1;h=h||o===!1;const m=h?c:o;if(m&&typeof m!="boolean"&&!Ib(m)){const x=Array.isArray(m)?m:[m];for(let b=0;b<x.length;b++){const w=V3(t,x[b]);if(w){const{transitionEnd:j,transition:S,...C}=w;for(const A in C){let k=C[A];if(Array.isArray(k)){const T=h?k.length-1:0;k=k[T]}k!==null&&(i[A]=k)}for(const A in j)i[A]=j[A]}}}return i}const lB=t=>(n,s)=>{const r=y.useContext(Tb),i=y.useContext(Eb),l=()=>Fae(t,n,r,i);return s?l():m3(l)};function H3(t,n,s){var l;const{style:r}=t,i={};for(const o in r)(Br(r[o])||n.style&&Br(n.style[o])||nB(o,t)||((l=s==null?void 0:s.getValue(o))==null?void 0:l.liveStyle)!==void 0)&&(i[o]=r[o]);return i}const zae=lB({scrapeMotionValuesFromProps:H3,createRenderState:z3});function oB(t,n,s){const r=H3(t,n,s);for(const i in t)if(Br(t[i])||Br(n[i])){const l=Sh.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[l]=t[i]}return r}const Uae=lB({scrapeMotionValuesFromProps:oB,createRenderState:aB}),Vae=Symbol.for("motionComponentSymbol");function vf(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Hae(t,n,s){return y.useCallback(r=>{r&&t.onMount&&t.onMount(r),n&&(r?n.mount(r):n.unmount()),s&&(typeof s=="function"?s(r):vf(s)&&(s.current=r))},[n])}const W3=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Wae="framerAppearId",cB="data-"+W3(Wae),dB=y.createContext({});function qae(t,n,s,r,i){var j,S;const{visualElement:l}=y.useContext(Tb),o=y.useContext(J7),c=y.useContext(Eb),d=y.useContext(L3).reducedMotion,u=y.useRef(null);r=r||o.renderer,!u.current&&r&&(u.current=r(t,{visualState:n,parent:l,props:s,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const h=u.current,m=y.useContext(dB);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&Gae(u.current,s,i,m);const x=y.useRef(!1);y.useInsertionEffect(()=>{h&&x.current&&h.update(s,c)});const b=s[cB],w=y.useRef(!!b&&!((j=window.MotionHandoffIsComplete)!=null&&j.call(window,b))&&((S=window.MotionHasOptimisedAnimation)==null?void 0:S.call(window,b)));return l7(()=>{h&&(x.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),w.current&&h.animationState&&h.animationState.animateChanges())}),y.useEffect(()=>{h&&(!w.current&&h.animationState&&h.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)==null||C.call(window,b)}),w.current=!1),h.enteringChildren=void 0)}),h}function Gae(t,n,s,r){const{layoutId:i,layout:l,drag:o,dragConstraints:c,layoutScroll:d,layoutRoot:u,layoutCrossfade:h}=n;t.projection=new s(t.latestValues,n["data-framer-portal-id"]?void 0:uB(t.parent)),t.projection.setOptions({layoutId:i,layout:l,alwaysMeasureLayout:!!o||c&&vf(c),visualElement:t,animationType:typeof l=="string"?l:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:d,layoutRoot:u})}function uB(t){if(t)return t.options.allowProjection!==!1?t.projection:uB(t.parent)}function gN(t,{forwardMotionProps:n=!1}={},s,r){s&&vae(s);const i=U3(t)?Uae:zae;function l(c,d){let u;const h={...y.useContext(L3),...c,layoutId:Kae(c)},{isStatic:m}=h,x=_ae(c),b=i(c,m);if(!m&&p3){Yae();const w=Xae(h);u=w.MeasureLayout,x.visualElement=qae(t,b,h,r,w.ProjectionNode)}return a.jsxs(Tb.Provider,{value:x,children:[u&&x.visualElement?a.jsx(u,{visualElement:x.visualElement,...h}):null,Bae(t,c,Hae(b,x.visualElement,d),b,m,n)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=y.forwardRef(l);return o[Vae]=t,o}function Kae({layoutId:t}){const n=y.useContext(h3).id;return n&&t!==void 0?n+"-"+t:t}function Yae(t,n){y.useContext(J7).strict}function Xae(t){const{drag:n,layout:s}=Zf;if(!n&&!s)return{};const r={...n,...s};return{MeasureLayout:n!=null&&n.isEnabled(t)||s!=null&&s.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Qae(t,n){if(typeof Proxy>"u")return gN;const s=new Map,r=(l,o)=>gN(l,o,t,n),i=(l,o)=>r(l,o);return new Proxy(i,{get:(l,o)=>o==="create"?r:(s.has(o)||s.set(o,gN(o,void 0,t,n)),s.get(o))})}function fB({top:t,left:n,right:s,bottom:r}){return{x:{min:n,max:s},y:{min:t,max:r}}}function Zae({x:t,y:n}){return{top:n.min,right:t.max,bottom:n.max,left:t.min}}function Jae(t,n){if(!n)return t;const s=n({x:t.left,y:t.top}),r=n({x:t.right,y:t.bottom});return{top:s.y,left:s.x,bottom:r.y,right:r.x}}function yN(t){return t===void 0||t===1}function vS({scale:t,scaleX:n,scaleY:s}){return!yN(t)||!yN(n)||!yN(s)}function vd(t){return vS(t)||hB(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function hB(t){return R4(t.x)||R4(t.y)}function R4(t){return t&&t!=="0%"}function R1(t,n,s){const r=t-s,i=n*r;return s+i}function L4(t,n,s,r,i){return i!==void 0&&(t=R1(t,i,r)),R1(t,s,r)+n}function wS(t,n=0,s=1,r,i){t.min=L4(t.min,n,s,r,i),t.max=L4(t.max,n,s,r,i)}function mB(t,{x:n,y:s}){wS(t.x,n.translate,n.scale,n.originPoint),wS(t.y,s.translate,s.scale,s.originPoint)}const B4=.999999999999,F4=1.0000000000001;function eie(t,n,s,r=!1){const i=s.length;if(!i)return;n.x=n.y=1;let l,o;for(let c=0;c<i;c++){l=s[c],o=l.projectionDelta;const{visualElement:d}=l.options;d&&d.props.style&&d.props.style.display==="contents"||(r&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Nf(t,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),o&&(n.x*=o.x.scale,n.y*=o.y.scale,mB(t,o)),r&&vd(l.latestValues)&&Nf(t,l.latestValues))}n.x<F4&&n.x>B4&&(n.x=1),n.y<F4&&n.y>B4&&(n.y=1)}function wf(t,n){t.min=t.min+n,t.max=t.max+n}function $4(t,n,s,r,i=.5){const l=ts(t.min,t.max,i);wS(t,n,s,l,r)}function Nf(t,n){$4(t.x,n.x,n.scaleX,n.scale,n.originX),$4(t.y,n.y,n.scaleY,n.scale,n.originY)}function pB(t,n){return fB(Jae(t.getBoundingClientRect(),n))}function tie(t,n,s){const r=pB(t,s),{scroll:i}=n;return i&&(wf(r.x,i.offset.x),wf(r.y,i.offset.y)),r}const z4=()=>({translate:0,scale:1,origin:0,originPoint:0}),jf=()=>({x:z4(),y:z4()}),U4=()=>({min:0,max:0}),ys=()=>({x:U4(),y:U4()}),NS={current:null},xB={current:!1};function nie(){if(xB.current=!0,!!p3)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),n=()=>NS.current=t.matches;t.addEventListener("change",n),n()}else NS.current=!1}const sie=new WeakMap;function rie(t,n,s){for(const r in n){const i=n[r],l=s[r];if(Br(i))t.addValue(r,i);else if(Br(l))t.addValue(r,Qf(i,{owner:t}));else if(l!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,Qf(o!==void 0?o:i,{owner:t}))}}for(const r in s)n[r]===void 0&&t.removeValue(r);return n}const V4=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class aie{scrapeMotionValuesFromProps(n,s,r){return{}}constructor({parent:n,props:s,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:l,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=P3,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=ga.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,Gn.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=s.initial?{...d}:{},this.renderState=u,this.parent=n,this.props=s,this.presenceContext=r,this.depth=n?n.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!l,this.isControllingVariants=Pb(s),this.isVariantNode=tB(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:h,...m}=this.scrapeMotionValuesFromProps(s,{},this);for(const x in m){const b=m[x];d[x]!==void 0&&Br(b)&&b.set(d[x])}}mount(n){var s;this.current=n,sie.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),xB.current||nie(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:NS.current,(s=this.parent)==null||s.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var n;this.projection&&this.projection.unmount(),Bc(this.notifyUpdate),Bc(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(n=this.parent)==null||n.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const r=this.features[s];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(n){this.children.add(n),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(n)}removeChild(n){this.children.delete(n),this.enteringChildren&&this.enteringChildren.delete(n)}bindToMotionValue(n,s){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const r=_h.has(n);r&&this.onBindTransform&&this.onBindTransform();const i=s.on("change",o=>{this.latestValues[n]=o,this.props.onUpdate&&Gn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,n,s)),this.valueSubscriptions.set(n,()=>{i(),l&&l(),s.owner&&s.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in Zf){const s=Zf[n];if(!s)continue;const{isEnabled:r,Feature:i}=s;if(!this.features[n]&&i&&r(this.props)&&(this.features[n]=new i(this)),this.features[n]){const l=this.features[n];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ys()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,s){this.latestValues[n]=s}update(n,s){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let r=0;r<V4.length;r++){const i=V4[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const l="on"+i,o=n[l];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=rie(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(n),()=>s.variantChildren.delete(n)}addValue(n,s){const r=this.values.get(n);s!==r&&(r&&this.removeValue(n),this.bindToMotionValue(n,s),this.values.set(n,s),this.latestValues[n]=s.get())}removeValue(n){this.values.delete(n);const s=this.valueSubscriptions.get(n);s&&(s(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,s){if(this.props.values&&this.props.values[n])return this.props.values[n];let r=this.values.get(n);return r===void 0&&s!==void 0&&(r=Qf(s===null?void 0:s,{owner:this}),this.addValue(n,r)),r}readValue(n,s){let r=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:this.getBaseTargetFromProps(this.props,n)??this.readValueFromInstance(this.current,n,this.options);return r!=null&&(typeof r=="string"&&(o7(r)||d7(r))?r=parseFloat(r):!hae(r)&&Fc.test(s)&&(r=W7(n,s)),this.setBaseTarget(n,Br(r)?r.get():r)),Br(r)?r.get():r}setBaseTarget(n,s){this.baseTarget[n]=s}getBaseTarget(n){var l;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=V3(this.props,s,(l=this.presenceContext)==null?void 0:l.custom);o&&(r=o[n])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,n);return i!==void 0&&!Br(i)?i:this.initialValues[n]!==void 0&&r===void 0?void 0:this.baseTarget[n]}on(n,s){return this.events[n]||(this.events[n]=new v3),this.events[n].add(s)}notify(n,...s){this.events[n]&&this.events[n].notify(...s)}scheduleRenderMicrotask(){D3.render(this.render)}}class gB extends aie{constructor(){super(...arguments),this.KeyframeResolver=tae}sortInstanceNodePosition(n,s){return n.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(n,s){return n.style?n.style[s]:void 0}removeValueFromRenderState(n,{vars:s,style:r}){delete s[n],delete r[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;Br(n)&&(this.childSubscription=n.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function yB(t,{style:n,vars:s},r,i){const l=t.style;let o;for(o in n)l[o]=n[o];i==null||i.applyProjectionStyles(l,r);for(o in s)l.setProperty(o,s[o])}function iie(t){return window.getComputedStyle(t)}class lie extends gB{constructor(){super(...arguments),this.type="html",this.renderInstance=yB}readValueFromInstance(n,s){var r;if(_h.has(s))return(r=this.projection)!=null&&r.isProjecting?hS(s):vre(n,s);{const i=iie(n),l=(j3(s)?i.getPropertyValue(s):i[s])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(n,{transformPagePoint:s}){return pB(n,s)}build(n,s,r){$3(n,s,r.transformTemplate)}scrapeMotionValuesFromProps(n,s,r){return H3(n,s,r)}}const bB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function oie(t,n,s,r){yB(t,n,void 0,r);for(const i in n.attrs)t.setAttribute(bB.has(i)?i:W3(i),n.attrs[i])}class cie extends gB{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ys}getBaseTargetFromProps(n,s){return n[s]}readValueFromInstance(n,s){if(_h.has(s)){const r=H7(s);return r&&r.default||0}return s=bB.has(s)?s:W3(s),n.getAttribute(s)}scrapeMotionValuesFromProps(n,s,r){return oB(n,s,r)}build(n,s,r){rB(n,s,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(n,s,r,i){oie(n,s,r,i)}mount(n){this.isSVGTag=iB(n.tagName),super.mount(n)}}const die=(t,n)=>U3(t)?new cie(n):new lie(n,{allowProjection:t!==y.Fragment});function Of(t,n,s){const r=t.getProps();return V3(r,n,s!==void 0?s:r.custom,t)}const jS=t=>Array.isArray(t);function uie(t,n,s){t.hasValue(n)?t.getValue(n).set(s):t.addValue(n,Qf(s))}function fie(t){return jS(t)?t[t.length-1]||0:t}function hie(t,n){const s=Of(t,n);let{transitionEnd:r={},transition:i={},...l}=s||{};l={...l,...r};for(const o in l){const c=fie(l[o]);uie(t,o,c)}}function mie(t){return!!(Br(t)&&t.add)}function SS(t,n){const s=t.getValue("willChange");if(mie(s))return s.add(n);if(!s&&So.WillChange){const r=new So.WillChange("auto");t.addValue("willChange",r),r.add(n)}}function vB(t){return t.props[cB]}const pie=t=>t!==null;function xie(t,{repeat:n,repeatType:s="loop"},r){const i=t.filter(pie),l=n&&s!=="loop"&&n%2===1?0:i.length-1;return i[l]}const gie={type:"spring",stiffness:500,damping:25,restSpeed:10},yie=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),bie={type:"keyframes",duration:.8},vie={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},wie=(t,{keyframes:n})=>n.length>2?bie:_h.has(t)?t.startsWith("scale")?yie(n[1]):gie:vie;function Nie({when:t,delay:n,delayChildren:s,staggerChildren:r,staggerDirection:i,repeat:l,repeatType:o,repeatDelay:c,from:d,elapsed:u,...h}){return!!Object.keys(h).length}const q3=(t,n,s,r={},i,l)=>o=>{const c=M3(r,t)||{},d=c.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Il(d);const h={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:n.getVelocity(),...c,delay:-u,onUpdate:x=>{n.set(x),c.onUpdate&&c.onUpdate(x)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:n,element:l?void 0:i};Nie(c)||Object.assign(h,wie(t,h)),h.duration&&(h.duration=Il(h.duration)),h.repeatDelay&&(h.repeatDelay=Il(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let m=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(yS(h),h.delay===0&&(m=!0)),(So.instantAnimations||So.skipAnimations)&&(m=!0,yS(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,m&&!l&&n.get()!==void 0){const x=xie(h.keyframes,c);if(x!==void 0){Gn.update(()=>{h.onUpdate(x),h.onComplete()});return}}return c.isSync?new I3(h):new Vre(h)};function jie({protectedKeys:t,needsAnimating:n},s){const r=t.hasOwnProperty(s)&&n[s]!==!0;return n[s]=!1,r}function wB(t,n,{delay:s=0,transitionOverride:r,type:i}={}){let{transition:l=t.getDefaultTransition(),transitionEnd:o,...c}=n;r&&(l=r);const d=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in c){const m=t.getValue(h,t.latestValues[h]??null),x=c[h];if(x===void 0||u&&jie(u,h))continue;const b={delay:s,...M3(l||{},h)},w=m.get();if(w!==void 0&&!m.isAnimating&&!Array.isArray(x)&&x===w&&!b.velocity)continue;let j=!1;if(window.MotionHandoffAnimation){const C=vB(t);if(C){const A=window.MotionHandoffAnimation(C,h,Gn);A!==null&&(b.startTime=A,j=!0)}}SS(t,h),m.start(q3(h,m,x,t.shouldReduceMotion&&z7.has(h)?{type:!1}:b,t,j));const S=m.animation;S&&d.push(S)}return o&&Promise.all(d).then(()=>{Gn.update(()=>{o&&hie(t,o)})}),d}function NB(t,n,s,r=0,i=1){const l=Array.from(t).sort((u,h)=>u.sortNodePosition(h)).indexOf(n),o=t.size,c=(o-1)*r;return typeof s=="function"?s(l,o):i===1?l*r:c-l*r}function _S(t,n,s={}){var d;const r=Of(t,n,s.type==="exit"?(d=t.presenceContext)==null?void 0:d.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};s.transitionOverride&&(i=s.transitionOverride);const l=r?()=>Promise.all(wB(t,r,s)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:m,staggerDirection:x}=i;return Sie(t,n,u,h,m,x,s)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,h]=c==="beforeChildren"?[l,o]:[o,l];return u().then(()=>h())}else return Promise.all([l(),o(s.delay)])}function Sie(t,n,s=0,r=0,i=0,l=1,o){const c=[];for(const d of t.variantChildren)d.notify("AnimationStart",n),c.push(_S(d,n,{...o,delay:s+(typeof r=="function"?0:r)+NB(t.variantChildren,d,r,i,l)}).then(()=>d.notify("AnimationComplete",n)));return Promise.all(c)}function _ie(t,n,s={}){t.notify("AnimationStart",n);let r;if(Array.isArray(n)){const i=n.map(l=>_S(t,l,s));r=Promise.all(i)}else if(typeof n=="string")r=_S(t,n,s);else{const i=typeof n=="function"?Of(t,n,s.custom):n;r=Promise.all(wB(t,i,s))}return r.then(()=>{t.notify("AnimationComplete",n)})}function jB(t,n){if(!Array.isArray(n))return!1;const s=n.length;if(s!==t.length)return!1;for(let r=0;r<s;r++)if(n[r]!==t[r])return!1;return!0}const Cie=F3.length;function SB(t){if(!t)return;if(!t.isControllingVariants){const s=t.parent?SB(t.parent)||{}:{};return t.props.initial!==void 0&&(s.initial=t.props.initial),s}const n={};for(let s=0;s<Cie;s++){const r=F3[s],i=t.props[r];(Ip(i)||i===!1)&&(n[r]=i)}return n}const Aie=[...B3].reverse(),kie=B3.length;function Eie(t){return n=>Promise.all(n.map(({animation:s,options:r})=>_ie(t,s,r)))}function Tie(t){let n=Eie(t),s=H4(),r=!0;const i=d=>(u,h)=>{var x;const m=Of(t,h,d==="exit"?(x=t.presenceContext)==null?void 0:x.custom:void 0);if(m){const{transition:b,transitionEnd:w,...j}=m;u={...u,...j,...w}}return u};function l(d){n=d(t)}function o(d){const{props:u}=t,h=SB(t.parent)||{},m=[],x=new Set;let b={},w=1/0;for(let S=0;S<kie;S++){const C=Aie[S],A=s[C],k=u[C]!==void 0?u[C]:h[C],T=Ip(k),I=C===d?A.isActive:null;I===!1&&(w=S);let D=k===h[C]&&k!==u[C]&&T;if(D&&r&&t.manuallyAnimateOnMount&&(D=!1),A.protectedKeys={...b},!A.isActive&&I===null||!k&&!A.prevProp||Ib(k)||typeof k=="boolean")continue;const O=Iie(A.prevProp,k);let R=O||C===d&&A.isActive&&!D&&T||S>w&&T,P=!1;const L=Array.isArray(k)?k:[k];let $=L.reduce(i(C),{});I===!1&&($={});const{prevResolvedValues:B={}}=A,V={...B,...$},K=Y=>{R=!0,x.has(Y)&&(P=!0,x.delete(Y)),A.needsAnimating[Y]=!0;const G=t.getValue(Y);G&&(G.liveStyle=!1)};for(const Y in V){const G=$[Y],J=B[Y];if(b.hasOwnProperty(Y))continue;let ee=!1;jS(G)&&jS(J)?ee=!jB(G,J):ee=G!==J,ee?G!=null?K(Y):x.add(Y):G!==void 0&&x.has(Y)?K(Y):A.protectedKeys[Y]=!0}A.prevProp=k,A.prevResolvedValues=$,A.isActive&&(b={...b,...$}),r&&t.blockInitialAnimation&&(R=!1);const z=D&&O;R&&(!z||P)&&m.push(...L.map(Y=>{const G={type:C};if(typeof Y=="string"&&r&&!z&&t.manuallyAnimateOnMount&&t.parent){const{parent:J}=t,ee=Of(J,Y);if(J.enteringChildren&&ee){const{delayChildren:ye}=ee.transition||{};G.delay=NB(J.enteringChildren,t,ye)}}return{animation:Y,options:G}}))}if(x.size){const S={};if(typeof u.initial!="boolean"){const C=Of(t,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(S.transition=C.transition)}x.forEach(C=>{const A=t.getBaseTarget(C),k=t.getValue(C);k&&(k.liveStyle=!0),S[C]=A??null}),m.push({animation:S})}let j=!!m.length;return r&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(j=!1),r=!1,j?n(m):Promise.resolve()}function c(d,u){var m;if(s[d].isActive===u)return Promise.resolve();(m=t.variantChildren)==null||m.forEach(x=>{var b;return(b=x.animationState)==null?void 0:b.setActive(d,u)}),s[d].isActive=u;const h=o(d);for(const x in s)s[x].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:l,getState:()=>s,reset:()=>{s=H4()}}}function Iie(t,n){return typeof n=="string"?n!==t:Array.isArray(n)?!jB(n,t):!1}function pd(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function H4(){return{animate:pd(!0),whileInView:pd(),whileHover:pd(),whileTap:pd(),whileDrag:pd(),whileFocus:pd(),exit:pd()}}class Jc{constructor(n){this.isMounted=!1,this.node=n}update(){}}class Pie extends Jc{constructor(n){super(n),n.animationState||(n.animationState=Tie(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();Ib(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:s}=this.node.prevProps||{};n!==s&&this.updateAnimationControlsSubscription()}unmount(){var n;this.node.animationState.reset(),(n=this.unmountControls)==null||n.call(this)}}let Mie=0;class Oie extends Jc{constructor(){super(...arguments),this.id=Mie++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:s}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===r)return;const i=this.node.animationState.setActive("exit",!n);s&&!n&&i.then(()=>{s(this.id)})}mount(){const{register:n,onExitComplete:s}=this.node.presenceContext||{};s&&s(this.id),n&&(this.unmount=n(this.id))}unmount(){}}const Die={animation:{Feature:Pie},exit:{Feature:Oie}};function Mp(t,n,s,r={passive:!0}){return t.addEventListener(n,s,r),()=>t.removeEventListener(n,s)}function Nx(t){return{point:{x:t.pageX,y:t.pageY}}}const Rie=t=>n=>R3(n)&&t(n,Nx(n));function Xm(t,n,s,r){return Mp(t,n,Rie(s),r)}const _B=1e-4,Lie=1-_B,Bie=1+_B,CB=.01,Fie=0-CB,$ie=0+CB;function ea(t){return t.max-t.min}function zie(t,n,s){return Math.abs(t-n)<=s}function W4(t,n,s,r=.5){t.origin=r,t.originPoint=ts(n.min,n.max,t.origin),t.scale=ea(s)/ea(n),t.translate=ts(s.min,s.max,t.origin)-t.originPoint,(t.scale>=Lie&&t.scale<=Bie||isNaN(t.scale))&&(t.scale=1),(t.translate>=Fie&&t.translate<=$ie||isNaN(t.translate))&&(t.translate=0)}function Qm(t,n,s,r){W4(t.x,n.x,s.x,r?r.originX:void 0),W4(t.y,n.y,s.y,r?r.originY:void 0)}function q4(t,n,s){t.min=s.min+n.min,t.max=t.min+ea(n)}function Uie(t,n,s){q4(t.x,n.x,s.x),q4(t.y,n.y,s.y)}function G4(t,n,s){t.min=n.min-s.min,t.max=t.min+ea(n)}function Zm(t,n,s){G4(t.x,n.x,s.x),G4(t.y,n.y,s.y)}function hi(t){return[t("x"),t("y")]}const AB=({current:t})=>t?t.ownerDocument.defaultView:null,K4=(t,n)=>Math.abs(t-n);function Vie(t,n){const s=K4(t.x,n.x),r=K4(t.y,n.y);return Math.sqrt(s**2+r**2)}class kB{constructor(n,s,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:l=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=vN(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,w=Vie(x.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!w)return;const{point:j}=x,{timestamp:S}=jr;this.history.push({...j,timestamp:S});const{onStart:C,onMove:A}=this.handlers;b||(C&&C(this.lastMoveEvent,x),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,x)},this.handlePointerMove=(x,b)=>{this.lastMoveEvent=x,this.lastMoveEventInfo=bN(b,this.transformPagePoint),Gn.update(this.updatePoint,!0)},this.handlePointerUp=(x,b)=>{this.end();const{onEnd:w,onSessionEnd:j,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=vN(x.type==="pointercancel"?this.lastMoveEventInfo:bN(b,this.transformPagePoint),this.history);this.startEvent&&w&&w(x,C),j&&j(x,C)},!R3(n))return;this.dragSnapToOrigin=l,this.handlers=s,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Nx(n),d=bN(c,this.transformPagePoint),{point:u}=d,{timestamp:h}=jr;this.history=[{...u,timestamp:h}];const{onSessionStart:m}=s;m&&m(n,vN(d,this.history)),this.removeListeners=bx(Xm(this.contextWindow,"pointermove",this.handlePointerMove),Xm(this.contextWindow,"pointerup",this.handlePointerUp),Xm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),Bc(this.updatePoint)}}function bN(t,n){return n?{point:n(t.point)}:t}function Y4(t,n){return{x:t.x-n.x,y:t.y-n.y}}function vN({point:t},n){return{point:t,delta:Y4(t,EB(n)),offset:Y4(t,Hie(n)),velocity:Wie(n,.1)}}function Hie(t){return t[0]}function EB(t){return t[t.length-1]}function Wie(t,n){if(t.length<2)return{x:0,y:0};let s=t.length-1,r=null;const i=EB(t);for(;s>=0&&(r=t[s],!(i.timestamp-r.timestamp>Il(n)));)s--;if(!r)return{x:0,y:0};const l=bi(i.timestamp-r.timestamp);if(l===0)return{x:0,y:0};const o={x:(i.x-r.x)/l,y:(i.y-r.y)/l};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function qie(t,{min:n,max:s},r){return n!==void 0&&t<n?t=r?ts(n,t,r.min):Math.max(t,n):s!==void 0&&t>s&&(t=r?ts(s,t,r.max):Math.min(t,s)),t}function X4(t,n,s){return{min:n!==void 0?t.min+n:void 0,max:s!==void 0?t.max+s-(t.max-t.min):void 0}}function Gie(t,{top:n,left:s,bottom:r,right:i}){return{x:X4(t.x,s,i),y:X4(t.y,n,r)}}function Q4(t,n){let s=n.min-t.min,r=n.max-t.max;return n.max-n.min<t.max-t.min&&([s,r]=[r,s]),{min:s,max:r}}function Kie(t,n){return{x:Q4(t.x,n.x),y:Q4(t.y,n.y)}}function Yie(t,n){let s=.5;const r=ea(t),i=ea(n);return i>r?s=kp(n.min,n.max-r,t.min):r>i&&(s=kp(t.min,t.max-i,n.min)),jo(0,1,s)}function Xie(t,n){const s={};return n.min!==void 0&&(s.min=n.min-t.min),n.max!==void 0&&(s.max=n.max-t.min),s}const CS=.35;function Qie(t=CS){return t===!1?t=0:t===!0&&(t=CS),{x:Z4(t,"left","right"),y:Z4(t,"top","bottom")}}function Z4(t,n,s){return{min:J4(t,n),max:J4(t,s)}}function J4(t,n){return typeof t=="number"?t:t[n]||0}const Zie=new WeakMap;class Jie{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ys(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=n}start(n,{snapToCursor:s=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const l=m=>{const{dragSnapToOrigin:x}=this.getProps();x?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(Nx(m).point)},o=(m,x)=>{const{drag:b,dragPropagation:w,onDragStart:j}=this.getProps();if(b&&!w&&(this.openDragLock&&this.openDragLock(),this.openDragLock=aae(b),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=x,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),hi(C=>{let A=this.getAxisMotionValue(C).get()||0;if(Pl.test(A)){const{projection:k}=this.visualElement;if(k&&k.layout){const T=k.layout.layoutBox[C];T&&(A=ea(T)*(parseFloat(A)/100))}}this.originPoint[C]=A}),j&&Gn.postRender(()=>j(m,x)),SS(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(m,x)=>{this.latestPointerEvent=m,this.latestPanInfo=x;const{dragPropagation:b,dragDirectionLock:w,onDirectionLock:j,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:C}=x;if(w&&this.currentDirection===null){this.currentDirection=ele(C),this.currentDirection!==null&&j&&j(this.currentDirection);return}this.updateAxis("x",x.point,C),this.updateAxis("y",x.point,C),this.visualElement.render(),S&&S(m,x)},d=(m,x)=>{this.latestPointerEvent=m,this.latestPanInfo=x,this.stop(m,x),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>hi(m=>{var x;return this.getAnimationState(m)==="paused"&&((x=this.getAxisMotionValue(m).animation)==null?void 0:x.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new kB(n,{onSessionStart:l,onStart:o,onMove:c,onSessionEnd:d,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:AB(this.visualElement)})}stop(n,s){const r=n||this.latestPointerEvent,i=s||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&Gn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:n,animationState:s}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(n,s,r){const{drag:i}=this.getProps();if(!r||!_0(n,i,this.currentDirection))return;const l=this.getAxisMotionValue(n);let o=this.originPoint[n]+r[n];this.constraints&&this.constraints[n]&&(o=qie(o,this.constraints[n],this.elastic[n])),l.set(o)}resolveConstraints(){var l;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,i=this.constraints;n&&vf(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=Gie(r.layoutBox,n):this.constraints=!1,this.elastic=Qie(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&hi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Xie(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:s}=this.getProps();if(!n||!vf(n))return!1;const r=n.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const l=tie(r,i.root,this.visualElement.getTransformPagePoint());let o=Kie(i.layout.layoutBox,l);if(s){const c=s(Zae(o));this.hasMutatedConstraints=!!c,c&&(o=fB(c))}return o}startAnimation(n){const{drag:s,dragMomentum:r,dragElastic:i,dragTransition:l,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},u=hi(h=>{if(!_0(h,s,this.currentDirection))return;let m=d&&d[h]||{};o&&(m={min:0,max:0});const x=i?200:1e6,b=i?40:1e7,w={type:"inertia",velocity:r?n[h]:0,bounceStiffness:x,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...l,...m};return this.startAxisValueAnimation(h,w)});return Promise.all(u).then(c)}startAxisValueAnimation(n,s){const r=this.getAxisMotionValue(n);return SS(this.visualElement,n),r.start(q3(n,r,0,s,this.visualElement,!1))}stopAnimation(){hi(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){hi(n=>{var s;return(s=this.getAxisMotionValue(n).animation)==null?void 0:s.pause()})}getAnimationState(n){var s;return(s=this.getAxisMotionValue(n).animation)==null?void 0:s.state}getAxisMotionValue(n){const s=`_drag${n.toUpperCase()}`,r=this.visualElement.getProps(),i=r[s];return i||this.visualElement.getValue(n,(r.initial?r.initial[n]:void 0)||0)}snapToCursor(n){hi(s=>{const{drag:r}=this.getProps();if(!_0(s,r,this.currentDirection))return;const{projection:i}=this.visualElement,l=this.getAxisMotionValue(s);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[s];l.set(n[s]-ts(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:s}=this.getProps(),{projection:r}=this.visualElement;if(!vf(s)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};hi(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const d=c.get();i[o]=Yie({min:d,max:d},this.constraints[o])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),hi(o=>{if(!_0(o,n,null))return;const c=this.getAxisMotionValue(o),{min:d,max:u}=this.constraints[o];c.set(ts(d,u,i[o]))})}addListeners(){if(!this.visualElement.current)return;Zie.set(this.visualElement,this);const n=this.visualElement.current,s=Xm(n,"pointerdown",d=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(d)}),r=()=>{const{dragConstraints:d}=this.getProps();vf(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,l=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Gn.read(r);const o=Mp(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(hi(h=>{const m=this.getAxisMotionValue(h);m&&(this.originPoint[h]+=d[h].translate,m.set(m.get()+d[h].translate))}),this.visualElement.render())});return()=>{o(),s(),l(),c&&c()}}getProps(){const n=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:l=!1,dragElastic:o=CS,dragMomentum:c=!0}=n;return{...n,drag:s,dragDirectionLock:r,dragPropagation:i,dragConstraints:l,dragElastic:o,dragMomentum:c}}}function _0(t,n,s){return(n===!0||n===t)&&(s===null||s===t)}function ele(t,n=10){let s=null;return Math.abs(t.y)>n?s="y":Math.abs(t.x)>n&&(s="x"),s}class tle extends Jc{constructor(n){super(n),this.removeGroupControls=Si,this.removeListeners=Si,this.controls=new Jie(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Si}unmount(){this.removeGroupControls(),this.removeListeners()}}const eI=t=>(n,s)=>{t&&Gn.postRender(()=>t(n,s))};class nle extends Jc{constructor(){super(...arguments),this.removePointerDownListener=Si}onPointerDown(n){this.session=new kB(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:AB(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:s,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:eI(n),onStart:eI(s),onMove:r,onEnd:(l,o)=>{delete this.session,i&&Gn.postRender(()=>i(l,o))}}}mount(){this.removePointerDownListener=Xm(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Rg={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function tI(t,n){return n.max===n.min?0:t/(n.max-n.min)*100}const hm={correct:(t,n)=>{if(!n.target)return t;if(typeof t=="string")if(Mt.test(t))t=parseFloat(t);else return t;const s=tI(t,n.target.x),r=tI(t,n.target.y);return`${s}% ${r}%`}},sle={correct:(t,{treeScale:n,projectionDelta:s})=>{const r=t,i=Fc.parse(t);if(i.length>5)return r;const l=Fc.createTransformer(t),o=typeof i[0]!="number"?1:0,c=s.x.scale*n.x,d=s.y.scale*n.y;i[0+o]/=c,i[1+o]/=d;const u=ts(c,d,.5);return typeof i[2+o]=="number"&&(i[2+o]/=u),typeof i[3+o]=="number"&&(i[3+o]/=u),l(i)}};let wN=!1;class rle extends y.Component{componentDidMount(){const{visualElement:n,layoutGroup:s,switchLayoutGroup:r,layoutId:i}=this.props,{projection:l}=n;Cae(ale),l&&(s.group&&s.group.add(l),r&&r.register&&i&&r.register(l),wN&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Rg.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:s,visualElement:r,drag:i,isPresent:l}=this.props,{projection:o}=r;return o&&(o.isPresent=l,wN=!0,i||n.layoutDependency!==s||s===void 0||n.isPresent!==l?o.willUpdate():this.safeToRemove(),n.isPresent!==l&&(l?o.promote():o.relegate()||Gn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),D3.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:s,switchLayoutGroup:r}=this.props,{projection:i}=n;wN=!0,i&&(i.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function TB(t){const[n,s]=Z7(),r=y.useContext(h3);return a.jsx(rle,{...t,layoutGroup:r,switchLayoutGroup:y.useContext(dB),isPresent:n,safeToRemove:s})}const ale={borderRadius:{...hm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hm,borderTopRightRadius:hm,borderBottomLeftRadius:hm,borderBottomRightRadius:hm,boxShadow:sle};function ile(t,n,s){const r=Br(t)?t:Qf(t);return r.start(q3("",r,n,s)),r.animation}const lle=(t,n)=>t.depth-n.depth;class ole{constructor(){this.children=[],this.isDirty=!1}add(n){x3(this.children,n),this.isDirty=!0}remove(n){g3(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(lle),this.isDirty=!1,this.children.forEach(n)}}function cle(t,n){const s=ga.now(),r=({timestamp:i})=>{const l=i-s;l>=n&&(Bc(r),t(l-n))};return Gn.setup(r,!0),()=>Bc(r)}const IB=["TopLeft","TopRight","BottomLeft","BottomRight"],dle=IB.length,nI=t=>typeof t=="string"?parseFloat(t):t,sI=t=>typeof t=="number"||Mt.test(t);function ule(t,n,s,r,i,l){i?(t.opacity=ts(0,s.opacity??1,fle(r)),t.opacityExit=ts(n.opacity??1,0,hle(r))):l&&(t.opacity=ts(n.opacity??1,s.opacity??1,r));for(let o=0;o<dle;o++){const c=`border${IB[o]}Radius`;let d=rI(n,c),u=rI(s,c);if(d===void 0&&u===void 0)continue;d||(d=0),u||(u=0),d===0||u===0||sI(d)===sI(u)?(t[c]=Math.max(ts(nI(d),nI(u),r),0),(Pl.test(u)||Pl.test(d))&&(t[c]+="%")):t[c]=u}(n.rotate||s.rotate)&&(t.rotate=ts(n.rotate||0,s.rotate||0,r))}function rI(t,n){return t[n]!==void 0?t[n]:t.borderRadius}const fle=PB(0,.5,y7),hle=PB(.5,.95,Si);function PB(t,n,s){return r=>r<t?0:r>n?1:s(kp(t,n,r))}function aI(t,n){t.min=n.min,t.max=n.max}function ci(t,n){aI(t.x,n.x),aI(t.y,n.y)}function iI(t,n){t.translate=n.translate,t.scale=n.scale,t.originPoint=n.originPoint,t.origin=n.origin}function lI(t,n,s,r,i){return t-=n,t=R1(t,1/s,r),i!==void 0&&(t=R1(t,1/i,r)),t}function mle(t,n=0,s=1,r=.5,i,l=t,o=t){if(Pl.test(n)&&(n=parseFloat(n),n=ts(o.min,o.max,n/100)-o.min),typeof n!="number")return;let c=ts(l.min,l.max,r);t===l&&(c-=n),t.min=lI(t.min,n,s,c,i),t.max=lI(t.max,n,s,c,i)}function oI(t,n,[s,r,i],l,o){mle(t,n[s],n[r],n[i],n.scale,l,o)}const ple=["x","scaleX","originX"],xle=["y","scaleY","originY"];function cI(t,n,s,r){oI(t.x,n,ple,s?s.x:void 0,r?r.x:void 0),oI(t.y,n,xle,s?s.y:void 0,r?r.y:void 0)}function dI(t){return t.translate===0&&t.scale===1}function MB(t){return dI(t.x)&&dI(t.y)}function uI(t,n){return t.min===n.min&&t.max===n.max}function gle(t,n){return uI(t.x,n.x)&&uI(t.y,n.y)}function fI(t,n){return Math.round(t.min)===Math.round(n.min)&&Math.round(t.max)===Math.round(n.max)}function OB(t,n){return fI(t.x,n.x)&&fI(t.y,n.y)}function hI(t){return ea(t.x)/ea(t.y)}function mI(t,n){return t.translate===n.translate&&t.scale===n.scale&&t.originPoint===n.originPoint}class yle{constructor(){this.members=[]}add(n){x3(this.members,n),n.scheduleRender()}remove(n){if(g3(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(n){const s=this.members.findIndex(i=>n===i);if(s===0)return!1;let r;for(let i=s;i>=0;i--){const l=this.members[i];if(l.isPresent!==!1){r=l;break}}return r?(this.promote(r),!0):!1}promote(n,s){const r=this.lead;if(n!==r&&(this.prevLead=r,this.lead=n,n.show(),r)){r.instance&&r.scheduleRender(),n.scheduleRender(),n.resumeFrom=r,s&&(n.resumeFrom.preserveOpacity=!0),r.snapshot&&(n.snapshot=r.snapshot,n.snapshot.latestValues=r.animationValues||r.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:i}=n.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:s,resumingFrom:r}=n;s.onExitComplete&&s.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ble(t,n,s){let r="";const i=t.x.translate/n.x,l=t.y.translate/n.y,o=(s==null?void 0:s.z)||0;if((i||l||o)&&(r=`translate3d(${i}px, ${l}px, ${o}px) `),(n.x!==1||n.y!==1)&&(r+=`scale(${1/n.x}, ${1/n.y}) `),s){const{transformPerspective:u,rotate:h,rotateX:m,rotateY:x,skewX:b,skewY:w}=s;u&&(r=`perspective(${u}px) ${r}`),h&&(r+=`rotate(${h}deg) `),m&&(r+=`rotateX(${m}deg) `),x&&(r+=`rotateY(${x}deg) `),b&&(r+=`skewX(${b}deg) `),w&&(r+=`skewY(${w}deg) `)}const c=t.x.scale*n.x,d=t.y.scale*n.y;return(c!==1||d!==1)&&(r+=`scale(${c}, ${d})`),r||"none"}const NN=["","X","Y","Z"],vle=1e3;let wle=0;function jN(t,n,s,r){const{latestValues:i}=n;i[t]&&(s[t]=i[t],n.setStaticValue(t,0),r&&(r[t]=0))}function DB(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:n}=t.options;if(!n)return;const s=vB(n);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:i,layoutId:l}=t.options;window.MotionCancelOptimisedAnimation(s,"transform",Gn,!(i||l))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&DB(r)}function RB({attachResizeListener:t,defaultParent:n,measureScroll:s,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=n==null?void 0:n()){this.id=wle++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Sle),this.nodes.forEach(kle),this.nodes.forEach(Ele),this.nodes.forEach(_le)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new ole)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new v3),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const d=this.eventHandlers.get(o);d&&d.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Q7(o)&&!uae(o),this.instance=o;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),t){let h,m=0;const x=()=>this.root.updateBlockedByResize=!1;Gn.read(()=>{m=window.innerWidth}),t(o,()=>{const b=window.innerWidth;b!==m&&(m=b,this.root.updateBlockedByResize=!0,h&&h(),h=cle(x,250),Rg.hasAnimatedSinceResize&&(Rg.hasAnimatedSinceResize=!1,this.nodes.forEach(gI)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:m,hasRelativeLayoutChanged:x,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||u.getDefaultTransition()||Ole,{onLayoutAnimationStart:j,onLayoutAnimationComplete:S}=u.getProps(),C=!this.targetLayout||!OB(this.targetLayout,b),A=!m&&x;if(this.options.layoutRoot||this.resumeFrom||A||m&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...M3(w,"layout"),onPlay:j,onComplete:S};(u.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(h,A)}else m||gI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Bc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Tle),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&DB(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const m=this.path[h];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(pI);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(xI);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Ale),this.nodes.forEach(Nle),this.nodes.forEach(jle)):this.nodes.forEach(xI),this.clearAllSnapshots();const c=ga.now();jr.delta=jo(0,1e3/60,c-jr.timestamp),jr.timestamp=c,jr.isProcessing=!0,uN.update.process(jr),uN.preRender.process(jr),uN.render.process(jr),jr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,D3.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Cle),this.sharedNodes.forEach(Ile)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Gn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Gn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ea(this.snapshot.measuredBox.x)&&!ea(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ys(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const d=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:d,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!MB(this.projectionDelta),d=this.getTransformTemplate(),u=d?d(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;o&&this.instance&&(c||vd(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return o&&(d=this.removeTransform(d)),Dle(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:o}=this.options;if(!o)return ys();const c=o.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Rle))){const{scroll:h}=this.root;h&&(wf(c.x,h.offset.x),wf(c.y,h.offset.y))}return c}removeElementScroll(o){var d;const c=ys();if(ci(c,o),(d=this.scroll)!=null&&d.wasRoot)return c;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:m,options:x}=h;h!==this.root&&m&&x.layoutScroll&&(m.wasRoot&&ci(c,o),wf(c.x,m.offset.x),wf(c.y,m.offset.y))}return c}applyTransform(o,c=!1){const d=ys();ci(d,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Nf(d,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),vd(h.latestValues)&&Nf(d,h.latestValues)}return vd(this.latestValues)&&Nf(d,this.latestValues),d}removeTransform(o){const c=ys();ci(c,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];if(!u.instance||!vd(u.latestValues))continue;vS(u.latestValues)&&u.updateSnapshot();const h=ys(),m=u.measurePageBox();ci(h,m),cI(c,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return vd(this.latestValues)&&cI(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==jr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var x;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:m}=this.options;if(!(!this.layout||!(h||m))){if(this.resolvedRelativeTargetAt=jr.timestamp,!this.targetDelta&&!this.relativeTarget){const b=this.getClosestProjectingParent();b&&b.layout&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ys(),this.relativeTargetOrigin=ys(),Zm(this.relativeTargetOrigin,this.layout.layoutBox,b.layout.layoutBox),ci(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ys(),this.targetWithTransforms=ys()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Uie(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ci(this.target,this.layout.layoutBox),mB(this.target,this.targetDelta)):ci(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const b=this.getClosestProjectingParent();b&&!!b.resumingFrom==!!this.resumingFrom&&!b.options.layoutScroll&&b.target&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ys(),this.relativeTargetOrigin=ys(),Zm(this.relativeTargetOrigin,this.target,b.target),ci(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||vS(this.parent.latestValues)||hB(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var w;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||(w=this.parent)!=null&&w.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===jr.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;ci(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,x=this.treeScale.y;eie(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ys());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(iI(this.prevProjectionDelta.x,this.projectionDelta.x),iI(this.prevProjectionDelta.y,this.projectionDelta.y)),Qm(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==x||!mI(this.projectionDelta.x,this.prevProjectionDelta.x)||!mI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=jf(),this.projectionDelta=jf(),this.projectionDeltaWithTransform=jf()}setAnimationOrigin(o,c=!1){const d=this.snapshot,u=d?d.latestValues:{},h={...this.latestValues},m=jf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const x=ys(),b=d?d.source:void 0,w=this.layout?this.layout.source:void 0,j=b!==w,S=this.getStack(),C=!S||S.members.length<=1,A=!!(j&&!C&&this.options.crossfade===!0&&!this.path.some(Mle));this.animationProgress=0;let k;this.mixTargetDelta=T=>{const I=T/1e3;yI(m.x,o.x,I),yI(m.y,o.y,I),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Zm(x,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ple(this.relativeTarget,this.relativeTargetOrigin,x,I),k&&gle(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=ys()),ci(k,this.relativeTarget)),j&&(this.animationValues=h,ule(h,u,this.latestValues,I,A,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=I},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,d,u;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(u=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||u.stop(),this.pendingAnimation&&(Bc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Gn.update(()=>{Rg.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Qf(0)),this.currentAnimation=ile(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),o.onUpdate&&o.onUpdate(h)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(vle),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:d,layout:u,latestValues:h}=o;if(!(!c||!d||!u)){if(this!==o&&this.layout&&u&&LB(this.options.animationType,this.layout.layoutBox,u.layoutBox)){d=this.target||ys();const m=ea(this.layout.layoutBox.x);d.x.min=o.target.x.min,d.x.max=d.x.min+m;const x=ea(this.layout.layoutBox.y);d.y.min=o.target.y.min,d.y.max=d.y.min+x}ci(c,d),Nf(c,h),Qm(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new yle),this.sharedNodes.get(o).add(c);const u=c.options.initialPromotionConfig;c.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:d}={}){const u=this.getStack();u&&u.promote(this,d),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:d}=o;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const u={};d.z&&jN("z",o,u,this.animationValues);for(let h=0;h<NN.length;h++)jN(`rotate${NN[h]}`,o,u,this.animationValues),jN(`skew${NN[h]}`,o,u,this.animationValues);o.render();for(const h in u)o.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Dg(c==null?void 0:c.pointerEvents)||"",o.transform=d?d(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Dg(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!vd(this.latestValues)&&(o.transform=d?d({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=u.animationValues||u.latestValues;this.applyTransformsToTarget();let m=ble(this.projectionDeltaWithTransform,this.treeScale,h);d&&(m=d(h,m)),o.transform=m;const{x,y:b}=this.projectionDelta;o.transformOrigin=`${x.origin*100}% ${b.origin*100}% 0`,u.animationValues?o.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const w in Pp){if(h[w]===void 0)continue;const{correct:j,applyTo:S,isCSSVariable:C}=Pp[w],A=m==="none"?h[w]:j(h[w],u);if(S){const k=S.length;for(let T=0;T<k;T++)o[S[T]]=A}else C?this.options.visualElement.renderState.vars[w]=A:o[w]=A}this.options.layoutId&&(o.pointerEvents=u===this?Dg(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(pI),this.root.sharedNodes.clear()}}}function Nle(t){t.updateLayout()}function jle(t){var s;const n=((s=t.resumeFrom)==null?void 0:s.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=t.layout,{animationType:l}=t.options,o=n.source!==t.layout.source;l==="size"?hi(m=>{const x=o?n.measuredBox[m]:n.layoutBox[m],b=ea(x);x.min=r[m].min,x.max=x.min+b}):LB(l,n.layoutBox,r)&&hi(m=>{const x=o?n.measuredBox[m]:n.layoutBox[m],b=ea(r[m]);x.max=x.min+b,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+b)});const c=jf();Qm(c,r,n.layoutBox);const d=jf();o?Qm(d,t.applyTransform(i,!0),n.measuredBox):Qm(d,r,n.layoutBox);const u=!MB(c);let h=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:x,layout:b}=m;if(x&&b){const w=ys();Zm(w,n.layoutBox,x.layoutBox);const j=ys();Zm(j,r,b.layoutBox),OB(w,j)||(h=!0),m.options.layoutRoot&&(t.relativeTarget=j,t.relativeTargetOrigin=w,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:d,layoutDelta:c,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Sle(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function _le(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Cle(t){t.clearSnapshot()}function pI(t){t.clearMeasurements()}function xI(t){t.isLayoutDirty=!1}function Ale(t){const{visualElement:n}=t.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),t.resetTransform()}function gI(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function kle(t){t.resolveTargetDelta()}function Ele(t){t.calcProjection()}function Tle(t){t.resetSkewAndRotation()}function Ile(t){t.removeLeadSnapshot()}function yI(t,n,s){t.translate=ts(n.translate,0,s),t.scale=ts(n.scale,1,s),t.origin=n.origin,t.originPoint=n.originPoint}function bI(t,n,s,r){t.min=ts(n.min,s.min,r),t.max=ts(n.max,s.max,r)}function Ple(t,n,s,r){bI(t.x,n.x,s.x,r),bI(t.y,n.y,s.y,r)}function Mle(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Ole={duration:.45,ease:[.4,0,.1,1]},vI=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),wI=vI("applewebkit/")&&!vI("chrome/")?Math.round:Si;function NI(t){t.min=wI(t.min),t.max=wI(t.max)}function Dle(t){NI(t.x),NI(t.y)}function LB(t,n,s){return t==="position"||t==="preserve-aspect"&&!zie(hI(n),hI(s),.2)}function Rle(t){var n;return t!==t.root&&((n=t.scroll)==null?void 0:n.wasRoot)}const Lle=RB({attachResizeListener:(t,n)=>Mp(t,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),SN={current:void 0},BB=RB({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!SN.current){const t=new Lle({});t.mount(window),t.setOptions({layoutScroll:!0}),SN.current=t}return SN.current},resetTransform:(t,n)=>{t.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Ble={pan:{Feature:nle},drag:{Feature:tle,ProjectionNode:BB,MeasureLayout:TB}};function jI(t,n,s){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",s==="Start");const i="onHover"+s,l=r[i];l&&Gn.postRender(()=>l(n,Nx(n)))}class Fle extends Jc{mount(){const{current:n}=this.node;n&&(this.unmount=iae(n,(s,r)=>(jI(this.node,r,"Start"),i=>jI(this.node,i,"End"))))}unmount(){}}class $le extends Jc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=bx(Mp(this.node.current,"focus",()=>this.onFocus()),Mp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function SI(t,n,s){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",s==="Start");const i="onTap"+(s==="End"?"":s),l=r[i];l&&Gn.postRender(()=>l(n,Nx(n)))}class zle extends Jc{mount(){const{current:n}=this.node;n&&(this.unmount=dae(n,(s,r)=>(SI(this.node,r,"Start"),(i,{success:l})=>SI(this.node,i,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const AS=new WeakMap,_N=new WeakMap,Ule=t=>{const n=AS.get(t.target);n&&n(t)},Vle=t=>{t.forEach(Ule)};function Hle({root:t,...n}){const s=t||document;_N.has(s)||_N.set(s,{});const r=_N.get(s),i=JSON.stringify(n);return r[i]||(r[i]=new IntersectionObserver(Vle,{root:t,...n})),r[i]}function Wle(t,n,s){const r=Hle(n);return AS.set(t,s),r.observe(t),()=>{AS.delete(t),r.unobserve(t)}}const qle={some:0,all:1};class Gle extends Jc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:s,margin:r,amount:i="some",once:l}=n,o={root:s?s.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:qle[i]},c=d=>{const{isIntersecting:u}=d;if(this.isInView===u||(this.isInView=u,l&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:m}=this.node.getProps(),x=u?h:m;x&&x(d)};return Wle(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:s}=this.node;["amount","margin","root"].some(Kle(n,s))&&this.startObserver()}unmount(){}}function Kle({viewport:t={}},{viewport:n={}}={}){return s=>t[s]!==n[s]}const Yle={inView:{Feature:Gle},tap:{Feature:zle},focus:{Feature:$le},hover:{Feature:Fle}},Xle={layout:{ProjectionNode:BB,MeasureLayout:TB}},Qle={...Die,...Yle,...Ble,...Xle},gt=Qae(Qle,die);function Mb(t){const n=kr(d=>d.modules)||{},s=kr(d=>d.user),r=(s==null?void 0:s.is_admin)&&Object.keys(n).length===0,i=n[t]||[],l=y.useMemo(()=>new Set(i.map(d=>d.code.split(".").pop())),[i]),o=r||i.length>0,c=d=>r||l.has(d);return{hasAny:o,canView:c("view"),canCreate:c("create"),canUpdate:c("update"),canDelete:c("delete")}}function FB(t){var n,s,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(s=FB(t[n]))&&(r&&(r+=" "),r+=s)}else for(s in t)t[s]&&(r&&(r+=" "),r+=s);return r}function fn(){for(var t,n,s=0,r="",i=arguments.length;s<i;s++)(t=arguments[s])&&(n=FB(t))&&(r&&(r+=" "),r+=n);return r}const G3="-",Zle=t=>{const n=eoe(t),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const c=o.split(G3);return c[0]===""&&c.length!==1&&c.shift(),$B(c,n)||Jle(o)},getConflictingClassGroupIds:(o,c)=>{const d=s[o]||[];return c&&r[o]?[...d,...r[o]]:d}}},$B=(t,n)=>{var o;if(t.length===0)return n.classGroupId;const s=t[0],r=n.nextPart.get(s),i=r?$B(t.slice(1),r):void 0;if(i)return i;if(n.validators.length===0)return;const l=t.join(G3);return(o=n.validators.find(({validator:c})=>c(l)))==null?void 0:o.classGroupId},_I=/^\[(.+)\]$/,Jle=t=>{if(_I.test(t)){const n=_I.exec(t)[1],s=n==null?void 0:n.substring(0,n.indexOf(":"));if(s)return"arbitrary.."+s}},eoe=t=>{const{theme:n,classGroups:s}=t,r={nextPart:new Map,validators:[]};for(const i in s)kS(s[i],r,i,n);return r},kS=(t,n,s,r)=>{t.forEach(i=>{if(typeof i=="string"){const l=i===""?n:CI(n,i);l.classGroupId=s;return}if(typeof i=="function"){if(toe(i)){kS(i(r),n,s,r);return}n.validators.push({validator:i,classGroupId:s});return}Object.entries(i).forEach(([l,o])=>{kS(o,CI(n,l),s,r)})})},CI=(t,n)=>{let s=t;return n.split(G3).forEach(r=>{s.nextPart.has(r)||s.nextPart.set(r,{nextPart:new Map,validators:[]}),s=s.nextPart.get(r)}),s},toe=t=>t.isThemeGetter,noe=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,s=new Map,r=new Map;const i=(l,o)=>{s.set(l,o),n++,n>t&&(n=0,r=s,s=new Map)};return{get(l){let o=s.get(l);if(o!==void 0)return o;if((o=r.get(l))!==void 0)return i(l,o),o},set(l,o){s.has(l)?s.set(l,o):i(l,o)}}},ES="!",TS=":",soe=TS.length,roe=t=>{const{prefix:n,experimentalParseClassName:s}=t;let r=i=>{const l=[];let o=0,c=0,d=0,u;for(let w=0;w<i.length;w++){let j=i[w];if(o===0&&c===0){if(j===TS){l.push(i.slice(d,w)),d=w+soe;continue}if(j==="/"){u=w;continue}}j==="["?o++:j==="]"?o--:j==="("?c++:j===")"&&c--}const h=l.length===0?i:i.substring(d),m=aoe(h),x=m!==h,b=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:x,baseClassName:m,maybePostfixModifierPosition:b}};if(n){const i=n+TS,l=r;r=o=>o.startsWith(i)?l(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(s){const i=r;r=l=>s({className:l,parseClassName:i})}return r},aoe=t=>t.endsWith(ES)?t.substring(0,t.length-1):t.startsWith(ES)?t.substring(1):t,ioe=t=>{const n=Object.fromEntries(t.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const i=[];let l=[];return r.forEach(o=>{o[0]==="["||n[o]?(i.push(...l.sort(),o),l=[]):l.push(o)}),i.push(...l.sort()),i}},loe=t=>({cache:noe(t.cacheSize),parseClassName:roe(t),sortModifiers:ioe(t),...Zle(t)}),ooe=/\s+/,coe=(t,n)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:l}=n,o=[],c=t.trim().split(ooe);let d="";for(let u=c.length-1;u>=0;u-=1){const h=c[u],{isExternal:m,modifiers:x,hasImportantModifier:b,baseClassName:w,maybePostfixModifierPosition:j}=s(h);if(m){d=h+(d.length>0?" "+d:d);continue}let S=!!j,C=r(S?w.substring(0,j):w);if(!C){if(!S){d=h+(d.length>0?" "+d:d);continue}if(C=r(w),!C){d=h+(d.length>0?" "+d:d);continue}S=!1}const A=l(x).join(":"),k=b?A+ES:A,T=k+C;if(o.includes(T))continue;o.push(T);const I=i(C,S);for(let D=0;D<I.length;++D){const O=I[D];o.push(k+O)}d=h+(d.length>0?" "+d:d)}return d};function doe(){let t=0,n,s,r="";for(;t<arguments.length;)(n=arguments[t++])&&(s=zB(n))&&(r&&(r+=" "),r+=s);return r}const zB=t=>{if(typeof t=="string")return t;let n,s="";for(let r=0;r<t.length;r++)t[r]&&(n=zB(t[r]))&&(s&&(s+=" "),s+=n);return s};function uoe(t,...n){let s,r,i,l=o;function o(d){const u=n.reduce((h,m)=>m(h),t());return s=loe(u),r=s.cache.get,i=s.cache.set,l=c,c(d)}function c(d){const u=r(d);if(u)return u;const h=coe(d,s);return i(d,h),h}return function(){return l(doe.apply(null,arguments))}}const $s=t=>{const n=s=>s[t]||[];return n.isThemeGetter=!0,n},UB=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,VB=/^\((?:(\w[\w-]*):)?(.+)\)$/i,foe=/^\d+\/\d+$/,hoe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,moe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,poe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,xoe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,goe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ku=t=>foe.test(t),Kt=t=>!!t&&!Number.isNaN(Number(t)),Qo=t=>!!t&&Number.isInteger(Number(t)),CN=t=>t.endsWith("%")&&Kt(t.slice(0,-1)),Ql=t=>hoe.test(t),yoe=()=>!0,boe=t=>moe.test(t)&&!poe.test(t),HB=()=>!1,voe=t=>xoe.test(t),woe=t=>goe.test(t),Noe=t=>!mt(t)&&!pt(t),joe=t=>Ch(t,GB,HB),mt=t=>UB.test(t),xd=t=>Ch(t,KB,boe),AN=t=>Ch(t,koe,Kt),AI=t=>Ch(t,WB,HB),Soe=t=>Ch(t,qB,woe),C0=t=>Ch(t,YB,voe),pt=t=>VB.test(t),mm=t=>Ah(t,KB),_oe=t=>Ah(t,Eoe),kI=t=>Ah(t,WB),Coe=t=>Ah(t,GB),Aoe=t=>Ah(t,qB),A0=t=>Ah(t,YB,!0),Ch=(t,n,s)=>{const r=UB.exec(t);return r?r[1]?n(r[1]):s(r[2]):!1},Ah=(t,n,s=!1)=>{const r=VB.exec(t);return r?r[1]?n(r[1]):s:!1},WB=t=>t==="position"||t==="percentage",qB=t=>t==="image"||t==="url",GB=t=>t==="length"||t==="size"||t==="bg-size",KB=t=>t==="length",koe=t=>t==="number",Eoe=t=>t==="family-name",YB=t=>t==="shadow",Toe=()=>{const t=$s("color"),n=$s("font"),s=$s("text"),r=$s("font-weight"),i=$s("tracking"),l=$s("leading"),o=$s("breakpoint"),c=$s("container"),d=$s("spacing"),u=$s("radius"),h=$s("shadow"),m=$s("inset-shadow"),x=$s("text-shadow"),b=$s("drop-shadow"),w=$s("blur"),j=$s("perspective"),S=$s("aspect"),C=$s("ease"),A=$s("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],I=()=>[...T(),pt,mt],D=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],R=()=>[pt,mt,d],P=()=>[Ku,"full","auto",...R()],L=()=>[Qo,"none","subgrid",pt,mt],$=()=>["auto",{span:["full",Qo,pt,mt]},Qo,pt,mt],B=()=>[Qo,"auto",pt,mt],V=()=>["auto","min","max","fr",pt,mt],K=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],H=()=>["auto",...R()],Y=()=>[Ku,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...R()],G=()=>[t,pt,mt],J=()=>[...T(),kI,AI,{position:[pt,mt]}],ee=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ye=()=>["auto","cover","contain",Coe,joe,{size:[pt,mt]}],ie=()=>[CN,mm,xd],he=()=>["","none","full",u,pt,mt],be=()=>["",Kt,mm,xd],we=()=>["solid","dashed","dotted","double"],Z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ce=()=>[Kt,CN,kI,AI],Te=()=>["","none",w,pt,mt],le=()=>["none",Kt,pt,mt],de=()=>["none",Kt,pt,mt],ge=()=>[Kt,pt,mt],ae=()=>[Ku,"full",...R()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ql],breakpoint:[Ql],color:[yoe],container:[Ql],"drop-shadow":[Ql],ease:["in","out","in-out"],font:[Noe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ql],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ql],shadow:[Ql],spacing:["px",Kt],text:[Ql],"text-shadow":[Ql],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ku,mt,pt,S]}],container:["container"],columns:[{columns:[Kt,mt,pt,c]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:I()}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:P()}],"inset-x":[{"inset-x":P()}],"inset-y":[{"inset-y":P()}],start:[{start:P()}],end:[{end:P()}],top:[{top:P()}],right:[{right:P()}],bottom:[{bottom:P()}],left:[{left:P()}],visibility:["visible","invisible","collapse"],z:[{z:[Qo,"auto",pt,mt]}],basis:[{basis:[Ku,"full","auto",c,...R()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Kt,Ku,"auto","initial","none",mt]}],grow:[{grow:["",Kt,pt,mt]}],shrink:[{shrink:["",Kt,pt,mt]}],order:[{order:[Qo,"first","last","none",pt,mt]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:$()}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:$()}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:R()}],"gap-x":[{"gap-x":R()}],"gap-y":[{"gap-y":R()}],"justify-content":[{justify:[...K(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...K()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":K()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:R()}],px:[{px:R()}],py:[{py:R()}],ps:[{ps:R()}],pe:[{pe:R()}],pt:[{pt:R()}],pr:[{pr:R()}],pb:[{pb:R()}],pl:[{pl:R()}],m:[{m:H()}],mx:[{mx:H()}],my:[{my:H()}],ms:[{ms:H()}],me:[{me:H()}],mt:[{mt:H()}],mr:[{mr:H()}],mb:[{mb:H()}],ml:[{ml:H()}],"space-x":[{"space-x":R()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":R()}],"space-y-reverse":["space-y-reverse"],size:[{size:Y()}],w:[{w:[c,"screen",...Y()]}],"min-w":[{"min-w":[c,"screen","none",...Y()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...Y()]}],h:[{h:["screen","lh",...Y()]}],"min-h":[{"min-h":["screen","lh","none",...Y()]}],"max-h":[{"max-h":["screen","lh",...Y()]}],"font-size":[{text:["base",s,mm,xd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,pt,AN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",CN,mt]}],"font-family":[{font:[_oe,mt,n]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,pt,mt]}],"line-clamp":[{"line-clamp":[Kt,"none",pt,AN]}],leading:[{leading:[l,...R()]}],"list-image":[{"list-image":["none",pt,mt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",pt,mt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:G()}],"text-color":[{text:G()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...we(),"wavy"]}],"text-decoration-thickness":[{decoration:[Kt,"from-font","auto",pt,xd]}],"text-decoration-color":[{decoration:G()}],"underline-offset":[{"underline-offset":[Kt,"auto",pt,mt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pt,mt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pt,mt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:J()}],"bg-repeat":[{bg:ee()}],"bg-size":[{bg:ye()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Qo,pt,mt],radial:["",pt,mt],conic:[Qo,pt,mt]},Aoe,Soe]}],"bg-color":[{bg:G()}],"gradient-from-pos":[{from:ie()}],"gradient-via-pos":[{via:ie()}],"gradient-to-pos":[{to:ie()}],"gradient-from":[{from:G()}],"gradient-via":[{via:G()}],"gradient-to":[{to:G()}],rounded:[{rounded:he()}],"rounded-s":[{"rounded-s":he()}],"rounded-e":[{"rounded-e":he()}],"rounded-t":[{"rounded-t":he()}],"rounded-r":[{"rounded-r":he()}],"rounded-b":[{"rounded-b":he()}],"rounded-l":[{"rounded-l":he()}],"rounded-ss":[{"rounded-ss":he()}],"rounded-se":[{"rounded-se":he()}],"rounded-ee":[{"rounded-ee":he()}],"rounded-es":[{"rounded-es":he()}],"rounded-tl":[{"rounded-tl":he()}],"rounded-tr":[{"rounded-tr":he()}],"rounded-br":[{"rounded-br":he()}],"rounded-bl":[{"rounded-bl":he()}],"border-w":[{border:be()}],"border-w-x":[{"border-x":be()}],"border-w-y":[{"border-y":be()}],"border-w-s":[{"border-s":be()}],"border-w-e":[{"border-e":be()}],"border-w-t":[{"border-t":be()}],"border-w-r":[{"border-r":be()}],"border-w-b":[{"border-b":be()}],"border-w-l":[{"border-l":be()}],"divide-x":[{"divide-x":be()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":be()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...we(),"hidden","none"]}],"divide-style":[{divide:[...we(),"hidden","none"]}],"border-color":[{border:G()}],"border-color-x":[{"border-x":G()}],"border-color-y":[{"border-y":G()}],"border-color-s":[{"border-s":G()}],"border-color-e":[{"border-e":G()}],"border-color-t":[{"border-t":G()}],"border-color-r":[{"border-r":G()}],"border-color-b":[{"border-b":G()}],"border-color-l":[{"border-l":G()}],"divide-color":[{divide:G()}],"outline-style":[{outline:[...we(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Kt,pt,mt]}],"outline-w":[{outline:["",Kt,mm,xd]}],"outline-color":[{outline:G()}],shadow:[{shadow:["","none",h,A0,C0]}],"shadow-color":[{shadow:G()}],"inset-shadow":[{"inset-shadow":["none",m,A0,C0]}],"inset-shadow-color":[{"inset-shadow":G()}],"ring-w":[{ring:be()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:G()}],"ring-offset-w":[{"ring-offset":[Kt,xd]}],"ring-offset-color":[{"ring-offset":G()}],"inset-ring-w":[{"inset-ring":be()}],"inset-ring-color":[{"inset-ring":G()}],"text-shadow":[{"text-shadow":["none",x,A0,C0]}],"text-shadow-color":[{"text-shadow":G()}],opacity:[{opacity:[Kt,pt,mt]}],"mix-blend":[{"mix-blend":[...Z(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Kt]}],"mask-image-linear-from-pos":[{"mask-linear-from":ce()}],"mask-image-linear-to-pos":[{"mask-linear-to":ce()}],"mask-image-linear-from-color":[{"mask-linear-from":G()}],"mask-image-linear-to-color":[{"mask-linear-to":G()}],"mask-image-t-from-pos":[{"mask-t-from":ce()}],"mask-image-t-to-pos":[{"mask-t-to":ce()}],"mask-image-t-from-color":[{"mask-t-from":G()}],"mask-image-t-to-color":[{"mask-t-to":G()}],"mask-image-r-from-pos":[{"mask-r-from":ce()}],"mask-image-r-to-pos":[{"mask-r-to":ce()}],"mask-image-r-from-color":[{"mask-r-from":G()}],"mask-image-r-to-color":[{"mask-r-to":G()}],"mask-image-b-from-pos":[{"mask-b-from":ce()}],"mask-image-b-to-pos":[{"mask-b-to":ce()}],"mask-image-b-from-color":[{"mask-b-from":G()}],"mask-image-b-to-color":[{"mask-b-to":G()}],"mask-image-l-from-pos":[{"mask-l-from":ce()}],"mask-image-l-to-pos":[{"mask-l-to":ce()}],"mask-image-l-from-color":[{"mask-l-from":G()}],"mask-image-l-to-color":[{"mask-l-to":G()}],"mask-image-x-from-pos":[{"mask-x-from":ce()}],"mask-image-x-to-pos":[{"mask-x-to":ce()}],"mask-image-x-from-color":[{"mask-x-from":G()}],"mask-image-x-to-color":[{"mask-x-to":G()}],"mask-image-y-from-pos":[{"mask-y-from":ce()}],"mask-image-y-to-pos":[{"mask-y-to":ce()}],"mask-image-y-from-color":[{"mask-y-from":G()}],"mask-image-y-to-color":[{"mask-y-to":G()}],"mask-image-radial":[{"mask-radial":[pt,mt]}],"mask-image-radial-from-pos":[{"mask-radial-from":ce()}],"mask-image-radial-to-pos":[{"mask-radial-to":ce()}],"mask-image-radial-from-color":[{"mask-radial-from":G()}],"mask-image-radial-to-color":[{"mask-radial-to":G()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":T()}],"mask-image-conic-pos":[{"mask-conic":[Kt]}],"mask-image-conic-from-pos":[{"mask-conic-from":ce()}],"mask-image-conic-to-pos":[{"mask-conic-to":ce()}],"mask-image-conic-from-color":[{"mask-conic-from":G()}],"mask-image-conic-to-color":[{"mask-conic-to":G()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:J()}],"mask-repeat":[{mask:ee()}],"mask-size":[{mask:ye()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",pt,mt]}],filter:[{filter:["","none",pt,mt]}],blur:[{blur:Te()}],brightness:[{brightness:[Kt,pt,mt]}],contrast:[{contrast:[Kt,pt,mt]}],"drop-shadow":[{"drop-shadow":["","none",b,A0,C0]}],"drop-shadow-color":[{"drop-shadow":G()}],grayscale:[{grayscale:["",Kt,pt,mt]}],"hue-rotate":[{"hue-rotate":[Kt,pt,mt]}],invert:[{invert:["",Kt,pt,mt]}],saturate:[{saturate:[Kt,pt,mt]}],sepia:[{sepia:["",Kt,pt,mt]}],"backdrop-filter":[{"backdrop-filter":["","none",pt,mt]}],"backdrop-blur":[{"backdrop-blur":Te()}],"backdrop-brightness":[{"backdrop-brightness":[Kt,pt,mt]}],"backdrop-contrast":[{"backdrop-contrast":[Kt,pt,mt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Kt,pt,mt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Kt,pt,mt]}],"backdrop-invert":[{"backdrop-invert":["",Kt,pt,mt]}],"backdrop-opacity":[{"backdrop-opacity":[Kt,pt,mt]}],"backdrop-saturate":[{"backdrop-saturate":[Kt,pt,mt]}],"backdrop-sepia":[{"backdrop-sepia":["",Kt,pt,mt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":R()}],"border-spacing-x":[{"border-spacing-x":R()}],"border-spacing-y":[{"border-spacing-y":R()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",pt,mt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Kt,"initial",pt,mt]}],ease:[{ease:["linear","initial",C,pt,mt]}],delay:[{delay:[Kt,pt,mt]}],animate:[{animate:["none",A,pt,mt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[j,pt,mt]}],"perspective-origin":[{"perspective-origin":I()}],rotate:[{rotate:le()}],"rotate-x":[{"rotate-x":le()}],"rotate-y":[{"rotate-y":le()}],"rotate-z":[{"rotate-z":le()}],scale:[{scale:de()}],"scale-x":[{"scale-x":de()}],"scale-y":[{"scale-y":de()}],"scale-z":[{"scale-z":de()}],"scale-3d":["scale-3d"],skew:[{skew:ge()}],"skew-x":[{"skew-x":ge()}],"skew-y":[{"skew-y":ge()}],transform:[{transform:[pt,mt,"","none","gpu","cpu"]}],"transform-origin":[{origin:I()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ae()}],"translate-x":[{"translate-x":ae()}],"translate-y":[{"translate-y":ae()}],"translate-z":[{"translate-z":ae()}],"translate-none":["translate-none"],accent:[{accent:G()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:G()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pt,mt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pt,mt]}],fill:[{fill:["none",...G()]}],"stroke-w":[{stroke:[Kt,mm,xd,AN]}],stroke:[{stroke:["none",...G()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ioe=uoe(Toe);function It(...t){return Ioe(fn(t))}const Le=y.forwardRef(({className:t,...n},s)=>a.jsx("div",{ref:s,className:It("rounded-xl border bg-card text-card-foreground shadow",t),...n}));Le.displayName="Card";const Je=y.forwardRef(({className:t,...n},s)=>a.jsx("div",{ref:s,className:It("flex flex-col space-y-1.5 p-6",t),...n}));Je.displayName="CardHeader";const st=y.forwardRef(({className:t,...n},s)=>a.jsx("div",{ref:s,className:It("font-semibold leading-none tracking-tight",t),...n}));st.displayName="CardTitle";const Sa=y.forwardRef(({className:t,...n},s)=>a.jsx("div",{ref:s,className:It("text-sm text-muted-foreground",t),...n}));Sa.displayName="CardDescription";const ze=y.forwardRef(({className:t,...n},s)=>a.jsx("div",{ref:s,className:It("p-6 pt-0",t),...n}));ze.displayName="CardContent";const Poe=y.forwardRef(({className:t,...n},s)=>a.jsx("div",{ref:s,className:It("flex items-center p-6 pt-0",t),...n}));Poe.displayName="CardFooter";const EI=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,TI=fn,Ob=(t,n)=>s=>{var r;if((n==null?void 0:n.variants)==null)return TI(t,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:i,defaultVariants:l}=n,o=Object.keys(i).map(u=>{const h=s==null?void 0:s[u],m=l==null?void 0:l[u];if(h===null)return null;const x=EI(h)||EI(m);return i[u][x]}),c=s&&Object.entries(s).reduce((u,h)=>{let[m,x]=h;return x===void 0||(u[m]=x),u},{}),d=n==null||(r=n.compoundVariants)===null||r===void 0?void 0:r.reduce((u,h)=>{let{class:m,className:x,...b}=h;return Object.entries(b).every(w=>{let[j,S]=w;return Array.isArray(S)?S.includes({...l,...c}[j]):{...l,...c}[j]===S})?[...u,m,x]:u},[]);return TI(t,o,d,s==null?void 0:s.class,s==null?void 0:s.className)},Moe=Ob("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Xe({className:t,variant:n,...s}){return a.jsx("div",{className:It(Moe({variant:n}),t),...s})}function II(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function XB(...t){return n=>{let s=!1;const r=t.map(i=>{const l=II(i,n);return!s&&typeof l=="function"&&(s=!0),l});if(s)return()=>{for(let i=0;i<r.length;i++){const l=r[i];typeof l=="function"?l():II(t[i],null)}}}}function Sn(...t){return y.useCallback(XB(...t),t)}function Jf(t){const n=Doe(t),s=y.forwardRef((r,i)=>{const{children:l,...o}=r,c=y.Children.toArray(l),d=c.find(Loe);if(d){const u=d.props.children,h=c.map(m=>m===d?y.Children.count(u)>1?y.Children.only(null):y.isValidElement(u)?u.props.children:null:m);return a.jsx(n,{...o,ref:i,children:y.isValidElement(u)?y.cloneElement(u,void 0,h):null})}return a.jsx(n,{...o,ref:i,children:l})});return s.displayName=`${t}.Slot`,s}var Ooe=Jf("Slot");function Doe(t){const n=y.forwardRef((s,r)=>{const{children:i,...l}=s;if(y.isValidElement(i)){const o=Foe(i),c=Boe(l,i.props);return i.type!==y.Fragment&&(c.ref=r?XB(r,o):o),y.cloneElement(i,c)}return y.Children.count(i)>1?y.Children.only(null):null});return n.displayName=`${t}.SlotClone`,n}var Roe=Symbol("radix.slottable");function Loe(t){return y.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Roe}function Boe(t,n){const s={...n};for(const r in n){const i=t[r],l=n[r];/^on[A-Z]/.test(r)?i&&l?s[r]=(...c)=>{const d=l(...c);return i(...c),d}:i&&(s[r]=i):r==="style"?s[r]={...i,...l}:r==="className"&&(s[r]=[i,l].filter(Boolean).join(" "))}return{...t,...s}}function Foe(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}const $oe=Ob("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Pe=y.forwardRef(({className:t,variant:n,size:s,asChild:r=!1,...i},l)=>{const o=r?Ooe:"button";return a.jsx(o,{className:It($oe({variant:n,size:s,className:t})),ref:l,...i})});Pe.displayName="Button";const _e=y.forwardRef(({className:t,type:n,...s},r)=>a.jsx("input",{type:n,className:It("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s}));_e.displayName="Input";function $c({variant:t="default",className:n,children:s,...r}){const i="relative w-full rounded-lg border px-4 py-3 text-sm flex gap-3 items-start",l={default:"bg-slate-50 border-slate-200 text-slate-800",destructive:"bg-rose-50 border-rose-200 text-rose-800"};return a.jsx("div",{role:"alert",className:It(i,l[t]||l.default,n),...r,children:s})}function zc({className:t,children:n,...s}){return a.jsx("div",{className:It("font-semibold leading-tight text-sm",t),...s,children:n})}function Uc({className:t,children:n,...s}){return a.jsx("div",{className:It("text-xs mt-1 text-slate-700",t),...s,children:n})}function Ze({className:t,...n}){return a.jsx("div",{className:It("animate-pulse rounded-md bg-primary/10",t),...n})}const k0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function zoe(){const{hasAny:t,canView:n,canCreate:s,canUpdate:r,canDelete:i}=Mb("departments"),[l,o]=y.useState([]),[c,d]=y.useState({name:"",description:""}),[u,h]=y.useState(null),[m,x]=y.useState(""),[b,w]=y.useState(!1),[j,S]=y.useState(!1),C=y.useCallback(async()=>{var I,D,O;if(n){x(""),S(!0);try{const{data:R}=await ne.get("/departments/");o(R||[])}catch(R){const P=(I=R==null?void 0:R.response)==null?void 0:I.status;x(P===403?"Access denied for Departments.":P===401?"Session expired. Please login again.":((O=(D=R==null?void 0:R.response)==null?void 0:D.data)==null?void 0:O.detail)||"Failed to load departments.")}finally{S(!1)}}},[n]);y.useEffect(()=>{C()},[C]);const A=async I=>{var D,O,R;if(I.preventDefault(),!(!u&&!s)&&!(u&&!r)){w(!0),x("");try{u?await ne.put(`/departments/${u}`,c):await ne.post("/departments/",c),d({name:"",description:""}),h(null),C()}catch(P){const L=(D=P==null?void 0:P.response)==null?void 0:D.status;x(L===403?"Access denied.":L===401?"Session expired. Please login again.":((R=(O=P==null?void 0:P.response)==null?void 0:O.data)==null?void 0:R.detail)||"Failed to save department.")}finally{w(!1)}}},k=async I=>{var D,O,R;if(i&&window.confirm("Delete this department?"))try{await ne.delete(`/departments/${I}`),C()}catch(P){const L=(D=P==null?void 0:P.response)==null?void 0:D.status;x(L===403?"Access denied.":L===401?"Session expired. Please login again.":((R=(O=P==null?void 0:P.response)==null?void 0:O.data)==null?void 0:R.detail)||"Failed to delete department.")}},T=I=>{r&&(h(I.id),d({name:I.name,description:I.description||""}))};return!t||!n?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{children:a.jsx(st,{className:"text-base text-slate-900",children:"Departments"})}),a.jsx(ze,{children:a.jsxs($c,{variant:"destructive",className:"border-amber-200 bg-amber-50 text-amber-800",children:[a.jsx(zc,{children:"Access restricted"}),a.jsx(Uc,{className:"text-sm",children:"You dont have permission to view the Departments module."})]})})]})})}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsx(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium tracking-wide text-slate-600",children:"Admin  Departments"}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),a.jsx("span",{children:"Desktop workspace"})]})]}),a.jsx(gt.div,{...k0,children:a.jsx(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:a.jsxs(Je,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(Ya,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(st,{className:"text-base sm:text-lg text-slate-900",children:"Clinical & support departments"}),a.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Configure OPD, IPD, diagnostics and support departments to align users, doctors and services."})]})]}),a.jsx("div",{className:"grid w-full gap-2 sm:w-auto sm:grid-cols-1",children:a.jsx(Uoe,{label:"Departments",value:l.length,hint:"Mapped across OPD, IPD, lab, radiology, etc."})})]})})}),m&&a.jsx(gt.div,{...k0,children:a.jsxs($c,{variant:"destructive",className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[a.jsx(zc,{children:"Issue"}),a.jsx(Uc,{className:"text-sm",children:m})]})}),a.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,260px)_minmax(0,1fr)]",children:[a.jsx(gt.div,{...k0,children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Je,{className:"pb-3",children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:u?"Edit department":"Create department"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Add or update hospital departments that will be used across modules."})]}),a.jsx(ze,{children:a.jsxs("form",{onSubmit:A,className:"grid gap-3",children:[a.jsx(_e,{placeholder:"Department name (e.g., General Medicine)",value:c.name,onChange:I=>d({...c,name:I.target.value}),required:!0,disabled:!(u?r:s),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(_e,{placeholder:"Description (optional)",value:c.description,onChange:I=>d({...c,description:I.target.value}),disabled:!(u?r:s),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[u&&a.jsx("button",{type:"button",onClick:()=>{h(null),d({name:"",description:""})},className:"text-[11px] text-slate-500 underline",children:"Cancel edit & reset"}),a.jsx(Pe,{type:"submit",className:"ml-auto rounded-2xl bg-slate-900 px-4 py-1.5 text-xs font-medium text-white hover:bg-slate-800",disabled:b||(u?!r:!s),children:b?"Saving...":u?"Update department":"Create department"})]})]})})]})}),a.jsx(gt.div,{...k0,children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Department list"}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[l.length," configured department(s)."]})]})})}),a.jsx(ze,{className:"pt-4",children:j?a.jsx("div",{className:"space-y-2",children:[0,1,2].map(I=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Ze,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),a.jsx(Ze,{className:"h-2.5 w-1/2 rounded-full bg-slate-100"})]}),a.jsx(Ze,{className:"h-6 w-20 rounded-full bg-slate-100"})]},I))}):a.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 text-left",children:"#"}),a.jsx("th",{className:"p-2 text-left",children:"Name"}),a.jsx("th",{className:"p-2 text-left",children:"Description"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[l.map((I,D)=>a.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800",children:[a.jsx("td",{className:"p-2",children:D+1}),a.jsx("td",{className:"p-2",children:I.name}),a.jsx("td",{className:"p-2 text-slate-500",children:I.description||""}),a.jsx("td",{className:"p-2 text-right",children:a.jsxs("div",{className:"inline-flex gap-2",children:[r&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>T(I),children:"Edit"}),i&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>k(I.id),children:"Delete"})]})})]},I.id)),!l.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-4",children:a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No departments yet."}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Use the form on the left to add your first department."})]})})})]})]})})})]})})]})]})})}function Uoe({label:t,value:n,hint:s}){return a.jsxs(gt.div,{whileHover:{y:-2,scale:1.01},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-600",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:t}),a.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:n}),s&&a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-400",children:s})]})}const E0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Voe(){const{hasAny:t,canView:n,canCreate:s,canUpdate:r,canDelete:i}=Mb("roles"),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState({name:"",description:"",permission_ids:[]}),[m,x]=y.useState(null),[b,w]=y.useState(!1),[j,S]=y.useState(!1),[C,A]=y.useState(""),k=y.useCallback(async()=>{var R,P,L;if(n){A(""),S(!0);try{const[$,B]=await Promise.all([ne.get("/roles/"),ne.get("/permissions/")]);o($.data||[]),d(B.data||[])}catch($){const B=(R=$==null?void 0:$.response)==null?void 0:R.status;A(B===403?"Access denied for Roles.":B===401?"Session expired. Please login again.":((L=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:L.detail)||"Failed to load roles.")}finally{S(!1)}}},[n]);y.useEffect(()=>{k()},[k]);const T=R=>{h(P=>({...P,permission_ids:P.permission_ids.includes(R)?P.permission_ids.filter(L=>L!==R):[...P.permission_ids,R]}))},I=async R=>{var P,L;if(R.preventDefault(),!(!m&&!s)&&!(m&&!r)){w(!0),A("");try{m?await ne.put(`/roles/${m}`,u):await ne.post("/roles/",u),h({name:"",description:"",permission_ids:[]}),x(null),k()}catch($){A(((L=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:L.detail)||"Failed to save role.")}finally{w(!1)}}},D=R=>{r&&(x(R.id),h({name:R.name,description:R.description||"",permission_ids:R.permission_ids||[]}))},O=async R=>{var P,L;if(i&&window.confirm("Delete this role?"))try{await ne.delete(`/roles/${R}`),k()}catch($){A(((L=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:L.detail)||"Failed to delete role.")}};return!t||!n?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{children:a.jsx(st,{className:"text-base text-slate-900",children:"Roles"})}),a.jsx(ze,{children:a.jsxs($c,{variant:"destructive",className:"border-amber-200 bg-amber-50 text-amber-800",children:[a.jsx(zc,{children:"Access restricted"}),a.jsx(Uc,{className:"text-sm",children:"You dont have permission to view the Roles module."})]})})]})})}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsx(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium tracking-wide text-slate-600",children:"Admin  Roles & permissions"}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),a.jsx("span",{children:"Desktop workspace"})]})]}),a.jsx(gt.div,{...E0,children:a.jsx(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:a.jsxs(Je,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(Ji,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(st,{className:"text-base sm:text-lg text-slate-900",children:"Roles & Permissions"}),a.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Define role templates and attach permission sets for OPD, IPD, billing, pharmacy, lab and other modules."})]})]}),a.jsxs("div",{className:"grid w-full gap-2 sm:w-auto sm:grid-cols-2",children:[a.jsx(PI,{label:"Roles",value:l.length,hint:"Reusable access profiles"}),a.jsx(PI,{label:"Permissions",value:c.length,hint:"Atomic permission codes"})]})]})})}),C&&a.jsx(gt.div,{...E0,children:a.jsxs($c,{variant:"destructive",className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[a.jsx(zc,{children:"Issue"}),a.jsx(Uc,{className:"text-sm",children:C})]})}),a.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,290px)_minmax(0,1fr)]",children:[a.jsx(gt.div,{...E0,children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:a.jsx(io,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:m?"Edit role":"Create role"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Group permissions into named roles and assign them to users."})]})]})}),a.jsx(ze,{className:"space-y-3",children:a.jsxs("form",{onSubmit:I,className:"space-y-3",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(_e,{placeholder:"Role name (e.g., OPD Doctor)",value:u.name,onChange:R=>h({...u,name:R.target.value}),required:!0,disabled:!(m?r:s),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(_e,{placeholder:"Description (optional)",value:u.description,onChange:R=>h({...u,description:R.target.value}),disabled:!(m?r:s),className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[a.jsx("span",{className:"font-medium text-slate-700",children:"Permissions"}),a.jsxs("span",{className:"text-slate-400",children:[u.permission_ids.length||0," selected"]})]}),a.jsxs("div",{className:"max-h-64 space-y-1 overflow-y-auto rounded-2xl border border-slate-100 bg-slate-50 px-2 py-2",children:[c.map(R=>a.jsxs("label",{className:`flex cursor-pointer items-start gap-2 rounded-2xl px-2 py-1.5 text-[11px] ${u.permission_ids.includes(R.id)?"bg-white":"bg-slate-50"}`,children:[a.jsx("input",{type:"checkbox",checked:u.permission_ids.includes(R.id),onChange:()=>T(R.id),disabled:!(m?r:s),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300"}),a.jsxs("span",{children:[a.jsx("span",{className:"block font-medium text-slate-800",children:R.label}),a.jsx("span",{className:"block text-[10px] text-slate-500",children:R.code})]})]},R.id)),!c.length&&!j&&a.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"No permissions configured yet."}),j&&a.jsx("div",{className:"space-y-2",children:[0,1,2].map(R=>a.jsxs("div",{className:"flex items-center gap-2 rounded-2xl px-2 py-1.5",children:[a.jsx(Ze,{className:"h-3 w-3 rounded bg-slate-100"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx(Ze,{className:"h-3 w-1/2 rounded-full bg-slate-100"}),a.jsx(Ze,{className:"h-2 w-1/3 rounded-full bg-slate-100"})]})]},R))})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[m&&a.jsx("button",{type:"button",onClick:()=>{x(null),h({name:"",description:"",permission_ids:[]})},className:"text-[11px] text-slate-500 underline",children:"Cancel edit & reset"}),a.jsx(Pe,{type:"submit",className:"ml-auto rounded-2xl bg-slate-900 px-4 py-1.5 text-xs font-medium text-white hover:bg-slate-800",disabled:b||(m?!r:!s),children:b?"Saving...":m?"Update role":"Create role"})]})]})})]})}),a.jsx(gt.div,{...E0,children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Role list"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Overview of all defined roles and number of attached permissions."})]})})}),a.jsx(ze,{className:"pt-4",children:j?a.jsx("div",{className:"space-y-2",children:[0,1,2].map(R=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Ze,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),a.jsx(Ze,{className:"h-2.5 w-1/4 rounded-full bg-slate-100"})]}),a.jsx(Ze,{className:"h-6 w-20 rounded-full bg-slate-100"})]},R))}):a.jsx("div",{className:"overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 text-left",children:"#"}),a.jsx("th",{className:"p-2 text-left",children:"Role name"}),a.jsx("th",{className:"p-2 text-left",children:"Description"}),a.jsx("th",{className:"p-2 text-left",children:"Permissions"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[l.map((R,P)=>{var L;return a.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800",children:[a.jsx("td",{className:"p-2",children:P+1}),a.jsx("td",{className:"p-2",children:R.name}),a.jsx("td",{className:"p-2 text-slate-500",children:R.description||""}),a.jsxs("td",{className:"p-2 text-slate-600",children:[((L=R.permission_ids)==null?void 0:L.length)||0," permissions"]}),a.jsx("td",{className:"p-2 text-right",children:a.jsxs("div",{className:"inline-flex gap-2",children:[r&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>D(R),children:"Edit"}),i&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>O(R.id),children:"Delete"})]})})]},R.id)}),!l.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4",children:a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-slate-700",children:"No roles defined yet."}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Create a role on the left to start grouping permissions."})]})})})]})]})})})]})})]})]})})}function PI({label:t,value:n,hint:s}){return a.jsxs(gt.div,{whileHover:{y:-2,scale:1.01},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-600",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:t}),a.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:n}),s&&a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-400",children:s})]})}function Hoe(){const{hasAny:t,canView:n,canCreate:s,canUpdate:r,canDelete:i}=Mb("permissions"),[l,o]=y.useState([]),[c,d]=y.useState({code:"",label:"",module:""}),[u,h]=y.useState(null),[m,x]=y.useState(!1),[b,w]=y.useState(""),j=y.useCallback(async()=>{var k,T,I;if(n){w("");try{const D=await ne.get("/permissions/");o(D.data)}catch(D){const O=(k=D==null?void 0:D.response)==null?void 0:k.status;w(O===403?"Access denied for Permissions.":O===401?"Session expired. Please login again.":((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to load")}}},[n]);y.useEffect(()=>{j()},[j]);const S=async k=>{var T,I;if(k.preventDefault(),!(!u&&!s)&&!(u&&!r)){x(!0),w("");try{u?await ne.put(`/permissions/${u}`,c):await ne.post("/permissions/",c),d({code:"",label:"",module:""}),h(null),j()}catch(D){w(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to save")}finally{x(!1)}}},C=async k=>{var T,I;if(i&&confirm("Delete this permission?"))try{await ne.delete(`/permissions/${k}`),j()}catch(D){w(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to delete")}},A=k=>{r&&(h(k.id),d({code:k.code,label:k.label,module:k.module}))};return!t||!n?a.jsxs("section",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Permissions"}),a.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-700",children:"You dont have access to view this module."})]}):a.jsxs("section",{className:"card text-black",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Permissions"})}),a.jsxs("form",{onSubmit:S,className:"grid md:grid-cols-4 gap-3 mb-4",children:[a.jsx("input",{className:"input",placeholder:"code (e.g. users.view)",value:c.code,onChange:k=>d({...c,code:k.target.value}),required:!0,disabled:!(u?r:s)}),a.jsx("input",{className:"input",placeholder:"label (Users  View)",value:c.label,onChange:k=>d({...c,label:k.target.value}),required:!0,disabled:!(u?r:s)}),a.jsx("input",{className:"input",placeholder:"module (users)",value:c.module,onChange:k=>d({...c,module:k.target.value}),required:!0,disabled:!(u?r:s)}),a.jsx("button",{className:"btn",disabled:m||(u?!r:!s),children:u?"Update":"Create"})]}),b&&a.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:b}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Label"}),a.jsx("th",{className:"p-2",children:"Module"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[l.map((k,T)=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"p-2",children:T+1}),a.jsx("td",{className:"p-2 font-mono text-xs",children:k.code}),a.jsx("td",{className:"p-2",children:k.label}),a.jsx("td",{className:"p-2",children:k.module}),a.jsxs("td",{className:"p-2 text-right space-x-2",children:[r&&a.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>A(k),children:"Edit"}),i&&a.jsx("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>C(k.id),children:"Delete"})]})]},k.id)),!l.length&&a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-sm text-gray-500",colSpan:"5",children:"No permissions yet."})})]})]})})]})}const T0={initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18}};function Woe(){const{hasAny:t,canView:n,canCreate:s,canUpdate:r,canDelete:i}=Mb("users"),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState([]),[m,x]=y.useState({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),[b,w]=y.useState(null),[j,S]=y.useState(!1),[C,A]=y.useState(!1),[k,T]=y.useState(""),[I,D]=y.useState("all"),[O,R]=y.useState(""),P=b?r:s,L=y.useCallback(async()=>{var ee,ye,ie;if(n){T(""),A(!0);try{const[he,be,we]=await Promise.all([ne.get("/users/"),ne.get("/roles/").catch(()=>({data:[]})),ne.get("/departments/").catch(()=>({data:[]}))]);o(he.data||[]),d(be.data||[]),h(we.data||[])}catch(he){const be=(ee=he==null?void 0:he.response)==null?void 0:ee.status;T(be===403?"Access denied for Users.":be===401?"Session expired. Please login again.":((ie=(ye=he==null?void 0:he.response)==null?void 0:ye.data)==null?void 0:ie.detail)||"Failed to load users.")}finally{A(!1)}}},[n]);y.useEffect(()=>{L()},[L]);const $=y.useMemo(()=>{const ee={};return u.forEach(ye=>{ee[ye.id]=ye.name}),ee},[u]),B=ee=>{x(ye=>({...ye,role_ids:ye.role_ids.includes(ee)?ye.role_ids.filter(ie=>ie!==ee):[...ye.role_ids,ee]}))},V=()=>{x({name:"",email:"",password:"",department_id:"",role_ids:[],is_doctor:!1,is_active:!0}),w(null)},K=async ee=>{var ie,he;if(ee.preventDefault(),!b&&!s||b&&!r)return;S(!0),T("");const ye={...m,department_id:m.department_id?Number(m.department_id):null};try{b?await ne.put(`/users/${b}`,ye):await ne.post("/users/",ye),V(),L()}catch(be){T(((he=(ie=be==null?void 0:be.response)==null?void 0:ie.data)==null?void 0:he.detail)||"Failed to save user.")}finally{S(!1)}},z=async ee=>{var ye,ie;if(i&&window.confirm("Delete this user?"))try{await ne.delete(`/users/${ee}`),L()}catch(he){T(((ie=(ye=he==null?void 0:he.response)==null?void 0:ye.data)==null?void 0:ie.detail)||"Failed to delete user.")}},H=ee=>{r&&(w(ee.id),x({name:ee.name||"",email:ee.email||"",password:"",department_id:ee.department_id||"",role_ids:ee.role_ids||[],is_doctor:!!ee.is_doctor,is_active:ee.is_active??!0}))},Y=y.useMemo(()=>l.filter(ee=>ee.is_doctor).length,[l]),G=y.useMemo(()=>l.filter(ee=>ee.is_active).length,[l]),J=y.useMemo(()=>{let ee=l;if(I==="doctors"&&(ee=ee.filter(ye=>ye.is_doctor)),O.trim()){const ye=O.toLowerCase();ee=ee.filter(ie=>(ie.name||"").toLowerCase().includes(ye)||(ie.email||"").toLowerCase().includes(ye))}return ee},[l,I,O]);return!t||!n?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{children:a.jsx(st,{className:"text-base text-slate-900",children:"Users"})}),a.jsx(ze,{children:a.jsxs($c,{variant:"destructive",className:"border-amber-200 bg-amber-50 text-amber-800",children:[a.jsx(zc,{children:"Access restricted"}),a.jsx(Uc,{className:"text-sm",children:"You dont have permission to view the Users module. Contact your administrator for access."})]})})]})})}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 py-4 md:px-6 md:py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsx(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium tracking-wide text-slate-600",children:"Admin  User management"}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 shadow-sm animate-pulse"}),a.jsx("span",{children:"Desktop workspace"})]})]}),a.jsx(gt.div,{...T0,children:a.jsx(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:a.jsxs(Je,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(Ap,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(st,{className:"text-base sm:text-lg text-slate-900",children:"Users & Doctors"}),a.jsx("p",{className:"mt-1 text-xs text-slate-600",children:"Manage staff accounts, link them to departments, assign roles and mark doctors for OPD/IPD routing."})]})]}),a.jsxs("div",{className:"grid w-full gap-2 sm:w-auto sm:grid-cols-3",children:[a.jsx(kN,{label:"Total users",value:l.length,hint:"All active & inactive staff"}),a.jsx(kN,{label:"Doctors",value:Y,icon:a.jsx(un,{className:"h-3 w-3 text-emerald-600"}),hint:"Marked as doctor"}),a.jsx(kN,{label:"Active users",value:G,hint:"Can login today"})]})]})})}),k&&a.jsx(gt.div,{...T0,children:a.jsxs($c,{variant:"destructive",className:"rounded-2xl border-red-200 bg-red-50 text-red-800",children:[a.jsx(zc,{children:"Issue"}),a.jsx(Uc,{className:"text-sm",children:k})]})}),a.jsxs("div",{className:"grid items-start gap-4 lg:grid-cols-[minmax(0,260px)_minmax(0,1fr)]",children:[a.jsx(gt.div,{...T0,children:a.jsxs(Le,{className:"sticky top-20 rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Filters & user form"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Filter list and add/update staff users."})]})})}),a.jsxs(ze,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium text-slate-600",children:[a.jsx(Ai,{className:"h-3 w-3"}),a.jsx("span",{children:"View"})]}),a.jsxs("div",{className:"inline-flex gap-1 rounded-full border border-slate-200 bg-slate-100 p-1 text-[11px]",children:[a.jsx("button",{type:"button",onClick:()=>D("all"),className:`rounded-full px-3 py-1 ${I==="all"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:"All users"}),a.jsxs("button",{type:"button",onClick:()=>D("doctors"),className:`inline-flex items-center gap-1 rounded-full px-3 py-1 ${I==="doctors"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:[a.jsx(un,{className:"h-3 w-3"}),"Doctors"]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-600",children:"Search"}),a.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-2 py-1.5",children:[a.jsx(_p,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx(_e,{placeholder:"Name or email",value:O,onChange:ee=>R(ee.target.value),className:"h-7 border-0 bg-transparent px-0 text-xs focus-visible:ring-0"})]})]})]}),a.jsxs("div",{className:"space-y-3 border-t border-slate-100 pt-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-700",children:[a.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:a.jsx(dse,{className:"h-3.5 w-3.5"})}),a.jsx("span",{children:b?"Edit user":"Create new user"})]}),a.jsxs("form",{onSubmit:K,className:"space-y-3",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(_e,{placeholder:"Full name",value:m.name,onChange:ee=>x({...m,name:ee.target.value}),required:!0,disabled:!P,className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(_e,{placeholder:"Email",type:"email",value:m.email,onChange:ee=>x({...m,email:ee.target.value}),required:!0,disabled:!P,className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsx(_e,{placeholder:b?"Password (leave blank to keep)":"Password",type:"password",value:m.password,onChange:ee=>x({...m,password:ee.target.value}),required:!b,disabled:!P,className:"h-8 rounded-2xl border-slate-200 bg-slate-50 text-xs"}),a.jsxs("div",{className:"space-y-1 text-[11px]",children:[a.jsx("label",{className:"font-medium text-slate-600",children:"Department"}),a.jsxs("select",{value:m.department_id,onChange:ee=>x({...m,department_id:ee.target.value}),disabled:!P,className:"h-8 w-full rounded-2xl border border-slate-200 bg-slate-50 px-2 text-xs text-slate-800 focus:outline-none focus:ring-1 focus:ring-slate-300",children:[a.jsx("option",{value:"",children:"No department"}),u.map(ee=>a.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[a.jsxs("label",{className:`inline-flex flex-1 min-w-[140px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 ${m.is_doctor?"border-emerald-300 bg-emerald-50":"border-slate-200 bg-white"}`,children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:m.is_doctor,onChange:ee=>x({...m,is_doctor:ee.target.checked}),disabled:!P}),a.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[a.jsx(un,{className:"h-3.5 w-3.5 text-emerald-600"}),a.jsx("span",{children:"Mark as doctor"})]})]}),a.jsxs("label",{className:`inline-flex flex-1 min-w-[140px] cursor-pointer items-center gap-2 rounded-2xl border px-3 py-2 ${m.is_active?"border-slate-300 bg-slate-50":"border-slate-200 bg-white"}`,children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300",checked:m.is_active,onChange:ee=>x({...m,is_active:ee.target.checked}),disabled:!P}),a.jsxs("span",{className:"inline-flex items-center gap-1 text-slate-700",children:[a.jsx(Ji,{className:"h-3.5 w-3.5 text-slate-700"}),a.jsx("span",{children:"Active user"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[a.jsx("span",{className:"font-medium text-slate-700",children:"Roles"}),a.jsxs("span",{className:"text-slate-400",children:[m.role_ids.length||0," selected"]})]}),a.jsxs("div",{className:"grid gap-1.5 sm:grid-cols-2",children:[c.map(ee=>a.jsxs("label",{className:`flex cursor-pointer items-center gap-2 rounded-2xl border px-2.5 py-2 ${m.role_ids.includes(ee.id)?"border-slate-300 bg-slate-50":"border-slate-200 bg-white"}`,children:[a.jsx("input",{type:"checkbox",checked:m.role_ids.includes(ee.id),onChange:()=>B(ee.id),disabled:!P,className:"h-3.5 w-3.5 rounded border-slate-300"}),a.jsx("span",{className:"text-[11px] text-slate-800",children:ee.name})]},ee.id)),!c.length&&a.jsx("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"No roles configured yet."})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-1",children:[b&&a.jsx("button",{type:"button",onClick:V,className:"text-[11px] text-slate-500 underline",children:"Cancel edit & clear form"}),a.jsx(Pe,{type:"submit",className:"ml-auto rounded-2xl bg-slate-900 px-4 py-1.5 text-xs font-medium text-white hover:bg-slate-800",disabled:j||!P,children:j?"Saving...":b?"Update user":"Create user"})]})]})]})]})]})}),a.jsx(gt.div,{...T0,children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-3",children:a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"User directory"}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:[J.length," of ",l.length," records visible in this view."]})]})})}),a.jsx(ze,{className:"space-y-4 pt-4",children:C?a.jsx(qoe,{}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid gap-3 md:hidden",children:[J.map((ee,ye)=>{const ie=c.filter(he=>(ee.role_ids||[]).includes(he.id)).map(he=>he.name);return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsx("div",{className:"flex items-start justify-between gap-3",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:[ye+1,". ",ee.name]}),ee.is_doctor&&a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700",children:[a.jsx(un,{className:"h-3 w-3"}),"Doctor"]}),!ee.is_active&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600",children:"Inactive"}),ee.is_admin&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] text-white",children:"Admin"})]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:ee.email}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Dept:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:$[ee.department_id]||"-"})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Roles:"," ",ie.length?ie.join(", "):"No roles"]})]})}),a.jsxs("div",{className:"mt-3 flex justify-end gap-2 text-[11px]",children:[r&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>H(ee),children:"Edit"}),i&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>z(ee.id),children:"Delete"})]})]},ee.id)}),!J.length&&a.jsx(MI,{title:"No users match this view"})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border border-slate-200 bg-white md:block",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-medium text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 text-left",children:"#"}),a.jsx("th",{className:"p-2 text-left",children:"Name"}),a.jsx("th",{className:"p-2 text-left",children:"Email"}),a.jsx("th",{className:"p-2 text-left",children:"Dept"}),a.jsx("th",{className:"p-2 text-left",children:"Roles"}),a.jsx("th",{className:"p-2 text-left",children:"Flags"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[J.map((ee,ye)=>{const ie=c.filter(he=>(ee.role_ids||[]).includes(he.id)).map(he=>he.name);return a.jsxs("tr",{className:"border-t border-slate-100 text-xs text-slate-800",children:[a.jsx("td",{className:"p-2",children:ye+1}),a.jsx("td",{className:"p-2",children:ee.name}),a.jsx("td",{className:"p-2",children:ee.email}),a.jsx("td",{className:"p-2",children:$[ee.department_id]||"-"}),a.jsx("td",{className:"p-2",children:ie.length?ie.join(", "):a.jsx("span",{className:"text-slate-400",children:"No roles"})}),a.jsx("td",{className:"p-2",children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[ee.is_doctor&&a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] text-emerald-700",children:[a.jsx(un,{className:"h-3 w-3"}),"Doctor"]}),!ee.is_active&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600",children:"Inactive"}),ee.is_admin&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] text-white",children:"Admin"})]})}),a.jsx("td",{className:"p-2 text-right",children:a.jsxs("div",{className:"inline-flex gap-2",children:[r&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border-slate-200 px-3 text-[11px]",onClick:()=>H(ee),children:"Edit"}),i&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 rounded-2xl border border-rose-200 px-3 text-[11px] text-rose-700 hover:bg-rose-50",onClick:()=>z(ee.id),children:"Delete"})]})})]},ee.id)}),!J.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4",children:a.jsx(MI,{title:"No users match this view"})})})]})]})})]})})]})})]})]})})}function kN({label:t,value:n,icon:s,hint:r}){return a.jsxs(gt.div,{whileHover:{y:-2,scale:1.01},className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-600",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:t}),s&&a.jsx("span",{children:s})]}),a.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:n}),r&&a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-400",children:r})]})}function MI({title:t}){return a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-4 py-5 text-center",children:[a.jsx("p",{className:"text-sm font-medium text-slate-700",children:t}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Try changing filters, clearing the search, or creating a new user."})]})}function qoe(){return a.jsx("div",{className:"space-y-2",children:[0,1,2].map(t=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Ze,{className:"h-3 w-1/3 rounded-full bg-slate-100"}),a.jsx(Ze,{className:"h-2.5 w-1/2 rounded-full bg-slate-100"})]}),a.jsx(Ze,{className:"h-6 w-20 rounded-full bg-slate-100"})]},t))})}const Goe=(()=>{try{return JSON.parse(localStorage.getItem("sidebarCollapsed")||"false")}catch{return!1}})(),QB=JL(t=>({sidebarCollapsed:Goe,sidebarMobileOpen:!1,toggleCollapse:()=>t(n=>{const s=!n.sidebarCollapsed;return localStorage.setItem("sidebarCollapsed",JSON.stringify(s)),{sidebarCollapsed:s}}),openMobile:()=>t({sidebarMobileOpen:!0}),closeMobile:()=>t({sidebarMobileOpen:!1}),toggleMobile:()=>t(n=>({sidebarMobileOpen:!n.sidebarMobileOpen}))}));function Koe(){return ne.get("/settings/ui-branding/public")}function Yoe(){return ne.get("/settings/ui-branding")}function Xoe(t){return ne.put("/settings/ui-branding",t)}function Qoe(t){return ne.post("/settings/ui-branding/assets",t,{headers:{"Content-Type":"multipart/form-data"}})}function Zoe(t){return ne.post("/settings/ui-branding/letterhead",t,{headers:{"Content-Type":"multipart/form-data"}})}const ZB=y.createContext({branding:null,setBranding:()=>{},loading:!0}),Joe="http://localhost:8000/api",ece=Joe.replace(/\/api\/?$/,"");function yl(t){if(!t)return;const n=String(t).trim();if(!n)return;if(/^https?:\/\//i.test(n))return n;if(n.startsWith("//"))return`${window.location.protocol}${n}`;const s=n.startsWith("/")?n:`/${n}`;return`${ece}${s}`}function EN(t){if(!t)return null;const n={...t};return n.primary_color=n.primary_color||"#2563eb",n.primary_color_dark=n.primary_color_dark||null,n.sidebar_bg_color=n.sidebar_bg_color||"#ffffff",n.content_bg_color=n.content_bg_color||"#f9fafb",n.card_bg_color=n.card_bg_color||"#ffffff",n.border_color=n.border_color||"#e5e7eb",n.text_color=n.text_color||"#111827",n.text_muted_color=n.text_muted_color||"#e5e7eb",n.icon_color=n.icon_color||n.text_color||"#2563eb",n.icon_bg_color=n.icon_bg_color||"rgba(37,99,235,0.08)",n.logo_path&&!n.logo_url?n.logo_url=yl(`/media/${String(n.logo_path).replace(/^\/+/,"")}`):n.logo_url&&(n.logo_url=yl(n.logo_url)),n.login_logo_path&&!n.login_logo_url?n.login_logo_url=yl(`/media/${String(n.login_logo_path).replace(/^\/+/,"")}`):n.login_logo_url&&(n.login_logo_url=yl(n.login_logo_url)),n.favicon_path&&!n.favicon_url?n.favicon_url=yl(`/media/${String(n.favicon_path).replace(/^\/+/,"")}`):n.favicon_url&&(n.favicon_url=yl(n.favicon_url)),n.pdf_header_path&&!n.pdf_header_url?n.pdf_header_url=yl(`/media/${String(n.pdf_header_path).replace(/^\/+/,"")}`):n.pdf_header_url&&(n.pdf_header_url=yl(n.pdf_header_url)),n.pdf_footer_path&&!n.pdf_footer_url?n.pdf_footer_url=yl(`/media/${String(n.pdf_footer_path).replace(/^\/+/,"")}`):n.pdf_footer_url&&(n.pdf_footer_url=yl(n.pdf_footer_url)),n}function tce({children:t}){const[n,s]=y.useState(null),[r,i]=y.useState(!0),l=o=>{s(typeof o=="function"?c=>EN(o(c)):EN(o))};return y.useEffect(()=>{let o=!0;return(async()=>{try{let d;try{d=(await Koe()).data}catch(h){console.warn("Public branding failed, falling back to /settings/ui-branding",h),d=(await Yoe()).data}if(!o)return;console.log("[BrandingProvider] raw branding from API:",d);const u=EN(d);console.log("[BrandingProvider] normalized branding:",u),s(u)}catch(d){console.error("Failed to load branding",d),xe.error("Failed to load customization settings")}finally{o&&i(!1)}})(),()=>{o=!1}},[]),a.jsx(ZB.Provider,{value:{branding:n,setBranding:l,loading:r},children:t})}function kh(){return y.useContext(ZB)}const nce="#2563eb",sce=t=>!t.startsWith("#")||t.length!==7?"#eff6ff":`${t}1A`,rce=t=>!t.startsWith("#")||t.length!==7?"#bfdbfe":`${t}33`,ace=[{key:"Dashboard",label:"Dashboard",icon:v0,flatLink:{to:"/dashboard",reqAny:["patients.view"]}},{key:"patients",label:"Patients management",icon:Ap,flatLink:{to:"/patients",reqAny:["patients.view","patients.create","patients.update"]}},{key:"patients masters",label:"Patients masters",icon:_r,flatLink:{to:"/patients/masters",reqAny:["patients.masters.view"]}},{key:"MIS",label:"MIS & Analytics",icon:mte,flatLink:{to:"/mis",reqAny:["mis.view"]}},{key:"emr",label:"Patients EMR",icon:Rc,flatLink:{to:"/emr",reqAny:["emr.view"]}},{key:"pharmacy",label:"Pharmacy",icon:Ur,items:[{key:"pharmacy-inventory",label:"Inventory & Stock",to:"/pharmacy/inventory",icon:ste,reqAny:["pharmacy.inventory.stock.view","pharmacy.inventory.items.view","pharmacy.inventory.po.view"]},{key:"pharmacy-barcode",label:"Barcode / QR Lookup",to:"/inventory/barcode-lookup",icon:Pg,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy RX",label:"Pharmacy RX",to:"/pharmacy/rx",icon:o4,reqAny:["pharmacy.inventory.stock.view"]},{key:"pharmacy dispense",label:"Pharmacy Dispense",to:"/pharmacy/dispense",icon:I1,reqAny:["pharmacy.inventory.stock.view"]}]},{key:"user-mgmt",label:"User Management",icon:Ji,items:[{key:"departments",label:"Departments",to:"/admin/departments",icon:Ya,reqAny:["departments.view","departments.create","departments.update","departments.delete"]},{key:"roles",label:"Roles",to:"/admin/roles",icon:Ji,reqAny:["roles.view","roles.create","roles.update","roles.delete"]},{key:"users",label:"Users",to:"/admin/users",icon:Ap,reqAny:["users.view","users.create","users.update","users.delete"]}]},{key:"op",label:"OP",icon:un,items:[{key:"op-dashboard",label:"Dashboard",to:"/opd/dashboard",icon:v0,reqAny:["appointments.view","mis.opd.view"]},{key:"appointments",label:"Appointments",to:"/opd/appointments",icon:a4,reqAny:["appointments.view","appointments.create"]},{key:"triage",label:"Vitals (Triage)",to:"/opd/triage",icon:or,reqAny:["vitals.create"]},{key:"queue",label:"Queue",to:"/opd/queue",icon:dne,reqAny:["appointments.view","visits.view"]},{key:"followups",label:"Follow-ups (Waiting)",to:"/opd/followups",icon:Ys,reqAny:["appointments.view","appointments.update"]},{key:"no-shows",label:"No-show Reschedule",to:"/opd/no-shows",icon:Zte,reqAny:["appointments.view","appointments.update"]},{key:"Doctor Fees",label:"Doctor Fees",to:"/opd/doctor-fees",icon:aS,reqAny:["appointments.view","appointments.update"]}]},{key:"ip",label:"IP",icon:Ps,items:[{key:"ipd-admissions",label:"Admissions",to:"/ipd/admissions",icon:Vte,reqAny:["ipd.view","ipd.manage"]},{key:"ipd-tracking",label:"Tracking",to:"/ipd/tracking",icon:v0,reqAny:["ipd.tracking.view"]},{key:"ipd-my",label:"My Admissions",to:"/ipd/my",icon:o4,reqAny:["ipd.my.view","ipd.doctor"]},{key:"ipd-discharged",label:"Discharged",to:"/ipd/discharged",icon:r7,reqAny:["ipd.discharged.view"]},{key:"ipd-bedboard",label:"Bedboard",to:"/ipd/bedboard",icon:Ps,reqAny:["ipd.bedboard.view"]},{key:"ipd-masters",label:"IPD Masters",to:"/ipd/masters",icon:io,reqAny:["ipd.masters.manage","ipd.packages.manage"]}]},{key:"lab",label:"Laboratory",icon:Lc,items:[{key:"lab-orders",label:"Orders & Reporting",to:"/lab/orders",icon:Lc,reqAny:["lab.orders.view","lab.orders.create","orders.lab.view","orders.lab.create"]},{key:"lab-masters",label:"Lab Masters (NABL)",to:"/lab/masters",icon:io,reqAny:["lab.masters.manage"]},{key:"LAB_SERVICE MASTER",label:"LAB_SERVICE MASTER",to:"/lab/service/masters",icon:io,reqAny:["lab.masters.manage"]}]},{key:"ris",label:"Radiology",icon:Pg,items:[{key:"ris-orders",label:"Orders & Reporting",to:"/ris/orders",icon:Pg,reqAny:["radiology.orders.view","radiology.orders.create","orders.ris.view","orders.ris.create","radiology.report.create","radiology.report.approve","radiology.schedule.manage","radiology.scan.update"]},{key:"ris-masters",label:"RIS Masters",to:"/ris/masters",icon:io,reqAny:["radiology.masters.manage"]}]},{key:"ot",label:"Operation Theatre",icon:i7,items:[{key:"ot-masters",label:"OT Masters",to:"/ot/masters",icon:Une,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-schedule",label:"OT Schedule",to:"/ot/schedule",icon:Gs,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]},{key:"ot-logs",label:"OT Logs / Register",to:"/ot/logs",icon:_r,reqAny:["ot.cases.view","ot.cases.create","ipd.view"]}]},{key:"billing",label:"Billing",icon:aS,items:[{key:"billing-console",label:"Billing Console",to:"/billing",icon:v0,reqAny:["billing.invoices.view","billing.invoices.create"]}]},{key:"settings",label:"Settings",icon:Hne,items:[{key:"schedules",label:"Schedules",to:"/opd/schedules",icon:a4,reqAny:["schedules.manage"]},{key:"ui-branding",label:"Customization & Templates",to:"/settings/branding",icon:one,reqAny:["settings.customization.view","settings.customization.manage"]},{key:"perm-logs",label:"Permissions (Access Logs)",to:"/admin/permissions",icon:io,reqAny:["permissions.view","permissions.create","permissions.update","permissions.delete"]}]}];function ice(){const t=kr($=>$.user),n=kr($=>$.modules)||{},s=sl(),{sidebarCollapsed:r,toggleCollapse:i,sidebarMobileOpen:l,closeMobile:o}=QB(),{branding:c}=kh()||{},d=(c==null?void 0:c.primary_color)||nce,u=(c==null?void 0:c.sidebar_bg_color)||"#ffffff",h=(c==null?void 0:c.text_color)||"#111827",m=(c==null?void 0:c.icon_color)||h,x=(c==null?void 0:c.icon_bg_color)||"rgba(37,99,235,0.08)",b=sce(d),w=rce(d),j=((c==null?void 0:c.org_name)||"").trim()||"NABH HIMS",S=((c==null?void 0:c.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard",C=y.useMemo(()=>{var V;const $=(V=c==null?void 0:c.org_name)==null?void 0:V.trim();if(!$)return"NH";const B=$.split(/\s+/).filter(Boolean);return B.length?B.length===1?B[0].slice(0,2).toUpperCase():(B[0][0]+B[1][0]).toUpperCase():"NH"},[c==null?void 0:c.org_name]);y.useEffect(()=>{if(!l)return;const $=window.scrollY,B={position:document.body.style.position,top:document.body.style.top,width:document.body.style.width,overflow:document.body.style.overflow,ob:document.documentElement.style.overscrollBehavior};return document.body.style.position="fixed",document.body.style.top=`-${$}px`,document.body.style.width="100%",document.body.style.overflow="hidden",document.documentElement.style.overscrollBehavior="none",()=>{document.body.style.position=B.position||"",document.body.style.top=B.top||"",document.body.style.width=B.width||"",document.body.style.overflow=B.overflow||"",document.documentElement.style.overscrollBehavior=B.ob||"",window.scrollTo(0,$)}},[l]);const A=!!(t!=null&&t.is_admin),k=y.useMemo(()=>{const $=Object.values(n).flat().map(V=>typeof V=="string"?V:V==null?void 0:V.code).filter(Boolean),B=((t==null?void 0:t.permissions)||[]).map(V=>typeof V=="string"?V:V==null?void 0:V.code).filter(Boolean);return new Set([...$||[],...B||[]])},[n,t]),T=($=[])=>A?!0:$.some(B=>k.has(B)),I=y.useMemo(()=>ace.map($=>{if($.flatLink){const K=T($.flatLink.reqAny);return{...$,_visible:K}}const B=($.items||[]).map(K=>({...K,_visible:T(K.reqAny)})),V=B.some(K=>K._visible);return{...$,items:B,_visible:V}}).filter($=>$._visible),[k,A]),D=$=>$.flatLink?s.pathname.startsWith($.flatLink.to):($.items||[]).some(B=>s.pathname.startsWith(B.to)),[O,R]=y.useState({});y.useEffect(()=>{const $={};I.forEach(B=>{$[B.key]=D(B)}),R(B=>({...B,...$}))},[s.pathname]);const P=$=>R(B=>({...B,[$]:!B[$]})),L=r?"md:w-16":"md:w-64";return a.jsxs(a.Fragment,{children:[a.jsx("div",{onClick:o,className:`fixed inset-0 z-40 bg-black/35 backdrop-blur-sm transition-opacity md:hidden ${l?"opacity-100":"pointer-events-none opacity-0"}`}),a.jsxs("aside",{className:["z-50 border-r transition-all duration-300 ease-out","fixed left-0 top-0 h-[100dvh] w-[86vw] max-w-sm md:w-auto",l?"translate-x-0":"-translate-x-full","md:static md:translate-x-0 md:sticky md:top-0 md:h-[100dvh]",L,"grid grid-rows-[auto,1fr,auto] min-h-0","overflow-x-hidden overflow-y-hidden"].join(" "),style:{backgroundColor:u,color:h},children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c!=null&&c.logo_url?a.jsx("img",{src:c.logo_url,alt:"Logo",className:"h-8 w-auto rounded-md border border-slate-200 bg-white"}):a.jsx("div",{className:"grid h-8 w-8 place-items-center rounded-xl ring-1",style:{backgroundColor:x,borderColor:w},children:a.jsx("span",{className:"text-xs font-bold",style:{color:m},children:C})}),!r&&a.jsxs("div",{className:"truncate",children:[a.jsx("div",{className:"text-xs font-semibold tracking-tight leading-snug",children:j}),a.jsx("div",{className:"text-[10px] leading-tight",children:S})]})]}),a.jsx("button",{onClick:o,className:"md:hidden inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":"Close sidebar",children:a.jsx(Os,{className:"h-5 w-5",style:{color:m}})}),a.jsx("button",{onClick:i,className:"hidden md:inline-flex h-8 w-8 items-center justify-center rounded-xl hover:bg-gray-50 active:scale-95 transition","aria-label":r?"Expand sidebar":"Collapse sidebar",title:r?"Expand":"Collapse",children:r?a.jsx(Nh,{className:"h-5 w-5",style:{color:m}}):a.jsx(yx,{className:"h-5 w-5",style:{color:m}})})]}),a.jsxs("nav",{className:"min-h-0 flex-1 overflow-y-auto no-scrollbar y-fade px-2 pb-4 pt-1 space-y-1 overscroll-contain touch-pan-y",children:[I.map($=>{if($.flatLink){const z=$.icon||io;return a.jsxs(DT,{to:$.flatLink.to,onClick:o,className:({isActive:H})=>["group relative flex h-10 items-center gap-3 rounded-xl px-3 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",r?"justify-center":""].join(" "),style:({isActive:H})=>H?{color:"#ffffff",backgroundColor:d,boxShadow:`0 0 0 1px ${w}`}:{color:h},title:r?$.label:void 0,children:[a.jsx(z,{className:"h-5 w-5 shrink-0",style:{color:D($)?"#ffffff":m}}),!r&&a.jsx("span",{className:"transition-all duration-300",children:$.label})]},$.key)}const B=$.icon||io,V=!!O[$.key]&&!r,K=D($);return a.jsxs("div",{className:"rounded-xl",children:[a.jsxs("button",{type:"button",onClick:()=>r?null:P($.key),className:["w-full flex items-center gap-3 rounded-xl px-3 h-10 text-sm transition-colors duration-200 ease-out",r?"justify-center":"justify-between"].join(" "),title:r?$.label:void 0,style:{color:K?d:h,backgroundColor:K?b:"transparent",boxShadow:K?`0 0 0 1px ${w}`:void 0},children:[a.jsxs("span",{className:"flex items-center gap-3",children:[a.jsx(B,{className:"h-5 w-5 shrink-0",style:{color:m}}),!r&&a.jsx("span",{className:"font-medium",children:$.label})]}),!r&&a.jsx(u3,{className:"h-4 w-4 transition-transform",style:{color:m}})]}),V&&a.jsx("div",{className:"mt-1 space-y-1 pl-9",children:$.items.filter(z=>z._visible).map(z=>{const H=z.icon||io;return a.jsxs(DT,{to:z.to,onClick:o,className:()=>"group relative flex h-9 items-center gap-2 rounded-lg px-2 text-sm leading-none transition-colors duration-200 ease-out active:scale-[0.99]",style:({isActive:Y})=>Y?{color:d,backgroundColor:b,boxShadow:`0 0 0 1px ${w}`}:{color:h},children:[a.jsx(H,{className:"h-[18px] w-[18px] shrink-0",style:{color:m}}),a.jsx("span",{children:z.label})]},z.key)})})]},$.key)}),I.length===0&&a.jsx("div",{className:"px-3 py-2 text-xs text-gray-500",children:"No modules granted. Contact administrator."})]}),a.jsx("div",{className:"px-3 pb-3",children:r?a.jsx("div",{className:"grid place-items-center text-[10px] text-gray-400",children:"v1.0"}):a.jsx("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 text-[11px] text-gray-500",children:"Tip: Click the chevron to collapse the sidebar."})})]})]})}function lce(){const{user:t,logout:n,fetchProfile:s}=kr(),{toggleMobile:r}=QB(),{branding:i}=kh()||{},[l,o]=y.useState(new Date),[c,d]=y.useState(typeof navigator<"u"?navigator.onLine:!0),[u,h]=y.useState(!1),[m,x]=y.useState(!1),[b,w]=y.useState(!1),j=(i==null?void 0:i.primary_color)||"#0f172a",C=(i==null?void 0:i.primary_color_dark)||null||j,A=(i==null?void 0:i.text_muted_color)||"#e5e7eb",k=(i==null?void 0:i.icon_color)||A,T=((i==null?void 0:i.org_name)||"").trim()||"NUTRYAH",I=((i==null?void 0:i.org_tagline)||"").trim()||"Smart  Secure  NABH-Standard";y.useEffect(()=>{const B=setInterval(()=>o(new Date),1e3);return()=>clearInterval(B)},[]),y.useEffect(()=>{const B=()=>d(navigator.onLine);return window.addEventListener("online",B),window.addEventListener("offline",B),()=>{window.removeEventListener("online",B),window.removeEventListener("offline",B)}},[]);const D=y.useMemo(()=>t?t.is_admin?"Admin":Array.isArray(t.roles)&&t.roles.length?t.roles[0]:"User":"",[t]),O=y.useMemo(()=>{try{return l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return l.toTimeString().slice(0,8)}},[l]),R=()=>{x(!0),setTimeout(()=>window.location.reload(),120)},P=async()=>{w(!0);try{await s()}finally{setTimeout(()=>w(!1),500)}},L=a.jsx("svg",{viewBox:"0 0 24 24",className:"h-9 w-9","aria-hidden":"true",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6.75a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.25a8.25 8.25 0 1 1 15 0v.75H4.5v-.75Z"})}),$=({ok:B})=>a.jsx("span",{title:B?"Online":"Offline",className:`inline-block h-2.5 w-2.5 rounded-full ${B?"bg-emerald-500":"bg-rose-500"} ring-2 ring-white`});return a.jsx("header",{className:"sticky top-0 z-30",style:{backgroundColor:C,color:A},children:a.jsxs("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-3 px-4 py-2 sm:px-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"md:hidden inline-flex items-center justify-center rounded-xl p-2 ring-1 ring-white/20 hover:bg-white/10 active:scale-95 transition",onClick:r,"aria-label":"Open menu",children:a.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 7h16M4 12h16M4 17h16"})})}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-lg font-semibold tracking-tight sm:text-xl",style:{color:A},children:T}),a.jsx("span",{className:"hidden text-[11px] sm:inline-block",style:{color:A},children:I})]})]}),a.jsxs("div",{className:"hidden items-center gap-3 sm:flex",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm",children:[a.jsx($,{ok:c}),a.jsx("span",{className:"tabular-nums",style:{color:A},children:O})]}),a.jsxs("button",{onClick:P,className:`group inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition ${b?"animate-pulse":"hover:bg-white/15"}`,title:"Sync data",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${b?"animate-spin":"group-hover:rotate-90"} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 8V4m0 0h4m-4 0l2 2M8 16v4m0 0H4m4 0-2-2M6 8a6 6 0 1 1 12 0 6 6 0 0 1-12 0Z"})}),a.jsx("span",{style:{color:A},children:"Sync"})]}),a.jsxs("button",{onClick:R,className:"inline-flex items-center gap-2 rounded-xl border border-white/15 bg-white/10 px-3 py-1.5 text-sm transition hover:bg-white/15 active:scale-95",title:"Refresh page",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${m?"animate-spin":""} transition`,stroke:"currentColor",strokeWidth:"1.5",fill:"none",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),a.jsx("span",{style:{color:A},children:"Refresh"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>h(B=>!B),className:"group inline-flex items-center gap-3 rounded-2xl border border-white/15 bg-white/10 px-2.5 py-1.5 transition hover:bg-white/15","aria-haspopup":"menu","aria-expanded":u,title:"Account",children:[a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute -right-0.5 -top-0.5 rounded-full bg-emerald-500 p-1 ring-2 ring-[rgba(0,0,0,0.2)]"}),L]}),a.jsx("div",{className:"hidden min-w-[9rem] text-left sm:block",children:a.jsxs("div",{className:"leading-tight",children:[a.jsx("div",{className:"truncate text-sm font-medium",style:{color:A},children:(t==null?void 0:t.name)||""}),a.jsx("div",{className:"truncate text-[11px]",style:{color:A},children:D})]})}),a.jsx("svg",{viewBox:"0 0 24 24",className:`hidden h-4 w-4 sm:block transition ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 9l6 6 6-6"})})]}),a.jsxs("div",{className:`absolute right-0 mt-2 w-64 origin-top-right rounded-2xl border border-gray-200 bg-gray-900 p-3 shadow-lg transition ${u?"scale-100 opacity-100":"pointer-events-none scale-95 opacity-0"}`,children:[a.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[a.jsx("div",{className:"shrink-0",children:L}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"truncate text-sm font-semibold text-gray-100",children:(t==null?void 0:t.name)||""}),a.jsx("div",{className:"truncate text-xs text-gray-300",children:D}),a.jsx("div",{className:"truncate text-[11px] text-gray-300",children:t==null?void 0:t.email})]})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsxs("button",{onClick:P,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${b?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 1 13.5-4.5M19.5 12A7.5 7.5 0 0 1 6 16.5M3 12h3m12 0h3"})}),a.jsx("span",{children:"Sync data"})]}),a.jsxs("button",{onClick:R,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm hover:bg-gray-50 hover:text-black/90",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:`h-5 w-5 ${m?"animate-spin":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992V4.356M21 12a9 9 0 1 1-3-6.708"})}),a.jsx("span",{children:"Refresh page"})]}),a.jsx("div",{className:"my-1 h-px bg-gray-100"}),a.jsxs("button",{onClick:n,className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",children:[a.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:"1.5",style:{color:k},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 8l-4 4m0 0 4 4m-4-4h12"})}),a.jsx("span",{children:"Logout"})]})]})]})]})]})})}const oce="#2563eb";function cce(){const{branding:t}=kh()||{},n=(t==null?void 0:t.primary_color)||oce,s=(t==null?void 0:t.sidebar_bg_color)||"#f9fafb",r=(t==null?void 0:t.text_color)||"#4b5563";return a.jsx("footer",{className:"w-full border-t text-xs sm:text-[13px]",style:{borderTopColor:n,background:s,color:r},children:a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-2 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"font-medium",children:["Powered by"," ",a.jsx("span",{className:"font-semibold",style:{color:n},children:"NUTRYAH DIGITAL HEALTH"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[a.jsx("span",{className:"font-medium",children:"Support:"}),a.jsx("a",{href:"tel:+918870787448",className:"hover:underline",style:{color:n},children:"Mobile: +91 88707 87448"}),a.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),a.jsx("a",{href:"mailto:support@nutryah.com",className:"hover:underline",style:{color:n},children:"Email: support@nutryah.com"}),a.jsx("span",{className:"hidden text-slate-300 md:inline",children:""}),a.jsx("a",{href:"https://www.nutryah.com",target:"_blank",rel:"noreferrer",className:"hover:underline",style:{color:n},children:"Website: www.nutryah.com"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[a.jsx("a",{href:"/privacy-policy",className:"hover:underline",style:{color:n},children:"Privacy Policy"}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsx("a",{href:"/terms-and-conditions",className:"hover:underline",style:{color:n},children:"Terms & Conditions"})]})]})})}function dce(){const{branding:t}=kh()||{},n=!!(t!=null&&t.content_bg_color),s=n?"min-h-dvh":"min-h-dvh bg-gradient-to-b from-gray-50 to-white",r=n?{backgroundColor:t.content_bg_color,color:t.text_color||void 0}:void 0;return a.jsxs("div",{className:s,style:r,children:[a.jsxs("div",{className:"flex min-h-dvh",children:[a.jsx(ice,{}),a.jsxs("div",{className:"flex min-h-dvh flex-1 flex-col",children:[a.jsx(lce,{}),a.jsx("main",{className:"flex-1",children:a.jsx("div",{className:"mx-auto w-full max-w-7xl px-4 py-4 sm:px-6 lg:px-8",children:a.jsx(vL,{})})})]})]}),a.jsx(cce,{})]})}function uce(){const{user:t,loading:n,fetchProfile:s}=kr(),[r,i]=y.useState(!1),l=localStorage.getItem("access_token"),o=sl();return y.useEffect(()=>{l&&!t&&!n&&(i(!0),s().finally(()=>i(!1)))},[l,t,n,s]),l?r||n||!t&&l?a.jsx("div",{className:"min-h-screen grid place-items-center text-sm",children:"Loading"}):a.jsx(vL,{}):a.jsx(bL,{to:"/auth/login",state:{from:o},replace:!0})}function ta({anyOf:t=[],fallback:n=null,children:s}){const r=kr(d=>d.user),i=kr(d=>d.modules)||{};if(!!(r!=null&&r.is_admin))return s;const o=new Set(Object.values(i).flat().map(d=>typeof d=="string"?d:d==null?void 0:d.code).filter(Boolean));return t.length===0||t.some(d=>o.has(d))?s:n}const jx=(t={})=>{const n={};return Object.entries(t).forEach(([s,r])=>{r!=null&&r!==""&&(n[s]=r)}),n},Db=()=>ne.get("/ipd/wards"),fce=t=>ne.post("/ipd/wards",t),hce=t=>ne.delete(`/ipd/wards/${t}`),Sx=(t={})=>ne.get("/ipd/rooms",{params:jx(t)}),mce=t=>ne.post("/ipd/rooms",t),pce=t=>ne.delete(`/ipd/rooms/${t}`),el=(t={})=>ne.get("/ipd/beds",{params:jx(t)}),xce=t=>ne.post("/ipd/beds",t),gce=t=>ne.delete(`/ipd/beds/${t}`),yce=(t,n)=>ne.patch(`/ipd/beds/${t}/state`,null,{params:jx(n)}),K3=()=>ne.get("/ipd/packages"),bce=t=>ne.post("/ipd/packages",t),vce=t=>ne.delete(`/ipd/packages/${t}`),wce=(t={})=>ne.get("/ipd/bed-rates",{params:jx(t)}),Nce=t=>ne.post("/ipd/bed-rates",t),jce=t=>ne.delete(`/ipd/bed-rates/${t}`),_x=(t={})=>ne.get("/ipd/admissions",{params:jx(t)}),JB=t=>ne.post("/ipd/admissions",t),Y3=t=>ne.get(`/patients/${t}`),L1=["General Ward","Semi-Private","Private","Deluxe","Suite","ICU","HDU","PICU","NICU","Isolation Room","Day Care","Observation","Emergency / ER"];function Sce(){return a.jsx(ta,{anyOf:["ipd.masters.manage","ipd.packages.manage"],children:a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6 space-y-6",children:[a.jsxs("div",{className:"mx-auto max-w-6xl space-y-1",children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"IPD Masters"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Configure wards, rooms, beds and their tariffs. This setup drives the Admission, Bedboard, Billing and Bed Occupancy workflows for your hospital."})]}),a.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[a.jsx(_ce,{}),a.jsx(Ace,{}),a.jsx(Ece,{})]})]})})}function _ce(){const[t,n]=y.useState([]),[s,r]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),h=async()=>{var b,w;c(!0),u("");try{const[j,S,C]=await Promise.all([Db(),Sx(),el()]);n(j.data||[]),r(S.data||[]),l(C.data||[])}catch(j){u(((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to load ward/room/bed data.")}finally{c(!1)}};y.useEffect(()=>{h()},[]);const m=y.useMemo(()=>Array.from(new Set((s||[]).map(b=>b.type).filter(Boolean).map(b=>b.trim()))),[s]),x=y.useMemo(()=>Array.from(new Set([...L1,...m])),[m]);return a.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-5",children:[a.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ya,{className:"h-5 w-5 text-slate-500"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Ward  Room  Bed"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Define the physical structure of the IPD: wards, room types and individual beds. Room type drives bed tariffs and reporting."})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-1 text-[11px]",children:[x.slice(0,6).map(b=>a.jsx(PS,{type:b},b)),x.length>6&&a.jsxs("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-slate-600",children:["+",x.length-6," more types"]})]})]}),d&&a.jsx(X3,{message:d}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(IS,{title:"New Ward",description:"Create a new ward or block (e.g. GW Block, ICU Block, Labour Ward).",fields:[{name:"code",label:"Ward code",placeholder:"e.g. GW-1",required:!0},{name:"name",label:"Ward name",placeholder:"e.g. General Ward Block 1",required:!0},{name:"floor",label:"Floor / Level",placeholder:"e.g. 1st Floor"}],onSubmit:async b=>{await fce(b),await h()}}),a.jsx(Cce,{wards:t,allRoomTypes:x,onCreated:h}),a.jsx(IS,{title:"New Bed",description:"Add individual beds to rooms. Bed codes should be easy for staff to identify (e.g. GW-101-A).",fields:[{name:"room_id",label:"Room",type:"select",required:!0,options:s.map(b=>({value:b.id,label:`Ward ${b.ward_id}  Room ${b.number} (${b.type||"Unspecified"})`})),placeholder:"Select room"},{name:"code",label:"Bed code",placeholder:"e.g. GW-101-A",required:!0}],onSubmit:async b=>{await xce(b),await h()}})]}),a.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[a.jsx(Jm,{title:"Wards",items:t,cols:[["code","Code"],["name","Name"],["floor","Floor"]],onDelete:b=>hce(b).then(h)}),a.jsx(Jm,{title:"Rooms",items:s,cols:[["ward_id","Ward ID"],["number","Room No"],["type","Room Type"]],renderValue:(b,w)=>b==="type"?a.jsx(PS,{type:w}):String(w??""),onDelete:b=>pce(b).then(h)}),a.jsx(Jm,{title:"Beds",items:i,cols:[["room_id","Room ID"],["code","Bed code"],["state","Status"]],renderValue:(b,w)=>b==="state"?a.jsx(Tce,{state:w}):String(w??""),onDelete:b=>gce(b).then(h)})]}),o&&a.jsx(Q3,{})]})}function Cce({wards:t=[],allRoomTypes:n=[],onCreated:s}){const[r,i]=y.useState({ward_id:"",number:"",typeChoice:"",customType:""}),[l,o]=y.useState(!1),[c,d]=y.useState(""),u=(m,x)=>{i(b=>({...b,[m]:x})),c&&d("")},h=async m=>{if(m.preventDefault(),d(""),!r.ward_id||!r.number){d("Ward and Room number are required.");return}let x="";if(r.typeChoice==="__custom"){if(!r.customType.trim()){d("Please enter a custom room type.");return}x=r.customType.trim()}else r.typeChoice&&(x=r.typeChoice);o(!0);try{const b={ward_id:r.ward_id,number:r.number,type:x||void 0};await mce(b),i({ward_id:"",number:"",typeChoice:"",customType:""}),s==null||s()}finally{o(!1)}};return a.jsxs("form",{onSubmit:h,className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 grid gap-3 md:grid-cols-4 text-sm",children:[a.jsxs("div",{className:"md:col-span-4",children:[a.jsx("div",{className:"text-sm font-medium text-slate-800",children:"New Room"}),a.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Link the room to a ward and assign a room type. Custom room types can be created on the fly when needed."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Ward"}),a.jsxs("select",{className:"input rounded-xl",value:r.ward_id,onChange:m=>u("ward_id",m.target.value),required:!0,children:[a.jsx("option",{value:"",children:"Select ward"}),t.map(m=>a.jsxs("option",{value:m.id,children:[m.code,"  ",m.name]},m.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Room number"}),a.jsx("input",{className:"input rounded-xl",placeholder:"e.g. 101",value:r.number,onChange:m=>u("number",m.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-1 md:col-span-2",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Room type"}),a.jsxs("select",{className:"input rounded-xl",value:r.typeChoice,onChange:m=>u("typeChoice",m.target.value),children:[a.jsx("option",{value:"",children:"(Optional) Select room type"}),L1.map(m=>a.jsx("option",{value:m,children:m},m)),n.filter(m=>!L1.includes(m)).map(m=>a.jsxs("option",{value:m,children:[m," (existing)"]},m)),a.jsx("option",{value:"__custom",children:"Other (custom)"})]}),r.typeChoice==="__custom"&&a.jsx("input",{className:"mt-2 input rounded-xl",placeholder:"Enter custom room type (e.g. Chemotherapy Day Care)",value:r.customType,onChange:m=>u("customType",m.target.value)}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Standard types include General Ward, Semi-Private, Private, Deluxe, ICU, NICU, PICU, HDU, Isolation Room and Suite. Use custom type for special units."})]}),c&&a.jsx("div",{className:"md:col-span-4 text-xs text-rose-600",children:c}),a.jsx("div",{className:"md:col-span-4 flex justify-end",children:a.jsx("button",{type:"submit",className:"btn min-w-[120px]",disabled:l,children:l?"Saving":"Save room"})})]})}function Ace(){const[t,n]=y.useState([]),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),d=async()=>{var h,m;l(!0),c("");try{const[x,b]=await Promise.all([wce(),Sx()]);n(x.data||[]),r(b.data||[])}catch(x){c(((m=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to load bed rates.")}finally{l(!1)}};y.useEffect(()=>{d()},[]);const u=y.useMemo(()=>{const h=(s||[]).map(x=>x.type).filter(Boolean).map(x=>x.trim()),m=(t||[]).map(x=>OI(x.room_type).baseType).filter(Boolean);return Array.from(new Set([...L1,...h,...m]))},[s,t]);return a.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-5",children:[a.jsx("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ps,{className:"h-5 w-5 text-slate-500"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Bed Rates (Daily & Hourly)"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Configure bed tariffs for each room type. Support both daily and hourly tariffs for day care, observation, emergency and short-stay scenarios."})]})]})}),o&&a.jsx(X3,{message:o}),a.jsx(kce,{roomTypeOptions:u,onCreated:d}),a.jsx(Jm,{title:"Configured Bed Rates",items:t,cols:[["room_type","Room type"],["daily_rate","Tariff ()"],["effective_from","From"],["effective_to","To"],["is_active","Active"]],renderValue:(h,m,x)=>{if(h==="room_type"){const b=OI(m);return a.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[a.jsx(PS,{type:b.baseType||m}),a.jsx(Ice,{basis:b.basis})]})}return h==="is_active"?a.jsx("span",{className:"text-xs",children:m?"Yes":"No"}):String(m??"")},onDelete:h=>jce(h).then(d)}),i&&a.jsx(Q3,{})]})}function kce({roomTypeOptions:t=[],onCreated:n}){const[s,r]=y.useState({baseRoomType:"",basis:"daily",amount:"",effective_from:"",effective_to:""}),[i,l]=y.useState(!1),[o,c]=y.useState(""),d=(m,x)=>{r(b=>({...b,[m]:x})),o&&c("")},u=async m=>{if(m.preventDefault(),c(""),!s.baseRoomType){c("Please select a room type.");return}if(!s.amount||Number(s.amount)<=0){c("Tariff amount must be greater than 0.");return}if(!s.effective_from){c("Please select the effective from date.");return}const x=s.basis==="hourly"?"Hourly":"Daily",w={room_type:`${s.baseRoomType} (${x})`,daily_rate:Number(s.amount),effective_from:s.effective_from,effective_to:s.effective_to||void 0};l(!0);try{await Nce(w),r({baseRoomType:"",basis:"daily",amount:"",effective_from:"",effective_to:""}),n==null||n()}finally{l(!1)}},h=s.basis==="hourly"?"Use hourly tariff for day care, observation, ER and short stays.":"Use daily tariff for standard in-patient stays (24 hours basis).";return a.jsxs("form",{onSubmit:u,className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 grid gap-3 md:grid-cols-4 text-sm",children:[a.jsxs("div",{className:"md:col-span-4",children:[a.jsx("div",{className:"text-sm font-medium text-slate-800",children:"New Bed Rate"}),a.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Select a room type, choose whether this is a daily or hourly tariff, and enter the amount and effective dates."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Room type"}),a.jsxs("select",{className:"input rounded-xl",value:s.baseRoomType,onChange:m=>d("baseRoomType",m.target.value),children:[a.jsx("option",{value:"",children:"Select room type"}),t.map(m=>a.jsx("option",{value:m,children:m},m))]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Includes standard types like General Ward, Private, ICU, NICU, PICU, HDU, Isolation, Suite and Day Care."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Tariff basis"}),a.jsxs("div",{className:"inline-flex rounded-full border border-slate-200 bg-white p-0.5 text-xs",children:[a.jsx("button",{type:"button",onClick:()=>d("basis","daily"),className:`px-3 py-1.5 rounded-full transition ${s.basis==="daily"?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:"Daily"}),a.jsx("button",{type:"button",onClick:()=>d("basis","hourly"),className:`px-3 py-1.5 rounded-full transition ${s.basis==="hourly"?"bg-slate-900 text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:"Hourly"})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:h})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Tariff amount ()"}),a.jsx("input",{type:"number",min:"0",className:"input rounded-xl",placeholder:"e.g. 2500",value:s.amount,onChange:m=>d("amount",m.target.value)}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Base amount charged based on the selected tariff basis."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Effective from"}),a.jsx("input",{type:"date",className:"input rounded-xl",value:s.effective_from,onChange:m=>d("effective_from",m.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs text-slate-500",children:["Effective to ",a.jsx("span",{className:"text-slate-400",children:"(optional)"})]}),a.jsx("input",{type:"date",className:"input rounded-xl",value:s.effective_to,onChange:m=>d("effective_to",m.target.value)})]}),o&&a.jsx("div",{className:"md:col-span-4 text-xs text-rose-600",children:o}),a.jsx("div",{className:"md:col-span-4 flex justify-end",children:a.jsx("button",{type:"submit",className:"btn min-w-[140px]",disabled:i,children:i?"Saving":"Save bed rate"})})]})}function OI(t){if(!t)return{baseType:"",basis:"Daily"};const n=String(t);return/\(hourly\)/i.test(n)?{baseType:n.replace(/\(hourly\)/i,"").trim(),basis:"Hourly"}:/\(daily\)/i.test(n)?{baseType:n.replace(/\(daily\)/i,"").trim(),basis:"Daily"}:{baseType:n.trim(),basis:"Daily"}}function Ece(){const[t,n]=y.useState([]),[s,r]=y.useState(!1),[i,l]=y.useState(""),o=async()=>{var c,d;r(!0),l("");try{const{data:u}=await K3();n(u||[])}catch(u){l(((d=(c=u==null?void 0:u.response)==null?void 0:c.data)==null?void 0:d.detail)||"Failed to load packages.")}finally{r(!1)}};return y.useEffect(()=>{o()},[]),a.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm space-y-5",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Packages"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Define IPD packages like Normal Delivery, LSCS, Medical Management with inclusive and exclusive items and package charges."})]}),i&&a.jsx(X3,{message:i}),a.jsx(IS,{title:"New Package",description:"Create a new IPD package with overall charges and inclusions/exclusions.",fields:[{name:"name",label:"Package name",placeholder:"e.g. Normal Delivery",required:!0},{name:"included",label:"Included",placeholder:"e.g. bed, nursing, OT, routine labs"},{name:"excluded",label:"Excluded",placeholder:"e.g. blood, implants, high-value drugs"},{name:"charges",label:"Package charges ()",placeholder:"e.g. 25000",type:"number"}],onSubmit:async c=>{await bce(c),await o()}}),a.jsx(Jm,{title:"Package List",items:t,cols:[["name","Name"],["charges","Charges"],["included","Included"],["excluded","Excluded"]],onDelete:c=>vce(c).then(o)}),s&&a.jsx(Q3,{})]})}function X3({message:t}){return a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:t})]})}function IS({title:t,description:n,fields:s,onSubmit:r}){const[i,l]=y.useState({}),[o,c]=y.useState(!1),d=(h,m)=>{l(x=>({...x,[h]:m}))},u=async h=>{h.preventDefault(),c(!0);try{const m={...i};Object.keys(m).forEach(x=>m[x]===""&&delete m[x]),await r(m),l({})}finally{c(!1)}};return a.jsxs("form",{onSubmit:u,className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 grid gap-3 md:grid-cols-4 text-sm",children:[a.jsxs("div",{className:"md:col-span-4 space-y-1",children:[a.jsx("div",{className:"text-sm font-medium text-slate-800",children:t}),n&&a.jsx("p",{className:"text-[11px] text-slate-500",children:n})]}),s.map(h=>{var m;return a.jsxs("div",{className:"space-y-1",children:[h.label&&a.jsx("label",{className:"text-xs text-slate-500",children:h.label}),h.type==="select"?a.jsxs("select",{className:"input rounded-xl",value:i[h.name]||"",onChange:x=>d(h.name,x.target.value),required:h.required,children:[a.jsx("option",{value:"",children:h.placeholder||"Select"}),(m=h.options)==null?void 0:m.map(x=>a.jsx("option",{value:x.value,children:x.label},x.value))]}):a.jsx("input",{className:"input rounded-xl",type:h.type||"text",placeholder:h.placeholder||h.name,value:i[h.name]||"",onChange:x=>d(h.name,x.target.value),required:h.required})]},h.name)}),a.jsx("div",{className:"md:col-span-4 flex justify-end pt-1",children:a.jsx("button",{type:"submit",className:"btn min-w-[100px]",disabled:o,children:o?"Saving":"Save"})})]})}function Jm({title:t,items:n=[],cols:s=[],onDelete:r,renderValue:i}){return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:t})}),a.jsx("div",{className:"hidden md:block rounded-xl border border-slate-200 overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[s.map(([l,o])=>a.jsx("th",{className:"px-3 py-2 text-left font-medium",children:o||l},l)),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsxs("tbody",{children:[n.map(l=>a.jsxs("tr",{className:"border-t hover:bg-slate-50",children:[s.map(([o])=>a.jsx("td",{className:"px-3 py-2 align-middle",children:i?i(o,l[o],l):String(l[o]??"")},o)),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",onClick:()=>r(l.id),children:[a.jsx(Wr,{className:"h-4 w-4"}),"Delete"]})})]},l.id)),!n.length&&a.jsx("tr",{children:a.jsx("td",{className:"p-3 text-sm text-slate-500",colSpan:s.length+1,children:"No records found."})})]})]})}),a.jsxs("div",{className:"space-y-3 md:hidden",children:[n.map(l=>a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 shadow-sm space-y-2",children:[s.map(([o,c])=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"text-slate-500",children:[c||o,": "]}),i?i(o,l[o],l):a.jsx("span",{className:"text-slate-900",children:String(l[o]??"")})]},o)),a.jsx("div",{className:"pt-1",children:a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-rose-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-rose-700",onClick:()=>r(l.id),children:[a.jsx(Wr,{className:"h-4 w-4"}),"Delete"]})})]},l.id)),!n.length&&a.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 p-3 text-center text-xs text-slate-500",children:"No records yet."})]})]})}function PS({type:t}){return t?a.jsx("span",{className:"inline-flex items-center rounded-full bg-sky-50 px-2 py-0.5 text-[11px] font-medium text-sky-700 border border-sky-200",children:t}):null}function Tce({state:t}){if(!t)return a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[11px] text-slate-600 border border-slate-200",children:"Unknown"});const n=String(t).toLowerCase();let s="bg-slate-100 text-slate-700 border-slate-200";return n==="vacant"||n==="available"?s="bg-emerald-50 text-emerald-700 border-emerald-200":n==="occupied"?s="bg-rose-50 text-rose-700 border-rose-200":(n==="reserved"||n==="cleaning")&&(s="bg-amber-50 text-amber-700 border-amber-200"),a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] capitalize border ${s}`,children:t})}function Ice({basis:t}){const s=(t||"Daily").toLowerCase()==="hourly";return a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] border ${s?"bg-purple-50 text-purple-700 border-purple-200":"bg-emerald-50 text-emerald-700 border-emerald-200"}`,children:s?"Hourly":"Daily"})}function Q3(){return a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 pt-1",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin"}),"Loading"]})}const Iu=(t={})=>{const n={};return Object.entries(t).forEach(([s,r])=>{r!=null&&r!==""&&(n[s]=r)}),n};function Pce(){return ne.get("/opd/departments")}function Mce({departmentId:t,roleId:n,roleName:s,isDoctor:r}={}){const i=Iu({department_id:t,role_id:n,role:s,is_doctor:typeof r=="boolean"?r:void 0});return ne.get("/opd/users",{params:i})}function DI({doctorUserId:t,date:n,detailed:s=!0}){return ne.get("/opd/slots",{params:{doctor_user_id:t,date:n,detailed:s}})}function Oce({doctorUserId:t,date:n}){return ne.get("/opd/slots/free",{params:{doctor_user_id:t,date:n}})}function Dce(t){return ne.get("/opd/schedules",{params:{doctor_user_id:t}})}function Rce(t){return ne.post("/opd/schedules",t)}function Lce(t){return ne.delete(`/opd/schedules/${t}`)}function Z3(t=""){const n=t?{q:t}:{};return ne.get("/patients",{params:n})}function Bce(t){return ne.post("/opd/appointments",t)}function RI(t={}){return ne.get("/opd/appointments",{params:Iu(t)})}function Fce(t,n){return ne.patch(`/opd/appointments/${t}/status`,{status:n})}function $ce(t,n){return ne.post(`/opd/appointments/${t}/reschedule`,n)}function zce(t={}){return ne.get("/opd/appointments/noshow",{params:Iu(t)})}function e9(t={}){return ne.get("/opd/queue",{params:Iu(t)})}function Uce(t){return ne.get(`/opd/visits/${t}`)}function Vce(t,n){return ne.put(`/opd/visits/${t}`,n)}function Hce(t){return ne.post("/opd/vitals",t)}function Wce(t,n){return ne.post(`/opd/visits/${t}/followup`,n)}function qce(t={}){return ne.get("/opd/followups",{params:Iu(t)})}function Gce(t,n){return ne.put(`/opd/followups/${t}`,n)}function Kce(t,n){return ne.post(`/opd/followups/${t}/schedule`,n)}function Yce(t={}){return ne.get("/opd/doctor-fees",{params:Iu(t)})}function Xce(t){return ne.post("/opd/doctor-fees",t)}function Qce(t,n){return ne.put(`/opd/doctor-fees/${t}`,n)}function LI(t){if(t.id){const{id:n,...s}=t;return Qce(n,s)}return Xce(t)}function Zce(t){return ne.delete(`/opd/doctor-fees/${t}`)}function t9(){return Pce()}function n9({departmentId:t,roleId:n,isDoctor:s}={}){return Mce({departmentId:t,roleId:n,isDoctor:s})}function Jce({dateFrom:t,dateTo:n,doctorId:s}={}){return ne.get("/opd/dashboard",{params:Iu({date_from:t,date_to:n,doctor_id:s})})}const TN=10;function s9({value:t,onChange:n}){const[s,r]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(0),[h,m]=y.useState(!1),[x,b]=y.useState(null);y.useEffect(()=>{const I=setTimeout(()=>l(s.trim()),300);return()=>clearTimeout(I)},[s]),y.useEffect(()=>{let I=!0;return(async()=>{var O,R;m(!0),b(null);try{const{data:P}=await Z3(i||"");if(!I)return;c(Array.isArray(P)?P:[]),u(0)}catch(P){if(!I)return;const L=((R=(O=P==null?void 0:P.response)==null?void 0:O.data)==null?void 0:R.detail)||(P==null?void 0:P.message)||"Could not load patients. Please try again.";b(L),c([]),u(0)}finally{I&&m(!1)}})(),()=>{I=!1}},[i]);const w=Math.max(1,Math.ceil(((o==null?void 0:o.length)||0)/TN)),j=d*TN,S=y.useMemo(()=>(o||[]).slice(j,j+TN),[o,j]),C=I=>{n&&n(I)},A=d===0||h,k=d>=w-1||h,T=t??null;return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Patient"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:"Search and select patient for admission"})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Search by UHID, name, phone or email and choose the correct patient."})]}),a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2.5 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by UHID, name, phone, email",value:s,onChange:I=>r(I.target.value)})]}),a.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"UHID"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Name"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Phone"}),a.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),a.jsxs("tbody",{children:[h&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-slate-500",children:a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs text-slate-600",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin"}),"Loading patients"]})})}),!h&&x&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-rose-600",children:x})}),!h&&!x&&S.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No patients found. Try a different search."})}),!h&&!x&&S.map(I=>{const D=T===I.id,O=`${I.first_name||""} ${I.last_name||""}`.trim();return a.jsxs("tr",{className:`border-t text-sm transition hover:bg-slate-50 ${D?"bg-sky-50":""}`,children:[a.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:a.jsxs("div",{className:"flex items-center gap-2",children:[D&&a.jsx(zr,{className:"h-4 w-4 text-sky-500"}),a.jsx("span",{className:"font-medium",children:I.uhid||""})]})}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:O||I.name||""}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:I.phone||""}),a.jsx("td",{className:"px-4 py-2 align-middle text-right",children:a.jsx("button",{type:"button",onClick:()=>C(I.id),className:`inline-flex items-center rounded-full px-4 py-1.5 text-xs font-semibold shadow-sm transition ${D?"bg-sky-600 text-white hover:bg-sky-700":"bg-slate-900 text-white hover:bg-slate-800"}`,children:D?"Selected":"Select"})})]},I.id)})]})]})}),a.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>u(I=>Math.max(0,I-1)),disabled:A,children:[a.jsx(yx,{className:"h-4 w-4"}),"Prev"]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page ",a.jsx("span",{className:"font-medium",children:d+1})," / ",w]}),a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>u(I=>Math.min(w-1,I+1)),disabled:k,children:["Next",a.jsx(Nh,{className:"h-4 w-4"})]})]})]})]})}function r9({value:t,onChange:n,label:s="Allocate Bed (Ward  Room  Bed)"}){const[r,i]=y.useState([]),[l,o]=y.useState([]),[c,d]=y.useState([]),[u,h]=y.useState(""),[m,x]=y.useState(""),[b,w]=y.useState(!1),[j,S]=y.useState(!1),[C,A]=y.useState(!1),[k,T]=y.useState("");y.useEffect(()=>{let P=!0;return(async()=>{var $,B;w(!0),T("");try{const{data:V}=await Db();if(!P)return;i(V||[])}catch(V){if(!P)return;console.error("listWards error",V),T(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Failed to load wards. Please refresh and try again."),i([])}finally{P&&w(!1)}})(),()=>{P=!1}},[]),y.useEffect(()=>{let P=!0;return o([]),x(""),d([]),T(""),n==null||n(null),u?((async()=>{var $,B;S(!0);try{const{data:V}=await Sx({ward_id:Number(u)});if(!P)return;o(V||[])}catch(V){if(!P)return;console.error("listRooms error",V),T(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Failed to load rooms for this ward."),o([])}finally{P&&S(!1)}})(),()=>{P=!1}):void 0},[u]),y.useEffect(()=>{let P=!0;return d([]),T(""),n==null||n(null),m?((async()=>{var $,B;A(!0);try{const{data:V}=await el({room_id:Number(m)});if(!P)return;d(V||[])}catch(V){if(!P)return;console.error("listBeds error",V),T(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Failed to load beds for this room."),d([])}finally{P&&A(!1)}})(),()=>{P=!1}):void 0},[m]);const I=y.useMemo(()=>{const P=t?Number(t):null;return P&&c.find(L=>L.id===P)||null},[c,t]),D=P=>{h(P.target.value)},O=P=>{x(P.target.value)},R=P=>{const L=P.target.value,$=L?Number(L):null;n==null||n($)};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Bed Allocation"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:s})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Select ward, then room, then an available bed for this admission."})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(Ya,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"font-medium",children:"Ward"})]}),a.jsxs("div",{className:"relative",children:[b&&a.jsx(nn,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:u,onChange:D,disabled:b,children:[a.jsx("option",{value:"",children:b?"Loading wards":"Select ward"}),r.map(P=>a.jsxs("option",{value:P.id,children:[P.code,"  ",P.name]},P.id))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(t7,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"font-medium",children:"Room"})]}),a.jsxs("div",{className:"relative",children:[j&&a.jsx(nn,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:m,onChange:O,disabled:!u||j||r.length===0,children:[a.jsx("option",{value:"",children:u?j?"Loading rooms":l.length===0?"No rooms in this ward":"Select room":"Select ward first"}),l.map(P=>a.jsxs("option",{value:P.id,children:[P.number,"  ",P.type]},P.id))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(Ps,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"font-medium",children:"Bed"})]}),a.jsxs("div",{className:"relative",children:[C&&a.jsx(nn,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:t||"",onChange:R,disabled:!m||C||l.length===0,children:[a.jsx("option",{value:"",children:m?C?"Loading beds":c.length===0?"No beds in this room":"Select bed":"Select room first"}),c.map(P=>a.jsxs("option",{value:P.id,children:[P.code,P.state&&P.state!=="vacant"?`  ${P.state}`:""]},P.id))]})]})]})]}),I&&a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-800",children:[a.jsx(zr,{className:"h-4 w-4"}),a.jsx("span",{className:"font-semibold",children:"Selected bed:"}),a.jsx("span",{className:"font-medium",children:I.code}),I.state&&a.jsxs("span",{className:"text-emerald-700",children:[" ",I.state]})]}),k&&a.jsxs("div",{className:"mt-1 flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:k})]})]})}function Hl({value:t,onChange:n,label:s="Primary Doctor  Department  Role  User"}){const[r,i]=y.useState([]),[l,o]=y.useState(""),[c,d]=y.useState([]),[u,h]=y.useState(!1),[m,x]=y.useState(!1),[b,w]=y.useState("");y.useEffect(()=>{let A=!0;return h(!0),t9().then(k=>{A&&i(k.data||[])}).catch(k=>{var I,D;if(!A)return;console.error("fetchDepartments error",k);const T=((D=(I=k==null?void 0:k.response)==null?void 0:I.data)==null?void 0:D.detail)||"Failed to load departments.";i([]),w(T),xe.error(T)}).finally(()=>{A&&h(!1)}),()=>{A=!1}},[]),y.useEffect(()=>{let A=!0;w(""),d([]);const k=l?Number(l):null;if(n==null||n(null,{department_id:k}),!!l)return x(!0),n9({departmentId:k,isDoctor:!0}).then(T=>{A&&d(T.data||[])}).catch(T=>{var D,O;if(!A)return;console.error("fetchDepartmentUsers error",T);const I=((O=(D=T==null?void 0:T.response)==null?void 0:D.data)==null?void 0:O.detail)||"Failed to load doctors.";w(I),d([]),xe.error(I)}).finally(()=>{A&&x(!1)}),()=>{A=!1}},[l]);const j=y.useMemo(()=>c.find(A=>A.id===t)||null,[c,t]),S=A=>{const k=A.target.value;o(k)},C=A=>{const k=A.target.value,T=k?Number(k):null,I=l?Number(l):null;n==null||n(T,{department_id:I})};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Doctor & Department"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:s})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose the admitting department and responsible doctor for this stay."})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(Ya,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"font-medium",children:"Department"})]}),a.jsxs("div",{className:"relative",children:[u&&a.jsx(nn,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:l,onChange:S,disabled:u,children:[a.jsx("option",{value:"",children:u?"Loading departments":"Select department"}),r.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(un,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"font-medium",children:"Doctor"})]}),a.jsxs("div",{className:"relative",children:[m&&a.jsx(nn,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 animate-spin text-slate-400"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:t||"",onChange:C,disabled:!l||m||c.length===0,children:[a.jsx("option",{value:"",children:m?"Loading doctors":l?c.length===0?"No doctors in this department":"Select doctor":"Select department first"}),c.map(A=>a.jsxs("option",{value:A.id,children:[A.name,A.email?` (${A.email})`:""]},A.id))]})]})]})]}),j&&a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-800",children:[a.jsx(zr,{className:"h-4 w-4"}),a.jsx("span",{className:"font-semibold",children:"Selected doctor:"}),a.jsx("span",{className:"font-medium",children:j.name}),j.email&&a.jsxs("span",{className:"text-emerald-700",children:[" ",j.email]})]}),b&&a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:b})]})]})}function ede({kind:t="success",title:n,message:s,onClose:r}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",Icon:zr},warn:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",Icon:No},error:{bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-700",Icon:Ab}},l=i[t]||i.success;return a.jsxs("div",{className:`flex w-full max-w-md items-start gap-3 rounded-xl border ${l.border} ${l.bg} p-3 shadow-lg`,children:[a.jsx(l.Icon,{className:`mt-0.5 h-5 w-5 ${l.text}`}),a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-medium",children:n}),s?a.jsx("div",{className:"mt-0.5 text-[13px] opacity-90",children:s}):null]}),a.jsx("button",{className:"ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg hover:bg-black/5",onClick:r,"aria-label":"Close",type:"button",children:a.jsx(Os,{className:"h-4 w-4"})})]})}const Zl=t=>typeof t=="number"?Number.isInteger(t)&&t>0:typeof t=="string"&&t.trim()!==""&&/^\d+$/.test(t)?Number(t)>0:!1,tde=t=>t?t.length===16?`${t}:00`:t:void 0;function nde(){const[t,n]=y.useState([]),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(null),[h,m]=y.useState(null),[x,b]=y.useState(null),[w,j]=y.useState({admission_type:"planned",expected_discharge_at:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:"",preliminary_diagnosis:"",history:"",care_plan:""}),[S,C]=y.useState(null),A=y.useRef(null),k=O=>{A.current&&clearTimeout(A.current),C(O),A.current=setTimeout(()=>C(null),4500)},T=y.useMemo(()=>t.find(O=>O.id===Number(x))||null,[t,x]);y.useEffect(()=>{let O=!0;return(async()=>{var R,P;l(!0);try{const[L,$]=await Promise.all([el(),K3()]);if(!O)return;n(L.data||[]),r($.data||[])}catch(L){k({kind:"error",title:"Failed to load data",message:((P=(R=L==null?void 0:L.response)==null?void 0:R.data)==null?void 0:P.detail)||"Could not load beds / packages. Please refresh and try again."})}finally{O&&l(!1)}})(),()=>{O=!1}},[]);const I=async O=>{try{const{data:R}=await _x({status:"admitted",patient_id:O});return Array.isArray(R)&&R.length>0?R[0]:null}catch{return null}},D=async O=>{var P;if(O.preventDefault(),i)return;if(!Zl(o)){k({kind:"warn",title:"Select a patient",message:"Pick a patient before admitting."});return}if(!Zl(x)){k({kind:"warn",title:"Select a bed",message:"Choose Ward  Room  Bed."});return}if(!t.find(L=>L.id===Number(x))){k({kind:"warn",title:"Selected bed is unavailable",message:"Refresh beds and select again."});return}l(!0);try{const L=await I(Number(o));if(L!=null&&L.id){const V=`ADM-${String(L.id).padStart(6,"0")}`;k({kind:"warn",title:"Patient already admitted",message:`Active admission ${V} exists. Open Tracking / My Admissions to view.`});return}const $={patient_id:Number(o),bed_id:Number(x),admission_type:w.admission_type||"planned",expected_discharge_at:tde(w.expected_discharge_at),department_id:Zl(d)?Number(d):void 0,practitioner_user_id:Zl(h)?Number(h):void 0,package_id:Zl(w.package_id)?Number(w.package_id):void 0,payor_type:w.payor_type||"cash",insurer_name:w.insurer_name||"",policy_number:w.policy_number||"",preliminary_diagnosis:w.preliminary_diagnosis||"",history:w.history||"",care_plan:w.care_plan||""};Object.keys($).forEach(V=>$[V]===void 0&&delete $[V]);const{data:B}=await JB($);k({kind:"success",title:"Admission created",message:`Admission ADM-${String(B.id).padStart(6,"0")} has been created successfully.`});try{const V=await el();n(V.data||[])}catch{}b(null),j(V=>({...V,expected_discharge_at:"",preliminary_diagnosis:"",history:"",care_plan:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:""}))}catch(L){const $=(P=L==null?void 0:L.response)==null?void 0:P.data,B=Array.isArray($==null?void 0:$.detail)?$.detail.map(K=>K==null?void 0:K.msg).filter(Boolean).join(", "):($==null?void 0:$.detail)||L.message||"Failed to create admission",V=/Bed not found/i.test(B)?"Please select a valid bed.":/Bed not available/i.test(B)?"That bed is not available. Pick another one.":B;k({kind:"error",title:"Admission failed",message:V})}finally{l(!1)}};return a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 md:px-6 md:py-6 text-black",children:[S&&a.jsx("div",{className:"fixed inset-x-0 top-16 z-50 flex justify-center px-4 sm:justify-end sm:px-6",children:a.jsx(ede,{kind:S.kind,title:S.title,message:S.message,onClose:()=>C(null)})}),a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"IPD Admission"}),a.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"Use this screen to admit an in-patient. Select the patient, assign a primary doctor and bed, and capture admission details and payer information. The system will automatically prevent duplicate active admissions for the same patient."})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Step 1"}),a.jsx("br",{}),"Pick patient"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(_r,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Step 2"}),a.jsx("br",{}),"Doctor & details"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Step 3"}),a.jsx("br",{}),"Assign bed"]})]})]})]}),a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx("div",{className:"border-b border-slate-200 px-4 py-3",children:a.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"New Admission"}),a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"IPD  Admission Management"})]})}),a.jsx(ta,{anyOf:["ipd.manage"],fallback:a.jsxs("div",{className:"p-4 text-xs text-amber-700 bg-amber-50 border-t border-amber-200 rounded-b-2xl",children:["You do not have permission to create admissions. Please contact the administrator to enable ",a.jsx("span",{className:"font-semibold",children:"IPD Manage"})," access."]}),children:a.jsxs("form",{onSubmit:D,className:"space-y-6 p-4 md:p-6 text-sm",children:[a.jsxs("section",{className:"space-y-2",children:[a.jsx(s9,{value:o??void 0,onChange:c}),Zl(o)&&a.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:"Tip: If this patient already has an active admission, you will see a warning and the system will block duplicate admission."})]}),a.jsx("section",{className:"space-y-2",children:a.jsx(Hl,{label:"Primary doctor  Department  Role  User",value:h??void 0,onChange:(O,R)=>{m(O||null),u((R==null?void 0:R.department_id)||null)}})}),a.jsxs("section",{className:"space-y-2",children:[a.jsx(r9,{value:x??"",onChange:O=>b(Zl(O)?Number(O):null)}),T&&a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[a.jsx("span",{className:"text-slate-500",children:"Selected bed: "}),a.jsx("span",{className:"font-medium text-slate-900",children:T.code}),a.jsx("span",{className:"mx-1 text-slate-400",children:""}),a.jsx("span",{className:"text-slate-500",children:"State: "}),a.jsx("span",{className:["inline-flex items-center rounded-md border px-1.5 py-0.5 text-[11px]",T.state==="vacant"?"border-emerald-200 bg-emerald-50 text-emerald-700":T.state==="reserved"?"border-amber-200 bg-amber-50 text-amber-700":"border-slate-200 bg-slate-100 text-slate-700"].join(" "),children:T.state}),T.reserved_until&&a.jsxs("span",{className:"ml-2 text-slate-500",children:["until"," ",new Date(T.reserved_until).toLocaleString()]})]})]}),a.jsxs("section",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Admission details"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose admission type, expected discharge and payer details."})]}),(()=>{const O=["insurance","tpa"].includes(w.payor_type);return a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Admission type"}),a.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.admission_type,onChange:R=>j(P=>({...P,admission_type:R.target.value})),children:["planned","emergency","daycare"].map(R=>a.jsx("option",{value:R,children:R},R))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Expected discharge"}),a.jsx("input",{type:"datetime-local",className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.expected_discharge_at,onChange:R=>j(P=>({...P,expected_discharge_at:R.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Package"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.package_id,onChange:R=>j(P=>({...P,package_id:R.target.value})),children:[a.jsx("option",{value:"",children:""}),s.map(R=>a.jsx("option",{value:R.id,children:R.name},R.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Payor type"}),a.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.payor_type,onChange:R=>j(P=>({...P,payor_type:R.target.value})),children:["cash","insurance","tpa"].map(R=>a.jsx("option",{value:R,children:R},R))})]}),O&&a.jsxs(a.Fragment,{children:[a.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Insurer name",value:w.insurer_name,onChange:R=>j(P=>({...P,insurer_name:R.target.value}))}),a.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Policy number",value:w.policy_number,onChange:R=>j(P=>({...P,policy_number:R.target.value}))})]}),a.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Preliminary diagnosis",value:w.preliminary_diagnosis,onChange:R=>j(P=>({...P,preliminary_diagnosis:R.target.value}))}),a.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"History",value:w.history,onChange:R=>j(P=>({...P,history:R.target.value}))}),a.jsx("input",{className:"input md:col-span-3 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Care plan",value:w.care_plan,onChange:R=>j(P=>({...P,care_plan:R.target.value}))})]})})()]}),a.jsxs("div",{className:"flex flex-col gap-2 border-t border-slate-100 pt-4 sm:flex-row sm:items-center sm:justify-end",children:[a.jsx("p",{className:"text-[11px] text-slate-500",children:"Once admitted, you can manage vitals, nursing notes and discharge from the Admission Detail screen."}),a.jsx("button",{type:"submit",className:"btn sm:min-w-[140px]",disabled:i||!Zl(o)||!Zl(x),children:i?"Admitting":"Admit patient"})]})]})})]})})]})}function sde({kind:t="success",title:n,message:s,onClose:r}){const i={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-700",Icon:zr},warn:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",Icon:No},error:{bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-700",Icon:Ab}},l=i[t]||i.success;return a.jsxs("div",{className:`flex w-full max-w-md items-start gap-3 rounded-xl border ${l.border} ${l.bg} p-3 shadow-lg`,role:"alert","aria-live":"polite",children:[a.jsx(l.Icon,{className:`mt-0.5 h-5 w-5 ${l.text}`}),a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-medium",children:n}),s?a.jsx("div",{className:"mt-0.5 text-[13px] opacity-90",children:s}):null]}),a.jsx("button",{className:"ml-auto inline-flex h-7 w-7 items-center justify-center rounded-lg hover:bg-black/5",onClick:r,"aria-label":"Close notification",type:"button",children:a.jsx(Os,{className:"h-4 w-4"})})]})}const Jl=t=>typeof t=="number"?Number.isInteger(t)&&t>0:typeof t=="string"&&t.trim()!==""&&/^\d+$/.test(t)?Number(t)>0:!1,rde=t=>t?t.length===16?`${t}:00`:t:void 0;function ade(){const[t,n]=y.useState([]),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(null),[h,m]=y.useState(null),[x,b]=y.useState(null),[w,j]=y.useState({admission_type:"planned",expected_discharge_at:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:"",preliminary_diagnosis:"",history:"",care_plan:""}),[S,C]=y.useState(null),A=y.useRef(null),k=R=>{A.current&&clearTimeout(A.current),C(R),A.current=setTimeout(()=>C(null),4500)};y.useEffect(()=>()=>{A.current&&clearTimeout(A.current)},[]);const T=y.useMemo(()=>t.find(R=>R.id===Number(x))||null,[t,x]);y.useEffect(()=>{let R=!0;return(async()=>{var P,L;l(!0);try{const[$,B]=await Promise.all([el(),K3()]);if(!R)return;n($.data||[]),r(B.data||[])}catch($){if(!R)return;console.error("Admissions lookup load error",$),k({kind:"error",title:"Failed to load data",message:((L=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:L.detail)||"Could not load beds / packages. Please refresh and try again."})}finally{R&&l(!1)}})(),()=>{R=!1}},[]);const I=async R=>{try{const{data:P}=await _x({status:"admitted",patient_id:R});return Array.isArray(P)&&P.length>0?P[0]:null}catch{return null}},D=async R=>{var L;if(R.preventDefault(),i)return;if(!Jl(o)){k({kind:"warn",title:"Select a patient",message:"Pick a patient before admitting."});return}if(!Jl(x)){k({kind:"warn",title:"Select a bed",message:"Choose Ward  Room  Bed."});return}if(!t.find($=>$.id===Number(x))){k({kind:"warn",title:"Selected bed is unavailable",message:"Refresh beds and select again."});return}l(!0);try{const $=await I(Number(o));if($!=null&&$.id){const K=`ADM-${String($.id).padStart(6,"0")}`;k({kind:"warn",title:"Patient already admitted",message:`Active admission ${K} exists. Open Tracking / My Admissions to view.`});return}const B={patient_id:Number(o),bed_id:Number(x),admission_type:w.admission_type||"planned",expected_discharge_at:rde(w.expected_discharge_at),department_id:Jl(d)?Number(d):void 0,practitioner_user_id:Jl(h)?Number(h):void 0,package_id:Jl(w.package_id)?Number(w.package_id):void 0,payor_type:w.payor_type||"cash",insurer_name:w.insurer_name||"",policy_number:w.policy_number||"",preliminary_diagnosis:w.preliminary_diagnosis||"",history:w.history||"",care_plan:w.care_plan||""};Object.keys(B).forEach(K=>B[K]===void 0&&delete B[K]);const{data:V}=await JB(B);k({kind:"success",title:"Admission created",message:`Admission ADM-${String(V.id).padStart(6,"0")} has been created successfully.`});try{const K=await el();n(K.data||[])}catch{}b(null),j(K=>({...K,expected_discharge_at:"",preliminary_diagnosis:"",history:"",care_plan:"",package_id:"",payor_type:"cash",insurer_name:"",policy_number:""}))}catch($){console.error("Admission create error",$);const B=(L=$==null?void 0:$.response)==null?void 0:L.data,V=Array.isArray(B==null?void 0:B.detail)?B.detail.map(z=>z==null?void 0:z.msg).filter(Boolean).join(", "):(B==null?void 0:B.detail)||$.message||"Failed to create admission",K=/Bed not found/i.test(V)?"Please select a valid bed.":/Bed not available/i.test(V)?"That bed is not available. Pick another one.":V;k({kind:"error",title:"Admission failed",message:K})}finally{l(!1)}},O=["insurance","tpa"].includes(w.payor_type);return a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[S&&a.jsx("div",{className:"fixed inset-x-0 top-16 z-50 flex justify-center px-4 sm:justify-end sm:px-6",children:a.jsx(sde,{kind:S.kind,title:S.title,message:S.message,onClose:()=>C(null)})}),a.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"IPD Admission"}),a.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"Use this screen to admit an in-patient. Select the patient, assign a primary doctor and bed, and capture admission details and payer information. The system automatically prevents duplicate active admissions for the same patient."})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Step 1"}),a.jsx("br",{}),"Pick patient"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(_r,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Step 2"}),a.jsx("br",{}),"Doctor & details"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Step 3"}),a.jsx("br",{}),"Assign bed"]})]})]})]}),a.jsx("div",{className:"mx-auto max-w-6xl",children:a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx("div",{className:"border-b border-slate-200 px-4 py-3",children:a.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"New Admission"}),a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"IPD  Admission Management"})]})}),a.jsx(ta,{anyOf:["ipd.manage"],fallback:a.jsxs("div",{className:"rounded-b-2xl border-t border-amber-200 bg-amber-50 p-4 text-xs text-amber-700",children:["You do not have permission to create admissions. Please contact the administrator to enable"," ",a.jsx("span",{className:"font-semibold",children:"IPD Manage"})," access."]}),children:a.jsxs("form",{onSubmit:D,className:"space-y-6 p-4 text-sm md:p-6",children:[a.jsxs("section",{className:"space-y-2",children:[a.jsx(s9,{value:o??void 0,onChange:c}),Jl(o)&&a.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:"Tip: If this patient already has an active admission, you will see a warning and the system will block duplicate admission."})]}),a.jsx("section",{className:"space-y-2",children:a.jsx(Hl,{label:"Primary doctor  Department  Role  User",value:h??void 0,onChange:(R,P)=>{m(R||null),u((P==null?void 0:P.department_id)||null)}})}),a.jsxs("section",{className:"space-y-2",children:[a.jsx(r9,{value:x??"",onChange:R=>b(Jl(R)?Number(R):null)}),T&&a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[a.jsx("span",{className:"text-slate-500",children:"Selected bed: "}),a.jsx("span",{className:"font-medium text-slate-900",children:T.code}),a.jsx("span",{className:"mx-1 text-slate-400",children:""}),a.jsx("span",{className:"text-slate-500",children:"State: "}),a.jsx("span",{className:["inline-flex items-center rounded-md border px-1.5 py-0.5 text-[11px]",T.state==="vacant"?"border-emerald-200 bg-emerald-50 text-emerald-700":T.state==="reserved"?"border-amber-200 bg-amber-50 text-amber-700":"border-slate-200 bg-slate-100 text-slate-700"].join(" "),children:T.state}),T.reserved_until&&a.jsxs("span",{className:"ml-2 text-slate-500",children:["until"," ",new Date(T.reserved_until).toLocaleString()]})]})]}),a.jsxs("section",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Admission details"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Choose admission type, expected discharge and payer details."})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Admission type"}),a.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.admission_type,onChange:R=>j(P=>({...P,admission_type:R.target.value})),children:["planned","emergency","daycare"].map(R=>a.jsx("option",{value:R,children:R},R))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Expected discharge"}),a.jsx("input",{type:"datetime-local",className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.expected_discharge_at,onChange:R=>j(P=>({...P,expected_discharge_at:R.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Package"}),a.jsxs("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.package_id,onChange:R=>j(P=>({...P,package_id:R.target.value})),children:[a.jsx("option",{value:"",children:""}),s.map(R=>a.jsx("option",{value:R.id,children:R.name},R.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs text-slate-500",children:"Payor type"}),a.jsx("select",{className:"input w-full rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:w.payor_type,onChange:R=>j(P=>({...P,payor_type:R.target.value})),children:["cash","insurance","tpa"].map(R=>a.jsx("option",{value:R,children:R},R))})]}),O&&a.jsxs(a.Fragment,{children:[a.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Insurer name",value:w.insurer_name,onChange:R=>j(P=>({...P,insurer_name:R.target.value}))}),a.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Policy number",value:w.policy_number,onChange:R=>j(P=>({...P,policy_number:R.target.value}))})]}),a.jsx("input",{className:"input md:col-span-2 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Preliminary diagnosis",value:w.preliminary_diagnosis,onChange:R=>j(P=>({...P,preliminary_diagnosis:R.target.value}))}),a.jsx("input",{className:"input rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"History",value:w.history,onChange:R=>j(P=>({...P,history:R.target.value}))}),a.jsx("input",{className:"input md:col-span-3 rounded-2xl border border-slate-200 bg-white text-sm shadow-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Care plan",value:w.care_plan,onChange:R=>j(P=>({...P,care_plan:R.target.value}))})]})]}),a.jsxs("div",{className:"flex flex-col gap-2 border-t border-slate-100 pt-4 sm:flex-row sm:items-center sm:justify-end",children:[a.jsx("p",{className:"text-[11px] text-slate-500",children:"Once admitted, you can manage vitals, nursing notes and discharge from the Admission Detail screen."}),a.jsx("button",{type:"submit",className:"btn sm:min-w-[140px]",disabled:i||!Jl(o)||!Jl(x),children:i?"Admitting":"Admit patient"})]})]})})]})})]})}const IN=10;function ide(){const[t,n]=y.useState([]),[s,r]=y.useState({}),[i,l]=y.useState({}),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,m]=y.useState(""),[x,b]=y.useState(1),w=L=>`ADM-${String(L).padStart(6,"0")}`,j=L=>L?L==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":L==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":L==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":L==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200",S=async()=>{var L,$;c(!0),u("");try{const[B,V]=await Promise.all([_x({status:"admitted"}),el()]),K=B.data||[],z=V.data||[];K.sort((J,ee)=>new Date(ee.admitted_at||0)-new Date(J.admitted_at||0)),n(K);const H={};for(const J of z)H[J.id]=J;r(H);const Y=[...new Set(K.map(J=>J.patient_id))].slice(0,100),G={};await Promise.all(Y.map(async J=>{try{const{data:ee}=await Y3(J);G[J]=(ee==null?void 0:ee.uhid)||`P-${J}`}catch{G[J]=`P-${J}`}})),l(G),b(1)}catch(B){console.error("TrackingAdmissions loadData error",B),u((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to load active admissions. Please try again."),n([]),r({}),l({})}finally{c(!1)}};y.useEffect(()=>{let L=!0;return(async()=>await S())(),()=>{L=!1}},[]);const C=y.useMemo(()=>{const L=h.trim().toLowerCase();return L?t.filter($=>{var z;const B=w($.id).toLowerCase(),V=(i[$.patient_id]||`P-${$.patient_id}`).toLowerCase(),K=(((z=s[$.current_bed_id])==null?void 0:z.code)||"").toLowerCase();return B.includes(L)||V.includes(L)||K.includes(L)}):t},[t,h,i,s]),A=Math.max(1,Math.ceil(C.length/IN));y.useEffect(()=>{b(1)},[h,t]);const k=(x-1)*IN,T=C.slice(k,k+IN),I=()=>b(L=>Math.max(1,L-1)),D=()=>b(L=>Math.min(A,L+1)),O=x<=1||o,R=x>=A||o,P=t.length;return a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[a.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Tracking Admissions"}),a.jsx("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:"View all currently admitted in-patients, along with their admission number, UHID and allocated bed. Use the search box to quickly find a patient or admission, and open the admission detail screen for nursing, vitals, orders and discharge."})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Active patients"}),a.jsx("br",{}),"Track IP stays"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Bed position"}),a.jsx("br",{}),"Ward / room / bed"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ys,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Admitted since"}),a.jsx("br",{}),"Monitor length of stay"]})]})]})]}),a.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"w-full md:max-w-md",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:h,onChange:L=>m(L.target.value)})]}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Tip: Try typing admission number (ADM-000123), UHID or bed code."})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[a.jsxs("div",{className:"text-xs text-slate-600",children:[a.jsx("span",{className:"font-semibold text-slate-900",children:C.length})," ","of ",P," active admissions"]}),a.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?a.jsx(nn,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(ji,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:d})]}),o&&!t.length&&a.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading active admissions"]})}),!o&&T.length===0&&a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No active admissions found."}),!o&&T.length>0&&a.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),a.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),a.jsx("tbody",{children:T.map(L=>{const $=s[L.current_bed_id],B=($==null?void 0:$.code)||"",V=i[L.patient_id]||`P-${L.patient_id}`;return a.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[a.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:w(L.id)})}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:V}),a.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[B,($==null?void 0:$.state)&&a.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${j($.state)}`,children:$.state})]}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:L.admitted_at?new Date(L.admitted_at).toLocaleString():""}),a.jsx("td",{className:"px-4 py-2 align-middle text-right",children:a.jsx(Zi,{to:`/ipd/admission/${L.id}`,state:{admission:L},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})})]},L.id)})})]})}),a.jsx("div",{className:"space-y-2 p-3 md:hidden",children:T.map(L=>{const $=s[L.current_bed_id],B=($==null?void 0:$.code)||"",V=i[L.patient_id]||`P-${L.patient_id}`;return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:w(L.id)}),a.jsx(Zi,{to:`/ipd/admission/${L.id}`,state:{admission:L},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium",children:V})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-slate-800",children:[a.jsx(Ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium",children:B}),($==null?void 0:$.state)&&a.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${j($.state)}`,children:$.state})]}),a.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[a.jsx(Ys,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),a.jsx("div",{className:"text-[11px]",children:L.admitted_at?new Date(L.admitted_at).toLocaleString():""})]})]})]})]},L.id)})}),C.length>0&&a.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[a.jsxs("button",{type:"button",onClick:I,disabled:O,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[a.jsx(yx,{className:"h-4 w-4"}),"Prev"]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",a.jsx("span",{className:"font-medium text-slate-900",children:x})," ","of ",A]}),a.jsxs("button",{type:"button",onClick:D,disabled:R,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",a.jsx(Nh,{className:"h-4 w-4"})]})]})]})]})]})}const PN=10;function lde(){const t=kr(B=>B.user),[n,s]=y.useState([]),[r,i]=y.useState({}),[l,o]=y.useState({}),[c,d]=y.useState(!1),[u,h]=y.useState(""),[m,x]=y.useState(""),[b,w]=y.useState(1),j=B=>`ADM-${String(B).padStart(6,"0")}`,S=B=>B?B==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":B==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":B==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":B==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200",C=async()=>{var B,V;if(t!=null&&t.id){d(!0),h("");try{const[K,z]=await Promise.all([_x({status:"admitted",practitioner_user_id:t.id}),el()]),H=K.data||[],Y=z.data||[];H.sort((ye,ie)=>new Date(ie.admitted_at||0)-new Date(ye.admitted_at||0)),s(H);const G={};for(const ye of Y)G[ye.id]=ye;i(G);const J=[...new Set(H.map(ye=>ye.patient_id))].slice(0,100),ee={};await Promise.all(J.map(async ye=>{try{const{data:ie}=await Y3(ye);ee[ye]=(ie==null?void 0:ie.uhid)||`P-${ye}`}catch{ee[ye]=`P-${ye}`}})),o(ee),w(1)}catch(K){console.error("MyAdmissions loadData error",K),h(((V=(B=K==null?void 0:K.response)==null?void 0:B.data)==null?void 0:V.detail)||"Failed to load your admissions. Please try again."),s([]),i({}),o({})}finally{d(!1)}}};y.useEffect(()=>{if(!(t!=null&&t.id))return;let B=!0;return(async()=>await C())(),()=>{B=!1}},[t==null?void 0:t.id]);const A=y.useMemo(()=>{const B=m.trim().toLowerCase();return B?n.filter(V=>{var Y;const K=j(V.id).toLowerCase(),z=(l[V.patient_id]||`P-${V.patient_id}`).toLowerCase(),H=(((Y=r[V.current_bed_id])==null?void 0:Y.code)||"").toLowerCase();return K.includes(B)||z.includes(B)||H.includes(B)}):n},[n,m,l,r]),k=Math.max(1,Math.ceil(A.length/PN));y.useEffect(()=>{w(1)},[m,n]);const T=(b-1)*PN,I=A.slice(T,T+PN),D=()=>w(B=>Math.max(1,B-1)),O=()=>w(B=>Math.min(k,B+1)),R=b<=1||c,P=b>=k||c,L=n.length;if(!(t!=null&&t.id))return a.jsx("div",{className:"min-h-screen bg-slate-50 px-4 py-6 text-sm text-slate-700 md:px-6",children:a.jsx("div",{className:"mx-auto max-w-3xl rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:"You are not logged in or your user information is missing. Please log in again to view your admissions."})});const $=(t==null?void 0:t.full_name)||(t==null?void 0:t.name)||(t==null?void 0:t.username)||(t==null?void 0:t.email)||"you";return a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[a.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"My Admissions"}),a.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["This view shows all"," ",a.jsx("span",{className:"font-semibold",children:"active in-patient admissions"})," ","where ",a.jsx("span",{className:"font-semibold",children:$})," is set as the primary doctor / practitioner. Use it to quickly jump into your patients' admission detail screens for orders, notes, vitals and discharge planning."]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Your in-patients"}),a.jsx("br",{}),"Assigned to you"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Bed overview"}),a.jsx("br",{}),"Ward / room / bed"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ys,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Admitted since"}),a.jsx("br",{}),"Length of stay"]})]})]})]}),a.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"w-full md:max-w-md",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:m,onChange:B=>x(B.target.value)})]}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Tip: Type an admission number (ADM-000123), UHID or bed code to quickly find a patient."})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[a.jsxs("div",{className:"text-xs text-slate-600",children:[a.jsx("span",{className:"font-semibold text-slate-900",children:A.length})," ","of ",L," active admissions assigned to you"]}),a.jsxs("button",{type:"button",onClick:C,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:c,children:[c?a.jsx(nn,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(ji,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),u&&a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:u})]}),c&&!n.length&&a.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading your admissions"]})}),!c&&I.length===0&&a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No active admissions assigned to you."}),!c&&I.length>0&&a.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),a.jsx("th",{className:"px-4 py-2 text-right font-medium",children:"Action"})]})}),a.jsx("tbody",{children:I.map(B=>{const V=r[B.current_bed_id],K=(V==null?void 0:V.code)||"",z=l[B.patient_id]||`P-${B.patient_id}`;return a.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[a.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:j(B.id)})}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:z}),a.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[K,(V==null?void 0:V.state)&&a.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${S(V.state)}`,children:V.state})]}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""}),a.jsx("td",{className:"px-4 py-2 align-middle text-right",children:a.jsx(Zi,{to:`/ipd/admission/${B.id}`,state:{admission:B},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})})]},B.id)})})]})}),a.jsx("div",{className:"space-y-2 p-3 md:hidden",children:I.map(B=>{const V=r[B.current_bed_id],K=(V==null?void 0:V.code)||"",z=l[B.patient_id]||`P-${B.patient_id}`;return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:j(B.id)}),a.jsx(Zi,{to:`/ipd/admission/${B.id}`,state:{admission:B},className:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1 text-[11px] font-semibold text-white shadow-sm transition hover:bg-slate-800",children:"Open"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium",children:z})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-slate-800",children:[a.jsx(Ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium",children:K}),(V==null?void 0:V.state)&&a.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${S(V.state)}`,children:V.state})]}),a.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[a.jsx(Ys,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),a.jsx("div",{className:"text-[11px]",children:B.admitted_at?new Date(B.admitted_at).toLocaleString():""})]})]})]})]},B.id)})}),A.length>0&&a.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[a.jsxs("button",{type:"button",onClick:D,disabled:R,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[a.jsx(yx,{className:"h-4 w-4"}),"Prev"]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",a.jsx("span",{className:"font-medium text-slate-900",children:b})," ","of ",k]}),a.jsxs("button",{type:"button",onClick:O,disabled:P,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",a.jsx(Nh,{className:"h-4 w-4"})]})]})]})]})]})}const MN=10;function ode(){const[t,n]=y.useState([]),[s,r]=y.useState({}),[i,l]=y.useState({}),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,m]=y.useState(""),[x,b]=y.useState(1),w=L=>`ADM-${String(L).padStart(6,"0")}`,j=async()=>{var L,$;c(!0),u("");try{const[B,V]=await Promise.all([_x({status:"discharged"}),el()]),K=B.data||[],z=V.data||[];K.sort((J,ee)=>new Date(ee.discharged_at||ee.admitted_at||0)-new Date(J.discharged_at||J.admitted_at||0)),n(K);const H={};for(const J of z)H[J.id]=J;r(H);const Y=[...new Set(K.map(J=>J.patient_id))].slice(0,100),G={};await Promise.all(Y.map(async J=>{try{const{data:ee}=await Y3(J);G[J]=(ee==null?void 0:ee.uhid)||`P-${J}`}catch{G[J]=`P-${J}`}})),l(G),b(1)}catch(B){console.error("DischargedList loadData error",B),u((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to load discharged admissions. Please try again."),n([]),r({}),l({})}finally{c(!1)}};y.useEffect(()=>{let L=!0;return(async()=>await j())(),()=>{L=!1}},[]);const S=y.useMemo(()=>{const L=h.trim().toLowerCase();return L?t.filter($=>{var z;const B=w($.id).toLowerCase(),V=(i[$.patient_id]||`P-${$.patient_id}`).toLowerCase(),K=(((z=s[$.current_bed_id])==null?void 0:z.code)||"").toLowerCase();return B.includes(L)||V.includes(L)||K.includes(L)}):t},[t,h,i,s]),C=Math.max(1,Math.ceil(S.length/MN));y.useEffect(()=>{b(1)},[h,t]);const A=(x-1)*MN,k=S.slice(A,A+MN),T=()=>b(L=>Math.max(1,L-1)),I=()=>b(L=>Math.min(C,L+1)),D=x<=1||o,O=x>=C||o,R=t.length,P=L=>L?L==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":L==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":L==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":L==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200":"bg-slate-50 text-slate-700 border-slate-200";return a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[a.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Discharged Patients"}),a.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["This list shows all"," ",a.jsx("span",{className:"font-semibold",children:"completed in-patient admissions"})," ","that have been discharged. Use it for audit, reporting, medical record review, and follow-up planning. Search by admission number, patient UHID or bed code to quickly find a case."]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Discharged IP"}),a.jsx("br",{}),"Completed stays"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ps,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"Last bed"}),a.jsx("br",{}),"Ward / room / bed"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 shadow-sm",children:[a.jsx(Ys,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{className:"leading-tight",children:[a.jsx("span",{className:"font-medium text-slate-800",children:"LOS view"}),a.jsx("br",{}),"Admit vs discharge"]})]})]})]}),a.jsxs("div",{className:"mx-auto max-w-6xl space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"w-full md:max-w-md",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by Admission no, UHID, Bed code",value:h,onChange:L=>m(L.target.value)})]}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Tip: Example search  ",a.jsx("span",{className:"font-mono",children:"ADM-000245"}),","," ","a UHID, or a bed code like"," ",a.jsx("span",{className:"font-mono",children:"IP-2B-05"}),"."]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[a.jsxs("div",{className:"text-xs text-slate-600",children:[a.jsx("span",{className:"font-semibold text-slate-900",children:S.length})," ","of ",R," discharged admissions"]}),a.jsxs("button",{type:"button",onClick:j,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?a.jsx(nn,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(ji,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:d})]}),o&&!t.length&&a.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading discharged admissions"]})}),!o&&k.length===0&&a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No discharged records found."}),!o&&k.length>0&&a.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-xs text-slate-500",children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admission"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Patient (UHID)"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Bed"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Admitted at"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium",children:"Status"})]})}),a.jsx("tbody",{children:k.map(L=>{const $=s[L.current_bed_id],B=($==null?void 0:$.code)||"",V=i[L.patient_id]||`P-${L.patient_id}`;return a.jsxs("tr",{className:"border-t text-sm hover:bg-slate-50",children:[a.jsx("td",{className:"px-4 py-2 align-middle text-slate-900",children:a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-slate-800",children:w(L.id)})}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-800",children:V}),a.jsxs("td",{className:"px-4 py-2 align-middle text-slate-800",children:[B,($==null?void 0:$.state)&&a.jsx("span",{className:`ml-1 inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${P($.state)}`,children:$.state})]}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:L.admitted_at?new Date(L.admitted_at).toLocaleString():""}),a.jsx("td",{className:"px-4 py-2 align-middle text-slate-700",children:a.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-0.5 text-[11px] font-semibold text-emerald-700",children:L.status||"discharged"})})]},L.id)})})]})}),a.jsx("div",{className:"space-y-2 p-3 md:hidden",children:k.map(L=>{const $=s[L.current_bed_id],B=($==null?void 0:$.code)||"",V=i[L.patient_id]||`P-${L.patient_id}`;return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-1 flex items-center justify-between gap-2",children:[a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 px-2.5 py-0.5 text-[11px] font-semibold tracking-wide text-white",children:w(L.id)}),a.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-semibold text-emerald-700",children:L.status||"discharged"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium",children:V})]}),a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(Ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium",children:B}),($==null?void 0:$.state)&&a.jsx("span",{className:`inline-flex items-center rounded-full border px-1.5 py-0.5 text-[10px] ${P($.state)}`,children:$.state})]}),a.jsxs("div",{className:"flex items-start gap-2 text-slate-700",children:[a.jsx(Ys,{className:"mt-0.5 h-3.5 w-3.5 text-slate-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:"Admitted at"}),a.jsx("div",{className:"text-[11px]",children:L.admitted_at?new Date(L.admitted_at).toLocaleString():""})]})]})]})]},L.id)})}),S.length>0&&a.jsxs("div",{className:"flex flex-col items-center justify-between gap-3 border-t border-slate-100 px-4 py-3 text-xs text-slate-600 sm:flex-row",children:[a.jsxs("button",{type:"button",onClick:T,disabled:D,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:[a.jsx(yx,{className:"h-4 w-4"}),"Prev"]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Page"," ",a.jsx("span",{className:"font-medium text-slate-900",children:x})," ","of ",C]}),a.jsxs("button",{type:"button",onClick:I,disabled:O,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 font-medium shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:["Next",a.jsx(Nh,{className:"h-4 w-4"})]})]})]})]})]})}function cde(){const[t,n]=y.useState([]),[s,r]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,m]=y.useState(null),[x,b]=y.useState(""),[w,j]=y.useState(!1),[S,C]=y.useState(""),A=async()=>{var $,B;c(!0),u("");try{const[V,K,z]=await Promise.all([Db(),Sx(),el()]);n(V.data||[]),r(K.data||[]),l(z.data||[])}catch(V){u(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Failed to load bedboard.")}finally{c(!1)}};y.useEffect(()=>{A()},[]);const k=y.useMemo(()=>{const $={};return s.forEach(B=>{var V;($[V=B.ward_id]||($[V]=[])).push(B)}),$},[s]),T=y.useMemo(()=>{const $={};return i.forEach(B=>{var V;($[V=B.room_id]||($[V]=[])).push(B)}),$},[i]),I=({s:$})=>{const B=$==="vacant"?"bg-emerald-50 text-emerald-700 border-emerald-200":$==="occupied"?"bg-rose-50 text-rose-700 border-rose-200":$==="reserved"?"bg-amber-50 text-amber-700 border-amber-200":$==="preoccupied"?"bg-sky-50 text-sky-700 border-sky-200":"bg-slate-50 text-slate-700 border-slate-200";return a.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] capitalize ${B}`,children:$||"unknown"})},D=$=>$==="vacant"?"border-emerald-200 bg-emerald-50/60":$==="occupied"?"border-rose-200 bg-rose-50/70":$==="reserved"?"border-amber-200 bg-amber-50/70":$==="preoccupied"?"border-sky-200 bg-sky-50/70":"border-slate-200 bg-white",O=($,B,V)=>{m({id:$,code:B,action:V,dt:"",note:""}),C("")},R=async()=>{var $,B;if(h){if(C(""),h.action==="reserved"&&!h.dt){C('Please select a "Reserved until" date & time.');return}try{j(!0);const V={state:h.action};h.action==="reserved"&&(V.reserved_until=h.dt?h.dt.length===16?`${h.dt}:00`:h.dt:null),h.note&&(V.note=h.note),await yce(h.id,V),m(null),await A()}catch(V){C(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Failed to update bed state.")}finally{j(!1)}}},P=x.trim().toLowerCase(),L=y.useMemo(()=>{if(!P)return t.map(B=>B.id);const $=new Set;return t.forEach(B=>{var H,Y;const V=((H=B.code)==null?void 0:H.toLowerCase().includes(P))||((Y=B.name)==null?void 0:Y.toLowerCase().includes(P)),K=k[B.id]||[];let z=V;K.forEach(G=>{const J=String(G.number||"").toLowerCase().includes(P)||String(G.type||"").toLowerCase().includes(P),ye=(T[G.id]||[]).some(ie=>{var be;const he=(ie.state||"").toLowerCase();return((be=ie.code)==null?void 0:be.toLowerCase().includes(P))||he.includes(P)});(J||ye)&&(z=!0)}),z&&$.add(B.id)}),Array.from($)},[P,t,k,T]);return a.jsxs("div",{className:"min-h-screen bg-slate-50 px-4 py-4 text-black md:px-6 md:py-6",children:[a.jsxs("div",{className:"mx-auto mb-4 flex max-w-6xl flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold tracking-tight text-slate-900",children:"Bedboard"}),a.jsxs("p",{className:"mt-1 max-w-2xl text-sm text-slate-600",children:["Live overview of ",a.jsx("span",{className:"font-semibold",children:"IPD bed occupancy"})," ","by ward and room. Colours help you quickly spot which beds are vacant, occupied, reserved or preoccupied. Use the quick actions to reserve or vacate beds in real time."]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] md:grid-cols-4",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-emerald-200 bg-emerald-50 px-2.5 py-1.5 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),a.jsxs("span",{className:"leading-tight text-emerald-800",children:[a.jsx("span",{className:"font-semibold",children:"Vacant"}),a.jsx("br",{}),"Ready to allocate"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-rose-200 bg-rose-50 px-2.5 py-1.5 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-rose-500"}),a.jsxs("span",{className:"leading-tight text-rose-800",children:[a.jsx("span",{className:"font-semibold",children:"Occupied"}),a.jsx("br",{}),"Patient in bed"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-amber-200 bg-amber-50 px-2.5 py-1.5 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-amber-500"}),a.jsxs("span",{className:"leading-tight text-amber-800",children:[a.jsx("span",{className:"font-semibold",children:"Reserved"}),a.jsx("br",{}),"Booked for patient"]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-sky-200 bg-sky-50 px-2.5 py-1.5 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-sky-500"}),a.jsxs("span",{className:"leading-tight text-sky-800",children:[a.jsx("span",{className:"font-semibold",children:"Preoccupied"}),a.jsx("br",{}),"Pending admission"]})]})]})]}),a.jsxs("div",{className:"mx-auto max-w-6xl space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white p-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"w-full md:max-w-md",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx("input",{className:"w-full rounded-2xl border border-slate-200 bg-white px-9 py-2 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Search by ward, room, bed code or state (vacant, occupied, reserved)",value:x,onChange:$=>b($.target.value)})]}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Example: type ",a.jsx("span",{className:"font-mono",children:"VACANT"}),", ward code like"," ",a.jsx("span",{className:"font-mono",children:"W1"}),", or bed code like"," ",a.jsx("span",{className:"font-mono",children:"B-102"}),"."]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 md:justify-end",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-1.5 text-[11px] text-slate-700",children:[a.jsx(Ps,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsxs("span",{children:["Total beds:"," ",a.jsx("span",{className:"font-semibold text-slate-900",children:i.length})]})]}),a.jsxs("button",{type:"button",onClick:A,className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm transition hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:o,children:[o?a.jsx(nn,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(ji,{className:"h-3.5 w-3.5"}),"Refresh"]})]})]}),d&&a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:d})]}),o&&!i.length&&a.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white px-4 py-10 text-sm text-slate-600 shadow-sm",children:a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-xs",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin text-slate-500"}),"Loading bedboard"]})}),!o&&a.jsxs("div",{className:"space-y-4",children:[t.filter($=>L.includes($.id)).map($=>a.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 border-b border-slate-100 bg-slate-50 px-3 py-2 text-sm font-semibold text-slate-900",children:[a.jsx(Ya,{className:"h-4 w-4 text-slate-500"}),a.jsxs("span",{children:[$.code,"  ",$.name]})]}),(k[$.id]||[]).length===0?a.jsx("div",{className:"px-3 py-3 text-sm text-slate-500",children:"No rooms configured for this ward."}):(k[$.id]||[]).map(B=>{var K;const V=(T[B.id]||[]).filter(z=>{var Y;if(!P)return!0;const H=(z.state||"").toLowerCase();return((Y=z.code)==null?void 0:Y.toLowerCase().includes(P))||H.includes(P)});return!V.length&&P&&!(String(B.number||"").toLowerCase().includes(P)||String(B.type||"").toLowerCase().includes(P))?null:a.jsxs("div",{className:"border-t border-slate-100 px-3 py-3",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2 text-xs text-slate-600",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(t7,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"font-medium",children:["Room ",B.number]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[" ",B.type]})]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["Beds: ",((K=T[B.id])==null?void 0:K.length)||0]})]}),V.length===0?a.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 px-3 py-3 text-xs text-slate-500",children:"No beds match your search in this room."}):a.jsx("div",{className:"flex flex-wrap gap-2",children:V.map(z=>a.jsxs("div",{className:`flex w-full flex-col justify-between rounded-2xl border px-3 py-2 text-xs shadow-sm transition hover:-translate-y-0.5 hover:shadow-md sm:w-[calc(50%-0.25rem)] lg:w-[calc(25%-0.375rem)] ${D(z.state)}`,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"font-semibold text-slate-900",children:z.code}),a.jsx(I,{s:z.state})]}),z.note&&a.jsx("div",{className:"mt-1 text-[11px] text-slate-600 line-clamp-2",children:z.note}),z.reserved_until&&a.jsxs("div",{className:"mt-1 text-[11px] text-slate-500",children:["Reserved until:"," ",new Date(z.reserved_until).toLocaleString()]}),a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[a.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-amber-50 px-2 py-1 text-[11px] font-medium text-amber-800 ring-1 ring-amber-200 hover:bg-amber-100",onClick:()=>O(z.id,z.code,"reserved"),children:"Reserve"}),a.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-sky-50 px-2 py-1 text-[11px] font-medium text-sky-800 ring-1 ring-sky-200 hover:bg-sky-100",onClick:()=>O(z.id,z.code,"preoccupied"),children:"Preoccupy"}),a.jsx("button",{type:"button",className:"inline-flex flex-1 items-center justify-center rounded-full bg-emerald-50 px-2 py-1 text-[11px] font-medium text-emerald-800 ring-1 ring-emerald-200 hover:bg-emerald-100",onClick:()=>O(z.id,z.code,"vacant"),children:"Vacate"})]})]},z.id))})]},B.id)})]},$.id)),!o&&L.length===0&&a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500 shadow-sm",children:"No beds match your search. Try clearing the filter or searching with a different ward, room or bed code."})]})]}),h&&a.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40 px-4",children:a.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-4 text-sm shadow-xl",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Update bed state"}),a.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[h.code,"  ",h.action]})]}),a.jsx(I,{s:h.action})]}),h.action==="reserved"&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Reserved until"}),a.jsx("input",{type:"datetime-local",className:"input w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",value:h.dt,onChange:$=>m(B=>({...B,dt:$.target.value}))})]}),a.jsxs("div",{className:"mt-3 space-y-1",children:[a.jsx("label",{className:"text-xs text-slate-500",children:"Note (optional)"}),a.jsx("input",{className:"input w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm focus:border-sky-500 focus:ring-2 focus:ring-sky-100",placeholder:"Reason for change, patient reference, etc.",value:h.note,onChange:$=>m(B=>({...B,note:$.target.value}))})]}),S&&a.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:[a.jsx(Ms,{className:"mt-0.5 h-4 w-4"}),a.jsx("span",{children:S})]}),a.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-200",onClick:()=>m(null),disabled:w,children:"Cancel"}),a.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",onClick:R,disabled:w,children:[w?a.jsx(nn,{className:"h-3.5 w-3.5 animate-spin"}):a.jsx(zr,{className:"h-3.5 w-3.5"}),"Save"]})]})]})})]})}const a9=({q:t="",active:n,page:s=1,page_size:r=50}={})=>ne.get("/masters/lab-tests",{params:{q:t,active:n,page:s,page_size:r}}),dde=t=>ne.post("/masters/lab-tests",t),ude=(t,n)=>ne.put(`/masters/lab-tests/${t}`,n),fde=t=>ne.delete(`/masters/lab-tests/${t}`),hde=({patient_id:t,context_type:n=null,context_id:s=null,priority:r="routine",test_ids:i=[]})=>{const l=(i||[]).map(o=>({test_id:o}));return ne.post("/lab/orders",{patient_id:t,context_type:n,context_id:s,priority:r,items:l})},mde=(t={})=>ne.get("/lab/orders",{params:t}),pde=t=>ne.get(`/lab/orders/${t}`),xde=t=>ne.post(`/lab/orders/${t}/finalize`);function gde(t={}){return ne.get("/lis/masters/departments",{params:t})}function yde(t,{department_id:n,sub_department_id:s}={}){const r={department_id:n};return s&&(r.sub_department_id=s),ne.get(`/lab/orders/${t}/panel`,{params:r})}function bde(t,n){return ne.post(`/lab/orders/${t}/panel/results`,n)}function vde(t){return ne.get(`/lab/orders/${t}/report-data`)}function Op({patient:t,patientId:n,className:s=""}){const[r,i]=y.useState(t||null);y.useEffect(()=>{let u=!1;return!t&&n&&(async()=>{try{const{data:h}=await ne.get(`/patients/${n}`);u||i(h)}catch{}})(),()=>{u=!0}},[t,n]);const l=(r==null?void 0:r.uhid)||"",o=(r==null?void 0:r.name)||(r!=null&&r.first_name?`${r.first_name} ${r.last_name||""}`.trim():""),c=r!=null&&r.id?`/patients?focus=${r.id}`:void 0,d=a.jsxs("span",{className:["inline-flex items-center gap-2 rounded-md border px-2 py-0.5 text-xs","bg-gray-50 border-gray-200 text-gray-700","max-w-[18rem]",s].join(" "),title:o!==""?o:void 0,children:[a.jsx("span",{className:"font-medium",children:l}),a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("span",{className:"truncate",children:o})]});return c?a.jsx(Zi,{to:c,children:d}):d}const wde=t=>t?new Date(t).toLocaleString():"",Nde=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function jde(){const{id:t}=Tu(),n=Aa(),[s,r]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState([]),[h,m]=y.useState([]),[x,b]=y.useState(!1),w=y.useMemo(()=>i?Nde(i.id):"",[i]),j=async()=>{r(!0);try{const{data:L}=await pde(t);l(L)}catch(L){console.error(L),xe.error("Failed to load order")}finally{r(!1)}},S=async()=>{try{const{data:L}=await gde({active_only:!0}),$=Array.isArray(L)?L:(L==null?void 0:L.items)||[];c($)}catch(L){console.error(L),xe.error("Failed to load lab departments")}};y.useEffect(()=>{j(),S()},[t]);const C=y.useMemo(()=>{const L=o.filter(B=>!B.parent_id),$={};return o.forEach(B=>{B.parent_id&&($[B.parent_id]||($[B.parent_id]=[]),$[B.parent_id].push(B))}),L.map(B=>({...B,children:$[B.id]||[]}))},[o]),A=y.useMemo(()=>i?(i.status||"").toLowerCase()!=="reported":!1,[i]),k=async()=>{var L,$;try{await xde(t),xe.success("Report finalized"),j()}catch(B){console.error(B),xe.error((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Finalize failed")}},T=()=>{n(`/lab/orders/${t}/print`)},I=(L,$=null)=>{const B=`${L}::${$||"root"}`;return d.some(V=>V.key===B)},D=(L,$=null,B="",V=null)=>{const K=`${L}::${$||"root"}`;u(z=>z.some(Y=>Y.key===K)?z.filter(Y=>Y.key!==K):[...z,{key:K,department_id:L,department_name:B,sub_department_id:$,sub_department_name:V}])},O=async()=>{var L,$;if(!d.length){xe.error("Select at least one Department / Panel");return}b(!0);try{const B=d.map(z=>yde(t,{department_id:z.department_id,sub_department_id:z.sub_department_id||void 0}).then(H=>({panel:z,rows:Array.isArray(H.data)?H.data:[]}))),K=(await Promise.all(B)).map(({panel:z,rows:H})=>({key:z.key,department_id:z.department_id,department_name:z.department_name,sub_department_id:z.sub_department_id,sub_department_name:z.sub_department_name,rows:H.map(Y=>({...Y,result_value:Y.result_value??"",flag:Y.flag??"",comments:Y.comments??""}))}));m(K)}catch(B){console.error(B),xe.error((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to load panel services")}finally{b(!1)}},R=(L,$,B)=>{m(V=>V.map(K=>K.key!==L?K:{...K,rows:K.rows.map((z,H)=>H===$?{...z,...B}:z)}))},P=async()=>{var L,$;if(!h.length){xe.error("No panel rows loaded");return}try{for(const B of h){if(!B.rows.length)continue;const V={department_id:Number(B.department_id),sub_department_id:B.sub_department_id?Number(B.sub_department_id):null,results:B.rows.map(K=>({service_id:K.service_id,result_value:K.result_value??"",flag:K.flag||null,comments:K.comments||null}))};await bde(Number(t),V)}xe.success("Panel results saved"),j()}catch(B){console.error(B),xe.error((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to save panel results")}};return s&&!i?a.jsx("div",{className:"p-6",children:"Loading"}):i?a.jsxs("div",{className:"p-3 md:p-6 space-y-6 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-start justify-between gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("h1",{className:"text-lg md:text-xl font-semibold",children:["Lab Order ",w]}),a.jsxs("div",{className:"text-xs text-gray-500 flex flex-wrap items-center gap-2",children:[a.jsx(Op,{patient:i==null?void 0:i.patient,patientId:i==null?void 0:i.patient_id,className:"border-blue-100 bg-blue-50"}),a.jsxs("span",{children:[" Created: ",wde(i.created_at||i.createdAt)]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Priority:"," ",a.jsx("span",{className:"capitalize font-medium",children:i.priority||"routine"})," "," Status:"," ",a.jsx("span",{className:"uppercase font-semibold",children:i.status||"ORDERED"})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("button",{className:"btn-ghost flex items-center gap-1 text-xs md:text-sm",onClick:T,children:[a.jsx(Rc,{className:"h-4 w-4"}),"View / Print Report"]}),a.jsx(ta,{anyOf:["lab.results.report","lab.results.enter","lab.results.approve"],children:a.jsxs("button",{className:"btn",disabled:!A,onClick:k,children:[a.jsx(d3,{className:"h-4 w-4 mr-2"})," Finalize"]})})]})]}),a.jsxs("section",{className:"rounded-xl border bg-white overflow-hidden",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 p-4 border-b",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(n7,{className:"h-4 w-4 text-gray-500"}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-semibold text-sm md:text-base",children:"Result Entry (Multi Department / Panel)"}),a.jsx("p",{className:"text-[11px] text-gray-500",children:"Select department/panel, enter all values, save, then finalize."})]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsxs("button",{className:"btn-ghost flex items-center gap-1",onClick:O,children:[a.jsx(Ste,{className:"h-4 w-4"}),"Start Entry"]}),a.jsx(ta,{anyOf:["lab.results.enter"],children:a.jsx("button",{className:"btn",onClick:P,disabled:!h.length,children:"Save Panel Results"})})]})]}),a.jsxs("div",{className:"p-4 border-b bg-slate-50",children:[a.jsx("h3",{className:"text-sm font-medium mb-1",children:"Select Departments & Panels"}),a.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Tick one or more Departments / Sub-Departments. All selected tests will appear below, grouped heading-wise."}),a.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-lg border bg-white p-3 space-y-2",children:[C.length===0&&a.jsx("div",{className:"text-xs text-gray-400",children:"No lab departments configured."}),C.map(L=>a.jsxs("div",{className:"border rounded-lg p-2 bg-slate-50/60",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[a.jsx("input",{type:"checkbox",checked:I(L.id,null),onChange:()=>D(L.id,null,L.name,null)}),a.jsx("span",{children:L.name}),a.jsx("span",{className:"text-[11px] text-gray-400",children:"(All tests in this department)"})]}),!!L.children.length&&a.jsx("div",{className:"mt-2 pl-4 space-y-1",children:L.children.map($=>a.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-700",children:[a.jsx("input",{type:"checkbox",checked:I(L.id,$.id),onChange:()=>D(L.id,$.id,L.name,$.name)}),a.jsx("span",{children:$.name})]},$.id))})]},L.id))]}),a.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:["Selected panels:"," ",a.jsx("span",{className:"font-semibold",children:d.length||0})]})]}),x&&a.jsx("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:"Loading selected panels"}),!x&&h.length===0&&a.jsxs("div",{className:"px-4 py-6 text-center text-xs text-gray-400",children:["Select one or more Departments / Panels above and click"," ",a.jsx("span",{className:"font-medium",children:"Start Entry"})," to load tests."]}),!x&&h.map(L=>a.jsxs("div",{className:"border-t",children:[a.jsxs("div",{className:"bg-slate-100 px-3 py-2 text-xs font-semibold text-slate-700",children:[L.department_name,L.sub_department_name?` / ${L.sub_department_name}`:""]}),a.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[L.rows.length===0&&a.jsx("div",{className:"text-xs text-gray-400",children:"No services configured for this panel."}),L.rows.map(($,B)=>a.jsxs("div",{className:"border rounded-lg p-2 space-y-1 bg-white",children:[a.jsx("div",{className:"text-xs font-semibold",children:$.service_name}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-gray-600",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Result"}),a.jsx("input",{className:"input h-7 text-xs",value:$.result_value,onChange:V=>R(L.key,B,{result_value:V.target.value})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Flag"}),a.jsx("input",{className:"input h-7 text-xs",placeholder:"H/L/N",value:$.flag||"",onChange:V=>R(L.key,B,{flag:V.target.value.toUpperCase()})})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Unit"}),a.jsx("div",{className:"text-[11px]",children:$.unit||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Normal Range"}),a.jsx("div",{className:"text-[11px]",children:$.normal_range||""})]})]})]}),a.jsxs("div",{className:"mt-1",children:[a.jsx("div",{className:"text-[10px] uppercase text-gray-400",children:"Comments"}),a.jsx("input",{className:"input h-7 text-xs",placeholder:"Comments",value:$.comments||"",onChange:V=>R(L.key,B,{comments:V.target.value})})]})]},$.service_id))]}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Service"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Result"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Unit"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Normal Range"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Flag"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Comments"})]})}),a.jsxs("tbody",{children:[L.rows.map(($,B)=>a.jsxs("tr",{className:"border-t hover:bg-slate-50/80",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("div",{className:"font-medium",children:$.service_name})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{className:"input",value:$.result_value,onChange:V=>R(L.key,B,{result_value:V.target.value})})}),a.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:$.unit||""}),a.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:$.normal_range||""}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{className:"input",placeholder:"Flag (H/L/N)",value:$.flag||"",onChange:V=>R(L.key,B,{flag:V.target.value.toUpperCase()})})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{className:"input",placeholder:"Comments",value:$.comments||"",onChange:V=>R(L.key,B,{comments:V.target.value})})})]},$.service_id)),L.rows.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-xs text-gray-400",children:"No services configured for this panel."})})]})]})})]},L.key))]})]}):a.jsx("div",{className:"p-6",children:"Order not found"})}function Sde(){const[t,n]=y.useState(""),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(!1),h=async()=>{l(!0);try{const{data:S}=await a9({q:t,page_size:200});r(S||[])}catch{xe.error("Failed to load tests")}finally{l(!1)}};y.useEffect(()=>{h()},[t]);const m=()=>{c({code:"",name:"",price:0,is_active:!0}),u(!0)},x=S=>{c({...S}),u(!0)},b=async()=>{var S,C;try{o!=null&&o.id?(await ude(o.id,o),xe.success("Updated")):(await dde(o),xe.success("Created")),u(!1),h()}catch(A){xe.error(((C=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:C.detail)||"Save failed")}},w=async S=>{if(confirm("Delete this test?"))try{await fde(S),xe.success("Deleted"),h()}catch{xe.error("Delete failed")}},j=y.useMemo(()=>s.length,[s]);return a.jsxs("div",{className:"p-4 md:p-6 text-black",children:[a.jsxs("header",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Lab Masters"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Manage NABL-friendly test catalogue"})]}),a.jsx(ta,{anyOf:["lab.masters.manage","masters.lab.manage"],children:a.jsxs("button",{className:"btn-primary",onClick:m,children:[a.jsx(Nn,{className:"h-4 w-4 mr-2"})," New Test"]})})]}),a.jsx("div",{className:"mb-3",children:a.jsxs("div",{className:"relative max-w-md",children:[a.jsx(jn,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search code/name",value:t,onChange:S=>n(S.target.value)})]})}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Active"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!i&&s.map(S=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:S.code}),a.jsx("td",{className:"px-3 py-2",children:S.name}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["",Number(S.price||0).toFixed(2)]}),a.jsx("td",{className:"px-3 py-2",children:S.is_active?"Yes":"No"}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsxs(ta,{anyOf:["lab.masters.manage","masters.lab.manage"],children:[a.jsx("button",{className:"btn-ghost mr-2",onClick:()=>x(S),children:a.jsx(Xa,{className:"h-4 w-4"})}),a.jsx("button",{className:"btn-ghost text-red-600",onClick:()=>w(S.id),children:a.jsx(Wr,{className:"h-4 w-4"})})]})})]},S.id)),!i&&s.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]}),a.jsx("tfoot",{children:a.jsx("tr",{children:a.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:5,children:["Total: ",j]})})})]})}),d&&a.jsxs("div",{className:"fixed inset-0 z-40",children:[a.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>u(!1)}),a.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl p-4 overflow-y-auto",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:o!=null&&o.id?"Edit Test":"New Test"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Code"}),a.jsx("input",{className:"input",value:(o==null?void 0:o.code)||"",onChange:S=>c(C=>({...C,code:S.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Name"}),a.jsx("input",{className:"input",value:(o==null?void 0:o.name)||"",onChange:S=>c(C=>({...C,name:S.target.value}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm",children:"Price"}),a.jsx("input",{type:"number",step:"0.01",className:"input",value:(o==null?void 0:o.price)??0,onChange:S=>c(C=>({...C,price:parseFloat(S.target.value||0)}))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"active",type:"checkbox",checked:!!(o!=null&&o.is_active),onChange:S=>c(C=>({...C,is_active:S.target.checked}))}),a.jsx("label",{htmlFor:"active",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-3",children:[a.jsx("button",{className:"btn-ghost",onClick:()=>u(!1),children:"Cancel"}),a.jsx("button",{className:"btn-primary",onClick:b,children:"Save"})]})]})]})]})]})}const i9=({q:t="",active:n,page:s=1,page_size:r=50}={})=>ne.get("/ris/masters/tests",{params:{q:t,active:n,page:s,page_size:r}}),_de=t=>ne.post("/ris/masters/tests",t),Cde=(t,n)=>ne.put(`/ris/masters/tests/${t}`,n),Ade=t=>ne.delete(`/ris/masters/tests/${t}`),kde=({patient_id:t,test_id:n,context_type:s=null,context_id:r=null,ordering_user_id:i=null,priority:l="routine"})=>ne.post("/ris/orders",{patient_id:t,test_id:n,context_type:s,context_id:r,ordering_user_id:i,priority:l}),Ede=(t={})=>ne.get("/ris/orders",{params:t}),Tde=t=>ne.get(`/ris/orders/${t}`),Ide=(t,{scheduled_at:n})=>ne.post(`/ris/orders/${t}/schedule`,{scheduled_at:n}),Pde=t=>ne.post(`/ris/orders/${t}/scan`),Mde=(t,{report_text:n})=>ne.post(`/ris/orders/${t}/report`,{report_text:n}),Ode=(t,{report_text:n})=>ne.put(`/ris/orders/${t}/report`,{report_text:n}),Dde=t=>ne.post(`/ris/orders/${t}/approve`),Rde=(t,n,s="")=>ne.post(`/ris/attachments/${t}`,{file_url:n,note:s}),Lde=(t,n)=>{const s=new FormData;return s.append("file",n),ne.post(`/ris/orders/${t}/upload`,s,{headers:{"Content-Type":"multipart/form-data"}})};function J3({order:t,to:n,className:s="",prefix:r="LAB"}){const i=new Date((t==null?void 0:t.created_at)||(t==null?void 0:t.createdAt)||Date.now()),l=i.toISOString().slice(2,7).replace("-",""),o=Number((t==null?void 0:t.id)||0).toString(36).toUpperCase().padStart(3,"0"),c=`${r}-${l}-${o}`,d=(t==null?void 0:t.accession_no)||c,u=a.jsx("span",{className:["inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium","bg-blue-50 border-blue-200 text-blue-700",s].join(" "),title:`Created ${i.toLocaleString()}`,children:d});return n?a.jsx(Zi,{to:n,children:u}):u}function B1({status:t}){const n=String(t||"ordered").toLowerCase(),r={ordered:"bg-amber-50 text-amber-700 border-amber-200",collected:"bg-blue-50 text-blue-700 border-blue-200",validated:"bg-purple-50 text-purple-700 border-purple-200",reported:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"}[n]||"bg-gray-50 text-gray-700 border-gray-200";return a.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${r}`,children:n.charAt(0).toUpperCase()+n.slice(1)})}function l9({modality:t}){const n=String(t||"").toUpperCase(),r={XR:"bg-sky-50 text-sky-700 border-sky-200",CT:"bg-purple-50 text-purple-700 border-purple-200",MRI:"bg-indigo-50 text-indigo-700 border-indigo-200",USG:"bg-emerald-50 text-emerald-700 border-emerald-200",MAMMO:"bg-rose-50 text-rose-700 border-rose-200"}[n]||"bg-gray-50 text-gray-700 border-gray-200";return a.jsx("span",{className:`inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-medium ${r}`,children:n||""})}function Rb({value:t,onChange:n,label:s="Patient"}){const[r,i]=y.useState(""),[l,o]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState(null);y.useEffect(()=>{let x=!0;if(!r){o([]);return}return d(!0),Z3(r).then(b=>{x&&o(b.data||[])}).catch(()=>{x&&o([])}).finally(()=>{x&&d(!1)}),()=>{x=!1}},[r]),y.useEffect(()=>{if(!t){h(null);return}const x=l.find(b=>b.id===t);x&&h(x)},[t,l]);const m=x=>{h(x),i(""),o([]),n==null||n(x.id,x)};return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:s}),a.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:r,onChange:x=>i(x.target.value)}),c&&a.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),l.length>0&&a.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:l.map(x=>a.jsx("button",{type:"button",onClick:()=>m(x),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:[x.first_name," ",x.last_name]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",x.uhid,"  ",x.phone]})]})},x.id))}),u&&a.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:["Selected:"," ",a.jsxs("span",{className:"font-semibold",children:[u.first_name," ",u.last_name]})," "," UHID ",u.uhid,"  ",u.phone]})]})}function Bde({onClose:t,onCreated:n}){const[s,r]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,m]=y.useState("routine"),[x,b]=y.useState("");y.useEffect(()=>{let j=!1;return(async()=>{const{data:C}=await i9({q:o});j||l(Array.isArray(C)?C:(C==null?void 0:C.items)||[])})(),()=>{j=!0}},[o]);const w=async()=>{var j,S;if(!s)return xe.error("Select a patient");if(!x)return xe.error("Select a test");u(!0);try{const{data:C}=await kde({patient_id:s,test_id:Number(x),priority:h});xe.success(`Order #${C==null?void 0:C.id} created`),n==null||n(C),t==null||t()}catch(C){xe.error(((S=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:S.detail)||"Failed to create order")}finally{u(!1)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Create Radiology Order"}),a.jsx(Rb,{value:s,onChange:r}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"md:col-span-2 space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Test"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{className:"input",placeholder:"Search tests",value:o,onChange:j=>c(j.target.value)}),a.jsxs("select",{className:"input",value:x,onChange:j=>b(j.target.value),children:[a.jsx("option",{value:"",children:"Select"}),i.map(j=>a.jsxs("option",{value:j.id,children:[j.code,"  ",j.name," ",j.modality?`(${j.modality})`:""]},j.id))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Priority"}),a.jsxs("select",{className:"input",value:h,onChange:j=>m(j.target.value),children:[a.jsx("option",{value:"routine",children:"Routine"}),a.jsx("option",{value:"urgent",children:"Urgent"}),a.jsx("option",{value:"stat",children:"STAT"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[a.jsx("button",{className:"btn-ghost",onClick:t,children:"Cancel"}),a.jsx("button",{className:"btn",onClick:w,disabled:d,children:d?"Creating":"Create Order"})]})]})}function Fde({open:t,onClose:n,children:s}){return t?a.jsxs("div",{className:"fixed inset-0 z-[100] grid place-items-center bg-black/40 p-4",children:[a.jsx("div",{className:"w-full max-w-3xl rounded-2xl bg-white p-4 shadow-2xl",children:s}),a.jsx("button",{className:"absolute inset-0 -z-10",onClick:n,"aria-label":"Close"})]}):null}function $de(){const[t,n]=y.useState([]),[s,r]=y.useState(!0),[i,l]=y.useState(""),[o,c]=y.useState(!1);return y.useEffect(()=>{let d=!1;return(async()=>{var h,m;r(!0);try{const{data:x}=await Ede({q:i});d||n(Array.isArray(x)?x:[])}catch(x){xe.error(((m=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to load orders")}finally{d||r(!1)}})(),()=>{d=!0}},[i]),a.jsxs("div",{className:"space-y-5 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Radiology Orders"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Book, track, scan and report."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{className:"input w-60",placeholder:"Search test, UHID or name",value:i,onChange:d=>l(d.target.value)}),a.jsx(ta,{anyOf:["orders.ris.create","radiology.orders.create"],children:a.jsxs("button",{className:"btn",onClick:()=>c(!0),children:[a.jsx(Nn,{className:"h-4 w-4 mr-2"})," New Order"]})})]})]}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Order"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Patient"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Priority"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Created"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[s&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:7,children:"Loading"})}),!s&&t.map(d=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx(J3,{order:d,to:`/ris/orders/${d.id}`,prefix:"RAD"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(Op,{patientId:d.patient_id})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(l9,{modality:d.modality})}),a.jsx("td",{className:"px-3 py-2 capitalize",children:d.priority||"routine"}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(B1,{status:d.status})}),a.jsx("td",{className:"px-3 py-2",children:new Date(d.created_at).toLocaleString()}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsx(Zi,{to:`/ris/orders/${d.id}`,className:"btn-ghost",children:"View"})})]},d.id)),!s&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:7,children:"No orders"})})]})]})}),a.jsx(Fde,{open:o,onClose:()=>c(!1),children:a.jsx(Bde,{onClose:()=>c(!1),onCreated:()=>c(!1)})})]})}function zde({t,onEdit:n,onDelete:s}){return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:t.code}),a.jsx("td",{className:"px-3 py-2",children:t.name}),a.jsx("td",{className:"px-3 py-2",children:t.modality||""}),a.jsx("td",{className:"px-3 py-2",children:Number(t.price||0).toFixed(2)}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsxs(ta,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:[a.jsx("button",{className:"btn-ghost mr-2",onClick:()=>n(t),children:"Edit"}),a.jsx("button",{className:"btn-ghost text-rose-600",onClick:()=>s(t),children:"Delete"})]})})]})}function Ude(){const[t,n]=y.useState([]),[s,r]=y.useState(!0),[i,l]=y.useState(""),[o,c]=y.useState({code:"",name:"",modality:"",price:0}),[d,u]=y.useState(null),h=async()=>{var w,j;r(!0);try{const{data:S}=await i9({q:i,page_size:100});n(Array.isArray(S)?S:(S==null?void 0:S.items)||[])}catch(S){xe.error(((j=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to load")}finally{r(!1)}};y.useEffect(()=>{h()},[i]);const m=async()=>{var w,j;try{d?(await Cde(d,o),xe.success("Updated")):(await _de(o),xe.success("Created")),c({code:"",name:"",modality:"",price:0}),u(null),h()}catch(S){xe.error(((j=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:j.detail)||"Save failed")}},x=w=>{u(w.id),c({code:w.code,name:w.name,modality:w.modality||"",price:w.price||0})},b=async w=>{var j,S;if(window.confirm(`Delete ${w.code}?`))try{await Ade(w.id),xe.success("Deleted"),h()}catch(C){xe.error(((S=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:S.detail)||"Delete failed")}};return a.jsxs("div",{className:"space-y-5 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"RIS Masters"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Manage radiology tests & modalities."})]}),a.jsx("input",{className:"input w-60",placeholder:"Search code/name",value:i,onChange:w=>l(w.target.value)})]}),a.jsx(ta,{anyOf:["radiology.masters.manage","masters.ris.manage"],children:a.jsxs("div",{className:"rounded-2xl border bg-white p-4",children:[a.jsx("h3",{className:"text-sm font-semibold mb-3",children:d?"Edit Test":"New Test"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsx("input",{className:"input",placeholder:"Code",value:o.code,onChange:w=>c(j=>({...j,code:w.target.value}))}),a.jsx("input",{className:"input",placeholder:"Name",value:o.name,onChange:w=>c(j=>({...j,name:w.target.value}))}),a.jsx("input",{className:"input",placeholder:"Modality (XR/CT/MRI/USG)",value:o.modality,onChange:w=>c(j=>({...j,modality:w.target.value}))}),a.jsx("input",{className:"input",placeholder:"Price",type:"number",step:"0.01",value:o.price,onChange:w=>c(j=>({...j,price:w.target.value}))})]}),a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("button",{className:"btn",onClick:m,children:d?"Update":"Create"}),d&&a.jsx("button",{className:"btn-ghost",onClick:()=>{u(null),c({code:"",name:"",modality:"",price:0})},children:"Cancel"})]})]})}),a.jsx("div",{className:"rounded-xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Modality"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[s&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3",colSpan:5,children:"Loading"})}),!s&&t.map(w=>a.jsx(zde,{t:w,onEdit:x,onDelete:b},w.id)),!s&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:5,children:"No tests"})})]})]})})]})}const Zo=t=>t?new Date(t).toLocaleString():"";function Vde(){const{id:t}=Tu(),[n,s]=y.useState(null),[r,i]=y.useState(!0),[l,o]=y.useState(""),[c,d]=y.useState(""),[u,h]=y.useState(!1),[m,x]=y.useState([]),b=async()=>{var T,I;i(!0);try{const{data:D}=await Tde(t);s(D),d((D==null?void 0:D.report_text)||"")}catch(D){xe.error(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to load order")}finally{i(!1)}};y.useEffect(()=>{b()},[t]);const w=async()=>{var T,I;if(!l)return xe.error("Pick a date & time");try{await Ide(n.id,{scheduled_at:l}),xe.success("Scheduled"),b()}catch(D){xe.error(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to schedule")}},j=async()=>{var T,I;try{await Pde(n.id),xe.success("Marked scanned"),b()}catch(D){xe.error(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to mark scanned")}},S=async()=>{var T,I;h(!0);try{n.status==="reported"||n.status==="approved"?await Ode(n.id,{report_text:c}):await Mde(n.id,{report_text:c}),xe.success("Report saved"),b()}catch(D){xe.error(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to save report")}finally{h(!1)}},C=async()=>{var T,I;try{await Dde(n.id),xe.success("Report approved"),b()}catch(D){xe.error(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Approval failed")}},A=async T=>{var D,O,R;const I=(D=T.target.files)==null?void 0:D[0];if(I)try{const{data:P}=await Lde(n.id,I);x(L=>[{file_url:P==null?void 0:P.file_url,note:I.name},...L]),xe.success("Attachment uploaded")}catch(P){xe.error(((R=(O=P==null?void 0:P.response)==null?void 0:O.data)==null?void 0:R.detail)||"Upload failed")}finally{T.target.value=""}},k=async()=>{var I,D;const T=prompt("Paste file URL");if(T)try{const{data:O}=await Rde(n.id,T,"Link");x(R=>[{file_url:(O==null?void 0:O.file_url)||T,note:"Link"},...R]),xe.success("Attachment linked")}catch(O){xe.error(((D=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:D.detail)||"Link failed")}};return r?a.jsx("div",{children:"Loading"}):n?a.jsxs("div",{className:"space-y-6 text-black",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-semibold",children:["Radiology Order ",a.jsx(J3,{order:n,prefix:"RAD"})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Patient: ",a.jsx(Op,{patientId:n.patient_id}),"  Created: ",Zo(n.created_at)]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Modality: ",a.jsx(l9,{modality:n.modality}),"  Status: ",a.jsx(B1,{status:n.status})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ta,{anyOf:["radiology.report.create"],children:a.jsx("button",{className:"btn",onClick:S,disabled:u,children:u?"Saving":"Save Report"})}),a.jsx(ta,{anyOf:["radiology.report.approve"],children:a.jsxs("button",{className:"btn",onClick:C,children:[a.jsx(d3,{className:"h-4 w-4 mr-2"})," Approve"]})})]})]}),a.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-4",children:[a.jsx("h2",{className:"text-sm font-semibold",children:"Workflow"}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx(Ni,{className:"h-4 w-4"})," Schedule"]}),a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsx("input",{type:"datetime-local",className:"input w-full",value:l,onChange:T=>o(T.target.value)}),a.jsx(ta,{anyOf:["radiology.schedule.manage"],children:a.jsx("button",{className:"btn w-full",onClick:w,children:"Book Slot"})}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",Zo(n.scheduled_at)]})]})]}),a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsx("div",{className:"flex items-center gap-2 font-medium",children:"Scan"}),a.jsxs("div",{className:"mt-2 grid gap-2",children:[a.jsx(ta,{anyOf:["radiology.scan.update"],children:a.jsx("button",{className:"btn w-full",onClick:j,children:"Mark Scanned"})}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Scanned: ",Zo(n.scanned_at)]})]})]}),a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[a.jsx(iS,{className:"h-4 w-4"})," Attachments"]}),a.jsxs("div",{className:"mt-2 grid gap-2",children:[a.jsx("input",{type:"file",onChange:A}),a.jsx("button",{className:"btn-ghost text-left",onClick:k,children:"Add link"}),a.jsxs("div",{className:"mt-2 space-y-1",children:[m.map((T,I)=>a.jsx("a",{href:T.file_url,className:"text-xs text-blue-700 underline",target:"_blank",rel:"noreferrer",children:T.note||T.file_url},I)),m.length===0&&a.jsx("div",{className:"text-xs text-gray-500",children:"No attachments (local list)"})]})]})]})]})]}),a.jsxs("section",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold",children:"Report"}),a.jsx("textarea",{className:"input min-h-[200px]",placeholder:"Enter radiology report text",value:c,onChange:T=>d(T.target.value)}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-gray-600",children:[a.jsxs("div",{children:["Ordered: ",Zo(n.created_at)]}),a.jsxs("div",{children:["Scheduled: ",Zo(n.scheduled_at)]}),a.jsxs("div",{children:["Scanned: ",Zo(n.scanned_at)]}),a.jsxs("div",{children:["Reported: ",Zo(n.reported_at)]}),a.jsxs("div",{children:["Approved: ",Zo(n.approved_at)]})]})]})]}):a.jsx("div",{className:"text-sm text-gray-500",children:"Order not found"})}function Hde(t){return ne.post("/billing/invoices",t)}function Wde(t){return ne.get(`/billing/invoices/${t}`)}function qde(t={}){return ne.get("/billing/invoices",{params:t})}function Gde(t,n){return ne.put(`/billing/invoices/${t}`,n)}function Kde(t){return ne.post(`/billing/invoices/${t}/finalize`)}function Yde(t){return ne.post(`/billing/invoices/${t}/cancel`)}function BI(t,n){return ne.post(`/billing/invoices/${t}/items/manual`,n)}function Xde(t,n,s){return ne.put(`/billing/invoices/${t}/items/${n}`,s)}function Qde(t,n,s){return ne.post(`/billing/invoices/${t}/items/${n}/void`,s)}function Zde(t,n){return ne.post(`/billing/invoices/${t}/payments`,n)}function Jde(t,n){return ne.delete(`/billing/invoices/${t}/payments/${n}`)}function eue(t,n={}){return ne.post(`/billing/invoices/${t}/apply-advances`,n)}function eA(){return ne.get("/billing/masters")}function tue(t){return ne.get(`/billing/patients/${t}/summary`)}function nue(t){return ne.get(`/billing/invoices/${t}/print`,{responseType:"blob"})}function sue(t){return ne.get(`/billing/patients/${t}/print-summary`,{responseType:"blob"})}function zs(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function rue(){var Un,yn;const{invoiceId:t}=Tu(),n=Aa(),[s,r]=y.useState(null),[i,l]=y.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[o,c]=y.useState(!0),[d,u]=y.useState(!1),[h,m]=y.useState({}),[x,b]=y.useState(!1),[w,j]=y.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[S,C]=y.useState(null),[A,k]=y.useState({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""}),[T,I]=y.useState(!1),[D,O]=y.useState({amount:"",mode:"cash",reference_no:"",notes:""}),[R,P]=y.useState(!1),[L,$]=y.useState(""),[B,V]=y.useState(""),[K,z]=y.useState(null),[H,Y]=y.useState(!1),G=(s==null?void 0:s.status)==="finalized"||(s==null?void 0:s.status)==="cancelled";y.useEffect(()=>{J()},[]),y.useEffect(()=>{t&&ye()},[t]);async function J(){try{const{data:re}=await eA();l({doctors:(re==null?void 0:re.doctors)||[],credit_providers:(re==null?void 0:re.credit_providers)||[],packages:(re==null?void 0:re.packages)||[],payers:(re==null?void 0:re.payers)||[],tpas:(re==null?void 0:re.tpas)||[],credit_plans:(re==null?void 0:re.credit_plans)||[]})}catch(re){console.error("Failed to load masters",re)}}async function ee(re){if(re){Y(!0);try{const{data:Ce}=await tue(re);z(Ce)}catch(Ce){console.error("Failed to load patient billing summary",Ce)}finally{Y(!1)}}}async function ye(){c(!0),V("");try{const{data:re}=await Wde(t);r(re),m({billing_type:re.billing_type||"general",consultant_id:re.consultant_id||"",provider_id:re.provider_id||"",visit_no:re.visit_no||"",remarks:re.remarks||"",header_discount_percent:re.header_discount_percent??"",header_discount_amount:re.header_discount_amount??"",discount_remarks:re.discount_remarks||""}),await ee(re.patient_id)}catch(re){console.error("Failed to load invoice",re),V("Unable to load invoice. Please go back and try again.")}finally{c(!1)}}function ie(re){const{name:Ce,value:Ue}=re.target;m(Qe=>({...Qe,[Ce]:Ue}))}async function he(){if(s){u(!0),V("");try{const re={billing_type:h.billing_type||null,consultant_id:h.consultant_id?Number(h.consultant_id):null,provider_id:h.provider_id?Number(h.provider_id):null,visit_no:h.visit_no||null,remarks:h.remarks||null,header_discount_percent:h.header_discount_percent!==""&&h.header_discount_percent!==null?Number(h.header_discount_percent):null,header_discount_amount:h.header_discount_amount!==""&&h.header_discount_amount!==null?Number(h.header_discount_amount):null,discount_remarks:h.discount_remarks||null},{data:Ce}=await Gde(s.id,re);r(Ce),m(Ue=>({...Ue,header_discount_percent:Ce.header_discount_percent??"",header_discount_amount:Ce.header_discount_amount??""}))}catch(re){console.error("Save header failed",re),V("Unable to save header details.")}finally{u(!1)}}}function be(re){const{name:Ce,value:Ue}=re.target;j(Qe=>({...Qe,[Ce]:Ce==="quantity"||Ce==="tax_rate"||Ce==="discount_percent"?Number(Ue):Ue}))}async function we(re){if(re.preventDefault(),!!s){V("");try{const Ce={description:w.description||"",quantity:w.quantity||1,unit_price:Number(w.unit_price||0),tax_rate:Number(w.tax_rate||0),discount_percent:Number(w.discount_percent||0),discount_amount:w.discount_amount!==""?Number(w.discount_amount||0):void 0},{data:Ue}=await BI(s.id,Ce);r(Ue),b(!1),j({description:"",quantity:1,unit_price:"",tax_rate:0,discount_percent:0,discount_amount:""})}catch(Ce){console.error("Add manual item failed",Ce),V("Unable to add manual item. Please check values.")}}}function Z(re){C(re.id),k({description:re.description||"",quantity:re.quantity||1,unit_price:String(re.unit_price||""),tax_rate:Number(re.tax_rate||0),discount_percent:Number(re.discount_percent||0),discount_amount:re.discount_amount!==null&&re.discount_amount!==void 0?String(re.discount_amount):""})}function ce(re){const{name:Ce,value:Ue}=re.target;k(Qe=>({...Qe,[Ce]:Ce==="quantity"||Ce==="tax_rate"||Ce==="discount_percent"?Number(Ue):Ue}))}async function Te(re){if(re.preventDefault(),!(!s||!S))try{const Ce={description:A.description||"",quantity:A.quantity||1,unit_price:Number(A.unit_price||0),tax_rate:Number(A.tax_rate||0),discount_percent:Number(A.discount_percent||0),discount_amount:A.discount_amount!==""?Number(A.discount_amount||0):void 0},{data:Ue}=await Xde(s.id,S,Ce);r(Ue),C(null)}catch(Ce){console.error("Update item failed",Ce),V("Unable to update item.")}}async function le(re){if(!(!s||!window.confirm("Void this line item?")))try{const{data:Ue}=await Qde(s.id,re.id,{reason:"Voided from UI"});r(Ue)}catch(Ue){console.error("Void item failed",Ue),V("Unable to void item.")}}function de(re){const{name:Ce,value:Ue}=re.target;O(Qe=>({...Qe,[Ce]:Ue}))}async function ge(re){if(re.preventDefault(),!!s){V("");try{let Ce=Number(D.amount||0);R&&(Ce=-Math.abs(Ce));const Ue={amount:Ce,mode:R?"refund":D.mode,reference_no:D.reference_no||null,notes:D.notes||null},{data:Qe}=await Zde(s.id,Ue);r(Qe),I(!1),P(!1),O({amount:"",mode:"cash",reference_no:"",notes:""})}catch(Ce){console.error("Add payment/refund failed",Ce),V("Unable to save payment / refund.")}}}async function ae(re){if(!(!s||!window.confirm("Delete this payment?")))try{const{data:Ue}=await Jde(s.id,re.id);r(Ue)}catch(Ue){console.error("Delete payment failed",Ue),V("Unable to delete payment.")}}async function Ve(){if(s){$("advance"),V("");try{const{data:re}=await eue(s.id,{});r(re)}catch(re){console.error("Apply advances failed",re),V("Unable to apply advances.")}finally{$("")}}}async function nt(){if(!(!s||!window.confirm("Finalize this invoice? You cannot edit items later."))){$("finalize"),V("");try{const{data:Ce}=await Kde(s.id);r(Ce)}catch(Ce){console.error("Finalize failed",Ce),V("Unable to finalize invoice.")}finally{$("")}}}async function wt(){if(!(!s||!window.confirm("Cancel this invoice?"))){$("cancel"),V("");try{await Yde(s.id),await ye()}catch(Ce){console.error("Cancel failed",Ce),V("Unable to cancel invoice.")}finally{$("")}}}async function jt(){if(s)try{const re=await nue(s.id),Ce=new Blob([re.data],{type:re.headers["content-type"]||"application/pdf"}),Ue=URL.createObjectURL(Ce);window.open(Ue,"_blank","noopener")}catch(re){console.error("Print failed",re),V("Unable to open invoice print view.")}}async function ct(){if(s)try{const re=await sue(s.patient_id),Ce=new Blob([re.data],{type:re.headers["content-type"]||"application/pdf"}),Ue=URL.createObjectURL(Ce);window.open(Ue,"_blank","noopener")}catch(re){console.error("Patient summary print failed",re),V("Unable to open patient billing summary.")}}function Me(){P(!0),I(!0)}function qe(){P(!1),I(!0)}function oe(re){if(!s||!re)return;const Ce=i.packages.find(Qe=>String(Qe.id)===String(re));if(!Ce)return;const Ue={description:`Package: ${Ce.name}`,quantity:1,unit_price:Number(Ce.charges||0),tax_rate:0,discount_percent:0};BI(s.id,Ue).then(({data:Qe})=>r(Qe)).catch(Qe=>{console.error("Add package charge failed",Qe),V("Unable to add package charge.")})}const ue=i.packages||[],De=(s==null?void 0:s.status)==="finalized"?"bg-green-100 text-green-800":(s==null?void 0:s.status)==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",St=(s==null?void 0:s.payments)||[],tn=(s==null?void 0:s.items)||[],Lt=y.useMemo(()=>St.filter(re=>Number(re.amount||0)>=0),[St]),Dt=y.useMemo(()=>St.filter(re=>Number(re.amount||0)<0),[St]);return o?a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:a.jsx("div",{className:"max-w-5xl mx-auto text-xs text-slate-500",children:"Loading invoice..."})}):s?a.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 px-3 md:px-6 pb-20 md:pb-4 pt-4",children:[a.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>n("/billing"),className:"text-xs text-slate-500 hover:text-slate-700",children:" Billing Console"}),a.jsx("span",{className:"text-xs text-slate-400",children:"/"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h1",{className:"text-sm md:text-base font-semibold text-slate-900",children:["Invoice #",s.invoice_number||s.id]}),a.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${De}`,children:s.status})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",onClick:jt,className:"text-xs rounded-full border border-slate-300 px-3 py-1.5 text-slate-700 bg-white hover:bg-slate-50 shadow-sm",children:"Print Invoice"})})]}),B&&a.jsx("div",{className:"rounded-md bg-red-50 px-3 py-2 text-xs text-red-700",children:B}),a.jsxs("div",{className:"rounded-2xl border border-indigo-100 bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-3 md:p-4 shadow-sm flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-800",children:"Patient Credit Overview"}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Patient ID: ",a.jsxs("span",{className:"font-medium",children:["#",s.patient_id]})]}),(K==null?void 0:K.patient)&&a.jsxs("div",{className:"text-[11px] text-slate-600",children:[K.patient.uhid&&a.jsxs(a.Fragment,{children:["UHID:"," ",a.jsx("span",{className:"font-medium",children:K.patient.uhid})," ",""," "]}),(K.patient.first_name||K.patient.last_name)&&a.jsxs(a.Fragment,{children:[K.patient.first_name," ",K.patient.last_name," "," "]}),K.patient.phone&&a.jsxs(a.Fragment,{children:[" ",K.patient.phone]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[a.jsxs("div",{className:"rounded-full bg-white/80 border border-indigo-100 px-3 py-1 shadow-sm",children:[a.jsx("span",{className:"text-slate-500 mr-1",children:"Total Outstanding:"}),a.jsxs("span",{className:"font-semibold text-red-700",children:[""," ",zs((K==null?void 0:K.total_outstanding)??s.balance_due??0)]})]}),a.jsxs("div",{className:"rounded-full bg-white/80 border border-emerald-100 px-3 py-1 shadow-sm",children:[a.jsx("span",{className:"text-slate-500 mr-1",children:"Advance Balance:"}),a.jsxs("span",{className:"font-semibold text-emerald-700",children:[" ",zs((K==null?void 0:K.advance_balance)??0)]})]}),a.jsx("button",{type:"button",onClick:ct,disabled:H,className:"rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:H?"Loading...":"Credit Summary PDF"})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"w-full md:w-2/5 space-y-4",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Invoice Header"}),a.jsxs("span",{className:"text-[11px] text-slate-400",children:["Patient #",s.patient_id]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Billing Type"}),a.jsxs("select",{name:"billing_type",value:h.billing_type,onChange:ie,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[a.jsx("option",{value:"op_billing",children:"OP Billing"}),a.jsx("option",{value:"ip_billing",children:"IP Billing"}),a.jsx("option",{value:"lab",children:"Lab"}),a.jsx("option",{value:"pharmacy",children:"Pharmacy"}),a.jsx("option",{value:"radiology",children:"Radiology"}),a.jsx("option",{value:"general",children:"General"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Consultant"}),a.jsxs("select",{name:"consultant_id",value:h.consultant_id,onChange:ie,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[a.jsx("option",{value:"",children:"None"}),(Un=i.doctors)==null?void 0:Un.map(re=>a.jsx("option",{value:re.id,children:re.name||`Doctor #${re.id}`},re.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Credit Provider"}),a.jsxs("select",{name:"provider_id",value:h.provider_id,onChange:ie,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",children:[a.jsx("option",{value:"",children:"Self pay"}),(yn=i.credit_providers)==null?void 0:yn.map(re=>a.jsx("option",{value:re.id,children:re.display_name||re.name||re.code||`Provider #${re.id}`},re.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Visit No (optional)"}),a.jsx("input",{type:"text",name:"visit_no",value:h.visit_no,onChange:ie,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Remarks"}),a.jsx("input",{type:"text",name:"remarks",value:h.remarks,onChange:ie,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),a.jsxs("div",{className:"mt-2 border-t border-slate-100 pt-2 space-y-2",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Header Discount"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount %"}),a.jsx("input",{type:"number",name:"header_discount_percent",value:h.header_discount_percent,onChange:ie,disabled:G,step:"0.1",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Amount"}),a.jsx("input",{type:"number",name:"header_discount_amount",value:h.header_discount_amount,onChange:ie,disabled:G,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Discount Remarks"}),a.jsx("input",{type:"text",name:"discount_remarks",value:h.discount_remarks,onChange:ie,disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50"})]})]}),!G&&a.jsx("div",{className:"pt-1 flex justify-end",children:a.jsx("button",{type:"button",onClick:he,disabled:d,className:"px-3 py-1.5 rounded-full bg-slate-900 text-xs font-medium text-white hover:bg-slate-800 disabled:opacity-60",children:d?"Saving...":"Save Header"})})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Totals"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Gross Amount"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",zs(s.gross_total)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Tax Total"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",zs(s.tax_total)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Header Discount"}),a.jsxs("span",{className:"font-medium text-orange-700",children:[" ",zs(s.header_discount_amount||0)," ",s.header_discount_percent?`(${s.header_discount_percent}%)`:""]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Net Amount"}),a.jsxs("span",{className:"font-semibold text-slate-900",children:[" ",zs(s.net_total)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Amount Received"}),a.jsxs("span",{className:"font-medium text-emerald-700",children:[" ",zs(s.amount_paid)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Advance Adjusted"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",zs(s.advance_adjusted)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Previous Balance"}),a.jsxs("span",{className:"font-medium text-slate-900",children:[" ",zs(s.previous_balance_snapshot)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-500",children:"Balance Due"}),a.jsxs("span",{className:"font-semibold text-red-700",children:[" ",zs(s.balance_due)]})]})]})]}),ue.length>0&&a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-2 text-xs",children:[a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Package Billing (IPD)"})}),a.jsx("p",{className:"text-[11px] text-slate-500 mb-1",children:"Quickly post a package charge to this invoice."}),a.jsxs("select",{onChange:re=>oe(re.target.value),disabled:G,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:bg-slate-50",defaultValue:"",children:[a.jsx("option",{value:"",children:"Select package to add..."}),ue.map(re=>a.jsxs("option",{value:re.id,children:[re.name,"   ",zs(re.charges)]},re.id))]})]})]}),a.jsxs("div",{className:"w-full md:w-3/5 space-y-4",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Items"}),!G&&a.jsx("button",{type:"button",onClick:()=>b(!0),className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 shadow-sm",children:"+ Add Manual Item"})]}),tn.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No items added yet."}):a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"#"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Description"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Qty"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Price"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"GST%"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Disc"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Total"}),a.jsx("th",{className:"px-2 py-1.5"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:tn.map((re,Ce)=>a.jsxs("tr",{className:"align-top",children:[a.jsx("td",{className:"px-2 py-1.5 whitespace-nowrap text-slate-500",children:Ce+1}),a.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:a.jsxs("div",{className:"max-w-xs",children:[a.jsx("div",{className:"truncate",children:re.description}),a.jsxs("div",{className:"text-[10px] text-slate-400",children:[re.service_type," #",re.service_ref_id]})]})}),a.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:re.quantity}),a.jsx("td",{className:"px-2 py-1.5 text-right text-slate-700",children:zs(re.unit_price)}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[Number(re.tax_rate||0),"%"]}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-slate-700",children:[re.discount_percent?`${Number(re.discount_percent)}%`:"",re.discount_amount?` /  ${zs(re.discount_amount)}`:""]}),a.jsx("td",{className:"px-2 py-1.5 text-right text-slate-800",children:zs(re.line_total)}),a.jsx("td",{className:"px-2 py-1.5 text-right whitespace-nowrap",children:!G&&a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx("button",{type:"button",onClick:()=>Z(re),className:"text-[10px] text-indigo-600 hover:text-indigo-800",children:"Edit"}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsx("button",{type:"button",onClick:()=>le(re),className:"text-[10px] text-red-600 hover:text-red-800",children:"Void"})]})})]},re.id))})]})})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-3 md:p-4 shadow-sm space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-800",children:"Payments & Refunds"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:Ve,disabled:L==="advance",className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:L==="advance"?"Applying...":"Apply Advances"}),!G&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:Me,className:"text-[11px] rounded-full border border-red-200 bg-red-50 px-3 py-1 text-red-700 hover:bg-red-100",children:"+ Add Refund"}),a.jsx("button",{type:"button",onClick:qe,className:"text-[11px] rounded-full border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-50",children:"+ Add Payment"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Payments"}),Lt.length===0?a.jsx("p",{className:"text-[11px] text-slate-500",children:"No payments recorded."}):a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Paid At"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),a.jsx("th",{className:"px-2 py-1.5"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:Lt.map(re=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:re.mode}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:re.reference_no||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:re.notes||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:re.paid_at?new Date(re.paid_at).toLocaleString():""}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-emerald-700 font-medium",children:[" ",zs(re.amount)]}),a.jsx("td",{className:"px-2 py-1.5 text-right",children:!G&&a.jsx("button",{type:"button",onClick:()=>ae(re),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},re.id))})]})})]}),a.jsxs("div",{className:"space-y-1 border-t border-slate-100 pt-2",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-700",children:"Refunds"}),Dt.length===0?a.jsx("p",{className:"text-[11px] text-slate-500",children:"No refunds recorded."}):a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Mode"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Reference"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Notes"}),a.jsx("th",{className:"px-2 py-1.5 text-left font-medium text-slate-500",children:"Time"}),a.jsx("th",{className:"px-2 py-1.5 text-right font-medium text-slate-500",children:"Amount"}),a.jsx("th",{className:"px-2 py-1.5"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:Dt.map(re=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-1.5 text-slate-800",children:re.mode}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:re.reference_no||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-600",children:re.notes||""}),a.jsx("td",{className:"px-2 py-1.5 text-slate-500",children:re.paid_at?new Date(re.paid_at).toLocaleString():""}),a.jsxs("td",{className:"px-2 py-1.5 text-right text-red-700 font-medium",children:[" ",zs(re.amount)]}),a.jsx("td",{className:"px-2 py-1.5 text-right",children:!G&&a.jsx("button",{type:"button",onClick:()=>ae(re),className:"text-[10px] text-red-600 hover:text-red-800",children:"Delete"})})]},re.id))})]})})]})]})]})]}),a.jsx("div",{className:"fixed inset-x-0 bottom-0 z-20 bg-white border-t border-slate-200 px-3 py-2 md:static md:border-none md:px-0 md:py-0 mt-3",children:a.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-xs",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"rounded-full bg-slate-100 px-2.5 py-1 text-[11px] text-slate-700",children:["Net:  ",zs(s.net_total)]}),a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] text-emerald-700",children:["Paid:  ",zs(s.amount_paid)]}),a.jsxs("span",{className:"rounded-full bg-red-50 px-2.5 py-1 text-[11px] text-red-700",children:["Balance:  ",zs(s.balance_due)]})]}),a.jsx("div",{className:"flex gap-2 justify-end",children:!G&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:wt,disabled:L==="cancel",className:"rounded-full border border-slate-300 px-3 py-1.5 text-xs text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-60",children:L==="cancel"?"Cancelling...":"Cancel Invoice"}),a.jsx("button",{type:"button",onClick:nt,disabled:L==="finalize",className:"rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-1.5 text-xs font-medium text-white shadow-md hover:shadow-lg disabled:opacity-60",children:L==="finalize"?"Finalizing...":"Finalize"})]})})]})})]}),x&&!G&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Add Manual Item"}),a.jsx("button",{type:"button",onClick:()=>b(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:we,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),a.jsx("input",{type:"text",name:"description",value:w.description,onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),a.jsx("input",{type:"number",name:"quantity",value:w.quantity,min:1,onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),a.jsx("input",{type:"number",name:"unit_price",value:w.unit_price,step:"0.01",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),a.jsx("input",{type:"number",name:"tax_rate",value:w.tax_rate,step:"0.1",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),a.jsx("input",{type:"number",name:"discount_percent",value:w.discount_percent,step:"0.1",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),a.jsx("input",{type:"number",name:"discount_amount",value:w.discount_amount,step:"0.01",onChange:be,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>b(!1),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Add Item"})]})]})]})}),S&&!G&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Edit Item"}),a.jsx("button",{type:"button",onClick:()=>C(null),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:Te,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),a.jsx("input",{type:"text",name:"description",value:A.description,onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Qty"}),a.jsx("input",{type:"number",name:"quantity",value:A.quantity,min:1,onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Unit Price"}),a.jsx("input",{type:"number",name:"unit_price",value:A.unit_price,step:"0.01",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Tax %"}),a.jsx("input",{type:"number",name:"tax_rate",value:A.tax_rate,step:"0.1",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc %"}),a.jsx("input",{type:"number",name:"discount_percent",value:A.discount_percent,step:"0.1",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Disc Amount"}),a.jsx("input",{type:"number",name:"discount_amount",value:A.discount_amount,step:"0.01",onChange:ce,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>C(null),className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-indigo-700",children:"Save Changes"})]})]})]})}),T&&!G&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:R?"Add Refund":"Add Payment"}),a.jsx("button",{type:"button",onClick:()=>{I(!1),P(!1)},className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:ge,children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Amount"}),a.jsx("input",{type:"number",name:"amount",value:D.amount,onChange:de,step:"0.01",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",required:!0})]}),!R&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode"}),a.jsxs("select",{name:"mode",value:D.mode,onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"card",children:"Card"}),a.jsx("option",{value:"upi",children:"UPI"}),a.jsx("option",{value:"credit",children:"Credit"}),a.jsx("option",{value:"cheque",children:"Cheque"}),a.jsx("option",{value:"neft",children:"NEFT"}),a.jsx("option",{value:"rtgs",children:"RTGS"}),a.jsx("option",{value:"wallet",children:"Wallet"}),a.jsx("option",{value:"other",children:"Other"})]})]}),R&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Mode (optional)"}),a.jsx("input",{type:"text",name:"mode",value:D.mode,onChange:de,placeholder:"refund / bank / cash",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reference No (optional)"}),a.jsx("input",{type:"text",name:"reference_no",value:D.reference_no,onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes (optional)"}),a.jsx("input",{type:"text",name:"notes",value:D.notes,onChange:de,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>{I(!1),P(!1)},className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:`rounded-md px-3 py-1.5 text-xs font-medium text-white ${R?"bg-red-600 hover:bg-red-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:R?"Save Refund":"Save Payment"})]})]})]})})]}):a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-3 md:px-6 py-4",children:a.jsxs("div",{className:"max-w-5xl mx-auto",children:[a.jsx("p",{className:"text-xs text-red-600 mb-2",children:B||"Invoice not found."}),a.jsx("button",{type:"button",onClick:()=>n("/billing"),className:"text-xs text-indigo-600 hover:text-indigo-800",children:" Back to Billing Console"})]})})}function o9(t){return ne.get("/emr/patients/lookup",{params:{q:t}})}function aue({patient_id:t,uhid:n,date_from:s,date_to:r,types:i}={}){let l;return Array.isArray(i)?l=i.length?i.join(","):void 0:typeof i=="string"?l=i||void 0:l=void 0,ne.get("/emr/timeline",{params:{patient_id:t,uhid:n,date_from:s||void 0,date_to:r||void 0,types:l}})}function iue(t){return ne.post("/emr/export/pdf-json",t,{responseType:"blob"})}function lue(t,n,s){return ne.get(`/emr/fhir/${t}`,{params:{date_from:n,date_to:s}})}function oue({onPick:t,placeholder:n="UHID, name, phone, email"}){const[s,r]=y.useState(""),[i,l]=y.useState([]),[o,c]=y.useState(!1);y.useEffect(()=>{let u=!0;const m=setTimeout(async()=>{if(!s||!s.trim()){l([]);return}try{c(!0);const{data:x}=await o9(s.trim());if(!u)return;l((x==null?void 0:x.results)||[])}finally{c(!1)}},250);return()=>{u=!1,clearTimeout(m)}},[s]);const d=y.useMemo(()=>i.slice(0,8),[i]);return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Find Patient"}),a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"w-full rounded-xl border border-gray-200 bg-white px-9 py-2 text-sm outline-none ring-blue-200 focus:ring-2",placeholder:n,value:s,onChange:u=>r(u.target.value)})]}),o&&a.jsx("div",{className:"text-xs text-gray-500",children:"Searching"}),!o&&d.length>0&&a.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:d.map(u=>{var h;return a.jsxs("button",{onClick:()=>t(u),className:"rounded-xl border p-3 text-left transition hover:bg-gray-50",children:[a.jsxs("div",{className:"font-medium",children:[u.uhid,"  ",u.name]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[(h=u.gender)==null?void 0:h.toUpperCase()," ",u.dob?` ${u.dob}`:""," ",u.phone?` ${u.phone}`:""]})]},u.uhid)})}),!o&&s&&d.length===0&&a.jsx("div",{className:"text-xs text-gray-500",children:"No matches."})]})}const pm=[{code:"opd_visit",label:"OPD Visit",icon:un},{code:"opd_vitals",label:"Vitals",icon:or},{code:"rx",label:"Prescription",icon:Rc},{code:"lab",label:"Lab",icon:Lc},{code:"radiology",label:"Radiology",icon:Pg},{code:"pharmacy",label:"Pharmacy",icon:I1},{code:"ipd_admission",label:"IPD Admit",icon:Ps},{code:"ipd_transfer",label:"IPD Transfer",icon:Yee},{code:"ipd_discharge",label:"IPD Discharge",icon:hne},{code:"ot",label:"OT",icon:i7},{code:"billing",label:"Billing",icon:aS},{code:"attachment",label:"Attachment",icon:jne},{code:"consent",label:"Consent",icon:Ji}];function Sf(t){return t<10?"0"+t:""+t}function cue(t){const n=new Date(t);return isNaN(n)?String(t||""):`${n.getFullYear()}-${Sf(n.getMonth()+1)}-${Sf(n.getDate())} ${Sf(n.getHours())}:${Sf(n.getMinutes())}`}function due(t){const n=new Date(t);return isNaN(n)?"":`${n.getFullYear()}-${Sf(n.getMonth()+1)}-${Sf(n.getDate())}`}function uue(t){const n=new Map;return t.forEach(s=>{const r=due(s.ts);n.has(r)||n.set(r,[]),n.get(r).push(s)}),Array.from(n.entries()).sort((s,r)=>s[0]<r[0]?1:-1)}function fue(t,n){const s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=n,r.click(),URL.revokeObjectURL(s)}function I0(t,n){const s=document.createElement("a");s.href=t,s.download=n||"download",s.target="_blank",s.rel="noopener",s.click()}const hue="inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",mue={new:"border-slate-200 bg-slate-50 text-slate-700",in_progress:"border-slate-200 bg-slate-50 text-slate-700",dispensed:"border-emerald-200 bg-emerald-50 text-emerald-700",completed:"border-emerald-200 bg-emerald-50 text-emerald-700",cancelled:"border-rose-200 bg-rose-50 text-rose-700"};function FI(t){const n=(t.content_type||"").toLowerCase(),s=String(t.url||"").toLowerCase();return n.startsWith("image/")?"image":n==="application/pdf"?"pdf":s.endsWith(".png")||s.endsWith(".jpg")||s.endsWith(".jpeg")||s.endsWith(".webp")||s.endsWith(".gif")?"image":s.endsWith(".pdf")?"pdf":"other"}function pue(){const[t,n]=y.useState(null),[s,r]=y.useState({date_from:"",date_to:"",types:pm.map(z=>z.code),consent_required:!1}),[i,l]=y.useState(!1),[o,c]=y.useState([]),[d,u]=y.useState(0),h=y.useMemo(()=>new Set(s.types||[]),[s.types]),[m,x]=y.useState(null),[b,w]=y.useState(!1),[j,S]=y.useState(null);y.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const C=z=>{r(H=>{const Y=new Set(H.types);return Y.has(z)?Y.delete(z):Y.add(z),{...H,types:Array.from(Y)}})},A=()=>r(z=>({...z,types:pm.map(H=>H.code)})),k=()=>r(z=>({...z,types:[]}));y.useEffect(()=>{let z=!0;return(async()=>{var Y,G;if(!(!(t!=null&&t.uhid)&&!(t!=null&&t.id)))try{l(!0);const J={uhid:t.uhid,patient_id:t.id,date_from:s.date_from||void 0,date_to:s.date_to||void 0};s.types&&s.types.length&&s.types.length!==pm.length&&(J.types=s.types.join(","));const{data:ee}=await aue(J);if(!z)return;c(ee||[])}catch(J){console.error(J),xe.error(((G=(Y=J==null?void 0:J.response)==null?void 0:Y.data)==null?void 0:G.detail)||"Failed to load EMR timeline"),c([])}finally{l(!1)}})(),()=>{z=!1}},[t==null?void 0:t.uhid,t==null?void 0:t.id,s.date_from,s.date_to,JSON.stringify(s.types),d]);const T=y.useMemo(()=>uue(o),[o]),I=(o==null?void 0:o.length)||0,D=s.date_from||s.date_to?`${s.date_from||""}  ${s.date_to||"Today"}`:"All available records",O=async()=>{var z,H,Y;if(!t){xe.info("Select a patient first.");return}try{const J={...t!=null&&t.id?{patient_id:t.id}:{uhid:t==null?void 0:t.uhid},date_from:s.date_from||null,date_to:s.date_to||null,sections:{opd:h.has("opd_visit")||h.has("opd_vitals")||h.has("rx"),ipd:h.has("ipd_admission")||h.has("ipd_transfer")||h.has("ipd_discharge"),vitals:h.has("opd_vitals"),prescriptions:h.has("rx"),lab:h.has("lab"),radiology:h.has("radiology"),pharmacy:h.has("pharmacy"),ot:h.has("ot"),billing:h.has("billing"),attachments:h.has("attachment"),consents:h.has("consent")},consent_required:!!s.consent_required},ye=(await iue(J)).data;if(!(ye instanceof Blob)){xe.error("PDF export failed: invalid response");return}x(ie=>(ie&&URL.revokeObjectURL(ie),URL.createObjectURL(ye))),w(!0),xe.success("EMR PDF ready for preview")}catch(G){((z=G==null?void 0:G.response)==null?void 0:z.status)===412?xe.error("Consent required. Enable consent capture or uncheck the Require consent box."):xe.error(((Y=(H=G==null?void 0:G.response)==null?void 0:H.data)==null?void 0:Y.detail)||"PDF export failed")}},R=async()=>{if(!(t!=null&&t.id)){xe.info("Patient id required; please pick from the search list.");return}try{const{data:z}=await lue(t.id,s.date_from||void 0,s.date_to||void 0),H=new Blob([JSON.stringify(z,null,2)],{type:"application/json"});fue(H,`FHIR_${t.uhid||"patient"}.json`),xe.success("FHIR bundle downloaded")}catch{xe.error("FHIR export failed")}};function P({k:z,v:H}){return H==null||H===""?null:a.jsxs("div",{className:"text-xs text-slate-700",children:[a.jsxs("span",{className:"font-medium",children:[z,":"]})," ",String(H)]})}function L(z){const H=z.data||{};switch(z.type){case"opd_visit":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Chief Complaint",v:H.chief_complaint}),a.jsx(P,{k:"Symptoms",v:H.symptoms}),a.jsx(P,{k:"Subjective",v:H.subjective}),a.jsx(P,{k:"Objective",v:H.objective}),a.jsx(P,{k:"Assessment",v:H.assessment}),a.jsx(P,{k:"Plan",v:H.plan}),a.jsx(P,{k:"Episode",v:H.episode_id}),H.appointment&&a.jsxs("div",{className:"text-xs text-slate-700",children:[a.jsx("span",{className:"font-medium",children:"Appointment:"})," ",H.appointment.date,"  ",H.appointment.slot_start,"",H.appointment.slot_end,"  ",H.appointment.purpose]})]});case"opd_vitals":return a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[a.jsx(P,{k:"Recorded at",v:H.recorded_at}),a.jsx(P,{k:"Height (cm)",v:H.height_cm}),a.jsx(P,{k:"Weight (kg)",v:H.weight_kg}),a.jsx(P,{k:"BMI",v:H.bmi}),a.jsx(P,{k:"BP",v:H.bp_systolic!=null&&H.bp_diastolic!=null?`${H.bp_systolic}/${H.bp_diastolic} mmHg`:""}),a.jsx(P,{k:"Pulse",v:H.pulse}),a.jsx(P,{k:"RR",v:H.rr}),a.jsx(P,{k:"Temp (C)",v:H.temp_c}),a.jsx(P,{k:"SpO (%)",v:H.spo2}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(P,{k:"Notes",v:H.notes})})]});case"rx":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Notes",v:H.notes}),a.jsx(P,{k:"Signed at",v:H.signed_at}),a.jsx(P,{k:"Signed by",v:H.signed_by}),Array.isArray(H.items)&&H.items.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.items.map((Y,G)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-5",children:[a.jsxs("div",{className:"md:col-span-2 text-xs",children:[a.jsx("span",{className:"font-medium text-slate-900",children:Y.drug_name})," ",Y.strength?a.jsxs("span",{className:"text-slate-500",children:[" ",Y.strength]}):null]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Freq: ",Y.frequency||""]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Dur: ",Y.duration_days,"d"]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",Y.quantity]})]},G))})]})]});case"lab":{const Y=H.item||{};return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Order ID",v:H.order_id}),a.jsx(P,{k:"Priority",v:H.priority}),a.jsx(P,{k:"Collected at",v:H.collected_at}),a.jsx(P,{k:"Reported at",v:H.reported_at}),a.jsx(P,{k:"Test",v:`${Y.test_name} (${Y.test_code})`}),a.jsx(P,{k:"Unit",v:Y.unit}),a.jsx(P,{k:"Normal range",v:Y.normal_range}),a.jsx(P,{k:"Specimen",v:Y.specimen_type}),a.jsx(P,{k:"Status",v:Y.status}),a.jsx(P,{k:"Result",v:Y.result_value}),a.jsx(P,{k:"Critical",v:Y.is_critical?"Yes":Y.is_critical===!1?"No":""}),a.jsx(P,{k:"Result at",v:Y.result_at})]})}case"radiology":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Test",v:`${H.test_name} (${H.test_code})`}),a.jsx(P,{k:"Modality",v:H.modality}),a.jsx(P,{k:"Status",v:H.status}),a.jsx(P,{k:"Scheduled at",v:H.scheduled_at}),a.jsx(P,{k:"Scanned at",v:H.scanned_at}),a.jsx(P,{k:"Reported at",v:H.reported_at}),a.jsx(P,{k:"Approved at",v:H.approved_at}),a.jsx(P,{k:"Report",v:H.report_text})]});case"pharmacy":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Sale ID",v:H.sale_id}),a.jsx(P,{k:"Context",v:H.context_type}),a.jsx(P,{k:"Payment",v:H.payment_mode}),a.jsx(P,{k:"Total",v:H.total_amount}),Array.isArray(H.items)&&H.items.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.items.map((Y,G)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[a.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:Y.medicine_name||`#${Y.medicine_id}`}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",Y.qty]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["",Y.amount]})]},G))})]})]});case"ipd_admission":return a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-slate-800 md:grid-cols-3",children:[a.jsx(P,{k:"Admission Code",v:H.admission_code}),a.jsx(P,{k:"Type",v:H.admission_type}),a.jsx(P,{k:"Admitted at",v:H.admitted_at}),a.jsx(P,{k:"Expected Discharge",v:H.expected_discharge_at}),a.jsx(P,{k:"Bed",v:H.current_bed_code}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(P,{k:"Preliminary Diagnosis",v:H.preliminary_diagnosis})}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(P,{k:"History",v:H.history})}),a.jsx("div",{className:"col-span-2 md:col-span-3",children:a.jsx(P,{k:"Care Plan",v:H.care_plan})})]});case"ipd_transfer":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Admission",v:H.admission_id}),a.jsx(P,{k:"From Bed",v:H.from_bed_id}),a.jsx(P,{k:"To Bed",v:H.to_bed_id}),a.jsx(P,{k:"Reason",v:H.reason}),a.jsx(P,{k:"Transferred at",v:H.transferred_at})]});case"ipd_discharge":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Finalized",v:H.finalized?"Yes":"No"}),a.jsx(P,{k:"Finalized at",v:H.finalized_at}),a.jsx(P,{k:"Demographics",v:H.demographics}),a.jsx(P,{k:"Medical History",v:H.medical_history}),a.jsx(P,{k:"Treatment Summary",v:H.treatment_summary}),a.jsx(P,{k:"Medications",v:H.medications}),a.jsx(P,{k:"Follow Up",v:H.follow_up}),a.jsx(P,{k:"ICD-10 Codes",v:H.icd10_codes})]});case"ot":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Surgery",v:H.surgery_name}),a.jsx(P,{k:"Code",v:H.surgery_code}),a.jsx(P,{k:"Estimated Cost",v:H.estimated_cost}),a.jsx(P,{k:"Scheduled",v:`${H.scheduled_start||""}  ${H.scheduled_end||""}`}),a.jsx(P,{k:"Actual",v:`${H.actual_start||""}  ${H.actual_end||""}`}),a.jsx(P,{k:"Status",v:H.status}),a.jsx(P,{k:"Pre-op Notes",v:H.preop_notes}),a.jsx(P,{k:"Post-op Notes",v:H.postop_notes})]});case"billing":return a.jsxs("div",{className:"mt-2 space-y-2 text-sm text-slate-800",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4",children:[a.jsx(P,{k:"Invoice ID",v:H.invoice_id}),a.jsx(P,{k:"Status",v:H.status}),a.jsx(P,{k:"Net Total",v:H.net_total}),a.jsx(P,{k:"Balance",v:H.balance_due})]}),Array.isArray(H.items)&&H.items.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Items"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.items.map((Y,G)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-6",children:[a.jsx("div",{className:"md:col-span-2 text-xs text-slate-800",children:Y.description}),a.jsx("div",{className:"text-xs text-slate-600",children:Y.service_type}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Qty: ",Y.quantity]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Unit: ",Y.unit_price]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Total: ",Y.line_total]})]},G))})]}),Array.isArray(H.payments)&&H.payments.length>0&&a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600 uppercase tracking-wide",children:"Payments"}),a.jsx("div",{className:"mt-1 divide-y rounded-2xl border border-slate-200 bg-slate-50",children:H.payments.map((Y,G)=>a.jsxs("div",{className:"grid gap-2 p-2.5 md:grid-cols-4",children:[a.jsxs("div",{className:"text-xs text-slate-600",children:["Mode: ",Y.mode]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["Ref: ",Y.reference_no||""]}),a.jsxs("div",{className:"text-xs text-slate-600",children:["",Y.amount]}),a.jsx("div",{className:"text-xs text-slate-600",children:Y.paid_at})]},G))})]})]});case"attachment":return null;case"consent":return a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-slate-800",children:[a.jsx(P,{k:"Type",v:H.type}),a.jsx(P,{k:"Captured at",v:H.captured_at}),a.jsx(P,{k:"Text",v:H.text})]});default:return null}}const $=z=>{const H=FI(z);if(H==="other"){window.open(z.url,"_blank","noopener,noreferrer");return}S({url:z.url,label:z.label||"Attachment",kind:H})},B=()=>{S(null)},V=()=>{if(!m)return;const z=window.open(m);z&&z.addEventListener("load",()=>{z.focus(),z.print()})},K=()=>{!m||!t||I0(m,`EMR_${t.uhid||"patient"}.pdf`)};return a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsxs("div",{className:"mx-auto max-w-6xl px-3 py-4 md:px-6 md:py-6 lg:px-8",children:[a.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),"EMR  Patient record & timeline"]}),a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1 text-[10px] font-medium text-slate-500",children:[a.jsx(rne,{className:"h-3 w-3"}),"Desktop workspace"]})]}),a.jsx(gt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:a.jsxs(Le,{className:"mb-5 rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Je,{className:"flex flex-col gap-4 border-b border-slate-100 pb-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-3xl bg-slate-900 text-slate-50",children:a.jsx(un,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx(st,{className:"text-xl font-semibold text-slate-900",children:"Patient EMR Timeline"}),a.jsx(Sa,{className:"text-sm text-slate-600",children:"Unified view of OPD, IPD, lab, radiology, pharmacy, billing, attachments and consents  ready to export as a clean EMR PDF."})]})]}),a.jsxs("div",{className:"grid gap-2 text-xs text-slate-600 sm:grid-cols-3 sm:text-right",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Selected patient"}),a.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:t?t.uhid:"None"}),a.jsx("div",{className:"truncate text-[11px] text-slate-500",children:t?t.name:"Use search to pick a patient"})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Total events"}),a.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:I}),a.jsx("div",{className:"text-[11px] text-slate-500",children:"Across visits, orders & billing"})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("div",{className:"text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"Date range"}),a.jsx("div",{className:"mt-1 text-[13px] font-semibold text-slate-900",children:D}),a.jsx("div",{className:"text-[11px] text-slate-500",children:"Filter scope for EMR export"})]})]})]}),a.jsx(ze,{className:"pt-4",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-500",children:[a.jsx(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-white px-2.5 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-500",children:"EMR Viewer"}),a.jsx("span",{className:"hidden text-[11px] text-slate-500 sm:inline",children:"Apply filters, review visits and export a print-aligned EMR PDF."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs(Pe,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:()=>u(z=>z+1),children:[a.jsx(ji,{className:"h-3.5 w-3.5"}),"Refresh"]}),a.jsxs(Pe,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-2 text-xs font-medium text-white hover:bg-slate-800",onClick:O,children:[a.jsx(rS,{className:"h-3.5 w-3.5"}),"Preview / Print EMR PDF"]}),a.jsxs(Pe,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-xs text-slate-700 hover:bg-slate-100",onClick:R,children:[a.jsx(Rc,{className:"h-3.5 w-3.5"}),"Export FHIR (JSON)"]})]})]})})]})}),a.jsxs("div",{className:"mt-4 lg:grid lg:grid-cols-[280px,minmax(0,1fr)] lg:gap-6",children:[a.jsxs("div",{className:"mb-4 space-y-4 lg:mb-0 lg:sticky lg:top-24",children:[a.jsx(gt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Je,{className:"pb-3",children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Patient"}),a.jsx(Sa,{className:"text-xs text-slate-500",children:"Search and select a patient to view their EMR timeline."})]}),a.jsxs(ze,{className:"space-y-3",children:[a.jsx(oue,{onPick:z=>{n(z),xe.success(`Selected ${z.uhid}  ${z.name}`)}}),t&&a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsx(Cp,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{className:"font-medium text-slate-900",children:t.uhid}),a.jsx(b0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"truncate",children:t.name}),t.gender&&a.jsxs(a.Fragment,{children:[a.jsx(b0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"uppercase text-slate-500",children:t.gender})]}),t.dob&&a.jsxs(a.Fragment,{children:[a.jsx(b0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"text-slate-500",children:["DOB ",t.dob]})]}),t.phone&&a.jsxs(a.Fragment,{children:[a.jsx(b0,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"text-slate-500",children:t.phone})]})]})})]})]})}),a.jsx(gt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.1},children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Filters"}),a.jsx(Sa,{className:"text-xs text-slate-500",children:"Date range, data types and consent requirement."})]})})}),a.jsxs(ze,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"mb-1.5 flex items-center gap-2 text-xs font-semibold text-slate-900",children:[a.jsx(yf,{className:"h-3.5 w-3.5 text-slate-500"}),"Date range"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(yf,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),a.jsx(_e,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:s.date_from,onChange:z=>r(H=>({...H,date_from:z.target.value}))})]}),a.jsxs("div",{className:"relative",children:[a.jsx(yf,{className:"pointer-events-none absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),a.jsx(_e,{type:"date",className:"h-8 rounded-2xl border-slate-200 bg-slate-50 pl-8 pr-2 text-xs text-slate-700",value:s.date_to,onChange:z=>r(H=>({...H,date_to:z.target.value}))})]})]}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Leave blank for full EMR history."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"mb-1.5 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-slate-900",children:[a.jsx(Ai,{className:"h-3.5 w-3.5 text-slate-500"}),"Types"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:A,className:"text-[10px] font-medium text-slate-600 hover:text-slate-900",children:"All"}),a.jsx("button",{type:"button",onClick:k,className:"text-[10px] font-medium text-slate-500 hover:text-slate-900",children:"Clear"})]})]}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:pm.map(z=>{const H=z.icon,Y=h.has(z.code);return a.jsxs("button",{type:"button",onClick:()=>C(z.code),className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-1 text-[10px] font-medium transition",Y?"border-slate-900 bg-slate-900 text-white shadow-sm":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"].join(" "),children:[a.jsx(H,{className:"h-3 w-3"}),z.label]},z.code)})})]}),a.jsxs("div",{className:"flex items-start gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsx("input",{id:"consentReq",type:"checkbox",checked:!!s.consent_required,onChange:z=>r(H=>({...H,consent_required:z.target.checked})),className:"mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-slate-900"}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("label",{htmlFor:"consentReq",className:"block text-xs font-medium text-slate-900",children:"Require active consent for export"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"When enabled, EMR PDF export is blocked unless a valid patient consent record exists."})]})]})]})]})})]}),a.jsx(gt.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.08},className:"space-y-4",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(un,{className:"h-4 w-4 text-slate-500"}),a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Timeline"})]}),a.jsx("span",{className:"text-[11px] text-slate-500",children:"Sorted newest to oldest"})]})}),a.jsxs(ze,{children:[i&&a.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((z,H)=>a.jsx(Ze,{className:"h-16 w-full rounded-2xl bg-slate-100"},H))}),!i&&(!o||o.length===0)&&a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-6 py-8 text-center",children:[a.jsx("div",{className:"mx-auto mb-2 flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500",children:a.jsx(un,{className:"h-4 w-4"})}),a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"No EMR events to display"}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Pick a patient and adjust the date range or type filters to load their EMR timeline."})]}),!i&&o&&o.length>0&&a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-slate-200 via-slate-200/70 to-transparent"}),a.jsx("div",{className:"space-y-6",children:T.map(([z,H])=>a.jsxs("div",{className:"relative pl-10",children:[a.jsxs("div",{className:"mb-2 inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] font-medium text-slate-700",children:[a.jsx(yf,{className:"h-3.5 w-3.5 text-slate-500"}),z]}),a.jsx("div",{className:"space-y-3",children:H.map((Y,G)=>{var ie,he;const J=[Y.doctor_name?`Dr. ${Y.doctor_name}`:null,Y.department_name||null,Y.location_name||null].filter(Boolean).join("  "),ee=((ie=pm.find(be=>be.code===Y.type))==null?void 0:ie.icon)||Rc,ye=Y.status&&(mue[Y.status]||"border-slate-200 bg-slate-50 text-slate-600");return a.jsxs(gt.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},transition:{duration:.15},className:"relative",children:[a.jsx("div",{className:"absolute -left-[9px] top-4 h-2.5 w-2.5 rounded-full border border-slate-200 bg-white"}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-3.5 hover:shadow-[0_4px_12px_rgba(15,23,42,0.06)]",children:a.jsx("div",{className:"flex items-start justify-between gap-3",children:a.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[a.jsx("div",{className:"mt-0.5 flex h-8 w-8 items-center justify-center rounded-2xl bg-slate-900 text-slate-50",children:a.jsx(ee,{className:"h-4 w-4"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:Y.title||"Event"}),a.jsx("div",{className:"text-[11px] text-slate-500",children:cue(Y.ts)}),Y.status&&a.jsx("span",{className:`${hue} ${ye}`,children:Y.status})]}),J&&a.jsx("div",{className:"mt-0.5 text-[11px] text-slate-500",children:J}),L(Y),((he=Y.attachments)==null?void 0:he.length)>0&&a.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Y.attachments.map((be,we)=>{const Z=FI(be);return a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-[10px]",children:[a.jsxs("button",{type:"button",onClick:()=>$(be),className:"inline-flex items-center gap-1 text-slate-700 hover:text-slate-900",children:[a.jsx(Gm,{className:"h-3 w-3"}),be.label||"attachment"]}),a.jsxs("button",{type:"button",onClick:()=>I0(be.url,be.label||"attachment"),className:"inline-flex items-center gap-1 text-slate-400 hover:text-slate-700",children:[a.jsx(Wd,{className:"h-3 w-3"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),a.jsx("span",{className:"text-[9px] uppercase text-slate-400",children:Z})]},we)})})]})]})})})]},`${Y.type}-${String(Y.ts)}-${G}`)})})]},z))})]})]})]})})]})]}),b&&m&&a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:a.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-6xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"EMR PDF Preview"}),t&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:[t.uhid,"  ",t.name]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Pe,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:K,children:[a.jsx(Wd,{className:"h-3 w-3"}),"Download"]}),a.jsxs(Pe,{size:"sm",className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] text-white hover:bg-slate-800",onClick:V,children:[a.jsx(rS,{className:"h-3 w-3"}),"Print"]}),a.jsx("button",{type:"button",onClick:()=>w(!1),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:a.jsx(Os,{className:"h-4 w-4"})})]})]}),a.jsx("div",{className:"flex-1 bg-slate-100",children:a.jsx("iframe",{src:m,title:"EMR PDF",className:"h-full w-full"})})]})}),j&&a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60",children:a.jsxs("div",{className:"relative flex h-[90vh] w-[95vw] max-w-4xl flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-2.5",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:j.label}),a.jsxs("div",{className:"text-[11px] uppercase text-slate-400",children:[j.kind," preview"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Pe,{variant:"outline",size:"sm",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>I0(j.url,j.label),children:[a.jsx(Wd,{className:"h-3 w-3"}),"Download"]}),a.jsx("button",{type:"button",onClick:B,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",children:a.jsx(Os,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex-1 bg-slate-100",children:[j.kind==="image"&&a.jsx("div",{className:"flex h-full w-full items-center justify-center overflow-auto bg-black",children:a.jsx("img",{src:j.url,alt:j.label,className:"max-h-full max-w-full object-contain"})}),j.kind==="pdf"&&a.jsx("iframe",{src:j.url,title:j.label,className:"h-full w-full"}),j.kind==="other"&&a.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 p-6 text-center text-sm text-slate-600",children:[a.jsx("p",{children:"This file type cant be previewed here. You can open it in a new tab or download it."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Pe,{size:"sm",className:"rounded-full bg-slate-900 px-4 py-1 text-[11px] text-white hover:bg-slate-800",onClick:()=>window.open(j.url,"_blank","noopener,noreferrer"),children:"Open in new tab"}),a.jsx(Pe,{variant:"outline",size:"sm",className:"rounded-full border-slate-200 bg-white px-4 py-1 text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>I0(j.url,j.label),children:"Download"})]})]})]})]})})]})}const tA=(t={})=>ne.get("/templates/templates",{params:t}),xue=t=>ne.get(`/templates/templates/${t}`),gue=t=>ne.post("/templates/templates",t),yue=(t,n)=>ne.patch(`/templates/templates/${t}`,n),bue=t=>ne.delete(`/templates/templates/${t}`),c9=(t,n,s=null)=>ne.post(`/templates/templates/${t}/render-html`,s?{data:s}:{},{params:{patient_id:n}}),vue=async(t,n)=>(await ne.get(`/templates/templates/${t}/pdf`,{params:{patient_id:n,inline:!1},responseType:"blob"})).data,wue=async(t,n)=>(await ne.post(`/templates/templates/${t}/pdf`,n,{responseType:"blob"})).data,Nue=(t,n)=>ne.post(`/templates/patients/${t}/consents`,n),jue=t=>ne.get(`/templates/patients/${t}/consents`),Sue=async t=>{const n=new FormData;return n.append("file",t),(await ne.post("/files/upload",n,{headers:{"Content-Type":"multipart/form-data"}})).data};function _ue(){const[t,n]=y.useState([]),[s,r]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState(!1),d=async()=>{c(!0);try{const m=await tA({q:s,category:i||void 0});n(m.data||[])}finally{c(!1)}};y.useEffect(()=>{d()},[]);const u=async m=>{m.preventDefault(),d()},h=async m=>{if(confirm("Delete this template?"))try{await bue(m),xe.success("Deleted"),d()}catch{}};return a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Templates"}),a.jsx(Zi,{to:"/templates/new",className:"bg-blue-600 text-white px-3 py-2 rounded-lg text-sm",children:"New Template"})]}),a.jsxs("form",{onSubmit:u,className:"mb-3 flex flex-wrap gap-2",children:[a.jsx("input",{value:s,onChange:m=>r(m.target.value),placeholder:"Search name/code...",className:"border rounded px-3 py-2 text-sm"}),a.jsxs("select",{value:i,onChange:m=>l(m.target.value),className:"border rounded px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"report",children:"Report"}),a.jsx("option",{value:"consent",children:"Consent"})]}),a.jsx("button",{className:"px-3 py-2 border rounded text-sm",children:"Filter"})]}),a.jsx("div",{className:"overflow-x-auto bg-white border rounded-lg",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Category"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Version"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[t.map(m=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:m.id}),a.jsx("td",{className:"px-3 py-2",children:m.name}),a.jsx("td",{className:"px-3 py-2",children:m.code}),a.jsx("td",{className:"px-3 py-2 capitalize",children:m.category}),a.jsx("td",{className:"px-3 py-2",children:m.version}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[a.jsx(Zi,{to:`/templates/${m.id}/edit`,className:"px-2 py-1 text-blue-700 hover:underline",children:"Edit"}),a.jsx("button",{onClick:()=>h(m.id),className:"px-2 py-1 text-red-600 hover:underline",children:"Delete"})]})]},m.id)),t.length===0&&!o&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-6 text-center text-gray-500",children:"No templates"})})]})]})})]})}const $I=["system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif","Arial, Helvetica, sans-serif","'Times New Roman', Times, serif","'Georgia', serif","'Courier New', Courier, monospace","'Inter', system-ui, -apple-system, sans-serif"],zI=["#000000","#444444","#666666","#999999","#CCCCCC","#EEEEEE","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB"];function ON({value:t,onChange:n}){const s=y.useRef(null),r=y.useRef(null),[i,l]=y.useState($I[0]);y.useEffect(()=>{s.current&&s.current.innerHTML!==(t||"")&&(s.current.innerHTML=t||"")},[t]);const o=()=>{var O;return((O=s.current)==null?void 0:O.innerHTML)||""},c=()=>n&&n(o()),d=O=>{document.execCommand("styleWithCSS",!1,!0);const R=window.getSelection();if(!R||R.rangeCount===0)return;const P=R.getRangeAt(0),L=document.createElement("span");Object.entries(O).forEach(([$,B])=>L.style[$]=B),P.surroundContents(L),c()},u=(O,R=null)=>{document.execCommand("styleWithCSS",!1,!0),document.execCommand(O,!1,R),c()},h=(O,R="",P=null)=>{const L=window.getSelection();if(!L||L.rangeCount===0)return;const $=L.getRangeAt(0),B=document.createElement(O);R&&(B.className=R),P&&Object.entries(P).forEach(([V,K])=>B.style[V]=K),$.surroundContents(B),c()},m=()=>{var O;return(O=r.current)==null?void 0:O.click()},x=async O=>{var P,L;const R=(P=O.target.files)==null?void 0:P[0];if(R)try{const $=await Sue(R),B="".replace(/\/$/,""),V=$.file_url_abs?$.file_url_abs:(L=$.file_url)!=null&&L.startsWith("http")?$.file_url:`${B}${$.file_url}`;b(`<img src="${V}" alt="${$.original_name||""}" style="max-width:100%;">`)}catch{xe.error("Upload failed")}finally{O.target.value=""}},b=O=>{var R;(R=s.current)==null||R.focus(),document.execCommand("insertHTML",!1,O),c()},w=()=>{var B;const O=window.getSelection();if(!O||O.rangeCount===0)return null;const R=O.getRangeAt(0),P=R.commonAncestorContainer.nodeType===1?R.commonAncestorContainer:R.commonAncestorContainer.parentNode;if(!P)return null;const L=P.querySelectorAll?P.querySelectorAll("img"):[],$=(B=O.anchorNode)==null?void 0:B.parentNode;if($&&$.tagName==="IMG")return $;if($!=null&&$.closest){const V=$.closest("img");if(V)return V}return L.length?L[0]:null},j=O=>{const R=w();if(!R)return xe.info("Select an image first");R.style.width=O,O==="100%"&&(R.style.maxWidth="100%"),c()},S=O=>{const R=w();if(!R)return xe.info("Select an image first");R.classList.remove("float-left","float-right","img-center"),R.style.removeProperty("float"),R.style.removeProperty("display"),R.style.removeProperty("margin-left"),R.style.removeProperty("margin-right"),O==="left"&&R.classList.add("float-left"),O==="right"&&R.classList.add("float-right"),O==="center"&&R.classList.add("img-center"),c()},C=O=>{var L,$;const R=window.getSelection();if(!R||R.rangeCount===0)return null;let P=((L=R.anchorNode)==null?void 0:L.nodeType)===1?R.anchorNode:($=R.anchorNode)==null?void 0:$.parentNode;for(;P;){if(P.tagName&&O.includes(P.tagName))return P;P=P.parentNode}return null},A=O=>{var P;const R=C(["TABLE"])||((P=C(["TD","TH"]))==null?void 0:P.closest("TABLE"));if(!R)return xe.info("Place caret inside a table");R.classList.remove("tbl-border-all","tbl-border-h","tbl-border-v","tbl-border-none"),R.removeAttribute("border"),R.style.borderCollapse="collapse",R.querySelectorAll("th,td").forEach(L=>{L.style.border="",L.style.borderTop="",L.style.borderBottom="",L.style.borderLeft="",L.style.borderRight=""}),O==="all"&&R.classList.add("tbl-border-all"),O==="h"&&R.classList.add("tbl-border-h"),O==="v"&&R.classList.add("tbl-border-v"),O==="none"&&R.classList.add("tbl-border-none"),c()},k=()=>{const O=C(["TD","TH"]);if(!O)return xe.info("Place caret inside a row");O.closest("tr").classList.toggle("tr-shade"),c()},T=O=>{h("div",O===2?"cols-2":"cols-3")},I=O=>{O.preventDefault();const R=O.clipboardData.getData("text/plain");document.execCommand("insertText",!1,R),c()},D=O=>{O.preventDefault();const R=O.dataTransfer.getData("text/x-token")||O.dataTransfer.getData("text/plain");if(R){b(R);return}const P=O.dataTransfer.getData("text");P&&document.execCommand("insertText",!1,P),c()};return a.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 border-b bg-gray-50",children:[a.jsx("select",{className:"text-sm border rounded px-2 py-1",value:i,onChange:O=>{l(O.target.value),d({fontFamily:O.target.value})},title:"Font family",children:$I.map(O=>a.jsx("option",{value:O,children:O.split(",")[0].replace(/['"]/g,"")},O))}),a.jsx("select",{className:"text-sm border rounded px-2 py-1",onChange:O=>d({fontSize:O.target.value}),children:["10px","12px","14px","16px","18px","20px","24px"].map(O=>a.jsx("option",{value:O,children:O},O))}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("bold"),children:a.jsx("b",{children:"B"})}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("italic"),children:a.jsx("i",{children:"I"})}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("underline"),children:a.jsx("u",{children:"U"})}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyLeft"),children:"Left"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyCenter"),children:"Center"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("justifyRight"),children:"Right"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>h("span","text-justify"),children:"Justify"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Text"}),zI.map(O=>a.jsx("button",{className:"w-4 h-4 rounded border",style:{background:O},onClick:()=>u("foreColor",O)},"fg"+O))]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-gray-500 ml-2 mr-1",children:"Highlight"}),zI.map(O=>a.jsx("button",{className:"w-4 h-4 rounded border",style:{background:O},onClick:()=>u("hiliteColor",O)},"bg"+O))]}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertUnorderedList"),children:" List"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>u("insertOrderedList"),children:"1. List"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:m,children:"Image"}),a.jsx("input",{ref:r,type:"file",accept:"image/*",className:"hidden",onChange:x}),a.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:O=>j(O.target.value),defaultValue:"",children:[a.jsx("option",{value:"",disabled:!0,children:"Img Width"}),a.jsx("option",{value:"25%",children:"25%"}),a.jsx("option",{value:"33%",children:"33%"}),a.jsx("option",{value:"50%",children:"50%"}),a.jsx("option",{value:"75%",children:"75%"}),a.jsx("option",{value:"100%",children:"100%"})]}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>S("left"),children:"Img Left"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>S("center"),children:"Img Center"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>S("right"),children:"Img Right"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(2),children:"2 Columns"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>T(3),children:"3 Columns"}),a.jsx("span",{className:"mx-1 w-px h-5 bg-gray-200"}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:()=>b("<table><tr><th>Header</th><th>Header</th></tr><tr><td>Cell</td><td>Cell</td></tr></table>"),children:"Insert Table"}),a.jsxs("select",{className:"text-sm border rounded px-2 py-1",onChange:O=>A(O.target.value),defaultValue:"",children:[a.jsx("option",{value:"",disabled:!0,children:"Borders"}),a.jsx("option",{value:"all",children:"All borders"}),a.jsx("option",{value:"h",children:"Horizontal only"}),a.jsx("option",{value:"v",children:"Vertical only"}),a.jsx("option",{value:"none",children:"No borders"})]}),a.jsx("button",{className:"px-2 py-1 text-sm rounded hover:bg-white",onClick:k,children:"Shade Row"})]}),a.jsx("div",{ref:s,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:I,suppressContentEditableWarning:!0,spellCheck:!1}),a.jsx("div",{ref:s,className:"min-h-[320px] p-3 prose max-w-none focus:outline-none",contentEditable:!0,onInput:c,onPaste:I,onDragOver:O=>O.preventDefault(),onDrop:D,suppressContentEditableWarning:!0,spellCheck:!1}),a.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-500 border-t bg-gray-50",children:"Tip: select an image to resize/align; use columns for magazine-style layouts."})]})}function Nr(t){this.content=t}Nr.prototype={constructor:Nr,find:function(t){for(var n=0;n<this.content.length;n+=2)if(this.content[n]===t)return n;return-1},get:function(t){var n=this.find(t);return n==-1?void 0:this.content[n+1]},update:function(t,n,s){var r=s&&s!=t?this.remove(s):this,i=r.find(t),l=r.content.slice();return i==-1?l.push(s||t,n):(l[i+1]=n,s&&(l[i]=s)),new Nr(l)},remove:function(t){var n=this.find(t);if(n==-1)return this;var s=this.content.slice();return s.splice(n,2),new Nr(s)},addToStart:function(t,n){return new Nr([t,n].concat(this.remove(t).content))},addToEnd:function(t,n){var s=this.remove(t).content.slice();return s.push(t,n),new Nr(s)},addBefore:function(t,n,s){var r=this.remove(n),i=r.content.slice(),l=r.find(t);return i.splice(l==-1?i.length:l,0,n,s),new Nr(i)},forEach:function(t){for(var n=0;n<this.content.length;n+=2)t(this.content[n],this.content[n+1])},prepend:function(t){return t=Nr.from(t),t.size?new Nr(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Nr.from(t),t.size?new Nr(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var n=this;t=Nr.from(t);for(var s=0;s<t.content.length;s+=2)n=n.remove(t.content[s]);return n},toObject:function(){var t={};return this.forEach(function(n,s){t[n]=s}),t},get size(){return this.content.length>>1}};Nr.from=function(t){if(t instanceof Nr)return t;var n=[];if(t)for(var s in t)n.push(s,t[s]);return new Nr(n)};function d9(t,n,s){for(let r=0;;r++){if(r==t.childCount||r==n.childCount)return t.childCount==n.childCount?null:s;let i=t.child(r),l=n.child(r);if(i==l){s+=i.nodeSize;continue}if(!i.sameMarkup(l))return s;if(i.isText&&i.text!=l.text){for(let o=0;i.text[o]==l.text[o];o++)s++;return s}if(i.content.size||l.content.size){let o=d9(i.content,l.content,s+1);if(o!=null)return o}s+=i.nodeSize}}function u9(t,n,s,r){for(let i=t.childCount,l=n.childCount;;){if(i==0||l==0)return i==l?null:{a:s,b:r};let o=t.child(--i),c=n.child(--l),d=o.nodeSize;if(o==c){s-=d,r-=d;continue}if(!o.sameMarkup(c))return{a:s,b:r};if(o.isText&&o.text!=c.text){let u=0,h=Math.min(o.text.length,c.text.length);for(;u<h&&o.text[o.text.length-u-1]==c.text[c.text.length-u-1];)u++,s--,r--;return{a:s,b:r}}if(o.content.size||c.content.size){let u=u9(o.content,c.content,s-1,r-1);if(u)return u}s-=d,r-=d}}class Oe{constructor(n,s){if(this.content=n,this.size=s||0,s==null)for(let r=0;r<n.length;r++)this.size+=n[r].nodeSize}nodesBetween(n,s,r,i=0,l){for(let o=0,c=0;c<s;o++){let d=this.content[o],u=c+d.nodeSize;if(u>n&&r(d,i+c,l||null,o)!==!1&&d.content.size){let h=c+1;d.nodesBetween(Math.max(0,n-h),Math.min(d.content.size,s-h),r,i+h)}c=u}}descendants(n){this.nodesBetween(0,this.size,n)}textBetween(n,s,r,i){let l="",o=!0;return this.nodesBetween(n,s,(c,d)=>{let u=c.isText?c.text.slice(Math.max(n,d)-d,s-d):c.isLeaf?i?typeof i=="function"?i(c):i:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&u||c.isTextblock)&&r&&(o?o=!1:l+=r),l+=u},0),l}append(n){if(!n.size)return this;if(!this.size)return n;let s=this.lastChild,r=n.firstChild,i=this.content.slice(),l=0;for(s.isText&&s.sameMarkup(r)&&(i[i.length-1]=s.withText(s.text+r.text),l=1);l<n.content.length;l++)i.push(n.content[l]);return new Oe(i,this.size+n.size)}cut(n,s=this.size){if(n==0&&s==this.size)return this;let r=[],i=0;if(s>n)for(let l=0,o=0;o<s;l++){let c=this.content[l],d=o+c.nodeSize;d>n&&((o<n||d>s)&&(c.isText?c=c.cut(Math.max(0,n-o),Math.min(c.text.length,s-o)):c=c.cut(Math.max(0,n-o-1),Math.min(c.content.size,s-o-1))),r.push(c),i+=c.nodeSize),o=d}return new Oe(r,i)}cutByIndex(n,s){return n==s?Oe.empty:n==0&&s==this.content.length?this:new Oe(this.content.slice(n,s))}replaceChild(n,s){let r=this.content[n];if(r==s)return this;let i=this.content.slice(),l=this.size+s.nodeSize-r.nodeSize;return i[n]=s,new Oe(i,l)}addToStart(n){return new Oe([n].concat(this.content),this.size+n.nodeSize)}addToEnd(n){return new Oe(this.content.concat(n),this.size+n.nodeSize)}eq(n){if(this.content.length!=n.content.length)return!1;for(let s=0;s<this.content.length;s++)if(!this.content[s].eq(n.content[s]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(n){let s=this.content[n];if(!s)throw new RangeError("Index "+n+" out of range for "+this);return s}maybeChild(n){return this.content[n]||null}forEach(n){for(let s=0,r=0;s<this.content.length;s++){let i=this.content[s];n(i,r,s),r+=i.nodeSize}}findDiffStart(n,s=0){return d9(this,n,s)}findDiffEnd(n,s=this.size,r=n.size){return u9(this,n,s,r)}findIndex(n){if(n==0)return P0(0,n);if(n==this.size)return P0(this.content.length,n);if(n>this.size||n<0)throw new RangeError(`Position ${n} outside of fragment (${this})`);for(let s=0,r=0;;s++){let i=this.child(s),l=r+i.nodeSize;if(l>=n)return l==n?P0(s+1,l):P0(s,r);r=l}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(n=>n.toJSON()):null}static fromJSON(n,s){if(!s)return Oe.empty;if(!Array.isArray(s))throw new RangeError("Invalid input for Fragment.fromJSON");return new Oe(s.map(n.nodeFromJSON))}static fromArray(n){if(!n.length)return Oe.empty;let s,r=0;for(let i=0;i<n.length;i++){let l=n[i];r+=l.nodeSize,i&&l.isText&&n[i-1].sameMarkup(l)?(s||(s=n.slice(0,i)),s[s.length-1]=l.withText(s[s.length-1].text+l.text)):s&&s.push(l)}return new Oe(s||n,r)}static from(n){if(!n)return Oe.empty;if(n instanceof Oe)return n;if(Array.isArray(n))return this.fromArray(n);if(n.attrs)return new Oe([n],n.nodeSize);throw new RangeError("Can not convert "+n+" to a Fragment"+(n.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Oe.empty=new Oe([],0);const DN={index:0,offset:0};function P0(t,n){return DN.index=t,DN.offset=n,DN}function F1(t,n){if(t===n)return!0;if(!(t&&typeof t=="object")||!(n&&typeof n=="object"))return!1;let s=Array.isArray(t);if(Array.isArray(n)!=s)return!1;if(s){if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++)if(!F1(t[r],n[r]))return!1}else{for(let r in t)if(!(r in n)||!F1(t[r],n[r]))return!1;for(let r in n)if(!(r in t))return!1}return!0}let qn=class MS{constructor(n,s){this.type=n,this.attrs=s}addToSet(n){let s,r=!1;for(let i=0;i<n.length;i++){let l=n[i];if(this.eq(l))return n;if(this.type.excludes(l.type))s||(s=n.slice(0,i));else{if(l.type.excludes(this.type))return n;!r&&l.type.rank>this.type.rank&&(s||(s=n.slice(0,i)),s.push(this),r=!0),s&&s.push(l)}}return s||(s=n.slice()),r||s.push(this),s}removeFromSet(n){for(let s=0;s<n.length;s++)if(this.eq(n[s]))return n.slice(0,s).concat(n.slice(s+1));return n}isInSet(n){for(let s=0;s<n.length;s++)if(this.eq(n[s]))return!0;return!1}eq(n){return this==n||this.type==n.type&&F1(this.attrs,n.attrs)}toJSON(){let n={type:this.type.name};for(let s in this.attrs){n.attrs=this.attrs;break}return n}static fromJSON(n,s){if(!s)throw new RangeError("Invalid input for Mark.fromJSON");let r=n.marks[s.type];if(!r)throw new RangeError(`There is no mark type ${s.type} in this schema`);let i=r.create(s.attrs);return r.checkAttrs(i.attrs),i}static sameSet(n,s){if(n==s)return!0;if(n.length!=s.length)return!1;for(let r=0;r<n.length;r++)if(!n[r].eq(s[r]))return!1;return!0}static setFrom(n){if(!n||Array.isArray(n)&&n.length==0)return MS.none;if(n instanceof MS)return[n];let s=n.slice();return s.sort((r,i)=>r.type.rank-i.type.rank),s}};qn.none=[];class $1 extends Error{}class tt{constructor(n,s,r){this.content=n,this.openStart=s,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(n,s){let r=h9(this.content,n+this.openStart,s);return r&&new tt(r,this.openStart,this.openEnd)}removeBetween(n,s){return new tt(f9(this.content,n+this.openStart,s+this.openStart),this.openStart,this.openEnd)}eq(n){return this.content.eq(n.content)&&this.openStart==n.openStart&&this.openEnd==n.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let n={content:this.content.toJSON()};return this.openStart>0&&(n.openStart=this.openStart),this.openEnd>0&&(n.openEnd=this.openEnd),n}static fromJSON(n,s){if(!s)return tt.empty;let r=s.openStart||0,i=s.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new tt(Oe.fromJSON(n,s.content),r,i)}static maxOpen(n,s=!0){let r=0,i=0;for(let l=n.firstChild;l&&!l.isLeaf&&(s||!l.type.spec.isolating);l=l.firstChild)r++;for(let l=n.lastChild;l&&!l.isLeaf&&(s||!l.type.spec.isolating);l=l.lastChild)i++;return new tt(n,r,i)}}tt.empty=new tt(Oe.empty,0,0);function f9(t,n,s){let{index:r,offset:i}=t.findIndex(n),l=t.maybeChild(r),{index:o,offset:c}=t.findIndex(s);if(i==n||l.isText){if(c!=s&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(s))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,l.copy(f9(l.content,n-i-1,s-i-1)))}function h9(t,n,s,r){let{index:i,offset:l}=t.findIndex(n),o=t.maybeChild(i);if(l==n||o.isText)return r&&!r.canReplace(i,i,s)?null:t.cut(0,n).append(s).append(t.cut(n));let c=h9(o.content,n-l-1,s,o);return c&&t.replaceChild(i,o.copy(c))}function Cue(t,n,s){if(s.openStart>t.depth)throw new $1("Inserted content deeper than insertion position");if(t.depth-s.openStart!=n.depth-s.openEnd)throw new $1("Inconsistent open depths");return m9(t,n,s,0)}function m9(t,n,s,r){let i=t.index(r),l=t.node(r);if(i==n.index(r)&&r<t.depth-s.openStart){let o=m9(t,n,s,r+1);return l.copy(l.content.replaceChild(i,o))}else if(s.content.size)if(!s.openStart&&!s.openEnd&&t.depth==r&&n.depth==r){let o=t.parent,c=o.content;return Yd(o,c.cut(0,t.parentOffset).append(s.content).append(c.cut(n.parentOffset)))}else{let{start:o,end:c}=Aue(s,t);return Yd(l,x9(t,o,c,n,r))}else return Yd(l,z1(t,n,r))}function p9(t,n){if(!n.type.compatibleContent(t.type))throw new $1("Cannot join "+n.type.name+" onto "+t.type.name)}function OS(t,n,s){let r=t.node(s);return p9(r,n.node(s)),r}function Kd(t,n){let s=n.length-1;s>=0&&t.isText&&t.sameMarkup(n[s])?n[s]=t.withText(n[s].text+t.text):n.push(t)}function ep(t,n,s,r){let i=(n||t).node(s),l=0,o=n?n.index(s):i.childCount;t&&(l=t.index(s),t.depth>s?l++:t.textOffset&&(Kd(t.nodeAfter,r),l++));for(let c=l;c<o;c++)Kd(i.child(c),r);n&&n.depth==s&&n.textOffset&&Kd(n.nodeBefore,r)}function Yd(t,n){return t.type.checkContent(n),t.copy(n)}function x9(t,n,s,r,i){let l=t.depth>i&&OS(t,n,i+1),o=r.depth>i&&OS(s,r,i+1),c=[];return ep(null,t,i,c),l&&o&&n.index(i)==s.index(i)?(p9(l,o),Kd(Yd(l,x9(t,n,s,r,i+1)),c)):(l&&Kd(Yd(l,z1(t,n,i+1)),c),ep(n,s,i,c),o&&Kd(Yd(o,z1(s,r,i+1)),c)),ep(r,null,i,c),new Oe(c)}function z1(t,n,s){let r=[];if(ep(null,t,s,r),t.depth>s){let i=OS(t,n,s+1);Kd(Yd(i,z1(t,n,s+1)),r)}return ep(n,null,s,r),new Oe(r)}function Aue(t,n){let s=n.depth-t.openStart,i=n.node(s).copy(t.content);for(let l=s-1;l>=0;l--)i=n.node(l).copy(Oe.from(i));return{start:i.resolveNoCache(t.openStart+s),end:i.resolveNoCache(i.content.size-t.openEnd-s)}}class Dp{constructor(n,s,r){this.pos=n,this.path=s,this.parentOffset=r,this.depth=s.length/3-1}resolveDepth(n){return n==null?this.depth:n<0?this.depth+n:n}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(n){return this.path[this.resolveDepth(n)*3]}index(n){return this.path[this.resolveDepth(n)*3+1]}indexAfter(n){return n=this.resolveDepth(n),this.index(n)+(n==this.depth&&!this.textOffset?0:1)}start(n){return n=this.resolveDepth(n),n==0?0:this.path[n*3-1]+1}end(n){return n=this.resolveDepth(n),this.start(n)+this.node(n).content.size}before(n){if(n=this.resolveDepth(n),!n)throw new RangeError("There is no position before the top-level node");return n==this.depth+1?this.pos:this.path[n*3-1]}after(n){if(n=this.resolveDepth(n),!n)throw new RangeError("There is no position after the top-level node");return n==this.depth+1?this.pos:this.path[n*3-1]+this.path[n*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let n=this.parent,s=this.index(this.depth);if(s==n.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=n.child(s);return r?n.child(s).cut(r):i}get nodeBefore(){let n=this.index(this.depth),s=this.pos-this.path[this.path.length-1];return s?this.parent.child(n).cut(0,s):n==0?null:this.parent.child(n-1)}posAtIndex(n,s){s=this.resolveDepth(s);let r=this.path[s*3],i=s==0?0:this.path[s*3-1]+1;for(let l=0;l<n;l++)i+=r.child(l).nodeSize;return i}marks(){let n=this.parent,s=this.index();if(n.content.size==0)return qn.none;if(this.textOffset)return n.child(s).marks;let r=n.maybeChild(s-1),i=n.maybeChild(s);if(!r){let c=r;r=i,i=c}let l=r.marks;for(var o=0;o<l.length;o++)l[o].type.spec.inclusive===!1&&(!i||!l[o].isInSet(i.marks))&&(l=l[o--].removeFromSet(l));return l}marksAcross(n){let s=this.parent.maybeChild(this.index());if(!s||!s.isInline)return null;let r=s.marks,i=n.parent.maybeChild(n.index());for(var l=0;l<r.length;l++)r[l].type.spec.inclusive===!1&&(!i||!r[l].isInSet(i.marks))&&(r=r[l--].removeFromSet(r));return r}sharedDepth(n){for(let s=this.depth;s>0;s--)if(this.start(s)<=n&&this.end(s)>=n)return s;return 0}blockRange(n=this,s){if(n.pos<this.pos)return n.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==n.pos?1:0);r>=0;r--)if(n.pos<=this.end(r)&&(!s||s(this.node(r))))return new U1(this,n,r);return null}sameParent(n){return this.pos-this.parentOffset==n.pos-n.parentOffset}max(n){return n.pos>this.pos?n:this}min(n){return n.pos<this.pos?n:this}toString(){let n="";for(let s=1;s<=this.depth;s++)n+=(n?"/":"")+this.node(s).type.name+"_"+this.index(s-1);return n+":"+this.parentOffset}static resolve(n,s){if(!(s>=0&&s<=n.content.size))throw new RangeError("Position "+s+" out of range");let r=[],i=0,l=s;for(let o=n;;){let{index:c,offset:d}=o.content.findIndex(l),u=l-d;if(r.push(o,c,i+d),!u||(o=o.child(c),o.isText))break;l=u-1,i+=d+1}return new Dp(s,r,l)}static resolveCached(n,s){let r=UI.get(n);if(r)for(let l=0;l<r.elts.length;l++){let o=r.elts[l];if(o.pos==s)return o}else UI.set(n,r=new kue);let i=r.elts[r.i]=Dp.resolve(n,s);return r.i=(r.i+1)%Eue,i}}class kue{constructor(){this.elts=[],this.i=0}}const Eue=12,UI=new WeakMap;class U1{constructor(n,s,r){this.$from=n,this.$to=s,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Tue=Object.create(null);let Tc=class DS{constructor(n,s,r,i=qn.none){this.type=n,this.attrs=s,this.marks=i,this.content=r||Oe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(n){return this.content.child(n)}maybeChild(n){return this.content.maybeChild(n)}forEach(n){this.content.forEach(n)}nodesBetween(n,s,r,i=0){this.content.nodesBetween(n,s,r,i,this)}descendants(n){this.nodesBetween(0,this.content.size,n)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(n,s,r,i){return this.content.textBetween(n,s,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(n){return this==n||this.sameMarkup(n)&&this.content.eq(n.content)}sameMarkup(n){return this.hasMarkup(n.type,n.attrs,n.marks)}hasMarkup(n,s,r){return this.type==n&&F1(this.attrs,s||n.defaultAttrs||Tue)&&qn.sameSet(this.marks,r||qn.none)}copy(n=null){return n==this.content?this:new DS(this.type,this.attrs,n,this.marks)}mark(n){return n==this.marks?this:new DS(this.type,this.attrs,this.content,n)}cut(n,s=this.content.size){return n==0&&s==this.content.size?this:this.copy(this.content.cut(n,s))}slice(n,s=this.content.size,r=!1){if(n==s)return tt.empty;let i=this.resolve(n),l=this.resolve(s),o=r?0:i.sharedDepth(s),c=i.start(o),u=i.node(o).content.cut(i.pos-c,l.pos-c);return new tt(u,i.depth-o,l.depth-o)}replace(n,s,r){return Cue(this.resolve(n),this.resolve(s),r)}nodeAt(n){for(let s=this;;){let{index:r,offset:i}=s.content.findIndex(n);if(s=s.maybeChild(r),!s)return null;if(i==n||s.isText)return s;n-=i+1}}childAfter(n){let{index:s,offset:r}=this.content.findIndex(n);return{node:this.content.maybeChild(s),index:s,offset:r}}childBefore(n){if(n==0)return{node:null,index:0,offset:0};let{index:s,offset:r}=this.content.findIndex(n);if(r<n)return{node:this.content.child(s),index:s,offset:r};let i=this.content.child(s-1);return{node:i,index:s-1,offset:r-i.nodeSize}}resolve(n){return Dp.resolveCached(this,n)}resolveNoCache(n){return Dp.resolve(this,n)}rangeHasMark(n,s,r){let i=!1;return s>n&&this.nodesBetween(n,s,l=>(r.isInSet(l.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let n=this.type.name;return this.content.size&&(n+="("+this.content.toStringInner()+")"),g9(this.marks,n)}contentMatchAt(n){let s=this.type.contentMatch.matchFragment(this.content,0,n);if(!s)throw new Error("Called contentMatchAt on a node with invalid content");return s}canReplace(n,s,r=Oe.empty,i=0,l=r.childCount){let o=this.contentMatchAt(n).matchFragment(r,i,l),c=o&&o.matchFragment(this.content,s);if(!c||!c.validEnd)return!1;for(let d=i;d<l;d++)if(!this.type.allowsMarks(r.child(d).marks))return!1;return!0}canReplaceWith(n,s,r,i){if(i&&!this.type.allowsMarks(i))return!1;let l=this.contentMatchAt(n).matchType(r),o=l&&l.matchFragment(this.content,s);return o?o.validEnd:!1}canAppend(n){return n.content.size?this.canReplace(this.childCount,this.childCount,n.content):this.type.compatibleContent(n.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let n=qn.none;for(let s=0;s<this.marks.length;s++){let r=this.marks[s];r.type.checkAttrs(r.attrs),n=r.addToSet(n)}if(!qn.sameSet(n,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(s=>s.type.name)}`);this.content.forEach(s=>s.check())}toJSON(){let n={type:this.type.name};for(let s in this.attrs){n.attrs=this.attrs;break}return this.content.size&&(n.content=this.content.toJSON()),this.marks.length&&(n.marks=this.marks.map(s=>s.toJSON())),n}static fromJSON(n,s){if(!s)throw new RangeError("Invalid input for Node.fromJSON");let r;if(s.marks){if(!Array.isArray(s.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=s.marks.map(n.markFromJSON)}if(s.type=="text"){if(typeof s.text!="string")throw new RangeError("Invalid text node in JSON");return n.text(s.text,r)}let i=Oe.fromJSON(n,s.content),l=n.nodeType(s.type).create(s.attrs,i,r);return l.type.checkAttrs(l.attrs),l}};Tc.prototype.text=void 0;class V1 extends Tc{constructor(n,s,r,i){if(super(n,s,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):g9(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(n,s){return this.text.slice(n,s)}get nodeSize(){return this.text.length}mark(n){return n==this.marks?this:new V1(this.type,this.attrs,this.text,n)}withText(n){return n==this.text?this:new V1(this.type,this.attrs,n,this.marks)}cut(n=0,s=this.text.length){return n==0&&s==this.text.length?this:this.withText(this.text.slice(n,s))}eq(n){return this.sameMarkup(n)&&this.text==n.text}toJSON(){let n=super.toJSON();return n.text=this.text,n}}function g9(t,n){for(let s=t.length-1;s>=0;s--)n=t[s].type.name+"("+n+")";return n}class uu{constructor(n){this.validEnd=n,this.next=[],this.wrapCache=[]}static parse(n,s){let r=new Iue(n,s);if(r.next==null)return uu.empty;let i=y9(r);r.next&&r.err("Unexpected trailing text");let l=Bue(Lue(i));return Fue(l,r),l}matchType(n){for(let s=0;s<this.next.length;s++)if(this.next[s].type==n)return this.next[s].next;return null}matchFragment(n,s=0,r=n.childCount){let i=this;for(let l=s;i&&l<r;l++)i=i.matchType(n.child(l).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let n=0;n<this.next.length;n++){let{type:s}=this.next[n];if(!(s.isText||s.hasRequiredAttrs()))return s}return null}compatible(n){for(let s=0;s<this.next.length;s++)for(let r=0;r<n.next.length;r++)if(this.next[s].type==n.next[r].type)return!0;return!1}fillBefore(n,s=!1,r=0){let i=[this];function l(o,c){let d=o.matchFragment(n,r);if(d&&(!s||d.validEnd))return Oe.from(c.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:h,next:m}=o.next[u];if(!(h.isText||h.hasRequiredAttrs())&&i.indexOf(m)==-1){i.push(m);let x=l(m,c.concat(h));if(x)return x}}return null}return l(this,[])}findWrapping(n){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==n)return this.wrapCache[r+1];let s=this.computeWrapping(n);return this.wrapCache.push(n,s),s}computeWrapping(n){let s=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),l=i.match;if(l.matchType(n)){let o=[];for(let c=i;c.type;c=c.via)o.push(c.type);return o.reverse()}for(let o=0;o<l.next.length;o++){let{type:c,next:d}=l.next[o];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in s)&&(!i.type||d.validEnd)&&(r.push({match:c.contentMatch,type:c,via:i}),s[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(n){if(n>=this.next.length)throw new RangeError(`There's no ${n}th edge in this content match`);return this.next[n]}toString(){let n=[];function s(r){n.push(r);for(let i=0;i<r.next.length;i++)n.indexOf(r.next[i].next)==-1&&s(r.next[i].next)}return s(this),n.map((r,i)=>{let l=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)l+=(o?", ":"")+r.next[o].type.name+"->"+n.indexOf(r.next[o].next);return l}).join(`
`)}}uu.empty=new uu(!0);class Iue{constructor(n,s){this.string=n,this.nodeTypes=s,this.inline=null,this.pos=0,this.tokens=n.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(n){return this.next==n&&(this.pos++||!0)}err(n){throw new SyntaxError(n+" (in content expression '"+this.string+"')")}}function y9(t){let n=[];do n.push(Pue(t));while(t.eat("|"));return n.length==1?n[0]:{type:"choice",exprs:n}}function Pue(t){let n=[];do n.push(Mue(t));while(t.next&&t.next!=")"&&t.next!="|");return n.length==1?n[0]:{type:"seq",exprs:n}}function Mue(t){let n=Rue(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=Oue(t,n);else break;return n}function VI(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let n=Number(t.next);return t.pos++,n}function Oue(t,n){let s=VI(t),r=s;return t.eat(",")&&(t.next!="}"?r=VI(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:s,max:r,expr:n}}function Due(t,n){let s=t.nodeTypes,r=s[n];if(r)return[r];let i=[];for(let l in s){let o=s[l];o.isInGroup(n)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+n+"' found"),i}function Rue(t){if(t.eat("(")){let n=y9(t);return t.eat(")")||t.err("Missing closing paren"),n}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let n=Due(t,t.next).map(s=>(t.inline==null?t.inline=s.isInline:t.inline!=s.isInline&&t.err("Mixing inline and block content"),{type:"name",value:s}));return t.pos++,n.length==1?n[0]:{type:"choice",exprs:n}}}function Lue(t){let n=[[]];return i(l(t,0),s()),n;function s(){return n.push([])-1}function r(o,c,d){let u={term:d,to:c};return n[o].push(u),u}function i(o,c){o.forEach(d=>d.to=c)}function l(o,c){if(o.type=="choice")return o.exprs.reduce((d,u)=>d.concat(l(u,c)),[]);if(o.type=="seq")for(let d=0;;d++){let u=l(o.exprs[d],c);if(d==o.exprs.length-1)return u;i(u,c=s())}else if(o.type=="star"){let d=s();return r(c,d),i(l(o.expr,d),d),[r(d)]}else if(o.type=="plus"){let d=s();return i(l(o.expr,c),d),i(l(o.expr,d),d),[r(d)]}else{if(o.type=="opt")return[r(c)].concat(l(o.expr,c));if(o.type=="range"){let d=c;for(let u=0;u<o.min;u++){let h=s();i(l(o.expr,d),h),d=h}if(o.max==-1)i(l(o.expr,d),d);else for(let u=o.min;u<o.max;u++){let h=s();r(d,h),i(l(o.expr,d),h),d=h}return[r(d)]}else{if(o.type=="name")return[r(c,void 0,o.value)];throw new Error("Unknown expr type")}}}}function b9(t,n){return n-t}function HI(t,n){let s=[];return r(n),s.sort(b9);function r(i){let l=t[i];if(l.length==1&&!l[0].term)return r(l[0].to);s.push(i);for(let o=0;o<l.length;o++){let{term:c,to:d}=l[o];!c&&s.indexOf(d)==-1&&r(d)}}}function Bue(t){let n=Object.create(null);return s(HI(t,0));function s(r){let i=[];r.forEach(o=>{t[o].forEach(({term:c,to:d})=>{if(!c)return;let u;for(let h=0;h<i.length;h++)i[h][0]==c&&(u=i[h][1]);HI(t,d).forEach(h=>{u||i.push([c,u=[]]),u.indexOf(h)==-1&&u.push(h)})})});let l=n[r.join(",")]=new uu(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let c=i[o][1].sort(b9);l.next.push({type:i[o][0],next:n[c.join(",")]||s(c)})}return l}}function Fue(t,n){for(let s=0,r=[t];s<r.length;s++){let i=r[s],l=!i.validEnd,o=[];for(let c=0;c<i.next.length;c++){let{type:d,next:u}=i.next[c];o.push(d.name),l&&!(d.isText||d.hasRequiredAttrs())&&(l=!1),r.indexOf(u)==-1&&r.push(u)}l&&n.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function v9(t){let n=Object.create(null);for(let s in t){let r=t[s];if(!r.hasDefault)return null;n[s]=r.default}return n}function w9(t,n){let s=Object.create(null);for(let r in t){let i=n&&n[r];if(i===void 0){let l=t[r];if(l.hasDefault)i=l.default;else throw new RangeError("No value supplied for attribute "+r)}s[r]=i}return s}function N9(t,n,s,r){for(let i in n)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${s} of type ${i}`);for(let i in t){let l=t[i];l.validate&&l.validate(n[i])}}function j9(t,n){let s=Object.create(null);if(n)for(let r in n)s[r]=new zue(t,r,n[r]);return s}let WI=class S9{constructor(n,s,r){this.name=n,this.schema=s,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=j9(n,r.attrs),this.defaultAttrs=v9(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||n=="text"),this.isText=n=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==uu.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(n){return this.groups.indexOf(n)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1}compatibleContent(n){return this==n||this.contentMatch.compatible(n.contentMatch)}computeAttrs(n){return!n&&this.defaultAttrs?this.defaultAttrs:w9(this.attrs,n)}create(n=null,s,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Tc(this,this.computeAttrs(n),Oe.from(s),qn.setFrom(r))}createChecked(n=null,s,r){return s=Oe.from(s),this.checkContent(s),new Tc(this,this.computeAttrs(n),s,qn.setFrom(r))}createAndFill(n=null,s,r){if(n=this.computeAttrs(n),s=Oe.from(s),s.size){let o=this.contentMatch.fillBefore(s);if(!o)return null;s=o.append(s)}let i=this.contentMatch.matchFragment(s),l=i&&i.fillBefore(Oe.empty,!0);return l?new Tc(this,n,s.append(l),qn.setFrom(r)):null}validContent(n){let s=this.contentMatch.matchFragment(n);if(!s||!s.validEnd)return!1;for(let r=0;r<n.childCount;r++)if(!this.allowsMarks(n.child(r).marks))return!1;return!0}checkContent(n){if(!this.validContent(n))throw new RangeError(`Invalid content for node ${this.name}: ${n.toString().slice(0,50)}`)}checkAttrs(n){N9(this.attrs,n,"node",this.name)}allowsMarkType(n){return this.markSet==null||this.markSet.indexOf(n)>-1}allowsMarks(n){if(this.markSet==null)return!0;for(let s=0;s<n.length;s++)if(!this.allowsMarkType(n[s].type))return!1;return!0}allowedMarks(n){if(this.markSet==null)return n;let s;for(let r=0;r<n.length;r++)this.allowsMarkType(n[r].type)?s&&s.push(n[r]):s||(s=n.slice(0,r));return s?s.length?s:qn.none:n}static compile(n,s){let r=Object.create(null);n.forEach((l,o)=>r[l]=new S9(l,s,o));let i=s.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let l in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function $ue(t,n,s){let r=s.split("|");return i=>{let l=i===null?"null":typeof i;if(r.indexOf(l)<0)throw new RangeError(`Expected value of type ${r} for attribute ${n} on type ${t}, got ${l}`)}}class zue{constructor(n,s,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?$ue(n,s,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Lb{constructor(n,s,r,i){this.name=n,this.rank=s,this.schema=r,this.spec=i,this.attrs=j9(n,i.attrs),this.excluded=null;let l=v9(this.attrs);this.instance=l?new qn(this,l):null}create(n=null){return!n&&this.instance?this.instance:new qn(this,w9(this.attrs,n))}static compile(n,s){let r=Object.create(null),i=0;return n.forEach((l,o)=>r[l]=new Lb(l,i++,s,o)),r}removeFromSet(n){for(var s=0;s<n.length;s++)n[s].type==this&&(n=n.slice(0,s).concat(n.slice(s+1)),s--);return n}isInSet(n){for(let s=0;s<n.length;s++)if(n[s].type==this)return n[s]}checkAttrs(n){N9(this.attrs,n,"mark",this.name)}excludes(n){return this.excluded.indexOf(n)>-1}}class _9{constructor(n){this.linebreakReplacement=null,this.cached=Object.create(null);let s=this.spec={};for(let i in n)s[i]=n[i];s.nodes=Nr.from(n.nodes),s.marks=Nr.from(n.marks||{}),this.nodes=WI.compile(this.spec.nodes,this),this.marks=Lb.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let l=this.nodes[i],o=l.spec.content||"",c=l.spec.marks;if(l.contentMatch=r[o]||(r[o]=uu.parse(o,this.nodes)),l.inlineContent=l.contentMatch.inlineContent,l.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!l.isInline||!l.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=l}l.markSet=c=="_"?null:c?qI(this,c.split(" ")):c==""||!l.inlineContent?[]:null}for(let i in this.marks){let l=this.marks[i],o=l.spec.excludes;l.excluded=o==null?[l]:o==""?[]:qI(this,o.split(" "))}this.nodeFromJSON=i=>Tc.fromJSON(this,i),this.markFromJSON=i=>qn.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(n,s=null,r,i){if(typeof n=="string")n=this.nodeType(n);else if(n instanceof WI){if(n.schema!=this)throw new RangeError("Node type from different schema used ("+n.name+")")}else throw new RangeError("Invalid node type: "+n);return n.createChecked(s,r,i)}text(n,s){let r=this.nodes.text;return new V1(r,r.defaultAttrs,n,qn.setFrom(s))}mark(n,s){return typeof n=="string"&&(n=this.marks[n]),n.create(s)}nodeType(n){let s=this.nodes[n];if(!s)throw new RangeError("Unknown node type: "+n);return s}}function qI(t,n){let s=[];for(let r=0;r<n.length;r++){let i=n[r],l=t.marks[i],o=l;if(l)s.push(l);else for(let c in t.marks){let d=t.marks[c];(i=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(i)>-1)&&s.push(o=d)}if(!o)throw new SyntaxError("Unknown mark type: '"+n[r]+"'")}return s}function Uue(t){return t.tag!=null}function Vue(t){return t.style!=null}class Ml{constructor(n,s){this.schema=n,this.rules=s,this.tags=[],this.styles=[];let r=this.matchedStyles=[];s.forEach(i=>{if(Uue(i))this.tags.push(i);else if(Vue(i)){let l=/[^=]*/.exec(i.style)[0];r.indexOf(l)<0&&r.push(l),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let l=n.nodes[i.node];return l.contentMatch.matchType(l)})}parse(n,s={}){let r=new KI(this,s,!1);return r.addAll(n,qn.none,s.from,s.to),r.finish()}parseSlice(n,s={}){let r=new KI(this,s,!0);return r.addAll(n,qn.none,s.from,s.to),tt.maxOpen(r.finish())}matchTag(n,s,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let l=this.tags[i];if(que(n,l.tag)&&(l.namespace===void 0||n.namespaceURI==l.namespace)&&(!l.context||s.matchesContext(l.context))){if(l.getAttrs){let o=l.getAttrs(n);if(o===!1)continue;l.attrs=o||void 0}return l}}}matchStyle(n,s,r,i){for(let l=i?this.styles.indexOf(i)+1:0;l<this.styles.length;l++){let o=this.styles[l],c=o.style;if(!(c.indexOf(n)!=0||o.context&&!r.matchesContext(o.context)||c.length>n.length&&(c.charCodeAt(n.length)!=61||c.slice(n.length+1)!=s))){if(o.getAttrs){let d=o.getAttrs(s);if(d===!1)continue;o.attrs=d||void 0}return o}}}static schemaRules(n){let s=[];function r(i){let l=i.priority==null?50:i.priority,o=0;for(;o<s.length;o++){let c=s[o];if((c.priority==null?50:c.priority)<l)break}s.splice(o,0,i)}for(let i in n.marks){let l=n.marks[i].spec.parseDOM;l&&l.forEach(o=>{r(o=YI(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in n.nodes){let l=n.nodes[i].spec.parseDOM;l&&l.forEach(o=>{r(o=YI(o)),o.node||o.ignore||o.mark||(o.node=i)})}return s}static fromSchema(n){return n.cached.domParser||(n.cached.domParser=new Ml(n,Ml.schemaRules(n)))}}const C9={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Hue={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},A9={ol:!0,ul:!0},Rp=1,RS=2,tp=4;function GI(t,n,s){return n!=null?(n?Rp:0)|(n==="full"?RS:0):t&&t.whitespace=="pre"?Rp|RS:s&~tp}class M0{constructor(n,s,r,i,l,o){this.type=n,this.attrs=s,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=qn.none,this.match=l||(o&tp?null:n.contentMatch)}findWrapping(n){if(!this.match){if(!this.type)return[];let s=this.type.contentMatch.fillBefore(Oe.from(n));if(s)this.match=this.type.contentMatch.matchFragment(s);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(n.type))?(this.match=r,i):null}}return this.match.findWrapping(n.type)}finish(n){if(!(this.options&Rp)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let l=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=l.withText(l.text.slice(0,l.text.length-i[0].length))}}let s=Oe.from(this.content);return!n&&this.match&&(s=s.append(this.match.fillBefore(Oe.empty,!0))),this.type?this.type.create(this.attrs,s,this.marks):s}inlineContext(n){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:n.parentNode&&!C9.hasOwnProperty(n.parentNode.nodeName.toLowerCase())}}class KI{constructor(n,s,r){this.parser=n,this.options=s,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=s.topNode,l,o=GI(null,s.preserveWhitespace,0)|(r?tp:0);i?l=new M0(i.type,i.attrs,qn.none,!0,s.topMatch||i.type.contentMatch,o):r?l=new M0(null,null,qn.none,!0,null,o):l=new M0(n.schema.topNodeType,null,qn.none,!0,null,o),this.nodes=[l],this.find=s.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(n,s){n.nodeType==3?this.addTextNode(n,s):n.nodeType==1&&this.addElement(n,s)}addTextNode(n,s){let r=n.nodeValue,i=this.top,l=i.options&RS?"full":this.localPreserveWS||(i.options&Rp)>0,{schema:o}=this.parser;if(l==="full"||i.inlineContext(n)||/[^ \t\r\n\u000c]/.test(r)){if(l)if(l==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let c=r.split(/\r?\n|\r/);for(let d=0;d<c.length;d++)d&&this.insertNode(o.linebreakReplacement.create(),s,!0),c[d]&&this.insertNode(o.text(c[d]),s,!/\S/.test(c[d]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let c=i.content[i.content.length-1],d=n.previousSibling;(!c||d&&d.nodeName=="BR"||c.isText&&/[ \t\r\n\u000c]$/.test(c.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),s,!/\S/.test(r)),this.findInText(n)}else this.findInside(n)}addElement(n,s,r){let i=this.localPreserveWS,l=this.top;(n.tagName=="PRE"||/pre/.test(n.style&&n.style.whiteSpace))&&(this.localPreserveWS=!0);let o=n.nodeName.toLowerCase(),c;A9.hasOwnProperty(o)&&this.parser.normalizeLists&&Wue(n);let d=this.options.ruleFromNode&&this.options.ruleFromNode(n)||(c=this.parser.matchTag(n,this,r));e:if(d?d.ignore:Hue.hasOwnProperty(o))this.findInside(n),this.ignoreFallback(n,s);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(n=d.skip);let u,h=this.needsBlock;if(C9.hasOwnProperty(o))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),u=!0,l.type||(this.needsBlock=!0);else if(!n.firstChild){this.leafFallback(n,s);break e}let m=d&&d.skip?s:this.readStyles(n,s);m&&this.addAll(n,m),u&&this.sync(l),this.needsBlock=h}else{let u=this.readStyles(n,s);u&&this.addElementByRule(n,d,u,d.consuming===!1?c:void 0)}this.localPreserveWS=i}leafFallback(n,s){n.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(n.ownerDocument.createTextNode(`
`),s)}ignoreFallback(n,s){n.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),s,!0)}readStyles(n,s){let r=n.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let l=this.parser.matchedStyles[i],o=r.getPropertyValue(l);if(o)for(let c=void 0;;){let d=this.parser.matchStyle(l,o,this,c);if(!d)break;if(d.ignore)return null;if(d.clearMark?s=s.filter(u=>!d.clearMark(u)):s=s.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)c=d;else break}}return s}addElementByRule(n,s,r,i){let l,o;if(s.node)if(o=this.parser.schema.nodes[s.node],o.isLeaf)this.insertNode(o.create(s.attrs),r,n.nodeName=="BR")||this.leafFallback(n,r);else{let d=this.enter(o,s.attrs||null,r,s.preserveWhitespace);d&&(l=!0,r=d)}else{let d=this.parser.schema.marks[s.mark];r=r.concat(d.create(s.attrs))}let c=this.top;if(o&&o.isLeaf)this.findInside(n);else if(i)this.addElement(n,r,i);else if(s.getContent)this.findInside(n),s.getContent(n,this.parser.schema).forEach(d=>this.insertNode(d,r,!1));else{let d=n;typeof s.contentElement=="string"?d=n.querySelector(s.contentElement):typeof s.contentElement=="function"?d=s.contentElement(n):s.contentElement&&(d=s.contentElement),this.findAround(n,d,!0),this.addAll(d,r),this.findAround(n,d,!1)}l&&this.sync(c)&&this.open--}addAll(n,s,r,i){let l=r||0;for(let o=r?n.childNodes[r]:n.firstChild,c=i==null?null:n.childNodes[i];o!=c;o=o.nextSibling,++l)this.findAtPoint(n,l),this.addDOM(o,s);this.findAtPoint(n,l)}findPlace(n,s,r){let i,l;for(let o=this.open,c=0;o>=0;o--){let d=this.nodes[o],u=d.findWrapping(n);if(u&&(!i||i.length>u.length+c)&&(i=u,l=d,!u.length))break;if(d.solid){if(r)break;c+=2}}if(!i)return null;this.sync(l);for(let o=0;o<i.length;o++)s=this.enterInner(i[o],null,s,!1);return s}insertNode(n,s,r){if(n.isInline&&this.needsBlock&&!this.top.type){let l=this.textblockFromContext();l&&(s=this.enterInner(l,null,s))}let i=this.findPlace(n,s,r);if(i){this.closeExtra();let l=this.top;l.match&&(l.match=l.match.matchType(n.type));let o=qn.none;for(let c of i.concat(n.marks))(l.type?l.type.allowsMarkType(c.type):XI(c.type,n.type))&&(o=c.addToSet(o));return l.content.push(n.mark(o)),!0}return!1}enter(n,s,r,i){let l=this.findPlace(n.create(s),r,!1);return l&&(l=this.enterInner(n,s,r,!0,i)),l}enterInner(n,s,r,i=!1,l){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(n);let c=GI(n,l,o.options);o.options&tp&&o.content.length==0&&(c|=tp);let d=qn.none;return r=r.filter(u=>(o.type?o.type.allowsMarkType(u.type):XI(u.type,n))?(d=u.addToSet(d),!1):!0),this.nodes.push(new M0(n,s,d,i,null,c)),this.open++,r}closeExtra(n=!1){let s=this.nodes.length-1;if(s>this.open){for(;s>this.open;s--)this.nodes[s-1].content.push(this.nodes[s].finish(n));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(n){for(let s=this.open;s>=0;s--){if(this.nodes[s]==n)return this.open=s,!0;this.localPreserveWS&&(this.nodes[s].options|=Rp)}return!1}get currentPos(){this.closeExtra();let n=0;for(let s=this.open;s>=0;s--){let r=this.nodes[s].content;for(let i=r.length-1;i>=0;i--)n+=r[i].nodeSize;s&&n++}return n}findAtPoint(n,s){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==n&&this.find[r].offset==s&&(this.find[r].pos=this.currentPos)}findInside(n){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&n.nodeType==1&&n.contains(this.find[s].node)&&(this.find[s].pos=this.currentPos)}findAround(n,s,r){if(n!=s&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&n.nodeType==1&&n.contains(this.find[i].node)&&s.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(n){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].node==n&&(this.find[s].pos=this.currentPos-(n.nodeValue.length-this.find[s].offset))}matchesContext(n){if(n.indexOf("|")>-1)return n.split(/\s*\|\s*/).some(this.matchesContext,this);let s=n.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),l=-(r?r.depth+1:0)+(i?0:1),o=(c,d)=>{for(;c>=0;c--){let u=s[c];if(u==""){if(c==s.length-1||c==0)continue;for(;d>=l;d--)if(o(c-1,d))return!0;return!1}else{let h=d>0||d==0&&i?this.nodes[d].type:r&&d>=l?r.node(d-l).type:null;if(!h||h.name!=u&&!h.isInGroup(u))return!1;d--}}return!0};return o(s.length-1,this.open)}textblockFromContext(){let n=this.options.context;if(n)for(let s=n.depth;s>=0;s--){let r=n.node(s).contentMatchAt(n.indexAfter(s)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let s in this.parser.schema.nodes){let r=this.parser.schema.nodes[s];if(r.isTextblock&&r.defaultAttrs)return r}}}function Wue(t){for(let n=t.firstChild,s=null;n;n=n.nextSibling){let r=n.nodeType==1?n.nodeName.toLowerCase():null;r&&A9.hasOwnProperty(r)&&s?(s.appendChild(n),n=s):r=="li"?s=n:r&&(s=null)}}function que(t,n){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,n)}function YI(t){let n={};for(let s in t)n[s]=t[s];return n}function XI(t,n){let s=n.schema.nodes;for(let r in s){let i=s[r];if(!i.allowsMarkType(t))continue;let l=[],o=c=>{l.push(c);for(let d=0;d<c.edgeCount;d++){let{type:u,next:h}=c.edge(d);if(u==n||l.indexOf(h)<0&&o(h))return!0}};if(o(i.contentMatch))return!0}}class Bb{constructor(n,s){this.nodes=n,this.marks=s}serializeFragment(n,s={},r){r||(r=RN(s).createDocumentFragment());let i=r,l=[];return n.forEach(o=>{if(l.length||o.marks.length){let c=0,d=0;for(;c<l.length&&d<o.marks.length;){let u=o.marks[d];if(!this.marks[u.type.name]){d++;continue}if(!u.eq(l[c][0])||u.type.spec.spanning===!1)break;c++,d++}for(;c<l.length;)i=l.pop()[1];for(;d<o.marks.length;){let u=o.marks[d++],h=this.serializeMark(u,o.isInline,s);h&&(l.push([u,i]),i.appendChild(h.dom),i=h.contentDOM||h.dom)}}i.appendChild(this.serializeNodeInner(o,s))}),r}serializeNodeInner(n,s){let{dom:r,contentDOM:i}=Lg(RN(s),this.nodes[n.type.name](n),null,n.attrs);if(i){if(n.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(n.content,s,i)}return r}serializeNode(n,s={}){let r=this.serializeNodeInner(n,s);for(let i=n.marks.length-1;i>=0;i--){let l=this.serializeMark(n.marks[i],n.isInline,s);l&&((l.contentDOM||l.dom).appendChild(r),r=l.dom)}return r}serializeMark(n,s,r={}){let i=this.marks[n.type.name];return i&&Lg(RN(r),i(n,s),null,n.attrs)}static renderSpec(n,s,r=null,i){return Lg(n,s,r,i)}static fromSchema(n){return n.cached.domSerializer||(n.cached.domSerializer=new Bb(this.nodesFromSchema(n),this.marksFromSchema(n)))}static nodesFromSchema(n){let s=QI(n.nodes);return s.text||(s.text=r=>r.text),s}static marksFromSchema(n){return QI(n.marks)}}function QI(t){let n={};for(let s in t){let r=t[s].spec.toDOM;r&&(n[s]=r)}return n}function RN(t){return t.document||window.document}const ZI=new WeakMap;function Gue(t){let n=ZI.get(t);return n===void 0&&ZI.set(t,n=Kue(t)),n}function Kue(t){let n=null;function s(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")n||(n=[]),n.push(r);else for(let i=0;i<r.length;i++)s(r[i]);else for(let i in r)s(r[i])}return s(t),n}function Lg(t,n,s,r){if(typeof n=="string")return{dom:t.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let i=n[0],l;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(l=Gue(r))&&l.indexOf(n)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(s=i.slice(0,o),i=i.slice(o+1));let c,d=s?t.createElementNS(s,i):t.createElement(i),u=n[1],h=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){h=2;for(let m in u)if(u[m]!=null){let x=m.indexOf(" ");x>0?d.setAttributeNS(m.slice(0,x),m.slice(x+1),u[m]):m=="style"&&d.style?d.style.cssText=u[m]:d.setAttribute(m,u[m])}}for(let m=h;m<n.length;m++){let x=n[m];if(x===0){if(m<n.length-1||m>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:b,contentDOM:w}=Lg(t,x,s,r);if(d.appendChild(b),w){if(c)throw new RangeError("Multiple content holes");c=w}}}return{dom:d,contentDOM:c}}const k9=65535,E9=Math.pow(2,16);function Yue(t,n){return t+n*E9}function JI(t){return t&k9}function Xue(t){return(t-(t&k9))/E9}const T9=1,I9=2,Bg=4,P9=8;class LS{constructor(n,s,r){this.pos=n,this.delInfo=s,this.recover=r}get deleted(){return(this.delInfo&P9)>0}get deletedBefore(){return(this.delInfo&(T9|Bg))>0}get deletedAfter(){return(this.delInfo&(I9|Bg))>0}get deletedAcross(){return(this.delInfo&Bg)>0}}class Ba{constructor(n,s=!1){if(this.ranges=n,this.inverted=s,!n.length&&Ba.empty)return Ba.empty}recover(n){let s=0,r=JI(n);if(!this.inverted)for(let i=0;i<r;i++)s+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+s+Xue(n)}mapResult(n,s=1){return this._map(n,s,!1)}map(n,s=1){return this._map(n,s,!0)}_map(n,s,r){let i=0,l=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?i:0);if(d>n)break;let u=this.ranges[c+l],h=this.ranges[c+o],m=d+u;if(n<=m){let x=u?n==d?-1:n==m?1:s:s,b=d+i+(x<0?0:h);if(r)return b;let w=n==(s<0?d:m)?null:Yue(c/3,n-d),j=n==d?I9:n==m?T9:Bg;return(s<0?n!=d:n!=m)&&(j|=P9),new LS(b,j,w)}i+=h-u}return r?n+i:new LS(n+i,0,null)}touches(n,s){let r=0,i=JI(s),l=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let d=this.ranges[c]-(this.inverted?r:0);if(d>n)break;let u=this.ranges[c+l],h=d+u;if(n<=h&&c==i*3)return!0;r+=this.ranges[c+o]-u}return!1}forEach(n){let s=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,l=0;i<this.ranges.length;i+=3){let o=this.ranges[i],c=o-(this.inverted?l:0),d=o+(this.inverted?0:l),u=this.ranges[i+s],h=this.ranges[i+r];n(c,c+u,d,d+h),l+=h-u}}invert(){return new Ba(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(n){return n==0?Ba.empty:new Ba(n<0?[0,-n,0]:[0,0,n])}}Ba.empty=new Ba([]);class Lp{constructor(n,s,r=0,i=n?n.length:0){this.mirror=s,this.from=r,this.to=i,this._maps=n||[],this.ownData=!(n||s)}get maps(){return this._maps}slice(n=0,s=this.maps.length){return new Lp(this._maps,this.mirror,n,s)}appendMap(n,s){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(n),s!=null&&this.setMirror(this._maps.length-1,s)}appendMapping(n){for(let s=0,r=this._maps.length;s<n._maps.length;s++){let i=n.getMirror(s);this.appendMap(n._maps[s],i!=null&&i<s?r+i:void 0)}}getMirror(n){if(this.mirror){for(let s=0;s<this.mirror.length;s++)if(this.mirror[s]==n)return this.mirror[s+(s%2?-1:1)]}}setMirror(n,s){this.mirror||(this.mirror=[]),this.mirror.push(n,s)}appendMappingInverted(n){for(let s=n.maps.length-1,r=this._maps.length+n._maps.length;s>=0;s--){let i=n.getMirror(s);this.appendMap(n._maps[s].invert(),i!=null&&i>s?r-i-1:void 0)}}invert(){let n=new Lp;return n.appendMappingInverted(this),n}map(n,s=1){if(this.mirror)return this._map(n,s,!0);for(let r=this.from;r<this.to;r++)n=this._maps[r].map(n,s);return n}mapResult(n,s=1){return this._map(n,s,!1)}_map(n,s,r){let i=0;for(let l=this.from;l<this.to;l++){let o=this._maps[l],c=o.mapResult(n,s);if(c.recover!=null){let d=this.getMirror(l);if(d!=null&&d>l&&d<this.to){l=d,n=this._maps[d].recover(c.recover);continue}}i|=c.delInfo,n=c.pos}return r?n:new LS(n,i,null)}}const LN=Object.create(null);let Yr=class{getMap(){return Ba.empty}merge(n){return null}static fromJSON(n,s){if(!s||!s.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=LN[s.stepType];if(!r)throw new RangeError(`No step type ${s.stepType} defined`);return r.fromJSON(n,s)}static jsonID(n,s){if(n in LN)throw new RangeError("Duplicate use of step JSON ID "+n);return LN[n]=s,s.prototype.jsonID=n,s}};class Ts{constructor(n,s){this.doc=n,this.failed=s}static ok(n){return new Ts(n,null)}static fail(n){return new Ts(null,n)}static fromReplace(n,s,r,i){try{return Ts.ok(n.replace(s,r,i))}catch(l){if(l instanceof $1)return Ts.fail(l.message);throw l}}}function nA(t,n,s){let r=[];for(let i=0;i<t.childCount;i++){let l=t.child(i);l.content.size&&(l=l.copy(nA(l.content,n,l))),l.isInline&&(l=n(l,s,i)),r.push(l)}return Oe.fromArray(r)}class yc extends Yr{constructor(n,s,r){super(),this.from=n,this.to=s,this.mark=r}apply(n){let s=n.slice(this.from,this.to),r=n.resolve(this.from),i=r.node(r.sharedDepth(this.to)),l=new tt(nA(s.content,(o,c)=>!o.isAtom||!c.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),s.openStart,s.openEnd);return Ts.fromReplace(n,this.from,this.to,l)}invert(){return new Ki(this.from,this.to,this.mark)}map(n){let s=n.mapResult(this.from,1),r=n.mapResult(this.to,-1);return s.deleted&&r.deleted||s.pos>=r.pos?null:new yc(s.pos,r.pos,this.mark)}merge(n){return n instanceof yc&&n.mark.eq(this.mark)&&this.from<=n.to&&this.to>=n.from?new yc(Math.min(this.from,n.from),Math.max(this.to,n.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(n,s){if(typeof s.from!="number"||typeof s.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new yc(s.from,s.to,n.markFromJSON(s.mark))}}Yr.jsonID("addMark",yc);class Ki extends Yr{constructor(n,s,r){super(),this.from=n,this.to=s,this.mark=r}apply(n){let s=n.slice(this.from,this.to),r=new tt(nA(s.content,i=>i.mark(this.mark.removeFromSet(i.marks)),n),s.openStart,s.openEnd);return Ts.fromReplace(n,this.from,this.to,r)}invert(){return new yc(this.from,this.to,this.mark)}map(n){let s=n.mapResult(this.from,1),r=n.mapResult(this.to,-1);return s.deleted&&r.deleted||s.pos>=r.pos?null:new Ki(s.pos,r.pos,this.mark)}merge(n){return n instanceof Ki&&n.mark.eq(this.mark)&&this.from<=n.to&&this.to>=n.from?new Ki(Math.min(this.from,n.from),Math.max(this.to,n.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(n,s){if(typeof s.from!="number"||typeof s.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ki(s.from,s.to,n.markFromJSON(s.mark))}}Yr.jsonID("removeMark",Ki);class bc extends Yr{constructor(n,s){super(),this.pos=n,this.mark=s}apply(n){let s=n.nodeAt(this.pos);if(!s)return Ts.fail("No node at mark step's position");let r=s.type.create(s.attrs,null,this.mark.addToSet(s.marks));return Ts.fromReplace(n,this.pos,this.pos+1,new tt(Oe.from(r),0,s.isLeaf?0:1))}invert(n){let s=n.nodeAt(this.pos);if(s){let r=this.mark.addToSet(s.marks);if(r.length==s.marks.length){for(let i=0;i<s.marks.length;i++)if(!s.marks[i].isInSet(r))return new bc(this.pos,s.marks[i]);return new bc(this.pos,this.mark)}}return new fu(this.pos,this.mark)}map(n){let s=n.mapResult(this.pos,1);return s.deletedAfter?null:new bc(s.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(n,s){if(typeof s.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new bc(s.pos,n.markFromJSON(s.mark))}}Yr.jsonID("addNodeMark",bc);class fu extends Yr{constructor(n,s){super(),this.pos=n,this.mark=s}apply(n){let s=n.nodeAt(this.pos);if(!s)return Ts.fail("No node at mark step's position");let r=s.type.create(s.attrs,null,this.mark.removeFromSet(s.marks));return Ts.fromReplace(n,this.pos,this.pos+1,new tt(Oe.from(r),0,s.isLeaf?0:1))}invert(n){let s=n.nodeAt(this.pos);return!s||!this.mark.isInSet(s.marks)?this:new bc(this.pos,this.mark)}map(n){let s=n.mapResult(this.pos,1);return s.deletedAfter?null:new fu(s.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(n,s){if(typeof s.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new fu(s.pos,n.markFromJSON(s.mark))}}Yr.jsonID("removeNodeMark",fu);class Ws extends Yr{constructor(n,s,r,i=!1){super(),this.from=n,this.to=s,this.slice=r,this.structure=i}apply(n){return this.structure&&BS(n,this.from,this.to)?Ts.fail("Structure replace would overwrite content"):Ts.fromReplace(n,this.from,this.to,this.slice)}getMap(){return new Ba([this.from,this.to-this.from,this.slice.size])}invert(n){return new Ws(this.from,this.from+this.slice.size,n.slice(this.from,this.to))}map(n){let s=n.mapResult(this.from,1),r=n.mapResult(this.to,-1);return s.deletedAcross&&r.deletedAcross?null:new Ws(s.pos,Math.max(s.pos,r.pos),this.slice,this.structure)}merge(n){if(!(n instanceof Ws)||n.structure||this.structure)return null;if(this.from+this.slice.size==n.from&&!this.slice.openEnd&&!n.slice.openStart){let s=this.slice.size+n.slice.size==0?tt.empty:new tt(this.slice.content.append(n.slice.content),this.slice.openStart,n.slice.openEnd);return new Ws(this.from,this.to+(n.to-n.from),s,this.structure)}else if(n.to==this.from&&!this.slice.openStart&&!n.slice.openEnd){let s=this.slice.size+n.slice.size==0?tt.empty:new tt(n.slice.content.append(this.slice.content),n.slice.openStart,this.slice.openEnd);return new Ws(n.from,this.to,s,this.structure)}else return null}toJSON(){let n={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(n.slice=this.slice.toJSON()),this.structure&&(n.structure=!0),n}static fromJSON(n,s){if(typeof s.from!="number"||typeof s.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ws(s.from,s.to,tt.fromJSON(n,s.slice),!!s.structure)}}Yr.jsonID("replace",Ws);class Qs extends Yr{constructor(n,s,r,i,l,o,c=!1){super(),this.from=n,this.to=s,this.gapFrom=r,this.gapTo=i,this.slice=l,this.insert=o,this.structure=c}apply(n){if(this.structure&&(BS(n,this.from,this.gapFrom)||BS(n,this.gapTo,this.to)))return Ts.fail("Structure gap-replace would overwrite content");let s=n.slice(this.gapFrom,this.gapTo);if(s.openStart||s.openEnd)return Ts.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,s.content);return r?Ts.fromReplace(n,this.from,this.to,r):Ts.fail("Content does not fit in gap")}getMap(){return new Ba([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(n){let s=this.gapTo-this.gapFrom;return new Qs(this.from,this.from+this.slice.size+s,this.from+this.insert,this.from+this.insert+s,n.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(n){let s=n.mapResult(this.from,1),r=n.mapResult(this.to,-1),i=this.from==this.gapFrom?s.pos:n.map(this.gapFrom,-1),l=this.to==this.gapTo?r.pos:n.map(this.gapTo,1);return s.deletedAcross&&r.deletedAcross||i<s.pos||l>r.pos?null:new Qs(s.pos,r.pos,i,l,this.slice,this.insert,this.structure)}toJSON(){let n={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(n.slice=this.slice.toJSON()),this.structure&&(n.structure=!0),n}static fromJSON(n,s){if(typeof s.from!="number"||typeof s.to!="number"||typeof s.gapFrom!="number"||typeof s.gapTo!="number"||typeof s.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Qs(s.from,s.to,s.gapFrom,s.gapTo,tt.fromJSON(n,s.slice),s.insert,!!s.structure)}}Yr.jsonID("replaceAround",Qs);function BS(t,n,s){let r=t.resolve(n),i=s-n,l=r.depth;for(;i>0&&l>0&&r.indexAfter(l)==r.node(l).childCount;)l--,i--;if(i>0){let o=r.node(l).maybeChild(r.indexAfter(l));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Que(t,n,s,r){let i=[],l=[],o,c;t.doc.nodesBetween(n,s,(d,u,h)=>{if(!d.isInline)return;let m=d.marks;if(!r.isInSet(m)&&h.type.allowsMarkType(r.type)){let x=Math.max(u,n),b=Math.min(u+d.nodeSize,s),w=r.addToSet(m);for(let j=0;j<m.length;j++)m[j].isInSet(w)||(o&&o.to==x&&o.mark.eq(m[j])?o.to=b:i.push(o=new Ki(x,b,m[j])));c&&c.to==x?c.to=b:l.push(c=new yc(x,b,r))}}),i.forEach(d=>t.step(d)),l.forEach(d=>t.step(d))}function Zue(t,n,s,r){let i=[],l=0;t.doc.nodesBetween(n,s,(o,c)=>{if(!o.isInline)return;l++;let d=null;if(r instanceof Lb){let u=o.marks,h;for(;h=r.isInSet(u);)(d||(d=[])).push(h),u=h.removeFromSet(u)}else r?r.isInSet(o.marks)&&(d=[r]):d=o.marks;if(d&&d.length){let u=Math.min(c+o.nodeSize,s);for(let h=0;h<d.length;h++){let m=d[h],x;for(let b=0;b<i.length;b++){let w=i[b];w.step==l-1&&m.eq(i[b].style)&&(x=w)}x?(x.to=u,x.step=l):i.push({style:m,from:Math.max(c,n),to:u,step:l})}}}),i.forEach(o=>t.step(new Ki(o.from,o.to,o.style)))}function sA(t,n,s,r=s.contentMatch,i=!0){let l=t.doc.nodeAt(n),o=[],c=n+1;for(let d=0;d<l.childCount;d++){let u=l.child(d),h=c+u.nodeSize,m=r.matchType(u.type);if(!m)o.push(new Ws(c,h,tt.empty));else{r=m;for(let x=0;x<u.marks.length;x++)s.allowsMarkType(u.marks[x].type)||t.step(new Ki(c,h,u.marks[x]));if(i&&u.isText&&s.whitespace!="pre"){let x,b=/\r?\n|\r/g,w;for(;x=b.exec(u.text);)w||(w=new tt(Oe.from(s.schema.text(" ",s.allowedMarks(u.marks))),0,0)),o.push(new Ws(c+x.index,c+x.index+x[0].length,w))}}c=h}if(!r.validEnd){let d=r.fillBefore(Oe.empty,!0);t.replace(c,c,new tt(d,0,0))}for(let d=o.length-1;d>=0;d--)t.step(o[d])}function Jue(t,n,s){return(n==0||t.canReplace(n,t.childCount))&&(s==t.childCount||t.canReplace(0,s))}function Pu(t){let s=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),l=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(l,o,s))return r;if(r==0||i.type.spec.isolating||!Jue(i,l,o))break}return null}function efe(t,n,s){let{$from:r,$to:i,depth:l}=n,o=r.before(l+1),c=i.after(l+1),d=o,u=c,h=Oe.empty,m=0;for(let w=l,j=!1;w>s;w--)j||r.index(w)>0?(j=!0,h=Oe.from(r.node(w).copy(h)),m++):d--;let x=Oe.empty,b=0;for(let w=l,j=!1;w>s;w--)j||i.after(w+1)<i.end(w)?(j=!0,x=Oe.from(i.node(w).copy(x)),b++):u++;t.step(new Qs(d,u,o,c,new tt(h.append(x),m,b),h.size-m,!0))}function rA(t,n,s=null,r=t){let i=tfe(t,n),l=i&&nfe(r,n);return l?i.map(eP).concat({type:n,attrs:s}).concat(l.map(eP)):null}function eP(t){return{type:t,attrs:null}}function tfe(t,n){let{parent:s,startIndex:r,endIndex:i}=t,l=s.contentMatchAt(r).findWrapping(n);if(!l)return null;let o=l.length?l[0]:n;return s.canReplaceWith(r,i,o)?l:null}function nfe(t,n){let{parent:s,startIndex:r,endIndex:i}=t,l=s.child(r),o=n.contentMatch.findWrapping(l.type);if(!o)return null;let d=(o.length?o[o.length-1]:n).contentMatch;for(let u=r;d&&u<i;u++)d=d.matchType(s.child(u).type);return!d||!d.validEnd?null:o}function sfe(t,n,s){let r=Oe.empty;for(let o=s.length-1;o>=0;o--){if(r.size){let c=s[o].type.contentMatch.matchFragment(r);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Oe.from(s[o].type.create(s[o].attrs,r))}let i=n.start,l=n.end;t.step(new Qs(i,l,i,l,new tt(r,0,0),s.length,!0))}function rfe(t,n,s,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let l=t.steps.length;t.doc.nodesBetween(n,s,(o,c)=>{let d=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,d)&&afe(t.doc,t.mapping.slice(l).map(c),r)){let u=null;if(r.schema.linebreakReplacement){let b=r.whitespace=="pre",w=!!r.contentMatch.matchType(r.schema.linebreakReplacement);b&&!w?u=!1:!b&&w&&(u=!0)}u===!1&&O9(t,o,c,l),sA(t,t.mapping.slice(l).map(c,1),r,void 0,u===null);let h=t.mapping.slice(l),m=h.map(c,1),x=h.map(c+o.nodeSize,1);return t.step(new Qs(m,x,m+1,x-1,new tt(Oe.from(r.create(d,null,o.marks)),0,0),1,!0)),u===!0&&M9(t,o,c,l),!1}})}function M9(t,n,s,r){n.forEach((i,l)=>{if(i.isText){let o,c=/\r?\n|\r/g;for(;o=c.exec(i.text);){let d=t.mapping.slice(r).map(s+1+l+o.index);t.replaceWith(d,d+1,n.type.schema.linebreakReplacement.create())}}})}function O9(t,n,s,r){n.forEach((i,l)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(s+1+l);t.replaceWith(o,o+1,n.type.schema.text(`
`))}})}function afe(t,n,s){let r=t.resolve(n),i=r.index();return r.parent.canReplaceWith(i,i+1,s)}function ife(t,n,s,r,i){let l=t.doc.nodeAt(n);if(!l)throw new RangeError("No node at given position");s||(s=l.type);let o=s.create(r,null,i||l.marks);if(l.isLeaf)return t.replaceWith(n,n+l.nodeSize,o);if(!s.validContent(l.content))throw new RangeError("Invalid content for node type "+s.name);t.step(new Qs(n,n+l.nodeSize,n+1,n+l.nodeSize-1,new tt(Oe.from(o),0,0),1,!0))}function Wa(t,n,s=1,r){let i=t.resolve(n),l=i.depth-s,o=r&&r[r.length-1]||i.parent;if(l<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,h=s-2;u>l;u--,h--){let m=i.node(u),x=i.index(u);if(m.type.spec.isolating)return!1;let b=m.content.cutByIndex(x,m.childCount),w=r&&r[h+1];w&&(b=b.replaceChild(0,w.type.create(w.attrs)));let j=r&&r[h]||m;if(!m.canReplace(x+1,m.childCount)||!j.type.validContent(b))return!1}let c=i.indexAfter(l),d=r&&r[0];return i.node(l).canReplaceWith(c,c,d?d.type:i.node(l+1).type)}function lfe(t,n,s=1,r){let i=t.doc.resolve(n),l=Oe.empty,o=Oe.empty;for(let c=i.depth,d=i.depth-s,u=s-1;c>d;c--,u--){l=Oe.from(i.node(c).copy(l));let h=r&&r[u];o=Oe.from(h?h.type.create(h.attrs,o):i.node(c).copy(o))}t.step(new Ws(n,n,new tt(l.append(o),s,s),!0))}function Wl(t,n){let s=t.resolve(n),r=s.index();return D9(s.nodeBefore,s.nodeAfter)&&s.parent.canReplace(r,r+1)}function ofe(t,n){n.content.size||t.type.compatibleContent(n.type);let s=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<n.childCount;i++){let l=n.child(i),o=l.type==r?t.type.schema.nodes.text:l.type;if(s=s.matchType(o),!s||!t.type.allowsMarks(l.marks))return!1}return s.validEnd}function D9(t,n){return!!(t&&n&&!t.isLeaf&&ofe(t,n))}function Eh(t,n,s=-1){let r=t.resolve(n);for(let i=r.depth;;i--){let l,o,c=r.index(i);if(i==r.depth?(l=r.nodeBefore,o=r.nodeAfter):s>0?(l=r.node(i+1),c++,o=r.node(i).maybeChild(c)):(l=r.node(i).maybeChild(c-1),o=r.node(i+1)),l&&!l.isTextblock&&D9(l,o)&&r.node(i).canReplace(c,c+1))return n;if(i==0)break;n=s<0?r.before(i):r.after(i)}}function cfe(t,n,s){let r=null,{linebreakReplacement:i}=t.doc.type.schema,l=t.doc.resolve(n-s),o=l.node().type;if(i&&o.inlineContent){let h=o.whitespace=="pre",m=!!o.contentMatch.matchType(i);h&&!m?r=!1:!h&&m&&(r=!0)}let c=t.steps.length;if(r===!1){let h=t.doc.resolve(n+s);O9(t,h.node(),h.before(),c)}o.inlineContent&&sA(t,n+s-1,o,l.node().contentMatchAt(l.index()),r==null);let d=t.mapping.slice(c),u=d.map(n-s);if(t.step(new Ws(u,d.map(n+s,-1),tt.empty,!0)),r===!0){let h=t.doc.resolve(u);M9(t,h.node(),h.before(),t.steps.length)}return t}function dfe(t,n,s){let r=t.resolve(n);if(r.parent.canReplaceWith(r.index(),r.index(),s))return n;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let l=r.index(i);if(r.node(i).canReplaceWith(l,l,s))return r.before(i+1);if(l>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let l=r.indexAfter(i);if(r.node(i).canReplaceWith(l,l,s))return r.after(i+1);if(l<r.node(i).childCount)return null}return null}function R9(t,n,s){let r=t.resolve(n);if(!s.content.size)return n;let i=s.content;for(let l=0;l<s.openStart;l++)i=i.firstChild.content;for(let l=1;l<=(s.openStart==0&&s.size?2:1);l++)for(let o=r.depth;o>=0;o--){let c=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,d=r.index(o)+(c>0?1:0),u=r.node(o),h=!1;if(l==1)h=u.canReplace(d,d,i);else{let m=u.contentMatchAt(d).findWrapping(i.firstChild.type);h=m&&u.canReplaceWith(d,d,m[0])}if(h)return c==0?r.pos:c<0?r.before(o+1):r.after(o+1)}return null}function Fb(t,n,s=n,r=tt.empty){if(n==s&&!r.size)return null;let i=t.resolve(n),l=t.resolve(s);return L9(i,l,r)?new Ws(n,s,r):new ufe(i,l,r).fit()}function L9(t,n,s){return!s.openStart&&!s.openEnd&&t.start()==n.start()&&t.parent.canReplace(t.index(),n.index(),s.content)}class ufe{constructor(n,s,r){this.$from=n,this.$to=s,this.unplaced=r,this.frontier=[],this.placed=Oe.empty;for(let i=0;i<=n.depth;i++){let l=n.node(i);this.frontier.push({type:l.type,match:l.contentMatchAt(n.indexAfter(i))})}for(let i=n.depth;i>0;i--)this.placed=Oe.from(n.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let n=this.mustMoveInline(),s=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(n<0?this.$to:r.doc.resolve(n));if(!i)return null;let l=this.placed,o=r.depth,c=i.depth;for(;o&&c&&l.childCount==1;)l=l.firstChild.content,o--,c--;let d=new tt(l,o,c);return n>-1?new Qs(r.pos,n,this.$to.pos,this.$to.end(),d,s):d.size||r.pos!=this.$to.pos?new Ws(r.pos,i.pos,d):null}findFittable(){let n=this.unplaced.openStart;for(let s=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<n;r++){let l=s.firstChild;if(s.childCount>1&&(i=0),l.type.spec.isolating&&i<=r){n=r;break}s=l.content}for(let s=1;s<=2;s++)for(let r=s==1?n:this.unplaced.openStart;r>=0;r--){let i,l=null;r?(l=BN(this.unplaced.content,r-1).firstChild,i=l.content):i=this.unplaced.content;let o=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:d,match:u}=this.frontier[c],h,m=null;if(s==1&&(o?u.matchType(o.type)||(m=u.fillBefore(Oe.from(o),!1)):l&&d.compatibleContent(l.type)))return{sliceDepth:r,frontierDepth:c,parent:l,inject:m};if(s==2&&o&&(h=u.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:c,parent:l,wrap:h};if(l&&u.matchType(l.type))break}}}openMore(){let{content:n,openStart:s,openEnd:r}=this.unplaced,i=BN(n,s);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new tt(n,s+1,Math.max(r,i.size+s>=n.size-r?s+1:0)),!0)}dropNode(){let{content:n,openStart:s,openEnd:r}=this.unplaced,i=BN(n,s);if(i.childCount<=1&&s>0){let l=n.size-s<=s+i.size;this.unplaced=new tt(Mm(n,s-1,1),s-1,l?s-1:r)}else this.unplaced=new tt(Mm(n,s,1),s,r)}placeNodes({sliceDepth:n,frontierDepth:s,parent:r,inject:i,wrap:l}){for(;this.depth>s;)this.closeFrontierNode();if(l)for(let j=0;j<l.length;j++)this.openFrontierNode(l[j]);let o=this.unplaced,c=r?r.content:o.content,d=o.openStart-n,u=0,h=[],{match:m,type:x}=this.frontier[s];if(i){for(let j=0;j<i.childCount;j++)h.push(i.child(j));m=m.matchFragment(i)}let b=c.size+n-(o.content.size-o.openEnd);for(;u<c.childCount;){let j=c.child(u),S=m.matchType(j.type);if(!S)break;u++,(u>1||d==0||j.content.size)&&(m=S,h.push(B9(j.mark(x.allowedMarks(j.marks)),u==1?d:0,u==c.childCount?b:-1)))}let w=u==c.childCount;w||(b=-1),this.placed=Om(this.placed,s,Oe.from(h)),this.frontier[s].match=m,w&&b<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let j=0,S=c;j<b;j++){let C=S.lastChild;this.frontier.push({type:C.type,match:C.contentMatchAt(C.childCount)}),S=C.content}this.unplaced=w?n==0?tt.empty:new tt(Mm(o.content,n-1,1),n-1,b<0?o.openEnd:n-1):new tt(Mm(o.content,n,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let n=this.frontier[this.depth],s;if(!n.type.isTextblock||!FN(this.$to,this.$to.depth,n.type,n.match,!1)||this.$to.depth==this.depth&&(s=this.findCloseLevel(this.$to))&&s.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(n){e:for(let s=Math.min(this.depth,n.depth);s>=0;s--){let{match:r,type:i}=this.frontier[s],l=s<n.depth&&n.end(s+1)==n.pos+(n.depth-(s+1)),o=FN(n,s,i,r,l);if(o){for(let c=s-1;c>=0;c--){let{match:d,type:u}=this.frontier[c],h=FN(n,c,u,d,!0);if(!h||h.childCount)continue e}return{depth:s,fit:o,move:l?n.doc.resolve(n.after(s+1)):n}}}}close(n){let s=this.findCloseLevel(n);if(!s)return null;for(;this.depth>s.depth;)this.closeFrontierNode();s.fit.childCount&&(this.placed=Om(this.placed,s.depth,s.fit)),n=s.move;for(let r=s.depth+1;r<=n.depth;r++){let i=n.node(r),l=i.type.contentMatch.fillBefore(i.content,!0,n.index(r));this.openFrontierNode(i.type,i.attrs,l)}return n}openFrontierNode(n,s=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(n),this.placed=Om(this.placed,this.depth,Oe.from(n.create(s,r))),this.frontier.push({type:n,match:n.contentMatch})}closeFrontierNode(){let s=this.frontier.pop().match.fillBefore(Oe.empty,!0);s.childCount&&(this.placed=Om(this.placed,this.frontier.length,s))}}function Mm(t,n,s){return n==0?t.cutByIndex(s,t.childCount):t.replaceChild(0,t.firstChild.copy(Mm(t.firstChild.content,n-1,s)))}function Om(t,n,s){return n==0?t.append(s):t.replaceChild(t.childCount-1,t.lastChild.copy(Om(t.lastChild.content,n-1,s)))}function BN(t,n){for(let s=0;s<n;s++)t=t.firstChild.content;return t}function B9(t,n,s){if(n<=0)return t;let r=t.content;return n>1&&(r=r.replaceChild(0,B9(r.firstChild,n-1,r.childCount==1?s-1:0))),n>0&&(r=t.type.contentMatch.fillBefore(r).append(r),s<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(Oe.empty,!0)))),t.copy(r)}function FN(t,n,s,r,i){let l=t.node(n),o=i?t.indexAfter(n):t.index(n);if(o==l.childCount&&!s.compatibleContent(l.type))return null;let c=r.fillBefore(l.content,!0,o);return c&&!ffe(s,l.content,o)?c:null}function ffe(t,n,s){for(let r=s;r<n.childCount;r++)if(!t.allowsMarks(n.child(r).marks))return!0;return!1}function hfe(t){return t.spec.defining||t.spec.definingForContent}function mfe(t,n,s,r){if(!r.size)return t.deleteRange(n,s);let i=t.doc.resolve(n),l=t.doc.resolve(s);if(L9(i,l,r))return t.step(new Ws(n,s,r));let o=$9(i,t.doc.resolve(s));o[o.length-1]==0&&o.pop();let c=-(i.depth+1);o.unshift(c);for(let x=i.depth,b=i.pos-1;x>0;x--,b--){let w=i.node(x).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;o.indexOf(x)>-1?c=x:i.before(x)==b&&o.splice(1,0,-x)}let d=o.indexOf(c),u=[],h=r.openStart;for(let x=r.content,b=0;;b++){let w=x.firstChild;if(u.push(w),b==r.openStart)break;x=w.content}for(let x=h-1;x>=0;x--){let b=u[x],w=hfe(b.type);if(w&&!b.sameMarkup(i.node(Math.abs(c)-1)))h=x;else if(w||!b.type.isTextblock)break}for(let x=r.openStart;x>=0;x--){let b=(x+h+1)%(r.openStart+1),w=u[b];if(w)for(let j=0;j<o.length;j++){let S=o[(j+d)%o.length],C=!0;S<0&&(C=!1,S=-S);let A=i.node(S-1),k=i.index(S-1);if(A.canReplaceWith(k,k,w.type,w.marks))return t.replace(i.before(S),C?l.after(S):s,new tt(F9(r.content,0,r.openStart,b),b,r.openEnd))}}let m=t.steps.length;for(let x=o.length-1;x>=0&&(t.replace(n,s,r),!(t.steps.length>m));x--){let b=o[x];b<0||(n=i.before(b),s=l.after(b))}}function F9(t,n,s,r,i){if(n<s){let l=t.firstChild;t=t.replaceChild(0,l.copy(F9(l.content,n+1,s,r,l)))}if(n>r){let l=i.contentMatchAt(0),o=l.fillBefore(t).append(t);t=o.append(l.matchFragment(o).fillBefore(Oe.empty,!0))}return t}function pfe(t,n,s,r){if(!r.isInline&&n==s&&t.doc.resolve(n).parent.content.size){let i=dfe(t.doc,n,r.type);i!=null&&(n=s=i)}t.replaceRange(n,s,new tt(Oe.from(r),0,0))}function xfe(t,n,s){let r=t.doc.resolve(n),i=t.doc.resolve(s),l=$9(r,i);for(let o=0;o<l.length;o++){let c=l[o],d=o==l.length-1;if(d&&c==0||r.node(c).type.contentMatch.validEnd)return t.delete(r.start(c),i.end(c));if(c>0&&(d||r.node(c-1).canReplace(r.index(c-1),i.indexAfter(c-1))))return t.delete(r.before(c),i.after(c))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(n-r.start(o)==r.depth-o&&s>r.end(o)&&i.end(o)-s!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return t.delete(r.before(o),s);t.delete(n,s)}function $9(t,n){let s=[],r=Math.min(t.depth,n.depth);for(let i=r;i>=0;i--){let l=t.start(i);if(l<t.pos-(t.depth-i)||n.end(i)>n.pos+(n.depth-i)||t.node(i).type.spec.isolating||n.node(i).type.spec.isolating)break;(l==n.start(i)||i==t.depth&&i==n.depth&&t.parent.inlineContent&&n.parent.inlineContent&&i&&n.start(i-1)==l-1)&&s.push(i)}return s}class Df extends Yr{constructor(n,s,r){super(),this.pos=n,this.attr=s,this.value=r}apply(n){let s=n.nodeAt(this.pos);if(!s)return Ts.fail("No node at attribute step's position");let r=Object.create(null);for(let l in s.attrs)r[l]=s.attrs[l];r[this.attr]=this.value;let i=s.type.create(r,null,s.marks);return Ts.fromReplace(n,this.pos,this.pos+1,new tt(Oe.from(i),0,s.isLeaf?0:1))}getMap(){return Ba.empty}invert(n){return new Df(this.pos,this.attr,n.nodeAt(this.pos).attrs[this.attr])}map(n){let s=n.mapResult(this.pos,1);return s.deletedAfter?null:new Df(s.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(n,s){if(typeof s.pos!="number"||typeof s.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Df(s.pos,s.attr,s.value)}}Yr.jsonID("attr",Df);class Bp extends Yr{constructor(n,s){super(),this.attr=n,this.value=s}apply(n){let s=Object.create(null);for(let i in n.attrs)s[i]=n.attrs[i];s[this.attr]=this.value;let r=n.type.create(s,n.content,n.marks);return Ts.ok(r)}getMap(){return Ba.empty}invert(n){return new Bp(this.attr,n.attrs[this.attr])}map(n){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(n,s){if(typeof s.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Bp(s.attr,s.value)}}Yr.jsonID("docAttr",Bp);let eh=class extends Error{};eh=function t(n){let s=Error.call(this,n);return s.__proto__=t.prototype,s};eh.prototype=Object.create(Error.prototype);eh.prototype.constructor=eh;eh.prototype.name="TransformError";class z9{constructor(n){this.doc=n,this.steps=[],this.docs=[],this.mapping=new Lp}get before(){return this.docs.length?this.docs[0]:this.doc}step(n){let s=this.maybeStep(n);if(s.failed)throw new eh(s.failed);return this}maybeStep(n){let s=n.apply(this.doc);return s.failed||this.addStep(n,s.doc),s}get docChanged(){return this.steps.length>0}addStep(n,s){this.docs.push(this.doc),this.steps.push(n),this.mapping.appendMap(n.getMap()),this.doc=s}replace(n,s=n,r=tt.empty){let i=Fb(this.doc,n,s,r);return i&&this.step(i),this}replaceWith(n,s,r){return this.replace(n,s,new tt(Oe.from(r),0,0))}delete(n,s){return this.replace(n,s,tt.empty)}insert(n,s){return this.replaceWith(n,n,s)}replaceRange(n,s,r){return mfe(this,n,s,r),this}replaceRangeWith(n,s,r){return pfe(this,n,s,r),this}deleteRange(n,s){return xfe(this,n,s),this}lift(n,s){return efe(this,n,s),this}join(n,s=1){return cfe(this,n,s),this}wrap(n,s){return sfe(this,n,s),this}setBlockType(n,s=n,r,i=null){return rfe(this,n,s,r,i),this}setNodeMarkup(n,s,r=null,i){return ife(this,n,s,r,i),this}setNodeAttribute(n,s,r){return this.step(new Df(n,s,r)),this}setDocAttribute(n,s){return this.step(new Bp(n,s)),this}addNodeMark(n,s){return this.step(new bc(n,s)),this}removeNodeMark(n,s){let r=this.doc.nodeAt(n);if(!r)throw new RangeError("No node at position "+n);if(s instanceof qn)s.isInSet(r.marks)&&this.step(new fu(n,s));else{let i=r.marks,l,o=[];for(;l=s.isInSet(i);)o.push(new fu(n,l)),i=l.removeFromSet(i);for(let c=o.length-1;c>=0;c--)this.step(o[c])}return this}split(n,s=1,r){return lfe(this,n,s,r),this}addMark(n,s,r){return Que(this,n,s,r),this}removeMark(n,s,r){return Zue(this,n,s,r),this}clearIncompatible(n,s,r){return sA(this,n,s,r),this}}const $N=Object.create(null);class At{constructor(n,s,r){this.$anchor=n,this.$head=s,this.ranges=r||[new U9(n.min(s),n.max(s))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let n=this.ranges;for(let s=0;s<n.length;s++)if(n[s].$from.pos!=n[s].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(n,s=tt.empty){let r=s.content.lastChild,i=null;for(let c=0;c<s.openEnd;c++)i=r,r=r.lastChild;let l=n.steps.length,o=this.ranges;for(let c=0;c<o.length;c++){let{$from:d,$to:u}=o[c],h=n.mapping.slice(l);n.replaceRange(h.map(d.pos),h.map(u.pos),c?tt.empty:s),c==0&&sP(n,l,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(n,s){let r=n.steps.length,i=this.ranges;for(let l=0;l<i.length;l++){let{$from:o,$to:c}=i[l],d=n.mapping.slice(r),u=d.map(o.pos),h=d.map(c.pos);l?n.deleteRange(u,h):(n.replaceRangeWith(u,h,s),sP(n,r,s.isInline?-1:1))}}static findFrom(n,s,r=!1){let i=n.parent.inlineContent?new xt(n):nf(n.node(0),n.parent,n.pos,n.index(),s,r);if(i)return i;for(let l=n.depth-1;l>=0;l--){let o=s<0?nf(n.node(0),n.node(l),n.before(l+1),n.index(l),s,r):nf(n.node(0),n.node(l),n.after(l+1),n.index(l)+1,s,r);if(o)return o}return null}static near(n,s=1){return this.findFrom(n,s)||this.findFrom(n,-s)||new _a(n.node(0))}static atStart(n){return nf(n,n,0,0,1)||new _a(n)}static atEnd(n){return nf(n,n,n.content.size,n.childCount,-1)||new _a(n)}static fromJSON(n,s){if(!s||!s.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=$N[s.type];if(!r)throw new RangeError(`No selection type ${s.type} defined`);return r.fromJSON(n,s)}static jsonID(n,s){if(n in $N)throw new RangeError("Duplicate use of selection JSON ID "+n);return $N[n]=s,s.prototype.jsonID=n,s}getBookmark(){return xt.between(this.$anchor,this.$head).getBookmark()}}At.prototype.visible=!0;class U9{constructor(n,s){this.$from=n,this.$to=s}}let tP=!1;function nP(t){!tP&&!t.parent.inlineContent&&(tP=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class xt extends At{constructor(n,s=n){nP(n),nP(s),super(n,s)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(n,s){let r=n.resolve(s.map(this.head));if(!r.parent.inlineContent)return At.near(r);let i=n.resolve(s.map(this.anchor));return new xt(i.parent.inlineContent?i:r,r)}replace(n,s=tt.empty){if(super.replace(n,s),s==tt.empty){let r=this.$from.marksAcross(this.$to);r&&n.ensureMarks(r)}}eq(n){return n instanceof xt&&n.anchor==this.anchor&&n.head==this.head}getBookmark(){return new $b(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(n,s){if(typeof s.anchor!="number"||typeof s.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new xt(n.resolve(s.anchor),n.resolve(s.head))}static create(n,s,r=s){let i=n.resolve(s);return new this(i,r==s?i:n.resolve(r))}static between(n,s,r){let i=n.pos-s.pos;if((!r||i)&&(r=i>=0?1:-1),!s.parent.inlineContent){let l=At.findFrom(s,r,!0)||At.findFrom(s,-r,!0);if(l)s=l.$head;else return At.near(s,r)}return n.parent.inlineContent||(i==0?n=s:(n=(At.findFrom(n,-r,!0)||At.findFrom(n,r,!0)).$anchor,n.pos<s.pos!=i<0&&(n=s))),new xt(n,s)}}At.jsonID("text",xt);class $b{constructor(n,s){this.anchor=n,this.head=s}map(n){return new $b(n.map(this.anchor),n.map(this.head))}resolve(n){return xt.between(n.resolve(this.anchor),n.resolve(this.head))}}class vt extends At{constructor(n){let s=n.nodeAfter,r=n.node(0).resolve(n.pos+s.nodeSize);super(n,r),this.node=s}map(n,s){let{deleted:r,pos:i}=s.mapResult(this.anchor),l=n.resolve(i);return r?At.near(l):new vt(l)}content(){return new tt(Oe.from(this.node),0,0)}eq(n){return n instanceof vt&&n.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new aA(this.anchor)}static fromJSON(n,s){if(typeof s.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new vt(n.resolve(s.anchor))}static create(n,s){return new vt(n.resolve(s))}static isSelectable(n){return!n.isText&&n.type.spec.selectable!==!1}}vt.prototype.visible=!1;At.jsonID("node",vt);class aA{constructor(n){this.anchor=n}map(n){let{deleted:s,pos:r}=n.mapResult(this.anchor);return s?new $b(r,r):new aA(r)}resolve(n){let s=n.resolve(this.anchor),r=s.nodeAfter;return r&&vt.isSelectable(r)?new vt(s):At.near(s)}}class _a extends At{constructor(n){super(n.resolve(0),n.resolve(n.content.size))}replace(n,s=tt.empty){if(s==tt.empty){n.delete(0,n.doc.content.size);let r=At.atStart(n.doc);r.eq(n.selection)||n.setSelection(r)}else super.replace(n,s)}toJSON(){return{type:"all"}}static fromJSON(n){return new _a(n)}map(n){return new _a(n)}eq(n){return n instanceof _a}getBookmark(){return gfe}}At.jsonID("all",_a);const gfe={map(){return this},resolve(t){return new _a(t)}};function nf(t,n,s,r,i,l=!1){if(n.inlineContent)return xt.create(t,s);for(let o=r-(i>0?0:1);i>0?o<n.childCount:o>=0;o+=i){let c=n.child(o);if(c.isAtom){if(!l&&vt.isSelectable(c))return vt.create(t,s-(i<0?c.nodeSize:0))}else{let d=nf(t,c,s+i,i<0?c.childCount:0,i,l);if(d)return d}s+=c.nodeSize*i}return null}function sP(t,n,s){let r=t.steps.length-1;if(r<n)return;let i=t.steps[r];if(!(i instanceof Ws||i instanceof Qs))return;let l=t.mapping.maps[r],o;l.forEach((c,d,u,h)=>{o==null&&(o=h)}),t.setSelection(At.near(t.doc.resolve(o),s))}function rP(t,n){return!n||!t?t:t.bind(n)}class O0{constructor(n,s,r){this.name=n,this.init=rP(s.init,r),this.apply=rP(s.apply,r)}}new O0("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new O0("selection",{init(t,n){return t.selection||At.atStart(n.doc)},apply(t){return t.selection}}),new O0("storedMarks",{init(t){return t.storedMarks||null},apply(t,n,s,r){return r.selection.$cursor?t.storedMarks:null}}),new O0("scrollToSelection",{init(){return 0},apply(t,n){return t.scrolledIntoView?n+1:n}});function V9(t,n,s){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(n):r=="handleDOMEvents"&&(i=V9(i,n,{})),s[r]=i}return s}class js{constructor(n){this.spec=n,this.props={},n.props&&V9(n.props,this,this.props),this.key=n.key?n.key.key:H9("plugin")}getState(n){return n[this.key]}}const zN=Object.create(null);function H9(t){return t in zN?t+"$"+ ++zN[t]:(zN[t]=0,t+"$")}class Ss{constructor(n="key"){this.key=H9(n)}get(n){return n.config.pluginsByKey[this.key]}getState(n){return n[this.key]}}const zb=(t,n)=>t.selection.empty?!1:(n&&n(t.tr.deleteSelection().scrollIntoView()),!0);function W9(t,n){let{$cursor:s}=t.selection;return!s||(n?!n.endOfTextblock("backward",t):s.parentOffset>0)?null:s}const iA=(t,n,s)=>{let r=W9(t,s);if(!r)return!1;let i=oA(r);if(!i){let o=r.blockRange(),c=o&&Pu(o);return c==null?!1:(n&&n(t.tr.lift(o,c).scrollIntoView()),!0)}let l=i.nodeBefore;if(tF(t,i,n,-1))return!0;if(r.parent.content.size==0&&(th(l,"end")||vt.isSelectable(l)))for(let o=r.depth;;o--){let c=Fb(t.doc,r.before(o),r.after(o),tt.empty);if(c&&c.slice.size<c.to-c.from){if(n){let d=t.tr.step(c);d.setSelection(th(l,"end")?At.findFrom(d.doc.resolve(d.mapping.map(i.pos,-1)),-1):vt.create(d.doc,i.pos-l.nodeSize)),n(d.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return l.isAtom&&i.depth==r.depth-1?(n&&n(t.tr.delete(i.pos-l.nodeSize,i.pos).scrollIntoView()),!0):!1},q9=(t,n,s)=>{let r=W9(t,s);if(!r)return!1;let i=oA(r);return i?K9(t,i,n):!1},G9=(t,n,s)=>{let r=Y9(t,s);if(!r)return!1;let i=uA(r);return i?K9(t,i,n):!1};function K9(t,n,s){let r=n.nodeBefore,i=r,l=n.pos-1;for(;!i.isTextblock;l--){if(i.type.spec.isolating)return!1;let h=i.lastChild;if(!h)return!1;i=h}let o=n.nodeAfter,c=o,d=n.pos+1;for(;!c.isTextblock;d++){if(c.type.spec.isolating)return!1;let h=c.firstChild;if(!h)return!1;c=h}let u=Fb(t.doc,l,d,tt.empty);if(!u||u.from!=l||u instanceof Ws&&u.slice.size>=d-l)return!1;if(s){let h=t.tr.step(u);h.setSelection(xt.create(h.doc,l)),s(h.scrollIntoView())}return!0}function th(t,n,s=!1){for(let r=t;r;r=n=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(s&&r.childCount!=1)return!1}return!1}const lA=(t,n,s)=>{let{$head:r,empty:i}=t.selection,l=r;if(!i)return!1;if(r.parent.isTextblock){if(s?!s.endOfTextblock("backward",t):r.parentOffset>0)return!1;l=oA(r)}let o=l&&l.nodeBefore;return!o||!vt.isSelectable(o)?!1:(n&&n(t.tr.setSelection(vt.create(t.doc,l.pos-o.nodeSize)).scrollIntoView()),!0)};function oA(t){if(!t.parent.type.spec.isolating)for(let n=t.depth-1;n>=0;n--){if(t.index(n)>0)return t.doc.resolve(t.before(n+1));if(t.node(n).type.spec.isolating)break}return null}function Y9(t,n){let{$cursor:s}=t.selection;return!s||(n?!n.endOfTextblock("forward",t):s.parentOffset<s.parent.content.size)?null:s}const cA=(t,n,s)=>{let r=Y9(t,s);if(!r)return!1;let i=uA(r);if(!i)return!1;let l=i.nodeAfter;if(tF(t,i,n,1))return!0;if(r.parent.content.size==0&&(th(l,"start")||vt.isSelectable(l))){let o=Fb(t.doc,r.before(),r.after(),tt.empty);if(o&&o.slice.size<o.to-o.from){if(n){let c=t.tr.step(o);c.setSelection(th(l,"start")?At.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):vt.create(c.doc,c.mapping.map(i.pos))),n(c.scrollIntoView())}return!0}}return l.isAtom&&i.depth==r.depth-1?(n&&n(t.tr.delete(i.pos,i.pos+l.nodeSize).scrollIntoView()),!0):!1},dA=(t,n,s)=>{let{$head:r,empty:i}=t.selection,l=r;if(!i)return!1;if(r.parent.isTextblock){if(s?!s.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;l=uA(r)}let o=l&&l.nodeAfter;return!o||!vt.isSelectable(o)?!1:(n&&n(t.tr.setSelection(vt.create(t.doc,l.pos)).scrollIntoView()),!0)};function uA(t){if(!t.parent.type.spec.isolating)for(let n=t.depth-1;n>=0;n--){let s=t.node(n);if(t.index(n)+1<s.childCount)return t.doc.resolve(t.after(n+1));if(s.type.spec.isolating)break}return null}const X9=(t,n)=>{let s=t.selection,r=s instanceof vt,i;if(r){if(s.node.isTextblock||!Wl(t.doc,s.from))return!1;i=s.from}else if(i=Eh(t.doc,s.from,-1),i==null)return!1;if(n){let l=t.tr.join(i);r&&l.setSelection(vt.create(l.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),n(l.scrollIntoView())}return!0},Q9=(t,n)=>{let s=t.selection,r;if(s instanceof vt){if(s.node.isTextblock||!Wl(t.doc,s.to))return!1;r=s.to}else if(r=Eh(t.doc,s.to,1),r==null)return!1;return n&&n(t.tr.join(r).scrollIntoView()),!0},Z9=(t,n)=>{let{$from:s,$to:r}=t.selection,i=s.blockRange(r),l=i&&Pu(i);return l==null?!1:(n&&n(t.tr.lift(i,l).scrollIntoView()),!0)},fA=(t,n)=>{let{$head:s,$anchor:r}=t.selection;return!s.parent.type.spec.code||!s.sameParent(r)?!1:(n&&n(t.tr.insertText(`
`).scrollIntoView()),!0)};function hA(t){for(let n=0;n<t.edgeCount;n++){let{type:s}=t.edge(n);if(s.isTextblock&&!s.hasRequiredAttrs())return s}return null}const J9=(t,n)=>{let{$head:s,$anchor:r}=t.selection;if(!s.parent.type.spec.code||!s.sameParent(r))return!1;let i=s.node(-1),l=s.indexAfter(-1),o=hA(i.contentMatchAt(l));if(!o||!i.canReplaceWith(l,l,o))return!1;if(n){let c=s.after(),d=t.tr.replaceWith(c,c,o.createAndFill());d.setSelection(At.near(d.doc.resolve(c),1)),n(d.scrollIntoView())}return!0},mA=(t,n)=>{let s=t.selection,{$from:r,$to:i}=s;if(s instanceof _a||r.parent.inlineContent||i.parent.inlineContent)return!1;let l=hA(i.parent.contentMatchAt(i.indexAfter()));if(!l||!l.isTextblock)return!1;if(n){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,c=t.tr.insert(o,l.createAndFill());c.setSelection(xt.create(c.doc,o+1)),n(c.scrollIntoView())}return!0},pA=(t,n)=>{let{$cursor:s}=t.selection;if(!s||s.parent.content.size)return!1;if(s.depth>1&&s.after()!=s.end(-1)){let l=s.before();if(Wa(t.doc,l))return n&&n(t.tr.split(l).scrollIntoView()),!0}let r=s.blockRange(),i=r&&Pu(r);return i==null?!1:(n&&n(t.tr.lift(r,i).scrollIntoView()),!0)};function yfe(t){return(n,s)=>{let{$from:r,$to:i}=n.selection;if(n.selection instanceof vt&&n.selection.node.isBlock)return!r.parentOffset||!Wa(n.doc,r.pos)?!1:(s&&s(n.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let l=[],o,c,d=!1,u=!1;for(let b=r.depth;;b--)if(r.node(b).isBlock){d=r.end(b)==r.pos+(r.depth-b),u=r.start(b)==r.pos-(r.depth-b),c=hA(r.node(b-1).contentMatchAt(r.indexAfter(b-1))),l.unshift(d&&c?{type:c}:null),o=b;break}else{if(b==1)return!1;l.unshift(null)}let h=n.tr;(n.selection instanceof xt||n.selection instanceof _a)&&h.deleteSelection();let m=h.mapping.map(r.pos),x=Wa(h.doc,m,l.length,l);if(x||(l[0]=c?{type:c}:null,x=Wa(h.doc,m,l.length,l)),!x)return!1;if(h.split(m,l.length,l),!d&&u&&r.node(o).type!=c){let b=h.mapping.map(r.before(o)),w=h.doc.resolve(b);c&&r.node(o-1).canReplaceWith(w.index(),w.index()+1,c)&&h.setNodeMarkup(h.mapping.map(r.before(o)),c)}return s&&s(h.scrollIntoView()),!0}}const bfe=yfe(),eF=(t,n)=>{let{$from:s,to:r}=t.selection,i,l=s.sharedDepth(r);return l==0?!1:(i=s.before(l),n&&n(t.tr.setSelection(vt.create(t.doc,i))),!0)};function vfe(t,n,s){let r=n.nodeBefore,i=n.nodeAfter,l=n.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&n.parent.canReplace(l-1,l)?(s&&s(t.tr.delete(n.pos-r.nodeSize,n.pos).scrollIntoView()),!0):!n.parent.canReplace(l,l+1)||!(i.isTextblock||Wl(t.doc,n.pos))?!1:(s&&s(t.tr.join(n.pos).scrollIntoView()),!0)}function tF(t,n,s,r){let i=n.nodeBefore,l=n.nodeAfter,o,c,d=i.type.spec.isolating||l.type.spec.isolating;if(!d&&vfe(t,n,s))return!0;let u=!d&&n.parent.canReplace(n.index(),n.index()+1);if(u&&(o=(c=i.contentMatchAt(i.childCount)).findWrapping(l.type))&&c.matchType(o[0]||l.type).validEnd){if(s){let b=n.pos+l.nodeSize,w=Oe.empty;for(let C=o.length-1;C>=0;C--)w=Oe.from(o[C].create(null,w));w=Oe.from(i.copy(w));let j=t.tr.step(new Qs(n.pos-1,b,n.pos,b,new tt(w,1,0),o.length,!0)),S=j.doc.resolve(b+2*o.length);S.nodeAfter&&S.nodeAfter.type==i.type&&Wl(j.doc,S.pos)&&j.join(S.pos),s(j.scrollIntoView())}return!0}let h=l.type.spec.isolating||r>0&&d?null:At.findFrom(n,1),m=h&&h.$from.blockRange(h.$to),x=m&&Pu(m);if(x!=null&&x>=n.depth)return s&&s(t.tr.lift(m,x).scrollIntoView()),!0;if(u&&th(l,"start",!0)&&th(i,"end")){let b=i,w=[];for(;w.push(b),!b.isTextblock;)b=b.lastChild;let j=l,S=1;for(;!j.isTextblock;j=j.firstChild)S++;if(b.canReplace(b.childCount,b.childCount,j.content)){if(s){let C=Oe.empty;for(let k=w.length-1;k>=0;k--)C=Oe.from(w[k].copy(C));let A=t.tr.step(new Qs(n.pos-w.length,n.pos+l.nodeSize,n.pos+S,n.pos+l.nodeSize-S,new tt(C,w.length,0),0,!0));s(A.scrollIntoView())}return!0}}return!1}function nF(t){return function(n,s){let r=n.selection,i=t<0?r.$from:r.$to,l=i.depth;for(;i.node(l).isInline;){if(!l)return!1;l--}return i.node(l).isTextblock?(s&&s(n.tr.setSelection(xt.create(n.doc,t<0?i.start(l):i.end(l)))),!0):!1}}const sF=nF(-1),rF=nF(1);function aF(t,n=null){return function(s,r){let{$from:i,$to:l}=s.selection,o=i.blockRange(l),c=o&&rA(o,t,n);return c?(r&&r(s.tr.wrap(o,c).scrollIntoView()),!0):!1}}function H1(t,n=null){return function(s,r){let i=!1;for(let l=0;l<s.selection.ranges.length&&!i;l++){let{$from:{pos:o},$to:{pos:c}}=s.selection.ranges[l];s.doc.nodesBetween(o,c,(d,u)=>{if(i)return!1;if(!(!d.isTextblock||d.hasMarkup(t,n)))if(d.type==t)i=!0;else{let h=s.doc.resolve(u),m=h.index();i=h.parent.canReplaceWith(m,m+1,t)}})}if(!i)return!1;if(r){let l=s.tr;for(let o=0;o<s.selection.ranges.length;o++){let{$from:{pos:c},$to:{pos:d}}=s.selection.ranges[o];l.setBlockType(c,d,t,n)}r(l.scrollIntoView())}return!0}}function xA(...t){return function(n,s,r){for(let i=0;i<t.length;i++)if(t[i](n,s,r))return!0;return!1}}xA(zb,iA,lA);xA(zb,cA,dA);xA(fA,mA,pA,bfe);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function iF(t,n=null){return function(s,r){let{$from:i,$to:l}=s.selection,o=i.blockRange(l);if(!o)return!1;let c=r?s.tr:null;return wfe(c,o,t,n)?(r&&r(c.scrollIntoView()),!0):!1}}function wfe(t,n,s,r=null){let i=!1,l=n,o=n.$from.doc;if(n.depth>=2&&n.$from.node(n.depth-1).type.compatibleContent(s)&&n.startIndex==0){if(n.$from.index(n.depth-1)==0)return!1;let d=o.resolve(n.start-2);l=new U1(d,d,n.depth),n.endIndex<n.parent.childCount&&(n=new U1(n.$from,o.resolve(n.$to.end(n.depth)),n.depth)),i=!0}let c=rA(l,s,r,n);return c?(t&&Nfe(t,n,c,i,s),!0):!1}function Nfe(t,n,s,r,i){let l=Oe.empty;for(let h=s.length-1;h>=0;h--)l=Oe.from(s[h].type.create(s[h].attrs,l));t.step(new Qs(n.start-(r?2:0),n.end,n.start,n.end,new tt(l,0,0),s.length,!0));let o=0;for(let h=0;h<s.length;h++)s[h].type==i&&(o=h+1);let c=s.length-o,d=n.start+s.length-(r?2:0),u=n.parent;for(let h=n.startIndex,m=n.endIndex,x=!0;h<m;h++,x=!1)!x&&Wa(t.doc,d,c)&&(t.split(d,c),d+=2*c),d+=u.child(h).nodeSize;return t}function lF(t){return function(n,s){let{$from:r,$to:i}=n.selection,l=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return l?s?r.node(l.depth-1).type==t?jfe(n,s,t,l):Sfe(n,s,l):!0:!1}}function jfe(t,n,s,r){let i=t.tr,l=r.end,o=r.$to.end(r.depth);l<o&&(i.step(new Qs(l-1,o,l,o,new tt(Oe.from(s.create(null,r.parent.copy())),1,0),1,!0)),r=new U1(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const c=Pu(r);if(c==null)return!1;i.lift(r,c);let d=i.doc.resolve(i.mapping.map(l,-1)-1);return Wl(i.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&i.join(d.pos),n(i.scrollIntoView()),!0}function Sfe(t,n,s){let r=t.tr,i=s.parent;for(let b=s.end,w=s.endIndex-1,j=s.startIndex;w>j;w--)b-=i.child(w).nodeSize,r.delete(b-1,b+1);let l=r.doc.resolve(s.start),o=l.nodeAfter;if(r.mapping.map(s.end)!=s.start+l.nodeAfter.nodeSize)return!1;let c=s.startIndex==0,d=s.endIndex==i.childCount,u=l.node(-1),h=l.index(-1);if(!u.canReplace(h+(c?0:1),h+1,o.content.append(d?Oe.empty:Oe.from(i))))return!1;let m=l.pos,x=m+o.nodeSize;return r.step(new Qs(m-(c?1:0),x+(d?1:0),m+1,x-1,new tt((c?Oe.empty:Oe.from(i.copy(Oe.empty))).append(d?Oe.empty:Oe.from(i.copy(Oe.empty))),c?0:1,d?0:1),c?0:1)),n(r.scrollIntoView()),!0}function oF(t){return function(n,s){let{$from:r,$to:i}=n.selection,l=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!l)return!1;let o=l.startIndex;if(o==0)return!1;let c=l.parent,d=c.child(o-1);if(d.type!=t)return!1;if(s){let u=d.lastChild&&d.lastChild.type==c.type,h=Oe.from(u?t.create():null),m=new tt(Oe.from(t.create(null,Oe.from(c.type.create(null,h)))),u?3:1,0),x=l.start,b=l.end;s(n.tr.step(new Qs(x-(u?3:1),b,x,b,m,1,!0)).scrollIntoView())}return!0}}const Mu=function(t){for(var n=0;;n++)if(t=t.previousSibling,!t)return n},cF=function(t,n,s,r){return s&&(aP(t,n,s,r,-1)||aP(t,n,s,r,1))},_fe=/^(img|br|input|textarea|hr)$/i;function aP(t,n,s,r,i){for(var l;;){if(t==s&&n==r)return!0;if(n==(i<0?0:W1(t))){let o=t.parentNode;if(!o||o.nodeType!=1||gA(t)||_fe.test(t.nodeName)||t.contentEditable=="false")return!1;n=Mu(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[n+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((l=o.pmViewDesc)===null||l===void 0)&&l.ignoreForSelection)n+=i;else return!1;else t=o,n=i<0?W1(t):0}else return!1}}function W1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Cfe(t,n,s){for(let r=n==0,i=n==W1(t);r||i;){if(t==s)return!0;let l=Mu(t);if(t=t.parentNode,!t)return!1;r=r&&l==0,i=i&&l==W1(t)}}function gA(t){let n;for(let s=t;s&&!(n=s.pmViewDesc);s=s.parentNode);return n&&n.node&&n.node.isBlock&&(n.dom==t||n.contentDOM==t)}const dF=function(t){return t.focusNode&&cF(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function uF(t,n){let s=document.createEvent("Event");return s.initEvent("keydown",!0,!0),s.keyCode=t,s.key=s.code=n,s}const Rl=typeof navigator<"u"?navigator:null,iP=typeof document<"u"?document:null,ed=Rl&&Rl.userAgent||"",FS=/Edge\/(\d+)/.exec(ed),fF=/MSIE \d/.exec(ed),$S=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ed),Cx=!!(fF||$S||FS),hF=fF?document.documentMode:$S?+$S[1]:FS?+FS[1]:0,Ub=!Cx&&/gecko\/(\d+)/i.test(ed);Ub&&+(/Firefox\/(\d+)/.exec(ed)||[0,0])[1];const zS=!Cx&&/Chrome\/(\d+)/.exec(ed),td=!!zS,mF=zS?+zS[1]:0,Ou=!Cx&&!!Rl&&/Apple Computer/.test(Rl.vendor),yA=Ou&&(/Mobile\/\w+/.test(ed)||!!Rl&&Rl.maxTouchPoints>2),pi=yA||(Rl?/Mac/.test(Rl.platform):!1),Afe=Rl?/Win/.test(Rl.platform):!1,Ax=/Android \d/.test(ed),bA=!!iP&&"webkitFontSmoothing"in iP.documentElement.style,kfe=bA?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Efe(t,n=null){let s=t.domSelectionRange(),r=t.state.doc;if(!s.focusNode)return null;let i=t.docView.nearestDesc(s.focusNode),l=i&&i.size==0,o=t.docView.posFromDOM(s.focusNode,s.focusOffset,1);if(o<0)return null;let c=r.resolve(o),d,u;if(dF(s)){for(d=o;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&vt.isSelectable(m)&&i.parent&&!(m.isInline&&Cfe(s.focusNode,s.focusOffset,i.dom))){let x=i.posBefore;u=new vt(o==x?c:r.resolve(x))}}else{if(s instanceof t.dom.ownerDocument.defaultView.Selection&&s.rangeCount>1){let m=o,x=o;for(let b=0;b<s.rangeCount;b++){let w=s.getRangeAt(b);m=Math.min(m,t.docView.posFromDOM(w.startContainer,w.startOffset,1)),x=Math.max(x,t.docView.posFromDOM(w.endContainer,w.endOffset,-1))}if(m<0)return null;[d,o]=x==t.state.selection.anchor?[x,m]:[m,x],c=r.resolve(o)}else d=t.docView.posFromDOM(s.anchorNode,s.anchorOffset,1);if(d<0)return null}let h=r.resolve(d);if(!u){let m=n=="pointer"||t.state.selection.head<c.pos&&!l?1:-1;u=xF(t,h,c,m)}return u}function pF(t){return t.editable?t.hasFocus():Mfe(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function vA(t,n=!1){let s=t.state.selection;if(Pfe(t,s),!!pF(t)){if(!n&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&td){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&cF(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Ife(t);else{let{anchor:r,head:i}=s,l,o;lP&&!(s instanceof xt)&&(s.$from.parent.inlineContent||(l=oP(t,s.from)),!s.empty&&!s.$from.parent.inlineContent&&(o=oP(t,s.to))),t.docView.setSelection(r,i,t,n),lP&&(l&&cP(l),o&&cP(o)),s.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Tfe(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const lP=Ou||td&&mF<63;function oP(t,n){let{node:s,offset:r}=t.docView.domFromPos(n,0),i=r<s.childNodes.length?s.childNodes[r]:null,l=r?s.childNodes[r-1]:null;if(Ou&&i&&i.contentEditable=="false")return UN(i);if((!i||i.contentEditable=="false")&&(!l||l.contentEditable=="false")){if(i)return UN(i);if(l)return UN(l)}}function UN(t){return t.contentEditable="true",Ou&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function cP(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Tfe(t){let n=t.dom.ownerDocument;n.removeEventListener("selectionchange",t.input.hideSelectionGuard);let s=t.domSelectionRange(),r=s.anchorNode,i=s.anchorOffset;n.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(s.anchorNode!=r||s.anchorOffset!=i)&&(n.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!pF(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Ife(t){let n=t.domSelection();if(!n)return;let s=t.cursorWrapper.dom,r=s.nodeName=="IMG";r?n.collapse(s.parentNode,Mu(s)+1):n.collapse(s,0),!r&&!t.state.selection.visible&&Cx&&hF<=11&&(s.disabled=!0,s.disabled=!1)}function Pfe(t,n){if(n instanceof vt){let s=t.docView.descAt(n.from);s!=t.lastSelectedViewDesc&&(dP(t),s&&s.selectNode(),t.lastSelectedViewDesc=s)}else dP(t)}function dP(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function xF(t,n,s,r){return t.someProp("createSelectionBetween",i=>i(t,n,s))||xt.between(n,s,r)}function Mfe(t){let n=t.domSelectionRange();if(!n.anchorNode)return!1;try{return t.dom.contains(n.anchorNode.nodeType==3?n.anchorNode.parentNode:n.anchorNode)&&(t.editable||t.dom.contains(n.focusNode.nodeType==3?n.focusNode.parentNode:n.focusNode))}catch{return!1}}function US(t,n){let{$anchor:s,$head:r}=t.selection,i=n>0?s.max(r):s.min(r),l=i.parent.inlineContent?i.depth?t.doc.resolve(n>0?i.after():i.before()):null:i;return l&&At.findFrom(l,n)}function lc(t,n){return t.dispatch(t.state.tr.setSelection(n).scrollIntoView()),!0}function uP(t,n,s){let r=t.state.selection;if(r instanceof xt)if(s.indexOf("s")>-1){let{$head:i}=r,l=i.textOffset?null:n<0?i.nodeBefore:i.nodeAfter;if(!l||l.isText||!l.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+l.nodeSize*(n<0?-1:1));return lc(t,new xt(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(n>0?"forward":"backward")){let i=US(t.state,n);return i&&i instanceof vt?lc(t,i):!1}else if(!(pi&&s.indexOf("m")>-1)){let i=r.$head,l=i.textOffset?null:n<0?i.nodeBefore:i.nodeAfter,o;if(!l||l.isText)return!1;let c=n<0?i.pos-l.nodeSize:i.pos;return l.isAtom||(o=t.docView.descAt(c))&&!o.contentDOM?vt.isSelectable(l)?lc(t,new vt(n<0?t.state.doc.resolve(i.pos-l.nodeSize):i)):bA?lc(t,new xt(t.state.doc.resolve(n<0?c:c+l.nodeSize))):!1:!1}}else return!1;else{if(r instanceof vt&&r.node.isInline)return lc(t,new xt(n>0?r.$to:r.$from));{let i=US(t.state,n);return i?lc(t,i):!1}}}function q1(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function np(t,n){let s=t.pmViewDesc;return s&&s.size==0&&(n<0||t.nextSibling||t.nodeName!="BR")}function Yu(t,n){return n<0?Ofe(t):Dfe(t)}function Ofe(t){let n=t.domSelectionRange(),s=n.focusNode,r=n.focusOffset;if(!s)return;let i,l,o=!1;for(Ub&&s.nodeType==1&&r<q1(s)&&np(s.childNodes[r],-1)&&(o=!0);;)if(r>0){if(s.nodeType!=1)break;{let c=s.childNodes[r-1];if(np(c,-1))i=s,l=--r;else if(c.nodeType==3)s=c,r=s.nodeValue.length;else break}}else{if(gF(s))break;{let c=s.previousSibling;for(;c&&np(c,-1);)i=s.parentNode,l=Mu(c),c=c.previousSibling;if(c)s=c,r=q1(s);else{if(s=s.parentNode,s==t.dom)break;r=0}}}o?VS(t,s,r):i&&VS(t,i,l)}function Dfe(t){let n=t.domSelectionRange(),s=n.focusNode,r=n.focusOffset;if(!s)return;let i=q1(s),l,o;for(;;)if(r<i){if(s.nodeType!=1)break;let c=s.childNodes[r];if(np(c,1))l=s,o=++r;else break}else{if(gF(s))break;{let c=s.nextSibling;for(;c&&np(c,1);)l=c.parentNode,o=Mu(c)+1,c=c.nextSibling;if(c)s=c,r=0,i=q1(s);else{if(s=s.parentNode,s==t.dom)break;r=i=0}}}l&&VS(t,l,o)}function gF(t){let n=t.pmViewDesc;return n&&n.node&&n.node.isBlock}function Rfe(t,n){for(;t&&n==t.childNodes.length&&!gA(t);)n=Mu(t)+1,t=t.parentNode;for(;t&&n<t.childNodes.length;){let s=t.childNodes[n];if(s.nodeType==3)return s;if(s.nodeType==1&&s.contentEditable=="false")break;t=s,n=0}}function Lfe(t,n){for(;t&&!n&&!gA(t);)n=Mu(t),t=t.parentNode;for(;t&&n;){let s=t.childNodes[n-1];if(s.nodeType==3)return s;if(s.nodeType==1&&s.contentEditable=="false")break;t=s,n=t.childNodes.length}}function VS(t,n,s){if(n.nodeType!=3){let l,o;(o=Rfe(n,s))?(n=o,s=0):(l=Lfe(n,s))&&(n=l,s=l.nodeValue.length)}let r=t.domSelection();if(!r)return;if(dF(r)){let l=document.createRange();l.setEnd(n,s),l.setStart(n,s),r.removeAllRanges(),r.addRange(l)}else r.extend&&r.extend(n,s);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&vA(t)},50)}function fP(t,n){let s=t.state.doc.resolve(n);if(!(td||Afe)&&s.parent.inlineContent){let i=t.coordsAtPos(n);if(n>s.start()){let l=t.coordsAtPos(n-1),o=(l.top+l.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(l.left-i.left)>1)return l.left<i.left?"ltr":"rtl"}if(n<s.end()){let l=t.coordsAtPos(n+1),o=(l.top+l.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(l.left-i.left)>1)return l.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function hP(t,n,s){let r=t.state.selection;if(r instanceof xt&&!r.empty||s.indexOf("s")>-1||pi&&s.indexOf("m")>-1)return!1;let{$from:i,$to:l}=r;if(!i.parent.inlineContent||t.endOfTextblock(n<0?"up":"down")){let o=US(t.state,n);if(o&&o instanceof vt)return lc(t,o)}if(!i.parent.inlineContent){let o=n<0?i:l,c=r instanceof _a?At.near(o,n):At.findFrom(o,n);return c?lc(t,c):!1}return!1}function mP(t,n){if(!(t.state.selection instanceof xt))return!0;let{$head:s,$anchor:r,empty:i}=t.state.selection;if(!s.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(n>0?"forward":"backward"))return!0;let l=!s.textOffset&&(n<0?s.nodeBefore:s.nodeAfter);if(l&&!l.isText){let o=t.state.tr;return n<0?o.delete(s.pos-l.nodeSize,s.pos):o.delete(s.pos,s.pos+l.nodeSize),t.dispatch(o),!0}return!1}function pP(t,n,s){t.domObserver.stop(),n.contentEditable=s,t.domObserver.start()}function Bfe(t){if(!Ou||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:n,focusOffset:s}=t.domSelectionRange();if(n&&n.nodeType==1&&s==0&&n.firstChild&&n.firstChild.contentEditable=="false"){let r=n.firstChild;pP(t,r,"true"),setTimeout(()=>pP(t,r,"false"),20)}return!1}function Ffe(t){let n="";return t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n}function $fe(t,n){let s=n.keyCode,r=Ffe(n);if(s==8||pi&&s==72&&r=="c")return mP(t,-1)||Yu(t,-1);if(s==46&&!n.shiftKey||pi&&s==68&&r=="c")return mP(t,1)||Yu(t,1);if(s==13||s==27)return!0;if(s==37||pi&&s==66&&r=="c"){let i=s==37?fP(t,t.state.selection.from)=="ltr"?-1:1:-1;return uP(t,i,r)||Yu(t,i)}else if(s==39||pi&&s==70&&r=="c"){let i=s==39?fP(t,t.state.selection.from)=="ltr"?1:-1:1;return uP(t,i,r)||Yu(t,i)}else{if(s==38||pi&&s==80&&r=="c")return hP(t,-1,r)||Yu(t,-1);if(s==40||pi&&s==78&&r=="c")return Bfe(t)||hP(t,1,r)||Yu(t,1);if(r==(pi?"m":"c")&&(s==66||s==73||s==89||s==90))return!0}return!1}function yF(t,n){t.someProp("transformCopied",b=>{n=b(n,t)});let s=[],{content:r,openStart:i,openEnd:l}=n;for(;i>1&&l>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,l--;let b=r.firstChild;s.push(b.type.name,b.attrs!=b.type.defaultAttrs?b.attrs:null),r=b.content}let o=t.someProp("clipboardSerializer")||Bb.fromSchema(t.state.schema),c=SF(),d=c.createElement("div");d.appendChild(o.serializeFragment(r,{document:c}));let u=d.firstChild,h,m=0;for(;u&&u.nodeType==1&&(h=jF[u.nodeName.toLowerCase()]);){for(let b=h.length-1;b>=0;b--){let w=c.createElement(h[b]);for(;d.firstChild;)w.appendChild(d.firstChild);d.appendChild(w),m++}u=d.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${l}${m?` -${m}`:""} ${JSON.stringify(s)}`);let x=t.someProp("clipboardTextSerializer",b=>b(n,t))||n.content.textBetween(0,n.content.size,`

`);return{dom:d,text:x,slice:n}}function bF(t,n,s,r,i){let l=i.parent.type.spec.code,o,c;if(!s&&!n)return null;let d=!!n&&(r||l||!s);if(d){if(t.someProp("transformPastedText",x=>{n=x(n,l||r,t)}),l)return c=new tt(Oe.from(t.state.schema.text(n.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",x=>{c=x(c,t,!0)}),c;let m=t.someProp("clipboardTextParser",x=>x(n,i,r,t));if(m)c=m;else{let x=i.marks(),{schema:b}=t.state,w=Bb.fromSchema(b);o=document.createElement("div"),n.split(/(?:\r\n?|\n)+/).forEach(j=>{let S=o.appendChild(document.createElement("p"));j&&S.appendChild(w.serializeNode(b.text(j,x)))})}}else t.someProp("transformPastedHTML",m=>{s=m(s,t)}),o=Hfe(s),bA&&Wfe(o);let u=o&&o.querySelector("[data-pm-slice]"),h=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let m=+h[3];m>0;m--){let x=o.firstChild;for(;x&&x.nodeType!=1;)x=x.nextSibling;if(!x)break;o=x}if(c||(c=(t.someProp("clipboardParser")||t.someProp("domParser")||Ml.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(d||h),context:i,ruleFromNode(x){return x.nodeName=="BR"&&!x.nextSibling&&x.parentNode&&!zfe.test(x.parentNode.nodeName)?{ignore:!0}:null}})),h)c=qfe(xP(c,+h[1],+h[2]),h[4]);else if(c=tt.maxOpen(Ufe(c.content,i),!0),c.openStart||c.openEnd){let m=0,x=0;for(let b=c.content.firstChild;m<c.openStart&&!b.type.spec.isolating;m++,b=b.firstChild);for(let b=c.content.lastChild;x<c.openEnd&&!b.type.spec.isolating;x++,b=b.lastChild);c=xP(c,m,x)}return t.someProp("transformPasted",m=>{c=m(c,t,d)}),c}const zfe=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Ufe(t,n){if(t.childCount<2)return t;for(let s=n.depth;s>=0;s--){let i=n.node(s).contentMatchAt(n.index(s)),l,o=[];if(t.forEach(c=>{if(!o)return;let d=i.findWrapping(c.type),u;if(!d)return o=null;if(u=o.length&&l.length&&wF(d,l,c,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=NF(o[o.length-1],l.length));let h=vF(c,d);o.push(h),i=i.matchType(h.type),l=d}}),o)return Oe.from(o)}return t}function vF(t,n,s=0){for(let r=n.length-1;r>=s;r--)t=n[r].create(null,Oe.from(t));return t}function wF(t,n,s,r,i){if(i<t.length&&i<n.length&&t[i]==n[i]){let l=wF(t,n,s,r.lastChild,i+1);if(l)return r.copy(r.content.replaceChild(r.childCount-1,l));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?s.type:t[i+1]))return r.copy(r.content.append(Oe.from(vF(s,t,i+1))))}}function NF(t,n){if(n==0)return t;let s=t.content.replaceChild(t.childCount-1,NF(t.lastChild,n-1)),r=t.contentMatchAt(t.childCount).fillBefore(Oe.empty,!0);return t.copy(s.append(r))}function HS(t,n,s,r,i,l){let o=n<0?t.firstChild:t.lastChild,c=o.content;return t.childCount>1&&(l=0),i<r-1&&(c=HS(c,n,s,r,i+1,l)),i>=s&&(c=n<0?o.contentMatchAt(0).fillBefore(c,l<=i).append(c):c.append(o.contentMatchAt(o.childCount).fillBefore(Oe.empty,!0))),t.replaceChild(n<0?0:t.childCount-1,o.copy(c))}function xP(t,n,s){return n<t.openStart&&(t=new tt(HS(t.content,-1,n,t.openStart,0,t.openEnd),n,t.openEnd)),s<t.openEnd&&(t=new tt(HS(t.content,1,s,t.openEnd,0,0),t.openStart,s)),t}const jF={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let gP=null;function SF(){return gP||(gP=document.implementation.createHTMLDocument("title"))}let VN=null;function Vfe(t){let n=window.trustedTypes;return n?(VN||(VN=n.defaultPolicy||n.createPolicy("ProseMirrorClipboard",{createHTML:s=>s})),VN.createHTML(t)):t}function Hfe(t){let n=/^(\s*<meta [^>]*>)*/.exec(t);n&&(t=t.slice(n[0].length));let s=SF().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&jF[r[1].toLowerCase()])&&(t=i.map(l=>"<"+l+">").join("")+t+i.map(l=>"</"+l+">").reverse().join("")),s.innerHTML=Vfe(t),i)for(let l=0;l<i.length;l++)s=s.querySelector(i[l])||s;return s}function Wfe(t){let n=t.querySelectorAll(td?"span:not([class]):not([style])":"span.Apple-converted-space");for(let s=0;s<n.length;s++){let r=n[s];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function qfe(t,n){if(!t.size)return t;let s=t.content.firstChild.type.schema,r;try{r=JSON.parse(n)}catch{return t}let{content:i,openStart:l,openEnd:o}=t;for(let c=r.length-2;c>=0;c-=2){let d=s.nodes[r[c]];if(!d||d.hasRequiredAttrs())break;i=Oe.from(d.create(r[c+1],i)),l++,o++}return new tt(i,l,o)}const al={},Qa={};function vc(t,n){t.input.lastSelectionOrigin=n,t.input.lastSelectionTime=Date.now()}Qa.keydown=(t,n)=>{let s=n;if(t.input.shiftKey=s.keyCode==16||s.shiftKey,!CF(t,s)&&(t.input.lastKeyCode=s.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Ax&&td&&s.keyCode==13)))if(s.keyCode!=229&&t.domObserver.forceFlush(),yA&&s.keyCode==13&&!s.ctrlKey&&!s.altKey&&!s.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,uF(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,s))||$fe(t,s)?s.preventDefault():vc(t,"key")};Qa.keyup=(t,n)=>{n.keyCode==16&&(t.input.shiftKey=!1)};Qa.keypress=(t,n)=>{let s=n;if(CF(t,s)||!s.charCode||s.ctrlKey&&!s.altKey||pi&&s.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,s))){s.preventDefault();return}let r=t.state.selection;if(!(r instanceof xt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(s.charCode),l=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i,l))&&t.dispatch(l()),s.preventDefault()}};function Vb(t){return{left:t.clientX,top:t.clientY}}function Gfe(t,n){let s=n.x-t.clientX,r=n.y-t.clientY;return s*s+r*r<100}function wA(t,n,s,r,i){if(r==-1)return!1;let l=t.state.doc.resolve(r);for(let o=l.depth+1;o>0;o--)if(t.someProp(n,c=>o>l.depth?c(t,s,l.nodeAfter,l.before(o),i,!0):c(t,s,l.node(o),l.before(o),i,!1)))return!0;return!1}function Rf(t,n,s){if(t.focused||t.focus(),t.state.selection.eq(n))return;let r=t.state.tr.setSelection(n);r.setMeta("pointer",!0),t.dispatch(r)}function Kfe(t,n){if(n==-1)return!1;let s=t.state.doc.resolve(n),r=s.nodeAfter;return r&&r.isAtom&&vt.isSelectable(r)?(Rf(t,new vt(s)),!0):!1}function Yfe(t,n){if(n==-1)return!1;let s=t.state.selection,r,i;s instanceof vt&&(r=s.node);let l=t.state.doc.resolve(n);for(let o=l.depth+1;o>0;o--){let c=o>l.depth?l.nodeAfter:l.node(o);if(vt.isSelectable(c)){r&&s.$from.depth>0&&o>=s.$from.depth&&l.before(s.$from.depth+1)==s.$from.pos?i=l.before(s.$from.depth):i=l.before(o);break}}return i!=null?(Rf(t,vt.create(t.state.doc,i)),!0):!1}function Xfe(t,n,s,r,i){return wA(t,"handleClickOn",n,s,r)||t.someProp("handleClick",l=>l(t,n,r))||(i?Yfe(t,s):Kfe(t,s))}function Qfe(t,n,s,r){return wA(t,"handleDoubleClickOn",n,s,r)||t.someProp("handleDoubleClick",i=>i(t,n,r))}function Zfe(t,n,s,r){return wA(t,"handleTripleClickOn",n,s,r)||t.someProp("handleTripleClick",i=>i(t,n,r))||Jfe(t,s,r)}function Jfe(t,n,s){if(s.button!=0)return!1;let r=t.state.doc;if(n==-1)return r.inlineContent?(Rf(t,xt.create(r,0,r.content.size)),!0):!1;let i=r.resolve(n);for(let l=i.depth+1;l>0;l--){let o=l>i.depth?i.nodeAfter:i.node(l),c=i.before(l);if(o.inlineContent)Rf(t,xt.create(r,c+1,c+1+o.content.size));else if(vt.isSelectable(o))Rf(t,vt.create(r,c));else continue;return!0}}function NA(t){return G1(t)}const _F=pi?"metaKey":"ctrlKey";al.mousedown=(t,n)=>{let s=n;t.input.shiftKey=s.shiftKey;let r=NA(t),i=Date.now(),l="singleClick";i-t.input.lastClick.time<500&&Gfe(s,t.input.lastClick)&&!s[_F]&&t.input.lastClick.button==s.button&&(t.input.lastClick.type=="singleClick"?l="doubleClick":t.input.lastClick.type=="doubleClick"&&(l="tripleClick")),t.input.lastClick={time:i,x:s.clientX,y:s.clientY,type:l,button:s.button};let o=t.posAtCoords(Vb(s));o&&(l=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new ehe(t,o,s,!!r)):(l=="doubleClick"?Qfe:Zfe)(t,o.pos,o.inside,s)?s.preventDefault():vc(t,"pointer"))};class ehe{constructor(n,s,r,i){this.view=n,this.pos=s,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=n.state.doc,this.selectNode=!!r[_F],this.allowDefault=r.shiftKey;let l,o;if(s.inside>-1)l=n.state.doc.nodeAt(s.inside),o=s.inside;else{let h=n.state.doc.resolve(s.pos);l=h.parent,o=h.depth?h.before():0}const c=i?null:r.target,d=c?n.docView.nearestDesc(c,!0):null;this.target=d&&d.nodeDOM.nodeType==1?d.nodeDOM:null;let{selection:u}=n.state;(r.button==0&&l.type.spec.draggable&&l.type.spec.selectable!==!1||u instanceof vt&&u.from<=o&&u.to>o)&&(this.mightDrag={node:l,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ub&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),n.root.addEventListener("mouseup",this.up=this.up.bind(this)),n.root.addEventListener("mousemove",this.move=this.move.bind(this)),vc(n,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>vA(this.view)),this.view.input.mouseDown=null}up(n){if(this.done(),!this.view.dom.contains(n.target))return;let s=this.pos;this.view.state.doc!=this.startDoc&&(s=this.view.posAtCoords(Vb(n))),this.updateAllowDefault(n),this.allowDefault||!s?vc(this.view,"pointer"):Xfe(this.view,s.pos,s.inside,n,this.selectNode)?n.preventDefault():n.button==0&&(this.flushed||Ou&&this.mightDrag&&!this.mightDrag.node.isAtom||td&&!this.view.state.selection.visible&&Math.min(Math.abs(s.pos-this.view.state.selection.from),Math.abs(s.pos-this.view.state.selection.to))<=2)?(Rf(this.view,At.near(this.view.state.doc.resolve(s.pos))),n.preventDefault()):vc(this.view,"pointer")}move(n){this.updateAllowDefault(n),vc(this.view,"pointer"),n.buttons==0&&this.done()}updateAllowDefault(n){!this.allowDefault&&(Math.abs(this.event.x-n.clientX)>4||Math.abs(this.event.y-n.clientY)>4)&&(this.allowDefault=!0)}}al.touchstart=t=>{t.input.lastTouch=Date.now(),NA(t),vc(t,"pointer")};al.touchmove=t=>{t.input.lastTouch=Date.now(),vc(t,"pointer")};al.contextmenu=t=>NA(t);function CF(t,n){return t.composing?!0:Ou&&Math.abs(n.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const the=Ax?5e3:-1;Qa.compositionstart=Qa.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:n}=t,s=n.selection.$to;if(n.selection instanceof xt&&(n.storedMarks||!s.textOffset&&s.parentOffset&&s.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||s.marks(),G1(t,!0),t.markCursor=null;else if(G1(t,!n.selection.empty),Ub&&n.selection.empty&&s.parentOffset&&!s.textOffset&&s.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,l=r.focusOffset;i&&i.nodeType==1&&l!=0;){let o=l<0?i.lastChild:i.childNodes[l-1];if(!o)break;if(o.nodeType==3){let c=t.domSelection();c&&c.collapse(o,o.nodeValue.length);break}else i=o,l=-1}}t.input.composing=!0}AF(t,the)};Qa.compositionend=(t,n)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=n.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,AF(t,20))};function AF(t,n){clearTimeout(t.input.composingTimeout),n>-1&&(t.input.composingTimeout=setTimeout(()=>G1(t),n))}function nhe(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=she());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function she(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function G1(t,n=!1){if(!(Ax&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),nhe(t),n||t.docView&&t.docView.dirty){let s=Efe(t),r=t.state.selection;return s&&!s.eq(r)?t.dispatch(t.state.tr.setSelection(s)):(t.markCursor||n)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function rhe(t,n){if(!t.dom.parentNode)return;let s=t.dom.parentNode.appendChild(document.createElement("div"));s.appendChild(n),s.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(n),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s),t.focus()},50)}const Fp=Cx&&hF<15||yA&&kfe<604;al.copy=Qa.cut=(t,n)=>{let s=n,r=t.state.selection,i=s.type=="cut";if(r.empty)return;let l=Fp?null:s.clipboardData,o=r.content(),{dom:c,text:d}=yF(t,o);l?(s.preventDefault(),l.clearData(),l.setData("text/html",c.innerHTML),l.setData("text/plain",d)):rhe(t,c),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function ahe(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function ihe(t,n){if(!t.dom.parentNode)return;let s=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(s?"textarea":"div"));s||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),s?WS(t,r.value,null,i,n):WS(t,r.textContent,r.innerHTML,i,n)},50)}function WS(t,n,s,r,i){let l=bF(t,n,s,r,t.state.selection.$from);if(t.someProp("handlePaste",d=>d(t,i,l||tt.empty)))return!0;if(!l)return!1;let o=ahe(l),c=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(l);return t.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function kF(t){let n=t.getData("text/plain")||t.getData("Text");if(n)return n;let s=t.getData("text/uri-list");return s?s.replace(/\r?\n/g," "):""}Qa.paste=(t,n)=>{let s=n;if(t.composing&&!Ax)return;let r=Fp?null:s.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&WS(t,kF(r),r.getData("text/html"),i,s)?s.preventDefault():ihe(t,s)};class lhe{constructor(n,s,r){this.slice=n,this.move=s,this.node=r}}const ohe=pi?"altKey":"ctrlKey";function EF(t,n){let s=t.someProp("dragCopies",r=>!r(n));return s??!n[ohe]}al.dragstart=(t,n)=>{let s=n,r=t.input.mouseDown;if(r&&r.done(),!s.dataTransfer)return;let i=t.state.selection,l=i.empty?null:t.posAtCoords(Vb(s)),o;if(!(l&&l.pos>=i.from&&l.pos<=(i instanceof vt?i.to-1:i.to))){if(r&&r.mightDrag)o=vt.create(t.state.doc,r.mightDrag.pos);else if(s.target&&s.target.nodeType==1){let m=t.docView.nearestDesc(s.target,!0);m&&m.node.type.spec.draggable&&m!=t.docView&&(o=vt.create(t.state.doc,m.posBefore))}}let c=(o||t.state.selection).content(),{dom:d,text:u,slice:h}=yF(t,c);(!s.dataTransfer.files.length||!td||mF>120)&&s.dataTransfer.clearData(),s.dataTransfer.setData(Fp?"Text":"text/html",d.innerHTML),s.dataTransfer.effectAllowed="copyMove",Fp||s.dataTransfer.setData("text/plain",u),t.dragging=new lhe(h,EF(t,s),o)};al.dragend=t=>{let n=t.dragging;window.setTimeout(()=>{t.dragging==n&&(t.dragging=null)},50)};Qa.dragover=Qa.dragenter=(t,n)=>n.preventDefault();Qa.drop=(t,n)=>{let s=n,r=t.dragging;if(t.dragging=null,!s.dataTransfer)return;let i=t.posAtCoords(Vb(s));if(!i)return;let l=t.state.doc.resolve(i.pos),o=r&&r.slice;o?t.someProp("transformPasted",w=>{o=w(o,t,!1)}):o=bF(t,kF(s.dataTransfer),Fp?null:s.dataTransfer.getData("text/html"),!1,l);let c=!!(r&&EF(t,s));if(t.someProp("handleDrop",w=>w(t,s,o||tt.empty,c))){s.preventDefault();return}if(!o)return;s.preventDefault();let d=o?R9(t.state.doc,l.pos,o):l.pos;d==null&&(d=l.pos);let u=t.state.tr;if(c){let{node:w}=r;w?w.replace(u):u.deleteSelection()}let h=u.mapping.map(d),m=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,x=u.doc;if(m?u.replaceRangeWith(h,h,o.content.firstChild):u.replaceRange(h,h,o),u.doc.eq(x))return;let b=u.doc.resolve(h);if(m&&vt.isSelectable(o.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new vt(b));else{let w=u.mapping.map(d);u.mapping.maps[u.mapping.maps.length-1].forEach((j,S,C,A)=>w=A),u.setSelection(xF(t,b,u.doc.resolve(w)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};al.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&vA(t)},20))};al.blur=(t,n)=>{let s=n;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),s.relatedTarget&&t.dom.contains(s.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};al.beforeinput=(t,n)=>{if(td&&Ax&&n.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",l=>l(t,uF(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Qa)al[t]=Qa[t];function $p(t,n){if(t==n)return!0;for(let s in t)if(t[s]!==n[s])return!1;for(let s in n)if(!(s in t))return!1;return!0}class K1{constructor(n,s){this.toDOM=n,this.spec=s||Xd,this.side=this.spec.side||0}map(n,s,r,i){let{pos:l,deleted:o}=n.mapResult(s.from+i,this.side<0?-1:1);return o?null:new Va(l-r,l-r,this)}valid(){return!0}eq(n){return this==n||n instanceof K1&&(this.spec.key&&this.spec.key==n.spec.key||this.toDOM==n.toDOM&&$p(this.spec,n.spec))}destroy(n){this.spec.destroy&&this.spec.destroy(n)}}class Ic{constructor(n,s){this.attrs=n,this.spec=s||Xd}map(n,s,r,i){let l=n.map(s.from+i,this.spec.inclusiveStart?-1:1)-r,o=n.map(s.to+i,this.spec.inclusiveEnd?1:-1)-r;return l>=o?null:new Va(l,o,this)}valid(n,s){return s.from<s.to}eq(n){return this==n||n instanceof Ic&&$p(this.attrs,n.attrs)&&$p(this.spec,n.spec)}static is(n){return n.type instanceof Ic}destroy(){}}class jA{constructor(n,s){this.attrs=n,this.spec=s||Xd}map(n,s,r,i){let l=n.mapResult(s.from+i,1);if(l.deleted)return null;let o=n.mapResult(s.to+i,-1);return o.deleted||o.pos<=l.pos?null:new Va(l.pos-r,o.pos-r,this)}valid(n,s){let{index:r,offset:i}=n.content.findIndex(s.from),l;return i==s.from&&!(l=n.child(r)).isText&&i+l.nodeSize==s.to}eq(n){return this==n||n instanceof jA&&$p(this.attrs,n.attrs)&&$p(this.spec,n.spec)}destroy(){}}class Va{constructor(n,s,r){this.from=n,this.to=s,this.type=r}copy(n,s){return new Va(n,s,this.type)}eq(n,s=0){return this.type.eq(n.type)&&this.from+s==n.from&&this.to+s==n.to}map(n,s,r){return this.type.map(n,this,s,r)}static widget(n,s,r){return new Va(n,n,new K1(s,r))}static inline(n,s,r,i){return new Va(n,s,new Ic(r,i))}static node(n,s,r,i){return new Va(n,s,new jA(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ic}get widget(){return this.type instanceof K1}}const sf=[],Xd={};class bs{constructor(n,s){this.local=n.length?n:sf,this.children=s.length?s:sf}static create(n,s){return s.length?Y1(s,n,0,Xd):Xr}find(n,s,r){let i=[];return this.findInner(n??0,s??1e9,i,0,r),i}findInner(n,s,r,i,l){for(let o=0;o<this.local.length;o++){let c=this.local[o];c.from<=s&&c.to>=n&&(!l||l(c.spec))&&r.push(c.copy(c.from+i,c.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<s&&this.children[o+1]>n){let c=this.children[o]+1;this.children[o+2].findInner(n-c,s-c,r,i+c,l)}}map(n,s,r){return this==Xr||n.maps.length==0?this:this.mapInner(n,s,0,0,r||Xd)}mapInner(n,s,r,i,l){let o;for(let c=0;c<this.local.length;c++){let d=this.local[c].map(n,r,i);d&&d.type.valid(s,d)?(o||(o=[])).push(d):l.onRemove&&l.onRemove(this.local[c].spec)}return this.children.length?che(this.children,o||[],n,s,r,i,l):o?new bs(o.sort(Qd),sf):Xr}add(n,s){return s.length?this==Xr?bs.create(n,s):this.addInner(n,s,0):this}addInner(n,s,r){let i,l=0;n.forEach((c,d)=>{let u=d+r,h;if(h=IF(s,c,u)){for(i||(i=this.children.slice());l<i.length&&i[l]<d;)l+=3;i[l]==d?i[l+2]=i[l+2].addInner(c,h,u+1):i.splice(l,0,d,d+c.nodeSize,Y1(h,c,u+1,Xd)),l+=3}});let o=TF(l?PF(s):s,-r);for(let c=0;c<o.length;c++)o[c].type.valid(n,o[c])||o.splice(c--,1);return new bs(o.length?this.local.concat(o).sort(Qd):this.local,i||this.children)}remove(n){return n.length==0||this==Xr?this:this.removeInner(n,0)}removeInner(n,s){let r=this.children,i=this.local;for(let l=0;l<r.length;l+=3){let o,c=r[l]+s,d=r[l+1]+s;for(let h=0,m;h<n.length;h++)(m=n[h])&&m.from>c&&m.to<d&&(n[h]=null,(o||(o=[])).push(m));if(!o)continue;r==this.children&&(r=this.children.slice());let u=r[l+2].removeInner(o,c+1);u!=Xr?r[l+2]=u:(r.splice(l,3),l-=3)}if(i.length){for(let l=0,o;l<n.length;l++)if(o=n[l])for(let c=0;c<i.length;c++)i[c].eq(o,s)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new bs(i,r):Xr}forChild(n,s){if(this==Xr)return this;if(s.isLeaf)return bs.empty;let r,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=n){this.children[c]==n&&(r=this.children[c+2]);break}let l=n+1,o=l+s.content.size;for(let c=0;c<this.local.length;c++){let d=this.local[c];if(d.from<o&&d.to>l&&d.type instanceof Ic){let u=Math.max(l,d.from)-l,h=Math.min(o,d.to)-l;u<h&&(i||(i=[])).push(d.copy(u,h))}}if(i){let c=new bs(i.sort(Qd),sf);return r?new Sd([c,r]):c}return r||Xr}eq(n){if(this==n)return!0;if(!(n instanceof bs)||this.local.length!=n.local.length||this.children.length!=n.children.length)return!1;for(let s=0;s<this.local.length;s++)if(!this.local[s].eq(n.local[s]))return!1;for(let s=0;s<this.children.length;s+=3)if(this.children[s]!=n.children[s]||this.children[s+1]!=n.children[s+1]||!this.children[s+2].eq(n.children[s+2]))return!1;return!0}locals(n){return SA(this.localsInner(n))}localsInner(n){if(this==Xr)return sf;if(n.inlineContent||!this.local.some(Ic.is))return this.local;let s=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ic||s.push(this.local[r]);return s}forEachSet(n){n(this)}}bs.empty=new bs([],[]);bs.removeOverlap=SA;const Xr=bs.empty;class Sd{constructor(n){this.members=n}map(n,s){const r=this.members.map(i=>i.map(n,s,Xd));return Sd.from(r)}forChild(n,s){if(s.isLeaf)return bs.empty;let r=[];for(let i=0;i<this.members.length;i++){let l=this.members[i].forChild(n,s);l!=Xr&&(l instanceof Sd?r=r.concat(l.members):r.push(l))}return Sd.from(r)}eq(n){if(!(n instanceof Sd)||n.members.length!=this.members.length)return!1;for(let s=0;s<this.members.length;s++)if(!this.members[s].eq(n.members[s]))return!1;return!0}locals(n){let s,r=!0;for(let i=0;i<this.members.length;i++){let l=this.members[i].localsInner(n);if(l.length)if(!s)s=l;else{r&&(s=s.slice(),r=!1);for(let o=0;o<l.length;o++)s.push(l[o])}}return s?SA(r?s:s.sort(Qd)):sf}static from(n){switch(n.length){case 0:return Xr;case 1:return n[0];default:return new Sd(n.every(s=>s instanceof bs)?n:n.reduce((s,r)=>s.concat(r instanceof bs?r:r.members),[]))}}forEachSet(n){for(let s=0;s<this.members.length;s++)this.members[s].forEachSet(n)}}function che(t,n,s,r,i,l,o){let c=t.slice();for(let u=0,h=l;u<s.maps.length;u++){let m=0;s.maps[u].forEach((x,b,w,j)=>{let S=j-w-(b-x);for(let C=0;C<c.length;C+=3){let A=c[C+1];if(A<0||x>A+h-m)continue;let k=c[C]+h-m;b>=k?c[C+1]=x<=k?-2:-1:x>=h&&S&&(c[C]+=S,c[C+1]+=S)}m+=S}),h=s.maps[u].map(h,-1)}let d=!1;for(let u=0;u<c.length;u+=3)if(c[u+1]<0){if(c[u+1]==-2){d=!0,c[u+1]=-1;continue}let h=s.map(t[u]+l),m=h-i;if(m<0||m>=r.content.size){d=!0;continue}let x=s.map(t[u+1]+l,-1),b=x-i,{index:w,offset:j}=r.content.findIndex(m),S=r.maybeChild(w);if(S&&j==m&&j+S.nodeSize==b){let C=c[u+2].mapInner(s,S,h+1,t[u]+l+1,o);C!=Xr?(c[u]=m,c[u+1]=b,c[u+2]=C):(c[u+1]=-2,d=!0)}else d=!0}if(d){let u=dhe(c,t,n,s,i,l,o),h=Y1(u,r,0,o);n=h.local;for(let m=0;m<c.length;m+=3)c[m+1]<0&&(c.splice(m,3),m-=3);for(let m=0,x=0;m<h.children.length;m+=3){let b=h.children[m];for(;x<c.length&&c[x]<b;)x+=3;c.splice(x,0,h.children[m],h.children[m+1],h.children[m+2])}}return new bs(n.sort(Qd),c)}function TF(t,n){if(!n||!t.length)return t;let s=[];for(let r=0;r<t.length;r++){let i=t[r];s.push(new Va(i.from+n,i.to+n,i.type))}return s}function dhe(t,n,s,r,i,l,o){function c(d,u){for(let h=0;h<d.local.length;h++){let m=d.local[h].map(r,i,u);m?s.push(m):o.onRemove&&o.onRemove(d.local[h].spec)}for(let h=0;h<d.children.length;h+=3)c(d.children[h+2],d.children[h]+u+1)}for(let d=0;d<t.length;d+=3)t[d+1]==-1&&c(t[d+2],n[d]+l+1);return s}function IF(t,n,s){if(n.isLeaf)return null;let r=s+n.nodeSize,i=null;for(let l=0,o;l<t.length;l++)(o=t[l])&&o.from>s&&o.to<r&&((i||(i=[])).push(o),t[l]=null);return i}function PF(t){let n=[];for(let s=0;s<t.length;s++)t[s]!=null&&n.push(t[s]);return n}function Y1(t,n,s,r){let i=[],l=!1;n.forEach((c,d)=>{let u=IF(t,c,d+s);if(u){l=!0;let h=Y1(u,c,s+d+1,r);h!=Xr&&i.push(d,d+c.nodeSize,h)}});let o=TF(l?PF(t):t,-s).sort(Qd);for(let c=0;c<o.length;c++)o[c].type.valid(n,o[c])||(r.onRemove&&r.onRemove(o[c].spec),o.splice(c--,1));return o.length||i.length?new bs(o,i):Xr}function Qd(t,n){return t.from-n.from||t.to-n.to}function SA(t){let n=t;for(let s=0;s<n.length-1;s++){let r=n[s];if(r.from!=r.to)for(let i=s+1;i<n.length;i++){let l=n[i];if(l.from==r.from){l.to!=r.to&&(n==t&&(n=t.slice()),n[i]=l.copy(l.from,r.to),yP(n,i+1,l.copy(r.to,l.to)));continue}else{l.from<r.to&&(n==t&&(n=t.slice()),n[s]=r.copy(r.from,l.from),yP(n,i,r.copy(l.from,r.to)));break}}}return n}function yP(t,n,s){for(;n<t.length&&Qd(s,t[n])>0;)n++;t.splice(n,0,s)}var Vc={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},X1={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},uhe=typeof navigator<"u"&&/Mac/.test(navigator.platform),fhe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Sr=0;Sr<10;Sr++)Vc[48+Sr]=Vc[96+Sr]=String(Sr);for(var Sr=1;Sr<=24;Sr++)Vc[Sr+111]="F"+Sr;for(var Sr=65;Sr<=90;Sr++)Vc[Sr]=String.fromCharCode(Sr+32),X1[Sr]=String.fromCharCode(Sr);for(var HN in Vc)X1.hasOwnProperty(HN)||(X1[HN]=Vc[HN]);function hhe(t){var n=uhe&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||fhe&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",s=!n&&t.key||(t.shiftKey?X1:Vc)[t.keyCode]||t.key||"Unidentified";return s=="Esc"&&(s="Escape"),s=="Del"&&(s="Delete"),s=="Left"&&(s="ArrowLeft"),s=="Up"&&(s="ArrowUp"),s=="Right"&&(s="ArrowRight"),s=="Down"&&(s="ArrowDown"),s}const mhe=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),phe=typeof navigator<"u"&&/Win/.test(navigator.platform);function xhe(t){let n=t.split(/-(?!$)/),s=n[n.length-1];s=="Space"&&(s=" ");let r,i,l,o;for(let c=0;c<n.length-1;c++){let d=n[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))mhe?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(s="Alt-"+s),i&&(s="Ctrl-"+s),o&&(s="Meta-"+s),l&&(s="Shift-"+s),s}function ghe(t){let n=Object.create(null);for(let s in t)n[xhe(s)]=t[s];return n}function WN(t,n,s=!0){return n.altKey&&(t="Alt-"+t),n.ctrlKey&&(t="Ctrl-"+t),n.metaKey&&(t="Meta-"+t),s&&n.shiftKey&&(t="Shift-"+t),t}function MF(t){let n=ghe(t);return function(s,r){let i=hhe(r),l,o=n[WN(i,r)];if(o&&o(s.state,s.dispatch,s))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let c=n[WN(i,r,!1)];if(c&&c(s.state,s.dispatch,s))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(phe&&r.ctrlKey&&r.altKey)&&(l=Vc[r.keyCode])&&l!=i){let c=n[WN(l,r)];if(c&&c(s.state,s.dispatch,s))return!0}}return!1}}var yhe=Object.defineProperty,_A=(t,n)=>{for(var s in n)yhe(t,s,{get:n[s],enumerable:!0})};function OF(t){const{state:n,transaction:s}=t;let{selection:r}=s,{doc:i}=s,{storedMarks:l}=s;return{...n,apply:n.apply.bind(n),applyTransaction:n.applyTransaction.bind(n),plugins:n.plugins,schema:n.schema,reconfigure:n.reconfigure.bind(n),toJSON:n.toJSON.bind(n),get storedMarks(){return l},get selection(){return r},get doc(){return i},get tr(){return r=s.selection,i=s.doc,l=s.storedMarks,s}}}var bhe=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:s,state:r}=this,{view:i}=s,{tr:l}=r,o=this.buildProps(l);return Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...h)=>{const m=d(...h)(o);return!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,s=!0){const{rawCommands:r,editor:i,state:l}=this,{view:o}=i,c=[],d=!!n,u=n||l.tr,h=()=>(!d&&s&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),c.every(x=>x===!0)),m={...Object.fromEntries(Object.entries(r).map(([x,b])=>[x,(...j)=>{const S=this.buildProps(u,s),C=b(...j)(S);return c.push(C),m}])),run:h};return m}createCan(n){const{rawCommands:s,state:r}=this,i=!1,l=n||r.tr,o=this.buildProps(l,i);return{...Object.fromEntries(Object.entries(s).map(([d,u])=>[d,(...h)=>u(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(l,i)}}buildProps(n,s=!0){const{rawCommands:r,editor:i,state:l}=this,{view:o}=i,c={tr:n,editor:i,view:o,state:OF({state:l,transaction:n}),dispatch:s?()=>{}:void 0,chain:()=>this.createChain(n,s),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(r).map(([d,u])=>[d,(...h)=>u(...h)(c)]))}};return c}},DF={};_A(DF,{blur:()=>vhe,clearContent:()=>whe,clearNodes:()=>Nhe,command:()=>jhe,createParagraphNear:()=>She,cut:()=>_he,deleteCurrentNode:()=>Che,deleteNode:()=>Ahe,deleteRange:()=>khe,deleteSelection:()=>Ehe,enter:()=>The,exitCode:()=>Ihe,extendMarkRange:()=>Mhe,first:()=>Ohe,focus:()=>Lhe,forEach:()=>Bhe,insertContent:()=>Fhe,insertContentAt:()=>Uhe,joinBackward:()=>Whe,joinDown:()=>Hhe,joinForward:()=>qhe,joinItemBackward:()=>Ghe,joinItemForward:()=>Khe,joinTextblockBackward:()=>Yhe,joinTextblockForward:()=>Xhe,joinUp:()=>Vhe,keyboardShortcut:()=>Zhe,lift:()=>Jhe,liftEmptyBlock:()=>eme,liftListItem:()=>tme,newlineInCode:()=>nme,resetAttributes:()=>sme,scrollIntoView:()=>rme,selectAll:()=>ame,selectNodeBackward:()=>ime,selectNodeForward:()=>lme,selectParentNode:()=>ome,selectTextblockEnd:()=>cme,selectTextblockStart:()=>dme,setContent:()=>fme,setMark:()=>Sme,setMeta:()=>_me,setNode:()=>Cme,setNodeSelection:()=>Ame,setTextDirection:()=>kme,setTextSelection:()=>Eme,sinkListItem:()=>Tme,splitBlock:()=>Ime,splitListItem:()=>Pme,toggleList:()=>Mme,toggleMark:()=>Ome,toggleNode:()=>Dme,toggleWrap:()=>Rme,undoInputRule:()=>Lme,unsetAllMarks:()=>Bme,unsetMark:()=>Fme,unsetTextDirection:()=>$me,updateAttributes:()=>zme,wrapIn:()=>Ume,wrapInList:()=>Vme});var vhe=()=>({editor:t,view:n})=>(requestAnimationFrame(()=>{var s;t.isDestroyed||(n.dom.blur(),(s=window==null?void 0:window.getSelection())==null||s.removeAllRanges())}),!0),whe=(t=!0)=>({commands:n})=>n.setContent("",{emitUpdate:t}),Nhe=()=>({state:t,tr:n,dispatch:s})=>{const{selection:r}=n,{ranges:i}=r;return s&&i.forEach(({$from:l,$to:o})=>{t.doc.nodesBetween(l.pos,o.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:h}=n,m=u.resolve(h.map(d)),x=u.resolve(h.map(d+c.nodeSize)),b=m.blockRange(x);if(!b)return;const w=Pu(b);if(c.type.isTextblock){const{defaultType:j}=m.parent.contentMatchAt(m.index());n.setNodeMarkup(b.start,j)}(w||w===0)&&n.lift(b,w)})}),!0},jhe=t=>n=>t(n),She=()=>({state:t,dispatch:n})=>mA(t,n),_he=(t,n)=>({editor:s,tr:r})=>{const{state:i}=s,l=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(n);return r.insert(o,l.content),r.setSelection(new xt(r.doc.resolve(Math.max(o-1,0)))),!0},Che=()=>({tr:t,dispatch:n})=>{const{selection:s}=t,r=s.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let l=i.depth;l>0;l-=1)if(i.node(l).type===r.type){if(n){const c=i.before(l),d=i.after(l);t.delete(c,d).scrollIntoView()}return!0}return!1};function qr(t,n){if(typeof t=="string"){if(!n.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return n.nodes[t]}return t}var Ahe=t=>({tr:n,state:s,dispatch:r})=>{const i=qr(t,s.schema),l=n.selection.$anchor;for(let o=l.depth;o>0;o-=1)if(l.node(o).type===i){if(r){const d=l.before(o),u=l.after(o);n.delete(d,u).scrollIntoView()}return!0}return!1},khe=t=>({tr:n,dispatch:s})=>{const{from:r,to:i}=t;return s&&n.delete(r,i),!0},Ehe=()=>({state:t,dispatch:n})=>zb(t,n),The=()=>({commands:t})=>t.keyboardShortcut("Enter"),Ihe=()=>({state:t,dispatch:n})=>J9(t,n);function Phe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Q1(t,n,s={strict:!0}){const r=Object.keys(n);return r.length?r.every(i=>s.strict?n[i]===t[i]:Phe(n[i])?n[i].test(t[i]):n[i]===t[i]):!0}function RF(t,n,s={}){return t.find(r=>r.type===n&&Q1(Object.fromEntries(Object.keys(s).map(i=>[i,r.attrs[i]])),s))}function bP(t,n,s={}){return!!RF(t,n,s)}function CA(t,n,s){var r;if(!t||!n)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===n))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===n)||(s=s||((r=i.node.marks[0])==null?void 0:r.attrs),!RF([...i.node.marks],n,s)))return;let o=i.index,c=t.start()+i.offset,d=o+1,u=c+i.node.nodeSize;for(;o>0&&bP([...t.parent.child(o-1).marks],n,s);)o-=1,c-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&bP([...t.parent.child(d).marks],n,s);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function nd(t,n){if(typeof t=="string"){if(!n.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return n.marks[t]}return t}var Mhe=(t,n={})=>({tr:s,state:r,dispatch:i})=>{const l=nd(t,r.schema),{doc:o,selection:c}=s,{$from:d,from:u,to:h}=c;if(i){const m=CA(d,l,n);if(m&&m.from<=u&&m.to>=h){const x=xt.create(o,m.from,m.to);s.setSelection(x)}}return!0},Ohe=t=>n=>{const s=typeof t=="function"?t(n):t;for(let r=0;r<s.length;r+=1)if(s[r](n))return!0;return!1};function LF(t){return t instanceof xt}function Rd(t=0,n=0,s=0){return Math.min(Math.max(t,n),s)}function Dhe(t,n=null){if(!n)return null;const s=At.atStart(t),r=At.atEnd(t);if(n==="start"||n===!0)return s;if(n==="end")return r;const i=s.from,l=r.to;return n==="all"?xt.create(t,Rd(0,i,l),Rd(t.content.size,i,l)):xt.create(t,Rd(n,i,l),Rd(n,i,l))}function Rhe(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function AA(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Lhe=(t=null,n={})=>({editor:s,view:r,tr:i,dispatch:l})=>{n={scrollIntoView:!0,...n};const o=()=>{(AA()||Rhe())&&r.dom.focus(),requestAnimationFrame(()=>{s.isDestroyed||(r.focus(),n!=null&&n.scrollIntoView&&s.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(l&&t===null&&!LF(s.state.selection))return o(),!0;const c=Dhe(i.doc,t)||s.state.selection,d=s.state.selection.eq(c);return l&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Bhe=(t,n)=>s=>t.every((r,i)=>n(r,{...s,index:i})),Fhe=(t,n)=>({tr:s,commands:r})=>r.insertContentAt({from:s.selection.from,to:s.selection.to},t,n),BF=t=>{const n=t.childNodes;for(let s=n.length-1;s>=0;s-=1){const r=n[s];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&BF(r)}return t};function D0(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const n=`<body>${t}</body>`,s=new window.DOMParser().parseFromString(n,"text/html").body;return BF(s)}function zp(t,n,s){if(t instanceof Tc||t instanceof Oe)return t;s={slice:!0,parseOptions:{},...s};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Oe.fromArray(t.map(c=>n.nodeFromJSON(c)));const o=n.nodeFromJSON(t);return s.errorOnInvalidContent&&o.check(),o}catch(l){if(s.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:l});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",l),zp("",n,s)}if(i){if(s.errorOnInvalidContent){let o=!1,c="";const d=new _9({topNode:n.spec.topNode,marks:n.spec.marks,nodes:n.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(s.slice?Ml.fromSchema(d).parseSlice(D0(t),s.parseOptions):Ml.fromSchema(d).parse(D0(t),s.parseOptions),s.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const l=Ml.fromSchema(n);return s.slice?l.parseSlice(D0(t),s.parseOptions).content:l.parse(D0(t),s.parseOptions)}return zp("",n,s)}function $he(t,n,s){const r=t.steps.length-1;if(r<n)return;const i=t.steps[r];if(!(i instanceof Ws||i instanceof Qs))return;const l=t.mapping.maps[r];let o=0;l.forEach((c,d,u,h)=>{o===0&&(o=h)}),t.setSelection(At.near(t.doc.resolve(o),s))}var zhe=t=>!("type"in t),Uhe=(t,n,s)=>({tr:r,dispatch:i,editor:l})=>{var o;if(i){s={parseOptions:l.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...s};let c;const d=S=>{l.emit("contentError",{editor:l,error:S,disableCollaboration:()=>{"collaboration"in l.storage&&typeof l.storage.collaboration=="object"&&l.storage.collaboration&&(l.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...s.parseOptions};if(!s.errorOnInvalidContent&&!l.options.enableContentCheck&&l.options.emitContentError)try{zp(n,l.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(S){d(S)}try{c=zp(n,l.schema,{parseOptions:u,errorOnInvalidContent:(o=s.errorOnInvalidContent)!=null?o:l.options.enableContentCheck})}catch(S){return d(S),!1}let{from:h,to:m}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,b=!0;if((zhe(c)?c:[c]).forEach(S=>{S.check(),x=x?S.isText&&S.marks.length===0:!1,b=b?S.isBlock:!1}),h===m&&b){const{parent:S}=r.doc.resolve(h);S.isTextblock&&!S.type.spec.code&&!S.childCount&&(h-=1,m+=1)}let j;if(x){if(Array.isArray(n))j=n.map(S=>S.text||"").join("");else if(n instanceof Oe){let S="";n.forEach(C=>{C.text&&(S+=C.text)}),j=S}else typeof n=="object"&&n&&n.text?j=n.text:j=n;r.insertText(j,h,m)}else{j=c;const S=r.doc.resolve(h),C=S.node(),A=S.parentOffset===0,k=C.isText||C.isTextblock,T=C.content.size>0;A&&k&&T&&(h=Math.max(0,h-1)),r.replaceWith(h,m,j)}s.updateSelection&&$he(r,r.steps.length-1,-1),s.applyInputRules&&r.setMeta("applyInputRules",{from:h,text:j}),s.applyPasteRules&&r.setMeta("applyPasteRules",{from:h,text:j})}return!0},Vhe=()=>({state:t,dispatch:n})=>X9(t,n),Hhe=()=>({state:t,dispatch:n})=>Q9(t,n),Whe=()=>({state:t,dispatch:n})=>iA(t,n),qhe=()=>({state:t,dispatch:n})=>cA(t,n),Ghe=()=>({state:t,dispatch:n,tr:s})=>{try{const r=Eh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(s.join(r,2),n&&n(s),!0)}catch{return!1}},Khe=()=>({state:t,dispatch:n,tr:s})=>{try{const r=Eh(t.doc,t.selection.$from.pos,1);return r==null?!1:(s.join(r,2),n&&n(s),!0)}catch{return!1}},Yhe=()=>({state:t,dispatch:n})=>q9(t,n),Xhe=()=>({state:t,dispatch:n})=>G9(t,n);function FF(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Qhe(t){const n=t.split(/-(?!$)/);let s=n[n.length-1];s==="Space"&&(s=" ");let r,i,l,o;for(let c=0;c<n.length-1;c+=1){const d=n[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))AA()||FF()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(s=`Alt-${s}`),i&&(s=`Ctrl-${s}`),o&&(s=`Meta-${s}`),l&&(s=`Shift-${s}`),s}var Zhe=t=>({editor:n,view:s,tr:r,dispatch:i})=>{const l=Qhe(t).split(/-(?!$)/),o=l.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:l.includes("Alt"),ctrlKey:l.includes("Ctrl"),metaKey:l.includes("Meta"),shiftKey:l.includes("Shift"),bubbles:!0,cancelable:!0}),d=n.captureTransaction(()=>{s.someProp("handleKeyDown",u=>u(s,c))});return d==null||d.steps.forEach(u=>{const h=u.map(r.mapping);h&&i&&r.maybeStep(h)}),!0};function kA(t,n,s={}){const{from:r,to:i,empty:l}=t.selection,o=n?qr(n,t.schema):null,c=[];t.doc.nodesBetween(r,i,(m,x)=>{if(m.isText)return;const b=Math.max(r,x),w=Math.min(i,x+m.nodeSize);c.push({node:m,from:b,to:w})});const d=i-r,u=c.filter(m=>o?o.name===m.node.type.name:!0).filter(m=>Q1(m.node.attrs,s,{strict:!1}));return l?!!u.length:u.reduce((m,x)=>m+x.to-x.from,0)>=d}var Jhe=(t,n={})=>({state:s,dispatch:r})=>{const i=qr(t,s.schema);return kA(s,i,n)?Z9(s,r):!1},eme=()=>({state:t,dispatch:n})=>pA(t,n),tme=t=>({state:n,dispatch:s})=>{const r=qr(t,n.schema);return lF(r)(n,s)},nme=()=>({state:t,dispatch:n})=>fA(t,n);function $F(t,n){return n.nodes[t]?"node":n.marks[t]?"mark":null}function vP(t,n){const s=typeof n=="string"?[n]:n;return Object.keys(t).reduce((r,i)=>(s.includes(i)||(r[i]=t[i]),r),{})}var sme=(t,n)=>({tr:s,state:r,dispatch:i})=>{let l=null,o=null;const c=$F(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(l=qr(t,r.schema)),c==="mark"&&(o=nd(t,r.schema));let d=!1;return s.selection.ranges.forEach(u=>{r.doc.nodesBetween(u.$from.pos,u.$to.pos,(h,m)=>{l&&l===h.type&&(d=!0,i&&s.setNodeMarkup(m,void 0,vP(h.attrs,n))),o&&h.marks.length&&h.marks.forEach(x=>{o===x.type&&(d=!0,i&&s.addMark(m,m+h.nodeSize,o.create(vP(x.attrs,n))))})})}),d},rme=()=>({tr:t,dispatch:n})=>(n&&t.scrollIntoView(),!0),ame=()=>({tr:t,dispatch:n})=>{if(n){const s=new _a(t.doc);t.setSelection(s)}return!0},ime=()=>({state:t,dispatch:n})=>lA(t,n),lme=()=>({state:t,dispatch:n})=>dA(t,n),ome=()=>({state:t,dispatch:n})=>eF(t,n),cme=()=>({state:t,dispatch:n})=>rF(t,n),dme=()=>({state:t,dispatch:n})=>sF(t,n);function ume(t,n,s={},r={}){return zp(t,n,{slice:!1,parseOptions:s,errorOnInvalidContent:r.errorOnInvalidContent})}var fme=(t,{errorOnInvalidContent:n,emitUpdate:s=!0,parseOptions:r={}}={})=>({editor:i,tr:l,dispatch:o,commands:c})=>{const{doc:d}=l;if(r.preserveWhitespace!=="full"){const u=ume(t,i.schema,r,{errorOnInvalidContent:n??i.options.enableContentCheck});return o&&l.replaceWith(0,d.content.size,u).setMeta("preventUpdate",!s),!0}return o&&l.setMeta("preventUpdate",!s),c.insertContentAt({from:0,to:d.content.size},t,{parseOptions:r,errorOnInvalidContent:n??i.options.enableContentCheck})};function hme(t,n){const s=nd(n,t.schema),{from:r,to:i,empty:l}=t.selection,o=[];l?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,d=>{o.push(...d.marks)});const c=o.find(d=>d.type.name===s.name);return c?{...c.attrs}:{}}function mme(t,n){const s=new z9(t);return n.forEach(r=>{r.steps.forEach(i=>{s.step(i)})}),s}function pme(t){for(let n=0;n<t.edgeCount;n+=1){const{type:s}=t.edge(n);if(s.isTextblock&&!s.hasRequiredAttrs())return s}return null}function zF(t,n){for(let s=t.depth;s>0;s-=1){const r=t.node(s);if(n(r))return{pos:s>0?t.before(s):0,start:t.start(s),depth:s,node:r}}}function EA(t){return n=>zF(n.$from,t)}function nh(t,n,s){return t.config[n]===void 0&&t.parent?nh(t.parent,n,s):typeof t.config[n]=="function"?t.config[n].bind({...s,parent:t.parent?nh(t.parent,n,s):null}):t.config[n]}function xme(t){return typeof t=="function"}function hu(t,n=void 0,...s){return xme(t)?n?t.bind(n)(...s):t(...s):t}function UF(t){const n=t.filter(i=>i.type==="extension"),s=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:n,nodeExtensions:s,markExtensions:r}}function sd(...t){return t.filter(n=>!!n).reduce((n,s)=>{const r={...n};return Object.entries(s).forEach(([i,l])=>{if(!r[i]){r[i]=l;return}if(i==="class"){const c=l?String(l).split(" "):[],d=r[i]?r[i].split(" "):[],u=c.filter(h=>!d.includes(h));r[i]=[...d,...u].join(" ")}else if(i==="style"){const c=l?l.split(";").map(h=>h.trim()).filter(Boolean):[],d=r[i]?r[i].split(";").map(h=>h.trim()).filter(Boolean):[],u=new Map;d.forEach(h=>{const[m,x]=h.split(":").map(b=>b.trim());u.set(m,x)}),c.forEach(h=>{const[m,x]=h.split(":").map(b=>b.trim());u.set(m,x)}),r[i]=Array.from(u.entries()).map(([h,m])=>`${h}: ${m}`).join("; ")}else r[i]=l}),r},{})}function gme(t,n,s){const{from:r,to:i}=n,{blockSeparator:l=`

`,textSerializers:o={}}=s||{};let c="";return t.nodesBetween(r,i,(d,u,h,m)=>{var x;d.isBlock&&u>r&&(c+=l);const b=o==null?void 0:o[d.type.name];if(b)return h&&(c+=b({node:d,pos:u,parent:h,index:m,range:n})),!1;d.isText&&(c+=(x=d==null?void 0:d.text)==null?void 0:x.slice(Math.max(r,u)-u,i-u))}),c}function yme(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,n])=>n.spec.toText).map(([n,s])=>[n,s.spec.toText]))}function bme(t,n=JSON.stringify){const s={};return t.filter(r=>{const i=n(r);return Object.prototype.hasOwnProperty.call(s,i)?!1:s[i]=!0})}function vme(t){const n=bme(t);return n.length===1?n:n.filter((s,r)=>!n.filter((l,o)=>o!==r).some(l=>s.oldRange.from>=l.oldRange.from&&s.oldRange.to<=l.oldRange.to&&s.newRange.from>=l.newRange.from&&s.newRange.to<=l.newRange.to))}function wme(t){const{mapping:n,steps:s}=t,r=[];return n.maps.forEach((i,l)=>{const o=[];if(i.ranges.length)i.forEach((c,d)=>{o.push({from:c,to:d})});else{const{from:c,to:d}=s[l];if(c===void 0||d===void 0)return;o.push({from:c,to:d})}o.forEach(({from:c,to:d})=>{const u=n.slice(l).map(c,-1),h=n.slice(l).map(d),m=n.invert().map(u,-1),x=n.invert().map(h);r.push({oldRange:{from:m,to:x},newRange:{from:u,to:h}})})}),vme(r)}function VF(t,n,s){const r=[];return t===n?s.resolve(t).marks().forEach(i=>{const l=s.resolve(t),o=CA(l,i.type);o&&r.push({mark:i,...o})}):s.nodesBetween(t,n,(i,l)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:l,to:l+i.nodeSize,mark:o})))}),r}function Fg(t,n,s){return Object.fromEntries(Object.entries(s).filter(([r])=>{const i=t.find(l=>l.type===n&&l.name===r);return i?i.attribute.keepOnSplit:!1}))}function Nme(t,n,s={}){const{empty:r,ranges:i}=t.selection,l=n?nd(n,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(m=>l?l.name===m.type.name:!0).find(m=>Q1(m.attrs,s,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:m,$to:x})=>{const b=m.pos,w=x.pos;t.doc.nodesBetween(b,w,(j,S)=>{if(!j.isText&&!j.marks.length)return;const C=Math.max(b,S),A=Math.min(w,S+j.nodeSize),k=A-C;o+=k,c.push(...j.marks.map(T=>({mark:T,from:C,to:A})))})}),o===0)return!1;const d=c.filter(m=>l?l.name===m.mark.type.name:!0).filter(m=>Q1(m.mark.attrs,s,{strict:!1})).reduce((m,x)=>m+x.to-x.from,0),u=c.filter(m=>l?m.mark.type!==l&&m.mark.type.excludes(l):!0).reduce((m,x)=>m+x.to-x.from,0);return(d>0?d+u:d)>=o}function wP(t,n){const{nodeExtensions:s}=UF(n),r=s.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},l=hu(nh(r,"group",i));return typeof l!="string"?!1:l.split(" ").includes("list")}function HF(t,{checkChildren:n=!0,ignoreWhitespace:s=!1}={}){var r;if(s){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(n){let i=!0;return t.content.forEach(l=>{i!==!1&&(HF(l,{ignoreWhitespace:s,checkChildren:n})||(i=!1))}),i}return!1}function jme(t,n,s){var r;const{selection:i}=n;let l=null;if(LF(i)&&(l=i.$cursor),l){const c=(r=t.storedMarks)!=null?r:l.marks();return l.parent.type.allowsMarkType(s)&&(!!s.isInSet(c)||!c.some(u=>u.type.excludes(s)))}const{ranges:o}=i;return o.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(s):!1;return t.doc.nodesBetween(c.pos,d.pos,(h,m,x)=>{if(u)return!1;if(h.isInline){const b=!x||x.type.allowsMarkType(s),w=!!s.isInSet(h.marks)||!h.marks.some(j=>j.type.excludes(s));u=b&&w}return!u}),u})}var Sme=(t,n={})=>({tr:s,state:r,dispatch:i})=>{const{selection:l}=s,{empty:o,ranges:c}=l,d=nd(t,r.schema);if(i)if(o){const u=hme(r,d);s.addStoredMark(d.create({...u,...n}))}else c.forEach(u=>{const h=u.$from.pos,m=u.$to.pos;r.doc.nodesBetween(h,m,(x,b)=>{const w=Math.max(b,h),j=Math.min(b+x.nodeSize,m);x.marks.find(C=>C.type===d)?x.marks.forEach(C=>{d===C.type&&s.addMark(w,j,d.create({...C.attrs,...n}))}):s.addMark(w,j,d.create(n))})});return jme(r,s,d)},_me=(t,n)=>({tr:s})=>(s.setMeta(t,n),!0),Cme=(t,n={})=>({state:s,dispatch:r,chain:i})=>{const l=qr(t,s.schema);let o;return s.selection.$anchor.sameParent(s.selection.$head)&&(o=s.selection.$anchor.parent.attrs),l.isTextblock?i().command(({commands:c})=>H1(l,{...o,...n})(s)?!0:c.clearNodes()).command(({state:c})=>H1(l,{...o,...n})(c,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Ame=t=>({tr:n,dispatch:s})=>{if(s){const{doc:r}=n,i=Rd(t,0,r.content.size),l=vt.create(r,i);n.setSelection(l)}return!0},kme=(t,n)=>({tr:s,state:r,dispatch:i})=>{const{selection:l}=r;let o,c;return typeof n=="number"?(o=n,c=n):n&&"from"in n&&"to"in n?(o=n.from,c=n.to):(o=l.from,c=l.to),i&&s.doc.nodesBetween(o,c,(d,u)=>{d.isText||s.setNodeMarkup(u,void 0,{...d.attrs,dir:t})}),!0},Eme=t=>({tr:n,dispatch:s})=>{if(s){const{doc:r}=n,{from:i,to:l}=typeof t=="number"?{from:t,to:t}:t,o=xt.atStart(r).from,c=xt.atEnd(r).to,d=Rd(i,o,c),u=Rd(l,o,c),h=xt.create(r,d,u);n.setSelection(h)}return!0},Tme=t=>({state:n,dispatch:s})=>{const r=qr(t,n.schema);return oF(r)(n,s)};function NP(t,n){const s=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(s){const r=s.filter(i=>n==null?void 0:n.includes(i.type.name));t.tr.ensureMarks(r)}}var Ime=({keepMarks:t=!0}={})=>({tr:n,state:s,dispatch:r,editor:i})=>{const{selection:l,doc:o}=n,{$from:c,$to:d}=l,u=i.extensionManager.attributes,h=Fg(u,c.node().type.name,c.node().attrs);if(l instanceof vt&&l.node.isBlock)return!c.parentOffset||!Wa(o,c.pos)?!1:(r&&(t&&NP(s,i.extensionManager.splittableMarks),n.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const m=d.parentOffset===d.parent.content.size,x=c.depth===0?void 0:pme(c.node(-1).contentMatchAt(c.indexAfter(-1)));let b=m&&x?[{type:x,attrs:h}]:void 0,w=Wa(n.doc,n.mapping.map(c.pos),1,b);if(!b&&!w&&Wa(n.doc,n.mapping.map(c.pos),1,x?[{type:x}]:void 0)&&(w=!0,b=x?[{type:x,attrs:h}]:void 0),r){if(w&&(l instanceof xt&&n.deleteSelection(),n.split(n.mapping.map(c.pos),1,b),x&&!m&&!c.parentOffset&&c.parent.type!==x)){const j=n.mapping.map(c.before()),S=n.doc.resolve(j);c.node(-1).canReplaceWith(S.index(),S.index()+1,x)&&n.setNodeMarkup(n.mapping.map(c.before()),x)}t&&NP(s,i.extensionManager.splittableMarks),n.scrollIntoView()}return w},Pme=(t,n={})=>({tr:s,state:r,dispatch:i,editor:l})=>{var o;const c=qr(t,r.schema),{$from:d,$to:u}=r.selection,h=r.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;const m=d.node(-1);if(m.type!==c)return!1;const x=l.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let C=Oe.empty;const A=d.index(-1)?1:d.index(-2)?2:3;for(let R=d.depth-A;R>=d.depth-3;R-=1)C=Oe.from(d.node(R).copy(C));const k=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...Fg(x,d.node().type.name,d.node().attrs),...n},I=((o=c.contentMatch.defaultType)==null?void 0:o.createAndFill(T))||void 0;C=C.append(Oe.from(c.createAndFill(null,I)||void 0));const D=d.before(d.depth-(A-1));s.replace(D,d.after(-k),new tt(C,4-A,0));let O=-1;s.doc.nodesBetween(D,s.doc.content.size,(R,P)=>{if(O>-1)return!1;R.isTextblock&&R.content.size===0&&(O=P+1)}),O>-1&&s.setSelection(xt.near(s.doc.resolve(O))),s.scrollIntoView()}return!0}const b=u.pos===d.end()?m.contentMatchAt(0).defaultType:null,w={...Fg(x,m.type.name,m.attrs),...n},j={...Fg(x,d.node().type.name,d.node().attrs),...n};s.delete(d.pos,u.pos);const S=b?[{type:c,attrs:w},{type:b,attrs:j}]:[{type:c,attrs:w}];if(!Wa(s.doc,d.pos,2))return!1;if(i){const{selection:C,storedMarks:A}=r,{splittableMarks:k}=l.extensionManager,T=A||C.$to.parentOffset&&C.$from.marks();if(s.split(d.pos,2,S).scrollIntoView(),!T||!i)return!0;const I=T.filter(D=>k.includes(D.type.name));s.ensureMarks(I)}return!0},qN=(t,n)=>{const s=EA(o=>o.type===n)(t.selection);if(!s)return!0;const r=t.doc.resolve(Math.max(0,s.pos-1)).before(s.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return s.node.type===(i==null?void 0:i.type)&&Wl(t.doc,s.pos)&&t.join(s.pos),!0},GN=(t,n)=>{const s=EA(o=>o.type===n)(t.selection);if(!s)return!0;const r=t.doc.resolve(s.start).after(s.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return s.node.type===(i==null?void 0:i.type)&&Wl(t.doc,r)&&t.join(r),!0},Mme=(t,n,s,r={})=>({editor:i,tr:l,state:o,dispatch:c,chain:d,commands:u,can:h})=>{const{extensions:m,splittableMarks:x}=i.extensionManager,b=qr(t,o.schema),w=qr(n,o.schema),{selection:j,storedMarks:S}=o,{$from:C,$to:A}=j,k=C.blockRange(A),T=S||j.$to.parentOffset&&j.$from.marks();if(!k)return!1;const I=EA(D=>wP(D.type.name,m))(j);if(k.depth>=1&&I&&k.depth-I.depth<=1){if(I.node.type===b)return u.liftListItem(w);if(wP(I.node.type.name,m)&&b.validContent(I.node.content)&&c)return d().command(()=>(l.setNodeMarkup(I.pos,b),!0)).command(()=>qN(l,b)).command(()=>GN(l,b)).run()}return!s||!T||!c?d().command(()=>h().wrapInList(b,r)?!0:u.clearNodes()).wrapInList(b,r).command(()=>qN(l,b)).command(()=>GN(l,b)).run():d().command(()=>{const D=h().wrapInList(b,r),O=T.filter(R=>x.includes(R.type.name));return l.ensureMarks(O),D?!0:u.clearNodes()}).wrapInList(b,r).command(()=>qN(l,b)).command(()=>GN(l,b)).run()},Ome=(t,n={},s={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:l=!1}=s,o=nd(t,r.schema);return Nme(r,o,n)?i.unsetMark(o,{extendEmptyMarkRange:l}):i.setMark(o,n)},Dme=(t,n,s={})=>({state:r,commands:i})=>{const l=qr(t,r.schema),o=qr(n,r.schema),c=kA(r,l,s);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),c?i.setNode(o,d):i.setNode(l,{...d,...s})},Rme=(t,n={})=>({state:s,commands:r})=>{const i=qr(t,s.schema);return kA(s,i,n)?r.lift(i):r.wrapIn(i,n)},Lme=()=>({state:t,dispatch:n})=>{const s=t.plugins;for(let r=0;r<s.length;r+=1){const i=s[r];let l;if(i.spec.isInputRules&&(l=i.getState(t))){if(n){const o=t.tr,c=l.transform;for(let d=c.steps.length-1;d>=0;d-=1)o.step(c.steps[d].invert(c.docs[d]));if(l.text){const d=o.doc.resolve(l.from).marks();o.replaceWith(l.from,l.to,t.schema.text(l.text,d))}else o.delete(l.from,l.to)}return!0}}return!1},Bme=()=>({tr:t,dispatch:n})=>{const{selection:s}=t,{empty:r,ranges:i}=s;return r||n&&i.forEach(l=>{t.removeMark(l.$from.pos,l.$to.pos)}),!0},Fme=(t,n={})=>({tr:s,state:r,dispatch:i})=>{var l;const{extendEmptyMarkRange:o=!1}=n,{selection:c}=s,d=nd(t,r.schema),{$from:u,empty:h,ranges:m}=c;if(!i)return!0;if(h&&o){let{from:x,to:b}=c;const w=(l=u.marks().find(S=>S.type===d))==null?void 0:l.attrs,j=CA(u,d,w);j&&(x=j.from,b=j.to),s.removeMark(x,b,d)}else m.forEach(x=>{s.removeMark(x.$from.pos,x.$to.pos,d)});return s.removeStoredMark(d),!0},$me=t=>({tr:n,state:s,dispatch:r})=>{const{selection:i}=s;let l,o;return typeof t=="number"?(l=t,o=t):t&&"from"in t&&"to"in t?(l=t.from,o=t.to):(l=i.from,o=i.to),r&&n.doc.nodesBetween(l,o,(c,d)=>{if(c.isText)return;const u={...c.attrs};delete u.dir,n.setNodeMarkup(d,void 0,u)}),!0},zme=(t,n={})=>({tr:s,state:r,dispatch:i})=>{let l=null,o=null;const c=$F(typeof t=="string"?t:t.name,r.schema);if(!c)return!1;c==="node"&&(l=qr(t,r.schema)),c==="mark"&&(o=nd(t,r.schema));let d=!1;return s.selection.ranges.forEach(u=>{const h=u.$from.pos,m=u.$to.pos;let x,b,w,j;s.selection.empty?r.doc.nodesBetween(h,m,(S,C)=>{l&&l===S.type&&(d=!0,w=Math.max(C,h),j=Math.min(C+S.nodeSize,m),x=C,b=S)}):r.doc.nodesBetween(h,m,(S,C)=>{C<h&&l&&l===S.type&&(d=!0,w=Math.max(C,h),j=Math.min(C+S.nodeSize,m),x=C,b=S),C>=h&&C<=m&&(l&&l===S.type&&(d=!0,i&&s.setNodeMarkup(C,void 0,{...S.attrs,...n})),o&&S.marks.length&&S.marks.forEach(A=>{if(o===A.type&&(d=!0,i)){const k=Math.max(C,h),T=Math.min(C+S.nodeSize,m);s.addMark(k,T,o.create({...A.attrs,...n}))}}))}),b&&(x!==void 0&&i&&s.setNodeMarkup(x,void 0,{...b.attrs,...n}),o&&b.marks.length&&b.marks.forEach(S=>{o===S.type&&i&&s.addMark(w,j,o.create({...S.attrs,...n}))}))}),d},Ume=(t,n={})=>({state:s,dispatch:r})=>{const i=qr(t,s.schema);return aF(i,n)(s,r)},Vme=(t,n={})=>({state:s,dispatch:r})=>{const i=qr(t,s.schema);return iF(i,n)(s,r)},WF=class{constructor(n){var s;this.find=n.find,this.handler=n.handler,this.undoable=(s=n.undoable)!=null?s:!0}};function Hme(t){return Object.prototype.toString.call(t).slice(8,-1)}function R0(t){return Hme(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function qF(t,n){const s={...t};return R0(t)&&R0(n)&&Object.keys(n).forEach(r=>{R0(n[r])&&R0(t[r])?s[r]=qF(t[r],n[r]):s[r]=n[r]}),s}var TA=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...hu(nh(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...hu(nh(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const n=this.extend({...this.config,addOptions:()=>qF(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new this.constructor({...this.config,...t});return n.parent=this,this.child=n,n.name="name"in t?t.name:n.parent.name,n}},IA=class GF extends TA{constructor(){super(...arguments),this.type="mark"}static create(n={}){const s=typeof n=="function"?n():n;return new GF(s)}static handleExit({editor:n,mark:s}){const{tr:r}=n.state,i=n.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===s.name))return!1;const d=o.find(u=>(u==null?void 0:u.type.name)===s.name);return d&&r.removeStoredMark(d),r.insertText(" ",i.pos),n.view.dispatch(r),!0}return!1}configure(n){return super.configure(n)}extend(n){const s=typeof n=="function"?n():n;return super.extend(s)}},Wme=class{constructor(n){this.find=n.find,this.handler=n.handler}},qme={};_A(qme,{ClipboardTextSerializer:()=>Gme,Commands:()=>Kme,Delete:()=>Yme,Drop:()=>Xme,Editable:()=>Qme,FocusEvents:()=>Zme,Keymap:()=>Jme,Paste:()=>epe,Tabindex:()=>tpe,TextDirection:()=>npe,focusEventsPluginKey:()=>YF});var ur=class KF extends TA{constructor(){super(...arguments),this.type="extension"}static create(n={}){const s=typeof n=="function"?n():n;return new KF(s)}configure(n){return super.configure(n)}extend(n){const s=typeof n=="function"?n():n;return super.extend(s)}},Gme=ur.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new js({key:new Ss("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:n,schema:s}=t,{doc:r,selection:i}=n,{ranges:l}=i,o=Math.min(...l.map(h=>h.$from.pos)),c=Math.max(...l.map(h=>h.$to.pos)),d=yme(s);return gme(r,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),Kme=ur.create({name:"commands",addCommands(){return{...DF}}}),Yme=ur.create({name:"delete",onUpdate({transaction:t,appendedTransactions:n}){var s,r,i;const l=()=>{var o,c,d,u;if((u=(d=(c=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:c.filterTransaction)==null?void 0:d.call(c,t))!=null?u:t.getMeta("y-sync$"))return;const h=mme(t.before,[t,...n]);wme(h).forEach(b=>{h.mapping.mapResult(b.oldRange.from).deletedAfter&&h.mapping.mapResult(b.oldRange.to).deletedBefore&&h.before.nodesBetween(b.oldRange.from,b.oldRange.to,(w,j)=>{const S=j+w.nodeSize-2,C=b.oldRange.from<=j&&S<=b.oldRange.to;this.editor.emit("delete",{type:"node",node:w,from:j,to:S,newFrom:h.mapping.map(j),newTo:h.mapping.map(S),deletedRange:b.oldRange,newRange:b.newRange,partial:!C,editor:this.editor,transaction:t,combinedTransform:h})})});const x=h.mapping;h.steps.forEach((b,w)=>{var j,S;if(b instanceof Ki){const C=x.slice(w).map(b.from,-1),A=x.slice(w).map(b.to),k=x.invert().map(C,-1),T=x.invert().map(A),I=(j=h.doc.nodeAt(C-1))==null?void 0:j.marks.some(O=>O.eq(b.mark)),D=(S=h.doc.nodeAt(A))==null?void 0:S.marks.some(O=>O.eq(b.mark));this.editor.emit("delete",{type:"mark",mark:b.mark,from:b.from,to:b.to,deletedRange:{from:k,to:T},newRange:{from:C,to:A},partial:!!(D||I),editor:this.editor,transaction:t,combinedTransform:h})}})};(i=(r=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:r.async)==null||i?setTimeout(l,0):l()}}),Xme=ur.create({name:"drop",addProseMirrorPlugins(){return[new js({key:new Ss("tiptapDrop"),props:{handleDrop:(t,n,s,r)=>{this.editor.emit("drop",{editor:this.editor,event:n,slice:s,moved:r})}}})]}}),Qme=ur.create({name:"editable",addProseMirrorPlugins(){return[new js({key:new Ss("editable"),props:{editable:()=>this.editor.options.editable}})]}}),YF=new Ss("focusEvents"),Zme=ur.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new js({key:YF,props:{handleDOMEvents:{focus:(n,s)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:s}).setMeta("addToHistory",!1);return n.dispatch(r),!1},blur:(n,s)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:s}).setMeta("addToHistory",!1);return n.dispatch(r),!1}}}})]}}),Jme=ur.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:h,$anchor:m}=d,{pos:x,parent:b}=m,w=m.parent.isTextblock&&x>0?c.doc.resolve(x-1):m,j=w.parent.type.spec.isolating,S=m.pos-m.parentOffset,C=j&&w.parent.childCount===1?S===m.pos:At.atStart(u).from===x;return!h||!b.type.isTextblock||b.textContent.length||!C||C&&m.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),n=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:n,"Mod-Delete":n,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},l={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":n,"Ctrl-Alt-Backspace":n,"Alt-Delete":n,"Alt-d":n,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return AA()||FF()?l:i},addProseMirrorPlugins(){return[new js({key:new Ss("clearDocument"),appendTransaction:(t,n,s)=>{if(t.some(j=>j.getMeta("composition")))return;const r=t.some(j=>j.docChanged)&&!n.doc.eq(s.doc),i=t.some(j=>j.getMeta("preventClearDocument"));if(!r||i)return;const{empty:l,from:o,to:c}=n.selection,d=At.atStart(n.doc).from,u=At.atEnd(n.doc).to;if(l||!(o===d&&c===u)||!HF(s.doc))return;const x=s.tr,b=OF({state:s,transaction:x}),{commands:w}=new bhe({editor:this.editor,state:b});if(w.clearNodes(),!!x.steps.length)return x}})]}}),epe=ur.create({name:"paste",addProseMirrorPlugins(){return[new js({key:new Ss("tiptapPaste"),props:{handlePaste:(t,n,s)=>{this.editor.emit("paste",{editor:this.editor,event:n,slice:s})}}})]}}),tpe=ur.create({name:"tabindex",addProseMirrorPlugins(){return[new js({key:new Ss("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),npe=ur.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=UF(this.extensions);return[{types:t.filter(n=>n.name!=="text").map(n=>n.name),attributes:{dir:{default:this.options.direction,parseHTML:n=>{const s=n.getAttribute("dir");return s&&(s==="ltr"||s==="rtl"||s==="auto")?s:this.options.direction},renderHTML:n=>n.dir?{dir:n.dir}:{}}}}]},addProseMirrorPlugins(){return[new js({key:new Ss("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}});function spe(t){return new WF({find:t.find,handler:({state:n,range:s,match:r})=>{const i=hu(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:l}=n,o=r[r.length-1],c=r[0];if(o){const d=c.search(/\S/),u=s.from+c.indexOf(o),h=u+o.length;if(VF(s.from,s.to,n.doc).filter(b=>b.mark.type.excluded.find(j=>j===t.type&&j!==b.mark.type)).filter(b=>b.to>u).length)return null;h<s.to&&l.delete(h,s.to),u>s.from&&l.delete(s.from+d,u);const x=s.from+d+o.length;l.addMark(s.from+d,x,t.type.create(i||{})),l.removeStoredMark(t.type)}},undoable:t.undoable})}function rpe(t){return new WF({find:t.find,handler:({state:n,range:s,match:r})=>{const i=hu(t.getAttributes,void 0,r)||{},{tr:l}=n,o=s.from;let c=s.to;const d=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let h=o+u;h>c?h=c:c=h+r[1].length;const m=r[0][r[0].length-1];l.insertText(m,o+r[0].length-1),l.replaceWith(h,c,d)}else if(r[0]){const u=t.type.isInline?o:o-1;l.insert(u,t.type.create(i)).delete(l.mapping.map(o),l.mapping.map(c))}l.scrollIntoView()},undoable:t.undoable})}var ape=t=>"touches"in t,ipe=class{constructor(t){this.directions=["bottom-left","bottom-right","top-left","top-right"],this.minSize={height:8,width:8},this.preserveAspectRatio=!1,this.classNames={container:"",wrapper:"",handle:"",resizing:""},this.initialWidth=0,this.initialHeight=0,this.aspectRatio=1,this.isResizing=!1,this.activeHandle=null,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.isShiftKeyPressed=!1,this.lastEditableState=void 0,this.handleMap=new Map,this.handleMouseMove=c=>{if(!this.isResizing||!this.activeHandle)return;const d=c.clientX-this.startX,u=c.clientY-this.startY;this.handleResize(d,u)},this.handleTouchMove=c=>{if(!this.isResizing||!this.activeHandle)return;const d=c.touches[0];if(!d)return;const u=d.clientX-this.startX,h=d.clientY-this.startY;this.handleResize(u,h)},this.handleMouseUp=()=>{if(!this.isResizing)return;const c=this.element.offsetWidth,d=this.element.offsetHeight;this.onCommit(c,d),this.isResizing=!1,this.activeHandle=null,this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},this.handleKeyDown=c=>{c.key==="Shift"&&(this.isShiftKeyPressed=!0)},this.handleKeyUp=c=>{c.key==="Shift"&&(this.isShiftKeyPressed=!1)};var n,s,r,i,l,o;this.node=t.node,this.editor=t.editor,this.element=t.element,this.contentElement=t.contentElement,this.getPos=t.getPos,this.onResize=t.onResize,this.onCommit=t.onCommit,this.onUpdate=t.onUpdate,(n=t.options)!=null&&n.min&&(this.minSize={...this.minSize,...t.options.min}),(s=t.options)!=null&&s.max&&(this.maxSize=t.options.max),(r=t==null?void 0:t.options)!=null&&r.directions&&(this.directions=t.options.directions),(i=t.options)!=null&&i.preserveAspectRatio&&(this.preserveAspectRatio=t.options.preserveAspectRatio),(l=t.options)!=null&&l.className&&(this.classNames={container:t.options.className.container||"",wrapper:t.options.className.wrapper||"",handle:t.options.className.handle||"",resizing:t.options.className.resizing||""}),(o=t.options)!=null&&o.createCustomHandle&&(this.createCustomHandle=t.options.createCustomHandle),this.wrapper=this.createWrapper(),this.container=this.createContainer(),this.applyInitialSize(),this.attachHandles(),this.editor.on("update",this.handleEditorUpdate.bind(this))}get dom(){return this.container}get contentDOM(){return this.contentElement}handleEditorUpdate(){const t=this.editor.isEditable;t!==this.lastEditableState&&(this.lastEditableState=t,t?t&&this.handleMap.size===0&&this.attachHandles():this.removeHandles())}update(t,n,s){return t.type!==this.node.type?!1:(this.node=t,this.onUpdate?this.onUpdate(t,n,s):!0)}destroy(){this.isResizing&&(this.container.dataset.resizeState="false",this.classNames.resizing&&this.container.classList.remove(this.classNames.resizing),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.isResizing=!1,this.activeHandle=null),this.editor.off("update",this.handleEditorUpdate.bind(this)),this.container.remove()}createContainer(){const t=document.createElement("div");return t.dataset.resizeContainer="",t.dataset.node=this.node.type.name,t.style.display="flex",this.classNames.container&&(t.className=this.classNames.container),t.appendChild(this.wrapper),t}createWrapper(){const t=document.createElement("div");return t.style.position="relative",t.style.display="block",t.dataset.resizeWrapper="",this.classNames.wrapper&&(t.className=this.classNames.wrapper),t.appendChild(this.element),t}createHandle(t){const n=document.createElement("div");return n.dataset.resizeHandle=t,n.style.position="absolute",this.classNames.handle&&(n.className=this.classNames.handle),n}positionHandle(t,n){const s=n.includes("top"),r=n.includes("bottom"),i=n.includes("left"),l=n.includes("right");s&&(t.style.top="0"),r&&(t.style.bottom="0"),i&&(t.style.left="0"),l&&(t.style.right="0"),(n==="top"||n==="bottom")&&(t.style.left="0",t.style.right="0"),(n==="left"||n==="right")&&(t.style.top="0",t.style.bottom="0")}attachHandles(){this.directions.forEach(t=>{let n;this.createCustomHandle?n=this.createCustomHandle(t):n=this.createHandle(t),n instanceof HTMLElement||(console.warn(`[ResizableNodeView] createCustomHandle("${t}") did not return an HTMLElement. Falling back to default handle.`),n=this.createHandle(t)),this.createCustomHandle||this.positionHandle(n,t),n.addEventListener("mousedown",s=>this.handleResizeStart(s,t)),n.addEventListener("touchstart",s=>this.handleResizeStart(s,t)),this.handleMap.set(t,n),this.wrapper.appendChild(n)})}removeHandles(){this.handleMap.forEach(t=>t.remove()),this.handleMap.clear()}applyInitialSize(){const t=this.node.attrs.width,n=this.node.attrs.height;t?(this.element.style.width=`${t}px`,this.initialWidth=t):this.initialWidth=this.element.offsetWidth,n?(this.element.style.height=`${n}px`,this.initialHeight=n):this.initialHeight=this.element.offsetHeight,this.initialWidth>0&&this.initialHeight>0&&(this.aspectRatio=this.initialWidth/this.initialHeight)}handleResizeStart(t,n){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.activeHandle=n,ape(t)?(this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY):(this.startX=t.clientX,this.startY=t.clientY),this.startWidth=this.element.offsetWidth,this.startHeight=this.element.offsetHeight,this.startWidth>0&&this.startHeight>0&&(this.aspectRatio=this.startWidth/this.startHeight),this.getPos(),this.container.dataset.resizeState="true",this.classNames.resizing&&this.container.classList.add(this.classNames.resizing),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}handleResize(t,n){if(!this.activeHandle)return;const s=this.preserveAspectRatio||this.isShiftKeyPressed,{width:r,height:i}=this.calculateNewDimensions(this.activeHandle,t,n),l=this.applyConstraints(r,i,s);this.element.style.width=`${l.width}px`,this.element.style.height=`${l.height}px`,this.onResize&&this.onResize(l.width,l.height)}calculateNewDimensions(t,n,s){let r=this.startWidth,i=this.startHeight;const l=t.includes("right"),o=t.includes("left"),c=t.includes("bottom"),d=t.includes("top");return l?r=this.startWidth+n:o&&(r=this.startWidth-n),c?i=this.startHeight+s:d&&(i=this.startHeight-s),(t==="right"||t==="left")&&(r=this.startWidth+(l?n:-n)),(t==="top"||t==="bottom")&&(i=this.startHeight+(c?s:-s)),this.preserveAspectRatio||this.isShiftKeyPressed?this.applyAspectRatio(r,i,t):{width:r,height:i}}applyConstraints(t,n,s){var r,i,l,o;if(!s){let u=Math.max(this.minSize.width,t),h=Math.max(this.minSize.height,n);return(r=this.maxSize)!=null&&r.width&&(u=Math.min(this.maxSize.width,u)),(i=this.maxSize)!=null&&i.height&&(h=Math.min(this.maxSize.height,h)),{width:u,height:h}}let c=t,d=n;return c<this.minSize.width&&(c=this.minSize.width,d=c/this.aspectRatio),d<this.minSize.height&&(d=this.minSize.height,c=d*this.aspectRatio),(l=this.maxSize)!=null&&l.width&&c>this.maxSize.width&&(c=this.maxSize.width,d=c/this.aspectRatio),(o=this.maxSize)!=null&&o.height&&d>this.maxSize.height&&(d=this.maxSize.height,c=d*this.aspectRatio),{width:c,height:d}}applyAspectRatio(t,n,s){const r=s==="left"||s==="right",i=s==="top"||s==="bottom";return r?{width:t,height:t/this.aspectRatio}:i?{width:n*this.aspectRatio,height:n}:{width:t,height:t/this.aspectRatio}}},lpe={};_A(lpe,{createAtomBlockMarkdownSpec:()=>ope,createBlockMarkdownSpec:()=>cpe,createInlineMarkdownSpec:()=>fpe,parseAttributes:()=>PA,parseIndentedBlocks:()=>hpe,renderNestedMarkdownContent:()=>mpe,serializeAttributes:()=>MA});function PA(t){if(!(t!=null&&t.trim()))return{};const n={},s=[],r=t.replace(/["']([^"']*)["']/g,u=>(s.push(u),`__QUOTED_${s.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(h=>h.trim().slice(1));n.class=u.join(" ")}const l=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);l&&(n.id=l[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,u,h])=>{var m;const x=parseInt(((m=h.match(/__QUOTED_(\d+)__/))==null?void 0:m[1])||"0",10),b=s[x];b&&(n[u]=b.slice(1,-1))});const d=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return d&&d.split(/\s+/).filter(Boolean).forEach(h=>{h.match(/^[a-zA-Z][\w-]*$/)&&(n[h]=!0)}),n}function MA(t){if(!t||Object.keys(t).length===0)return"";const n=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>n.push(`.${r}`)),t.id&&n.push(`#${t.id}`),Object.entries(t).forEach(([s,r])=>{s==="class"||s==="id"||(r===!0?n.push(s):r!==!1&&r!=null&&n.push(`${s}="${String(r)}"`))}),n.join(" ")}function ope(t){const{nodeName:n,name:s,parseAttributes:r=PA,serializeAttributes:i=MA,defaultAttributes:l={},requiredAttributes:o=[],allowedAttributes:c}=t,d=s||n,u=h=>{if(!c)return h;const m={};return c.forEach(x=>{x in h&&(m[x]=h[x])}),m};return{parseMarkdown:(h,m)=>{const x={...l,...h.attributes};return m.createNode(n,x,[])},markdownTokenizer:{name:n,level:"block",start(h){var m;const x=new RegExp(`^:::${d}(?:\\s|$)`,"m"),b=(m=h.match(x))==null?void 0:m.index;return b!==void 0?b:-1},tokenize(h,m,x){const b=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),w=h.match(b);if(!w)return;const j=w[1]||"",S=r(j);if(!o.find(A=>!(A in S)))return{type:n,raw:w[0],attributes:S}}},renderMarkdown:h=>{const m=u(h.attrs||{}),x=i(m),b=x?` {${x}}`:"";return`:::${d}${b} :::`}}}function cpe(t){const{nodeName:n,name:s,getContent:r,parseAttributes:i=PA,serializeAttributes:l=MA,defaultAttributes:o={},content:c="block",allowedAttributes:d}=t,u=s||n,h=m=>{if(!d)return m;const x={};return d.forEach(b=>{b in m&&(x[b]=m[b])}),x};return{parseMarkdown:(m,x)=>{let b;if(r){const j=r(m);b=typeof j=="string"?[{type:"text",text:j}]:j}else c==="block"?b=x.parseChildren(m.tokens||[]):b=x.parseInline(m.tokens||[]);const w={...o,...m.attributes};return x.createNode(n,w,b)},markdownTokenizer:{name:n,level:"block",start(m){var x;const b=new RegExp(`^:::${u}`,"m"),w=(x=m.match(b))==null?void 0:x.index;return w!==void 0?w:-1},tokenize(m,x,b){var w;const j=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),S=m.match(j);if(!S)return;const[C,A=""]=S,k=i(A);let T=1;const I=C.length;let D="";const O=/^:::([\w-]*)(\s.*)?/gm,R=m.slice(I);for(O.lastIndex=0;;){const P=O.exec(R);if(P===null)break;const L=P.index,$=P[1];if(!((w=P[2])!=null&&w.endsWith(":::"))){if($)T+=1;else if(T-=1,T===0){const B=R.slice(0,L);D=B.trim();const V=m.slice(0,I+L+P[0].length);let K=[];if(D)if(c==="block")for(K=b.blockTokens(B),K.forEach(z=>{z.text&&(!z.tokens||z.tokens.length===0)&&(z.tokens=b.inlineTokens(z.text))});K.length>0;){const z=K[K.length-1];if(z.type==="paragraph"&&(!z.text||z.text.trim()===""))K.pop();else break}else K=b.inlineTokens(D);return{type:n,raw:V,attributes:k,content:D,tokens:K}}}}}},renderMarkdown:(m,x)=>{const b=h(m.attrs||{}),w=l(b),j=w?` {${w}}`:"",S=x.renderChildren(m.content||[],`

`);return`:::${u}${j}

${S}

:::`}}}function dpe(t){if(!t.trim())return{};const n={},s=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=s.exec(t);for(;r!==null;){const[,i,l,o]=r;n[i]=l||o,r=s.exec(t)}return n}function upe(t){return Object.entries(t).filter(([,n])=>n!=null).map(([n,s])=>`${n}="${s}"`).join(" ")}function fpe(t){const{nodeName:n,name:s,getContent:r,parseAttributes:i=dpe,serializeAttributes:l=upe,defaultAttributes:o={},selfClosing:c=!1,allowedAttributes:d}=t,u=s||n,h=x=>{if(!d)return x;const b={};return d.forEach(w=>{const j=typeof w=="string"?w:w.name,S=typeof w=="string"?void 0:w.skipIfDefault;if(j in x){const C=x[j];if(S!==void 0&&C===S)return;b[j]=C}}),b},m=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(x,b)=>{const w={...o,...x.attributes};if(c)return b.createNode(n,w);const j=r?r(x):x.content||"";return j?b.createNode(n,w,[b.createTextNode(j)]):b.createNode(n,w,[])},markdownTokenizer:{name:n,level:"inline",start(x){const b=c?new RegExp(`\\[${m}\\s*[^\\]]*\\]`):new RegExp(`\\[${m}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${m}\\]`),w=x.match(b),j=w==null?void 0:w.index;return j!==void 0?j:-1},tokenize(x,b,w){const j=c?new RegExp(`^\\[${m}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${m}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${m}\\]`),S=x.match(j);if(!S)return;let C="",A="";if(c){const[,T]=S;A=T}else{const[,T,I]=S;A=T,C=I||""}const k=i(A.trim());return{type:n,raw:S[0],content:C.trim(),attributes:k}}},renderMarkdown:x=>{let b="";r?b=r(x):x.content&&x.content.length>0&&(b=x.content.filter(C=>C.type==="text").map(C=>C.text).join(""));const w=h(x.attrs||{}),j=l(w),S=j?` ${j}`:"";return c?`[${u}${S}]`:`[${u}${S}]${b}[/${u}]`}}}function hpe(t,n,s){var r,i,l,o;const c=t.split(`
`),d=[];let u="",h=0;const m=n.baseIndentSize||2;for(;h<c.length;){const x=c[h],b=x.match(n.itemPattern);if(!b){if(d.length>0)break;if(x.trim()===""){h+=1,u=`${u}${x}
`;continue}else return}const w=n.extractItemData(b),{indentLevel:j,mainContent:S}=w;u=`${u}${x}
`;const C=[S];for(h+=1;h<c.length;){const I=c[h];if(I.trim()===""){const O=c.slice(h+1).findIndex(L=>L.trim()!=="");if(O===-1)break;if((((i=(r=c[h+1+O].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>j){C.push(I),u=`${u}${I}
`,h+=1;continue}else break}if((((o=(l=I.match(/^(\s*)/))==null?void 0:l[1])==null?void 0:o.length)||0)>j)C.push(I),u=`${u}${I}
`,h+=1;else break}let A;const k=C.slice(1);if(k.length>0){const I=k.map(D=>D.slice(j+m)).join(`
`);I.trim()&&(n.customNestedParser?A=n.customNestedParser(I):A=s.blockTokens(I))}const T=n.createToken(w,A);d.push(T)}if(d.length!==0)return{items:d,raw:u}}function mpe(t,n,s,r){if(!t||!Array.isArray(t.content))return"";const i=typeof s=="function"?s(r):s,[l,...o]=t.content,c=n.renderChildren([l]),d=[`${i}${c}`];return o&&o.length>0&&o.forEach(u=>{const h=n.renderChildren([u]);if(h){const m=h.split(`
`).map(x=>x?n.indent(x):"").join(`
`);d.push(m)}}),d.join(`
`)}var kx=class XF extends TA{constructor(){super(...arguments),this.type="node"}static create(n={}){const s=typeof n=="function"?n():n;return new XF(s)}configure(n){return super.configure(n)}extend(n){const s=typeof n=="function"?n():n;return super.extend(s)}};function ppe(t){return new Wme({find:t.find,handler:({state:n,range:s,match:r,pasteEvent:i})=>{const l=hu(t.getAttributes,void 0,r,i);if(l===!1||l===null)return null;const{tr:o}=n,c=r[r.length-1],d=r[0];let u=s.to;if(c){const h=d.search(/\S/),m=s.from+d.indexOf(c),x=m+c.length;if(VF(s.from,s.to,n.doc).filter(w=>w.mark.type.excluded.find(S=>S===t.type&&S!==w.mark.type)).filter(w=>w.to>m).length)return null;x<s.to&&o.delete(x,s.to),m>s.from&&o.delete(s.from+h,m),u=s.from+h+c.length,o.addMark(s.from+h,u,t.type.create(l||{})),o.removeStoredMark(t.type)}}})}function QF(t){const{state:n,transaction:s}=t;let{selection:r}=s,{doc:i}=s,{storedMarks:l}=s;return{...n,apply:n.apply.bind(n),applyTransaction:n.applyTransaction.bind(n),plugins:n.plugins,schema:n.schema,reconfigure:n.reconfigure.bind(n),toJSON:n.toJSON.bind(n),get storedMarks(){return l},get selection(){return r},get doc(){return i},get tr(){return r=s.selection,i=s.doc,l=s.storedMarks,s}}}class xpe{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:s,state:r}=this,{view:i}=s,{tr:l}=r,o=this.buildProps(l);return Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...h)=>{const m=d(...h)(o);return!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,s=!0){const{rawCommands:r,editor:i,state:l}=this,{view:o}=i,c=[],d=!!n,u=n||l.tr,h=()=>(!d&&s&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),c.every(x=>x===!0)),m={...Object.fromEntries(Object.entries(r).map(([x,b])=>[x,(...j)=>{const S=this.buildProps(u,s),C=b(...j)(S);return c.push(C),m}])),run:h};return m}createCan(n){const{rawCommands:s,state:r}=this,i=!1,l=n||r.tr,o=this.buildProps(l,i);return{...Object.fromEntries(Object.entries(s).map(([d,u])=>[d,(...h)=>u(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(l,i)}}buildProps(n,s=!0){const{rawCommands:r,editor:i,state:l}=this,{view:o}=i,c={tr:n,editor:i,view:o,state:QF({state:l,transaction:n}),dispatch:s?()=>{}:void 0,chain:()=>this.createChain(n,s),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(r).map(([d,u])=>[d,(...h)=>u(...h)(c)]))}};return c}}function Fr(t,n,s){return t.config[n]===void 0&&t.parent?Fr(t.parent,n,s):typeof t.config[n]=="function"?t.config[n].bind({...s,parent:t.parent?Fr(t.parent,n,s):null}):t.config[n]}function gpe(t){const n=t.filter(i=>i.type==="extension"),s=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:n,nodeExtensions:s,markExtensions:r}}function Gr(t,n){if(typeof t=="string"){if(!n.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return n.nodes[t]}return t}function Ca(...t){return t.filter(n=>!!n).reduce((n,s)=>{const r={...n};return Object.entries(s).forEach(([i,l])=>{if(!r[i]){r[i]=l;return}if(i==="class"){const c=l?String(l).split(" "):[],d=r[i]?r[i].split(" "):[],u=c.filter(h=>!d.includes(h));r[i]=[...d,...u].join(" ")}else if(i==="style"){const c=l?l.split(";").map(h=>h.trim()).filter(Boolean):[],d=r[i]?r[i].split(";").map(h=>h.trim()).filter(Boolean):[],u=new Map;d.forEach(h=>{const[m,x]=h.split(":").map(b=>b.trim());u.set(m,x)}),c.forEach(h=>{const[m,x]=h.split(":").map(b=>b.trim());u.set(m,x)}),r[i]=Array.from(u.entries()).map(([h,m])=>`${h}: ${m}`).join("; ")}else r[i]=l}),r},{})}function ype(t){return typeof t=="function"}function Xs(t,n=void 0,...s){return ype(t)?n?t.bind(n)(...s):t(...s):t}function bpe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Hb{constructor(n){this.find=n.find,this.handler=n.handler}}function vpe(t){return Object.prototype.toString.call(t).slice(8,-1)}function L0(t){return vpe(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Wb(t,n){const s={...t};return L0(t)&&L0(n)&&Object.keys(n).forEach(r=>{L0(n[r])&&L0(t[r])?s[r]=Wb(t[r],n[r]):s[r]=n[r]}),s}class mu{constructor(n={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...n},this.name=this.config.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Xs(Fr(this,"addOptions",{name:this.name}))),this.storage=Xs(Fr(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(n={}){return new mu(n)}configure(n={}){const s=this.extend({...this.config,addOptions:()=>Wb(this.options,n)});return s.name=this.name,s.parent=this.parent,s}extend(n={}){const s=new mu(n);return s.parent=this,this.child=s,s.name=n.name?n.name:s.parent.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${s.name}".`),s.options=Xs(Fr(s,"addOptions",{name:s.name})),s.storage=Xs(Fr(s,"addStorage",{name:s.name,options:s.options})),s}static handleExit({editor:n,mark:s}){const{tr:r}=n.state,i=n.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===s.name))return!1;const d=o.find(u=>(u==null?void 0:u.type.name)===s.name);return d&&r.removeStoredMark(d),r.insertText(" ",i.pos),n.view.dispatch(r),!0}return!1}}class wpe{constructor(n){this.find=n.find,this.handler=n.handler}}class ra{constructor(n={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...n},this.name=this.config.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Xs(Fr(this,"addOptions",{name:this.name}))),this.storage=Xs(Fr(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(n={}){return new ra(n)}configure(n={}){const s=this.extend({...this.config,addOptions:()=>Wb(this.options,n)});return s.name=this.name,s.parent=this.parent,s}extend(n={}){const s=new ra({...this.config,...n});return s.parent=this,this.child=s,s.name=n.name?n.name:s.parent.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${s.name}".`),s.options=Xs(Fr(s,"addOptions",{name:s.name})),s.storage=Xs(Fr(s,"addStorage",{name:s.name,options:s.options})),s}}function Npe(t,n,s){const{from:r,to:i}=n,{blockSeparator:l=`

`,textSerializers:o={}}=s||{};let c="";return t.nodesBetween(r,i,(d,u,h,m)=>{var x;d.isBlock&&u>r&&(c+=l);const b=o==null?void 0:o[d.type.name];if(b)return h&&(c+=b({node:d,pos:u,parent:h,index:m,range:n})),!1;d.isText&&(c+=(x=d==null?void 0:d.text)===null||x===void 0?void 0:x.slice(Math.max(r,u)-u,i-u))}),c}function jpe(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,n])=>n.spec.toText).map(([n,s])=>[n,s.spec.toText]))}ra.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new js({key:new Ss("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:n,schema:s}=t,{doc:r,selection:i}=n,{ranges:l}=i,o=Math.min(...l.map(h=>h.$from.pos)),c=Math.max(...l.map(h=>h.$to.pos)),d=jpe(s);return Npe(r,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}});const Spe=()=>({editor:t,view:n})=>(requestAnimationFrame(()=>{var s;t.isDestroyed||(n.dom.blur(),(s=window==null?void 0:window.getSelection())===null||s===void 0||s.removeAllRanges())}),!0),_pe=(t=!1)=>({commands:n})=>n.setContent("",t),Cpe=()=>({state:t,tr:n,dispatch:s})=>{const{selection:r}=n,{ranges:i}=r;return s&&i.forEach(({$from:l,$to:o})=>{t.doc.nodesBetween(l.pos,o.pos,(c,d)=>{if(c.type.isText)return;const{doc:u,mapping:h}=n,m=u.resolve(h.map(d)),x=u.resolve(h.map(d+c.nodeSize)),b=m.blockRange(x);if(!b)return;const w=Pu(b);if(c.type.isTextblock){const{defaultType:j}=m.parent.contentMatchAt(m.index());n.setNodeMarkup(b.start,j)}(w||w===0)&&n.lift(b,w)})}),!0},Ape=t=>n=>t(n),kpe=()=>({state:t,dispatch:n})=>mA(t,n),Epe=(t,n)=>({editor:s,tr:r})=>{const{state:i}=s,l=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(n);return r.insert(o,l.content),r.setSelection(new xt(r.doc.resolve(Math.max(o-1,0)))),!0},Tpe=()=>({tr:t,dispatch:n})=>{const{selection:s}=t,r=s.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let l=i.depth;l>0;l-=1)if(i.node(l).type===r.type){if(n){const c=i.before(l),d=i.after(l);t.delete(c,d).scrollIntoView()}return!0}return!1},Ipe=t=>({tr:n,state:s,dispatch:r})=>{const i=Gr(t,s.schema),l=n.selection.$anchor;for(let o=l.depth;o>0;o-=1)if(l.node(o).type===i){if(r){const d=l.before(o),u=l.after(o);n.delete(d,u).scrollIntoView()}return!0}return!1},Ppe=t=>({tr:n,dispatch:s})=>{const{from:r,to:i}=t;return s&&n.delete(r,i),!0},Mpe=()=>({state:t,dispatch:n})=>zb(t,n),Ope=()=>({commands:t})=>t.keyboardShortcut("Enter"),Dpe=()=>({state:t,dispatch:n})=>J9(t,n);function Z1(t,n,s={strict:!0}){const r=Object.keys(n);return r.length?r.every(i=>s.strict?n[i]===t[i]:bpe(n[i])?n[i].test(t[i]):n[i]===t[i]):!0}function ZF(t,n,s={}){return t.find(r=>r.type===n&&Z1(Object.fromEntries(Object.keys(s).map(i=>[i,r.attrs[i]])),s))}function jP(t,n,s={}){return!!ZF(t,n,s)}function OA(t,n,s){var r;if(!t||!n)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===n))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===n)||(s=s||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!ZF([...i.node.marks],n,s)))return;let o=i.index,c=t.start()+i.offset,d=o+1,u=c+i.node.nodeSize;for(;o>0&&jP([...t.parent.child(o-1).marks],n,s);)o-=1,c-=t.parent.child(o).nodeSize;for(;d<t.parent.childCount&&jP([...t.parent.child(d).marks],n,s);)u+=t.parent.child(d).nodeSize,d+=1;return{from:c,to:u}}function rd(t,n){if(typeof t=="string"){if(!n.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return n.marks[t]}return t}const Rpe=(t,n={})=>({tr:s,state:r,dispatch:i})=>{const l=rd(t,r.schema),{doc:o,selection:c}=s,{$from:d,from:u,to:h}=c;if(i){const m=OA(d,l,n);if(m&&m.from<=u&&m.to>=h){const x=xt.create(o,m.from,m.to);s.setSelection(x)}}return!0},Lpe=t=>n=>{const s=typeof t=="function"?t(n):t;for(let r=0;r<s.length;r+=1)if(s[r](n))return!0;return!1};function JF(t){return t instanceof xt}function Ld(t=0,n=0,s=0){return Math.min(Math.max(t,n),s)}function Bpe(t,n=null){if(!n)return null;const s=At.atStart(t),r=At.atEnd(t);if(n==="start"||n===!0)return s;if(n==="end")return r;const i=s.from,l=r.to;return n==="all"?xt.create(t,Ld(0,i,l),Ld(t.content.size,i,l)):xt.create(t,Ld(n,i,l),Ld(n,i,l))}function Fpe(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function DA(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const $pe=(t=null,n={})=>({editor:s,view:r,tr:i,dispatch:l})=>{n={scrollIntoView:!0,...n};const o=()=>{(DA()||Fpe())&&r.dom.focus(),requestAnimationFrame(()=>{s.isDestroyed||(r.focus(),n!=null&&n.scrollIntoView&&s.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(l&&t===null&&!JF(s.state.selection))return o(),!0;const c=Bpe(i.doc,t)||s.state.selection,d=s.state.selection.eq(c);return l&&(d||i.setSelection(c),d&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},zpe=(t,n)=>s=>t.every((r,i)=>n(r,{...s,index:i})),Upe=(t,n)=>({tr:s,commands:r})=>r.insertContentAt({from:s.selection.from,to:s.selection.to},t,n),e$=t=>{const n=t.childNodes;for(let s=n.length-1;s>=0;s-=1){const r=n[s];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&e$(r)}return t};function B0(t){const n=`<body>${t}</body>`,s=new window.DOMParser().parseFromString(n,"text/html").body;return e$(s)}function Up(t,n,s){if(t instanceof Tc||t instanceof Oe)return t;s={slice:!0,parseOptions:{},...s};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Oe.fromArray(t.map(c=>n.nodeFromJSON(c)));const o=n.nodeFromJSON(t);return s.errorOnInvalidContent&&o.check(),o}catch(l){if(s.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:l});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",l),Up("",n,s)}if(i){if(s.errorOnInvalidContent){let o=!1,c="";const d=new _9({topNode:n.spec.topNode,marks:n.spec.marks,nodes:n.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,c=typeof u=="string"?u:u.outerHTML,null)}]}})});if(s.slice?Ml.fromSchema(d).parseSlice(B0(t),s.parseOptions):Ml.fromSchema(d).parse(B0(t),s.parseOptions),s.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const l=Ml.fromSchema(n);return s.slice?l.parseSlice(B0(t),s.parseOptions).content:l.parse(B0(t),s.parseOptions)}return Up("",n,s)}function Vpe(t,n,s){const r=t.steps.length-1;if(r<n)return;const i=t.steps[r];if(!(i instanceof Ws||i instanceof Qs))return;const l=t.mapping.maps[r];let o=0;l.forEach((c,d,u,h)=>{o===0&&(o=h)}),t.setSelection(At.near(t.doc.resolve(o),s))}const Hpe=t=>!("type"in t),Wpe=(t,n,s)=>({tr:r,dispatch:i,editor:l})=>{var o;if(i){s={parseOptions:l.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...s};let c;const d=S=>{l.emit("contentError",{editor:l,error:S,disableCollaboration:()=>{l.storage.collaboration&&(l.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...s.parseOptions};if(!s.errorOnInvalidContent&&!l.options.enableContentCheck&&l.options.emitContentError)try{Up(n,l.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(S){d(S)}try{c=Up(n,l.schema,{parseOptions:u,errorOnInvalidContent:(o=s.errorOnInvalidContent)!==null&&o!==void 0?o:l.options.enableContentCheck})}catch(S){return d(S),!1}let{from:h,to:m}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},x=!0,b=!0;if((Hpe(c)?c:[c]).forEach(S=>{S.check(),x=x?S.isText&&S.marks.length===0:!1,b=b?S.isBlock:!1}),h===m&&b){const{parent:S}=r.doc.resolve(h);S.isTextblock&&!S.type.spec.code&&!S.childCount&&(h-=1,m+=1)}let j;if(x){if(Array.isArray(n))j=n.map(S=>S.text||"").join("");else if(n instanceof Oe){let S="";n.forEach(C=>{C.text&&(S+=C.text)}),j=S}else typeof n=="object"&&n&&n.text?j=n.text:j=n;r.insertText(j,h,m)}else j=c,r.replaceWith(h,m,j);s.updateSelection&&Vpe(r,r.steps.length-1,-1),s.applyInputRules&&r.setMeta("applyInputRules",{from:h,text:j}),s.applyPasteRules&&r.setMeta("applyPasteRules",{from:h,text:j})}return!0},qpe=()=>({state:t,dispatch:n})=>X9(t,n),Gpe=()=>({state:t,dispatch:n})=>Q9(t,n),Kpe=()=>({state:t,dispatch:n})=>iA(t,n),Ype=()=>({state:t,dispatch:n})=>cA(t,n),Xpe=()=>({state:t,dispatch:n,tr:s})=>{try{const r=Eh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(s.join(r,2),n&&n(s),!0)}catch{return!1}},Qpe=()=>({state:t,dispatch:n,tr:s})=>{try{const r=Eh(t.doc,t.selection.$from.pos,1);return r==null?!1:(s.join(r,2),n&&n(s),!0)}catch{return!1}},Zpe=()=>({state:t,dispatch:n})=>q9(t,n),Jpe=()=>({state:t,dispatch:n})=>G9(t,n);function t$(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function exe(t){const n=t.split(/-(?!$)/);let s=n[n.length-1];s==="Space"&&(s=" ");let r,i,l,o;for(let c=0;c<n.length-1;c+=1){const d=n[c];if(/^(cmd|meta|m)$/i.test(d))o=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))i=!0;else if(/^s(hift)?$/i.test(d))l=!0;else if(/^mod$/i.test(d))DA()||t$()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(s=`Alt-${s}`),i&&(s=`Ctrl-${s}`),o&&(s=`Meta-${s}`),l&&(s=`Shift-${s}`),s}const txe=t=>({editor:n,view:s,tr:r,dispatch:i})=>{const l=exe(t).split(/-(?!$)/),o=l.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:l.includes("Alt"),ctrlKey:l.includes("Ctrl"),metaKey:l.includes("Meta"),shiftKey:l.includes("Shift"),bubbles:!0,cancelable:!0}),d=n.captureTransaction(()=>{s.someProp("handleKeyDown",u=>u(s,c))});return d==null||d.steps.forEach(u=>{const h=u.map(r.mapping);h&&i&&r.maybeStep(h)}),!0};function RA(t,n,s={}){const{from:r,to:i,empty:l}=t.selection,o=n?Gr(n,t.schema):null,c=[];t.doc.nodesBetween(r,i,(m,x)=>{if(m.isText)return;const b=Math.max(r,x),w=Math.min(i,x+m.nodeSize);c.push({node:m,from:b,to:w})});const d=i-r,u=c.filter(m=>o?o.name===m.node.type.name:!0).filter(m=>Z1(m.node.attrs,s,{strict:!1}));return l?!!u.length:u.reduce((m,x)=>m+x.to-x.from,0)>=d}const nxe=(t,n={})=>({state:s,dispatch:r})=>{const i=Gr(t,s.schema);return RA(s,i,n)?Z9(s,r):!1},sxe=()=>({state:t,dispatch:n})=>pA(t,n),rxe=t=>({state:n,dispatch:s})=>{const r=Gr(t,n.schema);return lF(r)(n,s)},axe=()=>({state:t,dispatch:n})=>fA(t,n);function n$(t,n){return n.nodes[t]?"node":n.marks[t]?"mark":null}function SP(t,n){const s=typeof n=="string"?[n]:n;return Object.keys(t).reduce((r,i)=>(s.includes(i)||(r[i]=t[i]),r),{})}const ixe=(t,n)=>({tr:s,state:r,dispatch:i})=>{let l=null,o=null;const c=n$(typeof t=="string"?t:t.name,r.schema);return c?(c==="node"&&(l=Gr(t,r.schema)),c==="mark"&&(o=rd(t,r.schema)),i&&s.selection.ranges.forEach(d=>{r.doc.nodesBetween(d.$from.pos,d.$to.pos,(u,h)=>{l&&l===u.type&&s.setNodeMarkup(h,void 0,SP(u.attrs,n)),o&&u.marks.length&&u.marks.forEach(m=>{o===m.type&&s.addMark(h,h+u.nodeSize,o.create(SP(m.attrs,n)))})})}),!0):!1},lxe=()=>({tr:t,dispatch:n})=>(n&&t.scrollIntoView(),!0),oxe=()=>({tr:t,dispatch:n})=>{if(n){const s=new _a(t.doc);t.setSelection(s)}return!0},cxe=()=>({state:t,dispatch:n})=>lA(t,n),dxe=()=>({state:t,dispatch:n})=>dA(t,n),uxe=()=>({state:t,dispatch:n})=>eF(t,n),fxe=()=>({state:t,dispatch:n})=>rF(t,n),hxe=()=>({state:t,dispatch:n})=>sF(t,n);function mxe(t,n,s={},r={}){return Up(t,n,{slice:!1,parseOptions:s,errorOnInvalidContent:r.errorOnInvalidContent})}const pxe=(t,n=!1,s={},r={})=>({editor:i,tr:l,dispatch:o,commands:c})=>{var d,u;const{doc:h}=l;if(s.preserveWhitespace!=="full"){const m=mxe(t,i.schema,s,{errorOnInvalidContent:(d=r.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck});return o&&l.replaceWith(0,h.content.size,m).setMeta("preventUpdate",!n),!0}return o&&l.setMeta("preventUpdate",!n),c.insertContentAt({from:0,to:h.content.size},t,{parseOptions:s,errorOnInvalidContent:(u=r.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function xxe(t,n){const s=rd(n,t.schema),{from:r,to:i,empty:l}=t.selection,o=[];l?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,d=>{o.push(...d.marks)});const c=o.find(d=>d.type.name===s.name);return c?{...c.attrs}:{}}function gxe(t){for(let n=0;n<t.edgeCount;n+=1){const{type:s}=t.edge(n);if(s.isTextblock&&!s.hasRequiredAttrs())return s}return null}function yxe(t,n){for(let s=t.depth;s>0;s-=1){const r=t.node(s);if(n(r))return{pos:s>0?t.before(s):0,start:t.start(s),depth:s,node:r}}}function LA(t){return n=>yxe(n.$from,t)}function s$(t,n,s){const r=[];return t===n?s.resolve(t).marks().forEach(i=>{const l=s.resolve(t),o=OA(l,i.type);o&&r.push({mark:i,...o})}):s.nodesBetween(t,n,(i,l)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:l,to:l+i.nodeSize,mark:o})))}),r}function $g(t,n,s){return Object.fromEntries(Object.entries(s).filter(([r])=>{const i=t.find(l=>l.type===n&&l.name===r);return i?i.attribute.keepOnSplit:!1}))}function bxe(t,n,s={}){const{empty:r,ranges:i}=t.selection,l=n?rd(n,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(m=>l?l.name===m.type.name:!0).find(m=>Z1(m.attrs,s,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:m,$to:x})=>{const b=m.pos,w=x.pos;t.doc.nodesBetween(b,w,(j,S)=>{if(!j.isText&&!j.marks.length)return;const C=Math.max(b,S),A=Math.min(w,S+j.nodeSize),k=A-C;o+=k,c.push(...j.marks.map(T=>({mark:T,from:C,to:A})))})}),o===0)return!1;const d=c.filter(m=>l?l.name===m.mark.type.name:!0).filter(m=>Z1(m.mark.attrs,s,{strict:!1})).reduce((m,x)=>m+x.to-x.from,0),u=c.filter(m=>l?m.mark.type!==l&&m.mark.type.excludes(l):!0).reduce((m,x)=>m+x.to-x.from,0);return(d>0?d+u:d)>=o}function _P(t,n){const{nodeExtensions:s}=gpe(n),r=s.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},l=Xs(Fr(r,"group",i));return typeof l!="string"?!1:l.split(" ").includes("list")}function r$(t,{checkChildren:n=!0,ignoreWhitespace:s=!1}={}){var r;if(s){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(n){let i=!0;return t.content.forEach(l=>{i!==!1&&(r$(l,{ignoreWhitespace:s,checkChildren:n})||(i=!1))}),i}return!1}function vxe(t){return t instanceof vt}function wxe(t,n,s){var r;const{selection:i}=n;let l=null;if(JF(i)&&(l=i.$cursor),l){const c=(r=t.storedMarks)!==null&&r!==void 0?r:l.marks();return!!s.isInSet(c)||!c.some(d=>d.type.excludes(s))}const{ranges:o}=i;return o.some(({$from:c,$to:d})=>{let u=c.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(s):!1;return t.doc.nodesBetween(c.pos,d.pos,(h,m,x)=>{if(u)return!1;if(h.isInline){const b=!x||x.type.allowsMarkType(s),w=!!s.isInSet(h.marks)||!h.marks.some(j=>j.type.excludes(s));u=b&&w}return!u}),u})}const Nxe=(t,n={})=>({tr:s,state:r,dispatch:i})=>{const{selection:l}=s,{empty:o,ranges:c}=l,d=rd(t,r.schema);if(i)if(o){const u=xxe(r,d);s.addStoredMark(d.create({...u,...n}))}else c.forEach(u=>{const h=u.$from.pos,m=u.$to.pos;r.doc.nodesBetween(h,m,(x,b)=>{const w=Math.max(b,h),j=Math.min(b+x.nodeSize,m);x.marks.find(C=>C.type===d)?x.marks.forEach(C=>{d===C.type&&s.addMark(w,j,d.create({...C.attrs,...n}))}):s.addMark(w,j,d.create(n))})});return wxe(r,s,d)},jxe=(t,n)=>({tr:s})=>(s.setMeta(t,n),!0),Sxe=(t,n={})=>({state:s,dispatch:r,chain:i})=>{const l=Gr(t,s.schema);let o;return s.selection.$anchor.sameParent(s.selection.$head)&&(o=s.selection.$anchor.parent.attrs),l.isTextblock?i().command(({commands:c})=>H1(l,{...o,...n})(s)?!0:c.clearNodes()).command(({state:c})=>H1(l,{...o,...n})(c,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},_xe=t=>({tr:n,dispatch:s})=>{if(s){const{doc:r}=n,i=Ld(t,0,r.content.size),l=vt.create(r,i);n.setSelection(l)}return!0},Cxe=t=>({tr:n,dispatch:s})=>{if(s){const{doc:r}=n,{from:i,to:l}=typeof t=="number"?{from:t,to:t}:t,o=xt.atStart(r).from,c=xt.atEnd(r).to,d=Ld(i,o,c),u=Ld(l,o,c),h=xt.create(r,d,u);n.setSelection(h)}return!0},Axe=t=>({state:n,dispatch:s})=>{const r=Gr(t,n.schema);return oF(r)(n,s)};function CP(t,n){const s=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(s){const r=s.filter(i=>n==null?void 0:n.includes(i.type.name));t.tr.ensureMarks(r)}}const kxe=({keepMarks:t=!0}={})=>({tr:n,state:s,dispatch:r,editor:i})=>{const{selection:l,doc:o}=n,{$from:c,$to:d}=l,u=i.extensionManager.attributes,h=$g(u,c.node().type.name,c.node().attrs);if(l instanceof vt&&l.node.isBlock)return!c.parentOffset||!Wa(o,c.pos)?!1:(r&&(t&&CP(s,i.extensionManager.splittableMarks),n.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const m=d.parentOffset===d.parent.content.size,x=c.depth===0?void 0:gxe(c.node(-1).contentMatchAt(c.indexAfter(-1)));let b=m&&x?[{type:x,attrs:h}]:void 0,w=Wa(n.doc,n.mapping.map(c.pos),1,b);if(!b&&!w&&Wa(n.doc,n.mapping.map(c.pos),1,x?[{type:x}]:void 0)&&(w=!0,b=x?[{type:x,attrs:h}]:void 0),r){if(w&&(l instanceof xt&&n.deleteSelection(),n.split(n.mapping.map(c.pos),1,b),x&&!m&&!c.parentOffset&&c.parent.type!==x)){const j=n.mapping.map(c.before()),S=n.doc.resolve(j);c.node(-1).canReplaceWith(S.index(),S.index()+1,x)&&n.setNodeMarkup(n.mapping.map(c.before()),x)}t&&CP(s,i.extensionManager.splittableMarks),n.scrollIntoView()}return w},Exe=(t,n={})=>({tr:s,state:r,dispatch:i,editor:l})=>{var o;const c=Gr(t,r.schema),{$from:d,$to:u}=r.selection,h=r.selection.node;if(h&&h.isBlock||d.depth<2||!d.sameParent(u))return!1;const m=d.node(-1);if(m.type!==c)return!1;const x=l.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==c||d.index(-2)!==d.node(-2).childCount-1)return!1;if(i){let C=Oe.empty;const A=d.index(-1)?1:d.index(-2)?2:3;for(let R=d.depth-A;R>=d.depth-3;R-=1)C=Oe.from(d.node(R).copy(C));const k=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,T={...$g(x,d.node().type.name,d.node().attrs),...n},I=((o=c.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(T))||void 0;C=C.append(Oe.from(c.createAndFill(null,I)||void 0));const D=d.before(d.depth-(A-1));s.replace(D,d.after(-k),new tt(C,4-A,0));let O=-1;s.doc.nodesBetween(D,s.doc.content.size,(R,P)=>{if(O>-1)return!1;R.isTextblock&&R.content.size===0&&(O=P+1)}),O>-1&&s.setSelection(xt.near(s.doc.resolve(O))),s.scrollIntoView()}return!0}const b=u.pos===d.end()?m.contentMatchAt(0).defaultType:null,w={...$g(x,m.type.name,m.attrs),...n},j={...$g(x,d.node().type.name,d.node().attrs),...n};s.delete(d.pos,u.pos);const S=b?[{type:c,attrs:w},{type:b,attrs:j}]:[{type:c,attrs:w}];if(!Wa(s.doc,d.pos,2))return!1;if(i){const{selection:C,storedMarks:A}=r,{splittableMarks:k}=l.extensionManager,T=A||C.$to.parentOffset&&C.$from.marks();if(s.split(d.pos,2,S).scrollIntoView(),!T||!i)return!0;const I=T.filter(D=>k.includes(D.type.name));s.ensureMarks(I)}return!0},KN=(t,n)=>{const s=LA(o=>o.type===n)(t.selection);if(!s)return!0;const r=t.doc.resolve(Math.max(0,s.pos-1)).before(s.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return s.node.type===(i==null?void 0:i.type)&&Wl(t.doc,s.pos)&&t.join(s.pos),!0},YN=(t,n)=>{const s=LA(o=>o.type===n)(t.selection);if(!s)return!0;const r=t.doc.resolve(s.start).after(s.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return s.node.type===(i==null?void 0:i.type)&&Wl(t.doc,r)&&t.join(r),!0},Txe=(t,n,s,r={})=>({editor:i,tr:l,state:o,dispatch:c,chain:d,commands:u,can:h})=>{const{extensions:m,splittableMarks:x}=i.extensionManager,b=Gr(t,o.schema),w=Gr(n,o.schema),{selection:j,storedMarks:S}=o,{$from:C,$to:A}=j,k=C.blockRange(A),T=S||j.$to.parentOffset&&j.$from.marks();if(!k)return!1;const I=LA(D=>_P(D.type.name,m))(j);if(k.depth>=1&&I&&k.depth-I.depth<=1){if(I.node.type===b)return u.liftListItem(w);if(_P(I.node.type.name,m)&&b.validContent(I.node.content)&&c)return d().command(()=>(l.setNodeMarkup(I.pos,b),!0)).command(()=>KN(l,b)).command(()=>YN(l,b)).run()}return!s||!T||!c?d().command(()=>h().wrapInList(b,r)?!0:u.clearNodes()).wrapInList(b,r).command(()=>KN(l,b)).command(()=>YN(l,b)).run():d().command(()=>{const D=h().wrapInList(b,r),O=T.filter(R=>x.includes(R.type.name));return l.ensureMarks(O),D?!0:u.clearNodes()}).wrapInList(b,r).command(()=>KN(l,b)).command(()=>YN(l,b)).run()},Ixe=(t,n={},s={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:l=!1}=s,o=rd(t,r.schema);return bxe(r,o,n)?i.unsetMark(o,{extendEmptyMarkRange:l}):i.setMark(o,n)},Pxe=(t,n,s={})=>({state:r,commands:i})=>{const l=Gr(t,r.schema),o=Gr(n,r.schema),c=RA(r,l,s);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),c?i.setNode(o,d):i.setNode(l,{...d,...s})},Mxe=(t,n={})=>({state:s,commands:r})=>{const i=Gr(t,s.schema);return RA(s,i,n)?r.lift(i):r.wrapIn(i,n)},Oxe=()=>({state:t,dispatch:n})=>{const s=t.plugins;for(let r=0;r<s.length;r+=1){const i=s[r];let l;if(i.spec.isInputRules&&(l=i.getState(t))){if(n){const o=t.tr,c=l.transform;for(let d=c.steps.length-1;d>=0;d-=1)o.step(c.steps[d].invert(c.docs[d]));if(l.text){const d=o.doc.resolve(l.from).marks();o.replaceWith(l.from,l.to,t.schema.text(l.text,d))}else o.delete(l.from,l.to)}return!0}}return!1},Dxe=()=>({tr:t,dispatch:n})=>{const{selection:s}=t,{empty:r,ranges:i}=s;return r||n&&i.forEach(l=>{t.removeMark(l.$from.pos,l.$to.pos)}),!0},Rxe=(t,n={})=>({tr:s,state:r,dispatch:i})=>{var l;const{extendEmptyMarkRange:o=!1}=n,{selection:c}=s,d=rd(t,r.schema),{$from:u,empty:h,ranges:m}=c;if(!i)return!0;if(h&&o){let{from:x,to:b}=c;const w=(l=u.marks().find(S=>S.type===d))===null||l===void 0?void 0:l.attrs,j=OA(u,d,w);j&&(x=j.from,b=j.to),s.removeMark(x,b,d)}else m.forEach(x=>{s.removeMark(x.$from.pos,x.$to.pos,d)});return s.removeStoredMark(d),!0},Lxe=(t,n={})=>({tr:s,state:r,dispatch:i})=>{let l=null,o=null;const c=n$(typeof t=="string"?t:t.name,r.schema);return c?(c==="node"&&(l=Gr(t,r.schema)),c==="mark"&&(o=rd(t,r.schema)),i&&s.selection.ranges.forEach(d=>{const u=d.$from.pos,h=d.$to.pos;let m,x,b,w;s.selection.empty?r.doc.nodesBetween(u,h,(j,S)=>{l&&l===j.type&&(b=Math.max(S,u),w=Math.min(S+j.nodeSize,h),m=S,x=j)}):r.doc.nodesBetween(u,h,(j,S)=>{S<u&&l&&l===j.type&&(b=Math.max(S,u),w=Math.min(S+j.nodeSize,h),m=S,x=j),S>=u&&S<=h&&(l&&l===j.type&&s.setNodeMarkup(S,void 0,{...j.attrs,...n}),o&&j.marks.length&&j.marks.forEach(C=>{if(o===C.type){const A=Math.max(S,u),k=Math.min(S+j.nodeSize,h);s.addMark(A,k,o.create({...C.attrs,...n}))}}))}),x&&(m!==void 0&&s.setNodeMarkup(m,void 0,{...x.attrs,...n}),o&&x.marks.length&&x.marks.forEach(j=>{o===j.type&&s.addMark(b,w,o.create({...j.attrs,...n}))}))}),!0):!1},Bxe=(t,n={})=>({state:s,dispatch:r})=>{const i=Gr(t,s.schema);return aF(i,n)(s,r)},Fxe=(t,n={})=>({state:s,dispatch:r})=>{const i=Gr(t,s.schema);return iF(i,n)(s,r)};var $xe=Object.freeze({__proto__:null,blur:Spe,clearContent:_pe,clearNodes:Cpe,command:Ape,createParagraphNear:kpe,cut:Epe,deleteCurrentNode:Tpe,deleteNode:Ipe,deleteRange:Ppe,deleteSelection:Mpe,enter:Ope,exitCode:Dpe,extendMarkRange:Rpe,first:Lpe,focus:$pe,forEach:zpe,insertContent:Upe,insertContentAt:Wpe,joinBackward:Kpe,joinDown:Gpe,joinForward:Ype,joinItemBackward:Xpe,joinItemForward:Qpe,joinTextblockBackward:Zpe,joinTextblockForward:Jpe,joinUp:qpe,keyboardShortcut:txe,lift:nxe,liftEmptyBlock:sxe,liftListItem:rxe,newlineInCode:axe,resetAttributes:ixe,scrollIntoView:lxe,selectAll:oxe,selectNodeBackward:cxe,selectNodeForward:dxe,selectParentNode:uxe,selectTextblockEnd:fxe,selectTextblockStart:hxe,setContent:pxe,setMark:Nxe,setMeta:jxe,setNode:Sxe,setNodeSelection:_xe,setTextSelection:Cxe,sinkListItem:Axe,splitBlock:kxe,splitListItem:Exe,toggleList:Txe,toggleMark:Ixe,toggleNode:Pxe,toggleWrap:Mxe,undoInputRule:Oxe,unsetAllMarks:Dxe,unsetMark:Rxe,updateAttributes:Lxe,wrapIn:Bxe,wrapInList:Fxe});ra.create({name:"commands",addCommands(){return{...$xe}}});ra.create({name:"drop",addProseMirrorPlugins(){return[new js({key:new Ss("tiptapDrop"),props:{handleDrop:(t,n,s,r)=>{this.editor.emit("drop",{editor:this.editor,event:n,slice:s,moved:r})}}})]}});ra.create({name:"editable",addProseMirrorPlugins(){return[new js({key:new Ss("editable"),props:{editable:()=>this.editor.options.editable}})]}});const zxe=new Ss("focusEvents");ra.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new js({key:zxe,props:{handleDOMEvents:{focus:(n,s)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:s}).setMeta("addToHistory",!1);return n.dispatch(r),!1},blur:(n,s)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:s}).setMeta("addToHistory",!1);return n.dispatch(r),!1}}}})]}});ra.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:d,doc:u}=c,{empty:h,$anchor:m}=d,{pos:x,parent:b}=m,w=m.parent.isTextblock&&x>0?c.doc.resolve(x-1):m,j=w.parent.type.spec.isolating,S=m.pos-m.parentOffset,C=j&&w.parent.childCount===1?S===m.pos:At.atStart(u).from===x;return!h||!b.type.isTextblock||b.textContent.length||!C||C&&m.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),n=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:n,"Mod-Delete":n,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},l={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":n,"Ctrl-Alt-Backspace":n,"Alt-Delete":n,"Alt-d":n,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return DA()||t$()?l:i},addProseMirrorPlugins(){return[new js({key:new Ss("clearDocument"),appendTransaction:(t,n,s)=>{if(t.some(j=>j.getMeta("composition")))return;const r=t.some(j=>j.docChanged)&&!n.doc.eq(s.doc),i=t.some(j=>j.getMeta("preventClearDocument"));if(!r||i)return;const{empty:l,from:o,to:c}=n.selection,d=At.atStart(n.doc).from,u=At.atEnd(n.doc).to;if(l||!(o===d&&c===u)||!r$(s.doc))return;const x=s.tr,b=QF({state:s,transaction:x}),{commands:w}=new xpe({editor:this.editor,state:b});if(w.clearNodes(),!!x.steps.length)return x}})]}});ra.create({name:"paste",addProseMirrorPlugins(){return[new js({key:new Ss("tiptapPaste"),props:{handlePaste:(t,n,s)=>{this.editor.emit("paste",{editor:this.editor,event:n,slice:s})}}})]}});ra.create({name:"tabindex",addProseMirrorPlugins(){return[new js({key:new Ss("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function sh(t){return new Hb({find:t.find,handler:({state:n,range:s,match:r})=>{const i=Xs(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:l}=n,o=r[r.length-1],c=r[0];if(o){const d=c.search(/\S/),u=s.from+c.indexOf(o),h=u+o.length;if(s$(s.from,s.to,n.doc).filter(b=>b.mark.type.excluded.find(j=>j===t.type&&j!==b.mark.type)).filter(b=>b.to>u).length)return null;h<s.to&&l.delete(h,s.to),u>s.from&&l.delete(s.from+d,u);const x=s.from+d+o.length;l.addMark(s.from+d,x,t.type.create(i||{})),l.removeStoredMark(t.type)}}})}function Uxe(t){return new Hb({find:t.find,handler:({state:n,range:s,match:r})=>{const i=Xs(t.getAttributes,void 0,r)||{},{tr:l}=n,o=s.from;let c=s.to;const d=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let h=o+u;h>c?h=c:c=h+r[1].length;const m=r[0][r[0].length-1];l.insertText(m,o+r[0].length-1),l.replaceWith(h,c,d)}else if(r[0]){const u=t.type.isInline?o:o-1;l.insert(u,t.type.create(i)).delete(l.mapping.map(o),l.mapping.map(c))}l.scrollIntoView()}})}function qS(t){return new Hb({find:t.find,handler:({state:n,range:s,match:r})=>{const i=n.doc.resolve(s.from),l=Xs(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;n.tr.delete(s.from,s.to).setBlockType(s.from,s.from,t.type,l)}})}function Vp(t){return new Hb({find:t.find,handler:({state:n,range:s,match:r,chain:i})=>{const l=Xs(t.getAttributes,void 0,r)||{},o=n.tr.delete(s.from,s.to),d=o.doc.resolve(s.from).blockRange(),u=d&&rA(d,t.type,l);if(!u)return null;if(o.wrap(d,u),t.keepMarks&&t.editor){const{selection:m,storedMarks:x}=n,{splittableMarks:b}=t.editor.extensionManager,w=x||m.$to.parentOffset&&m.$from.marks();if(w){const j=w.filter(S=>b.includes(S.type.name));o.ensureMarks(j)}}if(t.keepAttributes){const m=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(m,l).run()}const h=o.doc.resolve(s.from-1).nodeBefore;h&&h.type===t.type&&Wl(o.doc,s.from-1)&&(!t.joinPredicate||t.joinPredicate(r,h))&&o.join(s.from-1)}})}let il=class GS{constructor(n={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...n},this.name=this.config.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Xs(Fr(this,"addOptions",{name:this.name}))),this.storage=Xs(Fr(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(n={}){return new GS(n)}configure(n={}){const s=this.extend({...this.config,addOptions:()=>Wb(this.options,n)});return s.name=this.name,s.parent=this.parent,s}extend(n={}){const s=new GS(n);return s.parent=this,this.child=s,s.name=n.name?n.name:s.parent.name,n.defaultOptions&&Object.keys(n.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${s.name}".`),s.options=Xs(Fr(s,"addOptions",{name:s.name})),s.storage=Xs(Fr(s,"addStorage",{name:s.name,options:s.options})),s}};function rh(t){return new wpe({find:t.find,handler:({state:n,range:s,match:r,pasteEvent:i})=>{const l=Xs(t.getAttributes,void 0,r,i);if(l===!1||l===null)return null;const{tr:o}=n,c=r[r.length-1],d=r[0];let u=s.to;if(c){const h=d.search(/\S/),m=s.from+d.indexOf(c),x=m+c.length;if(s$(s.from,s.to,n.doc).filter(w=>w.mark.type.excluded.find(S=>S===t.type&&S!==w.mark.type)).filter(w=>w.to>m).length)return null;x<s.to&&o.delete(x,s.to),m>s.from&&o.delete(s.from+h,m),u=s.from+h+c.length,o.addMark(s.from+h,u,t.type.create(l||{})),o.removeStoredMark(t.type)}}})}function Vxe(t,n){const{selection:s}=t,{$from:r}=s;if(s instanceof vt){const l=r.index();return r.parent.canReplaceWith(l,l+1,n)}let i=r.depth;for(;i>=0;){const l=r.index(i);if(r.node(i).contentMatchAt(l).matchType(n))return!0;i-=1}return!1}const Hxe=/^\s*>\s$/,Wxe=il.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Vp({find:Hxe,type:this.type})]}}),qxe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Gxe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Kxe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Yxe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Xxe=mu.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[sh({find:qxe,type:this.type}),sh({find:Kxe,type:this.type})]},addPasteRules(){return[rh({find:Gxe,type:this.type}),rh({find:Yxe,type:this.type})]}}),Qxe="listItem",AP="textStyle",kP=/^\s*([-+*])\s$/,Zxe=il.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:n})=>this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Qxe,this.editor.getAttributes(AP)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Vp({find:kP,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Vp({find:kP,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(AP),editor:this.editor})),[t]}}),Jxe=/(^|[^`])`([^`]+)`(?!`)/,e0e=/(^|[^`])`([^`]+)`(?!`)/g,t0e=mu.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[sh({find:Jxe,type:this.type})]},addPasteRules(){return[rh({find:e0e,type:this.type})]}}),n0e=/^```([a-z]+)?[\s\n]$/,s0e=/^~~~([a-z]+)?[\s\n]$/,r0e=il.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var n;const{languageClassPrefix:s}=this.options,l=[...((n=t.firstElementChild)===null||n===void 0?void 0:n.classList)||[]].filter(o=>o.startsWith(s)).map(o=>o.replace(s,""))[0];return l||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:n}){return["pre",Ca(this.options.HTMLAttributes,n),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:n})=>n.setNode(this.name,t),toggleCodeBlock:t=>({commands:n})=>n.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:n}=this.editor.state.selection,s=n.pos===1;return!t||n.parent.type.name!==this.name?!1:s||!n.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:n}=t,{selection:s}=n,{$from:r,empty:i}=s;if(!i||r.parent.type!==this.type)return!1;const l=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!l||!o?!1:t.chain().command(({tr:c})=>(c.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:n}=t,{selection:s,doc:r}=n,{$from:i,empty:l}=s;if(!l||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const c=i.after();return c===void 0?!1:r.nodeAt(c)?t.commands.command(({tr:u})=>(u.setSelection(At.near(r.resolve(c))),!0)):t.commands.exitCode()}}},addInputRules(){return[qS({find:n0e,type:this.type,getAttributes:t=>({language:t[1]})}),qS({find:s0e,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new js({key:new Ss("codeBlockVSCodeHandler"),props:{handlePaste:(t,n)=>{if(!n.clipboardData||this.editor.isActive(this.type.name))return!1;const s=n.clipboardData.getData("text/plain"),r=n.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,l=i==null?void 0:i.mode;if(!s||!l)return!1;const{tr:o,schema:c}=t.state,d=c.text(s.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:l},d)),o.selection.$from.parent.type!==this.type&&o.setSelection(xt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),a0e=il.create({name:"doc",topNode:!0,content:"block+"});function i0e(t={}){return new js({view(n){return new l0e(n,t)}})}class l0e{constructor(n,s){var r;this.editorView=n,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=s.width)!==null&&r!==void 0?r:1,this.color=s.color===!1?void 0:s.color||"black",this.class=s.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let l=o=>{this[i](o)};return n.dom.addEventListener(i,l),{name:i,handler:l}})}destroy(){this.handlers.forEach(({name:n,handler:s})=>this.editorView.dom.removeEventListener(n,s))}update(n,s){this.cursorPos!=null&&s.doc!=n.state.doc&&(this.cursorPos>n.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(n){n!=this.cursorPos&&(this.cursorPos=n,n==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let n=this.editorView.state.doc.resolve(this.cursorPos),s=!n.parent.inlineContent,r,i=this.editorView.dom,l=i.getBoundingClientRect(),o=l.width/i.offsetWidth,c=l.height/i.offsetHeight;if(s){let m=n.nodeBefore,x=n.nodeAfter;if(m||x){let b=this.editorView.nodeDOM(this.cursorPos-(m?m.nodeSize:0));if(b){let w=b.getBoundingClientRect(),j=m?w.bottom:w.top;m&&x&&(j=(j+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let S=this.width/2*c;r={left:w.left,right:w.right,top:j-S,bottom:j+S}}}}if(!r){let m=this.editorView.coordsAtPos(this.cursorPos),x=this.width/2*o;r={left:m.left-x,right:m.left+x,top:m.top,bottom:m.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",s),this.element.classList.toggle("prosemirror-dropcursor-inline",!s);let u,h;if(!d||d==document.body&&getComputedStyle(d).position=="static")u=-pageXOffset,h=-pageYOffset;else{let m=d.getBoundingClientRect(),x=m.width/d.offsetWidth,b=m.height/d.offsetHeight;u=m.left-d.scrollLeft*x,h=m.top-d.scrollTop*b}this.element.style.left=(r.left-u)/o+"px",this.element.style.top=(r.top-h)/c+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/c+"px"}scheduleRemoval(n){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),n)}dragover(n){if(!this.editorView.editable)return;let s=this.editorView.posAtCoords({left:n.clientX,top:n.clientY}),r=s&&s.inside>=0&&this.editorView.state.doc.nodeAt(s.inside),i=r&&r.type.spec.disableDropCursor,l=typeof i=="function"?i(this.editorView,s,n):i;if(s&&!l){let o=s.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let c=R9(this.editorView.state.doc,o,this.editorView.dragging.slice);c!=null&&(o=c)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(n){this.editorView.dom.contains(n.relatedTarget)||this.setCursor(null)}}const o0e=ra.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[i0e(this.options)]}});class hs extends At{constructor(n){super(n,n)}map(n,s){let r=n.resolve(s.map(this.head));return hs.valid(r)?new hs(r):At.near(r)}content(){return tt.empty}eq(n){return n instanceof hs&&n.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(n,s){if(typeof s.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new hs(n.resolve(s.pos))}getBookmark(){return new BA(this.anchor)}static valid(n){let s=n.parent;if(s.isTextblock||!c0e(n)||!d0e(n))return!1;let r=s.type.spec.allowGapCursor;if(r!=null)return r;let i=s.contentMatchAt(n.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(n,s,r=!1){e:for(;;){if(!r&&hs.valid(n))return n;let i=n.pos,l=null;for(let o=n.depth;;o--){let c=n.node(o);if(s>0?n.indexAfter(o)<c.childCount:n.index(o)>0){l=c.child(s>0?n.indexAfter(o):n.index(o)-1);break}else if(o==0)return null;i+=s;let d=n.doc.resolve(i);if(hs.valid(d))return d}for(;;){let o=s>0?l.firstChild:l.lastChild;if(!o){if(l.isAtom&&!l.isText&&!vt.isSelectable(l)){n=n.doc.resolve(i+l.nodeSize*s),r=!1;continue e}break}l=o,i+=s;let c=n.doc.resolve(i);if(hs.valid(c))return c}return null}}}hs.prototype.visible=!1;hs.findFrom=hs.findGapCursorFrom;At.jsonID("gapcursor",hs);class BA{constructor(n){this.pos=n}map(n){return new BA(n.map(this.pos))}resolve(n){let s=n.resolve(this.pos);return hs.valid(s)?new hs(s):At.near(s)}}function a$(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function c0e(t){for(let n=t.depth;n>=0;n--){let s=t.index(n),r=t.node(n);if(s==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(s-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||a$(i.type))return!0;if(i.inlineContent)return!1}}return!0}function d0e(t){for(let n=t.depth;n>=0;n--){let s=t.indexAfter(n),r=t.node(n);if(s==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(s);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||a$(i.type))return!0;if(i.inlineContent)return!1}}return!0}function u0e(){return new js({props:{decorations:p0e,createSelectionBetween(t,n,s){return n.pos==s.pos&&hs.valid(s)?new hs(s):null},handleClick:h0e,handleKeyDown:f0e,handleDOMEvents:{beforeinput:m0e}}})}const f0e=MF({ArrowLeft:F0("horiz",-1),ArrowRight:F0("horiz",1),ArrowUp:F0("vert",-1),ArrowDown:F0("vert",1)});function F0(t,n){const s=t=="vert"?n>0?"down":"up":n>0?"right":"left";return function(r,i,l){let o=r.selection,c=n>0?o.$to:o.$from,d=o.empty;if(o instanceof xt){if(!l.endOfTextblock(s)||c.depth==0)return!1;d=!1,c=r.doc.resolve(n>0?c.after():c.before())}let u=hs.findGapCursorFrom(c,n,d);return u?(i&&i(r.tr.setSelection(new hs(u))),!0):!1}}function h0e(t,n,s){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(n);if(!hs.valid(r))return!1;let i=t.posAtCoords({left:s.clientX,top:s.clientY});return i&&i.inside>-1&&vt.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new hs(r))),!0)}function m0e(t,n){if(n.inputType!="insertCompositionText"||!(t.state.selection instanceof hs))return!1;let{$from:s}=t.state.selection,r=s.parent.contentMatchAt(s.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=Oe.empty;for(let o=r.length-1;o>=0;o--)i=Oe.from(r[o].createAndFill(null,i));let l=t.state.tr.replace(s.pos,s.pos,new tt(i,0,0));return l.setSelection(xt.near(l.doc.resolve(s.pos+1))),t.dispatch(l),!1}function p0e(t){if(!(t.selection instanceof hs))return null;let n=document.createElement("div");return n.className="ProseMirror-gapcursor",bs.create(t.doc,[Va.widget(t.selection.head,n,{key:"gapcursor"})])}const x0e=ra.create({name:"gapCursor",addProseMirrorPlugins(){return[u0e()]},extendNodeSchema(t){var n;const s={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(n=Xs(Fr(t,"allowGapCursor",s)))!==null&&n!==void 0?n:null}}}),g0e=il.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Ca(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:n,state:s,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:l}=s;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:c}=r.extensionManager,d=l||i.$to.parentOffset&&i.$from.marks();return n().insertContent({type:this.name}).command(({tr:u,dispatch:h})=>{if(h&&d&&o){const m=d.filter(x=>c.includes(x.type.name));u.ensureMarks(m)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),y0e=il.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:n}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Ca(this.options.HTMLAttributes,n),0]},addCommands(){return{setHeading:t=>({commands:n})=>this.options.levels.includes(t.level)?n.setNode(this.name,t):!1,toggleHeading:t=>({commands:n})=>this.options.levels.includes(t.level)?n.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,n)=>({...t,[`Mod-Alt-${n}`]:()=>this.editor.commands.toggleHeading({level:n})}),{})},addInputRules(){return this.options.levels.map(t=>qS({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var J1=200,cr=function(){};cr.prototype.append=function(n){return n.length?(n=cr.from(n),!this.length&&n||n.length<J1&&this.leafAppend(n)||this.length<J1&&n.leafPrepend(this)||this.appendInner(n)):this};cr.prototype.prepend=function(n){return n.length?cr.from(n).append(this):this};cr.prototype.appendInner=function(n){return new b0e(this,n)};cr.prototype.slice=function(n,s){return n===void 0&&(n=0),s===void 0&&(s=this.length),n>=s?cr.empty:this.sliceInner(Math.max(0,n),Math.min(this.length,s))};cr.prototype.get=function(n){if(!(n<0||n>=this.length))return this.getInner(n)};cr.prototype.forEach=function(n,s,r){s===void 0&&(s=0),r===void 0&&(r=this.length),s<=r?this.forEachInner(n,s,r,0):this.forEachInvertedInner(n,s,r,0)};cr.prototype.map=function(n,s,r){s===void 0&&(s=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(l,o){return i.push(n(l,o))},s,r),i};cr.from=function(n){return n instanceof cr?n:n&&n.length?new i$(n):cr.empty};var i$=function(t){function n(r){t.call(this),this.values=r}t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n;var s={length:{configurable:!0},depth:{configurable:!0}};return n.prototype.flatten=function(){return this.values},n.prototype.sliceInner=function(i,l){return i==0&&l==this.length?this:new n(this.values.slice(i,l))},n.prototype.getInner=function(i){return this.values[i]},n.prototype.forEachInner=function(i,l,o,c){for(var d=l;d<o;d++)if(i(this.values[d],c+d)===!1)return!1},n.prototype.forEachInvertedInner=function(i,l,o,c){for(var d=l-1;d>=o;d--)if(i(this.values[d],c+d)===!1)return!1},n.prototype.leafAppend=function(i){if(this.length+i.length<=J1)return new n(this.values.concat(i.flatten()))},n.prototype.leafPrepend=function(i){if(this.length+i.length<=J1)return new n(i.flatten().concat(this.values))},s.length.get=function(){return this.values.length},s.depth.get=function(){return 0},Object.defineProperties(n.prototype,s),n}(cr);cr.empty=new i$([]);var b0e=function(t){function n(s,r){t.call(this),this.left=s,this.right=r,this.length=s.length+r.length,this.depth=Math.max(s.depth,r.depth)+1}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},n.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},n.prototype.forEachInner=function(r,i,l,o){var c=this.left.length;if(i<c&&this.left.forEachInner(r,i,Math.min(l,c),o)===!1||l>c&&this.right.forEachInner(r,Math.max(i-c,0),Math.min(this.length,l)-c,o+c)===!1)return!1},n.prototype.forEachInvertedInner=function(r,i,l,o){var c=this.left.length;if(i>c&&this.right.forEachInvertedInner(r,i-c,Math.max(l,c)-c,o+c)===!1||l<c&&this.left.forEachInvertedInner(r,Math.min(i,c),l,o)===!1)return!1},n.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var l=this.left.length;return i<=l?this.left.slice(r,i):r>=l?this.right.slice(r-l,i-l):this.left.slice(r,l).append(this.right.slice(0,i-l))},n.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new n(this.left,i)},n.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new n(i,this.right)},n.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new n(this.left,new n(this.right,r)):new n(this,r)},n}(cr);const v0e=500;class Wi{constructor(n,s){this.items=n,this.eventCount=s}popEvent(n,s){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,l;s&&(i=this.remapping(r,this.items.length),l=i.maps.length);let o=n.tr,c,d,u=[],h=[];return this.items.forEach((m,x)=>{if(!m.step){i||(i=this.remapping(r,x+1),l=i.maps.length),l--,h.push(m);return}if(i){h.push(new Jo(m.map));let b=m.step.map(i.slice(l)),w;b&&o.maybeStep(b).doc&&(w=o.mapping.maps[o.mapping.maps.length-1],u.push(new Jo(w,void 0,void 0,u.length+h.length))),l--,w&&i.appendMap(w,l)}else o.maybeStep(m.step);if(m.selection)return c=i?m.selection.map(i.slice(l)):m.selection,d=new Wi(this.items.slice(0,r).append(h.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:o,selection:c}}addTransform(n,s,r,i){let l=[],o=this.eventCount,c=this.items,d=!i&&c.length?c.get(c.length-1):null;for(let h=0;h<n.steps.length;h++){let m=n.steps[h].invert(n.docs[h]),x=new Jo(n.mapping.maps[h],m,s),b;(b=d&&d.merge(x))&&(x=b,h?l.pop():c=c.slice(0,c.length-1)),l.push(x),s&&(o++,s=void 0),i||(d=x)}let u=o-r.depth;return u>N0e&&(c=w0e(c,u),o-=u),new Wi(c.append(l),o)}remapping(n,s){let r=new Lp;return this.items.forEach((i,l)=>{let o=i.mirrorOffset!=null&&l-i.mirrorOffset>=n?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},n,s),r}addMaps(n){return this.eventCount==0?this:new Wi(this.items.append(n.map(s=>new Jo(s))),this.eventCount)}rebased(n,s){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-s),l=n.mapping,o=n.steps.length,c=this.eventCount;this.items.forEach(x=>{x.selection&&c--},i);let d=s;this.items.forEach(x=>{let b=l.getMirror(--d);if(b==null)return;o=Math.min(o,b);let w=l.maps[b];if(x.step){let j=n.steps[b].invert(n.docs[b]),S=x.selection&&x.selection.map(l.slice(d+1,b));S&&c++,r.push(new Jo(w,j,S))}else r.push(new Jo(w))},i);let u=[];for(let x=s;x<o;x++)u.push(new Jo(l.maps[x]));let h=this.items.slice(0,i).append(u).append(r),m=new Wi(h,c);return m.emptyItemCount()>v0e&&(m=m.compress(this.items.length-r.length)),m}emptyItemCount(){let n=0;return this.items.forEach(s=>{s.step||n++}),n}compress(n=this.items.length){let s=this.remapping(0,n),r=s.maps.length,i=[],l=0;return this.items.forEach((o,c)=>{if(c>=n)i.push(o),o.selection&&l++;else if(o.step){let d=o.step.map(s.slice(r)),u=d&&d.getMap();if(r--,u&&s.appendMap(u,r),d){let h=o.selection&&o.selection.map(s.slice(r));h&&l++;let m=new Jo(u.invert(),d,h),x,b=i.length-1;(x=i.length&&i[b].merge(m))?i[b]=x:i.push(m)}}else o.map&&r--},this.items.length,0),new Wi(cr.from(i.reverse()),l)}}Wi.empty=new Wi(cr.empty,0);function w0e(t,n){let s;return t.forEach((r,i)=>{if(r.selection&&n--==0)return s=i,!1}),t.slice(s)}let Jo=class l${constructor(n,s,r,i){this.map=n,this.step=s,this.selection=r,this.mirrorOffset=i}merge(n){if(this.step&&n.step&&!n.selection){let s=n.step.merge(this.step);if(s)return new l$(s.getMap().invert(),s,this.selection)}}};class oc{constructor(n,s,r,i,l){this.done=n,this.undone=s,this.prevRanges=r,this.prevTime=i,this.prevComposition=l}}const N0e=20;function j0e(t,n,s,r){let i=s.getMeta(Zd),l;if(i)return i.historyState;s.getMeta(C0e)&&(t=new oc(t.done,t.undone,null,0,-1));let o=s.getMeta("appendedTransaction");if(s.steps.length==0)return t;if(o&&o.getMeta(Zd))return o.getMeta(Zd).redo?new oc(t.done.addTransform(s,void 0,r,zg(n)),t.undone,EP(s.mapping.maps),t.prevTime,t.prevComposition):new oc(t.done,t.undone.addTransform(s,void 0,r,zg(n)),null,t.prevTime,t.prevComposition);if(s.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let c=s.getMeta("composition"),d=t.prevTime==0||!o&&t.prevComposition!=c&&(t.prevTime<(s.time||0)-r.newGroupDelay||!S0e(s,t.prevRanges)),u=o?XN(t.prevRanges,s.mapping):EP(s.mapping.maps);return new oc(t.done.addTransform(s,d?n.selection.getBookmark():void 0,r,zg(n)),Wi.empty,u,s.time,c??t.prevComposition)}else return(l=s.getMeta("rebased"))?new oc(t.done.rebased(s,l),t.undone.rebased(s,l),XN(t.prevRanges,s.mapping),t.prevTime,t.prevComposition):new oc(t.done.addMaps(s.mapping.maps),t.undone.addMaps(s.mapping.maps),XN(t.prevRanges,s.mapping),t.prevTime,t.prevComposition)}function S0e(t,n){if(!n)return!1;if(!t.docChanged)return!0;let s=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let l=0;l<n.length;l+=2)r<=n[l+1]&&i>=n[l]&&(s=!0)}),s}function EP(t){let n=[];for(let s=t.length-1;s>=0&&n.length==0;s--)t[s].forEach((r,i,l,o)=>n.push(l,o));return n}function XN(t,n){if(!t)return null;let s=[];for(let r=0;r<t.length;r+=2){let i=n.map(t[r],1),l=n.map(t[r+1],-1);i<=l&&s.push(i,l)}return s}function _0e(t,n,s){let r=zg(n),i=Zd.get(n).spec.config,l=(s?t.undone:t.done).popEvent(n,r);if(!l)return null;let o=l.selection.resolve(l.transform.doc),c=(s?t.done:t.undone).addTransform(l.transform,n.selection.getBookmark(),i,r),d=new oc(s?c:l.remaining,s?l.remaining:c,null,0,-1);return l.transform.setSelection(o).setMeta(Zd,{redo:s,historyState:d})}let QN=!1,TP=null;function zg(t){let n=t.plugins;if(TP!=n){QN=!1,TP=n;for(let s=0;s<n.length;s++)if(n[s].spec.historyPreserveItems){QN=!0;break}}return QN}const Zd=new Ss("history"),C0e=new Ss("closeHistory");function A0e(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new js({key:Zd,state:{init(){return new oc(Wi.empty,Wi.empty,null,0,-1)},apply(n,s,r){return j0e(s,r,n,t)}},config:t,props:{handleDOMEvents:{beforeinput(n,s){let r=s.inputType,i=r=="historyUndo"?c$:r=="historyRedo"?d$:null;return i?(s.preventDefault(),i(n.state,n.dispatch)):!1}}}})}function o$(t,n){return(s,r)=>{let i=Zd.getState(s);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let l=_0e(i,s,t);l&&r(n?l.scrollIntoView():l)}return!0}}const c$=o$(!1,!0),d$=o$(!0,!0),k0e=ra.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:n})=>c$(t,n),redo:()=>({state:t,dispatch:n})=>d$(t,n)}},addProseMirrorPlugins(){return[A0e(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),E0e=il.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Ca(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:n})=>{if(!Vxe(n,n.schema.nodes[this.name]))return!1;const{selection:s}=n,{$from:r,$to:i}=s,l=t();return r.parentOffset===0?l.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):vxe(s)?l.insertContentAt(i.pos,{type:this.name}):l.insertContent({type:this.name}),l.command(({tr:o,dispatch:c})=>{var d;if(c){const{$to:u}=o.selection,h=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(xt.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(vt.create(o.doc,u.pos)):o.setSelection(xt.create(o.doc,u.pos));else{const m=(d=u.parent.type.contentMatch.defaultType)===null||d===void 0?void 0:d.create();m&&(o.insert(h,m),o.setSelection(xt.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Uxe({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),T0e=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,I0e=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,P0e=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,M0e=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,O0e=mu.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[sh({find:T0e,type:this.type}),sh({find:P0e,type:this.type})]},addPasteRules(){return[rh({find:I0e,type:this.type}),rh({find:M0e,type:this.type})]}}),D0e=il.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Ca(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),R0e="listItem",IP="textStyle",PP=/^(\d+)\.\s$/,L0e=il.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:n,...s}=t;return n===1?["ol",Ca(this.options.HTMLAttributes,s),0]:["ol",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:n})=>this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(R0e,this.editor.getAttributes(IP)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Vp({find:PP,type:this.type,getAttributes:n=>({start:+n[1]}),joinPredicate:(n,s)=>s.childCount+s.attrs.start===+n[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Vp({find:PP,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:n=>({start:+n[1],...this.editor.getAttributes(IP)}),joinPredicate:(n,s)=>s.childCount+s.attrs.start===+n[1],editor:this.editor})),[t]}}),B0e=il.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),F0e=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,$0e=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,z0e=mu.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Ca(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[sh({find:F0e,type:this.type})]},addPasteRules(){return[rh({find:$0e,type:this.type})]}}),U0e=il.create({name:"text",group:"inline"});ra.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(Xxe.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(Wxe.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(Zxe.configure(this.options.bulletList)),this.options.code!==!1&&t.push(t0e.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(r0e.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(a0e.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(o0e.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(x0e.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(g0e.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(y0e.configure(this.options.heading)),this.options.history!==!1&&t.push(k0e.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(E0e.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(O0e.configure(this.options.italic)),this.options.listItem!==!1&&t.push(D0e.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(L0e.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(B0e.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(z0e.configure(this.options.strike)),this.options.text!==!1&&t.push(U0e.configure(this.options.text)),t}});var V0e=20,u$=(t,n=0)=>{const s=[];return!t.children.length||n>V0e||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?s.push(r):r.children.length&&s.push(...u$(r,n+1))}),s},H0e=t=>{if(!t.children.length)return;const n=u$(t);n&&n.forEach(s=>{var r,i;const l=s.getAttribute("style"),o=(i=(r=s.parentElement)==null?void 0:r.closest("span"))==null?void 0:i.getAttribute("style");s.setAttribute("style",`${o};${l}`)})},W0e=IA.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&H0e(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",sd(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:n})=>n.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:n}=t;return t.doc.nodesBetween(n.from,n.to,(s,r)=>{if(s.isTextblock)return!0;s.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(l=>!!l))||t.removeMark(r,r+s.nodeSize,this.type)}),!0}}}}),q0e=ur.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var n;const s=t.getAttribute("style");if(s){const r=s.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const l=r[i].split(":");if(l.length>=2){const o=l[0].trim().toLowerCase(),c=l.slice(1).join(":").trim();if(o==="background-color")return c.replace(/['"]+/g,"")}}}return(n=t.style.backgroundColor)==null?void 0:n.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:n})=>n().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),G0e=ur.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var n;const s=t.getAttribute("style");if(s){const r=s.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const l=r[i].split(":");if(l.length>=2){const o=l[0].trim().toLowerCase(),c=l.slice(1).join(":").trim();if(o==="color")return c.replace(/['"]+/g,"")}}}return(n=t.style.color)==null?void 0:n.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:n})=>n().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),K0e=ur.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:n})=>n().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),Y0e=ur.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:n})=>n().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),X0e=ur.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:n})=>n().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});ur.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(q0e.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(G0e.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(K0e.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(Y0e.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(X0e.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(W0e.configure(this.options.textStyle)),t}});IA.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",sd(this.options.HTMLAttributes,t),0]},parseMarkdown(t,n){return n.applyMark(this.name||"underline",n.parseInline(t.tokens||[]))},renderMarkdown(t,n){return`++${n.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,n,s){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const l=i[2].trim();return{type:"underline",raw:i[0],text:l,tokens:s.inlineTokens(l)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var Q0e=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,Z0e=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g;IA.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",sd(this.options.HTMLAttributes,t),0]},renderMarkdown:(t,n)=>`==${n.renderChildren(t)}==`,parseMarkdown:(t,n)=>n.applyMark("highlight",n.parseInline(t.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:t=>t.indexOf("=="),tokenize(t,n,s){const i=/^(==)([^=]+)(==)/.exec(t);if(i){const l=i[2].trim(),o=s.inlineTokens(l);return{type:"highlight",raw:i[0],text:l,tokens:o}}}},addCommands(){return{setHighlight:t=>({commands:n})=>n.setMark(this.name,t),toggleHighlight:t=>({commands:n})=>n.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[spe({find:Q0e,type:this.type})]},addPasteRules(){return[ppe({find:Z0e,type:this.type})]}});ur.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const n=t.style.textAlign;return this.options.alignments.includes(n)?n:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:n})=>this.options.alignments.includes(t)?this.options.types.map(s=>n.updateAttributes(s,{textAlign:t})).every(s=>s):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(n=>t.resetAttributes(n,"textAlign")).every(n=>n),toggleTextAlign:t=>({editor:n,commands:s})=>this.options.alignments.includes(t)?n.isActive({textAlign:t})?s.unsetTextAlign():s.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});var J0e=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/;kx.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",sd(this.options.HTMLAttributes,t)]},parseMarkdown:(t,n)=>n.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var n,s,r,i,l,o;const c=(s=(n=t.attrs)==null?void 0:n.src)!=null?s:"",d=(i=(r=t.attrs)==null?void 0:r.alt)!=null?i:"",u=(o=(l=t.attrs)==null?void 0:l.title)!=null?o:"";return u?`![${d}](${c} "${u}")`:`![${d}](${c})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:t,minWidth:n,minHeight:s,alwaysPreserveAspectRatio:r}=this.options.resize;return({node:i,getPos:l,HTMLAttributes:o,editor:c})=>{const d=document.createElement("img");Object.entries(o).forEach(([m,x])=>{if(x!=null)switch(m){case"width":case"height":break;default:d.setAttribute(m,x);break}}),d.src=o.src;const u=new ipe({element:d,editor:c,node:i,getPos:l,onResize:(m,x)=>{d.style.width=`${m}px`,d.style.height=`${x}px`},onCommit:(m,x)=>{const b=l();b!==void 0&&this.editor.chain().setNodeSelection(b).updateAttributes(this.name,{width:m,height:x}).run()},onUpdate:(m,x,b)=>m.type===i.type,options:{directions:t,min:{width:n,height:s},preserveAspectRatio:r===!0}}),h=u.dom;return h.style.visibility="hidden",h.style.pointerEvents="none",d.onload=()=>{h.style.visibility="",h.style.pointerEvents=""},u}},addCommands(){return{setImage:t=>({commands:n})=>n.insertContent({type:this.name,attrs:t})}},addInputRules(){return[rpe({find:J0e,type:this.type,getAttributes:t=>{const[,,n,s,r]=t;return{src:s,alt:n,title:r}}})]}});var KS,YS;if(typeof WeakMap<"u"){let t=new WeakMap;KS=n=>t.get(n),YS=(n,s)=>(t.set(n,s),s)}else{const t=[];let s=0;KS=r=>{for(let i=0;i<t.length;i+=2)if(t[i]==r)return t[i+1]},YS=(r,i)=>(s==10&&(s=0),t[s++]=r,t[s++]=i)}var ms=class{constructor(t,n,s,r){this.width=t,this.height=n,this.map=s,this.problems=r}findCell(t){for(let n=0;n<this.map.length;n++){const s=this.map[n];if(s!=t)continue;const r=n%this.width,i=n/this.width|0;let l=r+1,o=i+1;for(let c=1;l<this.width&&this.map[n+c]==s;c++)l++;for(let c=1;o<this.height&&this.map[n+this.width*c]==s;c++)o++;return{left:r,top:i,right:l,bottom:o}}throw new RangeError(`No cell with offset ${t} found`)}colCount(t){for(let n=0;n<this.map.length;n++)if(this.map[n]==t)return n%this.width;throw new RangeError(`No cell with offset ${t} found`)}nextCell(t,n,s){const{left:r,right:i,top:l,bottom:o}=this.findCell(t);return n=="horiz"?(s<0?r==0:i==this.width)?null:this.map[l*this.width+(s<0?r-1:i)]:(s<0?l==0:o==this.height)?null:this.map[r+this.width*(s<0?l-1:o)]}rectBetween(t,n){const{left:s,right:r,top:i,bottom:l}=this.findCell(t),{left:o,right:c,top:d,bottom:u}=this.findCell(n);return{left:Math.min(s,o),top:Math.min(i,d),right:Math.max(r,c),bottom:Math.max(l,u)}}cellsInRect(t){const n=[],s={};for(let r=t.top;r<t.bottom;r++)for(let i=t.left;i<t.right;i++){const l=r*this.width+i,o=this.map[l];s[o]||(s[o]=!0,!(i==t.left&&i&&this.map[l-1]==o||r==t.top&&r&&this.map[l-this.width]==o)&&n.push(o))}return n}positionAt(t,n,s){for(let r=0,i=0;;r++){const l=i+s.child(r).nodeSize;if(r==t){let o=n+t*this.width;const c=(t+1)*this.width;for(;o<c&&this.map[o]<i;)o++;return o==c?l-1:this.map[o]}i=l}}static get(t){return KS(t)||YS(t,ege(t))}};function ege(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const n=tge(t),s=t.childCount,r=[];let i=0,l=null;const o=[];for(let u=0,h=n*s;u<h;u++)r[u]=0;for(let u=0,h=0;u<s;u++){const m=t.child(u);h++;for(let w=0;;w++){for(;i<r.length&&r[i]!=0;)i++;if(w==m.childCount)break;const j=m.child(w),{colspan:S,rowspan:C,colwidth:A}=j.attrs;for(let k=0;k<C;k++){if(k+u>=s){(l||(l=[])).push({type:"overlong_rowspan",pos:h,n:C-k});break}const T=i+k*n;for(let I=0;I<S;I++){r[T+I]==0?r[T+I]=h:(l||(l=[])).push({type:"collision",row:u,pos:h,n:S-I});const D=A&&A[I];if(D){const O=(T+I)%n*2,R=o[O];R==null||R!=D&&o[O+1]==1?(o[O]=D,o[O+1]=1):R==D&&o[O+1]++}}}i+=S,h+=j.nodeSize}const x=(u+1)*n;let b=0;for(;i<x;)r[i++]==0&&b++;b&&(l||(l=[])).push({type:"missing",row:u,n:b}),h++}(n===0||s===0)&&(l||(l=[])).push({type:"zero_sized"});const c=new ms(n,s,r,l);let d=!1;for(let u=0;!d&&u<o.length;u+=2)o[u]!=null&&o[u+1]<s&&(d=!0);return d&&nge(c,o,t),c}function tge(t){let n=-1,s=!1;for(let r=0;r<t.childCount;r++){const i=t.child(r);let l=0;if(s)for(let o=0;o<r;o++){const c=t.child(o);for(let d=0;d<c.childCount;d++){const u=c.child(d);o+u.attrs.rowspan>r&&(l+=u.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const c=i.child(o);l+=c.attrs.colspan,c.attrs.rowspan>1&&(s=!0)}n==-1?n=l:n!=l&&(n=Math.max(n,l))}return n}function nge(t,n,s){t.problems||(t.problems=[]);const r={};for(let i=0;i<t.map.length;i++){const l=t.map[i];if(r[l])continue;r[l]=!0;const o=s.nodeAt(l);if(!o)throw new RangeError(`No cell with offset ${l} found`);let c=null;const d=o.attrs;for(let u=0;u<d.colspan;u++){const h=(i+u)%t.width,m=n[h*2];m!=null&&(!d.colwidth||d.colwidth[u]!=m)&&((c||(c=sge(d)))[u]=m)}c&&t.problems.unshift({type:"colwidth mismatch",pos:l,colwidth:c})}}function sge(t){if(t.colwidth)return t.colwidth.slice();const n=[];for(let s=0;s<t.colspan;s++)n.push(0);return n}function Kr(t){let n=t.cached.tableNodeTypes;if(!n){n=t.cached.tableNodeTypes={};for(const s in t.nodes){const r=t.nodes[s],i=r.spec.tableRole;i&&(n[i]=r)}}return n}var hc=new Ss("selectingCells");function Th(t){for(let n=t.depth-1;n>0;n--)if(t.node(n).type.spec.tableRole=="row")return t.node(0).resolve(t.before(n+1));return null}function rge(t){for(let n=t.depth;n>0;n--){const s=t.node(n).type.spec.tableRole;if(s==="cell"||s==="header_cell")return t.node(n)}return null}function ll(t){const n=t.selection.$head;for(let s=n.depth;s>0;s--)if(n.node(s).type.spec.tableRole=="row")return!0;return!1}function qb(t){const n=t.selection;if("$anchorCell"in n&&n.$anchorCell)return n.$anchorCell.pos>n.$headCell.pos?n.$anchorCell:n.$headCell;if("node"in n&&n.node&&n.node.type.spec.tableRole=="cell")return n.$anchor;const s=Th(n.$head)||age(n.$head);if(s)return s;throw new RangeError(`No cell found around position ${n.head}`)}function age(t){for(let n=t.nodeAfter,s=t.pos;n;n=n.firstChild,s++){const r=n.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(s)}for(let n=t.nodeBefore,s=t.pos;n;n=n.lastChild,s--){const r=n.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(s-n.nodeSize)}}function XS(t){return t.parent.type.spec.tableRole=="row"&&!!t.nodeAfter}function ige(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function FA(t,n){return t.depth==n.depth&&t.pos>=n.start(-1)&&t.pos<=n.end(-1)}function f$(t,n,s){const r=t.node(-1),i=ms.get(r),l=t.start(-1),o=i.nextCell(t.pos-l,n,s);return o==null?null:t.node(0).resolve(l+o)}function pu(t,n,s=1){const r={...t,colspan:t.colspan-s};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(n,s),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function h$(t,n,s=1){const r={...t,colspan:t.colspan+s};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<s;i++)r.colwidth.splice(n,0,0)}return r}function lge(t,n,s){const r=Kr(n.type.schema).header_cell;for(let i=0;i<t.height;i++)if(n.nodeAt(t.map[s+i*t.width]).type!=r)return!1;return!0}var Rn=class so extends At{constructor(n,s=n){const r=n.node(-1),i=ms.get(r),l=n.start(-1),o=i.rectBetween(n.pos-l,s.pos-l),c=n.node(0),d=i.cellsInRect(o).filter(h=>h!=s.pos-l);d.unshift(s.pos-l);const u=d.map(h=>{const m=r.nodeAt(h);if(!m)throw RangeError(`No cell with offset ${h} found`);const x=l+h+1;return new U9(c.resolve(x),c.resolve(x+m.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=n,this.$headCell=s}map(n,s){const r=n.resolve(s.map(this.$anchorCell.pos)),i=n.resolve(s.map(this.$headCell.pos));if(XS(r)&&XS(i)&&FA(r,i)){const l=this.$anchorCell.node(-1)!=r.node(-1);return l&&this.isRowSelection()?so.rowSelection(r,i):l&&this.isColSelection()?so.colSelection(r,i):new so(r,i)}return xt.between(r,i)}content(){const n=this.$anchorCell.node(-1),s=ms.get(n),r=this.$anchorCell.start(-1),i=s.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),l={},o=[];for(let d=i.top;d<i.bottom;d++){const u=[];for(let h=d*s.width+i.left,m=i.left;m<i.right;m++,h++){const x=s.map[h];if(l[x])continue;l[x]=!0;const b=s.findCell(x);let w=n.nodeAt(x);if(!w)throw RangeError(`No cell with offset ${x} found`);const j=i.left-b.left,S=b.right-i.right;if(j>0||S>0){let C=w.attrs;if(j>0&&(C=pu(C,0,j)),S>0&&(C=pu(C,C.colspan-S,S)),b.left<i.left){if(w=w.type.createAndFill(C),!w)throw RangeError(`Could not create cell with attrs ${JSON.stringify(C)}`)}else w=w.type.create(C,w.content)}if(b.top<i.top||b.bottom>i.bottom){const C={...w.attrs,rowspan:Math.min(b.bottom,i.bottom)-Math.max(b.top,i.top)};b.top<i.top?w=w.type.createAndFill(C):w=w.type.create(C,w.content)}u.push(w)}o.push(n.child(d).copy(Oe.from(u)))}const c=this.isColSelection()&&this.isRowSelection()?n:o;return new tt(Oe.from(c),1,1)}replace(n,s=tt.empty){const r=n.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:c,$to:d}=i[o],u=n.mapping.slice(r);n.replace(u.map(c.pos),u.map(d.pos),o?tt.empty:s)}const l=At.findFrom(n.doc.resolve(n.mapping.slice(r).map(this.to)),-1);l&&n.setSelection(l)}replaceWith(n,s){this.replace(n,new tt(Oe.from(s),0,0))}forEachCell(n){const s=this.$anchorCell.node(-1),r=ms.get(s),i=this.$anchorCell.start(-1),l=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<l.length;o++)n(s.nodeAt(l[o]),i+l[o])}isColSelection(){const n=this.$anchorCell.index(-1),s=this.$headCell.index(-1);if(Math.min(n,s)>0)return!1;const r=n+this.$anchorCell.nodeAfter.attrs.rowspan,i=s+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(n,s=n){const r=n.node(-1),i=ms.get(r),l=n.start(-1),o=i.findCell(n.pos-l),c=i.findCell(s.pos-l),d=n.node(0);return o.top<=c.top?(o.top>0&&(n=d.resolve(l+i.map[o.left])),c.bottom<i.height&&(s=d.resolve(l+i.map[i.width*(i.height-1)+c.right-1]))):(c.top>0&&(s=d.resolve(l+i.map[c.left])),o.bottom<i.height&&(n=d.resolve(l+i.map[i.width*(i.height-1)+o.right-1]))),new so(n,s)}isRowSelection(){const n=this.$anchorCell.node(-1),s=ms.get(n),r=this.$anchorCell.start(-1),i=s.colCount(this.$anchorCell.pos-r),l=s.colCount(this.$headCell.pos-r);if(Math.min(i,l)>0)return!1;const o=i+this.$anchorCell.nodeAfter.attrs.colspan,c=l+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,c)==s.width}eq(n){return n instanceof so&&n.$anchorCell.pos==this.$anchorCell.pos&&n.$headCell.pos==this.$headCell.pos}static rowSelection(n,s=n){const r=n.node(-1),i=ms.get(r),l=n.start(-1),o=i.findCell(n.pos-l),c=i.findCell(s.pos-l),d=n.node(0);return o.left<=c.left?(o.left>0&&(n=d.resolve(l+i.map[o.top*i.width])),c.right<i.width&&(s=d.resolve(l+i.map[i.width*(c.top+1)-1]))):(c.left>0&&(s=d.resolve(l+i.map[c.top*i.width])),o.right<i.width&&(n=d.resolve(l+i.map[i.width*(o.top+1)-1]))),new so(n,s)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(n,s){return new so(n.resolve(s.anchor),n.resolve(s.head))}static create(n,s,r=s){return new so(n.resolve(s),n.resolve(r))}getBookmark(){return new oge(this.$anchorCell.pos,this.$headCell.pos)}};Rn.prototype.visible=!1;At.jsonID("cell",Rn);var oge=class m${constructor(n,s){this.anchor=n,this.head=s}map(n){return new m$(n.map(this.anchor),n.map(this.head))}resolve(n){const s=n.resolve(this.anchor),r=n.resolve(this.head);return s.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&s.index()<s.parent.childCount&&r.index()<r.parent.childCount&&FA(s,r)?new Rn(s,r):At.near(r,1)}};function cge(t){if(!(t.selection instanceof Rn))return null;const n=[];return t.selection.forEachCell((s,r)=>{n.push(Va.node(r,r+s.nodeSize,{class:"selectedCell"}))}),bs.create(t.doc,n)}function dge({$from:t,$to:n}){if(t.pos==n.pos||t.pos<n.pos-6)return!1;let s=t.pos,r=n.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,s++);for(let l=n.depth;l>=0&&!(n.before(l+1)>n.start(l));l--,r--);return s==r&&/row|table/.test(t.node(i).type.spec.tableRole)}function uge({$from:t,$to:n}){let s,r;for(let i=t.depth;i>0;i--){const l=t.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){s=l;break}}for(let i=n.depth;i>0;i--){const l=n.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){r=l;break}}return s!==r&&n.parentOffset===0}function fge(t,n,s){const r=(n||t).selection,i=(n||t).doc;let l,o;if(r instanceof vt&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")l=Rn.create(i,r.from);else if(o=="row"){const c=i.resolve(r.from+1);l=Rn.rowSelection(c,c)}else if(!s){const c=ms.get(r.node),d=r.from+1,u=d+c.map[c.width*c.height-1];l=Rn.create(i,d+1,u)}}else r instanceof xt&&dge(r)?l=xt.create(i,r.from):r instanceof xt&&uge(r)&&(l=xt.create(i,r.$from.start(),r.$from.end()));return l&&(n||(n=t.tr)).setSelection(l),n}var hge=new Ss("fix-tables");function p$(t,n,s,r){const i=t.childCount,l=n.childCount;e:for(let o=0,c=0;o<l;o++){const d=n.child(o);for(let u=c,h=Math.min(i,o+3);u<h;u++)if(t.child(u)==d){c=u+1,s+=d.nodeSize;continue e}r(d,s),c<i&&t.child(c).sameMarkup(d)?p$(t.child(c),d,s+1,r):d.nodesBetween(0,d.content.size,r,s+1),s+=d.nodeSize}}function x$(t,n){let s;const r=(i,l)=>{i.type.spec.tableRole=="table"&&(s=mge(t,i,l,s))};return n?n.doc!=t.doc&&p$(n.doc,t.doc,0,r):t.doc.descendants(r),s}function mge(t,n,s,r){const i=ms.get(n);if(!i.problems)return r;r||(r=t.tr);const l=[];for(let d=0;d<i.height;d++)l.push(0);for(let d=0;d<i.problems.length;d++){const u=i.problems[d];if(u.type=="collision"){const h=n.nodeAt(u.pos);if(!h)continue;const m=h.attrs;for(let x=0;x<m.rowspan;x++)l[u.row+x]+=u.n;r.setNodeMarkup(r.mapping.map(s+1+u.pos),null,pu(m,m.colspan-u.n,u.n))}else if(u.type=="missing")l[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const h=n.nodeAt(u.pos);if(!h)continue;r.setNodeMarkup(r.mapping.map(s+1+u.pos),null,{...h.attrs,rowspan:h.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const h=n.nodeAt(u.pos);if(!h)continue;r.setNodeMarkup(r.mapping.map(s+1+u.pos),null,{...h.attrs,colwidth:u.colwidth})}else if(u.type=="zero_sized"){const h=r.mapping.map(s);r.delete(h,h+n.nodeSize)}}let o,c;for(let d=0;d<l.length;d++)l[d]&&(o==null&&(o=d),c=d);for(let d=0,u=s+1;d<i.height;d++){const h=n.child(d),m=u+h.nodeSize,x=l[d];if(x>0){let b="cell";h.firstChild&&(b=h.firstChild.type.spec.tableRole);const w=[];for(let S=0;S<x;S++){const C=Kr(t.schema)[b].createAndFill();C&&w.push(C)}const j=(d==0||o==d-1)&&c==d?u+1:m-1;r.insert(r.mapping.map(j),w)}u=m}return r.setMeta(hge,{fixTables:!0})}function ql(t){const n=t.selection,s=qb(t),r=s.node(-1),i=s.start(-1),l=ms.get(r);return{...n instanceof Rn?l.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):l.findCell(s.pos-i),tableStart:i,map:l,table:r}}function g$(t,{map:n,tableStart:s,table:r},i){let l=i>0?-1:0;lge(n,r,i+l)&&(l=i==0||i==n.width?null:0);for(let o=0;o<n.height;o++){const c=o*n.width+i;if(i>0&&i<n.width&&n.map[c-1]==n.map[c]){const d=n.map[c],u=r.nodeAt(d);t.setNodeMarkup(t.mapping.map(s+d),null,h$(u.attrs,i-n.colCount(d))),o+=u.attrs.rowspan-1}else{const d=l==null?Kr(r.type.schema).cell:r.nodeAt(n.map[c+l]).type,u=n.positionAt(o,i,r);t.insert(t.mapping.map(s+u),d.createAndFill())}}return t}function pge(t,n){if(!ll(t))return!1;if(n){const s=ql(t);n(g$(t.tr,s,s.left))}return!0}function xge(t,n){if(!ll(t))return!1;if(n){const s=ql(t);n(g$(t.tr,s,s.right))}return!0}function gge(t,{map:n,table:s,tableStart:r},i){const l=t.mapping.maps.length;for(let o=0;o<n.height;){const c=o*n.width+i,d=n.map[c],u=s.nodeAt(d),h=u.attrs;if(i>0&&n.map[c-1]==d||i<n.width-1&&n.map[c+1]==d)t.setNodeMarkup(t.mapping.slice(l).map(r+d),null,pu(h,i-n.colCount(d)));else{const m=t.mapping.slice(l).map(r+d);t.delete(m,m+u.nodeSize)}o+=h.rowspan}}function yge(t,n){if(!ll(t))return!1;if(n){const s=ql(t),r=t.tr;if(s.left==0&&s.right==s.map.width)return!1;for(let i=s.right-1;gge(r,s,i),i!=s.left;i--){const l=s.tableStart?r.doc.nodeAt(s.tableStart-1):r.doc;if(!l)throw RangeError("No table found");s.table=l,s.map=ms.get(l)}n(r)}return!0}function bge(t,n,s){var r;const i=Kr(n.type.schema).header_cell;for(let l=0;l<t.width;l++)if(((r=n.nodeAt(t.map[l+s*t.width]))==null?void 0:r.type)!=i)return!1;return!0}function y$(t,{map:n,tableStart:s,table:r},i){var l;let o=s;for(let u=0;u<i;u++)o+=r.child(u).nodeSize;const c=[];let d=i>0?-1:0;bge(n,r,i+d)&&(d=i==0||i==n.height?null:0);for(let u=0,h=n.width*i;u<n.width;u++,h++)if(i>0&&i<n.height&&n.map[h]==n.map[h-n.width]){const m=n.map[h],x=r.nodeAt(m).attrs;t.setNodeMarkup(s+m,null,{...x,rowspan:x.rowspan+1}),u+=x.colspan-1}else{const m=d==null?Kr(r.type.schema).cell:(l=r.nodeAt(n.map[h+d*n.width]))==null?void 0:l.type,x=m==null?void 0:m.createAndFill();x&&c.push(x)}return t.insert(o,Kr(r.type.schema).row.create(null,c)),t}function vge(t,n){if(!ll(t))return!1;if(n){const s=ql(t);n(y$(t.tr,s,s.top))}return!0}function wge(t,n){if(!ll(t))return!1;if(n){const s=ql(t);n(y$(t.tr,s,s.bottom))}return!0}function Nge(t,{map:n,table:s,tableStart:r},i){let l=0;for(let u=0;u<i;u++)l+=s.child(u).nodeSize;const o=l+s.child(i).nodeSize,c=t.mapping.maps.length;t.delete(l+r,o+r);const d=new Set;for(let u=0,h=i*n.width;u<n.width;u++,h++){const m=n.map[h];if(!d.has(m)){if(d.add(m),i>0&&m==n.map[h-n.width]){const x=s.nodeAt(m).attrs;t.setNodeMarkup(t.mapping.slice(c).map(m+r),null,{...x,rowspan:x.rowspan-1}),u+=x.colspan-1}else if(i<n.height&&m==n.map[h+n.width]){const x=s.nodeAt(m),b=x.attrs,w=x.type.create({...b,rowspan:x.attrs.rowspan-1},x.content),j=n.positionAt(i+1,u,s);t.insert(t.mapping.slice(c).map(r+j),w),u+=b.colspan-1}}}}function jge(t,n){if(!ll(t))return!1;if(n){const s=ql(t),r=t.tr;if(s.top==0&&s.bottom==s.map.height)return!1;for(let i=s.bottom-1;Nge(r,s,i),i!=s.top;i--){const l=s.tableStart?r.doc.nodeAt(s.tableStart-1):r.doc;if(!l)throw RangeError("No table found");s.table=l,s.map=ms.get(s.table)}n(r)}return!0}function MP(t){const n=t.content;return n.childCount==1&&n.child(0).isTextblock&&n.child(0).childCount==0}function Sge({width:t,height:n,map:s},r){let i=r.top*t+r.left,l=i,o=(r.bottom-1)*t+r.left,c=i+(r.right-r.left-1);for(let d=r.top;d<r.bottom;d++){if(r.left>0&&s[l]==s[l-1]||r.right<t&&s[c]==s[c+1])return!0;l+=t,c+=t}for(let d=r.left;d<r.right;d++){if(r.top>0&&s[i]==s[i-t]||r.bottom<n&&s[o]==s[o+t])return!0;i++,o++}return!1}function OP(t,n){const s=t.selection;if(!(s instanceof Rn)||s.$anchorCell.pos==s.$headCell.pos)return!1;const r=ql(t),{map:i}=r;if(Sge(i,r))return!1;if(n){const l=t.tr,o={};let c=Oe.empty,d,u;for(let h=r.top;h<r.bottom;h++)for(let m=r.left;m<r.right;m++){const x=i.map[h*i.width+m],b=r.table.nodeAt(x);if(!(o[x]||!b))if(o[x]=!0,d==null)d=x,u=b;else{MP(b)||(c=c.append(b.content));const w=l.mapping.map(x+r.tableStart);l.delete(w,w+b.nodeSize)}}if(d==null||u==null)return!0;if(l.setNodeMarkup(d+r.tableStart,null,{...h$(u.attrs,u.attrs.colspan,r.right-r.left-u.attrs.colspan),rowspan:r.bottom-r.top}),c.size){const h=d+1+u.content.size,m=MP(u)?d+1:h;l.replaceWith(m+r.tableStart,h+r.tableStart,c)}l.setSelection(new Rn(l.doc.resolve(d+r.tableStart))),n(l)}return!0}function DP(t,n){const s=Kr(t.schema);return _ge(({node:r})=>s[r.type.spec.tableRole])(t,n)}function _ge(t){return(n,s)=>{var r;const i=n.selection;let l,o;if(i instanceof Rn){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;l=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(l=rge(i.$from),!l)return!1;o=(r=Th(i.$from))==null?void 0:r.pos}if(l==null||o==null||l.attrs.colspan==1&&l.attrs.rowspan==1)return!1;if(s){let c=l.attrs;const d=[],u=c.colwidth;c.rowspan>1&&(c={...c,rowspan:1}),c.colspan>1&&(c={...c,colspan:1});const h=ql(n),m=n.tr;for(let b=0;b<h.right-h.left;b++)d.push(u?{...c,colwidth:u&&u[b]?[u[b]]:null}:c);let x;for(let b=h.top;b<h.bottom;b++){let w=h.map.positionAt(b,h.left,h.table);b==h.top&&(w+=l.nodeSize);for(let j=h.left,S=0;j<h.right;j++,S++)j==h.left&&b==h.top||m.insert(x=m.mapping.map(w+h.tableStart,1),t({node:l,row:b,col:j}).createAndFill(d[S]))}m.setNodeMarkup(o,t({node:l,row:h.top,col:h.left}),d[0]),i instanceof Rn&&m.setSelection(new Rn(m.doc.resolve(i.$anchorCell.pos),x?m.doc.resolve(x):void 0)),s(m)}return!0}}function Cge(t,n){return function(s,r){if(!ll(s))return!1;const i=qb(s);if(i.nodeAfter.attrs[t]===n)return!1;if(r){const l=s.tr;s.selection instanceof Rn?s.selection.forEachCell((o,c)=>{o.attrs[t]!==n&&l.setNodeMarkup(c,null,{...o.attrs,[t]:n})}):l.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[t]:n}),r(l)}return!0}}function Age(t){return function(n,s){if(!ll(n))return!1;if(s){const r=Kr(n.schema),i=ql(n),l=n.tr,o=i.map.cellsInRect(t=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:t=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),c=o.map(d=>i.table.nodeAt(d));for(let d=0;d<o.length;d++)c[d].type==r.header_cell&&l.setNodeMarkup(i.tableStart+o[d],r.cell,c[d].attrs);if(l.steps.length==0)for(let d=0;d<o.length;d++)l.setNodeMarkup(i.tableStart+o[d],r.header_cell,c[d].attrs);s(l)}return!0}}function RP(t,n,s){const r=n.map.cellsInRect({left:0,top:0,right:t=="row"?n.map.width:1,bottom:t=="column"?n.map.height:1});for(let i=0;i<r.length;i++){const l=n.table.nodeAt(r[i]);if(l&&l.type!==s.header_cell)return!1}return!0}function Hp(t,n){return n=n||{useDeprecatedLogic:!1},n.useDeprecatedLogic?Age(t):function(s,r){if(!ll(s))return!1;if(r){const i=Kr(s.schema),l=ql(s),o=s.tr,c=RP("row",l,i),d=RP("column",l,i),h=(t==="column"?c:t==="row"?d:!1)?1:0,m=t=="column"?{left:0,top:h,right:1,bottom:l.map.height}:t=="row"?{left:h,top:0,right:l.map.width,bottom:1}:l,x=t=="column"?d?i.cell:i.header_cell:t=="row"?c?i.cell:i.header_cell:i.cell;l.map.cellsInRect(m).forEach(b=>{const w=b+l.tableStart,j=o.doc.nodeAt(w);j&&o.setNodeMarkup(w,x,j.attrs)}),r(o)}return!0}}Hp("row",{useDeprecatedLogic:!0});Hp("column",{useDeprecatedLogic:!0});var kge=Hp("cell",{useDeprecatedLogic:!0});function Ege(t,n){if(n<0){const s=t.nodeBefore;if(s)return t.pos-s.nodeSize;for(let r=t.index(-1)-1,i=t.before();r>=0;r--){const l=t.node(-1).child(r),o=l.lastChild;if(o)return i-1-o.nodeSize;i-=l.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const s=t.node(-1);for(let r=t.indexAfter(-1),i=t.after();r<s.childCount;r++){const l=s.child(r);if(l.childCount)return i+1;i+=l.nodeSize}}return null}function LP(t){return function(n,s){if(!ll(n))return!1;const r=Ege(qb(n),t);if(r==null)return!1;if(s){const i=n.doc.resolve(r);s(n.tr.setSelection(xt.between(i,ige(i))).scrollIntoView())}return!0}}function Tge(t,n){const s=t.selection.$anchor;for(let r=s.depth;r>0;r--)if(s.node(r).type.spec.tableRole=="table")return n&&n(t.tr.delete(s.before(r),s.after(r)).scrollIntoView()),!0;return!1}function $0(t,n){const s=t.selection;if(!(s instanceof Rn))return!1;if(n){const r=t.tr,i=Kr(t.schema).cell.createAndFill().content;s.forEachCell((l,o)=>{l.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+l.nodeSize-1),new tt(i,0,0))}),r.docChanged&&n(r)}return!0}function Ige(t){if(!t.size)return null;let{content:n,openStart:s,openEnd:r}=t;for(;n.childCount==1&&(s>0&&r>0||n.child(0).type.spec.tableRole=="table");)s--,r--,n=n.child(0).content;const i=n.child(0),l=i.type.spec.tableRole,o=i.type.schema,c=[];if(l=="row")for(let d=0;d<n.childCount;d++){let u=n.child(d).content;const h=d?0:Math.max(0,s-1),m=d<n.childCount-1?0:Math.max(0,r-1);(h||m)&&(u=QS(Kr(o).row,new tt(u,h,m)).content),c.push(u)}else if(l=="cell"||l=="header_cell")c.push(s||r?QS(Kr(o).row,new tt(n,s,r)).content:n);else return null;return Pge(o,c)}function Pge(t,n){const s=[];for(let i=0;i<n.length;i++){const l=n[i];for(let o=l.childCount-1;o>=0;o--){const{rowspan:c,colspan:d}=l.child(o).attrs;for(let u=i;u<i+c;u++)s[u]=(s[u]||0)+d}}let r=0;for(let i=0;i<s.length;i++)r=Math.max(r,s[i]);for(let i=0;i<s.length;i++)if(i>=n.length&&n.push(Oe.empty),s[i]<r){const l=Kr(t).cell.createAndFill(),o=[];for(let c=s[i];c<r;c++)o.push(l);n[i]=n[i].append(Oe.from(o))}return{height:n.length,width:r,rows:n}}function QS(t,n){const s=t.createAndFill();return new z9(s).replace(0,s.content.size,n).doc}function Mge({width:t,height:n,rows:s},r,i){if(t!=r){const l=[],o=[];for(let c=0;c<s.length;c++){const d=s[c],u=[];for(let h=l[c]||0,m=0;h<r;m++){let x=d.child(m%d.childCount);h+x.attrs.colspan>r&&(x=x.type.createChecked(pu(x.attrs,x.attrs.colspan,h+x.attrs.colspan-r),x.content)),u.push(x),h+=x.attrs.colspan;for(let b=1;b<x.attrs.rowspan;b++)l[c+b]=(l[c+b]||0)+x.attrs.colspan}o.push(Oe.from(u))}s=o,t=r}if(n!=i){const l=[];for(let o=0,c=0;o<i;o++,c++){const d=[],u=s[c%n];for(let h=0;h<u.childCount;h++){let m=u.child(h);o+m.attrs.rowspan>i&&(m=m.type.create({...m.attrs,rowspan:Math.max(1,i-m.attrs.rowspan)},m.content)),d.push(m)}l.push(Oe.from(d))}s=l,n=i}return{width:t,height:n,rows:s}}function Oge(t,n,s,r,i,l,o){const c=t.doc.type.schema,d=Kr(c);let u,h;if(i>n.width)for(let m=0,x=0;m<n.height;m++){const b=s.child(m);x+=b.nodeSize;const w=[];let j;b.lastChild==null||b.lastChild.type==d.cell?j=u||(u=d.cell.createAndFill()):j=h||(h=d.header_cell.createAndFill());for(let S=n.width;S<i;S++)w.push(j);t.insert(t.mapping.slice(o).map(x-1+r),w)}if(l>n.height){const m=[];for(let w=0,j=(n.height-1)*n.width;w<Math.max(n.width,i);w++){const S=w>=n.width?!1:s.nodeAt(n.map[j+w]).type==d.header_cell;m.push(S?h||(h=d.header_cell.createAndFill()):u||(u=d.cell.createAndFill()))}const x=d.row.create(null,Oe.from(m)),b=[];for(let w=n.height;w<l;w++)b.push(x);t.insert(t.mapping.slice(o).map(r+s.nodeSize-2),b)}return!!(u||h)}function BP(t,n,s,r,i,l,o,c){if(o==0||o==n.height)return!1;let d=!1;for(let u=i;u<l;u++){const h=o*n.width+u,m=n.map[h];if(n.map[h-n.width]==m){d=!0;const x=s.nodeAt(m),{top:b,left:w}=n.findCell(m);t.setNodeMarkup(t.mapping.slice(c).map(m+r),null,{...x.attrs,rowspan:o-b}),t.insert(t.mapping.slice(c).map(n.positionAt(o,w,s)),x.type.createAndFill({...x.attrs,rowspan:b+x.attrs.rowspan-o})),u+=x.attrs.colspan-1}}return d}function FP(t,n,s,r,i,l,o,c){if(o==0||o==n.width)return!1;let d=!1;for(let u=i;u<l;u++){const h=u*n.width+o,m=n.map[h];if(n.map[h-1]==m){d=!0;const x=s.nodeAt(m),b=n.colCount(m),w=t.mapping.slice(c).map(m+r);t.setNodeMarkup(w,null,pu(x.attrs,o-b,x.attrs.colspan-(o-b))),t.insert(w+x.nodeSize,x.type.createAndFill(pu(x.attrs,0,o-b))),u+=x.attrs.rowspan-1}}return d}function $P(t,n,s,r,i){let l=s?t.doc.nodeAt(s-1):t.doc;if(!l)throw new Error("No table found");let o=ms.get(l);const{top:c,left:d}=r,u=d+i.width,h=c+i.height,m=t.tr;let x=0;function b(){if(l=s?m.doc.nodeAt(s-1):m.doc,!l)throw new Error("No table found");o=ms.get(l),x=m.mapping.maps.length}Oge(m,o,l,s,u,h,x)&&b(),BP(m,o,l,s,d,u,c,x)&&b(),BP(m,o,l,s,d,u,h,x)&&b(),FP(m,o,l,s,c,h,d,x)&&b(),FP(m,o,l,s,c,h,u,x)&&b();for(let w=c;w<h;w++){const j=o.positionAt(w,d,l),S=o.positionAt(w,u,l);m.replace(m.mapping.slice(x).map(j+s),m.mapping.slice(x).map(S+s),new tt(i.rows[w-c],0,0))}b(),m.setSelection(new Rn(m.doc.resolve(s+o.positionAt(c,d,l)),m.doc.resolve(s+o.positionAt(h-1,u-1,l)))),n(m)}var Dge=MF({ArrowLeft:z0("horiz",-1),ArrowRight:z0("horiz",1),ArrowUp:z0("vert",-1),ArrowDown:z0("vert",1),"Shift-ArrowLeft":U0("horiz",-1),"Shift-ArrowRight":U0("horiz",1),"Shift-ArrowUp":U0("vert",-1),"Shift-ArrowDown":U0("vert",1),Backspace:$0,"Mod-Backspace":$0,Delete:$0,"Mod-Delete":$0});function Ug(t,n,s){return s.eq(t.selection)?!1:(n&&n(t.tr.setSelection(s).scrollIntoView()),!0)}function z0(t,n){return(s,r,i)=>{if(!i)return!1;const l=s.selection;if(l instanceof Rn)return Ug(s,r,At.near(l.$headCell,n));if(t!="horiz"&&!l.empty)return!1;const o=b$(i,t,n);if(o==null)return!1;if(t=="horiz")return Ug(s,r,At.near(s.doc.resolve(l.head+n),n));{const c=s.doc.resolve(o),d=f$(c,t,n);let u;return d?u=At.near(d,1):n<0?u=At.near(s.doc.resolve(c.before(-1)),-1):u=At.near(s.doc.resolve(c.after(-1)),1),Ug(s,r,u)}}}function U0(t,n){return(s,r,i)=>{if(!i)return!1;const l=s.selection;let o;if(l instanceof Rn)o=l;else{const d=b$(i,t,n);if(d==null)return!1;o=new Rn(s.doc.resolve(d))}const c=f$(o.$headCell,t,n);return c?Ug(s,r,new Rn(o.$anchorCell,c)):!1}}function Rge(t,n){const s=t.state.doc,r=Th(s.resolve(n));return r?(t.dispatch(t.state.tr.setSelection(new Rn(r))),!0):!1}function Lge(t,n,s){if(!ll(t.state))return!1;let r=Ige(s);const i=t.state.selection;if(i instanceof Rn){r||(r={width:1,height:1,rows:[Oe.from(QS(Kr(t.state.schema).cell,s))]});const l=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),c=ms.get(l).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=Mge(r,c.right-c.left,c.bottom-c.top),$P(t.state,t.dispatch,o,c,r),!0}else if(r){const l=qb(t.state),o=l.start(-1);return $P(t.state,t.dispatch,o,ms.get(l.node(-1)).findCell(l.pos-o),r),!0}else return!1}function Bge(t,n){var s;if(n.ctrlKey||n.metaKey)return;const r=zP(t,n.target);let i;if(n.shiftKey&&t.state.selection instanceof Rn)l(t.state.selection.$anchorCell,n),n.preventDefault();else if(n.shiftKey&&r&&(i=Th(t.state.selection.$anchor))!=null&&((s=ZN(t,n))==null?void 0:s.pos)!=i.pos)l(i,n),n.preventDefault();else if(!r)return;function l(d,u){let h=ZN(t,u);const m=hc.getState(t.state)==null;if(!h||!FA(d,h))if(m)h=d;else return;const x=new Rn(d,h);if(m||!t.state.selection.eq(x)){const b=t.state.tr.setSelection(x);m&&b.setMeta(hc,d.pos),t.dispatch(b)}}function o(){t.root.removeEventListener("mouseup",o),t.root.removeEventListener("dragstart",o),t.root.removeEventListener("mousemove",c),hc.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(hc,-1))}function c(d){const u=d,h=hc.getState(t.state);let m;if(h!=null)m=t.state.doc.resolve(h);else if(zP(t,u.target)!=r&&(m=ZN(t,n),!m))return o();m&&l(m,u)}t.root.addEventListener("mouseup",o),t.root.addEventListener("dragstart",o),t.root.addEventListener("mousemove",c)}function b$(t,n,s){if(!(t.state.selection instanceof xt))return null;const{$head:r}=t.state.selection;for(let i=r.depth-1;i>=0;i--){const l=r.node(i);if((s<0?r.index(i):r.indexAfter(i))!=(s<0?0:l.childCount))return null;if(l.type.spec.tableRole=="cell"||l.type.spec.tableRole=="header_cell"){const c=r.before(i),d=n=="vert"?s>0?"down":"up":s>0?"right":"left";return t.endOfTextblock(d)?c:null}}return null}function zP(t,n){for(;n&&n!=t.dom;n=n.parentNode)if(n.nodeName=="TD"||n.nodeName=="TH")return n;return null}function ZN(t,n){const s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s?Th(t.state.doc.resolve(s.pos)):null}var Fge=class{constructor(n,s){this.node=n,this.defaultCellMinWidth=s,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${s}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ZS(n,this.colgroup,this.table,s),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!=this.node.type?!1:(this.node=n,ZS(n,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(n){return n.type=="attributes"&&(n.target==this.table||this.colgroup.contains(n.target))}};function ZS(t,n,s,r,i,l){var o;let c=0,d=!0,u=n.firstChild;const h=t.firstChild;if(h){for(let m=0,x=0;m<h.childCount;m++){const{colspan:b,colwidth:w}=h.child(m).attrs;for(let j=0;j<b;j++,x++){const S=i==x?l:w&&w[j],C=S?S+"px":"";if(c+=S||r,S||(d=!1),u)u.style.width!=C&&(u.style.width=C),u=u.nextSibling;else{const A=document.createElement("col");A.style.width=C,n.appendChild(A)}}}for(;u;){const m=u.nextSibling;(o=u.parentNode)==null||o.removeChild(u),u=m}d?(s.style.width=c+"px",s.style.minWidth=""):(s.style.width="",s.style.minWidth=c+"px")}}var Fa=new Ss("tableColumnResizing");function $ge({handleWidth:t=5,cellMinWidth:n=25,defaultCellMinWidth:s=100,View:r=Fge,lastColumnResizable:i=!0}={}){const l=new js({key:Fa,state:{init(o,c){var d,u;const h=(u=(d=l.spec)==null?void 0:d.props)==null?void 0:u.nodeViews,m=Kr(c.schema).table.name;return r&&h&&(h[m]=(x,b)=>new r(x,s,b)),new zge(-1,!1)},apply(o,c){return c.apply(o)}},props:{attributes:o=>{const c=Fa.getState(o);return c&&c.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,c)=>{Uge(o,c,t,i)},mouseleave:o=>{Vge(o)},mousedown:(o,c)=>{Hge(o,c,n,s)}},decorations:o=>{const c=Fa.getState(o);if(c&&c.activeHandle>-1)return Yge(o,c.activeHandle)},nodeViews:{}}});return l}var zge=class Vg{constructor(n,s){this.activeHandle=n,this.dragging=s}apply(n){const s=this,r=n.getMeta(Fa);if(r&&r.setHandle!=null)return new Vg(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new Vg(s.activeHandle,r.setDragging);if(s.activeHandle>-1&&n.docChanged){let i=n.mapping.map(s.activeHandle,-1);return XS(n.doc.resolve(i))||(i=-1),new Vg(i,s.dragging)}return s}};function Uge(t,n,s,r){if(!t.editable)return;const i=Fa.getState(t.state);if(i&&!i.dragging){const l=qge(n.target);let o=-1;if(l){const{left:c,right:d}=l.getBoundingClientRect();n.clientX-c<=s?o=UP(t,n,"left",s):d-n.clientX<=s&&(o=UP(t,n,"right",s))}if(o!=i.activeHandle){if(!r&&o!==-1){const c=t.state.doc.resolve(o),d=c.node(-1),u=ms.get(d),h=c.start(-1);if(u.colCount(c.pos-h)+c.nodeAfter.attrs.colspan-1==u.width-1)return}v$(t,o)}}}function Vge(t){if(!t.editable)return;const n=Fa.getState(t.state);n&&n.activeHandle>-1&&!n.dragging&&v$(t,-1)}function Hge(t,n,s,r){var i;if(!t.editable)return!1;const l=(i=t.dom.ownerDocument.defaultView)!=null?i:window,o=Fa.getState(t.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const c=t.state.doc.nodeAt(o.activeHandle),d=Wge(t,o.activeHandle,c.attrs);t.dispatch(t.state.tr.setMeta(Fa,{setDragging:{startX:n.clientX,startWidth:d}}));function u(m){l.removeEventListener("mouseup",u),l.removeEventListener("mousemove",h);const x=Fa.getState(t.state);x!=null&&x.dragging&&(Gge(t,x.activeHandle,VP(x.dragging,m,s)),t.dispatch(t.state.tr.setMeta(Fa,{setDragging:null})))}function h(m){if(!m.which)return u(m);const x=Fa.getState(t.state);if(x&&x.dragging){const b=VP(x.dragging,m,s);HP(t,x.activeHandle,b,r)}}return HP(t,o.activeHandle,d,r),l.addEventListener("mouseup",u),l.addEventListener("mousemove",h),n.preventDefault(),!0}function Wge(t,n,{colspan:s,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const l=t.domAtPos(n);let c=l.node.childNodes[l.offset].offsetWidth,d=s;if(r)for(let u=0;u<s;u++)r[u]&&(c-=r[u],d--);return c/d}function qge(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList&&t.classList.contains("ProseMirror")?null:t.parentNode;return t}function UP(t,n,s,r){const i=s=="right"?-r:r,l=t.posAtCoords({left:n.clientX+i,top:n.clientY});if(!l)return-1;const{pos:o}=l,c=Th(t.state.doc.resolve(o));if(!c)return-1;if(s=="right")return c.pos;const d=ms.get(c.node(-1)),u=c.start(-1),h=d.map.indexOf(c.pos-u);return h%d.width==0?-1:u+d.map[h-1]}function VP(t,n,s){const r=n.clientX-t.startX;return Math.max(s,t.startWidth+r)}function v$(t,n){t.dispatch(t.state.tr.setMeta(Fa,{setHandle:n}))}function Gge(t,n,s){const r=t.state.doc.resolve(n),i=r.node(-1),l=ms.get(i),o=r.start(-1),c=l.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,d=t.state.tr;for(let u=0;u<l.height;u++){const h=u*l.width+c;if(u&&l.map[h]==l.map[h-l.width])continue;const m=l.map[h],x=i.nodeAt(m).attrs,b=x.colspan==1?0:c-l.colCount(m);if(x.colwidth&&x.colwidth[b]==s)continue;const w=x.colwidth?x.colwidth.slice():Kge(x.colspan);w[b]=s,d.setNodeMarkup(o+m,null,{...x,colwidth:w})}d.docChanged&&t.dispatch(d)}function HP(t,n,s,r){const i=t.state.doc.resolve(n),l=i.node(-1),o=i.start(-1),c=ms.get(l).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let d=t.domAtPos(i.start(-1)).node;for(;d&&d.nodeName!="TABLE";)d=d.parentNode;d&&ZS(l,d.firstChild,d,r,c,s)}function Kge(t){return Array(t).fill(0)}function Yge(t,n){var s;const r=[],i=t.doc.resolve(n),l=i.node(-1);if(!l)return bs.empty;const o=ms.get(l),c=i.start(-1),d=o.colCount(i.pos-c)+i.nodeAfter.attrs.colspan-1;for(let u=0;u<o.height;u++){const h=d+u*o.width;if((d==o.width-1||o.map[h]!=o.map[h+1])&&(u==0||o.map[h]!=o.map[h-o.width])){const m=o.map[h],x=c+m+l.nodeAt(m).nodeSize-1,b=document.createElement("div");b.className="column-resize-handle",(s=Fa.getState(t))!=null&&s.dragging&&r.push(Va.node(c+m,c+m+l.nodeAt(m).nodeSize,{class:"column-resize-dragging"})),r.push(Va.widget(x,b))}}return bs.create(t.doc,r)}function Xge({allowTableNodeSelection:t=!1}={}){return new js({key:hc,state:{init(){return null},apply(n,s){const r=n.getMeta(hc);if(r!=null)return r==-1?null:r;if(s==null||!n.docChanged)return s;const{deleted:i,pos:l}=n.mapping.mapResult(s);return i?null:l}},props:{decorations:cge,handleDOMEvents:{mousedown:Bge},createSelectionBetween(n){return hc.getState(n.state)!=null?n.state.selection:null},handleTripleClick:Rge,handleKeyDown:Dge,handlePaste:Lge},appendTransaction(n,s,r){return fge(r,x$(r,s),t)}})}var w$=kx.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var n,s;const r=t.getAttribute("colwidth"),i=r?r.split(",").map(l=>parseInt(l,10)):null;if(!i){const l=(n=t.closest("table"))==null?void 0:n.querySelectorAll("colgroup > col"),o=Array.from(((s=t.parentElement)==null?void 0:s.children)||[]).indexOf(t);if(o&&o>-1&&l&&l[o]){const c=l[o].getAttribute("width");return c?[parseInt(c,10)]:null}}return i}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",sd(this.options.HTMLAttributes,t),0]}}),Qge=kx.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const n=t.getAttribute("colwidth");return n?n.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",sd(this.options.HTMLAttributes,t),0]}}),Zge=kx.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",sd(this.options.HTMLAttributes,t),0]}});function JS(t,n){return n?["width",`${Math.max(n,t)}px`]:["min-width",`${t}px`]}function WP(t,n,s,r,i,l){var o;let c=0,d=!0,u=n.firstChild;const h=t.firstChild;if(h!==null)for(let x=0,b=0;x<h.childCount;x+=1){const{colspan:w,colwidth:j}=h.child(x).attrs;for(let S=0;S<w;S+=1,b+=1){const C=i===b?l:j&&j[S],A=C?`${C}px`:"";if(c+=C||r,C||(d=!1),u){if(u.style.width!==A){const[k,T]=JS(r,C);u.style.setProperty(k,T)}u=u.nextSibling}else{const k=document.createElement("col"),[T,I]=JS(r,C);k.style.setProperty(T,I),n.appendChild(k)}}}for(;u;){const x=u.nextSibling;(o=u.parentNode)==null||o.removeChild(u),u=x}const m=t.attrs.style&&typeof t.attrs.style=="string"&&/\bwidth\s*:/i.test(t.attrs.style);d&&!m?(s.style.width=`${c}px`,s.style.minWidth=""):(s.style.width="",s.style.minWidth=`${c}px`)}var Jge=class{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),t.attrs.style&&(this.table.style.cssText=t.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),WP(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,WP(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const n=t.target,s=this.dom.contains(n),r=this.contentDOM.contains(n);return!!(s&&!r&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function e1e(t,n,s,r){let i=0,l=!0;const o=[],c=t.firstChild;if(!c)return{};for(let m=0,x=0;m<c.childCount;m+=1){const{colspan:b,colwidth:w}=c.child(m).attrs;for(let j=0;j<b;j+=1,x+=1){const S=s===x?r:w&&w[j];i+=S||n,S||(l=!1);const[C,A]=JS(n,S);o.push(["col",{style:`${C}: ${A}`}])}}const d=l?`${i}px`:"",u=l?"":`${i}px`;return{colgroup:["colgroup",{},...o],tableWidth:d,tableMinWidth:u}}function qP(t,n){return t.createAndFill()}function t1e(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const n={};return Object.keys(t.nodes).forEach(s=>{const r=t.nodes[s];r.spec.tableRole&&(n[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=n,n}function n1e(t,n,s,r,i){const l=t1e(t),o=[],c=[];for(let u=0;u<s;u+=1){const h=qP(l.cell);if(h&&c.push(h),r){const m=qP(l.header_cell);m&&o.push(m)}}const d=[];for(let u=0;u<n;u+=1)d.push(l.row.createChecked(null,r&&u===0?o:c));return l.table.createChecked(null,d)}function s1e(t){return t instanceof Rn}var V0=({editor:t})=>{const{selection:n}=t.state;if(!s1e(n))return!1;let s=0;const r=zF(n.ranges[0].$from,l=>l.type.name==="table");return r==null||r.node.descendants(l=>{if(l.type.name==="table")return!1;["tableCell","tableHeader"].includes(l.type.name)&&(s+=1)}),s===n.ranges.length?(t.commands.deleteTable(),!0):!1},r1e="";function a1e(t){return(t||"").replace(/\s+/g," ").trim()}function i1e(t,n,s={}){var r;const i=(r=s.cellLineSeparator)!=null?r:r1e;if(!t||!t.content||t.content.length===0)return"";const l=[];t.content.forEach(w=>{const j=[];w.content&&w.content.forEach(S=>{let C="";S.content&&Array.isArray(S.content)&&S.content.length>1?C=S.content.map(I=>n.renderChildren(I)).join(i):C=S.content?n.renderChildren(S.content):"";const A=a1e(C),k=S.type==="tableHeader";j.push({text:A,isHeader:k})}),l.push(j)});const o=l.reduce((w,j)=>Math.max(w,j.length),0);if(o===0)return"";const c=new Array(o).fill(0);l.forEach(w=>{var j;for(let S=0;S<o;S+=1){const A=(((j=w[S])==null?void 0:j.text)||"").length;A>c[S]&&(c[S]=A),c[S]<3&&(c[S]=3)}});const d=(w,j)=>w+" ".repeat(Math.max(0,j-w.length)),u=l[0],h=u.some(w=>w.isHeader);let m=`
`;const x=new Array(o).fill(0).map((w,j)=>h&&u[j]&&u[j].text||"");return m+=`| ${x.map((w,j)=>d(w,c[j])).join(" | ")} |
`,m+=`| ${c.map(w=>"-".repeat(Math.max(3,w))).join(" | ")} |
`,(h?l.slice(1):l).forEach(w=>{m+=`| ${new Array(o).fill(0).map((j,S)=>d(w[S]&&w[S].text||"",c[S])).join(" | ")} |
`}),m}var l1e=i1e,N$=kx.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:Jge,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:n}){const{colgroup:s,tableWidth:r,tableMinWidth:i}=e1e(t,this.options.cellMinWidth),l=n.style;function o(){return l||(r?`width: ${r}`:`min-width: ${i}`)}const c=["table",sd(this.options.HTMLAttributes,n,{style:o()}),s,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},c]:c},parseMarkdown:(t,n)=>{const s=[];if(t.header){const r=[];t.header.forEach(i=>{r.push(n.createNode("tableHeader",{},[{type:"paragraph",content:n.parseInline(i.tokens)}]))}),s.push(n.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(r=>{const i=[];r.forEach(l=>{i.push(n.createNode("tableCell",{},[{type:"paragraph",content:n.parseInline(l.tokens)}]))}),s.push(n.createNode("tableRow",{},i))}),n.createNode("table",void 0,s)},renderMarkdown:(t,n)=>l1e(t,n),addCommands(){return{insertTable:({rows:t=3,cols:n=3,withHeaderRow:s=!0}={})=>({tr:r,dispatch:i,editor:l})=>{const o=n1e(l.schema,t,n,s);if(i){const c=r.selection.from+1;r.replaceSelectionWith(o).scrollIntoView().setSelection(xt.near(r.doc.resolve(c)))}return!0},addColumnBefore:()=>({state:t,dispatch:n})=>pge(t,n),addColumnAfter:()=>({state:t,dispatch:n})=>xge(t,n),deleteColumn:()=>({state:t,dispatch:n})=>yge(t,n),addRowBefore:()=>({state:t,dispatch:n})=>vge(t,n),addRowAfter:()=>({state:t,dispatch:n})=>wge(t,n),deleteRow:()=>({state:t,dispatch:n})=>jge(t,n),deleteTable:()=>({state:t,dispatch:n})=>Tge(t,n),mergeCells:()=>({state:t,dispatch:n})=>OP(t,n),splitCell:()=>({state:t,dispatch:n})=>DP(t,n),toggleHeaderColumn:()=>({state:t,dispatch:n})=>Hp("column")(t,n),toggleHeaderRow:()=>({state:t,dispatch:n})=>Hp("row")(t,n),toggleHeaderCell:()=>({state:t,dispatch:n})=>kge(t,n),mergeOrSplit:()=>({state:t,dispatch:n})=>OP(t,n)?!0:DP(t,n),setCellAttribute:(t,n)=>({state:s,dispatch:r})=>Cge(t,n)(s,r),goToNextCell:()=>({state:t,dispatch:n})=>LP(1)(t,n),goToPreviousCell:()=>({state:t,dispatch:n})=>LP(-1)(t,n),fixTables:()=>({state:t,dispatch:n})=>(n&&x$(t),!0),setCellSelection:t=>({tr:n,dispatch:s})=>{if(s){const r=Rn.create(n.doc,t.anchorCell,t.headCell);n.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:V0,"Mod-Backspace":V0,Delete:V0,"Mod-Delete":V0}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[$ge({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Xge({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const n={name:t.name,options:t.options,storage:t.storage};return{tableRole:hu(nh(t,"tableRole",n))}}});ur.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(N$.configure(this.options.table)),this.options.tableCell!==!1&&t.push(w$.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(Qge.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(Zge.configure(this.options.tableRow)),t}});N$.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),borderPreset:{default:null,parseHTML:n=>{const s=n.getAttribute("class")||"";return/\btbl-border-all\b/.test(s)?"all":/\btbl-border-h\b/.test(s)?"h":/\btbl-border-v\b/.test(s)?"v":/\btbl-border-none\b/.test(s)?"none":null},renderHTML:n=>({class:n.borderPreset?`tbl-border-${n.borderPreset}`:null,style:"border-collapse:collapse;"})}}}}).configure({resizable:!0});w$.extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),backgroundColor:{default:null,parseHTML:n=>n.style.backgroundColor||n.getAttribute("data-bg")||null,renderHTML:n=>{const s={};return n.backgroundColor&&(s.style=`background-color:${n.backgroundColor}`),{...s,"data-bg":n.backgroundColor||null}}}}}});const JN={Patient:[{label:"UHID",token:"{{ patient.uhid }}"},{label:"Name",token:"{{ patient.name }}"},{label:"Gender",token:"{{ patient.gender }}"},{label:"DOB",token:'{{ patient.dob | datefmt("%d-%b-%Y") }}'},{label:"Phone",token:"{{ patient.phone }}"},{label:"Email",token:"{{ patient.email }}"},{label:"Address",token:"{{ patient.address }}"}],"Clinical  Last Visit":[{label:"Visit Date",token:'{{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}'},{label:"Doctor",token:"{{ clinical.last_visit.doctor }}"},{label:"Department",token:"{{ clinical.last_visit.department }}"},{label:"Chief Complaints",token:"{{ clinical.last_visit.chief_complaints }}"},{label:"Diagnosis",token:"{{ clinical.last_visit.diagnosis }}"}],"Clinical  Lab Results (loop)":[{label:"Lab Results Table",token:`<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td>
      <td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>`}],Billing:[{label:"Invoices Count",token:"{{ billing.summary.invoices_count }}"},{label:"Total",token:"{{ billing.summary.total_net }}"},{label:"Paid",token:"{{ billing.summary.total_paid }}"},{label:"Balance",token:"{{ billing.summary.balance }}"}]};function o1e({onInsert:t}){const[n,s]=y.useState(()=>new Set(Object.keys(JN))),[r,i]=y.useState(""),l=y.useMemo(()=>{const d=r.trim().toLowerCase();return Object.entries(JN).filter(([h])=>n.has(h)).map(([h,m])=>{const x=d?m.filter(b=>b.label.toLowerCase().includes(d)||b.token.toLowerCase().includes(d)):m;return{group:h,items:x}}).filter(h=>h.items.length>0)},[n,r]),o=d=>{const u=new Set(n);u.has(d)?u.delete(d):u.add(d),s(u)},c=(d,u)=>{d.dataTransfer.setData("text/x-token",u),d.dataTransfer.setData("text/plain",u)};return a.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[a.jsx("div",{className:"text-sm font-semibold",children:"Field Catalog"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(JN).map(d=>a.jsxs("label",{className:"inline-flex items-center gap-1 text-xs border rounded px-2 py-1 bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:n.has(d),onChange:()=>o(d)}),d]},d))}),a.jsx("input",{value:r,onChange:d=>i(d.target.value),placeholder:"Search fields",className:"w-full border rounded px-2 py-1 text-sm"}),a.jsx("div",{className:"space-y-4",children:l.map(({group:d,items:u})=>a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-gray-600 mb-1",children:d}),a.jsx("div",{className:"flex flex-wrap gap-2",children:u.map((h,m)=>a.jsx("div",{draggable:!0,onDragStart:x=>c(x,h.token),onDoubleClick:()=>t&&t(h.token),className:"cursor-grab active:cursor-grabbing text-[11px] px-2 py-1 rounded-md bg-gray-50 hover:bg-gray-100 border",title:"Drag into editor or double-click to insert",children:h.label},m))})]},d))}),a.jsxs("div",{className:"pt-2 border-t",children:[a.jsx("div",{className:"text-[11px] text-gray-600 mb-1",children:"Custom token"}),a.jsxs("form",{onSubmit:d=>{d.preventDefault();const u=d.target.elements.token.value.trim();u&&(t&&t(u),d.target.reset())},children:[a.jsx("input",{name:"token",placeholder:"e.g. {{ my.custom }}",className:"border rounded px-2 py-1 text-sm w-full"}),a.jsx("button",{className:"mt-2 w-full px-2 py-1 border rounded text-sm",children:"Insert"})]})]})]})}const Hg=`@page {
  size: A4;
  margin: 18mm 16mm 18mm 16mm;
}
header.tpl-header { position: running(doc-header); }
footer.tpl-footer { position: running(doc-footer); }
@page {
  @top-center { content: element(doc-header); }
  @bottom-center { content: element(doc-footer); }
}
body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size: 12px; }
h1,h2,h3 { margin: 0 0 8px 0; }
table { width: 100%; border-collapse: collapse; }
th, td { padding: 6px; }`,mi={HeaderMinimal:`
<header class="tpl-header" style="font-size:12px;border-bottom:1px solid #ccc;padding-bottom:6px;display:flex;justify-content:space-between;align-items:center;">
  <div>
    <div style="font-weight:700">Hospital Name</div>
    <div style="font-size:11px;">Address line 1, City</div>
  </div>
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:28px"/>
</header>`.trim(),FooterMinimal:`
<footer class="tpl-footer" style="font-size:11px;border-top:1px solid #ccc;padding-top:6px;display:flex;justify-content:space-between;">
  <div>UHID: {{ patient.uhid }} | {{ patient.name }}</div>
  <div>Page: counter(page) / counter(pages)</div>
</footer>`.trim(),SignatureBlock:`
<div style="margin-top:60px;display:flex;gap:40px;">
  <div>Patient/Guardian Signature: __________________</div>
  <div>Doctor: __________________</div>
  <div>Witness: __________________</div>
</div>`.trim(),CoverPage:`
<section style="display:flex;flex-direction:column;min-height:240mm;justify-content:center;align-items:center;text-align:center;gap:8px;">
  <img src="/media/uploads/sample/hospital_logo.png" alt="Logo" style="height:64px;opacity:0.8"/>
  <h1 style="font-size:28px;">Patient Clinical Summary</h1>
  <div style="font-size:14px">UHID: {{ patient.uhid }} &nbsp; | &nbsp; {{ patient.name }}</div>
  <div style="margin-top:40px;font-size:12px;color:#666">Generated on {{ now }}</div>
</section>`.trim()},c1e=[{key:"clinical_summary_v2",title:"Clinical Summary  Header/Footer + Tables",category:"report",html:`
<h1>Clinical Summary</h1>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Name:</b> {{ patient.name }}<br/>
<b>Gender:</b> {{ patient.gender }}<br/>
<b>DOB:</b> {{ patient.dob | datefmt("%d-%b-%Y") }}</p>

{% if clinical.last_visit.date %}
<h3>Last Visit</h3>
<p><b>Date:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}<br/>
<b>Doctor:</b> {{ clinical.last_visit.doctor }}<br/>
<b>Department:</b> {{ clinical.last_visit.department }}<br/>
<b>Chief Complaints:</b> {{ clinical.last_visit.chief_complaints }}<br/>
<b>Diagnosis:</b> {{ clinical.last_visit.diagnosis }}</p>
{% endif %}

{% if clinical.lab_results %}
<h3>Recent Lab Results</h3>
<table border="1" cellspacing="0" cellpadding="6">
  <tr><th>Test</th><th>Code</th><th>Status</th><th>Result</th><th>Units</th></tr>
  {% for r in clinical.lab_results %}
    <tr>
      <td>{{ r.test }}</td><td>{{ r.code }}</td><td>{{ r.status }}</td><td>{{ r.result }}</td><td>{{ r.units }}</td>
    </tr>
  {% endfor %}
</table>
{% endif %}

{% if billing.summary %}
<h3>Billing Summary</h3>
<p>
<b>Invoices:</b> {{ billing.summary.invoices_count }} |
<b>Total:</b> {{ billing.summary.total_net }} |
<b>Paid:</b> {{ billing.summary.total_paid }} |
<b>Balance:</b> {{ billing.summary.balance }}
</p>
{% endif %}
`.trim(),css:Hg,header:mi.HeaderMinimal,footer:mi.FooterMinimal},{key:"general_consent_v2",title:"General Consent  with Signature",category:"consent",html:`
<h2 style="text-align:center;">General Consent for Treatment</h2>
<p><b>UHID:</b> {{ patient.uhid }}<br/>
<b>Patient Name:</b> {{ patient.name }}<br/>
<b>Date:</b> {{ now }}</p>

<p>
I, {{ patient.name }}, hereby give consent for the proposed {{ data.procedure_name }}
under the care of {{ data.doctor_name }}.
</p>

<p><b>Risks explained:</b> {{ data.risks_text }}</p>

${mi.SignatureBlock}
`.trim(),css:Hg,header:mi.HeaderMinimal,footer:mi.FooterMinimal},{key:"cover_plus_clinical",title:"Cover Page + Clinical",category:"report",html:`${mi.CoverPage}
<div style="page-break-before:always;"></div>
<h1>Clinical Details</h1>
<p><b>UHID:</b> {{ patient.uhid }} &nbsp; <b>Name:</b> {{ patient.name }}</p>
{% if clinical.last_visit.date %}
<p><b>Last Visit:</b> {{ clinical.last_visit.date | datefmt("%d-%b-%Y") }}  {{ clinical.last_visit.doctor }}</p>
{% endif %}
`.trim(),css:Hg,header:mi.HeaderMinimal,footer:mi.FooterMinimal}];function d1e({onUseLayout:t,onInsertBlock:n}){const s=y.useMemo(()=>[{key:"HeaderMinimal",title:"Header  Minimal",html:mi.HeaderMinimal},{key:"FooterMinimal",title:"Footer  Minimal",html:mi.FooterMinimal},{key:"SignatureBlock",title:"Signature Block",html:mi.SignatureBlock},{key:"CoverPage",title:"Cover Page",html:mi.CoverPage}],[]);return a.jsxs("div",{className:"border rounded-lg p-3 bg-white space-y-3",children:[a.jsx("div",{className:"text-sm font-semibold",children:"Template Gallery"}),a.jsx("div",{className:"space-y-2",children:c1e.map(r=>a.jsxs("div",{className:"border rounded p-2",children:[a.jsx("div",{className:"text-sm font-medium",children:r.title}),a.jsxs("div",{className:"text-[11px] text-gray-500 mb-2",children:["Category: ",r.category]}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{className:"px-2 py-1 rounded text-sm border",onClick:()=>t&&t(r),children:"Use Layout"})})]},r.key))}),a.jsxs("div",{className:"pt-2 border-t",children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Blocks"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map(r=>a.jsxs("button",{className:"border rounded p-2 text-left hover:bg-gray-50",onClick:()=>n&&n(r.html),title:"Insert into current editor",children:[a.jsx("div",{className:"text-xs font-medium",children:r.title}),a.jsx("div",{className:"text-[10px] text-gray-500",children:"Click to insert"})]},r.key))})]})]})}const u1e=[{key:"A4",label:"A4 (210297 mm)"},{key:"A5",label:"A5 (148210 mm)"},{key:"Letter",label:"Letter (8.511 in)"},{key:"Legal",label:"Legal (8.514 in)"}];function f1e({css:t="",onApply:n,onClose:s}){const[r,i]=y.useState("A4"),[l,o]=y.useState("portrait"),[c,d]=y.useState(18),[u,h]=y.useState(16),[m,x]=y.useState(18),[b,w]=y.useState(16),[j,S]=y.useState(!0);y.useEffect(()=>{const A=t.match(/@page\s*{([\s\S]*?)}/);if(!A)return;const k=A[1],T=O=>(k.match(O)||[,""])[1],I=T(/size:\s*([^;]+);/i);if(I){const O=I.trim().split(/\s+/);i(O[0]),O[1]&&o(O[1])}const D=(O,R)=>{const P=T(O);return P?parseInt(P,10):R};d(D(/margin-top:\s*([0-9]+)mm/i,c)),h(D(/margin-right:\s*([0-9]+)mm/i,u)),x(D(/margin-bottom:\s*([0-9]+)mm/i,m)),w(D(/margin-left:\s*([0-9]+)mm/i,b))},[]);const C=()=>`@page {
  size: ${r} ${l};
  margin-top: ${c}mm;
  margin-right: ${u}mm;
  margin-bottom: ${m}mm;
  margin-left: ${b}mm;
  ${j?'@bottom-right { content: "Page " counter(page) " of " counter(pages); font-size:10px; }':""}
}`;return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-xl",children:[a.jsx("div",{className:"px-4 py-3 border-b font-semibold",children:"Page Setup"}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"text-sm",children:["Size",a.jsx("select",{className:"w-full border rounded px-2 py-1",value:r,onChange:A=>i(A.target.value),children:u1e.map(A=>a.jsx("option",{value:A.key,children:A.label},A.key))})]}),a.jsxs("label",{className:"text-sm",children:["Orientation",a.jsxs("select",{className:"w-full border rounded px-2 py-1",value:l,onChange:A=>o(A.target.value),children:[a.jsx("option",{value:"portrait",children:"Portrait"}),a.jsx("option",{value:"landscape",children:"Landscape"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsxs("label",{className:"text-sm",children:["Top (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:c,onChange:A=>d(+A.target.value)})]}),a.jsxs("label",{className:"text-sm",children:["Right (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:u,onChange:A=>h(+A.target.value)})]}),a.jsxs("label",{className:"text-sm",children:["Bottom (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:m,onChange:A=>x(+A.target.value)})]}),a.jsxs("label",{className:"text-sm",children:["Left (mm)",a.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1",value:b,onChange:A=>w(+A.target.value)})]})]}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:j,onChange:A=>S(A.target.checked)}),"Show page numbers (WeasyPrint)"]}),a.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-2 overflow-auto",children:C()})]}),a.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 border rounded",onClick:s,children:"Cancel"}),a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>n&&n(C()),children:"Apply"})]})]})})}const e2=Hg;function GP({mode:t="create"}){var R;const{id:n}=Tu(),s=Aa(),i=((R=sl().state)==null?void 0:R.preset)||null,[l,o]=y.useState({name:"",code:"",category:"report",subcategory:"",description:"",css:e2,is_active:!0}),[c,d]=y.useState(""),[u,h]=y.useState("<h1>New Template</h1><p>Use the Field Catalog or Gallery.</p>"),[m,x]=y.useState(""),[b,w]=y.useState("body"),j=t==="edit";y.useEffect(()=>{!j||!n||(async()=>{const L=(await xue(n)).data;o({name:L.name,code:L.code,category:L.category,subcategory:L.subcategory||"",description:L.description||"",css:L.css||e2,is_active:!!L.is_active});const $=L.html||"",B=$.match(/<header[^>]*class="[^"]*tpl-header[^"]*"[^>]*>[\s\S]*?<\/header>/i),V=$.match(/<footer[^>]*class="[^"]*tpl-footer[^"]*"[^>]*>[\s\S]*?<\/footer>/i);d(B?B[0]:""),x(V?V[0]:"");let K=$;B&&(K=K.replace(B[0],"")),V&&(K=K.replace(V[0],"")),h(K.trim()||"")})()},[j,n]),y.useEffect(()=>{!i||j||(o(P=>({...P,category:i.category||"report",name:P.name||i.title||"Untitled",code:P.code||(i.key?`${i.key}-${Date.now()}`:""),css:i.css||e2})),d(i.header||""),x(i.footer||""),h(i.html||""))},[i,j]);const S=y.useMemo(()=>[c,u,m].filter(Boolean).join(`
`),[c,u,m]),C=async()=>{if(!l.name.trim()||!l.code.trim()){xe.error("Name and unique code are required");return}const P={...l,html:S,placeholders:{header:!!c,footer:!!m}};try{j?(await yue(n,P),xe.success("Template updated")):(await gue(P),xe.success("Template created")),s("/templates")}catch{}},A=P=>{o(L=>({...L,category:P.category||L.category,css:P.css||L.css,name:L.name||P.title,code:L.code||(P.key?`${P.key}-${Date.now()}`:"")})),d(P.header||""),x(P.footer||""),h(P.html||""),xe.success("Layout applied")},k=P=>{b==="header"?d(L=>`${L}
${P}`):b==="footer"?x(L=>`${L}
${P}`):h(L=>`${L}
${P}`)},T=P=>{k(P)},[I,D]=y.useState(!1),O=P=>{o(L=>{const $=/@page\s*{[\s\S]*?}/.test(L.css||"");return{...L,css:$?L.css.replace(/@page\s*{[\s\S]*?}/,P):P+`
`+(L.css||"")}}),D(!1)};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>D(!0),className:"px-3 py-2 rounded border",children:"Page Setup"}),a.jsx("button",{onClick:C,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"}),I&&a.jsx(f1e,{css:l.css,onApply:O,onClose:()=>D(!1)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-xl font-semibold",children:j?"Edit Template":"Create Template"}),a.jsx("div",{className:"flex gap-2",children:a.jsx("button",{onClick:C,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsx("input",{value:l.name,onChange:P=>o({...l,name:P.target.value}),className:"border rounded px-3 py-2",placeholder:"Template Name"}),a.jsx("input",{value:l.code,onChange:P=>o({...l,code:P.target.value}),className:"border rounded px-3 py-2",placeholder:"Unique Code (e.g., clinical_summary_v2)",disabled:j}),a.jsxs("select",{value:l.category,onChange:P=>o({...l,category:P.target.value}),className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"report",children:"Report"}),a.jsx("option",{value:"consent",children:"Consent"})]}),a.jsx("input",{value:l.subcategory,onChange:P=>o({...l,subcategory:P.target.value}),className:"border rounded px-3 py-2",placeholder:"Subcategory (optional)"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:l.is_active,onChange:P=>o({...l,is_active:P.target.checked})}),"Active"]})]}),a.jsx("textarea",{value:l.description,onChange:P=>o({...l,description:P.target.value}),placeholder:"Description (optional)",className:"border rounded px-3 py-2 w-full min-h-[80px]"}),a.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[a.jsxs("div",{className:"col-span-12 lg:col-span-8 space-y-3",children:[a.jsx("div",{className:"flex gap-2",children:["header","body","footer"].map(P=>a.jsx("button",{onClick:()=>w(P),className:["px-3 py-1 rounded border text-sm",b===P?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:P.toUpperCase()},P))}),b==="header"&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Header (running top)"}),a.jsx(ON,{value:c,onChange:d})]}),b==="body"&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Body"}),a.jsx(ON,{value:u,onChange:h})]}),b==="footer"&&a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Footer (running bottom)"}),a.jsx(ON,{value:m,onChange:x})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"CSS (print styles)"}),a.jsx("textarea",{value:l.css,onChange:P=>o({...l,css:P.target.value}),className:"border rounded px-3 py-2 w-full min-h-[160px] font-mono text-xs"})]})]}),a.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-3",children:[a.jsx(o1e,{onInsert:T}),a.jsx(d1e,{onUseLayout:A,onInsertBlock:k}),a.jsxs("div",{className:"text-[11px] text-gray-500",children:[a.jsx("b",{children:"Note:"})," Save the template to use server-side merged preview & PDF."]})]})]})]})}function h1e(t,n){const s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=n||"download",document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(s)}function j$({value:t,onChange:n,onSelect:s}){const[r,i]=y.useState(""),[l,o]=y.useState([]),[c,d]=y.useState(!1);y.useEffect(()=>{const m=setTimeout(async()=>{const x=(r||"").trim();if(x.length<2){o([]);return}d(!0);try{const{data:b}=await o9(x),w=(b==null?void 0:b.results)||(b==null?void 0:b.items)||b||[];o(w)}catch(b){console.error("lookupPatients failed",b),o([])}finally{d(!1)}},300);return()=>clearTimeout(m)},[r]);function u(h){const m=n||s;m&&m(h.id,h)}return a.jsxs("div",{className:"space-y-1",children:[a.jsx("input",{value:r,onChange:h=>i(h.target.value),placeholder:"Search patient (UHID / Name / Phone)",className:"w-full rounded-md border border-slate-300 px-2.5 py-1.5 text-xs md:text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500"}),a.jsxs("div",{className:"mt-1 max-h-56 overflow-auto rounded-xl border border-slate-200 bg-white shadow-sm",children:[c&&a.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Searching"}),!c&&l.length===0&&a.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-400",children:"Type at least 2 characters to search."}),l.map(h=>{const m=h.uhid||`NH-${String(h.id??"").toString().padStart(6,"0")}`,x=h.name||[h.first_name,h.last_name].filter(Boolean).join(" ")||"Unnamed";return a.jsxs("button",{type:"button",onClick:()=>u(h),className:"w-full text-left px-3 py-2 text-xs md:text-sm hover:bg-indigo-50 flex flex-col gap-0.5",children:[a.jsxs("span",{className:"font-medium text-slate-800",children:[m,"  ",x]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[h.gender?`${h.gender}  `:"",h.phone||"No phone"]})]},h.id)})]}),t&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Selected patient ID:"," ",a.jsx("span",{className:"font-semibold text-slate-800",children:t})]})]})}function m1e(){const[t,n]=y.useState("saved"),[s,r]=y.useState(null),[i,l]=y.useState([]),[o,c]=y.useState(""),[d,u]=y.useState(""),[h,m]=y.useState(1),[x,b]=y.useState("");y.useEffect(()=>{(async()=>{const S=await tA({category:"report",active:!0});l(S.data||[])})()},[]);const w=async()=>{if(!s||!o)return xe.info("Select template and patient");try{const S=await c9(Number(o),Number(s));u(S.data.html||"")}catch{}},j=async()=>{if(!s||!o)return xe.info("Select template and patient");try{const S=x?await wue(Number(o),{patient_id:Number(s),inline:!1,engine:x}):await vue(Number(o),Number(s));h1e(S,`patient-${s}.pdf`)}catch{}};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Generate Patient Reports"}),a.jsx("div",{className:"flex gap-2",children:["saved","predefined","customized"].map(S=>a.jsx("button",{onClick:()=>n(S),className:["px-3 py-1 rounded border text-sm",t===S?"bg-blue-600 text-white border-blue-600":"bg-white"].join(" "),children:S==="saved"?"Saved Formats":S==="predefined"?"Predefined":"Customized"},S))}),t==="saved"&&a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"1) Select Template"}),a.jsxs("select",{value:o,onChange:S=>c(S.target.value),className:"border rounded px-3 py-2 w-full",children:[a.jsx("option",{value:"",children:"-- choose report template --"}),i.map(S=>a.jsxs("option",{value:S.id,children:[S.name," (",S.code,")"]},S.id))]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"2) Choose Patient"}),a.jsx(j$,{value:s,onSelect:r})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Engine"}),a.jsxs("select",{value:x,onChange:S=>b(S.target.value),className:"border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"",children:"Auto"}),a.jsx("option",{value:"weasyprint",children:"WeasyPrint"}),a.jsx("option",{value:"xhtml2pdf",children:"xhtml2pdf (fallback)"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:w,className:"px-3 py-2 border rounded",children:"Preview"}),a.jsx("button",{onClick:j,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Download PDF"})]})]})]}),a.jsxs("div",{className:"md:col-span-2 border rounded-lg overflow-hidden bg-white",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Preview"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>m(S=>Math.max(.5,+(S-.1).toFixed(2))),children:""}),a.jsxs("div",{className:"text-xs w-12 text-center",children:[Math.round(h*100),"%"]}),a.jsx("button",{className:"px-2 py-1 border rounded text-sm",onClick:()=>m(S=>Math.min(2,+(S+.1).toFixed(2))),children:"+"})]})]}),a.jsx("div",{className:"w-full",style:{transform:`scale(${h})`,transformOrigin:"0 0"},children:a.jsx("iframe",{title:"report-preview",className:"w-full min-h-[900px]",srcDoc:d||""})})]})]}),t==="predefined"&&a.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[a.jsx("div",{className:"md:col-span-1",children:a.jsx(TemplateGallery,{onUseLayout:S=>window.location.assign("/templates/new"),onInsertBlock:()=>{}})}),a.jsx("div",{className:"md:col-span-2 border rounded-lg p-4 bg-white text-sm text-gray-600",children:'Pick a layout from the left to open the editor pre-filled. Save it, then return to "Saved Formats".'})]}),t==="customized"&&a.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[a.jsx("div",{className:"text-sm mb-2",children:"Create your own template with header/footer, drag-drop fields and blocks."}),a.jsx("a",{href:"/templates/new",className:"px-3 py-2 rounded bg-blue-600 text-white inline-block",children:"Open Template Builder"})]})]})}function p1e(){const[t,n]=y.useState(""),[s,r]=y.useState([]),[i,l]=y.useState(""),[o,c]=y.useState({procedure_name:"",doctor_name:"",risks_text:"",witness_name:""}),[d,u]=y.useState(""),[h,m]=y.useState([]),x=async j=>{if(!j){m([]);return}try{const S=await jue(Number(j));m(S.data||[])}catch{}};y.useEffect(()=>{(async()=>{const j=await tA({category:"consent",active:!0});r(j.data||[])})()},[]);const b=async()=>{if(!t||!i){xe.info("Select consent template and enter Patient ID");return}const j={data:{...o}},S=await c9(Number(i),Number(t),j);u(S.data.html||"")},w=async()=>{if(!t||!i){xe.info("Select consent template and enter Patient ID");return}try{await Nue(Number(t),{template_id:Number(i),data:{...o},finalize:!0,signed_by:o.doctor_name||void 0,witness_name:o.witness_name||void 0}),xe.success("Consent saved"),x(t)}catch{}};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Patient Consents"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"md:col-span-1 border rounded-lg p-3 bg-white",children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Consent Template"}),a.jsxs("select",{value:i,onChange:j=>l(j.target.value),className:"border rounded px-3 py-2 w-full",children:[a.jsx("option",{value:"",children:"-- choose consent template --"}),s.map(j=>a.jsxs("option",{value:j.id,children:[j.name," (",j.code,")"]},j.id))]}),a.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Patient"}),a.jsx("input",{value:t,onChange:j=>n(j.target.value),className:"border rounded px-3 py-2 w-full",placeholder:"Patient ID",onBlur:()=>x(e.target.value)}),a.jsx("div",{className:"mt-3 text-sm font-semibold",children:"Extra Fields"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{value:o.procedure_name,onChange:j=>c({...o,procedure_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Procedure name"}),a.jsx("input",{value:o.doctor_name,onChange:j=>c({...o,doctor_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Doctor name"}),a.jsx("textarea",{value:o.risks_text,onChange:j=>c({...o,risks_text:j.target.value}),className:"border rounded px-3 py-2 w-full min-h-[80px]",placeholder:"Risks explained..."}),a.jsx("input",{value:o.witness_name,onChange:j=>c({...o,witness_name:j.target.value}),className:"border rounded px-3 py-2 w-full",placeholder:"Witness name"})]}),a.jsxs("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{onClick:b,className:"px-3 py-2 border rounded",children:"Preview"}),a.jsx("button",{onClick:w,className:"px-3 py-2 rounded bg-blue-600 text-white",children:"Save PDF"})]})]}),a.jsxs("div",{className:"md:col-span-2 space-y-3",children:[a.jsx("div",{className:"border rounded-lg overflow-hidden bg-white",children:a.jsx("iframe",{title:"consent-preview",className:"w-full min-h-[400px]",srcDoc:d||""})}),a.jsxs("div",{className:"border rounded-lg bg-white",children:[a.jsxs("div",{className:"px-3 py-2 border-b text-sm font-semibold",children:["Existing Consents (Patient #",t||"-",")"]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"#"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Template"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"PDF"})]})}),a.jsxs("tbody",{children:[h.map(j=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:j.id}),a.jsx("td",{className:"px-3 py-2",children:j.template_id}),a.jsx("td",{className:"px-3 py-2",children:j.status}),a.jsx("td",{className:"px-3 py-2",children:j.pdf_path?a.jsx("a",{href:j.pdf_path,target:"_blank",rel:"noreferrer",className:"text-blue-700 underline",children:"Open"}):a.jsx("span",{className:"text-gray-400",children:"-"})})]},j.id)),h.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"No consents"})})]})]})})]})]})]})]})}function x1e(t={}){return ne.get("/dashboard/data",{params:t})}function Vt(t,n,{checkForDefaultPrevented:s=!0}={}){return function(i){if(t==null||t(i),s===!1||!i.defaultPrevented)return n==null?void 0:n(i)}}function g1e(t,n){const s=y.createContext(n),r=l=>{const{children:o,...c}=l,d=y.useMemo(()=>c,Object.values(c));return a.jsx(s.Provider,{value:d,children:o})};r.displayName=t+"Provider";function i(l){const o=y.useContext(s);if(o)return o;if(n!==void 0)return n;throw new Error(`\`${l}\` must be used within \`${t}\``)}return[r,i]}function Du(t,n=[]){let s=[];function r(l,o){const c=y.createContext(o),d=s.length;s=[...s,o];const u=m=>{var C;const{scope:x,children:b,...w}=m,j=((C=x==null?void 0:x[t])==null?void 0:C[d])||c,S=y.useMemo(()=>w,Object.values(w));return a.jsx(j.Provider,{value:S,children:b})};u.displayName=l+"Provider";function h(m,x){var j;const b=((j=x==null?void 0:x[t])==null?void 0:j[d])||c,w=y.useContext(b);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${m}\` must be used within \`${l}\``)}return[u,h]}const i=()=>{const l=s.map(o=>y.createContext(o));return function(c){const d=(c==null?void 0:c[t])||l;return y.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return i.scopeName=t,[r,y1e(i,...n)]}function y1e(...t){const n=t[0];if(t.length===1)return n;const s=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const m=d(l)[`__scope${u}`];return{...c,...m}},{});return y.useMemo(()=>({[`__scope${n.scopeName}`]:o}),[o])}};return s.scopeName=n.scopeName,s}function S$(t){const n=t+"CollectionProvider",[s,r]=Du(n),[i,l]=s(n,{collectionRef:{current:null},itemMap:new Map}),o=j=>{const{scope:S,children:C}=j,A=Ge.useRef(null),k=Ge.useRef(new Map).current;return a.jsx(i,{scope:S,itemMap:k,collectionRef:A,children:C})};o.displayName=n;const c=t+"CollectionSlot",d=Jf(c),u=Ge.forwardRef((j,S)=>{const{scope:C,children:A}=j,k=l(c,C),T=Sn(S,k.collectionRef);return a.jsx(d,{ref:T,children:A})});u.displayName=c;const h=t+"CollectionItemSlot",m="data-radix-collection-item",x=Jf(h),b=Ge.forwardRef((j,S)=>{const{scope:C,children:A,...k}=j,T=Ge.useRef(null),I=Sn(S,T),D=l(h,C);return Ge.useEffect(()=>(D.itemMap.set(T,{ref:T,...k}),()=>void D.itemMap.delete(T))),a.jsx(x,{[m]:"",ref:I,children:A})});b.displayName=h;function w(j){const S=l(t+"CollectionConsumer",j);return Ge.useCallback(()=>{const A=S.collectionRef.current;if(!A)return[];const k=Array.from(A.querySelectorAll(`[${m}]`));return Array.from(S.itemMap.values()).sort((D,O)=>k.indexOf(D.ref.current)-k.indexOf(O.ref.current))},[S.collectionRef,S.itemMap])}return[{Provider:o,Slot:u,ItemSlot:b},w,r]}var Tr=globalThis!=null&&globalThis.document?y.useLayoutEffect:()=>{},b1e=tb[" useId ".trim().toString()]||(()=>{}),v1e=0;function Pc(t){const[n,s]=y.useState(b1e());return Tr(()=>{s(r=>r??String(v1e++))},[t]),n?`radix-${n}`:""}var w1e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Yt=w1e.reduce((t,n)=>{const s=Jf(`Primitive.${n}`),r=y.forwardRef((i,l)=>{const{asChild:o,...c}=i,d=o?s:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(d,{...c,ref:l})});return r.displayName=`Primitive.${n}`,{...t,[n]:r}},{});function N1e(t,n){t&&Zc.flushSync(()=>t.dispatchEvent(n))}function Jr(t){const n=y.useRef(t);return y.useEffect(()=>{n.current=t}),y.useMemo(()=>(...s)=>{var r;return(r=n.current)==null?void 0:r.call(n,...s)},[])}var j1e=tb[" useInsertionEffect ".trim().toString()]||Tr;function Wp({prop:t,defaultProp:n,onChange:s=()=>{},caller:r}){const[i,l,o]=S1e({defaultProp:n,onChange:s}),c=t!==void 0,d=c?t:i;{const h=y.useRef(t!==void 0);y.useEffect(()=>{const m=h.current;m!==c&&console.warn(`${r} is changing from ${m?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=c},[c,r])}const u=y.useCallback(h=>{var m;if(c){const x=_1e(h)?h(t):h;x!==t&&((m=o.current)==null||m.call(o,x))}else l(h)},[c,t,l,o]);return[d,u]}function S1e({defaultProp:t,onChange:n}){const[s,r]=y.useState(t),i=y.useRef(s),l=y.useRef(n);return j1e(()=>{l.current=n},[n]),y.useEffect(()=>{var o;i.current!==s&&((o=l.current)==null||o.call(l,s),i.current=s)},[s,i]),[s,r,l]}function _1e(t){return typeof t=="function"}var C1e=y.createContext(void 0);function Gb(t){const n=y.useContext(C1e);return t||n||"ltr"}var t2="rovingFocusGroup.onEntryFocus",A1e={bubbles:!1,cancelable:!0},Ex="RovingFocusGroup",[e_,_$,k1e]=S$(Ex),[E1e,C$]=Du(Ex,[k1e]),[T1e,I1e]=E1e(Ex),A$=y.forwardRef((t,n)=>a.jsx(e_.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(e_.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(P1e,{...t,ref:n})})}));A$.displayName=Ex;var P1e=y.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:s,orientation:r,loop:i=!1,dir:l,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:h=!1,...m}=t,x=y.useRef(null),b=Sn(n,x),w=Gb(l),[j,S]=Wp({prop:o,defaultProp:c??null,onChange:d,caller:Ex}),[C,A]=y.useState(!1),k=Jr(u),T=_$(s),I=y.useRef(!1),[D,O]=y.useState(0);return y.useEffect(()=>{const R=x.current;if(R)return R.addEventListener(t2,k),()=>R.removeEventListener(t2,k)},[k]),a.jsx(T1e,{scope:s,orientation:r,dir:w,loop:i,currentTabStopId:j,onItemFocus:y.useCallback(R=>S(R),[S]),onItemShiftTab:y.useCallback(()=>A(!0),[]),onFocusableItemAdd:y.useCallback(()=>O(R=>R+1),[]),onFocusableItemRemove:y.useCallback(()=>O(R=>R-1),[]),children:a.jsx(Yt.div,{tabIndex:C||D===0?-1:0,"data-orientation":r,...m,ref:b,style:{outline:"none",...t.style},onMouseDown:Vt(t.onMouseDown,()=>{I.current=!0}),onFocus:Vt(t.onFocus,R=>{const P=!I.current;if(R.target===R.currentTarget&&P&&!C){const L=new CustomEvent(t2,A1e);if(R.currentTarget.dispatchEvent(L),!L.defaultPrevented){const $=T().filter(H=>H.focusable),B=$.find(H=>H.active),V=$.find(H=>H.id===j),z=[B,V,...$].filter(Boolean).map(H=>H.ref.current);T$(z,h)}}I.current=!1}),onBlur:Vt(t.onBlur,()=>A(!1))})})}),k$="RovingFocusGroupItem",E$=y.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:s,focusable:r=!0,active:i=!1,tabStopId:l,children:o,...c}=t,d=Pc(),u=l||d,h=I1e(k$,s),m=h.currentTabStopId===u,x=_$(s),{onFocusableItemAdd:b,onFocusableItemRemove:w,currentTabStopId:j}=h;return y.useEffect(()=>{if(r)return b(),()=>w()},[r,b,w]),a.jsx(e_.ItemSlot,{scope:s,id:u,focusable:r,active:i,children:a.jsx(Yt.span,{tabIndex:m?0:-1,"data-orientation":h.orientation,...c,ref:n,onMouseDown:Vt(t.onMouseDown,S=>{r?h.onItemFocus(u):S.preventDefault()}),onFocus:Vt(t.onFocus,()=>h.onItemFocus(u)),onKeyDown:Vt(t.onKeyDown,S=>{if(S.key==="Tab"&&S.shiftKey){h.onItemShiftTab();return}if(S.target!==S.currentTarget)return;const C=D1e(S,h.orientation,h.dir);if(C!==void 0){if(S.metaKey||S.ctrlKey||S.altKey||S.shiftKey)return;S.preventDefault();let k=x().filter(T=>T.focusable).map(T=>T.ref.current);if(C==="last")k.reverse();else if(C==="prev"||C==="next"){C==="prev"&&k.reverse();const T=k.indexOf(S.currentTarget);k=h.loop?R1e(k,T+1):k.slice(T+1)}setTimeout(()=>T$(k))}}),children:typeof o=="function"?o({isCurrentTabStop:m,hasTabStop:j!=null}):o})})});E$.displayName=k$;var M1e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function O1e(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function D1e(t,n,s){const r=O1e(t.key,s);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return M1e[r]}function T$(t,n=!1){const s=document.activeElement;for(const r of t)if(r===s||(r.focus({preventScroll:n}),document.activeElement!==s))return}function R1e(t,n){return t.map((s,r)=>t[(n+r)%t.length])}var L1e=A$,B1e=E$;function F1e(t,n){return y.useReducer((s,r)=>n[s][r]??s,t)}var Lo=t=>{const{present:n,children:s}=t,r=$1e(n),i=typeof s=="function"?s({present:r.isPresent}):y.Children.only(s),l=Sn(r.ref,z1e(i));return typeof s=="function"||r.isPresent?y.cloneElement(i,{ref:l}):null};Lo.displayName="Presence";function $1e(t){const[n,s]=y.useState(),r=y.useRef(null),i=y.useRef(t),l=y.useRef("none"),o=t?"mounted":"unmounted",[c,d]=F1e(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return y.useEffect(()=>{const u=H0(r.current);l.current=c==="mounted"?u:"none"},[c]),Tr(()=>{const u=r.current,h=i.current;if(h!==t){const x=l.current,b=H0(u);t?d("MOUNT"):b==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(h&&x!==b?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,d]),Tr(()=>{if(n){let u;const h=n.ownerDocument.defaultView??window,m=b=>{const j=H0(r.current).includes(CSS.escape(b.animationName));if(b.target===n&&j&&(d("ANIMATION_END"),!i.current)){const S=n.style.animationFillMode;n.style.animationFillMode="forwards",u=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=S)})}},x=b=>{b.target===n&&(l.current=H0(r.current))};return n.addEventListener("animationstart",x),n.addEventListener("animationcancel",m),n.addEventListener("animationend",m),()=>{h.clearTimeout(u),n.removeEventListener("animationstart",x),n.removeEventListener("animationcancel",m),n.removeEventListener("animationend",m)}}else d("ANIMATION_END")},[n,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:y.useCallback(u=>{r.current=u?getComputedStyle(u):null,s(u)},[])}}function H0(t){return(t==null?void 0:t.animationName)||"none"}function z1e(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var Kb="Tabs",[U1e]=Du(Kb,[C$]),I$=C$(),[V1e,$A]=U1e(Kb),P$=y.forwardRef((t,n)=>{const{__scopeTabs:s,value:r,onValueChange:i,defaultValue:l,orientation:o="horizontal",dir:c,activationMode:d="automatic",...u}=t,h=Gb(c),[m,x]=Wp({prop:r,onChange:i,defaultProp:l??"",caller:Kb});return a.jsx(V1e,{scope:s,baseId:Pc(),value:m,onValueChange:x,orientation:o,dir:h,activationMode:d,children:a.jsx(Yt.div,{dir:h,"data-orientation":o,...u,ref:n})})});P$.displayName=Kb;var M$="TabsList",O$=y.forwardRef((t,n)=>{const{__scopeTabs:s,loop:r=!0,...i}=t,l=$A(M$,s),o=I$(s);return a.jsx(L1e,{asChild:!0,...o,orientation:l.orientation,dir:l.dir,loop:r,children:a.jsx(Yt.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:n})})});O$.displayName=M$;var D$="TabsTrigger",R$=y.forwardRef((t,n)=>{const{__scopeTabs:s,value:r,disabled:i=!1,...l}=t,o=$A(D$,s),c=I$(s),d=F$(o.baseId,r),u=$$(o.baseId,r),h=r===o.value;return a.jsx(B1e,{asChild:!0,...c,focusable:!i,active:h,children:a.jsx(Yt.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":u,"data-state":h?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:d,...l,ref:n,onMouseDown:Vt(t.onMouseDown,m=>{!i&&m.button===0&&m.ctrlKey===!1?o.onValueChange(r):m.preventDefault()}),onKeyDown:Vt(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(r)}),onFocus:Vt(t.onFocus,()=>{const m=o.activationMode!=="manual";!h&&!i&&m&&o.onValueChange(r)})})})});R$.displayName=D$;var L$="TabsContent",B$=y.forwardRef((t,n)=>{const{__scopeTabs:s,value:r,forceMount:i,children:l,...o}=t,c=$A(L$,s),d=F$(c.baseId,r),u=$$(c.baseId,r),h=r===c.value,m=y.useRef(h);return y.useEffect(()=>{const x=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(x)},[]),a.jsx(Lo,{present:i||h,children:({present:x})=>a.jsx(Yt.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!x,id:u,tabIndex:0,...o,ref:n,style:{...t.style,animationDuration:m.current?"0s":void 0},children:x&&l})})});B$.displayName=L$;function F$(t,n){return`${t}-trigger-${n}`}function $$(t,n){return`${t}-content-${n}`}var H1e=P$,z$=O$,U$=R$,V$=B$;const _o=H1e,Ll=y.forwardRef(({className:t,...n},s)=>a.jsx(z$,{ref:s,className:It("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...n}));Ll.displayName=z$.displayName;const dn=y.forwardRef(({className:t,...n},s)=>a.jsx(U$,{ref:s,className:It("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...n}));dn.displayName=U$.displayName;const mn=y.forwardRef(({className:t,...n},s)=>a.jsx(V$,{ref:s,className:It("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n}));mn.displayName=V$.displayName;var W1e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function zA(t){if(typeof t!="string")return!1;var n=W1e;return n.includes(t)}var q1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function H$(t){if(typeof t!="string")return!1;var n=q1e;return n.includes(t)}function W$(t){return typeof t=="string"&&t.startsWith("data-")}function Bl(t){var n=Object.entries(t).filter(s=>{var[r]=s;return H$(r)||W$(r)});return Object.fromEntries(n)}function qp(t){if(t==null)return null;if(y.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var n=t.props;return Bl(n)}return typeof t=="object"&&!Array.isArray(t)?Bl(t):null}function ki(t){var n=Object.entries(t).filter(s=>{var[r]=s;return H$(r)||W$(r)||zA(r)});return Object.fromEntries(n)}var G1e=["children","width","height","viewBox","className","style","title","desc"];function t_(){return t_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},t_.apply(null,arguments)}function K1e(t,n){if(t==null)return{};var s,r,i=Y1e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function Y1e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var q$=y.forwardRef((t,n)=>{var{children:s,width:r,height:i,viewBox:l,className:o,style:c,title:d,desc:u}=t,h=K1e(t,G1e),m=l||{width:r,height:i,x:0,y:0},x=fn("recharts-surface",o);return y.createElement("svg",t_({},ki(h),{className:x,width:r,height:i,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:n}),y.createElement("title",null,d),y.createElement("desc",null,u),s)}),X1e=["children","className"];function n_(){return n_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},n_.apply(null,arguments)}function Q1e(t,n){if(t==null)return{};var s,r,i=Z1e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function Z1e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var aa=y.forwardRef((t,n)=>{var{children:s,className:r}=t,i=Q1e(t,X1e),l=fn("recharts-layer",r);return y.createElement("g",n_({className:l},ki(i),{ref:n}),s)}),J1e=y.createContext(null);function Pn(t){return function(){return t}}const G$=Math.cos,ey=Math.sin,ol=Math.sqrt,ty=Math.PI,Yb=2*ty,s_=Math.PI,r_=2*s_,wd=1e-6,eye=r_-wd;function K$(t){this._+=t[0];for(let n=1,s=t.length;n<s;++n)this._+=arguments[n]+t[n]}function tye(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return K$;const s=10**n;return function(r){this._+=r[0];for(let i=1,l=r.length;i<l;++i)this._+=Math.round(arguments[i]*s)/s+r[i]}}class nye{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?K$:tye(n)}moveTo(n,s){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,s){this._append`L${this._x1=+n},${this._y1=+s}`}quadraticCurveTo(n,s,r,i){this._append`Q${+n},${+s},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(n,s,r,i,l,o){this._append`C${+n},${+s},${+r},${+i},${this._x1=+l},${this._y1=+o}`}arcTo(n,s,r,i,l){if(n=+n,s=+s,r=+r,i=+i,l=+l,l<0)throw new Error(`negative radius: ${l}`);let o=this._x1,c=this._y1,d=r-n,u=i-s,h=o-n,m=c-s,x=h*h+m*m;if(this._x1===null)this._append`M${this._x1=n},${this._y1=s}`;else if(x>wd)if(!(Math.abs(m*d-u*h)>wd)||!l)this._append`L${this._x1=n},${this._y1=s}`;else{let b=r-o,w=i-c,j=d*d+u*u,S=b*b+w*w,C=Math.sqrt(j),A=Math.sqrt(x),k=l*Math.tan((s_-Math.acos((j+x-S)/(2*C*A)))/2),T=k/A,I=k/C;Math.abs(T-1)>wd&&this._append`L${n+T*h},${s+T*m}`,this._append`A${l},${l},0,0,${+(m*b>h*w)},${this._x1=n+I*d},${this._y1=s+I*u}`}}arc(n,s,r,i,l,o){if(n=+n,s=+s,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let c=r*Math.cos(i),d=r*Math.sin(i),u=n+c,h=s+d,m=1^o,x=o?i-l:l-i;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>wd||Math.abs(this._y1-h)>wd)&&this._append`L${u},${h}`,r&&(x<0&&(x=x%r_+r_),x>eye?this._append`A${r},${r},0,1,${m},${n-c},${s-d}A${r},${r},0,1,${m},${this._x1=u},${this._y1=h}`:x>wd&&this._append`A${r},${r},0,${+(x>=s_)},${m},${this._x1=n+r*Math.cos(l)},${this._y1=s+r*Math.sin(l)}`)}rect(n,s,r,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+s}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function UA(t){let n=3;return t.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const r=Math.floor(s);if(!(r>=0))throw new RangeError(`invalid digits: ${s}`);n=r}return t},()=>new nye(n)}function VA(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Y$(t){this._context=t}Y$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n);break}}};function Xb(t){return new Y$(t)}function X$(t){return t[0]}function Q$(t){return t[1]}function Z$(t,n){var s=Pn(!0),r=null,i=Xb,l=null,o=UA(c);t=typeof t=="function"?t:t===void 0?X$:Pn(t),n=typeof n=="function"?n:n===void 0?Q$:Pn(n);function c(d){var u,h=(d=VA(d)).length,m,x=!1,b;for(r==null&&(l=i(b=o())),u=0;u<=h;++u)!(u<h&&s(m=d[u],u,d))===x&&((x=!x)?l.lineStart():l.lineEnd()),x&&l.point(+t(m,u,d),+n(m,u,d));if(b)return l=null,b+""||null}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:Pn(+d),c):t},c.y=function(d){return arguments.length?(n=typeof d=="function"?d:Pn(+d),c):n},c.defined=function(d){return arguments.length?(s=typeof d=="function"?d:Pn(!!d),c):s},c.curve=function(d){return arguments.length?(i=d,r!=null&&(l=i(r)),c):i},c.context=function(d){return arguments.length?(d==null?r=l=null:l=i(r=d),c):r},c}function W0(t,n,s){var r=null,i=Pn(!0),l=null,o=Xb,c=null,d=UA(u);t=typeof t=="function"?t:t===void 0?X$:Pn(+t),n=typeof n=="function"?n:Pn(n===void 0?0:+n),s=typeof s=="function"?s:s===void 0?Q$:Pn(+s);function u(m){var x,b,w,j=(m=VA(m)).length,S,C=!1,A,k=new Array(j),T=new Array(j);for(l==null&&(c=o(A=d())),x=0;x<=j;++x){if(!(x<j&&i(S=m[x],x,m))===C)if(C=!C)b=x,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),w=x-1;w>=b;--w)c.point(k[w],T[w]);c.lineEnd(),c.areaEnd()}C&&(k[x]=+t(S,x,m),T[x]=+n(S,x,m),c.point(r?+r(S,x,m):k[x],s?+s(S,x,m):T[x]))}if(A)return c=null,A+""||null}function h(){return Z$().defined(i).curve(o).context(l)}return u.x=function(m){return arguments.length?(t=typeof m=="function"?m:Pn(+m),r=null,u):t},u.x0=function(m){return arguments.length?(t=typeof m=="function"?m:Pn(+m),u):t},u.x1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Pn(+m),u):r},u.y=function(m){return arguments.length?(n=typeof m=="function"?m:Pn(+m),s=null,u):n},u.y0=function(m){return arguments.length?(n=typeof m=="function"?m:Pn(+m),u):n},u.y1=function(m){return arguments.length?(s=m==null?null:typeof m=="function"?m:Pn(+m),u):s},u.lineX0=u.lineY0=function(){return h().x(t).y(n)},u.lineY1=function(){return h().x(t).y(s)},u.lineX1=function(){return h().x(r).y(n)},u.defined=function(m){return arguments.length?(i=typeof m=="function"?m:Pn(!!m),u):i},u.curve=function(m){return arguments.length?(o=m,l!=null&&(c=o(l)),u):o},u.context=function(m){return arguments.length?(m==null?l=c=null:c=o(l=m),u):l},u}class J${constructor(n,s){this._context=n,this._x=s}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,s){switch(n=+n,s=+s,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,s,n,s):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+s)/2,n,this._y0,n,s);break}}this._x0=n,this._y0=s}}function sye(t){return new J$(t,!0)}function rye(t){return new J$(t,!1)}const HA={draw(t,n){const s=ol(n/ty);t.moveTo(s,0),t.arc(0,0,s,0,Yb)}},aye={draw(t,n){const s=ol(n/5)/2;t.moveTo(-3*s,-s),t.lineTo(-s,-s),t.lineTo(-s,-3*s),t.lineTo(s,-3*s),t.lineTo(s,-s),t.lineTo(3*s,-s),t.lineTo(3*s,s),t.lineTo(s,s),t.lineTo(s,3*s),t.lineTo(-s,3*s),t.lineTo(-s,s),t.lineTo(-3*s,s),t.closePath()}},ez=ol(1/3),iye=ez*2,lye={draw(t,n){const s=ol(n/iye),r=s*ez;t.moveTo(0,-s),t.lineTo(r,0),t.lineTo(0,s),t.lineTo(-r,0),t.closePath()}},oye={draw(t,n){const s=ol(n),r=-s/2;t.rect(r,r,s,s)}},cye=.8908130915292852,tz=ey(ty/10)/ey(7*ty/10),dye=ey(Yb/10)*tz,uye=-G$(Yb/10)*tz,fye={draw(t,n){const s=ol(n*cye),r=dye*s,i=uye*s;t.moveTo(0,-s),t.lineTo(r,i);for(let l=1;l<5;++l){const o=Yb*l/5,c=G$(o),d=ey(o);t.lineTo(d*s,-c*s),t.lineTo(c*r-d*i,d*r+c*i)}t.closePath()}},n2=ol(3),hye={draw(t,n){const s=-ol(n/(n2*3));t.moveTo(0,s*2),t.lineTo(-n2*s,-s),t.lineTo(n2*s,-s),t.closePath()}},di=-.5,ui=ol(3)/2,a_=1/ol(12),mye=(a_/2+1)*3,pye={draw(t,n){const s=ol(n/mye),r=s/2,i=s*a_,l=r,o=s*a_+s,c=-l,d=o;t.moveTo(r,i),t.lineTo(l,o),t.lineTo(c,d),t.lineTo(di*r-ui*i,ui*r+di*i),t.lineTo(di*l-ui*o,ui*l+di*o),t.lineTo(di*c-ui*d,ui*c+di*d),t.lineTo(di*r+ui*i,di*i-ui*r),t.lineTo(di*l+ui*o,di*o-ui*l),t.lineTo(di*c+ui*d,di*d-ui*c),t.closePath()}};function xye(t,n){let s=null,r=UA(i);t=typeof t=="function"?t:Pn(t||HA),n=typeof n=="function"?n:Pn(n===void 0?64:+n);function i(){let l;if(s||(s=l=r()),t.apply(this,arguments).draw(s,+n.apply(this,arguments)),l)return s=null,l+""||null}return i.type=function(l){return arguments.length?(t=typeof l=="function"?l:Pn(l),i):t},i.size=function(l){return arguments.length?(n=typeof l=="function"?l:Pn(+l),i):n},i.context=function(l){return arguments.length?(s=l??null,i):s},i}function ny(){}function sy(t,n,s){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+s)/6)}function nz(t){this._context=t}nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:sy(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:sy(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function gye(t){return new nz(t)}function sz(t){this._context=t}sz.prototype={areaStart:ny,areaEnd:ny,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:sy(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function yye(t){return new sz(t)}function rz(t){this._context=t}rz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var s=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(s,r):this._context.moveTo(s,r);break;case 3:this._point=4;default:sy(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function bye(t){return new rz(t)}function az(t){this._context=t}az.prototype={areaStart:ny,areaEnd:ny,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}};function vye(t){return new az(t)}function KP(t){return t<0?-1:1}function YP(t,n,s){var r=t._x1-t._x0,i=n-t._x1,l=(t._y1-t._y0)/(r||i<0&&-0),o=(s-t._y1)/(i||r<0&&-0),c=(l*i+o*r)/(r+i);return(KP(l)+KP(o))*Math.min(Math.abs(l),Math.abs(o),.5*Math.abs(c))||0}function XP(t,n){var s=t._x1-t._x0;return s?(3*(t._y1-t._y0)/s-n)/2:n}function s2(t,n,s){var r=t._x0,i=t._y0,l=t._x1,o=t._y1,c=(l-r)/3;t._context.bezierCurveTo(r+c,i+c*n,l-c,o-c*s,l,o)}function ry(t){this._context=t}ry.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:s2(this,this._t0,XP(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var s=NaN;if(t=+t,n=+n,!(t===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,s2(this,XP(this,s=YP(this,t,n)),s);break;default:s2(this,this._t0,s=YP(this,t,n));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=s}}};function iz(t){this._context=new lz(t)}(iz.prototype=Object.create(ry.prototype)).point=function(t,n){ry.prototype.point.call(this,n,t)};function lz(t){this._context=t}lz.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,s,r,i,l){this._context.bezierCurveTo(n,t,r,s,l,i)}};function wye(t){return new ry(t)}function Nye(t){return new iz(t)}function oz(t){this._context=t}oz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,s=t.length;if(s)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),s===2)this._context.lineTo(t[1],n[1]);else for(var r=QP(t),i=QP(n),l=0,o=1;o<s;++l,++o)this._context.bezierCurveTo(r[0][l],i[0][l],r[1][l],i[1][l],t[o],n[o]);(this._line||this._line!==0&&s===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}};function QP(t){var n,s=t.length-1,r,i=new Array(s),l=new Array(s),o=new Array(s);for(i[0]=0,l[0]=2,o[0]=t[0]+2*t[1],n=1;n<s-1;++n)i[n]=1,l[n]=4,o[n]=4*t[n]+2*t[n+1];for(i[s-1]=2,l[s-1]=7,o[s-1]=8*t[s-1]+t[s],n=1;n<s;++n)r=i[n]/l[n-1],l[n]-=r,o[n]-=r*o[n-1];for(i[s-1]=o[s-1]/l[s-1],n=s-2;n>=0;--n)i[n]=(o[n]-i[n+1])/l[n];for(l[s-1]=(t[s]+i[s-1])/2,n=0;n<s-1;++n)l[n]=2*t[n+1]-i[n+1];return[i,l]}function jye(t){return new oz(t)}function Qb(t,n){this._context=t,this._t=n}Qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var s=this._x*(1-this._t)+t*this._t;this._context.lineTo(s,this._y),this._context.lineTo(s,n)}break}}this._x=t,this._y=n}};function Sye(t){return new Qb(t,.5)}function _ye(t){return new Qb(t,0)}function Cye(t){return new Qb(t,1)}function ah(t,n){if((o=t.length)>1)for(var s=1,r,i,l=t[n[0]],o,c=l.length;s<o;++s)for(i=l,l=t[n[s]],r=0;r<c;++r)l[r][1]+=l[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function i_(t){for(var n=t.length,s=new Array(n);--n>=0;)s[n]=n;return s}function Aye(t,n){return t[n]}function kye(t){const n=[];return n.key=t,n}function Eye(){var t=Pn([]),n=i_,s=ah,r=Aye;function i(l){var o=Array.from(t.apply(this,arguments),kye),c,d=o.length,u=-1,h;for(const m of l)for(c=0,++u;c<d;++c)(o[c][u]=[0,+r(m,o[c].key,u,l)]).data=m;for(c=0,h=VA(n(o));c<d;++c)o[h[c]].index=c;return s(o,h),o}return i.keys=function(l){return arguments.length?(t=typeof l=="function"?l:Pn(Array.from(l)),i):t},i.value=function(l){return arguments.length?(r=typeof l=="function"?l:Pn(+l),i):r},i.order=function(l){return arguments.length?(n=l==null?i_:typeof l=="function"?l:Pn(Array.from(l)),i):n},i.offset=function(l){return arguments.length?(s=l??ah,i):s},i}function Tye(t,n){if((r=t.length)>0){for(var s,r,i=0,l=t[0].length,o;i<l;++i){for(o=s=0;s<r;++s)o+=t[s][i][1]||0;if(o)for(s=0;s<r;++s)t[s][i][1]/=o}ah(t,n)}}function Iye(t,n){if((i=t.length)>0){for(var s=0,r=t[n[0]],i,l=r.length;s<l;++s){for(var o=0,c=0;o<i;++o)c+=t[o][s][1]||0;r[s][1]+=r[s][0]=-c/2}ah(t,n)}}function Pye(t,n){if(!(!((o=t.length)>0)||!((l=(i=t[n[0]]).length)>0))){for(var s=0,r=1,i,l,o;r<l;++r){for(var c=0,d=0,u=0;c<o;++c){for(var h=t[n[c]],m=h[r][1]||0,x=h[r-1][1]||0,b=(m-x)/2,w=0;w<c;++w){var j=t[n[w]],S=j[r][1]||0,C=j[r-1][1]||0;b+=S-C}d+=m,u+=b*m}i[r-1][1]+=i[r-1][0]=s,d&&(s-=u/d)}i[r-1][1]+=i[r-1][0]=s,ah(t,n)}}var Zb={},cz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return s==="__proto__"}t.isUnsafeProperty=n})(cz);var WA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){switch(typeof s){case"number":case"symbol":return!1;case"string":return s.includes(".")||s.includes("[")||s.includes("]")}}t.isDeepKey=n})(WA);var Jb={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){var r;return typeof s=="string"||typeof s=="symbol"?s:Object.is((r=s==null?void 0:s.valueOf)==null?void 0:r.call(s),-0)?"-0":String(s)}t.toKey=n})(Jb);var ev={},dz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){if(s==null)return"";if(typeof s=="string")return s;if(Array.isArray(s))return s.map(n).join(",");const r=String(s);return r==="0"&&Object.is(Number(s),-0)?"-0":r}t.toString=n})(dz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=dz,s=Jb;function r(i){if(Array.isArray(i))return i.map(s.toKey);if(typeof i=="symbol")return[i];i=n.toString(i);const l=[],o=i.length;if(o===0)return l;let c=0,d="",u="",h=!1;for(i.charCodeAt(0)===46&&(l.push(""),c++);c<o;){const m=i[c];u?m==="\\"&&c+1<o?(c++,d+=i[c]):m===u?u="":d+=m:h?m==='"'||m==="'"?u=m:m==="]"?(h=!1,l.push(d),d=""):d+=m:m==="["?(h=!0,d&&(l.push(d),d="")):m==="."?d&&(l.push(d),d=""):d+=m,c++}return d&&l.push(d),l}t.toPath=r})(ev);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=cz,s=WA,r=Jb,i=ev;function l(c,d,u){if(c==null)return u;switch(typeof d){case"string":{if(n.isUnsafeProperty(d))return u;const h=c[d];return h===void 0?s.isDeepKey(d)?l(c,i.toPath(d),u):u:h}case"number":case"symbol":{typeof d=="number"&&(d=r.toKey(d));const h=c[d];return h===void 0?u:h}default:{if(Array.isArray(d))return o(c,d,u);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),n.isUnsafeProperty(d))return u;const h=c[d];return h===void 0?u:h}}}function o(c,d,u){if(d.length===0)return u;let h=c;for(let m=0;m<d.length;m++){if(h==null||n.isUnsafeProperty(d[m]))return u;h=h[d[m]]}return h===void 0?u:h}t.get=l})(Zb);var Mye=Zb.get;const xu=Ii(Mye);var Cr=t=>t===0?0:t>0?1:-1,Fl=t=>typeof t=="number"&&t!=+t,Co=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,Ct=t=>(typeof t=="number"||t instanceof Number)&&!Fl(t),$l=t=>Ct(t)||typeof t=="string",Oye=0,Gp=t=>{var n=++Oye;return"".concat(t||"").concat(n)},Vr=function(n,s){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ct(n)&&typeof n!="string")return r;var l;if(Co(n)){if(s==null)return r;var o=n.indexOf("%");l=s*parseFloat(n.slice(0,o))/100}else l=+n;return Fl(l)&&(l=r),i&&s!=null&&l>s&&(l=s),l},uz=t=>{if(!Array.isArray(t))return!1;for(var n=t.length,s={},r=0;r<n;r++)if(!s[t[r]])s[t[r]]=!0;else return!0;return!1};function Vs(t,n,s){return Ct(t)&&Ct(n)?t+s*(n-t):n}function Dye(t,n,s){if(!(!t||!t.length))return t.find(r=>r&&(typeof n=="function"?n(r):xu(r,n))===s)}var dr=t=>t===null||typeof t>"u",Tx=t=>dr(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function Rye(t){return t!=null}function Ru(){}var Lye=["type","size","sizeType"];function l_(){return l_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},l_.apply(null,arguments)}function ZP(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function JP(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?ZP(Object(s),!0).forEach(function(r){Bye(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ZP(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Bye(t,n,s){return(n=Fye(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Fye(t){var n=$ye(t,"string");return typeof n=="symbol"?n:n+""}function $ye(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function zye(t,n){if(t==null)return{};var s,r,i=Uye(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function Uye(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var fz={symbolCircle:HA,symbolCross:aye,symbolDiamond:lye,symbolSquare:oye,symbolStar:fye,symbolTriangle:hye,symbolWye:pye},Vye=Math.PI/180,Hye=t=>{var n="symbol".concat(Tx(t));return fz[n]||HA},Wye=(t,n,s)=>{if(n==="area")return t;switch(s){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var r=18*Vye;return 1.25*t*t*(Math.tan(r)-Math.tan(r*2)*Math.tan(r)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},qye=(t,n)=>{fz["symbol".concat(Tx(t))]=n},hz=t=>{var{type:n="circle",size:s=64,sizeType:r="area"}=t,i=zye(t,Lye),l=JP(JP({},i),{},{type:n,size:s,sizeType:r}),o="circle";typeof n=="string"&&(o=n);var c=()=>{var x=Hye(o),b=xye().type(x).size(Wye(s,r,o)),w=b();if(w!==null)return w},{className:d,cx:u,cy:h}=l,m=ki(l);return Ct(u)&&Ct(h)&&Ct(s)?y.createElement("path",l_({},m,{className:fn("recharts-symbols",d),transform:"translate(".concat(u,", ").concat(h,")"),d:c()})):null};hz.registerSymbol=qye;var mz=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,Gye=(t,n)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(y.isValidElement(t)&&(s=t.props),typeof s!="object"&&typeof s!="function")return null;var r={};return Object.keys(s).forEach(i=>{zA(i)&&(r[i]=l=>s[i](s,l))}),r},Kye=(t,n,s)=>r=>(t(n,s,r),null),tv=(t,n,s)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var r=null;return Object.keys(t).forEach(i=>{var l=t[i];zA(i)&&typeof l=="function"&&(r||(r={}),r[i]=Kye(l,n,s))}),r};function eM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Yye(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?eM(Object(s),!0).forEach(function(r){Xye(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):eM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Xye(t,n,s){return(n=Qye(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Qye(t){var n=Zye(t,"string");return typeof n=="symbol"?n:n+""}function Zye(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function oa(t,n){var s=Yye({},t),r=n,i=Object.keys(n),l=i.reduce((o,c)=>(o[c]===void 0&&r[c]!==void 0&&(o[c]=r[c]),o),s);return l}var pz={},xz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s,r){const i=new Map;for(let l=0;l<s.length;l++){const o=s[l],c=r(o);i.has(c)||i.set(c,o)}return Array.from(i.values())}t.uniqBy=n})(xz);var qA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return s}t.identity=n})(qA);var gz={},nv={},yz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return Number.isSafeInteger(s)&&s>=0}t.isLength=n})(yz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=yz;function s(r){return r!=null&&typeof r!="function"&&n.isLength(r.length)}t.isArrayLike=s})(nv);var bz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return typeof s=="object"&&s!==null}t.isObjectLike=n})(bz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=nv,s=bz;function r(i){return s.isObjectLike(i)&&n.isArrayLike(i)}t.isArrayLikeObject=r})(gz);var vz={},wz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Zb;function s(r){return function(i){return n.get(i,r)}}t.property=s})(wz);var Nz={},GA={},jz={},KA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return s!==null&&(typeof s=="object"||typeof s=="function")}t.isObject=n})(KA);var YA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return s==null||typeof s!="object"&&typeof s!="function"}t.isPrimitive=n})(YA);var XA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s,r){return s===r||Number.isNaN(s)&&Number.isNaN(r)}t.eq=n})(XA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=KA,s=YA,r=XA;function i(h,m,x){return typeof x!="function"?i(h,m,()=>{}):l(h,m,function b(w,j,S,C,A,k){const T=x(w,j,S,C,A,k);return T!==void 0?!!T:l(w,j,b,k)},new Map)}function l(h,m,x,b){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,x,b);case"function":return Object.keys(m).length>0?l(h,{...m},x,b):r.eq(h,m);default:return n.isObject(h)?typeof m=="string"?m==="":!0:r.eq(h,m)}}function o(h,m,x,b){if(m==null)return!0;if(Array.isArray(m))return d(h,m,x,b);if(m instanceof Map)return c(h,m,x,b);if(m instanceof Set)return u(h,m,x,b);const w=Object.keys(m);if(h==null)return w.length===0;if(w.length===0)return!0;if(b!=null&&b.has(m))return b.get(m)===h;b==null||b.set(m,h);try{for(let j=0;j<w.length;j++){const S=w[j];if(!s.isPrimitive(h)&&!(S in h)||m[S]===void 0&&h[S]!==void 0||m[S]===null&&h[S]!==null||!x(h[S],m[S],S,h,m,b))return!1}return!0}finally{b==null||b.delete(m)}}function c(h,m,x,b){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[w,j]of m.entries()){const S=h.get(w);if(x(S,j,w,h,m,b)===!1)return!1}return!0}function d(h,m,x,b){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const w=new Set;for(let j=0;j<m.length;j++){const S=m[j];let C=!1;for(let A=0;A<h.length;A++){if(w.has(A))continue;const k=h[A];let T=!1;if(x(k,S,j,h,m,b)&&(T=!0),T){w.add(A),C=!0;break}}if(!C)return!1}return!0}function u(h,m,x,b){return m.size===0?!0:h instanceof Set?d([...h],[...m],x,b):!1}t.isMatchWith=i,t.isSetMatch=u})(jz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=jz;function s(r,i){return n.isMatchWith(r,i,()=>{})}t.isMatch=s})(GA);var Sz={},QA={},_z={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return Object.getOwnPropertySymbols(s).filter(r=>Object.prototype.propertyIsEnumerable.call(s,r))}t.getSymbols=n})(_z);var ZA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}t.getTag=n})(ZA);var JA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n="[object RegExp]",s="[object String]",r="[object Number]",i="[object Boolean]",l="[object Arguments]",o="[object Symbol]",c="[object Date]",d="[object Map]",u="[object Set]",h="[object Array]",m="[object Function]",x="[object ArrayBuffer]",b="[object Object]",w="[object Error]",j="[object DataView]",S="[object Uint8Array]",C="[object Uint8ClampedArray]",A="[object Uint16Array]",k="[object Uint32Array]",T="[object BigUint64Array]",I="[object Int8Array]",D="[object Int16Array]",O="[object Int32Array]",R="[object BigInt64Array]",P="[object Float32Array]",L="[object Float64Array]";t.argumentsTag=l,t.arrayBufferTag=x,t.arrayTag=h,t.bigInt64ArrayTag=R,t.bigUint64ArrayTag=T,t.booleanTag=i,t.dataViewTag=j,t.dateTag=c,t.errorTag=w,t.float32ArrayTag=P,t.float64ArrayTag=L,t.functionTag=m,t.int16ArrayTag=D,t.int32ArrayTag=O,t.int8ArrayTag=I,t.mapTag=d,t.numberTag=r,t.objectTag=b,t.regexpTag=n,t.setTag=u,t.stringTag=s,t.symbolTag=o,t.uint16ArrayTag=A,t.uint32ArrayTag=k,t.uint8ArrayTag=S,t.uint8ClampedArrayTag=C})(JA);var Cz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}t.isTypedArray=n})(Cz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=_z,s=ZA,r=JA,i=YA,l=Cz;function o(h,m){return c(h,void 0,h,new Map,m)}function c(h,m,x,b=new Map,w=void 0){const j=w==null?void 0:w(h,m,x,b);if(j!==void 0)return j;if(i.isPrimitive(h))return h;if(b.has(h))return b.get(h);if(Array.isArray(h)){const S=new Array(h.length);b.set(h,S);for(let C=0;C<h.length;C++)S[C]=c(h[C],C,x,b,w);return Object.hasOwn(h,"index")&&(S.index=h.index),Object.hasOwn(h,"input")&&(S.input=h.input),S}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const S=new RegExp(h.source,h.flags);return S.lastIndex=h.lastIndex,S}if(h instanceof Map){const S=new Map;b.set(h,S);for(const[C,A]of h)S.set(C,c(A,C,x,b,w));return S}if(h instanceof Set){const S=new Set;b.set(h,S);for(const C of h)S.add(c(C,void 0,x,b,w));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(l.isTypedArray(h)){const S=new(Object.getPrototypeOf(h)).constructor(h.length);b.set(h,S);for(let C=0;C<h.length;C++)S[C]=c(h[C],C,x,b,w);return S}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const S=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return b.set(h,S),d(S,h,x,b,w),S}if(typeof File<"u"&&h instanceof File){const S=new File([h],h.name,{type:h.type});return b.set(h,S),d(S,h,x,b,w),S}if(typeof Blob<"u"&&h instanceof Blob){const S=new Blob([h],{type:h.type});return b.set(h,S),d(S,h,x,b,w),S}if(h instanceof Error){const S=new h.constructor;return b.set(h,S),S.message=h.message,S.name=h.name,S.stack=h.stack,S.cause=h.cause,d(S,h,x,b,w),S}if(h instanceof Boolean){const S=new Boolean(h.valueOf());return b.set(h,S),d(S,h,x,b,w),S}if(h instanceof Number){const S=new Number(h.valueOf());return b.set(h,S),d(S,h,x,b,w),S}if(h instanceof String){const S=new String(h.valueOf());return b.set(h,S),d(S,h,x,b,w),S}if(typeof h=="object"&&u(h)){const S=Object.create(Object.getPrototypeOf(h));return b.set(h,S),d(S,h,x,b,w),S}return h}function d(h,m,x=h,b,w){const j=[...Object.keys(m),...n.getSymbols(m)];for(let S=0;S<j.length;S++){const C=j[S],A=Object.getOwnPropertyDescriptor(h,C);(A==null||A.writable)&&(h[C]=c(m[C],C,x,b,w))}}function u(h){switch(s.getTag(h)){case r.argumentsTag:case r.arrayTag:case r.arrayBufferTag:case r.dataViewTag:case r.booleanTag:case r.dateTag:case r.float32ArrayTag:case r.float64ArrayTag:case r.int8ArrayTag:case r.int16ArrayTag:case r.int32ArrayTag:case r.mapTag:case r.numberTag:case r.objectTag:case r.regexpTag:case r.setTag:case r.stringTag:case r.symbolTag:case r.uint8ArrayTag:case r.uint8ClampedArrayTag:case r.uint16ArrayTag:case r.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=c,t.copyProperties=d})(QA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=QA;function s(r){return n.cloneDeepWithImpl(r,void 0,r,new Map,void 0)}t.cloneDeep=s})(Sz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=GA,s=Sz;function r(i){return i=s.cloneDeep(i),l=>n.isMatch(l,i)}t.matches=r})(Nz);var Az={},kz={},Ez={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=QA,s=JA;function r(i,l){return n.cloneDeepWith(i,(o,c,d,u)=>{const h=l==null?void 0:l(o,c,d,u);if(h!==void 0)return h;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case s.numberTag:case s.stringTag:case s.booleanTag:{const m=new i.constructor(i==null?void 0:i.valueOf());return n.copyProperties(m,i),m}case s.argumentsTag:{const m={};return n.copyProperties(m,i),m.length=i.length,m[Symbol.iterator]=i[Symbol.iterator],m}default:return}})}t.cloneDeepWith=r})(Ez);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Ez;function s(r){return n.cloneDeepWith(r)}t.cloneDeep=s})(kz);var Tz={},ek={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;function s(r,i=Number.MAX_SAFE_INTEGER){switch(typeof r){case"number":return Number.isInteger(r)&&r>=0&&r<i;case"symbol":return!1;case"string":return n.test(r)}}t.isIndex=s})(ek);var Iz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=ZA;function s(r){return r!==null&&typeof r=="object"&&n.getTag(r)==="[object Arguments]"}t.isArguments=s})(Iz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=WA,s=ek,r=Iz,i=ev;function l(o,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&n.isDeepKey(c)&&(o==null?void 0:o[c])==null?d=i.toPath(c):d=[c],d.length===0)return!1;let u=o;for(let h=0;h<d.length;h++){const m=d[h];if((u==null||!Object.hasOwn(u,m))&&!((Array.isArray(u)||r.isArguments(u))&&s.isIndex(m)&&m<u.length))return!1;u=u[m]}return!0}t.has=l})(Tz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=GA,s=Jb,r=kz,i=Zb,l=Tz;function o(c,d){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=s.toKey(c);break}}return d=r.cloneDeep(d),function(u){const h=i.get(u,c);return h===void 0?l.has(u,c):d===void 0?h===void 0:n.isMatch(h,d)}}t.matchesProperty=o})(Az);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=qA,s=wz,r=Nz,i=Az;function l(o){if(o==null)return n.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):r.matches(o);case"string":case"symbol":case"number":return s.property(o)}}t.iteratee=l})(vz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=xz,s=qA,r=gz,i=vz;function l(o,c=s.identity){return r.isArrayLikeObject(o)?n.uniqBy(Array.from(o),i.iteratee(c)):[]}t.uniqBy=l})(pz);var Jye=pz.uniqBy;const tM=Ii(Jye);function ebe(t,n,s){return n===!0?tM(t,s):typeof n=="function"?tM(t,n):t}var tk=y.createContext(null),tbe=t=>t,Yn=()=>{var t=y.useContext(tk);return t?t.store.dispatch:tbe},Wg=()=>{},nbe=()=>Wg,sbe=(t,n)=>t===n;function yt(t){var n=y.useContext(tk);return QL.useSyncExternalStoreWithSelector(n?n.subscription.addNestedSub:nbe,n?n.store.getState:Wg,n?n.store.getState:Wg,n?t:Wg,sbe)}function rbe(t,n=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(n)}function abe(t,n=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(n)}function ibe(t,n="expected all items to be functions, instead received the following types: "){if(!t.every(s=>typeof s=="function")){const s=t.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${n}[${s}]`)}}var nM=t=>Array.isArray(t)?t:[t];function lbe(t){const n=Array.isArray(t[0])?t[0]:t;return ibe(n,"createSelector expects all input-selectors to be functions, but received the following types: "),n}function obe(t,n){const s=[],{length:r}=t;for(let i=0;i<r;i++)s.push(t[i].apply(null,n));return s}var cbe=class{constructor(t){this.value=t}deref(){return this.value}},dbe=typeof WeakRef<"u"?WeakRef:cbe,ube=0,sM=1;function q0(){return{s:ube,v:void 0,o:null,p:null}}function Pz(t,n={}){let s=q0();const{resultEqualityCheck:r}=n;let i,l=0;function o(){var m;let c=s;const{length:d}=arguments;for(let x=0,b=d;x<b;x++){const w=arguments[x];if(typeof w=="function"||typeof w=="object"&&w!==null){let j=c.o;j===null&&(c.o=j=new WeakMap);const S=j.get(w);S===void 0?(c=q0(),j.set(w,c)):c=S}else{let j=c.p;j===null&&(c.p=j=new Map);const S=j.get(w);S===void 0?(c=q0(),j.set(w,c)):c=S}}const u=c;let h;if(c.s===sM)h=c.v;else if(h=t.apply(null,arguments),l++,r){const x=((m=i==null?void 0:i.deref)==null?void 0:m.call(i))??i;x!=null&&r(x,h)&&(h=x,l!==0&&l--),i=typeof h=="object"&&h!==null||typeof h=="function"?new dbe(h):h}return u.s=sM,u.v=h,h}return o.clearCache=()=>{s=q0(),o.resetResultsCount()},o.resultsCount=()=>l,o.resetResultsCount=()=>{l=0},o}function fbe(t,...n){const s=typeof t=="function"?{memoize:t,memoizeOptions:n}:t,r=(...i)=>{let l=0,o=0,c,d={},u=i.pop();typeof u=="object"&&(d=u,u=i.pop()),rbe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const h={...s,...d},{memoize:m,memoizeOptions:x=[],argsMemoize:b=Pz,argsMemoizeOptions:w=[]}=h,j=nM(x),S=nM(w),C=lbe(i),A=m(function(){return l++,u.apply(null,arguments)},...j),k=b(function(){o++;const I=obe(C,arguments);return c=A.apply(null,I),c},...S);return Object.assign(k,{resultFunc:u,memoizedResultFunc:A,dependencies:C,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>c,recomputations:()=>l,resetRecomputations:()=>{l=0},memoize:m,argsMemoize:b})};return Object.assign(r,{withTypes:()=>r}),r}var Se=fbe(Pz),hbe=Object.assign((t,n=Se)=>{abe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const s=Object.keys(t),r=s.map(l=>t[l]);return n(r,(...l)=>l.reduce((o,c,d)=>(o[s[d]]=c,o),{}))},{withTypes:()=>hbe}),Mz={},Oz={},Dz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(r){return typeof r=="symbol"?1:r===null?2:r===void 0?3:r!==r?4:0}const s=(r,i,l)=>{if(r!==i){const o=n(r),c=n(i);if(o===c&&o===0){if(r<i)return l==="desc"?1:-1;if(r>i)return l==="desc"?-1:1}return l==="desc"?c-o:o-c}return 0};t.compareValues=s})(Dz);var Rz={},nk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return typeof s=="symbol"||s instanceof Symbol}t.isSymbol=n})(nk);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=nk,s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(l,o){return Array.isArray(l)?!1:typeof l=="number"||typeof l=="boolean"||l==null||n.isSymbol(l)?!0:typeof l=="string"&&(r.test(l)||!s.test(l))||o!=null&&Object.hasOwn(o,l)}t.isKey=i})(Rz);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Dz,s=Rz,r=ev;function i(l,o,c,d){if(l==null)return[];c=d?void 0:c,Array.isArray(l)||(l=Object.values(l)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(b=>String(b));const u=(b,w)=>{let j=b;for(let S=0;S<w.length&&j!=null;++S)j=j[w[S]];return j},h=(b,w)=>w==null||b==null?w:typeof b=="object"&&"key"in b?Object.hasOwn(w,b.key)?w[b.key]:u(w,b.path):typeof b=="function"?b(w):Array.isArray(b)?u(w,b):typeof w=="object"?w[b]:w,m=o.map(b=>(Array.isArray(b)&&b.length===1&&(b=b[0]),b==null||typeof b=="function"||Array.isArray(b)||s.isKey(b)?b:{key:b,path:r.toPath(b)}));return l.map(b=>({original:b,criteria:m.map(w=>h(w,b))})).slice().sort((b,w)=>{for(let j=0;j<m.length;j++){const S=n.compareValues(b.criteria[j],w.criteria[j],c[j]);if(S!==0)return S}return 0}).map(b=>b.original)}t.orderBy=i})(Oz);var Lz={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s,r=1){const i=[],l=Math.floor(r),o=(c,d)=>{for(let u=0;u<c.length;u++){const h=c[u];Array.isArray(h)&&d<l?o(h,d+1):i.push(h)}};return o(s,0),i}t.flatten=n})(Lz);var sk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=ek,s=nv,r=KA,i=XA;function l(o,c,d){return r.isObject(d)&&(typeof c=="number"&&s.isArrayLike(d)&&n.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?i.eq(d[c],o):!1}t.isIterateeCall=l})(sk);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=Oz,s=Lz,r=sk;function i(l,...o){const c=o.length;return c>1&&r.isIterateeCall(l,o[0],o[1])?o=[]:c>2&&r.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),n.orderBy(l,s.flatten(o),["asc"])}t.sortBy=i})(Mz);var mbe=Mz.sortBy;const sv=Ii(mbe);var Bz=t=>t.legend.settings,pbe=t=>t.legend.size,xbe=t=>t.legend.payload;Se([xbe,Bz],(t,n)=>{var{itemSorter:s}=n,r=t.flat(1);return s?sv(r,s):r});var G0=1;function gbe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[n,s]=y.useState({height:0,left:0,top:0,width:0}),r=y.useCallback(i=>{if(i!=null){var l=i.getBoundingClientRect(),o={height:l.height,left:l.left,top:l.top,width:l.width};(Math.abs(o.height-n.height)>G0||Math.abs(o.left-n.left)>G0||Math.abs(o.top-n.top)>G0||Math.abs(o.width-n.width)>G0)&&s({height:o.height,left:o.left,top:o.top,width:o.width})}},[n.width,n.height,n.top,n.left,...t]);return[n,r]}function vr(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var ybe=typeof Symbol=="function"&&Symbol.observable||"@@observable",rM=ybe,r2=()=>Math.random().toString(36).substring(7).split("").join("."),bbe={INIT:`@@redux/INIT${r2()}`,REPLACE:`@@redux/REPLACE${r2()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${r2()}`},ay=bbe;function rk(t){if(typeof t!="object"||t===null)return!1;let n=t;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n||Object.getPrototypeOf(t)===null}function Fz(t,n,s){if(typeof t!="function")throw new Error(vr(2));if(typeof n=="function"&&typeof s=="function"||typeof s=="function"&&typeof arguments[3]=="function")throw new Error(vr(0));if(typeof n=="function"&&typeof s>"u"&&(s=n,n=void 0),typeof s<"u"){if(typeof s!="function")throw new Error(vr(1));return s(Fz)(t,n)}let r=t,i=n,l=new Map,o=l,c=0,d=!1;function u(){o===l&&(o=new Map,l.forEach((S,C)=>{o.set(C,S)}))}function h(){if(d)throw new Error(vr(3));return i}function m(S){if(typeof S!="function")throw new Error(vr(4));if(d)throw new Error(vr(5));let C=!0;u();const A=c++;return o.set(A,S),function(){if(C){if(d)throw new Error(vr(6));C=!1,u(),o.delete(A),l=null}}}function x(S){if(!rk(S))throw new Error(vr(7));if(typeof S.type>"u")throw new Error(vr(8));if(typeof S.type!="string")throw new Error(vr(17));if(d)throw new Error(vr(9));try{d=!0,i=r(i,S)}finally{d=!1}return(l=o).forEach(A=>{A()}),S}function b(S){if(typeof S!="function")throw new Error(vr(10));r=S,x({type:ay.REPLACE})}function w(){const S=m;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(vr(11));function A(){const T=C;T.next&&T.next(h())}return A(),{unsubscribe:S(A)}},[rM](){return this}}}return x({type:ay.INIT}),{dispatch:x,subscribe:m,getState:h,replaceReducer:b,[rM]:w}}function vbe(t){Object.keys(t).forEach(n=>{const s=t[n];if(typeof s(void 0,{type:ay.INIT})>"u")throw new Error(vr(12));if(typeof s(void 0,{type:ay.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(vr(13))})}function $z(t){const n=Object.keys(t),s={};for(let l=0;l<n.length;l++){const o=n[l];typeof t[o]=="function"&&(s[o]=t[o])}const r=Object.keys(s);let i;try{vbe(s)}catch(l){i=l}return function(o={},c){if(i)throw i;let d=!1;const u={};for(let h=0;h<r.length;h++){const m=r[h],x=s[m],b=o[m],w=x(b,c);if(typeof w>"u")throw c&&c.type,new Error(vr(14));u[m]=w,d=d||w!==b}return d=d||r.length!==Object.keys(o).length,d?u:o}}function iy(...t){return t.length===0?n=>n:t.length===1?t[0]:t.reduce((n,s)=>(...r)=>n(s(...r)))}function wbe(...t){return n=>(s,r)=>{const i=n(s,r);let l=()=>{throw new Error(vr(15))};const o={getState:i.getState,dispatch:(d,...u)=>l(d,...u)},c=t.map(d=>d(o));return l=iy(...c)(i.dispatch),{...i,dispatch:l}}}function zz(t){return rk(t)&&"type"in t&&typeof t.type=="string"}var Uz=Symbol.for("immer-nothing"),aM=Symbol.for("immer-draftable"),Za=Symbol.for("immer-state");function qi(t,...n){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Kp=Object.getPrototypeOf;function gu(t){return!!t&&!!t[Za]}function Ao(t){var n;return t?Vz(t)||Array.isArray(t)||!!t[aM]||!!((n=t.constructor)!=null&&n[aM])||Ix(t)||av(t):!1}var Nbe=Object.prototype.constructor.toString(),iM=new WeakMap;function Vz(t){if(!t||typeof t!="object")return!1;const n=Object.getPrototypeOf(t);if(n===null||n===Object.prototype)return!0;const s=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;if(s===Object)return!0;if(typeof s!="function")return!1;let r=iM.get(s);return r===void 0&&(r=Function.toString.call(s),iM.set(s,r)),r===Nbe}function ly(t,n,s=!0){rv(t)===0?(s?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{n(i,t[i],t)}):t.forEach((r,i)=>n(i,r,t))}function rv(t){const n=t[Za];return n?n.type_:Array.isArray(t)?1:Ix(t)?2:av(t)?3:0}function o_(t,n){return rv(t)===2?t.has(n):Object.prototype.hasOwnProperty.call(t,n)}function Hz(t,n,s){const r=rv(t);r===2?t.set(n,s):r===3?t.add(s):t[n]=s}function jbe(t,n){return t===n?t!==0||1/t===1/n:t!==t&&n!==n}function Ix(t){return t instanceof Map}function av(t){return t instanceof Set}function Nd(t){return t.copy_||t.base_}function c_(t,n){if(Ix(t))return new Map(t);if(av(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const s=Vz(t);if(n===!0||n==="class_only"&&!s){const r=Object.getOwnPropertyDescriptors(t);delete r[Za];let i=Reflect.ownKeys(r);for(let l=0;l<i.length;l++){const o=i[l],c=r[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(r[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[o]})}return Object.create(Kp(t),r)}else{const r=Kp(t);if(r!==null&&s)return{...t};const i=Object.create(r);return Object.assign(i,t)}}function ak(t,n=!1){return iv(t)||gu(t)||!Ao(t)||(rv(t)>1&&Object.defineProperties(t,{set:K0,add:K0,clear:K0,delete:K0}),Object.freeze(t),n&&Object.values(t).forEach(s=>ak(s,!0))),t}function Sbe(){qi(2)}var K0={value:Sbe};function iv(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var _be={};function yu(t){const n=_be[t];return n||qi(0,t),n}var Yp;function Wz(){return Yp}function Cbe(t,n){return{drafts_:[],parent_:t,immer_:n,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function lM(t,n){n&&(yu("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=n)}function d_(t){u_(t),t.drafts_.forEach(Abe),t.drafts_=null}function u_(t){t===Yp&&(Yp=t.parent_)}function oM(t){return Yp=Cbe(Yp,t)}function Abe(t){const n=t[Za];n.type_===0||n.type_===1?n.revoke_():n.revoked_=!0}function cM(t,n){n.unfinalizedDrafts_=n.drafts_.length;const s=n.drafts_[0];return t!==void 0&&t!==s?(s[Za].modified_&&(d_(n),qi(4)),Ao(t)&&(t=oy(n,t),n.parent_||cy(n,t)),n.patches_&&yu("Patches").generateReplacementPatches_(s[Za].base_,t,n.patches_,n.inversePatches_)):t=oy(n,s,[]),d_(n),n.patches_&&n.patchListener_(n.patches_,n.inversePatches_),t!==Uz?t:void 0}function oy(t,n,s){if(iv(n))return n;const r=t.immer_.shouldUseStrictIteration(),i=n[Za];if(!i)return ly(n,(l,o)=>dM(t,i,n,l,o,s),r),n;if(i.scope_!==t)return n;if(!i.modified_)return cy(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const l=i.copy_;let o=l,c=!1;i.type_===3&&(o=new Set(l),l.clear(),c=!0),ly(o,(d,u)=>dM(t,i,l,d,u,s,c),r),cy(t,l,!1),s&&t.patches_&&yu("Patches").generatePatches_(i,s,t.patches_,t.inversePatches_)}return i.copy_}function dM(t,n,s,r,i,l,o){if(i==null||typeof i!="object"&&!o)return;const c=iv(i);if(!(c&&!o)){if(gu(i)){const d=l&&n&&n.type_!==3&&!o_(n.assigned_,r)?l.concat(r):void 0,u=oy(t,i,d);if(Hz(s,r,u),gu(u))t.canAutoFreeze_=!1;else return}else o&&s.add(i);if(Ao(i)&&!c){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||n&&n.base_&&n.base_[r]===i&&c)return;oy(t,i),(!n||!n.scope_.parent_)&&typeof r!="symbol"&&(Ix(s)?s.has(r):Object.prototype.propertyIsEnumerable.call(s,r))&&cy(t,i)}}}function cy(t,n,s=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ak(n,s)}function kbe(t,n){const s=Array.isArray(t),r={type_:s?1:0,scope_:n?n.scope_:Wz(),modified_:!1,finalized_:!1,assigned_:{},parent_:n,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,l=ik;s&&(i=[r],l=Xp);const{revoke:o,proxy:c}=Proxy.revocable(i,l);return r.draft_=c,r.revoke_=o,c}var ik={get(t,n){if(n===Za)return t;const s=Nd(t);if(!o_(s,n))return Ebe(t,s,n);const r=s[n];return t.finalized_||!Ao(r)?r:r===a2(t.base_,n)?(i2(t),t.copy_[n]=h_(r,t)):r},has(t,n){return n in Nd(t)},ownKeys(t){return Reflect.ownKeys(Nd(t))},set(t,n,s){const r=qz(Nd(t),n);if(r!=null&&r.set)return r.set.call(t.draft_,s),!0;if(!t.modified_){const i=a2(Nd(t),n),l=i==null?void 0:i[Za];if(l&&l.base_===s)return t.copy_[n]=s,t.assigned_[n]=!1,!0;if(jbe(s,i)&&(s!==void 0||o_(t.base_,n)))return!0;i2(t),f_(t)}return t.copy_[n]===s&&(s!==void 0||n in t.copy_)||Number.isNaN(s)&&Number.isNaN(t.copy_[n])||(t.copy_[n]=s,t.assigned_[n]=!0),!0},deleteProperty(t,n){return a2(t.base_,n)!==void 0||n in t.base_?(t.assigned_[n]=!1,i2(t),f_(t)):delete t.assigned_[n],t.copy_&&delete t.copy_[n],!0},getOwnPropertyDescriptor(t,n){const s=Nd(t),r=Reflect.getOwnPropertyDescriptor(s,n);return r&&{writable:!0,configurable:t.type_!==1||n!=="length",enumerable:r.enumerable,value:s[n]}},defineProperty(){qi(11)},getPrototypeOf(t){return Kp(t.base_)},setPrototypeOf(){qi(12)}},Xp={};ly(ik,(t,n)=>{Xp[t]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}});Xp.deleteProperty=function(t,n){return Xp.set.call(this,t,n,void 0)};Xp.set=function(t,n,s){return ik.set.call(this,t[0],n,s,t[0])};function a2(t,n){const s=t[Za];return(s?Nd(s):t)[n]}function Ebe(t,n,s){var i;const r=qz(n,s);return r?"value"in r?r.value:(i=r.get)==null?void 0:i.call(t.draft_):void 0}function qz(t,n){if(!(n in t))return;let s=Kp(t);for(;s;){const r=Object.getOwnPropertyDescriptor(s,n);if(r)return r;s=Kp(s)}}function f_(t){t.modified_||(t.modified_=!0,t.parent_&&f_(t.parent_))}function i2(t){t.copy_||(t.copy_=c_(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Tbe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(n,s,r)=>{if(typeof n=="function"&&typeof s!="function"){const l=s;s=n;const o=this;return function(d=l,...u){return o.produce(d,h=>s.call(this,h,...u))}}typeof s!="function"&&qi(6),r!==void 0&&typeof r!="function"&&qi(7);let i;if(Ao(n)){const l=oM(this),o=h_(n,void 0);let c=!0;try{i=s(o),c=!1}finally{c?d_(l):u_(l)}return lM(l,r),cM(i,l)}else if(!n||typeof n!="object"){if(i=s(n),i===void 0&&(i=n),i===Uz&&(i=void 0),this.autoFreeze_&&ak(i,!0),r){const l=[],o=[];yu("Patches").generateReplacementPatches_(n,i,l,o),r(l,o)}return i}else qi(1,n)},this.produceWithPatches=(n,s)=>{if(typeof n=="function")return(o,...c)=>this.produceWithPatches(o,d=>n(d,...c));let r,i;return[this.produce(n,s,(o,c)=>{r=o,i=c}),r,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Ao(t)||qi(8),gu(t)&&(t=xo(t));const n=oM(this),s=h_(t,void 0);return s[Za].isManual_=!0,u_(n),s}finishDraft(t,n){const s=t&&t[Za];(!s||!s.isManual_)&&qi(9);const{scope_:r}=s;return lM(r,n),cM(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,n){let s;for(s=n.length-1;s>=0;s--){const i=n[s];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}s>-1&&(n=n.slice(s+1));const r=yu("Patches").applyPatches_;return gu(t)?r(t,n):this.produce(t,i=>r(i,n))}};function h_(t,n){const s=Ix(t)?yu("MapSet").proxyMap_(t,n):av(t)?yu("MapSet").proxySet_(t,n):kbe(t,n);return(n?n.scope_:Wz()).drafts_.push(s),s}function xo(t){return gu(t)||qi(10,t),Gz(t)}function Gz(t){if(!Ao(t)||iv(t))return t;const n=t[Za];let s,r=!0;if(n){if(!n.modified_)return n.base_;n.finalized_=!0,s=c_(t,n.scope_.immer_.useStrictShallowCopy_),r=n.scope_.immer_.shouldUseStrictIteration()}else s=c_(t,!0);return ly(s,(i,l)=>{Hz(s,i,Gz(l))},r),n&&(n.finalized_=!1),s}var m_=new Tbe,Kz=m_.produce,Ibe=m_.setUseStrictIteration.bind(m_);function Yz(t){return({dispatch:s,getState:r})=>i=>l=>typeof l=="function"?l(s,r,t):i(l)}var Pbe=Yz(),Mbe=Yz,Obe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?iy:iy.apply(null,arguments)};function Ei(t,n){function s(...r){if(n){let i=n(...r);if(!i)throw new Error(qa(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:r[0]}}return s.toString=()=>`${t}`,s.type=t,s.match=r=>zz(r)&&r.type===t,s}var Xz=class Dm extends Array{constructor(...n){super(...n),Object.setPrototypeOf(this,Dm.prototype)}static get[Symbol.species](){return Dm}concat(...n){return super.concat.apply(this,n)}prepend(...n){return n.length===1&&Array.isArray(n[0])?new Dm(...n[0].concat(this)):new Dm(...n.concat(this))}};function uM(t){return Ao(t)?Kz(t,()=>{}):t}function Y0(t,n,s){return t.has(n)?t.get(n):t.set(n,s(n)).get(n)}function Dbe(t){return typeof t=="boolean"}var Rbe=()=>function(n){const{thunk:s=!0,immutableCheck:r=!0,serializableCheck:i=!0,actionCreatorCheck:l=!0}=n??{};let o=new Xz;return s&&(Dbe(s)?o.push(Pbe):o.push(Mbe(s.extraArgument))),o},Qz="RTK_autoBatch",qs=()=>t=>({payload:t,meta:{[Qz]:!0}}),fM=t=>n=>{setTimeout(n,t)},Zz=(t={type:"raf"})=>n=>(...s)=>{const r=n(...s);let i=!0,l=!1,o=!1;const c=new Set,d=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:fM(10):t.type==="callback"?t.queueNotification:fM(t.timeout),u=()=>{o=!1,l&&(l=!1,c.forEach(h=>h()))};return Object.assign({},r,{subscribe(h){const m=()=>i&&h(),x=r.subscribe(m);return c.add(h),()=>{x(),c.delete(h)}},dispatch(h){var m;try{return i=!((m=h==null?void 0:h.meta)!=null&&m[Qz]),l=!i,l&&(o||(o=!0,d(u))),r.dispatch(h)}finally{i=!0}}})},Lbe=t=>function(s){const{autoBatch:r=!0}=s??{};let i=new Xz(t);return r&&i.push(Zz(typeof r=="object"?r:void 0)),i};function Bbe(t){const n=Rbe(),{reducer:s=void 0,middleware:r,devTools:i=!0,preloadedState:l=void 0,enhancers:o=void 0}=t||{};let c;if(typeof s=="function")c=s;else if(rk(s))c=$z(s);else throw new Error(qa(1));let d;typeof r=="function"?d=r(n):d=n();let u=iy;i&&(u=Obe({trace:!1,...typeof i=="object"&&i}));const h=wbe(...d),m=Lbe(h);let x=typeof o=="function"?o(m):m();const b=u(...x);return Fz(c,l,b)}function Jz(t){const n={},s=[];let r;const i={addCase(l,o){const c=typeof l=="string"?l:l.type;if(!c)throw new Error(qa(28));if(c in n)throw new Error(qa(29));return n[c]=o,i},addAsyncThunk(l,o){return o.pending&&(n[l.pending.type]=o.pending),o.rejected&&(n[l.rejected.type]=o.rejected),o.fulfilled&&(n[l.fulfilled.type]=o.fulfilled),o.settled&&s.push({matcher:l.settled,reducer:o.settled}),i},addMatcher(l,o){return s.push({matcher:l,reducer:o}),i},addDefaultCase(l){return r=l,i}};return t(i),[n,s,r]}Ibe(!1);function Fbe(t){return typeof t=="function"}function $be(t,n){let[s,r,i]=Jz(n),l;if(Fbe(t))l=()=>uM(t());else{const c=uM(t);l=()=>c}function o(c=l(),d){let u=[s[d.type],...r.filter(({matcher:h})=>h(d)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[i]),u.reduce((h,m)=>{if(m)if(gu(h)){const b=m(h,d);return b===void 0?h:b}else{if(Ao(h))return Kz(h,x=>m(x,d));{const x=m(h,d);if(x===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return h},c)}return o.getInitialState=l,o}var zbe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Ube=(t=21)=>{let n="",s=t;for(;s--;)n+=zbe[Math.random()*64|0];return n},Vbe=Symbol.for("rtk-slice-createasyncthunk");function Hbe(t,n){return`${t}/${n}`}function Wbe({creators:t}={}){var s;const n=(s=t==null?void 0:t.asyncThunk)==null?void 0:s[Vbe];return function(i){const{name:l,reducerPath:o=l}=i;if(!l)throw new Error(qa(11));const c=(typeof i.reducers=="function"?i.reducers(Gbe()):i.reducers)||{},d=Object.keys(c),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(T,I){const D=typeof T=="string"?T:T.type;if(!D)throw new Error(qa(12));if(D in u.sliceCaseReducersByType)throw new Error(qa(13));return u.sliceCaseReducersByType[D]=I,h},addMatcher(T,I){return u.sliceMatchers.push({matcher:T,reducer:I}),h},exposeAction(T,I){return u.actionCreators[T]=I,h},exposeCaseReducer(T,I){return u.sliceCaseReducersByName[T]=I,h}};d.forEach(T=>{const I=c[T],D={reducerName:T,type:Hbe(l,T),createNotation:typeof i.reducers=="function"};Ybe(I)?Qbe(D,I,h,n):Kbe(D,I,h)});function m(){const[T={},I=[],D=void 0]=typeof i.extraReducers=="function"?Jz(i.extraReducers):[i.extraReducers],O={...T,...u.sliceCaseReducersByType};return $be(i.initialState,R=>{for(let P in O)R.addCase(P,O[P]);for(let P of u.sliceMatchers)R.addMatcher(P.matcher,P.reducer);for(let P of I)R.addMatcher(P.matcher,P.reducer);D&&R.addDefaultCase(D)})}const x=T=>T,b=new Map,w=new WeakMap;let j;function S(T,I){return j||(j=m()),j(T,I)}function C(){return j||(j=m()),j.getInitialState()}function A(T,I=!1){function D(R){let P=R[T];return typeof P>"u"&&I&&(P=Y0(w,D,C)),P}function O(R=x){const P=Y0(b,I,()=>new WeakMap);return Y0(P,R,()=>{const L={};for(const[$,B]of Object.entries(i.selectors??{}))L[$]=qbe(B,R,()=>Y0(w,R,C),I);return L})}return{reducerPath:T,getSelectors:O,get selectors(){return O(D)},selectSlice:D}}const k={name:l,reducer:S,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:C,...A(o),injectInto(T,{reducerPath:I,...D}={}){const O=I??o;return T.inject({reducerPath:O,reducer:S},D),{...k,...A(O,!0)}}};return k}}function qbe(t,n,s,r){function i(l,...o){let c=n(l);return typeof c>"u"&&r&&(c=s()),t(c,...o)}return i.unwrapped=t,i}var ka=Wbe();function Gbe(){function t(n,s){return{_reducerDefinitionType:"asyncThunk",payloadCreator:n,...s}}return t.withTypes=()=>t,{reducer(n){return Object.assign({[n.name](...s){return n(...s)}}[n.name],{_reducerDefinitionType:"reducer"})},preparedReducer(n,s){return{_reducerDefinitionType:"reducerWithPrepare",prepare:n,reducer:s}},asyncThunk:t}}function Kbe({type:t,reducerName:n,createNotation:s},r,i){let l,o;if("reducer"in r){if(s&&!Xbe(r))throw new Error(qa(17));l=r.reducer,o=r.prepare}else l=r;i.addCase(t,l).exposeCaseReducer(n,l).exposeAction(n,o?Ei(t,o):Ei(t))}function Ybe(t){return t._reducerDefinitionType==="asyncThunk"}function Xbe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Qbe({type:t,reducerName:n},s,r,i){if(!i)throw new Error(qa(18));const{payloadCreator:l,fulfilled:o,pending:c,rejected:d,settled:u,options:h}=s,m=i(t,l,h);r.exposeAction(n,m),o&&r.addCase(m.fulfilled,o),c&&r.addCase(m.pending,c),d&&r.addCase(m.rejected,d),u&&r.addMatcher(m.settled,u),r.exposeCaseReducer(n,{fulfilled:o||X0,pending:c||X0,rejected:d||X0,settled:u||X0})}function X0(){}var Zbe="task",eU="listener",tU="completed",lk="cancelled",Jbe=`task-${lk}`,eve=`task-${tU}`,p_=`${eU}-${lk}`,tve=`${eU}-${tU}`,lv=class{constructor(t){Ew(this,"name","TaskAbortError");Ew(this,"message");this.code=t,this.message=`${Zbe} ${lk} (reason: ${t})`}},ok=(t,n)=>{if(typeof t!="function")throw new TypeError(qa(32))},dy=()=>{},nU=(t,n=dy)=>(t.catch(n),t),sU=(t,n)=>(t.addEventListener("abort",n,{once:!0}),()=>t.removeEventListener("abort",n)),Jd=(t,n)=>{const s=t.signal;s.aborted||("reason"in s||Object.defineProperty(s,"reason",{enumerable:!0,value:n,configurable:!0,writable:!0}),t.abort(n))},eu=t=>{if(t.aborted){const{reason:n}=t;throw new lv(n)}};function rU(t,n){let s=dy;return new Promise((r,i)=>{const l=()=>i(new lv(t.reason));if(t.aborted){l();return}s=sU(t,l),n.finally(()=>s()).then(r,i)}).finally(()=>{s=dy})}var nve=async(t,n)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(s){return{status:s instanceof lv?"cancelled":"rejected",error:s}}finally{n==null||n()}},uy=t=>n=>nU(rU(t,n).then(s=>(eu(t),s))),aU=t=>{const n=uy(t);return s=>n(new Promise(r=>setTimeout(r,s)))},{assign:Lf}=Object,hM={},ov="listenerMiddleware",sve=(t,n)=>{const s=r=>sU(t,()=>Jd(r,t.reason));return(r,i)=>{ok(r);const l=new AbortController;s(l);const o=nve(async()=>{eu(t),eu(l.signal);const c=await r({pause:uy(l.signal),delay:aU(l.signal),signal:l.signal});return eu(l.signal),c},()=>Jd(l,eve));return i!=null&&i.autoJoin&&n.push(o.catch(dy)),{result:uy(t)(o),cancel(){Jd(l,Jbe)}}}},rve=(t,n)=>{const s=async(r,i)=>{eu(n);let l=()=>{};const c=[new Promise((d,u)=>{let h=t({predicate:r,effect:(m,x)=>{x.unsubscribe(),d([m,x.getState(),x.getOriginalState()])}});l=()=>{h(),u()}})];i!=null&&c.push(new Promise(d=>setTimeout(d,i,null)));try{const d=await rU(n,Promise.race(c));return eu(n),d}finally{l()}};return(r,i)=>nU(s(r,i))},iU=t=>{let{type:n,actionCreator:s,matcher:r,predicate:i,effect:l}=t;if(n)i=Ei(n).match;else if(s)n=s.type,i=s.match;else if(r)i=r;else if(!i)throw new Error(qa(21));return ok(l),{predicate:i,type:n,effect:l}},lU=Lf(t=>{const{type:n,predicate:s,effect:r}=iU(t);return{id:Ube(),effect:r,type:n,predicate:s,pending:new Set,unsubscribe:()=>{throw new Error(qa(22))}}},{withTypes:()=>lU}),mM=(t,n)=>{const{type:s,effect:r,predicate:i}=iU(n);return Array.from(t.values()).find(l=>(typeof s=="string"?l.type===s:l.predicate===i)&&l.effect===r)},x_=t=>{t.pending.forEach(n=>{Jd(n,p_)})},ave=(t,n)=>()=>{for(const s of n.keys())x_(s);t.clear()},pM=(t,n,s)=>{try{t(n,s)}catch(r){setTimeout(()=>{throw r},0)}},oU=Lf(Ei(`${ov}/add`),{withTypes:()=>oU}),ive=Ei(`${ov}/removeAll`),cU=Lf(Ei(`${ov}/remove`),{withTypes:()=>cU}),lve=(...t)=>{console.error(`${ov}/error`,...t)},Px=(t={})=>{const n=new Map,s=new Map,r=b=>{const w=s.get(b)??0;s.set(b,w+1)},i=b=>{const w=s.get(b)??1;w===1?s.delete(b):s.set(b,w-1)},{extra:l,onError:o=lve}=t;ok(o);const c=b=>(b.unsubscribe=()=>n.delete(b.id),n.set(b.id,b),w=>{b.unsubscribe(),w!=null&&w.cancelActive&&x_(b)}),d=b=>{const w=mM(n,b)??lU(b);return c(w)};Lf(d,{withTypes:()=>d});const u=b=>{const w=mM(n,b);return w&&(w.unsubscribe(),b.cancelActive&&x_(w)),!!w};Lf(u,{withTypes:()=>u});const h=async(b,w,j,S)=>{const C=new AbortController,A=rve(d,C.signal),k=[];try{b.pending.add(C),r(b),await Promise.resolve(b.effect(w,Lf({},j,{getOriginalState:S,condition:(T,I)=>A(T,I).then(Boolean),take:A,delay:aU(C.signal),pause:uy(C.signal),extra:l,signal:C.signal,fork:sve(C.signal,k),unsubscribe:b.unsubscribe,subscribe:()=>{n.set(b.id,b)},cancelActiveListeners:()=>{b.pending.forEach((T,I,D)=>{T!==C&&(Jd(T,p_),D.delete(T))})},cancel:()=>{Jd(C,p_),b.pending.delete(C)},throwIfCancelled:()=>{eu(C.signal)}})))}catch(T){T instanceof lv||pM(o,T,{raisedBy:"effect"})}finally{await Promise.all(k),Jd(C,tve),i(b),b.pending.delete(C)}},m=ave(n,s);return{middleware:b=>w=>j=>{if(!zz(j))return w(j);if(oU.match(j))return d(j.payload);if(ive.match(j)){m();return}if(cU.match(j))return u(j.payload);let S=b.getState();const C=()=>{if(S===hM)throw new Error(qa(23));return S};let A;try{if(A=w(j),n.size>0){const k=b.getState(),T=Array.from(n.values());for(const I of T){let D=!1;try{D=I.predicate(j,k,S)}catch(O){D=!1,pM(o,O,{raisedBy:"predicate"})}D&&h(I,j,b,C)}}}finally{S=hM}return A},startListening:d,stopListening:u,clearListeners:m}};function qa(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var ove={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},dU=ka({name:"chartLayout",initialState:ove,reducers:{setLayout(t,n){t.layoutType=n.payload},setChartSize(t,n){t.width=n.payload.width,t.height=n.payload.height},setMargin(t,n){var s,r,i,l;t.margin.top=(s=n.payload.top)!==null&&s!==void 0?s:0,t.margin.right=(r=n.payload.right)!==null&&r!==void 0?r:0,t.margin.bottom=(i=n.payload.bottom)!==null&&i!==void 0?i:0,t.margin.left=(l=n.payload.left)!==null&&l!==void 0?l:0},setScale(t,n){t.scale=n.payload}}}),{setMargin:cve,setLayout:dve,setChartSize:uve,setScale:fve}=dU.actions,hve=dU.reducer;function uU(t,n,s){return Array.isArray(t)&&t&&n+s!==0?t.slice(n,s+1):t}function xM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function _f(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?xM(Object(s),!0).forEach(function(r){mve(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):xM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function mve(t,n,s){return(n=pve(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function pve(t){var n=xve(t,"string");return typeof n=="symbol"?n:n+""}function xve(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function ns(t,n,s){return dr(t)||dr(n)?s:$l(n)?xu(t,n,s):typeof n=="function"?n(t):s}var gve=(t,n,s)=>{if(n&&s){var{width:r,height:i}=s,{align:l,verticalAlign:o,layout:c}=n;if((c==="vertical"||c==="horizontal"&&o==="middle")&&l!=="center"&&Ct(t[l]))return _f(_f({},t),{},{[l]:t[l]+(r||0)});if((c==="horizontal"||c==="vertical"&&l==="center")&&o!=="middle"&&Ct(t[o]))return _f(_f({},t),{},{[o]:t[o]+(i||0)})}return t},Lu=(t,n)=>t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis",gM=1e-4,yve=t=>{var n=t.domain();if(!(!n||n.length<=2)){var s=n.length,r=t.range(),i=Math.min(r[0],r[1])-gM,l=Math.max(r[0],r[1])+gM,o=t(n[0]),c=t(n[s-1]);(o<i||o>l||c<i||c>l)&&t.domain([n[0],n[s-1]])}},bve=(t,n)=>{if(!n||n.length!==2||!Ct(n[0])||!Ct(n[1]))return t;var s=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]),i=[t[0],t[1]];return(!Ct(t[0])||t[0]<s)&&(i[0]=s),(!Ct(t[1])||t[1]>r)&&(i[1]=r),i[0]>r&&(i[0]=r),i[1]<s&&(i[1]=s),i},vve=t=>{var n=t.length;if(!(n<=0))for(var s=0,r=t[0].length;s<r;++s)for(var i=0,l=0,o=0;o<n;++o){var c=Fl(t[o][s][1])?t[o][s][0]:t[o][s][1];c>=0?(t[o][s][0]=i,t[o][s][1]=i+c,i=t[o][s][1]):(t[o][s][0]=l,t[o][s][1]=l+c,l=t[o][s][1])}},wve=t=>{var n=t.length;if(!(n<=0))for(var s=0,r=t[0].length;s<r;++s)for(var i=0,l=0;l<n;++l){var o=Fl(t[l][s][1])?t[l][s][0]:t[l][s][1];o>=0?(t[l][s][0]=i,t[l][s][1]=i+o,i=t[l][s][1]):(t[l][s][0]=0,t[l][s][1]=0)}},Nve={sign:vve,expand:Tye,none:ah,silhouette:Iye,wiggle:Pye,positive:wve},jve=(t,n,s)=>{var r=Nve[s],i=Eye().keys(n).value((l,o)=>Number(ns(l,o,0))).order(i_).offset(r);return i(t)};function Sve(t){return t==null?void 0:String(t)}var yM=t=>{var{axis:n,ticks:s,offset:r,bandSize:i,entry:l,index:o}=t;if(n.type==="category")return s[o]?s[o].coordinate+r:null;var c=ns(l,n.dataKey,n.scale.domain()[o]);return dr(c)?null:n.scale(c)-i/2+r},_ve=t=>{var{numericAxis:n}=t,s=n.scale.domain();if(n.type==="number"){var r=Math.min(s[0],s[1]),i=Math.max(s[0],s[1]);return r<=0&&i>=0?0:i<0?i:r}return s[0]},Cve=t=>{var n=t.flat(2).filter(Ct);return[Math.min(...n),Math.max(...n)]},Ave=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],kve=(t,n,s)=>{if(t!=null)return Ave(Object.keys(t).reduce((r,i)=>{var l=t[i],{stackedData:o}=l,c=o.reduce((d,u)=>{var h=uU(u,n,s),m=Cve(h);return[Math.min(d[0],m[0]),Math.max(d[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],r[0]),Math.max(c[1],r[1])]},[1/0,-1/0]))},bM=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vM=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,fy=(t,n,s)=>{if(t&&t.scale&&t.scale.bandwidth){var r=t.scale.bandwidth();if(!s||r>0)return r}if(t&&n&&n.length>=2){for(var i=sv(n,h=>h.coordinate),l=1/0,o=1,c=i.length;o<c;o++){var d=i[o],u=i[o-1];l=Math.min((d.coordinate||0)-(u.coordinate||0),l)}return l===1/0?0:l}return s?void 0:0};function wM(t){var{tooltipEntrySettings:n,dataKey:s,payload:r,value:i,name:l}=t;return _f(_f({},n),{},{dataKey:s,payload:r,value:i,name:l})}function cv(t,n){if(t)return String(t);if(typeof n=="string")return n}var Eve=(t,n)=>{if(n==="horizontal")return t.chartX;if(n==="vertical")return t.chartY},Tve=(t,n)=>n==="centric"?t.angle:t.radius,Bo=t=>t.layout.width,Fo=t=>t.layout.height,Ive=t=>t.layout.scale,fU=t=>t.layout.margin,dv=Se(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),uv=Se(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),hU="data-recharts-item-index",mU="data-recharts-item-data-key",Mx=60;function NM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Q0(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?NM(Object(s),!0).forEach(function(r){Pve(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):NM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Pve(t,n,s){return(n=Mve(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Mve(t){var n=Ove(t,"string");return typeof n=="symbol"?n:n+""}function Ove(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Dve=t=>t.brush.height;function Rve(t){var n=uv(t);return n.reduce((s,r)=>{if(r.orientation==="left"&&!r.mirror&&!r.hide){var i=typeof r.width=="number"?r.width:Mx;return s+i}return s},0)}function Lve(t){var n=uv(t);return n.reduce((s,r)=>{if(r.orientation==="right"&&!r.mirror&&!r.hide){var i=typeof r.width=="number"?r.width:Mx;return s+i}return s},0)}function Bve(t){var n=dv(t);return n.reduce((s,r)=>r.orientation==="top"&&!r.mirror&&!r.hide?s+r.height:s,0)}function Fve(t){var n=dv(t);return n.reduce((s,r)=>r.orientation==="bottom"&&!r.mirror&&!r.hide?s+r.height:s,0)}var Zs=Se([Bo,Fo,fU,Dve,Rve,Lve,Bve,Fve,Bz,pbe],(t,n,s,r,i,l,o,c,d,u)=>{var h={left:(s.left||0)+i,right:(s.right||0)+l},m={top:(s.top||0)+o,bottom:(s.bottom||0)+c},x=Q0(Q0({},m),h),b=x.bottom;x.bottom+=r,x=gve(x,d,u);var w=t-x.left-x.right,j=n-x.top-x.bottom;return Q0(Q0({brushBottom:b},x),{},{width:Math.max(w,0),height:Math.max(j,0)})}),$ve=Se(Zs,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),ck=Se(Bo,Fo,(t,n)=>({x:0,y:0,width:t,height:n})),zve=y.createContext(null),ti=()=>y.useContext(zve)!=null,fv=t=>t.brush,hv=Se([fv,Zs,fU],(t,n,s)=>({height:t.height,x:Ct(t.x)?t.x:n.left,y:Ct(t.y)?t.y:n.top+n.height+n.brushBottom-((s==null?void 0:s.bottom)||0),width:Ct(t.width)?t.width:n.width})),pU={},xU={},gU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s,r,{signal:i,edges:l}={}){let o,c=null;const d=l!=null&&l.includes("leading"),u=l==null||l.includes("trailing"),h=()=>{c!==null&&(s.apply(o,c),o=void 0,c=null)},m=()=>{u&&h(),j()};let x=null;const b=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},r)},w=()=>{x!==null&&(clearTimeout(x),x=null)},j=()=>{w(),o=void 0,c=null},S=()=>{h()},C=function(...A){if(i!=null&&i.aborted)return;o=this,c=A;const k=x==null;b(),d&&k&&h()};return C.schedule=b,C.cancel=j,C.flush=S,i==null||i.addEventListener("abort",j,{once:!0}),C}t.debounce=n})(gU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=gU;function s(r,i=0,l={}){typeof l!="object"&&(l={});const{leading:o=!1,trailing:c=!0,maxWait:d}=l,u=Array(2);o&&(u[0]="leading"),c&&(u[1]="trailing");let h,m=null;const x=n.debounce(function(...j){h=r.apply(this,j),m=null},i,{edges:u}),b=function(...j){return d!=null&&(m===null&&(m=Date.now()),Date.now()-m>=d)?(h=r.apply(this,j),m=Date.now(),x.cancel(),x.schedule(),h):(x.apply(this,j),h)},w=()=>(x.flush(),h);return b.cancel=x.cancel,b.flush=w,b}t.debounce=s})(xU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=xU;function s(r,i=0,l={}){const{leading:o=!0,trailing:c=!0}=l;return n.debounce(r,i,{leading:o,maxWait:i,trailing:c})}t.throttle=s})(pU);var Uve=pU.throttle;const Vve=Ii(Uve);var jM=function(n,s){for(var r=arguments.length,i=new Array(r>2?r-2:0),l=2;l<r;l++)i[l-2]=arguments[l]},yU=(t,n,s)=>{var{width:r="100%",height:i="100%",aspect:l,maxHeight:o}=s,c=Co(r)?t:Number(r),d=Co(i)?n:Number(i);return l&&l>0&&(c?d=c/l:d&&(c=d*l),o&&d!=null&&d>o&&(d=o)),{calculatedWidth:c,calculatedHeight:d}},Hve={width:0,height:0,overflow:"visible"},Wve={width:0,overflowX:"visible"},qve={height:0,overflowY:"visible"},Gve={},Kve=t=>{var{width:n,height:s}=t,r=Co(n),i=Co(s);return r&&i?Hve:r?Wve:i?qve:Gve};function Yve(t){var{width:n,height:s,aspect:r}=t,i=n,l=s;return i===void 0&&l===void 0?(i="100%",l="100%"):i===void 0?i=r&&r>0?void 0:"100%":l===void 0&&(l=r&&r>0?void 0:"100%"),{width:i,height:l}}function Ns(t){return Number.isFinite(t)}function Hc(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function g_(){return g_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},g_.apply(null,arguments)}function SM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function _M(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?SM(Object(s),!0).forEach(function(r){Xve(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):SM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Xve(t,n,s){return(n=Qve(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Qve(t){var n=Zve(t,"string");return typeof n=="symbol"?n:n+""}function Zve(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var bU=y.createContext({width:-1,height:-1});function Jve(t){return Hc(t.width)&&Hc(t.height)}function vU(t){var{children:n,width:s,height:r}=t,i=y.useMemo(()=>({width:s,height:r}),[s,r]);return Jve(i)?y.createElement(bU.Provider,{value:i},n):null}var dk=()=>y.useContext(bU),ewe=y.forwardRef((t,n)=>{var{aspect:s,initialDimension:r={width:-1,height:-1},width:i,height:l,minWidth:o=0,minHeight:c,maxHeight:d,children:u,debounce:h=0,id:m,className:x,onResize:b,style:w={}}=t,j=y.useRef(null),S=y.useRef();S.current=b,y.useImperativeHandle(n,()=>j.current);var[C,A]=y.useState({containerWidth:r.width,containerHeight:r.height}),k=y.useCallback((R,P)=>{A(L=>{var $=Math.round(R),B=Math.round(P);return L.containerWidth===$&&L.containerHeight===B?L:{containerWidth:$,containerHeight:B}})},[]);y.useEffect(()=>{if(j.current==null||typeof ResizeObserver>"u")return Ru;var R=B=>{var V,{width:K,height:z}=B[0].contentRect;k(K,z),(V=S.current)===null||V===void 0||V.call(S,K,z)};h>0&&(R=Vve(R,h,{trailing:!0,leading:!1}));var P=new ResizeObserver(R),{width:L,height:$}=j.current.getBoundingClientRect();return k(L,$),P.observe(j.current),()=>{P.disconnect()}},[k,h]);var{containerWidth:T,containerHeight:I}=C;jM(!s||s>0,"The aspect(%s) must be greater than zero.",s);var{calculatedWidth:D,calculatedHeight:O}=yU(T,I,{width:i,height:l,aspect:s,maxHeight:d});return jM(D!=null&&D>0||O!=null&&O>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,D,O,i,l,o,c,s),y.createElement("div",{id:m?"".concat(m):void 0,className:fn("recharts-responsive-container",x),style:_M(_M({},w),{},{width:i,height:l,minWidth:o,minHeight:c,maxHeight:d}),ref:j},y.createElement("div",{style:Kve({width:i,height:l})},y.createElement(vU,{width:D,height:O},u)))}),Bd=y.forwardRef((t,n)=>{var s=dk();if(Hc(s.width)&&Hc(s.height))return t.children;var{width:r,height:i}=Yve({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:l,calculatedHeight:o}=yU(void 0,void 0,{width:r,height:i,aspect:t.aspect,maxHeight:t.maxHeight});return Ct(l)&&Ct(o)?y.createElement(vU,{width:l,height:o},t.children):y.createElement(ewe,g_({},t,{width:r,height:i,ref:n}))});function wU(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var mv=()=>{var t,n=ti(),s=yt($ve),r=yt(hv),i=(t=yt(fv))===null||t===void 0?void 0:t.padding;return!n||!r||!i?s:{width:r.width-i.left-i.right,height:r.height-i.top-i.bottom,x:i.left,y:i.top}},twe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},nwe=()=>{var t;return(t=yt(Zs))!==null&&t!==void 0?t:twe},swe=()=>yt(Bo),rwe=()=>yt(Fo),cn=t=>t.layout.layoutType,pv=()=>yt(cn),awe=()=>{var t=pv();return t!==void 0},xv=t=>{var n=Yn(),s=ti(),{width:r,height:i}=t,l=dk(),o=r,c=i;return l&&(o=l.width>0?l.width:r,c=l.height>0?l.height:i),y.useEffect(()=>{!s&&Hc(o)&&Hc(c)&&n(uve({width:o,height:c}))},[n,s,o,c]),null},iwe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},NU=ka({name:"legend",initialState:iwe,reducers:{setLegendSize(t,n){t.size.width=n.payload.width,t.size.height=n.payload.height},setLegendSettings(t,n){t.settings.align=n.payload.align,t.settings.layout=n.payload.layout,t.settings.verticalAlign=n.payload.verticalAlign,t.settings.itemSorter=n.payload.itemSorter},addLegendPayload:{reducer(t,n){t.payload.push(n.payload)},prepare:qs()},removeLegendPayload:{reducer(t,n){var s=xo(t).payload.indexOf(n.payload);s>-1&&t.payload.splice(s,1)},prepare:qs()}}}),{setLegendSize:$Le,setLegendSettings:zLe,addLegendPayload:jU,removeLegendPayload:SU}=NU.actions,lwe=NU.reducer;function y_(){return y_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},y_.apply(null,arguments)}function CM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function l2(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?CM(Object(s),!0).forEach(function(r){owe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):CM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function owe(t,n,s){return(n=cwe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function cwe(t){var n=dwe(t,"string");return typeof n=="symbol"?n:n+""}function dwe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function uwe(t){return Array.isArray(t)&&$l(t[0])&&$l(t[1])?t.join(" ~ "):t}var fwe=t=>{var{separator:n=" : ",contentStyle:s={},itemStyle:r={},labelStyle:i={},payload:l,formatter:o,itemSorter:c,wrapperClassName:d,labelClassName:u,label:h,labelFormatter:m,accessibilityLayer:x=!1}=t,b=()=>{if(l&&l.length){var I={padding:0,margin:0},D=(c?sv(l,c):l).map((O,R)=>{if(O.type==="none")return null;var P=O.formatter||o||uwe,{value:L,name:$}=O,B=L,V=$;if(P){var K=P(L,$,O,R,l);if(Array.isArray(K))[B,V]=K;else if(K!=null)B=K;else return null}var z=l2({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},r);return y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:z},$l(V)?y.createElement("span",{className:"recharts-tooltip-item-name"},V):null,$l(V)?y.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,y.createElement("span",{className:"recharts-tooltip-item-value"},B),y.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return y.createElement("ul",{className:"recharts-tooltip-item-list",style:I},D)}return null},w=l2({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),j=l2({margin:0},i),S=!dr(h),C=S?h:"",A=fn("recharts-default-tooltip",d),k=fn("recharts-tooltip-label",u);S&&m&&l!==void 0&&l!==null&&(C=m(h,l));var T=x?{role:"status","aria-live":"assertive"}:{};return y.createElement("div",y_({className:A,style:w},T),y.createElement("p",{className:k,style:j},y.isValidElement(C)?C:"".concat(C)),b())},xm="recharts-tooltip-wrapper",hwe={visibility:"hidden"};function mwe(t){var{coordinate:n,translateX:s,translateY:r}=t;return fn(xm,{["".concat(xm,"-right")]:Ct(s)&&n&&Ct(n.x)&&s>=n.x,["".concat(xm,"-left")]:Ct(s)&&n&&Ct(n.x)&&s<n.x,["".concat(xm,"-bottom")]:Ct(r)&&n&&Ct(n.y)&&r>=n.y,["".concat(xm,"-top")]:Ct(r)&&n&&Ct(n.y)&&r<n.y})}function AM(t){var{allowEscapeViewBox:n,coordinate:s,key:r,offsetTopLeft:i,position:l,reverseDirection:o,tooltipDimension:c,viewBox:d,viewBoxDimension:u}=t;if(l&&Ct(l[r]))return l[r];var h=s[r]-c-(i>0?i:0),m=s[r]+i;if(n[r])return o[r]?h:m;var x=d[r];if(x==null)return 0;if(o[r]){var b=h,w=x;return b<w?Math.max(m,x):Math.max(h,x)}if(u==null)return 0;var j=m+c,S=x+u;return j>S?Math.max(h,x):Math.max(m,x)}function pwe(t){var{translateX:n,translateY:s,useTranslate3d:r}=t;return{transform:r?"translate3d(".concat(n,"px, ").concat(s,"px, 0)"):"translate(".concat(n,"px, ").concat(s,"px)")}}function xwe(t){var{allowEscapeViewBox:n,coordinate:s,offsetTopLeft:r,position:i,reverseDirection:l,tooltipBox:o,useTranslate3d:c,viewBox:d}=t,u,h,m;return o.height>0&&o.width>0&&s?(h=AM({allowEscapeViewBox:n,coordinate:s,key:"x",offsetTopLeft:r,position:i,reverseDirection:l,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),m=AM({allowEscapeViewBox:n,coordinate:s,key:"y",offsetTopLeft:r,position:i,reverseDirection:l,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),u=pwe({translateX:h,translateY:m,useTranslate3d:c})):u=hwe,{cssProperties:u,cssClasses:mwe({translateX:h,translateY:m,coordinate:s})}}function kM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Z0(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?kM(Object(s),!0).forEach(function(r){b_(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):kM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function b_(t,n,s){return(n=gwe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function gwe(t){var n=ywe(t,"string");return typeof n=="symbol"?n:n+""}function ywe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}class bwe extends y.PureComponent{constructor(){super(...arguments),b_(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),b_(this,"handleKeyDown",n=>{if(n.key==="Escape"){var s,r,i,l;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==null&&s!==void 0?s:0,y:(i=(l=this.props.coordinate)===null||l===void 0?void 0:l.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var n,s;this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:n,allowEscapeViewBox:s,animationDuration:r,animationEasing:i,children:l,coordinate:o,hasPayload:c,isAnimationActive:d,offset:u,position:h,reverseDirection:m,useTranslate3d:x,viewBox:b,wrapperStyle:w,lastBoundingBox:j,innerRef:S,hasPortalFromProps:C}=this.props,{cssClasses:A,cssProperties:k}=xwe({allowEscapeViewBox:s,coordinate:o,offsetTopLeft:u,position:h,reverseDirection:m,tooltipBox:{height:j.height,width:j.width},useTranslate3d:x,viewBox:b}),T=C?{}:Z0(Z0({transition:d&&n?"transform ".concat(r,"ms ").concat(i):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&n&&c?"visible":"hidden",position:"absolute",top:0,left:0}),I=Z0(Z0({},T),{},{visibility:!this.state.dismissed&&n&&c?"visible":"hidden"},w);return y.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:A,style:I,ref:S},l)}}var vwe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Bu={devToolsEnabled:!1,isSsr:vwe()},_U=()=>{var t;return(t=yt(n=>n.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function v_(){return v_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},v_.apply(null,arguments)}function EM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function TM(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?EM(Object(s),!0).forEach(function(r){wwe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):EM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function wwe(t,n,s){return(n=Nwe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Nwe(t){var n=jwe(t,"string");return typeof n=="symbol"?n:n+""}function jwe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var IM={curveBasisClosed:yye,curveBasisOpen:bye,curveBasis:gye,curveBumpX:sye,curveBumpY:rye,curveLinearClosed:vye,curveLinear:Xb,curveMonotoneX:wye,curveMonotoneY:Nye,curveNatural:jye,curveStep:Sye,curveStepAfter:Cye,curveStepBefore:_ye},hy=t=>Ns(t.x)&&Ns(t.y),PM=t=>t.base!=null&&hy(t.base)&&hy(t),gm=t=>t.x,ym=t=>t.y,Swe=(t,n)=>{if(typeof t=="function")return t;var s="curve".concat(Tx(t));return(s==="curveMonotone"||s==="curveBump")&&n?IM["".concat(s).concat(n==="vertical"?"Y":"X")]:IM[s]||Xb},_we=t=>{var{type:n="linear",points:s=[],baseLine:r,layout:i,connectNulls:l=!1}=t,o=Swe(n,i),c=l?s.filter(hy):s,d;if(Array.isArray(r)){var u=s.map((b,w)=>TM(TM({},b),{},{base:r[w]}));i==="vertical"?d=W0().y(ym).x1(gm).x0(b=>b.base.x):d=W0().x(gm).y1(ym).y0(b=>b.base.y);var h=d.defined(PM).curve(o),m=l?u.filter(PM):u;return h(m)}i==="vertical"&&Ct(r)?d=W0().y(ym).x1(gm).x0(r):Ct(r)?d=W0().x(gm).y1(ym).y0(r):d=Z$().x(gm).y(ym);var x=d.defined(hy).curve(o);return x(c)},uk=t=>{var{className:n,points:s,path:r,pathRef:i}=t;if((!s||!s.length)&&!r)return null;var l=s&&s.length?_we(t):r;return y.createElement("path",v_({},Bl(t),Gye(t),{className:fn("recharts-curve",n),d:l===null?void 0:l,ref:i}))},Cwe=["x","y","top","left","width","height","className"];function w_(){return w_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},w_.apply(null,arguments)}function MM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Awe(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?MM(Object(s),!0).forEach(function(r){kwe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):MM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function kwe(t,n,s){return(n=Ewe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Ewe(t){var n=Twe(t,"string");return typeof n=="symbol"?n:n+""}function Twe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Iwe(t,n){if(t==null)return{};var s,r,i=Pwe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function Pwe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var Mwe=(t,n,s,r,i,l)=>"M".concat(t,",").concat(i,"v").concat(r,"M").concat(l,",").concat(n,"h").concat(s),Owe=t=>{var{x:n=0,y:s=0,top:r=0,left:i=0,width:l=0,height:o=0,className:c}=t,d=Iwe(t,Cwe),u=Awe({x:n,y:s,top:r,left:i,width:l,height:o},d);return!Ct(n)||!Ct(s)||!Ct(l)||!Ct(o)||!Ct(r)||!Ct(i)?null:y.createElement("path",w_({},ki(u),{className:fn("recharts-cross",c),d:Mwe(n,s,l,o,r,i)}))};function Dwe(t,n,s,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?n.x-i:s.left+.5,y:t==="horizontal"?s.top+.5:n.y-i,width:t==="horizontal"?r:s.width-1,height:t==="horizontal"?s.height-1:r}}function OM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function DM(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?OM(Object(s),!0).forEach(function(r){Rwe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):OM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Rwe(t,n,s){return(n=Lwe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Lwe(t){var n=Bwe(t,"string");return typeof n=="symbol"?n:n+""}function Bwe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Fwe=t=>t.replace(/([A-Z])/g,n=>"-".concat(n.toLowerCase())),CU=(t,n,s)=>t.map(r=>"".concat(Fwe(r)," ").concat(n,"ms ").concat(s)).join(","),$we=(t,n)=>[Object.keys(t),Object.keys(n)].reduce((s,r)=>s.filter(i=>r.includes(i))),Qp=(t,n)=>Object.keys(n).reduce((s,r)=>DM(DM({},s),{},{[r]:t(r,n[r])}),{});function RM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Hs(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?RM(Object(s),!0).forEach(function(r){zwe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):RM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function zwe(t,n,s){return(n=Uwe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Uwe(t){var n=Vwe(t,"string");return typeof n=="symbol"?n:n+""}function Vwe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var my=(t,n,s)=>t+(n-t)*s,N_=t=>{var{from:n,to:s}=t;return n!==s},AU=(t,n,s)=>{var r=Qp((i,l)=>{if(N_(l)){var[o,c]=t(l.from,l.to,l.velocity);return Hs(Hs({},l),{},{from:o,velocity:c})}return l},n);return s<1?Qp((i,l)=>N_(l)?Hs(Hs({},l),{},{velocity:my(l.velocity,r[i].velocity,s),from:my(l.from,r[i].from,s)}):l,n):AU(t,r,s-1)};function Hwe(t,n,s,r,i,l){var o,c=r.reduce((x,b)=>Hs(Hs({},x),{},{[b]:{from:t[b],velocity:0,to:n[b]}}),{}),d=()=>Qp((x,b)=>b.from,c),u=()=>!Object.values(c).filter(N_).length,h=null,m=x=>{o||(o=x);var b=x-o,w=b/s.dt;c=AU(s,c,w),i(Hs(Hs(Hs({},t),n),d())),o=x,u()||(h=l.setTimeout(m))};return()=>(h=l.setTimeout(m),()=>{var x;(x=h)===null||x===void 0||x()})}function Wwe(t,n,s,r,i,l,o){var c=null,d=i.reduce((m,x)=>Hs(Hs({},m),{},{[x]:[t[x],n[x]]}),{}),u,h=m=>{u||(u=m);var x=(m-u)/r,b=Qp((j,S)=>my(...S,s(x)),d);if(l(Hs(Hs(Hs({},t),n),b)),x<1)c=o.setTimeout(h);else{var w=Qp((j,S)=>my(...S,s(1)),d);l(Hs(Hs(Hs({},t),n),w))}};return()=>(c=o.setTimeout(h),()=>{var m;(m=c)===null||m===void 0||m()})}const qwe=(t,n,s,r,i,l)=>{var o=$we(t,n);return s==null?()=>(i(Hs(Hs({},t),n)),()=>{}):s.isStepper===!0?Hwe(t,n,s,o,i,l):Wwe(t,n,s,r,o,i,l)};var py=1e-4,kU=(t,n)=>[0,3*t,3*n-6*t,3*t-3*n+1],EU=(t,n)=>t.map((s,r)=>s*n**r).reduce((s,r)=>s+r),LM=(t,n)=>s=>{var r=kU(t,n);return EU(r,s)},Gwe=(t,n)=>s=>{var r=kU(t,n),i=[...r.map((l,o)=>l*o).slice(1),0];return EU(i,s)},Kwe=function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];if(s.length===1)switch(s[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i,l=s[0].split("(");if(l[0]==="cubic-bezier"&&((i=l[1])===null||i===void 0?void 0:i.split(")")[0].split(",").length)===4){var o=l[1].split(")")[0].split(",").map(c=>parseFloat(c));return[o[0],o[1],o[2],o[3]]}}}return s.length===4?s:[0,0,1,1]},Ywe=(t,n,s,r)=>{var i=LM(t,s),l=LM(n,r),o=Gwe(t,s),c=u=>u>1?1:u<0?0:u,d=u=>{for(var h=u>1?1:u,m=h,x=0;x<8;++x){var b=i(m)-h,w=o(m);if(Math.abs(b-h)<py||w<py)return l(m);m=c(m-b/w)}return l(m)};return d.isStepper=!1,d},BM=function(){return Ywe(...Kwe(...arguments))},Xwe=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:s=100,damping:r=8,dt:i=17}=n,l=(o,c,d)=>{var u=-(o-c)*s,h=d*r,m=d+(u-h)*i/1e3,x=d*i/1e3+o;return Math.abs(x-c)<py&&Math.abs(m)<py?[c,0]:[x,m]};return l.isStepper=!0,l.dt=i,l},Qwe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return BM(t);case"spring":return Xwe();default:if(t.split("(")[0]==="cubic-bezier")return BM(t)}return typeof t=="function"?t:null};function Zwe(t){var n,s=()=>null,r=!1,i=null,l=o=>{if(!r){if(Array.isArray(o)){if(!o.length)return;var c=o,[d,...u]=c;if(typeof d=="number"){i=t.setTimeout(l.bind(null,u),d);return}l(d),i=t.setTimeout(l.bind(null,u));return}typeof o=="string"&&(n=o,s(n)),typeof o=="object"&&(n=o,s(n)),typeof o=="function"&&o()}};return{stop:()=>{r=!0},start:o=>{r=!1,i&&(i(),i=null),l(o)},subscribe:o=>(s=o,()=>{s=()=>null}),getTimeoutController:()=>t}}class Jwe{setTimeout(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=performance.now(),i=null,l=o=>{o-r>=s?n(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(l))};return i=requestAnimationFrame(l),()=>{i!=null&&cancelAnimationFrame(i)}}}function eNe(){return Zwe(new Jwe)}var tNe=y.createContext(eNe);function nNe(t,n){var s=y.useContext(tNe);return y.useMemo(()=>n??s(t),[t,n,s])}var sNe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},FM={t:0},o2={t:1};function gv(t){var n=oa(t,sNe),{isActive:s,canBegin:r,duration:i,easing:l,begin:o,onAnimationEnd:c,onAnimationStart:d,children:u}=n,h=nNe(n.animationId,n.animationManager),[m,x]=y.useState(s?FM:o2),b=y.useRef(null);return y.useEffect(()=>{s||x(o2)},[s]),y.useEffect(()=>{if(!s||!r)return Ru;var w=qwe(FM,o2,Qwe(l),i,x,h.getTimeoutController()),j=()=>{b.current=w()};return h.start([d,o,j,i,c]),()=>{h.stop(),b.current&&b.current(),c()}},[s,r,i,l,o,d,c,h]),u(m.t)}function yv(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",s=y.useRef(Gp(n)),r=y.useRef(t);return r.current!==t&&(s.current=Gp(n),r.current=t),s.current}var rNe=["radius"],aNe=["radius"];function $M(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function zM(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?$M(Object(s),!0).forEach(function(r){iNe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$M(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function iNe(t,n,s){return(n=lNe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function lNe(t){var n=oNe(t,"string");return typeof n=="symbol"?n:n+""}function oNe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function xy(){return xy=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},xy.apply(null,arguments)}function UM(t,n){if(t==null)return{};var s,r,i=cNe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function cNe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var VM=(t,n,s,r,i)=>{var l=Math.min(Math.abs(s)/2,Math.abs(r)/2),o=r>=0?1:-1,c=s>=0?1:-1,d=r>=0&&s>=0||r<0&&s<0?1:0,u;if(l>0&&i instanceof Array){for(var h=[0,0,0,0],m=0,x=4;m<x;m++)h[m]=i[m]>l?l:i[m];u="M".concat(t,",").concat(n+o*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(d,",").concat(t+c*h[0],",").concat(n)),u+="L ".concat(t+s-c*h[1],",").concat(n),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(d,`,
        `).concat(t+s,",").concat(n+o*h[1])),u+="L ".concat(t+s,",").concat(n+r-o*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(d,`,
        `).concat(t+s-c*h[2],",").concat(n+r)),u+="L ".concat(t+c*h[3],",").concat(n+r),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(n+r-o*h[3])),u+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);u="M ".concat(t,",").concat(n+o*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+c*b,",").concat(n,`
            L `).concat(t+s-c*b,",").concat(n,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+s,",").concat(n+o*b,`
            L `).concat(t+s,",").concat(n+r-o*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t+s-c*b,",").concat(n+r,`
            L `).concat(t+c*b,",").concat(n+r,`
            A `).concat(b,",").concat(b,",0,0,").concat(d,",").concat(t,",").concat(n+r-o*b," Z")}else u="M ".concat(t,",").concat(n," h ").concat(s," v ").concat(r," h ").concat(-s," Z");return u},HM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},TU=t=>{var n=oa(t,HM),s=y.useRef(null),[r,i]=y.useState(-1);y.useEffect(()=>{if(s.current&&s.current.getTotalLength)try{var Y=s.current.getTotalLength();Y&&i(Y)}catch{}},[]);var{x:l,y:o,width:c,height:d,radius:u,className:h}=n,{animationEasing:m,animationDuration:x,animationBegin:b,isAnimationActive:w,isUpdateAnimationActive:j}=n,S=y.useRef(c),C=y.useRef(d),A=y.useRef(l),k=y.useRef(o),T=y.useMemo(()=>({x:l,y:o,width:c,height:d,radius:u}),[l,o,c,d,u]),I=yv(T,"rectangle-");if(l!==+l||o!==+o||c!==+c||d!==+d||c===0||d===0)return null;var D=fn("recharts-rectangle",h);if(!j){var O=ki(n),{radius:R}=O,P=UM(O,rNe);return y.createElement("path",xy({},P,{radius:typeof u=="number"?u:void 0,className:D,d:VM(l,o,c,d,u)}))}var L=S.current,$=C.current,B=A.current,V=k.current,K="0px ".concat(r===-1?1:r,"px"),z="".concat(r,"px 0px"),H=CU(["strokeDasharray"],x,typeof m=="string"?m:HM.animationEasing);return y.createElement(gv,{animationId:I,key:I,canBegin:r>0,duration:x,easing:m,isActive:j,begin:b},Y=>{var G=Vs(L,c,Y),J=Vs($,d,Y),ee=Vs(B,l,Y),ye=Vs(V,o,Y);s.current&&(S.current=G,C.current=J,A.current=ee,k.current=ye);var ie;w?Y>0?ie={transition:H,strokeDasharray:z}:ie={strokeDasharray:K}:ie={strokeDasharray:z};var he=ki(n),{radius:be}=he,we=UM(he,aNe);return y.createElement("path",xy({},we,{radius:typeof u=="number"?u:void 0,className:D,d:VM(ee,ye,G,J,u),ref:s,style:zM(zM({},ie),n.style)}))})};function WM(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function qM(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?WM(Object(s),!0).forEach(function(r){dNe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):WM(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function dNe(t,n,s){return(n=uNe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function uNe(t){var n=fNe(t,"string");return typeof n=="symbol"?n:n+""}function fNe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var gy=Math.PI/180,hNe=t=>t*180/Math.PI,Is=(t,n,s,r)=>({x:t+Math.cos(-gy*r)*s,y:n+Math.sin(-gy*r)*s}),IU=function(n,s){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(n-(r.left||0)-(r.right||0)),Math.abs(s-(r.top||0)-(r.bottom||0)))/2},mNe=(t,n)=>{var{x:s,y:r}=t,{x:i,y:l}=n;return Math.sqrt((s-i)**2+(r-l)**2)},pNe=(t,n)=>{var{x:s,y:r}=t,{cx:i,cy:l}=n,o=mNe({x:s,y:r},{x:i,y:l});if(o<=0)return{radius:o,angle:0};var c=(s-i)/o,d=Math.acos(c);return r>l&&(d=2*Math.PI-d),{radius:o,angle:hNe(d),angleInRadian:d}},xNe=t=>{var{startAngle:n,endAngle:s}=t,r=Math.floor(n/360),i=Math.floor(s/360),l=Math.min(r,i);return{startAngle:n-l*360,endAngle:s-l*360}},gNe=(t,n)=>{var{startAngle:s,endAngle:r}=n,i=Math.floor(s/360),l=Math.floor(r/360),o=Math.min(i,l);return t+o*360},yNe=(t,n)=>{var{chartX:s,chartY:r}=t,{radius:i,angle:l}=pNe({x:s,y:r},n),{innerRadius:o,outerRadius:c}=n;if(i<o||i>c||i===0)return null;var{startAngle:d,endAngle:u}=xNe(n),h=l,m;if(d<=u){for(;h>u;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=u}else{for(;h>d;)h-=360;for(;h<u;)h+=360;m=h>=u&&h<=d}return m?qM(qM({},n),{},{radius:i,angle:gNe(h,n)}):null};function PU(t){var{cx:n,cy:s,radius:r,startAngle:i,endAngle:l}=t,o=Is(n,s,r,i),c=Is(n,s,r,l);return{points:[o,c],cx:n,cy:s,radius:r,startAngle:i,endAngle:l}}function j_(){return j_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},j_.apply(null,arguments)}var bNe=(t,n)=>{var s=Cr(n-t),r=Math.min(Math.abs(n-t),359.999);return s*r},J0=t=>{var{cx:n,cy:s,radius:r,angle:i,sign:l,isExternal:o,cornerRadius:c,cornerIsExternal:d}=t,u=c*(o?1:-1)+r,h=Math.asin(c/u)/gy,m=d?i:i+l*h,x=Is(n,s,u,m),b=Is(n,s,r,m),w=d?i-l*h:i,j=Is(n,s,u*Math.cos(h*gy),w);return{center:x,circleTangency:b,lineTangency:j,theta:h}},MU=t=>{var{cx:n,cy:s,innerRadius:r,outerRadius:i,startAngle:l,endAngle:o}=t,c=bNe(l,o),d=l+c,u=Is(n,s,i,l),h=Is(n,s,i,d),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(l>d),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(r>0){var x=Is(n,s,r,l),b=Is(n,s,r,d);m+="L ".concat(b.x,",").concat(b.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(l<=d),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(n,",").concat(s," Z");return m},vNe=t=>{var{cx:n,cy:s,innerRadius:r,outerRadius:i,cornerRadius:l,forceCornerRadius:o,cornerIsExternal:c,startAngle:d,endAngle:u}=t,h=Cr(u-d),{circleTangency:m,lineTangency:x,theta:b}=J0({cx:n,cy:s,radius:i,angle:d,sign:h,cornerRadius:l,cornerIsExternal:c}),{circleTangency:w,lineTangency:j,theta:S}=J0({cx:n,cy:s,radius:i,angle:u,sign:-h,cornerRadius:l,cornerIsExternal:c}),C=c?Math.abs(d-u):Math.abs(d-u)-b-S;if(C<0)return o?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(l,",").concat(l,",0,0,1,").concat(l*2,`,0
        a`).concat(l,",").concat(l,",0,0,1,").concat(-l*2,`,0
      `):MU({cx:n,cy:s,innerRadius:r,outerRadius:i,startAngle:d,endAngle:u});var A="M ".concat(x.x,",").concat(x.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(C>180),",").concat(+(h<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(j.x,",").concat(j.y,`
  `);if(r>0){var{circleTangency:k,lineTangency:T,theta:I}=J0({cx:n,cy:s,radius:r,angle:d,sign:h,isExternal:!0,cornerRadius:l,cornerIsExternal:c}),{circleTangency:D,lineTangency:O,theta:R}=J0({cx:n,cy:s,radius:r,angle:u,sign:-h,isExternal:!0,cornerRadius:l,cornerIsExternal:c}),P=c?Math.abs(d-u):Math.abs(d-u)-I-R;if(P<0&&l===0)return"".concat(A,"L").concat(n,",").concat(s,"Z");A+="L".concat(O.x,",").concat(O.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(P>180),",").concat(+(h>0),",").concat(k.x,",").concat(k.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,"Z")}else A+="L".concat(n,",").concat(s,"Z");return A},wNe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},OU=t=>{var n=oa(t,wNe),{cx:s,cy:r,innerRadius:i,outerRadius:l,cornerRadius:o,forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h,className:m}=n;if(l<i||u===h)return null;var x=fn("recharts-sector",m),b=l-i,w=Vr(o,b,0,!0),j;return w>0&&Math.abs(u-h)<360?j=vNe({cx:s,cy:r,innerRadius:i,outerRadius:l,cornerRadius:Math.min(w,b/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h}):j=MU({cx:s,cy:r,innerRadius:i,outerRadius:l,startAngle:u,endAngle:h}),y.createElement("path",j_({},ki(n),{className:x,d:j}))};function NNe(t,n,s){if(t==="horizontal")return[{x:n.x,y:s.top},{x:n.x,y:s.top+s.height}];if(t==="vertical")return[{x:s.left,y:n.y},{x:s.left+s.width,y:n.y}];if(mz(n)){if(t==="centric"){var{cx:r,cy:i,innerRadius:l,outerRadius:o,angle:c}=n,d=Is(r,i,l,c),u=Is(r,i,o,c);return[{x:d.x,y:d.y},{x:u.x,y:u.y}]}return PU(n)}}var DU={},RU={},LU={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=nk;function s(r){return n.isSymbol(r)?NaN:Number(r)}t.toNumber=s})(LU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=LU;function s(r){return r?(r=n.toNumber(r),r===1/0||r===-1/0?(r<0?-1:1)*Number.MAX_VALUE:r===r?r:0):r===0?r:0}t.toFinite=s})(RU);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=sk,s=RU;function r(i,l,o){o&&typeof o!="number"&&n.isIterateeCall(i,l,o)&&(l=o=void 0),i=s.toFinite(i),l===void 0?(l=i,i=0):l=s.toFinite(l),o=o===void 0?i<l?1:-1:s.toFinite(o);const c=Math.max(Math.ceil((l-i)/(o||1)),0),d=new Array(c);for(let u=0;u<c;u++)d[u]=i,i+=o;return d}t.range=r})(DU);var jNe=DU.range;const BU=Ii(jNe);function Mc(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function SNe(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function fk(t){let n,s,r;t.length!==2?(n=Mc,s=(c,d)=>Mc(t(c),d),r=(c,d)=>t(c)-d):(n=t===Mc||t===SNe?t:_Ne,s=t,r=t);function i(c,d,u=0,h=c.length){if(u<h){if(n(d,d)!==0)return h;do{const m=u+h>>>1;s(c[m],d)<0?u=m+1:h=m}while(u<h)}return u}function l(c,d,u=0,h=c.length){if(u<h){if(n(d,d)!==0)return h;do{const m=u+h>>>1;s(c[m],d)<=0?u=m+1:h=m}while(u<h)}return u}function o(c,d,u=0,h=c.length){const m=i(c,d,u,h-1);return m>u&&r(c[m-1],d)>-r(c[m],d)?m-1:m}return{left:i,center:o,right:l}}function _Ne(){return 0}function FU(t){return t===null?NaN:+t}function*CNe(t,n){for(let s of t)s!=null&&(s=+s)>=s&&(yield s)}const ANe=fk(Mc),Ox=ANe.right;fk(FU).center;class GM extends Map{constructor(n,s=TNe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:s}}),n!=null)for(const[r,i]of n)this.set(r,i)}get(n){return super.get(KM(this,n))}has(n){return super.has(KM(this,n))}set(n,s){return super.set(kNe(this,n),s)}delete(n){return super.delete(ENe(this,n))}}function KM({_intern:t,_key:n},s){const r=n(s);return t.has(r)?t.get(r):s}function kNe({_intern:t,_key:n},s){const r=n(s);return t.has(r)?t.get(r):(t.set(r,s),s)}function ENe({_intern:t,_key:n},s){const r=n(s);return t.has(r)&&(s=t.get(r),t.delete(r)),s}function TNe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function INe(t=Mc){if(t===Mc)return $U;if(typeof t!="function")throw new TypeError("compare is not a function");return(n,s)=>{const r=t(n,s);return r||r===0?r:(t(s,s)===0)-(t(n,n)===0)}}function $U(t,n){return(t==null||!(t>=t))-(n==null||!(n>=n))||(t<n?-1:t>n?1:0)}const PNe=Math.sqrt(50),MNe=Math.sqrt(10),ONe=Math.sqrt(2);function yy(t,n,s){const r=(n-t)/Math.max(0,s),i=Math.floor(Math.log10(r)),l=r/Math.pow(10,i),o=l>=PNe?10:l>=MNe?5:l>=ONe?2:1;let c,d,u;return i<0?(u=Math.pow(10,-i)/o,c=Math.round(t*u),d=Math.round(n*u),c/u<t&&++c,d/u>n&&--d,u=-u):(u=Math.pow(10,i)*o,c=Math.round(t/u),d=Math.round(n/u),c*u<t&&++c,d*u>n&&--d),d<c&&.5<=s&&s<2?yy(t,n,s*2):[c,d,u]}function S_(t,n,s){if(n=+n,t=+t,s=+s,!(s>0))return[];if(t===n)return[t];const r=n<t,[i,l,o]=r?yy(n,t,s):yy(t,n,s);if(!(l>=i))return[];const c=l-i+1,d=new Array(c);if(r)if(o<0)for(let u=0;u<c;++u)d[u]=(l-u)/-o;else for(let u=0;u<c;++u)d[u]=(l-u)*o;else if(o<0)for(let u=0;u<c;++u)d[u]=(i+u)/-o;else for(let u=0;u<c;++u)d[u]=(i+u)*o;return d}function __(t,n,s){return n=+n,t=+t,s=+s,yy(t,n,s)[2]}function C_(t,n,s){n=+n,t=+t,s=+s;const r=n<t,i=r?__(n,t,s):__(t,n,s);return(r?-1:1)*(i<0?1/-i:i)}function YM(t,n){let s;for(const r of t)r!=null&&(s<r||s===void 0&&r>=r)&&(s=r);return s}function XM(t,n){let s;for(const r of t)r!=null&&(s>r||s===void 0&&r>=r)&&(s=r);return s}function zU(t,n,s=0,r=1/0,i){if(n=Math.floor(n),s=Math.floor(Math.max(0,s)),r=Math.floor(Math.min(t.length-1,r)),!(s<=n&&n<=r))return t;for(i=i===void 0?$U:INe(i);r>s;){if(r-s>600){const d=r-s+1,u=n-s+1,h=Math.log(d),m=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*m*(d-m)/d)*(u-d/2<0?-1:1),b=Math.max(s,Math.floor(n-u*m/d+x)),w=Math.min(r,Math.floor(n+(d-u)*m/d+x));zU(t,n,b,w,i)}const l=t[n];let o=s,c=r;for(bm(t,s,n),i(t[r],l)>0&&bm(t,s,r);o<c;){for(bm(t,o,c),++o,--c;i(t[o],l)<0;)++o;for(;i(t[c],l)>0;)--c}i(t[s],l)===0?bm(t,s,c):(++c,bm(t,c,r)),c<=n&&(s=c+1),n<=c&&(r=c-1)}return t}function bm(t,n,s){const r=t[n];t[n]=t[s],t[s]=r}function DNe(t,n,s){if(t=Float64Array.from(CNe(t)),!(!(r=t.length)||isNaN(n=+n))){if(n<=0||r<2)return XM(t);if(n>=1)return YM(t);var r,i=(r-1)*n,l=Math.floor(i),o=YM(zU(t,l).subarray(0,l+1)),c=XM(t.subarray(l+1));return o+(c-o)*(i-l)}}function RNe(t,n,s=FU){if(!(!(r=t.length)||isNaN(n=+n))){if(n<=0||r<2)return+s(t[0],0,t);if(n>=1)return+s(t[r-1],r-1,t);var r,i=(r-1)*n,l=Math.floor(i),o=+s(t[l],l,t),c=+s(t[l+1],l+1,t);return o+(c-o)*(i-l)}}function LNe(t,n,s){t=+t,n=+n,s=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+s;for(var r=-1,i=Math.max(0,Math.ceil((n-t)/s))|0,l=new Array(i);++r<i;)l[r]=t+r*s;return l}function Pi(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function $o(t,n){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const A_=Symbol("implicit");function hk(){var t=new GM,n=[],s=[],r=A_;function i(l){let o=t.get(l);if(o===void 0){if(r!==A_)return r;t.set(l,o=n.push(l)-1)}return s[o%s.length]}return i.domain=function(l){if(!arguments.length)return n.slice();n=[],t=new GM;for(const o of l)t.has(o)||t.set(o,n.push(o)-1);return i},i.range=function(l){return arguments.length?(s=Array.from(l),i):s.slice()},i.unknown=function(l){return arguments.length?(r=l,i):r},i.copy=function(){return hk(n,s).unknown(r)},Pi.apply(i,arguments),i}function mk(){var t=hk().unknown(void 0),n=t.domain,s=t.range,r=0,i=1,l,o,c=!1,d=0,u=0,h=.5;delete t.unknown;function m(){var x=n().length,b=i<r,w=b?i:r,j=b?r:i;l=(j-w)/Math.max(1,x-d+u*2),c&&(l=Math.floor(l)),w+=(j-w-l*(x-d))*h,o=l*(1-d),c&&(w=Math.round(w),o=Math.round(o));var S=LNe(x).map(function(C){return w+l*C});return s(b?S.reverse():S)}return t.domain=function(x){return arguments.length?(n(x),m()):n()},t.range=function(x){return arguments.length?([r,i]=x,r=+r,i=+i,m()):[r,i]},t.rangeRound=function(x){return[r,i]=x,r=+r,i=+i,c=!0,m()},t.bandwidth=function(){return o},t.step=function(){return l},t.round=function(x){return arguments.length?(c=!!x,m()):c},t.padding=function(x){return arguments.length?(d=Math.min(1,u=+x),m()):d},t.paddingInner=function(x){return arguments.length?(d=Math.min(1,x),m()):d},t.paddingOuter=function(x){return arguments.length?(u=+x,m()):u},t.align=function(x){return arguments.length?(h=Math.max(0,Math.min(1,x)),m()):h},t.copy=function(){return mk(n(),[r,i]).round(c).paddingInner(d).paddingOuter(u).align(h)},Pi.apply(m(),arguments)}function UU(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return UU(n())},t}function BNe(){return UU(mk.apply(null,arguments).paddingInner(1))}function pk(t,n,s){t.prototype=n.prototype=s,s.constructor=t}function VU(t,n){var s=Object.create(t.prototype);for(var r in n)s[r]=n[r];return s}function Dx(){}var Zp=.7,by=1/Zp,Bf="\\s*([+-]?\\d+)\\s*",Jp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ol="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",FNe=/^#([0-9a-f]{3,8})$/,$Ne=new RegExp(`^rgb\\(${Bf},${Bf},${Bf}\\)$`),zNe=new RegExp(`^rgb\\(${Ol},${Ol},${Ol}\\)$`),UNe=new RegExp(`^rgba\\(${Bf},${Bf},${Bf},${Jp}\\)$`),VNe=new RegExp(`^rgba\\(${Ol},${Ol},${Ol},${Jp}\\)$`),HNe=new RegExp(`^hsl\\(${Jp},${Ol},${Ol}\\)$`),WNe=new RegExp(`^hsla\\(${Jp},${Ol},${Ol},${Jp}\\)$`),QM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pk(Dx,ex,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ZM,formatHex:ZM,formatHex8:qNe,formatHsl:GNe,formatRgb:JM,toString:JM});function ZM(){return this.rgb().formatHex()}function qNe(){return this.rgb().formatHex8()}function GNe(){return HU(this).formatHsl()}function JM(){return this.rgb().formatRgb()}function ex(t){var n,s;return t=(t+"").trim().toLowerCase(),(n=FNe.exec(t))?(s=n[1].length,n=parseInt(n[1],16),s===6?eO(n):s===3?new ya(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):s===8?eg(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):s===4?eg(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=$Ne.exec(t))?new ya(n[1],n[2],n[3],1):(n=zNe.exec(t))?new ya(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=UNe.exec(t))?eg(n[1],n[2],n[3],n[4]):(n=VNe.exec(t))?eg(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=HNe.exec(t))?sO(n[1],n[2]/100,n[3]/100,1):(n=WNe.exec(t))?sO(n[1],n[2]/100,n[3]/100,n[4]):QM.hasOwnProperty(t)?eO(QM[t]):t==="transparent"?new ya(NaN,NaN,NaN,0):null}function eO(t){return new ya(t>>16&255,t>>8&255,t&255,1)}function eg(t,n,s,r){return r<=0&&(t=n=s=NaN),new ya(t,n,s,r)}function KNe(t){return t instanceof Dx||(t=ex(t)),t?(t=t.rgb(),new ya(t.r,t.g,t.b,t.opacity)):new ya}function k_(t,n,s,r){return arguments.length===1?KNe(t):new ya(t,n,s,r??1)}function ya(t,n,s,r){this.r=+t,this.g=+n,this.b=+s,this.opacity=+r}pk(ya,k_,VU(Dx,{brighter(t){return t=t==null?by:Math.pow(by,t),new ya(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Zp:Math.pow(Zp,t),new ya(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ya(tu(this.r),tu(this.g),tu(this.b),vy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tO,formatHex:tO,formatHex8:YNe,formatRgb:nO,toString:nO}));function tO(){return`#${Fd(this.r)}${Fd(this.g)}${Fd(this.b)}`}function YNe(){return`#${Fd(this.r)}${Fd(this.g)}${Fd(this.b)}${Fd((isNaN(this.opacity)?1:this.opacity)*255)}`}function nO(){const t=vy(this.opacity);return`${t===1?"rgb(":"rgba("}${tu(this.r)}, ${tu(this.g)}, ${tu(this.b)}${t===1?")":`, ${t})`}`}function vy(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function tu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Fd(t){return t=tu(t),(t<16?"0":"")+t.toString(16)}function sO(t,n,s,r){return r<=0?t=n=s=NaN:s<=0||s>=1?t=n=NaN:n<=0&&(t=NaN),new Gi(t,n,s,r)}function HU(t){if(t instanceof Gi)return new Gi(t.h,t.s,t.l,t.opacity);if(t instanceof Dx||(t=ex(t)),!t)return new Gi;if(t instanceof Gi)return t;t=t.rgb();var n=t.r/255,s=t.g/255,r=t.b/255,i=Math.min(n,s,r),l=Math.max(n,s,r),o=NaN,c=l-i,d=(l+i)/2;return c?(n===l?o=(s-r)/c+(s<r)*6:s===l?o=(r-n)/c+2:o=(n-s)/c+4,c/=d<.5?l+i:2-l-i,o*=60):c=d>0&&d<1?0:o,new Gi(o,c,d,t.opacity)}function XNe(t,n,s,r){return arguments.length===1?HU(t):new Gi(t,n,s,r??1)}function Gi(t,n,s,r){this.h=+t,this.s=+n,this.l=+s,this.opacity=+r}pk(Gi,XNe,VU(Dx,{brighter(t){return t=t==null?by:Math.pow(by,t),new Gi(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Zp:Math.pow(Zp,t),new Gi(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,s=this.l,r=s+(s<.5?s:1-s)*n,i=2*s-r;return new ya(c2(t>=240?t-240:t+120,i,r),c2(t,i,r),c2(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Gi(rO(this.h),tg(this.s),tg(this.l),vy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=vy(this.opacity);return`${t===1?"hsl(":"hsla("}${rO(this.h)}, ${tg(this.s)*100}%, ${tg(this.l)*100}%${t===1?")":`, ${t})`}`}}));function rO(t){return t=(t||0)%360,t<0?t+360:t}function tg(t){return Math.max(0,Math.min(1,t||0))}function c2(t,n,s){return(t<60?n+(s-n)*t/60:t<180?s:t<240?n+(s-n)*(240-t)/60:n)*255}const xk=t=>()=>t;function QNe(t,n){return function(s){return t+s*n}}function ZNe(t,n,s){return t=Math.pow(t,s),n=Math.pow(n,s)-t,s=1/s,function(r){return Math.pow(t+r*n,s)}}function JNe(t){return(t=+t)==1?WU:function(n,s){return s-n?ZNe(n,s,t):xk(isNaN(n)?s:n)}}function WU(t,n){var s=n-t;return s?QNe(t,s):xk(isNaN(t)?n:t)}const aO=function t(n){var s=JNe(n);function r(i,l){var o=s((i=k_(i)).r,(l=k_(l)).r),c=s(i.g,l.g),d=s(i.b,l.b),u=WU(i.opacity,l.opacity);return function(h){return i.r=o(h),i.g=c(h),i.b=d(h),i.opacity=u(h),i+""}}return r.gamma=t,r}(1);function e2e(t,n){n||(n=[]);var s=t?Math.min(n.length,t.length):0,r=n.slice(),i;return function(l){for(i=0;i<s;++i)r[i]=t[i]*(1-l)+n[i]*l;return r}}function t2e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function n2e(t,n){var s=n?n.length:0,r=t?Math.min(s,t.length):0,i=new Array(r),l=new Array(s),o;for(o=0;o<r;++o)i[o]=Ih(t[o],n[o]);for(;o<s;++o)l[o]=n[o];return function(c){for(o=0;o<r;++o)l[o]=i[o](c);return l}}function s2e(t,n){var s=new Date;return t=+t,n=+n,function(r){return s.setTime(t*(1-r)+n*r),s}}function wy(t,n){return t=+t,n=+n,function(s){return t*(1-s)+n*s}}function r2e(t,n){var s={},r={},i;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(i in n)i in t?s[i]=Ih(t[i],n[i]):r[i]=n[i];return function(l){for(i in s)r[i]=s[i](l);return r}}var E_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d2=new RegExp(E_.source,"g");function a2e(t){return function(){return t}}function i2e(t){return function(n){return t(n)+""}}function l2e(t,n){var s=E_.lastIndex=d2.lastIndex=0,r,i,l,o=-1,c=[],d=[];for(t=t+"",n=n+"";(r=E_.exec(t))&&(i=d2.exec(n));)(l=i.index)>s&&(l=n.slice(s,l),c[o]?c[o]+=l:c[++o]=l),(r=r[0])===(i=i[0])?c[o]?c[o]+=i:c[++o]=i:(c[++o]=null,d.push({i:o,x:wy(r,i)})),s=d2.lastIndex;return s<n.length&&(l=n.slice(s),c[o]?c[o]+=l:c[++o]=l),c.length<2?d[0]?i2e(d[0].x):a2e(n):(n=d.length,function(u){for(var h=0,m;h<n;++h)c[(m=d[h]).i]=m.x(u);return c.join("")})}function Ih(t,n){var s=typeof n,r;return n==null||s==="boolean"?xk(n):(s==="number"?wy:s==="string"?(r=ex(n))?(n=r,aO):l2e:n instanceof ex?aO:n instanceof Date?s2e:t2e(n)?e2e:Array.isArray(n)?n2e:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?r2e:wy)(t,n)}function gk(t,n){return t=+t,n=+n,function(s){return Math.round(t*(1-s)+n*s)}}function o2e(t,n){n===void 0&&(n=t,t=Ih);for(var s=0,r=n.length-1,i=n[0],l=new Array(r<0?0:r);s<r;)l[s]=t(i,i=n[++s]);return function(o){var c=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return l[c](o-c)}}function c2e(t){return function(){return t}}function Ny(t){return+t}var iO=[0,1];function na(t){return t}function T_(t,n){return(n-=t=+t)?function(s){return(s-t)/n}:c2e(isNaN(n)?NaN:.5)}function d2e(t,n){var s;return t>n&&(s=t,t=n,n=s),function(r){return Math.max(t,Math.min(n,r))}}function u2e(t,n,s){var r=t[0],i=t[1],l=n[0],o=n[1];return i<r?(r=T_(i,r),l=s(o,l)):(r=T_(r,i),l=s(l,o)),function(c){return l(r(c))}}function f2e(t,n,s){var r=Math.min(t.length,n.length)-1,i=new Array(r),l=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<r;)i[o]=T_(t[o],t[o+1]),l[o]=s(n[o],n[o+1]);return function(c){var d=Ox(t,c,1,r)-1;return l[d](i[d](c))}}function Rx(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function bv(){var t=iO,n=iO,s=Ih,r,i,l,o=na,c,d,u;function h(){var x=Math.min(t.length,n.length);return o!==na&&(o=d2e(t[0],t[x-1])),c=x>2?f2e:u2e,d=u=null,m}function m(x){return x==null||isNaN(x=+x)?l:(d||(d=c(t.map(r),n,s)))(r(o(x)))}return m.invert=function(x){return o(i((u||(u=c(n,t.map(r),wy)))(x)))},m.domain=function(x){return arguments.length?(t=Array.from(x,Ny),h()):t.slice()},m.range=function(x){return arguments.length?(n=Array.from(x),h()):n.slice()},m.rangeRound=function(x){return n=Array.from(x),s=gk,h()},m.clamp=function(x){return arguments.length?(o=x?!0:na,h()):o!==na},m.interpolate=function(x){return arguments.length?(s=x,h()):s},m.unknown=function(x){return arguments.length?(l=x,m):l},function(x,b){return r=x,i=b,h()}}function yk(){return bv()(na,na)}function h2e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function jy(t,n){if((s=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var s,r=t.slice(0,s);return[r.length>1?r[0]+r.slice(2):r,+t.slice(s+1)]}function ih(t){return t=jy(Math.abs(t)),t?t[1]:NaN}function m2e(t,n){return function(s,r){for(var i=s.length,l=[],o=0,c=t[0],d=0;i>0&&c>0&&(d+c+1>r&&(c=Math.max(1,r-d)),l.push(s.substring(i-=c,i+c)),!((d+=c+1)>r));)c=t[o=(o+1)%t.length];return l.reverse().join(n)}}function p2e(t){return function(n){return n.replace(/[0-9]/g,function(s){return t[+s]})}}var x2e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tx(t){if(!(n=x2e.exec(t)))throw new Error("invalid format: "+t);var n;return new bk({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}tx.prototype=bk.prototype;function bk(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}bk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function g2e(t){e:for(var n=t.length,s=1,r=-1,i;s<n;++s)switch(t[s]){case".":r=i=s;break;case"0":r===0&&(r=s),i=s;break;default:if(!+t[s])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var qU;function y2e(t,n){var s=jy(t,n);if(!s)return t+"";var r=s[0],i=s[1],l=i-(qU=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return l===o?r:l>o?r+new Array(l-o+1).join("0"):l>0?r.slice(0,l)+"."+r.slice(l):"0."+new Array(1-l).join("0")+jy(t,Math.max(0,n+l-1))[0]}function lO(t,n){var s=jy(t,n);if(!s)return t+"";var r=s[0],i=s[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const oO={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:h2e,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>lO(t*100,n),r:lO,s:y2e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function cO(t){return t}var dO=Array.prototype.map,uO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function b2e(t){var n=t.grouping===void 0||t.thousands===void 0?cO:m2e(dO.call(t.grouping,Number),t.thousands+""),s=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",l=t.numerals===void 0?cO:p2e(dO.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function u(m){m=tx(m);var x=m.fill,b=m.align,w=m.sign,j=m.symbol,S=m.zero,C=m.width,A=m.comma,k=m.precision,T=m.trim,I=m.type;I==="n"?(A=!0,I="g"):oO[I]||(k===void 0&&(k=12),T=!0,I="g"),(S||x==="0"&&b==="=")&&(S=!0,x="0",b="=");var D=j==="$"?s:j==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():"",O=j==="$"?r:/[%p]/.test(I)?o:"",R=oO[I],P=/[defgprs%]/.test(I);k=k===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function L($){var B=D,V=O,K,z,H;if(I==="c")V=R($)+V,$="";else{$=+$;var Y=$<0||1/$<0;if($=isNaN($)?d:R(Math.abs($),k),T&&($=g2e($)),Y&&+$==0&&w!=="+"&&(Y=!1),B=(Y?w==="("?w:c:w==="-"||w==="("?"":w)+B,V=(I==="s"?uO[8+qU/3]:"")+V+(Y&&w==="("?")":""),P){for(K=-1,z=$.length;++K<z;)if(H=$.charCodeAt(K),48>H||H>57){V=(H===46?i+$.slice(K+1):$.slice(K))+V,$=$.slice(0,K);break}}}A&&!S&&($=n($,1/0));var G=B.length+$.length+V.length,J=G<C?new Array(C-G+1).join(x):"";switch(A&&S&&($=n(J+$,J.length?C-V.length:1/0),J=""),b){case"<":$=B+$+V+J;break;case"=":$=B+J+$+V;break;case"^":$=J.slice(0,G=J.length>>1)+B+$+V+J.slice(G);break;default:$=J+B+$+V;break}return l($)}return L.toString=function(){return m+""},L}function h(m,x){var b=u((m=tx(m),m.type="f",m)),w=Math.max(-8,Math.min(8,Math.floor(ih(x)/3)))*3,j=Math.pow(10,-w),S=uO[8+w/3];return function(C){return b(j*C)+S}}return{format:u,formatPrefix:h}}var ng,vk,GU;v2e({thousands:",",grouping:[3],currency:["$",""]});function v2e(t){return ng=b2e(t),vk=ng.format,GU=ng.formatPrefix,ng}function w2e(t){return Math.max(0,-ih(Math.abs(t)))}function N2e(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ih(n)/3)))*3-ih(Math.abs(t)))}function j2e(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,ih(n)-ih(t))+1}function KU(t,n,s,r){var i=C_(t,n,s),l;switch(r=tx(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(n));return r.precision==null&&!isNaN(l=N2e(i,o))&&(r.precision=l),GU(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(l=j2e(i,Math.max(Math.abs(t),Math.abs(n))))&&(r.precision=l-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(l=w2e(i))&&(r.precision=l-(r.type==="%")*2);break}}return vk(r)}function ad(t){var n=t.domain;return t.ticks=function(s){var r=n();return S_(r[0],r[r.length-1],s??10)},t.tickFormat=function(s,r){var i=n();return KU(i[0],i[i.length-1],s??10,r)},t.nice=function(s){s==null&&(s=10);var r=n(),i=0,l=r.length-1,o=r[i],c=r[l],d,u,h=10;for(c<o&&(u=o,o=c,c=u,u=i,i=l,l=u);h-- >0;){if(u=__(o,c,s),u===d)return r[i]=o,r[l]=c,n(r);if(u>0)o=Math.floor(o/u)*u,c=Math.ceil(c/u)*u;else if(u<0)o=Math.ceil(o*u)/u,c=Math.floor(c*u)/u;else break;d=u}return t},t}function YU(){var t=yk();return t.copy=function(){return Rx(t,YU())},Pi.apply(t,arguments),ad(t)}function XU(t){var n;function s(r){return r==null||isNaN(r=+r)?n:r}return s.invert=s,s.domain=s.range=function(r){return arguments.length?(t=Array.from(r,Ny),s):t.slice()},s.unknown=function(r){return arguments.length?(n=r,s):n},s.copy=function(){return XU(t).unknown(n)},t=arguments.length?Array.from(t,Ny):[0,1],ad(s)}function QU(t,n){t=t.slice();var s=0,r=t.length-1,i=t[s],l=t[r],o;return l<i&&(o=s,s=r,r=o,o=i,i=l,l=o),t[s]=n.floor(i),t[r]=n.ceil(l),t}function fO(t){return Math.log(t)}function hO(t){return Math.exp(t)}function S2e(t){return-Math.log(-t)}function _2e(t){return-Math.exp(-t)}function C2e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function A2e(t){return t===10?C2e:t===Math.E?Math.exp:n=>Math.pow(t,n)}function k2e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),n=>Math.log(n)/t)}function mO(t){return(n,s)=>-t(-n,s)}function wk(t){const n=t(fO,hO),s=n.domain;let r=10,i,l;function o(){return i=k2e(r),l=A2e(r),s()[0]<0?(i=mO(i),l=mO(l),t(S2e,_2e)):t(fO,hO),n}return n.base=function(c){return arguments.length?(r=+c,o()):r},n.domain=function(c){return arguments.length?(s(c),o()):s()},n.ticks=c=>{const d=s();let u=d[0],h=d[d.length-1];const m=h<u;m&&([u,h]=[h,u]);let x=i(u),b=i(h),w,j;const S=c==null?10:+c;let C=[];if(!(r%1)&&b-x<S){if(x=Math.floor(x),b=Math.ceil(b),u>0){for(;x<=b;++x)for(w=1;w<r;++w)if(j=x<0?w/l(-x):w*l(x),!(j<u)){if(j>h)break;C.push(j)}}else for(;x<=b;++x)for(w=r-1;w>=1;--w)if(j=x>0?w/l(-x):w*l(x),!(j<u)){if(j>h)break;C.push(j)}C.length*2<S&&(C=S_(u,h,S))}else C=S_(x,b,Math.min(b-x,S)).map(l);return m?C.reverse():C},n.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=r===10?"s":","),typeof d!="function"&&(!(r%1)&&(d=tx(d)).precision==null&&(d.trim=!0),d=vk(d)),c===1/0)return d;const u=Math.max(1,r*c/n.ticks().length);return h=>{let m=h/l(Math.round(i(h)));return m*r<r-.5&&(m*=r),m<=u?d(h):""}},n.nice=()=>s(QU(s(),{floor:c=>l(Math.floor(i(c))),ceil:c=>l(Math.ceil(i(c)))})),n}function ZU(){const t=wk(bv()).domain([1,10]);return t.copy=()=>Rx(t,ZU()).base(t.base()),Pi.apply(t,arguments),t}function pO(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function xO(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function Nk(t){var n=1,s=t(pO(n),xO(n));return s.constant=function(r){return arguments.length?t(pO(n=+r),xO(n)):n},ad(s)}function JU(){var t=Nk(bv());return t.copy=function(){return Rx(t,JU()).constant(t.constant())},Pi.apply(t,arguments)}function gO(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function E2e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function T2e(t){return t<0?-t*t:t*t}function jk(t){var n=t(na,na),s=1;function r(){return s===1?t(na,na):s===.5?t(E2e,T2e):t(gO(s),gO(1/s))}return n.exponent=function(i){return arguments.length?(s=+i,r()):s},ad(n)}function Sk(){var t=jk(bv());return t.copy=function(){return Rx(t,Sk()).exponent(t.exponent())},Pi.apply(t,arguments),t}function I2e(){return Sk.apply(null,arguments).exponent(.5)}function yO(t){return Math.sign(t)*t*t}function P2e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function eV(){var t=yk(),n=[0,1],s=!1,r;function i(l){var o=P2e(t(l));return isNaN(o)?r:s?Math.round(o):o}return i.invert=function(l){return t.invert(yO(l))},i.domain=function(l){return arguments.length?(t.domain(l),i):t.domain()},i.range=function(l){return arguments.length?(t.range((n=Array.from(l,Ny)).map(yO)),i):n.slice()},i.rangeRound=function(l){return i.range(l).round(!0)},i.round=function(l){return arguments.length?(s=!!l,i):s},i.clamp=function(l){return arguments.length?(t.clamp(l),i):t.clamp()},i.unknown=function(l){return arguments.length?(r=l,i):r},i.copy=function(){return eV(t.domain(),n).round(s).clamp(t.clamp()).unknown(r)},Pi.apply(i,arguments),ad(i)}function tV(){var t=[],n=[],s=[],r;function i(){var o=0,c=Math.max(1,n.length);for(s=new Array(c-1);++o<c;)s[o-1]=RNe(t,o/c);return l}function l(o){return o==null||isNaN(o=+o)?r:n[Ox(s,o)]}return l.invertExtent=function(o){var c=n.indexOf(o);return c<0?[NaN,NaN]:[c>0?s[c-1]:t[0],c<s.length?s[c]:t[t.length-1]]},l.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let c of o)c!=null&&!isNaN(c=+c)&&t.push(c);return t.sort(Mc),i()},l.range=function(o){return arguments.length?(n=Array.from(o),i()):n.slice()},l.unknown=function(o){return arguments.length?(r=o,l):r},l.quantiles=function(){return s.slice()},l.copy=function(){return tV().domain(t).range(n).unknown(r)},Pi.apply(l,arguments)}function nV(){var t=0,n=1,s=1,r=[.5],i=[0,1],l;function o(d){return d!=null&&d<=d?i[Ox(r,d,0,s)]:l}function c(){var d=-1;for(r=new Array(s);++d<s;)r[d]=((d+1)*n-(d-s)*t)/(s+1);return o}return o.domain=function(d){return arguments.length?([t,n]=d,t=+t,n=+n,c()):[t,n]},o.range=function(d){return arguments.length?(s=(i=Array.from(d)).length-1,c()):i.slice()},o.invertExtent=function(d){var u=i.indexOf(d);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=s?[r[s-1],n]:[r[u-1],r[u]]},o.unknown=function(d){return arguments.length&&(l=d),o},o.thresholds=function(){return r.slice()},o.copy=function(){return nV().domain([t,n]).range(i).unknown(l)},Pi.apply(ad(o),arguments)}function sV(){var t=[.5],n=[0,1],s,r=1;function i(l){return l!=null&&l<=l?n[Ox(t,l,0,r)]:s}return i.domain=function(l){return arguments.length?(t=Array.from(l),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(l){return arguments.length?(n=Array.from(l),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(l){var o=n.indexOf(l);return[t[o-1],t[o]]},i.unknown=function(l){return arguments.length?(s=l,i):s},i.copy=function(){return sV().domain(t).range(n).unknown(s)},Pi.apply(i,arguments)}const u2=new Date,f2=new Date;function Js(t,n,s,r){function i(l){return t(l=arguments.length===0?new Date:new Date(+l)),l}return i.floor=l=>(t(l=new Date(+l)),l),i.ceil=l=>(t(l=new Date(l-1)),n(l,1),t(l),l),i.round=l=>{const o=i(l),c=i.ceil(l);return l-o<c-l?o:c},i.offset=(l,o)=>(n(l=new Date(+l),o==null?1:Math.floor(o)),l),i.range=(l,o,c)=>{const d=[];if(l=i.ceil(l),c=c==null?1:Math.floor(c),!(l<o)||!(c>0))return d;let u;do d.push(u=new Date(+l)),n(l,c),t(l);while(u<l&&l<o);return d},i.filter=l=>Js(o=>{if(o>=o)for(;t(o),!l(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;n(o,-1),!l(o););else for(;--c>=0;)for(;n(o,1),!l(o););}),s&&(i.count=(l,o)=>(u2.setTime(+l),f2.setTime(+o),t(u2),t(f2),Math.floor(s(u2,f2))),i.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?i.filter(r?o=>r(o)%l===0:o=>i.count(0,o)%l===0):i)),i}const Sy=Js(()=>{},(t,n)=>{t.setTime(+t+n)},(t,n)=>n-t);Sy.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Js(n=>{n.setTime(Math.floor(n/t)*t)},(n,s)=>{n.setTime(+n+s*t)},(n,s)=>(s-n)/t):Sy);Sy.range;const fo=1e3,vi=fo*60,ho=vi*60,ko=ho*24,_k=ko*7,bO=ko*30,h2=ko*365,$d=Js(t=>{t.setTime(t-t.getMilliseconds())},(t,n)=>{t.setTime(+t+n*fo)},(t,n)=>(n-t)/fo,t=>t.getUTCSeconds());$d.range;const Ck=Js(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*fo)},(t,n)=>{t.setTime(+t+n*vi)},(t,n)=>(n-t)/vi,t=>t.getMinutes());Ck.range;const Ak=Js(t=>{t.setUTCSeconds(0,0)},(t,n)=>{t.setTime(+t+n*vi)},(t,n)=>(n-t)/vi,t=>t.getUTCMinutes());Ak.range;const kk=Js(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*fo-t.getMinutes()*vi)},(t,n)=>{t.setTime(+t+n*ho)},(t,n)=>(n-t)/ho,t=>t.getHours());kk.range;const Ek=Js(t=>{t.setUTCMinutes(0,0,0)},(t,n)=>{t.setTime(+t+n*ho)},(t,n)=>(n-t)/ho,t=>t.getUTCHours());Ek.range;const Lx=Js(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*vi)/ko,t=>t.getDate()-1);Lx.range;const vv=Js(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/ko,t=>t.getUTCDate()-1);vv.range;const rV=Js(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/ko,t=>Math.floor(t/ko));rV.range;function Fu(t){return Js(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,s)=>{n.setDate(n.getDate()+s*7)},(n,s)=>(s-n-(s.getTimezoneOffset()-n.getTimezoneOffset())*vi)/_k)}const wv=Fu(0),_y=Fu(1),M2e=Fu(2),O2e=Fu(3),lh=Fu(4),D2e=Fu(5),R2e=Fu(6);wv.range;_y.range;M2e.range;O2e.range;lh.range;D2e.range;R2e.range;function $u(t){return Js(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,s)=>{n.setUTCDate(n.getUTCDate()+s*7)},(n,s)=>(s-n)/_k)}const Nv=$u(0),Cy=$u(1),L2e=$u(2),B2e=$u(3),oh=$u(4),F2e=$u(5),$2e=$u(6);Nv.range;Cy.range;L2e.range;B2e.range;oh.range;F2e.range;$2e.range;const Tk=Js(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,n)=>{t.setMonth(t.getMonth()+n)},(t,n)=>n.getMonth()-t.getMonth()+(n.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Tk.range;const Ik=Js(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCMonth(t.getUTCMonth()+n)},(t,n)=>n.getUTCMonth()-t.getUTCMonth()+(n.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Ik.range;const Eo=Js(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());Eo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Js(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,s)=>{n.setFullYear(n.getFullYear()+s*t)});Eo.range;const To=Js(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());To.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Js(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,s)=>{n.setUTCFullYear(n.getUTCFullYear()+s*t)});To.range;function aV(t,n,s,r,i,l){const o=[[$d,1,fo],[$d,5,5*fo],[$d,15,15*fo],[$d,30,30*fo],[l,1,vi],[l,5,5*vi],[l,15,15*vi],[l,30,30*vi],[i,1,ho],[i,3,3*ho],[i,6,6*ho],[i,12,12*ho],[r,1,ko],[r,2,2*ko],[s,1,_k],[n,1,bO],[n,3,3*bO],[t,1,h2]];function c(u,h,m){const x=h<u;x&&([u,h]=[h,u]);const b=m&&typeof m.range=="function"?m:d(u,h,m),w=b?b.range(u,+h+1):[];return x?w.reverse():w}function d(u,h,m){const x=Math.abs(h-u)/m,b=fk(([,,S])=>S).right(o,x);if(b===o.length)return t.every(C_(u/h2,h/h2,m));if(b===0)return Sy.every(Math.max(C_(u,h,m),1));const[w,j]=o[x/o[b-1][2]<o[b][2]/x?b-1:b];return w.every(j)}return[c,d]}const[z2e,U2e]=aV(To,Ik,Nv,rV,Ek,Ak),[V2e,H2e]=aV(Eo,Tk,wv,Lx,kk,Ck);function m2(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function p2(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function vm(t,n,s){return{y:t,m:n,d:s,H:0,M:0,S:0,L:0}}function W2e(t){var n=t.dateTime,s=t.date,r=t.time,i=t.periods,l=t.days,o=t.shortDays,c=t.months,d=t.shortMonths,u=wm(i),h=Nm(i),m=wm(l),x=Nm(l),b=wm(o),w=Nm(o),j=wm(c),S=Nm(c),C=wm(d),A=Nm(d),k={a:Y,A:G,b:J,B:ee,c:null,d:_O,e:_O,f:mje,g:Sje,G:Cje,H:uje,I:fje,j:hje,L:iV,m:pje,M:xje,p:ye,q:ie,Q:kO,s:EO,S:gje,u:yje,U:bje,V:vje,w:wje,W:Nje,x:null,X:null,y:jje,Y:_je,Z:Aje,"%":AO},T={a:he,A:be,b:we,B:Z,c:null,d:CO,e:CO,f:Ije,g:zje,G:Vje,H:kje,I:Eje,j:Tje,L:oV,m:Pje,M:Mje,p:ce,q:Te,Q:kO,s:EO,S:Oje,u:Dje,U:Rje,V:Lje,w:Bje,W:Fje,x:null,X:null,y:$je,Y:Uje,Z:Hje,"%":AO},I={a:L,A:$,b:B,B:V,c:K,d:jO,e:jO,f:lje,g:NO,G:wO,H:SO,I:SO,j:sje,L:ije,m:nje,M:rje,p:P,q:tje,Q:cje,s:dje,S:aje,u:X2e,U:Q2e,V:Z2e,w:Y2e,W:J2e,x:z,X:H,y:NO,Y:wO,Z:eje,"%":oje};k.x=D(s,k),k.X=D(r,k),k.c=D(n,k),T.x=D(s,T),T.X=D(r,T),T.c=D(n,T);function D(le,de){return function(ge){var ae=[],Ve=-1,nt=0,wt=le.length,jt,ct,Me;for(ge instanceof Date||(ge=new Date(+ge));++Ve<wt;)le.charCodeAt(Ve)===37&&(ae.push(le.slice(nt,Ve)),(ct=vO[jt=le.charAt(++Ve)])!=null?jt=le.charAt(++Ve):ct=jt==="e"?" ":"0",(Me=de[jt])&&(jt=Me(ge,ct)),ae.push(jt),nt=Ve+1);return ae.push(le.slice(nt,Ve)),ae.join("")}}function O(le,de){return function(ge){var ae=vm(1900,void 0,1),Ve=R(ae,le,ge+="",0),nt,wt;if(Ve!=ge.length)return null;if("Q"in ae)return new Date(ae.Q);if("s"in ae)return new Date(ae.s*1e3+("L"in ae?ae.L:0));if(de&&!("Z"in ae)&&(ae.Z=0),"p"in ae&&(ae.H=ae.H%12+ae.p*12),ae.m===void 0&&(ae.m="q"in ae?ae.q:0),"V"in ae){if(ae.V<1||ae.V>53)return null;"w"in ae||(ae.w=1),"Z"in ae?(nt=p2(vm(ae.y,0,1)),wt=nt.getUTCDay(),nt=wt>4||wt===0?Cy.ceil(nt):Cy(nt),nt=vv.offset(nt,(ae.V-1)*7),ae.y=nt.getUTCFullYear(),ae.m=nt.getUTCMonth(),ae.d=nt.getUTCDate()+(ae.w+6)%7):(nt=m2(vm(ae.y,0,1)),wt=nt.getDay(),nt=wt>4||wt===0?_y.ceil(nt):_y(nt),nt=Lx.offset(nt,(ae.V-1)*7),ae.y=nt.getFullYear(),ae.m=nt.getMonth(),ae.d=nt.getDate()+(ae.w+6)%7)}else("W"in ae||"U"in ae)&&("w"in ae||(ae.w="u"in ae?ae.u%7:"W"in ae?1:0),wt="Z"in ae?p2(vm(ae.y,0,1)).getUTCDay():m2(vm(ae.y,0,1)).getDay(),ae.m=0,ae.d="W"in ae?(ae.w+6)%7+ae.W*7-(wt+5)%7:ae.w+ae.U*7-(wt+6)%7);return"Z"in ae?(ae.H+=ae.Z/100|0,ae.M+=ae.Z%100,p2(ae)):m2(ae)}}function R(le,de,ge,ae){for(var Ve=0,nt=de.length,wt=ge.length,jt,ct;Ve<nt;){if(ae>=wt)return-1;if(jt=de.charCodeAt(Ve++),jt===37){if(jt=de.charAt(Ve++),ct=I[jt in vO?de.charAt(Ve++):jt],!ct||(ae=ct(le,ge,ae))<0)return-1}else if(jt!=ge.charCodeAt(ae++))return-1}return ae}function P(le,de,ge){var ae=u.exec(de.slice(ge));return ae?(le.p=h.get(ae[0].toLowerCase()),ge+ae[0].length):-1}function L(le,de,ge){var ae=b.exec(de.slice(ge));return ae?(le.w=w.get(ae[0].toLowerCase()),ge+ae[0].length):-1}function $(le,de,ge){var ae=m.exec(de.slice(ge));return ae?(le.w=x.get(ae[0].toLowerCase()),ge+ae[0].length):-1}function B(le,de,ge){var ae=C.exec(de.slice(ge));return ae?(le.m=A.get(ae[0].toLowerCase()),ge+ae[0].length):-1}function V(le,de,ge){var ae=j.exec(de.slice(ge));return ae?(le.m=S.get(ae[0].toLowerCase()),ge+ae[0].length):-1}function K(le,de,ge){return R(le,n,de,ge)}function z(le,de,ge){return R(le,s,de,ge)}function H(le,de,ge){return R(le,r,de,ge)}function Y(le){return o[le.getDay()]}function G(le){return l[le.getDay()]}function J(le){return d[le.getMonth()]}function ee(le){return c[le.getMonth()]}function ye(le){return i[+(le.getHours()>=12)]}function ie(le){return 1+~~(le.getMonth()/3)}function he(le){return o[le.getUTCDay()]}function be(le){return l[le.getUTCDay()]}function we(le){return d[le.getUTCMonth()]}function Z(le){return c[le.getUTCMonth()]}function ce(le){return i[+(le.getUTCHours()>=12)]}function Te(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var de=D(le+="",k);return de.toString=function(){return le},de},parse:function(le){var de=O(le+="",!1);return de.toString=function(){return le},de},utcFormat:function(le){var de=D(le+="",T);return de.toString=function(){return le},de},utcParse:function(le){var de=O(le+="",!0);return de.toString=function(){return le},de}}}var vO={"-":"",_:" ",0:"0"},fr=/^\s*\d+/,q2e=/^%/,G2e=/[\\^$*+?|[\]().{}]/g;function on(t,n,s){var r=t<0?"-":"",i=(r?-t:t)+"",l=i.length;return r+(l<s?new Array(s-l+1).join(n)+i:i)}function K2e(t){return t.replace(G2e,"\\$&")}function wm(t){return new RegExp("^(?:"+t.map(K2e).join("|")+")","i")}function Nm(t){return new Map(t.map((n,s)=>[n.toLowerCase(),s]))}function Y2e(t,n,s){var r=fr.exec(n.slice(s,s+1));return r?(t.w=+r[0],s+r[0].length):-1}function X2e(t,n,s){var r=fr.exec(n.slice(s,s+1));return r?(t.u=+r[0],s+r[0].length):-1}function Q2e(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.U=+r[0],s+r[0].length):-1}function Z2e(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.V=+r[0],s+r[0].length):-1}function J2e(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.W=+r[0],s+r[0].length):-1}function wO(t,n,s){var r=fr.exec(n.slice(s,s+4));return r?(t.y=+r[0],s+r[0].length):-1}function NO(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),s+r[0].length):-1}function eje(t,n,s){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(s,s+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),s+r[0].length):-1}function tje(t,n,s){var r=fr.exec(n.slice(s,s+1));return r?(t.q=r[0]*3-3,s+r[0].length):-1}function nje(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.m=r[0]-1,s+r[0].length):-1}function jO(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.d=+r[0],s+r[0].length):-1}function sje(t,n,s){var r=fr.exec(n.slice(s,s+3));return r?(t.m=0,t.d=+r[0],s+r[0].length):-1}function SO(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.H=+r[0],s+r[0].length):-1}function rje(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.M=+r[0],s+r[0].length):-1}function aje(t,n,s){var r=fr.exec(n.slice(s,s+2));return r?(t.S=+r[0],s+r[0].length):-1}function ije(t,n,s){var r=fr.exec(n.slice(s,s+3));return r?(t.L=+r[0],s+r[0].length):-1}function lje(t,n,s){var r=fr.exec(n.slice(s,s+6));return r?(t.L=Math.floor(r[0]/1e3),s+r[0].length):-1}function oje(t,n,s){var r=q2e.exec(n.slice(s,s+1));return r?s+r[0].length:-1}function cje(t,n,s){var r=fr.exec(n.slice(s));return r?(t.Q=+r[0],s+r[0].length):-1}function dje(t,n,s){var r=fr.exec(n.slice(s));return r?(t.s=+r[0],s+r[0].length):-1}function _O(t,n){return on(t.getDate(),n,2)}function uje(t,n){return on(t.getHours(),n,2)}function fje(t,n){return on(t.getHours()%12||12,n,2)}function hje(t,n){return on(1+Lx.count(Eo(t),t),n,3)}function iV(t,n){return on(t.getMilliseconds(),n,3)}function mje(t,n){return iV(t,n)+"000"}function pje(t,n){return on(t.getMonth()+1,n,2)}function xje(t,n){return on(t.getMinutes(),n,2)}function gje(t,n){return on(t.getSeconds(),n,2)}function yje(t){var n=t.getDay();return n===0?7:n}function bje(t,n){return on(wv.count(Eo(t)-1,t),n,2)}function lV(t){var n=t.getDay();return n>=4||n===0?lh(t):lh.ceil(t)}function vje(t,n){return t=lV(t),on(lh.count(Eo(t),t)+(Eo(t).getDay()===4),n,2)}function wje(t){return t.getDay()}function Nje(t,n){return on(_y.count(Eo(t)-1,t),n,2)}function jje(t,n){return on(t.getFullYear()%100,n,2)}function Sje(t,n){return t=lV(t),on(t.getFullYear()%100,n,2)}function _je(t,n){return on(t.getFullYear()%1e4,n,4)}function Cje(t,n){var s=t.getDay();return t=s>=4||s===0?lh(t):lh.ceil(t),on(t.getFullYear()%1e4,n,4)}function Aje(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+on(n/60|0,"0",2)+on(n%60,"0",2)}function CO(t,n){return on(t.getUTCDate(),n,2)}function kje(t,n){return on(t.getUTCHours(),n,2)}function Eje(t,n){return on(t.getUTCHours()%12||12,n,2)}function Tje(t,n){return on(1+vv.count(To(t),t),n,3)}function oV(t,n){return on(t.getUTCMilliseconds(),n,3)}function Ije(t,n){return oV(t,n)+"000"}function Pje(t,n){return on(t.getUTCMonth()+1,n,2)}function Mje(t,n){return on(t.getUTCMinutes(),n,2)}function Oje(t,n){return on(t.getUTCSeconds(),n,2)}function Dje(t){var n=t.getUTCDay();return n===0?7:n}function Rje(t,n){return on(Nv.count(To(t)-1,t),n,2)}function cV(t){var n=t.getUTCDay();return n>=4||n===0?oh(t):oh.ceil(t)}function Lje(t,n){return t=cV(t),on(oh.count(To(t),t)+(To(t).getUTCDay()===4),n,2)}function Bje(t){return t.getUTCDay()}function Fje(t,n){return on(Cy.count(To(t)-1,t),n,2)}function $je(t,n){return on(t.getUTCFullYear()%100,n,2)}function zje(t,n){return t=cV(t),on(t.getUTCFullYear()%100,n,2)}function Uje(t,n){return on(t.getUTCFullYear()%1e4,n,4)}function Vje(t,n){var s=t.getUTCDay();return t=s>=4||s===0?oh(t):oh.ceil(t),on(t.getUTCFullYear()%1e4,n,4)}function Hje(){return"+0000"}function AO(){return"%"}function kO(t){return+t}function EO(t){return Math.floor(+t/1e3)}var Xu,dV,uV;Wje({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Wje(t){return Xu=W2e(t),dV=Xu.format,Xu.parse,uV=Xu.utcFormat,Xu.utcParse,Xu}function qje(t){return new Date(t)}function Gje(t){return t instanceof Date?+t:+new Date(+t)}function Pk(t,n,s,r,i,l,o,c,d,u){var h=yk(),m=h.invert,x=h.domain,b=u(".%L"),w=u(":%S"),j=u("%I:%M"),S=u("%I %p"),C=u("%a %d"),A=u("%b %d"),k=u("%B"),T=u("%Y");function I(D){return(d(D)<D?b:c(D)<D?w:o(D)<D?j:l(D)<D?S:r(D)<D?i(D)<D?C:A:s(D)<D?k:T)(D)}return h.invert=function(D){return new Date(m(D))},h.domain=function(D){return arguments.length?x(Array.from(D,Gje)):x().map(qje)},h.ticks=function(D){var O=x();return t(O[0],O[O.length-1],D??10)},h.tickFormat=function(D,O){return O==null?I:u(O)},h.nice=function(D){var O=x();return(!D||typeof D.range!="function")&&(D=n(O[0],O[O.length-1],D??10)),D?x(QU(O,D)):h},h.copy=function(){return Rx(h,Pk(t,n,s,r,i,l,o,c,d,u))},h}function Kje(){return Pi.apply(Pk(V2e,H2e,Eo,Tk,wv,Lx,kk,Ck,$d,dV).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Yje(){return Pi.apply(Pk(z2e,U2e,To,Ik,Nv,vv,Ek,Ak,$d,uV).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function jv(){var t=0,n=1,s,r,i,l,o=na,c=!1,d;function u(m){return m==null||isNaN(m=+m)?d:o(i===0?.5:(m=(l(m)-s)*i,c?Math.max(0,Math.min(1,m)):m))}u.domain=function(m){return arguments.length?([t,n]=m,s=l(t=+t),r=l(n=+n),i=s===r?0:1/(r-s),u):[t,n]},u.clamp=function(m){return arguments.length?(c=!!m,u):c},u.interpolator=function(m){return arguments.length?(o=m,u):o};function h(m){return function(x){var b,w;return arguments.length?([b,w]=x,o=m(b,w),u):[o(0),o(1)]}}return u.range=h(Ih),u.rangeRound=h(gk),u.unknown=function(m){return arguments.length?(d=m,u):d},function(m){return l=m,s=m(t),r=m(n),i=s===r?0:1/(r-s),u}}function id(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function fV(){var t=ad(jv()(na));return t.copy=function(){return id(t,fV())},$o.apply(t,arguments)}function hV(){var t=wk(jv()).domain([1,10]);return t.copy=function(){return id(t,hV()).base(t.base())},$o.apply(t,arguments)}function mV(){var t=Nk(jv());return t.copy=function(){return id(t,mV()).constant(t.constant())},$o.apply(t,arguments)}function Mk(){var t=jk(jv());return t.copy=function(){return id(t,Mk()).exponent(t.exponent())},$o.apply(t,arguments)}function Xje(){return Mk.apply(null,arguments).exponent(.5)}function pV(){var t=[],n=na;function s(r){if(r!=null&&!isNaN(r=+r))return n((Ox(t,r,1)-1)/(t.length-1))}return s.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let i of r)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Mc),s},s.interpolator=function(r){return arguments.length?(n=r,s):n},s.range=function(){return t.map((r,i)=>n(i/(t.length-1)))},s.quantiles=function(r){return Array.from({length:r+1},(i,l)=>DNe(t,l/r))},s.copy=function(){return pV(n).domain(t)},$o.apply(s,arguments)}function Sv(){var t=0,n=.5,s=1,r=1,i,l,o,c,d,u=na,h,m=!1,x;function b(j){return isNaN(j=+j)?x:(j=.5+((j=+h(j))-l)*(r*j<r*l?c:d),u(m?Math.max(0,Math.min(1,j)):j))}b.domain=function(j){return arguments.length?([t,n,s]=j,i=h(t=+t),l=h(n=+n),o=h(s=+s),c=i===l?0:.5/(l-i),d=l===o?0:.5/(o-l),r=l<i?-1:1,b):[t,n,s]},b.clamp=function(j){return arguments.length?(m=!!j,b):m},b.interpolator=function(j){return arguments.length?(u=j,b):u};function w(j){return function(S){var C,A,k;return arguments.length?([C,A,k]=S,u=o2e(j,[C,A,k]),b):[u(0),u(.5),u(1)]}}return b.range=w(Ih),b.rangeRound=w(gk),b.unknown=function(j){return arguments.length?(x=j,b):x},function(j){return h=j,i=j(t),l=j(n),o=j(s),c=i===l?0:.5/(l-i),d=l===o?0:.5/(o-l),r=l<i?-1:1,b}}function xV(){var t=ad(Sv()(na));return t.copy=function(){return id(t,xV())},$o.apply(t,arguments)}function gV(){var t=wk(Sv()).domain([.1,1,10]);return t.copy=function(){return id(t,gV()).base(t.base())},$o.apply(t,arguments)}function yV(){var t=Nk(Sv());return t.copy=function(){return id(t,yV()).constant(t.constant())},$o.apply(t,arguments)}function Ok(){var t=jk(Sv());return t.copy=function(){return id(t,Ok()).exponent(t.exponent())},$o.apply(t,arguments)}function Qje(){return Ok.apply(null,arguments).exponent(.5)}const Rm=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:mk,scaleDiverging:xV,scaleDivergingLog:gV,scaleDivergingPow:Ok,scaleDivergingSqrt:Qje,scaleDivergingSymlog:yV,scaleIdentity:XU,scaleImplicit:A_,scaleLinear:YU,scaleLog:ZU,scaleOrdinal:hk,scalePoint:BNe,scalePow:Sk,scaleQuantile:tV,scaleQuantize:nV,scaleRadial:eV,scaleSequential:fV,scaleSequentialLog:hV,scaleSequentialPow:Mk,scaleSequentialQuantile:pV,scaleSequentialSqrt:Xje,scaleSequentialSymlog:mV,scaleSqrt:I2e,scaleSymlog:JU,scaleThreshold:sV,scaleTime:Kje,scaleUtc:Yje,tickFormat:KU},Symbol.toStringTag,{value:"Module"}));var ld=t=>t.chartData,Dk=Se([ld],t=>{var n=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:n,dataStartIndex:0}}),Rk=(t,n,s,r)=>r?Dk(t):ld(t);function bu(t){if(Array.isArray(t)&&t.length===2){var[n,s]=t;if(Ns(n)&&Ns(s))return!0}return!1}function TO(t,n,s){return s?t:[Math.min(t[0],n[0]),Math.max(t[1],n[1])]}function bV(t,n){if(n&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[s,r]=t,i,l;if(Ns(s))i=s;else if(typeof s=="function")return;if(Ns(r))l=r;else if(typeof r=="function")return;var o=[i,l];if(bu(o))return o}}function Zje(t,n,s){if(!(!s&&n==null)){if(typeof t=="function"&&n!=null)try{var r=t(n,s);if(bu(r))return TO(r,n,s)}catch{}if(Array.isArray(t)&&t.length===2){var[i,l]=t,o,c;if(i==="auto")n!=null&&(o=Math.min(...n));else if(Ct(i))o=i;else if(typeof i=="function")try{n!=null&&(o=i(n==null?void 0:n[0]))}catch{}else if(typeof i=="string"&&bM.test(i)){var d=bM.exec(i);if(d==null||n==null)o=void 0;else{var u=+d[1];o=n[0]-u}}else o=n==null?void 0:n[0];if(l==="auto")n!=null&&(c=Math.max(...n));else if(Ct(l))c=l;else if(typeof l=="function")try{n!=null&&(c=l(n==null?void 0:n[1]))}catch{}else if(typeof l=="string"&&vM.test(l)){var h=vM.exec(l);if(h==null||n==null)c=void 0;else{var m=+h[1];c=n[1]+m}}else c=n==null?void 0:n[1];var x=[o,c];if(bu(x))return n==null?x:TO(x,n,s)}}}var Ph=1e9,Jje={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Bk,Kn=!0,Ti="[DecimalError] ",nu=Ti+"Invalid argument: ",Lk=Ti+"Exponent out of range: ",Mh=Math.floor,jd=Math.pow,eSe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$a,ar=1e7,$n=7,vV=9007199254740991,Ay=Mh(vV/$n),ft={};ft.absoluteValue=ft.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};ft.comparedTo=ft.cmp=function(t){var n,s,r,i,l=this;if(t=new l.constructor(t),l.s!==t.s)return l.s||-t.s;if(l.e!==t.e)return l.e>t.e^l.s<0?1:-1;for(r=l.d.length,i=t.d.length,n=0,s=r<i?r:i;n<s;++n)if(l.d[n]!==t.d[n])return l.d[n]>t.d[n]^l.s<0?1:-1;return r===i?0:r>i^l.s<0?1:-1};ft.decimalPlaces=ft.dp=function(){var t=this,n=t.d.length-1,s=(n-t.e)*$n;if(n=t.d[n],n)for(;n%10==0;n/=10)s--;return s<0?0:s};ft.dividedBy=ft.div=function(t){return go(this,new this.constructor(t))};ft.dividedToIntegerBy=ft.idiv=function(t){var n=this,s=n.constructor;return En(go(n,new s(t),0,1),s.precision)};ft.equals=ft.eq=function(t){return!this.cmp(t)};ft.exponent=function(){return Ds(this)};ft.greaterThan=ft.gt=function(t){return this.cmp(t)>0};ft.greaterThanOrEqualTo=ft.gte=function(t){return this.cmp(t)>=0};ft.isInteger=ft.isint=function(){return this.e>this.d.length-2};ft.isNegative=ft.isneg=function(){return this.s<0};ft.isPositive=ft.ispos=function(){return this.s>0};ft.isZero=function(){return this.s===0};ft.lessThan=ft.lt=function(t){return this.cmp(t)<0};ft.lessThanOrEqualTo=ft.lte=function(t){return this.cmp(t)<1};ft.logarithm=ft.log=function(t){var n,s=this,r=s.constructor,i=r.precision,l=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq($a))throw Error(Ti+"NaN");if(s.s<1)throw Error(Ti+(s.s?"NaN":"-Infinity"));return s.eq($a)?new r(0):(Kn=!1,n=go(nx(s,l),nx(t,l),l),Kn=!0,En(n,i))};ft.minus=ft.sub=function(t){var n=this;return t=new n.constructor(t),n.s==t.s?jV(n,t):wV(n,(t.s=-t.s,t))};ft.modulo=ft.mod=function(t){var n,s=this,r=s.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(Ti+"NaN");return s.s?(Kn=!1,n=go(s,t,0,1).times(t),Kn=!0,s.minus(n)):En(new r(s),i)};ft.naturalExponential=ft.exp=function(){return NV(this)};ft.naturalLogarithm=ft.ln=function(){return nx(this)};ft.negated=ft.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};ft.plus=ft.add=function(t){var n=this;return t=new n.constructor(t),n.s==t.s?wV(n,t):jV(n,(t.s=-t.s,t))};ft.precision=ft.sd=function(t){var n,s,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(nu+t);if(n=Ds(i)+1,r=i.d.length-1,s=r*$n+1,r=i.d[r],r){for(;r%10==0;r/=10)s--;for(r=i.d[0];r>=10;r/=10)s++}return t&&n>s?n:s};ft.squareRoot=ft.sqrt=function(){var t,n,s,r,i,l,o,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(Ti+"NaN")}for(t=Ds(c),Kn=!1,i=Math.sqrt(+c),i==0||i==1/0?(n=Cl(c.d),(n.length+t)%2==0&&(n+="0"),i=Math.sqrt(n),t=Mh((t+1)/2)-(t<0||t%2),i==1/0?n="5e"+t:(n=i.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new d(n)):r=new d(i.toString()),s=d.precision,i=o=s+3;;)if(l=r,r=l.plus(go(c,l,o+2)).times(.5),Cl(l.d).slice(0,o)===(n=Cl(r.d)).slice(0,o)){if(n=n.slice(o-3,o+1),i==o&&n=="4999"){if(En(l,s+1,0),l.times(l).eq(c)){r=l;break}}else if(n!="9999")break;o+=4}return Kn=!0,En(r,s)};ft.times=ft.mul=function(t){var n,s,r,i,l,o,c,d,u,h=this,m=h.constructor,x=h.d,b=(t=new m(t)).d;if(!h.s||!t.s)return new m(0);for(t.s*=h.s,s=h.e+t.e,d=x.length,u=b.length,d<u&&(l=x,x=b,b=l,o=d,d=u,u=o),l=[],o=d+u,r=o;r--;)l.push(0);for(r=u;--r>=0;){for(n=0,i=d+r;i>r;)c=l[i]+b[r]*x[i-r-1]+n,l[i--]=c%ar|0,n=c/ar|0;l[i]=(l[i]+n)%ar|0}for(;!l[--o];)l.pop();return n?++s:l.shift(),t.d=l,t.e=s,Kn?En(t,m.precision):t};ft.toDecimalPlaces=ft.todp=function(t,n){var s=this,r=s.constructor;return s=new r(s),t===void 0?s:(zl(t,0,Ph),n===void 0?n=r.rounding:zl(n,0,8),En(s,t+Ds(s)+1,n))};ft.toExponential=function(t,n){var s,r=this,i=r.constructor;return t===void 0?s=vu(r,!0):(zl(t,0,Ph),n===void 0?n=i.rounding:zl(n,0,8),r=En(new i(r),t+1,n),s=vu(r,!0,t+1)),s};ft.toFixed=function(t,n){var s,r,i=this,l=i.constructor;return t===void 0?vu(i):(zl(t,0,Ph),n===void 0?n=l.rounding:zl(n,0,8),r=En(new l(i),t+Ds(i)+1,n),s=vu(r.abs(),!1,t+Ds(r)+1),i.isneg()&&!i.isZero()?"-"+s:s)};ft.toInteger=ft.toint=function(){var t=this,n=t.constructor;return En(new n(t),Ds(t)+1,n.rounding)};ft.toNumber=function(){return+this};ft.toPower=ft.pow=function(t){var n,s,r,i,l,o,c=this,d=c.constructor,u=12,h=+(t=new d(t));if(!t.s)return new d($a);if(c=new d(c),!c.s){if(t.s<1)throw Error(Ti+"Infinity");return c}if(c.eq($a))return c;if(r=d.precision,t.eq($a))return En(c,r);if(n=t.e,s=t.d.length-1,o=n>=s,l=c.s,o){if((s=h<0?-h:h)<=vV){for(i=new d($a),n=Math.ceil(r/$n+4),Kn=!1;s%2&&(i=i.times(c),PO(i.d,n)),s=Mh(s/2),s!==0;)c=c.times(c),PO(c.d,n);return Kn=!0,t.s<0?new d($a).div(i):En(i,r)}}else if(l<0)throw Error(Ti+"NaN");return l=l<0&&t.d[Math.max(n,s)]&1?-1:1,c.s=1,Kn=!1,i=t.times(nx(c,r+u)),Kn=!0,i=NV(i),i.s=l,i};ft.toPrecision=function(t,n){var s,r,i=this,l=i.constructor;return t===void 0?(s=Ds(i),r=vu(i,s<=l.toExpNeg||s>=l.toExpPos)):(zl(t,1,Ph),n===void 0?n=l.rounding:zl(n,0,8),i=En(new l(i),t,n),s=Ds(i),r=vu(i,t<=s||s<=l.toExpNeg,t)),r};ft.toSignificantDigits=ft.tosd=function(t,n){var s=this,r=s.constructor;return t===void 0?(t=r.precision,n=r.rounding):(zl(t,1,Ph),n===void 0?n=r.rounding:zl(n,0,8)),En(new r(s),t,n)};ft.toString=ft.valueOf=ft.val=ft.toJSON=ft[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,n=Ds(t),s=t.constructor;return vu(t,n<=s.toExpNeg||n>=s.toExpPos)};function wV(t,n){var s,r,i,l,o,c,d,u,h=t.constructor,m=h.precision;if(!t.s||!n.s)return n.s||(n=new h(t)),Kn?En(n,m):n;if(d=t.d,u=n.d,o=t.e,i=n.e,d=d.slice(),l=o-i,l){for(l<0?(r=d,l=-l,c=u.length):(r=u,i=o,c=d.length),o=Math.ceil(m/$n),c=o>c?o+1:c+1,l>c&&(l=c,r.length=1),r.reverse();l--;)r.push(0);r.reverse()}for(c=d.length,l=u.length,c-l<0&&(l=c,r=u,u=d,d=r),s=0;l;)s=(d[--l]=d[l]+u[l]+s)/ar|0,d[l]%=ar;for(s&&(d.unshift(s),++i),c=d.length;d[--c]==0;)d.pop();return n.d=d,n.e=i,Kn?En(n,m):n}function zl(t,n,s){if(t!==~~t||t<n||t>s)throw Error(nu+t)}function Cl(t){var n,s,r,i=t.length-1,l="",o=t[0];if(i>0){for(l+=o,n=1;n<i;n++)r=t[n]+"",s=$n-r.length,s&&(l+=cc(s)),l+=r;o=t[n],r=o+"",s=$n-r.length,s&&(l+=cc(s))}else if(o===0)return"0";for(;o%10===0;)o/=10;return l+o}var go=function(){function t(r,i){var l,o=0,c=r.length;for(r=r.slice();c--;)l=r[c]*i+o,r[c]=l%ar|0,o=l/ar|0;return o&&r.unshift(o),r}function n(r,i,l,o){var c,d;if(l!=o)d=l>o?1:-1;else for(c=d=0;c<l;c++)if(r[c]!=i[c]){d=r[c]>i[c]?1:-1;break}return d}function s(r,i,l){for(var o=0;l--;)r[l]-=o,o=r[l]<i[l]?1:0,r[l]=o*ar+r[l]-i[l];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,l,o){var c,d,u,h,m,x,b,w,j,S,C,A,k,T,I,D,O,R,P=r.constructor,L=r.s==i.s?1:-1,$=r.d,B=i.d;if(!r.s)return new P(r);if(!i.s)throw Error(Ti+"Division by zero");for(d=r.e-i.e,O=B.length,I=$.length,b=new P(L),w=b.d=[],u=0;B[u]==($[u]||0);)++u;if(B[u]>($[u]||0)&&--d,l==null?A=l=P.precision:o?A=l+(Ds(r)-Ds(i))+1:A=l,A<0)return new P(0);if(A=A/$n+2|0,u=0,O==1)for(h=0,B=B[0],A++;(u<I||h)&&A--;u++)k=h*ar+($[u]||0),w[u]=k/B|0,h=k%B|0;else{for(h=ar/(B[0]+1)|0,h>1&&(B=t(B,h),$=t($,h),O=B.length,I=$.length),T=O,j=$.slice(0,O),S=j.length;S<O;)j[S++]=0;R=B.slice(),R.unshift(0),D=B[0],B[1]>=ar/2&&++D;do h=0,c=n(B,j,O,S),c<0?(C=j[0],O!=S&&(C=C*ar+(j[1]||0)),h=C/D|0,h>1?(h>=ar&&(h=ar-1),m=t(B,h),x=m.length,S=j.length,c=n(m,j,x,S),c==1&&(h--,s(m,O<x?R:B,x))):(h==0&&(c=h=1),m=B.slice()),x=m.length,x<S&&m.unshift(0),s(j,m,S),c==-1&&(S=j.length,c=n(B,j,O,S),c<1&&(h++,s(j,O<S?R:B,S))),S=j.length):c===0&&(h++,j=[0]),w[u++]=h,c&&j[0]?j[S++]=$[T]||0:(j=[$[T]],S=1);while((T++<I||j[0]!==void 0)&&A--)}return w[0]||w.shift(),b.e=d,En(b,o?l+Ds(b)+1:l)}}();function NV(t,n){var s,r,i,l,o,c,d=0,u=0,h=t.constructor,m=h.precision;if(Ds(t)>16)throw Error(Lk+Ds(t));if(!t.s)return new h($a);for(Kn=!1,c=m,o=new h(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(r=Math.log(jd(2,u))/Math.LN10*2+5|0,c+=r,s=i=l=new h($a),h.precision=c;;){if(i=En(i.times(t),c),s=s.times(++d),o=l.plus(go(i,s,c)),Cl(o.d).slice(0,c)===Cl(l.d).slice(0,c)){for(;u--;)l=En(l.times(l),c);return h.precision=m,n==null?(Kn=!0,En(l,m)):l}l=o}}function Ds(t){for(var n=t.e*$n,s=t.d[0];s>=10;s/=10)n++;return n}function x2(t,n,s){if(n>t.LN10.sd())throw Kn=!0,s&&(t.precision=s),Error(Ti+"LN10 precision limit exceeded");return En(new t(t.LN10),n)}function cc(t){for(var n="";t--;)n+="0";return n}function nx(t,n){var s,r,i,l,o,c,d,u,h,m=1,x=10,b=t,w=b.d,j=b.constructor,S=j.precision;if(b.s<1)throw Error(Ti+(b.s?"NaN":"-Infinity"));if(b.eq($a))return new j(0);if(n==null?(Kn=!1,u=S):u=n,b.eq(10))return n==null&&(Kn=!0),x2(j,u);if(u+=x,j.precision=u,s=Cl(w),r=s.charAt(0),l=Ds(b),Math.abs(l)<15e14){for(;r<7&&r!=1||r==1&&s.charAt(1)>3;)b=b.times(t),s=Cl(b.d),r=s.charAt(0),m++;l=Ds(b),r>1?(b=new j("0."+s),l++):b=new j(r+"."+s.slice(1))}else return d=x2(j,u+2,S).times(l+""),b=nx(new j(r+"."+s.slice(1)),u-x).plus(d),j.precision=S,n==null?(Kn=!0,En(b,S)):b;for(c=o=b=go(b.minus($a),b.plus($a),u),h=En(b.times(b),u),i=3;;){if(o=En(o.times(h),u),d=c.plus(go(o,new j(i),u)),Cl(d.d).slice(0,u)===Cl(c.d).slice(0,u))return c=c.times(2),l!==0&&(c=c.plus(x2(j,u+2,S).times(l+""))),c=go(c,new j(m),u),j.precision=S,n==null?(Kn=!0,En(c,S)):c;c=d,i+=2}}function IO(t,n){var s,r,i;for((s=n.indexOf("."))>-1&&(n=n.replace(".","")),(r=n.search(/e/i))>0?(s<0&&(s=r),s+=+n.slice(r+1),n=n.substring(0,r)):s<0&&(s=n.length),r=0;n.charCodeAt(r)===48;)++r;for(i=n.length;n.charCodeAt(i-1)===48;)--i;if(n=n.slice(r,i),n){if(i-=r,s=s-r-1,t.e=Mh(s/$n),t.d=[],r=(s+1)%$n,s<0&&(r+=$n),r<i){for(r&&t.d.push(+n.slice(0,r)),i-=$n;r<i;)t.d.push(+n.slice(r,r+=$n));n=n.slice(r),r=$n-n.length}else r-=i;for(;r--;)n+="0";if(t.d.push(+n),Kn&&(t.e>Ay||t.e<-Ay))throw Error(Lk+s)}else t.s=0,t.e=0,t.d=[0];return t}function En(t,n,s){var r,i,l,o,c,d,u,h,m=t.d;for(o=1,l=m[0];l>=10;l/=10)o++;if(r=n-o,r<0)r+=$n,i=n,u=m[h=0];else{if(h=Math.ceil((r+1)/$n),l=m.length,h>=l)return t;for(u=l=m[h],o=1;l>=10;l/=10)o++;r%=$n,i=r-$n+o}if(s!==void 0&&(l=jd(10,o-i-1),c=u/l%10|0,d=n<0||m[h+1]!==void 0||u%l,d=s<4?(c||d)&&(s==0||s==(t.s<0?3:2)):c>5||c==5&&(s==4||d||s==6&&(r>0?i>0?u/jd(10,o-i):0:m[h-1])%10&1||s==(t.s<0?8:7))),n<1||!m[0])return d?(l=Ds(t),m.length=1,n=n-l-1,m[0]=jd(10,($n-n%$n)%$n),t.e=Mh(-n/$n)||0):(m.length=1,m[0]=t.e=t.s=0),t;if(r==0?(m.length=h,l=1,h--):(m.length=h+1,l=jd(10,$n-r),m[h]=i>0?(u/jd(10,o-i)%jd(10,i)|0)*l:0),d)for(;;)if(h==0){(m[0]+=l)==ar&&(m[0]=1,++t.e);break}else{if(m[h]+=l,m[h]!=ar)break;m[h--]=0,l=1}for(r=m.length;m[--r]===0;)m.pop();if(Kn&&(t.e>Ay||t.e<-Ay))throw Error(Lk+Ds(t));return t}function jV(t,n){var s,r,i,l,o,c,d,u,h,m,x=t.constructor,b=x.precision;if(!t.s||!n.s)return n.s?n.s=-n.s:n=new x(t),Kn?En(n,b):n;if(d=t.d,m=n.d,r=n.e,u=t.e,d=d.slice(),o=u-r,o){for(h=o<0,h?(s=d,o=-o,c=m.length):(s=m,r=u,c=d.length),i=Math.max(Math.ceil(b/$n),c)+2,o>i&&(o=i,s.length=1),s.reverse(),i=o;i--;)s.push(0);s.reverse()}else{for(i=d.length,c=m.length,h=i<c,h&&(c=i),i=0;i<c;i++)if(d[i]!=m[i]){h=d[i]<m[i];break}o=0}for(h&&(s=d,d=m,m=s,n.s=-n.s),c=d.length,i=m.length-c;i>0;--i)d[c++]=0;for(i=m.length;i>o;){if(d[--i]<m[i]){for(l=i;l&&d[--l]===0;)d[l]=ar-1;--d[l],d[i]+=ar}d[i]-=m[i]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--r;return d[0]?(n.d=d,n.e=r,Kn?En(n,b):n):new x(0)}function vu(t,n,s){var r,i=Ds(t),l=Cl(t.d),o=l.length;return n?(s&&(r=s-o)>0?l=l.charAt(0)+"."+l.slice(1)+cc(r):o>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(i<0?"e":"e+")+i):i<0?(l="0."+cc(-i-1)+l,s&&(r=s-o)>0&&(l+=cc(r))):i>=o?(l+=cc(i+1-o),s&&(r=s-i-1)>0&&(l=l+"."+cc(r))):((r=i+1)<o&&(l=l.slice(0,r)+"."+l.slice(r)),s&&(r=s-o)>0&&(i+1===o&&(l+="."),l+=cc(r))),t.s<0?"-"+l:l}function PO(t,n){if(t.length>n)return t.length=n,!0}function SV(t){var n,s,r;function i(l){var o=this;if(!(o instanceof i))return new i(l);if(o.constructor=i,l instanceof i){o.s=l.s,o.e=l.e,o.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(nu+l);if(l>0)o.s=1;else if(l<0)l=-l,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(l===~~l&&l<1e7){o.e=0,o.d=[l];return}return IO(o,l.toString())}else if(typeof l!="string")throw Error(nu+l);if(l.charCodeAt(0)===45?(l=l.slice(1),o.s=-1):o.s=1,eSe.test(l))IO(o,l);else throw Error(nu+l)}if(i.prototype=ft,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=SV,i.config=i.set=tSe,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<r.length;)t.hasOwnProperty(s=r[n++])||(t[s]=this[s]);return i.config(t),i}function tSe(t){if(!t||typeof t!="object")throw Error(Ti+"Object expected");var n,s,r,i=["precision",1,Ph,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(n=0;n<i.length;n+=3)if((r=t[s=i[n]])!==void 0)if(Mh(r)===r&&r>=i[n+1]&&r<=i[n+2])this[s]=r;else throw Error(nu+s+": "+r);if((r=t[s="LN10"])!==void 0)if(r==Math.LN10)this[s]=new this(r);else throw Error(nu+s+": "+r);return this}var Bk=SV(Jje);$a=new Bk(1);const pn=Bk;var nSe=t=>t,_V={},CV=t=>t===_V,MO=t=>function n(){return arguments.length===0||arguments.length===1&&CV(arguments.length<=0?void 0:arguments[0])?n:t(...arguments)},AV=(t,n)=>t===1?n:MO(function(){for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];var l=r.filter(o=>o!==_V).length;return l>=t?n(...r):AV(t-l,MO(function(){for(var o=arguments.length,c=new Array(o),d=0;d<o;d++)c[d]=arguments[d];var u=r.map(h=>CV(h)?c.shift():h);return n(...u,...c)}))}),_v=t=>AV(t.length,t),I_=(t,n)=>{for(var s=[],r=t;r<n;++r)s[r-t]=r;return s},sSe=_v((t,n)=>Array.isArray(n)?n.map(t):Object.keys(n).map(s=>n[s]).map(t)),rSe=function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];if(!s.length)return nSe;var i=s.reverse(),l=i[0],o=i.slice(1);return function(){return o.reduce((c,d)=>d(c),l(...arguments))}},P_=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),kV=t=>{var n=null,s=null;return function(){for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return n&&i.every((o,c)=>{var d;return o===((d=n)===null||d===void 0?void 0:d[c])})||(n=i,s=t(...i)),s}};function EV(t){var n;return t===0?n=1:n=Math.floor(new pn(t).abs().log(10).toNumber())+1,n}function TV(t,n,s){for(var r=new pn(t),i=0,l=[];r.lt(n)&&i<1e5;)l.push(r.toNumber()),r=r.add(s),i++;return l}_v((t,n,s)=>{var r=+t,i=+n;return r+s*(i-r)});_v((t,n,s)=>{var r=n-+t;return r=r||1/0,(s-t)/r});_v((t,n,s)=>{var r=n-+t;return r=r||1/0,Math.max(0,Math.min(1,(s-t)/r))});var IV=t=>{var[n,s]=t,[r,i]=[n,s];return n>s&&([r,i]=[s,n]),[r,i]},PV=(t,n,s)=>{if(t.lte(0))return new pn(0);var r=EV(t.toNumber()),i=new pn(10).pow(r),l=t.div(i),o=r!==1?.05:.1,c=new pn(Math.ceil(l.div(o).toNumber())).add(s).mul(o),d=c.mul(i);return n?new pn(d.toNumber()):new pn(Math.ceil(d.toNumber()))},aSe=(t,n,s)=>{var r=new pn(1),i=new pn(t);if(!i.isint()&&s){var l=Math.abs(t);l<1?(r=new pn(10).pow(EV(t)-1),i=new pn(Math.floor(i.div(r).toNumber())).mul(r)):l>1&&(i=new pn(Math.floor(t)))}else t===0?i=new pn(Math.floor((n-1)/2)):s||(i=new pn(Math.floor(t)));var o=Math.floor((n-1)/2),c=rSe(sSe(d=>i.add(new pn(d-o).mul(r)).toNumber()),I_);return c(0,n)},MV=function(n,s,r,i){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((s-n)/(r-1)))return{step:new pn(0),tickMin:new pn(0),tickMax:new pn(0)};var o=PV(new pn(s).sub(n).div(r-1),i,l),c;n<=0&&s>=0?c=new pn(0):(c=new pn(n).add(s).div(2),c=c.sub(new pn(c).mod(o)));var d=Math.ceil(c.sub(n).div(o).toNumber()),u=Math.ceil(new pn(s).sub(c).div(o).toNumber()),h=d+u+1;return h>r?MV(n,s,r,i,l+1):(h<r&&(u=s>0?u+(r-h):u,d=s>0?d:d+(r-h)),{step:o,tickMin:c.sub(new pn(d).mul(o)),tickMax:c.add(new pn(u).mul(o))})};function iSe(t){var[n,s]=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(r,2),[o,c]=IV([n,s]);if(o===-1/0||c===1/0){var d=c===1/0?[o,...I_(0,r-1).map(()=>1/0)]:[...I_(0,r-1).map(()=>-1/0),c];return n>s?P_(d):d}if(o===c)return aSe(o,r,i);var{step:u,tickMin:h,tickMax:m}=MV(o,c,l,i,0),x=TV(h,m.add(new pn(.1).mul(u)),u);return n>s?P_(x):x}function lSe(t,n){var[s,r]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,o]=IV([s,r]);if(l===-1/0||o===1/0)return[s,r];if(l===o)return[l];var c=Math.max(n,2),d=PV(new pn(o).sub(l).div(c-1),i,0),u=[...TV(new pn(l),new pn(o),d),o];return i===!1&&(u=u.map(h=>Math.round(h))),s>r?P_(u):u}var oSe=kV(iSe),cSe=kV(lSe),OV=t=>t.rootProps.maxBarSize,dSe=t=>t.rootProps.barGap,DV=t=>t.rootProps.barCategoryGap,uSe=t=>t.rootProps.barSize,Bx=t=>t.rootProps.stackOffset,Fk=t=>t.options.chartName,$k=t=>t.rootProps.syncId,RV=t=>t.rootProps.syncMethod,zk=t=>t.options.eventEmitter,$r={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},lo={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Ra={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Cv=(t,n)=>{if(!(!t||!n))return t!=null&&t.reversed?[n[1],n[0]]:n},fSe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:lo.angleAxisId,includeHidden:!1,name:void 0,reversed:lo.reversed,scale:lo.scale,tick:lo.tick,tickCount:void 0,ticks:void 0,type:lo.type,unit:void 0},hSe={allowDataOverflow:Ra.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ra.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ra.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ra.scale,tick:Ra.tick,tickCount:Ra.tickCount,ticks:void 0,type:Ra.type,unit:void 0},mSe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:lo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:lo.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:lo.scale,tick:lo.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},pSe={allowDataOverflow:Ra.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ra.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ra.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ra.scale,tick:Ra.tick,tickCount:Ra.tickCount,ticks:void 0,type:"category",unit:void 0},Uk=(t,n)=>t.polarAxis.angleAxis[n]!=null?t.polarAxis.angleAxis[n]:t.layout.layoutType==="radial"?mSe:fSe,Vk=(t,n)=>t.polarAxis.radiusAxis[n]!=null?t.polarAxis.radiusAxis[n]:t.layout.layoutType==="radial"?pSe:hSe,Av=t=>t.polarOptions,Hk=Se([Bo,Fo,Zs],IU),LV=Se([Av,Hk],(t,n)=>{if(t!=null)return Vr(t.innerRadius,n,0)}),BV=Se([Av,Hk],(t,n)=>{if(t!=null)return Vr(t.outerRadius,n,n*.8)}),xSe=t=>{if(t==null)return[0,0];var{startAngle:n,endAngle:s}=t;return[n,s]},FV=Se([Av],xSe);Se([Uk,FV],Cv);var $V=Se([Hk,LV,BV],(t,n,s)=>{if(!(t==null||n==null||s==null))return[n,s]});Se([Vk,$V],Cv);var zV=Se([cn,Av,LV,BV,Bo,Fo],(t,n,s,r,i,l)=>{if(!(t!=="centric"&&t!=="radial"||n==null||s==null||r==null)){var{cx:o,cy:c,startAngle:d,endAngle:u}=n;return{cx:Vr(o,i,i/2),cy:Vr(c,l,l/2),innerRadius:s,outerRadius:r,startAngle:d,endAngle:u,clockWise:!1}}}),Xn=(t,n)=>n,Fx=(t,n,s)=>s;function Wk(t){return t==null?void 0:t.id}function UV(t,n,s){var{chartData:r=[]}=n,{allowDuplicatedCategory:i,dataKey:l}=s,o=new Map;return t.forEach(c=>{var d,u=(d=c.data)!==null&&d!==void 0?d:r;if(!(u==null||u.length===0)){var h=Wk(c);u.forEach((m,x)=>{var b=l==null||i?x:String(ns(m,l,null)),w=ns(m,c.dataKey,0),j;o.has(b)?j=o.get(b):j={},Object.assign(j,{[h]:w}),o.set(b,j)})}}),Array.from(o.values())}function kv(t){return t.stackId!=null&&t.dataKey!=null}var Ev=(t,n)=>t===n?!0:t==null||n==null?!1:t[0]===n[0]&&t[1]===n[1];function Tv(t,n){return Array.isArray(t)&&Array.isArray(n)&&t.length===0&&n.length===0?!0:t===n}function gSe(t,n){if(t.length===n.length){for(var s=0;s<t.length;s++)if(t[s]!==n[s])return!1;return!0}return!1}var er=t=>{var n=cn(t);return n==="horizontal"?"xAxis":n==="vertical"?"yAxis":n==="centric"?"angleAxis":"radiusAxis"},Oh=t=>t.tooltip.settings.axisId;function OO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function ky(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?OO(Object(s),!0).forEach(function(r){ySe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):OO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function ySe(t,n,s){return(n=bSe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function bSe(t){var n=vSe(t,"string");return typeof n=="symbol"?n:n+""}function vSe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var M_=[0,"auto"],Ia={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},VV=(t,n)=>t.cartesianAxis.xAxis[n],zo=(t,n)=>{var s=VV(t,n);return s??Ia},Pa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:M_,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Mx},HV=(t,n)=>t.cartesianAxis.yAxis[n],Uo=(t,n)=>{var s=HV(t,n);return s??Pa},wSe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},qk=(t,n)=>{var s=t.cartesianAxis.zAxis[n];return s??wSe},is=(t,n,s)=>{switch(n){case"xAxis":return zo(t,s);case"yAxis":return Uo(t,s);case"zAxis":return qk(t,s);case"angleAxis":return Uk(t,s);case"radiusAxis":return Vk(t,s);default:throw new Error("Unexpected axis type: ".concat(n))}},NSe=(t,n,s)=>{switch(n){case"xAxis":return zo(t,s);case"yAxis":return Uo(t,s);default:throw new Error("Unexpected axis type: ".concat(n))}},$x=(t,n,s)=>{switch(n){case"xAxis":return zo(t,s);case"yAxis":return Uo(t,s);case"angleAxis":return Uk(t,s);case"radiusAxis":return Vk(t,s);default:throw new Error("Unexpected axis type: ".concat(n))}},WV=t=>t.graphicalItems.cartesianItems.some(n=>n.type==="bar")||t.graphicalItems.polarItems.some(n=>n.type==="radialBar");function Gk(t,n){return s=>{switch(t){case"xAxis":return"xAxisId"in s&&s.xAxisId===n;case"yAxis":return"yAxisId"in s&&s.yAxisId===n;case"zAxis":return"zAxisId"in s&&s.zAxisId===n;case"angleAxis":return"angleAxisId"in s&&s.angleAxisId===n;case"radiusAxis":return"radiusAxisId"in s&&s.radiusAxisId===n;default:return!1}}}var Kk=t=>t.graphicalItems.cartesianItems,jSe=Se([Xn,Fx],Gk),Yk=(t,n,s)=>t.filter(s).filter(r=>(n==null?void 0:n.includeHidden)===!0?!0:!r.hide),zx=Se([Kk,is,jSe],Yk,{memoizeOptions:{resultEqualityCheck:Tv}}),qV=Se([zx],t=>t.filter(n=>n.type==="area"||n.type==="bar").filter(kv)),GV=t=>t.filter(n=>!("stackId"in n)||n.stackId===void 0),SSe=Se([zx],GV),Xk=t=>t.map(n=>n.data).filter(Boolean).flat(1),_Se=Se([zx],Xk,{memoizeOptions:{resultEqualityCheck:Tv}}),Qk=(t,n)=>{var{chartData:s=[],dataStartIndex:r,dataEndIndex:i}=n;return t.length>0?t:s.slice(r,i+1)},Zk=Se([_Se,Rk],Qk),Jk=(t,n,s)=>(n==null?void 0:n.dataKey)!=null?t.map(r=>({value:ns(r,n.dataKey)})):s.length>0?s.map(r=>r.dataKey).flatMap(r=>t.map(i=>({value:ns(i,r)}))):t.map(r=>({value:r})),Iv=Se([Zk,is,zx],Jk);function KV(t,n){switch(t){case"xAxis":return n.direction==="x";case"yAxis":return n.direction==="y";default:return!1}}function qg(t){if($l(t)||t instanceof Date){var n=Number(t);if(Ns(n))return n}}function DO(t){if(Array.isArray(t)){var n=[qg(t[0]),qg(t[1])];return bu(n)?n:void 0}var s=qg(t);if(s!=null)return[s,s]}function Io(t){return t.map(qg).filter(Rye)}function CSe(t,n,s){return!s||typeof n!="number"||Fl(n)?[]:s.length?Io(s.flatMap(r=>{var i=ns(t,r.dataKey),l,o;if(Array.isArray(i)?[l,o]=i:l=o=i,!(!Ns(l)||!Ns(o)))return[n-l,n+o]})):[]}var tr=t=>{var n=er(t),s=Oh(t);return $x(t,n,s)},YV=Se([tr],t=>t==null?void 0:t.dataKey),ASe=Se([qV,Rk,tr],UV),XV=(t,n,s)=>{var r={},i=n.reduce((l,o)=>(o.stackId==null||(l[o.stackId]==null&&(l[o.stackId]=[]),l[o.stackId].push(o)),l),r);return Object.fromEntries(Object.entries(i).map(l=>{var[o,c]=l,d=c.map(Wk);return[o,{stackedData:jve(t,d,s),graphicalItems:c}]}))},O_=Se([ASe,qV,Bx],XV),QV=(t,n,s,r)=>{var{dataStartIndex:i,dataEndIndex:l}=n;if(r==null&&s!=="zAxis"){var o=kve(t,i,l);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},kSe=Se([is],t=>t.allowDataOverflow),eE=t=>{var n;if(t==null||!("domain"in t))return M_;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var s=Io(t.ticks);return[Math.min(...s),Math.max(...s)]}if(t.type==="category")return t.ticks.map(String)}return(n=t==null?void 0:t.domain)!==null&&n!==void 0?n:M_},tE=Se([is],eE),nE=Se([tE,kSe],bV),ESe=Se([O_,ld,Xn,nE],QV,{memoizeOptions:{resultEqualityCheck:Ev}}),Pv=t=>t.errorBars,TSe=(t,n,s)=>t.flatMap(r=>n[r.id]).filter(Boolean).filter(r=>KV(s,r)),Ey=function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];var i=s.filter(Boolean);if(i.length!==0){var l=i.flat(),o=Math.min(...l),c=Math.max(...l);return[o,c]}},sE=(t,n,s,r,i)=>{var l,o;if(s.length>0&&t.forEach(c=>{s.forEach(d=>{var u,h,m=(u=r[d.id])===null||u===void 0?void 0:u.filter(C=>KV(i,C)),x=ns(c,(h=n.dataKey)!==null&&h!==void 0?h:d.dataKey),b=CSe(c,x,m);if(b.length>=2){var w=Math.min(...b),j=Math.max(...b);(l==null||w<l)&&(l=w),(o==null||j>o)&&(o=j)}var S=DO(x);S!=null&&(l=l==null?S[0]:Math.min(l,S[0]),o=o==null?S[1]:Math.max(o,S[1]))})}),(n==null?void 0:n.dataKey)!=null&&t.forEach(c=>{var d=DO(ns(c,n.dataKey));d!=null&&(l=l==null?d[0]:Math.min(l,d[0]),o=o==null?d[1]:Math.max(o,d[1]))}),Ns(l)&&Ns(o))return[l,o]},ISe=Se([Zk,is,SSe,Pv,Xn],sE,{memoizeOptions:{resultEqualityCheck:Ev}});function PSe(t){var{value:n}=t;if($l(n)||n instanceof Date)return n}var MSe=(t,n,s)=>{var r=t.map(PSe).filter(i=>i!=null);return s&&(n.dataKey==null||n.allowDuplicatedCategory&&uz(r))?BU(0,t.length):n.allowDuplicatedCategory?r:Array.from(new Set(r))},ZV=t=>t.referenceElements.dots,Dh=(t,n,s)=>t.filter(r=>r.ifOverflow==="extendDomain").filter(r=>n==="xAxis"?r.xAxisId===s:r.yAxisId===s),OSe=Se([ZV,Xn,Fx],Dh),JV=t=>t.referenceElements.areas,DSe=Se([JV,Xn,Fx],Dh),eH=t=>t.referenceElements.lines,RSe=Se([eH,Xn,Fx],Dh),tH=(t,n)=>{var s=Io(t.map(r=>n==="xAxis"?r.x:r.y));if(s.length!==0)return[Math.min(...s),Math.max(...s)]},LSe=Se(OSe,Xn,tH),nH=(t,n)=>{var s=Io(t.flatMap(r=>[n==="xAxis"?r.x1:r.y1,n==="xAxis"?r.x2:r.y2]));if(s.length!==0)return[Math.min(...s),Math.max(...s)]},BSe=Se([DSe,Xn],nH);function FSe(t){var n;if(t.x!=null)return Io([t.x]);var s=(n=t.segment)===null||n===void 0?void 0:n.map(r=>r.x);return s==null||s.length===0?[]:Io(s)}function $Se(t){var n;if(t.y!=null)return Io([t.y]);var s=(n=t.segment)===null||n===void 0?void 0:n.map(r=>r.y);return s==null||s.length===0?[]:Io(s)}var sH=(t,n)=>{var s=t.flatMap(r=>n==="xAxis"?FSe(r):$Se(r));if(s.length!==0)return[Math.min(...s),Math.max(...s)]},zSe=Se([RSe,Xn],sH),USe=Se(LSe,zSe,BSe,(t,n,s)=>Ey(t,s,n)),rE=(t,n,s,r,i,l,o,c)=>{if(s!=null)return s;var d=o==="vertical"&&c==="xAxis"||o==="horizontal"&&c==="yAxis",u=d?Ey(r,l,i):Ey(l,i);return Zje(n,u,t.allowDataOverflow)},VSe=Se([is,tE,nE,ESe,ISe,USe,cn,Xn],rE,{memoizeOptions:{resultEqualityCheck:Ev}}),HSe=[0,1],aE=(t,n,s,r,i,l,o)=>{if(!((t==null||s==null||s.length===0)&&o===void 0)){var{dataKey:c,type:d}=t,u=Lu(n,l);if(u&&c==null){var h;return BU(0,(h=s==null?void 0:s.length)!==null&&h!==void 0?h:0)}return d==="category"?MSe(r,t,u):i==="expand"?HSe:o}},iE=Se([is,cn,Zk,Iv,Bx,Xn,VSe],aE),rH=(t,n,s,r,i)=>{if(t!=null){var{scale:l,type:o}=t;if(l==="auto")return n==="radial"&&i==="radiusAxis"?"band":n==="radial"&&i==="angleAxis"?"linear":o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!s)?"point":o==="category"?"band":"linear";if(typeof l=="string"){var c="scale".concat(Tx(l));return c in Rm?c:"point"}}},Rh=Se([is,cn,WV,Fk,Xn],rH);function WSe(t){if(t!=null){if(t in Rm)return Rm[t]();var n="scale".concat(Tx(t));if(n in Rm)return Rm[n]()}}function lE(t,n,s,r){if(!(s==null||r==null)){if(typeof t.scale=="function")return t.scale.copy().domain(s).range(r);var i=WSe(n);if(i!=null){var l=i.domain(s).range(r);return yve(l),l}}}var oE=(t,n,s)=>{var r=eE(n);if(!(s!=="auto"&&s!=="linear")){if(n!=null&&n.tickCount&&Array.isArray(r)&&(r[0]==="auto"||r[1]==="auto")&&bu(t))return oSe(t,n.tickCount,n.allowDecimals);if(n!=null&&n.tickCount&&n.type==="number"&&bu(t))return cSe(t,n.tickCount,n.allowDecimals)}},cE=Se([iE,$x,Rh],oE),dE=(t,n,s,r)=>{if(r!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&bu(n)&&Array.isArray(s)&&s.length>0){var i=n[0],l=s[0],o=n[1],c=s[s.length-1];return[Math.min(i,l),Math.max(o,c)]}return n},qSe=Se([is,iE,cE,Xn],dE),GSe=Se(Iv,is,(t,n)=>{if(!(!n||n.type!=="number")){var s=1/0,r=Array.from(Io(t.map(c=>c.value))).sort((c,d)=>c-d);if(r.length<2)return 1/0;var i=r[r.length-1]-r[0];if(i===0)return 1/0;for(var l=0;l<r.length-1;l++){var o=r[l+1]-r[l];s=Math.min(s,o)}return s/i}}),aH=Se(GSe,cn,DV,Zs,(t,n,s,r)=>r,(t,n,s,r,i)=>{if(!Ns(t))return 0;var l=n==="vertical"?r.height:r.width;if(i==="gap")return t*l/2;if(i==="no-gap"){var o=Vr(s,t*l),c=t*l/2;return c-o-(c-o)/l*o}return 0}),KSe=(t,n)=>{var s=zo(t,n);return s==null||typeof s.padding!="string"?0:aH(t,"xAxis",n,s.padding)},YSe=(t,n)=>{var s=Uo(t,n);return s==null||typeof s.padding!="string"?0:aH(t,"yAxis",n,s.padding)},XSe=Se(zo,KSe,(t,n)=>{var s,r;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:n,right:n}:{left:((s=i.left)!==null&&s!==void 0?s:0)+n,right:((r=i.right)!==null&&r!==void 0?r:0)+n}}),QSe=Se(Uo,YSe,(t,n)=>{var s,r;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:n,bottom:n}:{top:((s=i.top)!==null&&s!==void 0?s:0)+n,bottom:((r=i.bottom)!==null&&r!==void 0?r:0)+n}}),ZSe=Se([Zs,XSe,hv,fv,(t,n,s)=>s],(t,n,s,r,i)=>{var{padding:l}=r;return i?[l.left,s.width-l.right]:[t.left+n.left,t.left+t.width-n.right]}),JSe=Se([Zs,cn,QSe,hv,fv,(t,n,s)=>s],(t,n,s,r,i,l)=>{var{padding:o}=i;return l?[r.height-o.bottom,o.top]:n==="horizontal"?[t.top+t.height-s.bottom,t.top+s.top]:[t.top+s.top,t.top+t.height-s.bottom]}),Ux=(t,n,s,r)=>{var i;switch(n){case"xAxis":return ZSe(t,s,r);case"yAxis":return JSe(t,s,r);case"zAxis":return(i=qk(t,s))===null||i===void 0?void 0:i.range;case"angleAxis":return FV(t);case"radiusAxis":return $V(t,s);default:return}},iH=Se([is,Ux],Cv),Lh=Se([is,Rh,qSe,iH],lE);Se([zx,Pv,Xn],TSe);function lH(t,n){return t.id<n.id?-1:t.id>n.id?1:0}var Mv=(t,n)=>n,Ov=(t,n,s)=>s,e_e=Se(dv,Mv,Ov,(t,n,s)=>t.filter(r=>r.orientation===n).filter(r=>r.mirror===s).sort(lH)),t_e=Se(uv,Mv,Ov,(t,n,s)=>t.filter(r=>r.orientation===n).filter(r=>r.mirror===s).sort(lH)),oH=(t,n)=>({width:t.width,height:n.height}),n_e=(t,n)=>{var s=typeof n.width=="number"?n.width:Mx;return{width:s,height:t.height}},cH=Se(Zs,zo,oH),s_e=(t,n,s)=>{switch(n){case"top":return t.top;case"bottom":return s-t.bottom;default:return 0}},r_e=(t,n,s)=>{switch(n){case"left":return t.left;case"right":return s-t.right;default:return 0}},a_e=Se(Fo,Zs,e_e,Mv,Ov,(t,n,s,r,i)=>{var l={},o;return s.forEach(c=>{var d=oH(n,c);o==null&&(o=s_e(n,r,t));var u=r==="top"&&!i||r==="bottom"&&i;l[c.id]=o-Number(u)*d.height,o+=(u?-1:1)*d.height}),l}),i_e=Se(Bo,Zs,t_e,Mv,Ov,(t,n,s,r,i)=>{var l={},o;return s.forEach(c=>{var d=n_e(n,c);o==null&&(o=r_e(n,r,t));var u=r==="left"&&!i||r==="right"&&i;l[c.id]=o-Number(u)*d.width,o+=(u?-1:1)*d.width}),l}),l_e=(t,n)=>{var s=zo(t,n);if(s!=null)return a_e(t,s.orientation,s.mirror)},o_e=Se([Zs,zo,l_e,(t,n)=>n],(t,n,s,r)=>{if(n!=null){var i=s==null?void 0:s[r];return i==null?{x:t.left,y:0}:{x:t.left,y:i}}}),c_e=(t,n)=>{var s=Uo(t,n);if(s!=null)return i_e(t,s.orientation,s.mirror)},d_e=Se([Zs,Uo,c_e,(t,n)=>n],(t,n,s,r)=>{if(n!=null){var i=s==null?void 0:s[r];return i==null?{x:0,y:t.top}:{x:i,y:t.top}}}),dH=Se(Zs,Uo,(t,n)=>{var s=typeof n.width=="number"?n.width:Mx;return{width:s,height:t.height}}),RO=(t,n,s)=>{switch(n){case"xAxis":return cH(t,s).width;case"yAxis":return dH(t,s).height;default:return}},uH=(t,n,s,r)=>{if(s!=null){var{allowDuplicatedCategory:i,type:l,dataKey:o}=s,c=Lu(t,r),d=n.map(u=>u.value);if(o&&c&&l==="category"&&i&&uz(d))return d}},uE=Se([cn,Iv,is,Xn],uH),fH=(t,n,s,r)=>{if(!(s==null||s.dataKey==null)){var{type:i,scale:l}=s,o=Lu(t,r);if(o&&(i==="number"||l!=="auto"))return n.map(c=>c.value)}},fE=Se([cn,Iv,$x,Xn],fH);Se([cn,NSe,Rh,Lh,uE,fE,Ux,cE,Xn],(t,n,s,r,i,l,o,c,d)=>{if(n!=null){var u=Lu(t,d);return{angle:n.angle,interval:n.interval,minTickGap:n.minTickGap,orientation:n.orientation,tick:n.tick,tickCount:n.tickCount,tickFormatter:n.tickFormatter,ticks:n.ticks,type:n.type,unit:n.unit,axisType:d,categoricalDomain:l,duplicateDomain:i,isCategorical:u,niceTicks:c,range:o,realScaleType:s,scale:r}}});var u_e=(t,n,s,r,i,l,o,c,d)=>{if(!(n==null||r==null)){var u=Lu(t,d),{type:h,ticks:m,tickCount:x}=n,b=s==="scaleBand"&&typeof r.bandwidth=="function"?r.bandwidth()/2:2,w=h==="category"&&r.bandwidth?r.bandwidth()/b:0;w=d==="angleAxis"&&l!=null&&l.length>=2?Cr(l[0]-l[1])*2*w:w;var j=m||i;if(j){var S=j.map((C,A)=>{var k=o?o.indexOf(C):C;return{index:A,coordinate:r(k)+w,value:C,offset:w}});return S.filter(C=>Ns(C.coordinate))}return u&&c?c.map((C,A)=>({coordinate:r(C)+w,value:C,index:A,offset:w})).filter(C=>Ns(C.coordinate)):r.ticks?r.ticks(x).map(C=>({coordinate:r(C)+w,value:C,offset:w})):r.domain().map((C,A)=>({coordinate:r(C)+w,value:o?o[C]:C,index:A,offset:w}))}},hH=Se([cn,$x,Rh,Lh,cE,Ux,uE,fE,Xn],u_e),f_e=(t,n,s,r,i,l,o)=>{if(!(n==null||s==null||r==null||r[0]===r[1])){var c=Lu(t,o),{tickCount:d}=n,u=0;return u=o==="angleAxis"&&(r==null?void 0:r.length)>=2?Cr(r[0]-r[1])*2*u:u,c&&l?l.map((h,m)=>({coordinate:s(h)+u,value:h,index:m,offset:u})):s.ticks?s.ticks(d).map(h=>({coordinate:s(h)+u,value:h,offset:u})):s.domain().map((h,m)=>({coordinate:s(h)+u,value:i?i[h]:h,index:m,offset:u}))}},ch=Se([cn,$x,Lh,Ux,uE,fE,Xn],f_e),dh=Se(is,Lh,(t,n)=>{if(!(t==null||n==null))return ky(ky({},t),{},{scale:n})}),h_e=Se([is,Rh,iE,iH],lE);Se((t,n,s)=>qk(t,s),h_e,(t,n)=>{if(!(t==null||n==null))return ky(ky({},t),{},{scale:n})});var m_e=Se([cn,dv,uv],(t,n,s)=>{switch(t){case"horizontal":return n.some(r=>r.reversed)?"right-to-left":"left-to-right";case"vertical":return s.some(r=>r.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),mH=t=>t.options.defaultTooltipEventType,pH=t=>t.options.validateTooltipEventTypes;function xH(t,n,s){if(t==null)return n;var r=t?"axis":"item";return s==null?n:s.includes(r)?r:n}function hE(t,n){var s=mH(t),r=pH(t);return xH(n,s,r)}function p_e(t){return yt(n=>hE(n,t))}var gH=(t,n)=>{var s,r=Number(n);if(!(Fl(r)||n==null))return r>=0?t==null||(s=t[r])===null||s===void 0?void 0:s.value:void 0},x_e=t=>t.tooltip.settings,mc={active:!1,index:null,dataKey:void 0,coordinate:void 0},g_e={itemInteraction:{click:mc,hover:mc},axisInteraction:{click:mc,hover:mc},keyboardInteraction:mc,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},yH=ka({name:"tooltip",initialState:g_e,reducers:{addTooltipEntrySettings:{reducer(t,n){t.tooltipItemPayloads.push(n.payload)},prepare:qs()},removeTooltipEntrySettings:{reducer(t,n){var s=xo(t).tooltipItemPayloads.indexOf(n.payload);s>-1&&t.tooltipItemPayloads.splice(s,1)},prepare:qs()},setTooltipSettingsState(t,n){t.settings=n.payload},setActiveMouseOverItemIndex(t,n){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=n.payload.activeIndex,t.itemInteraction.hover.dataKey=n.payload.activeDataKey,t.itemInteraction.hover.coordinate=n.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,n){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=n.payload.activeIndex,t.itemInteraction.click.dataKey=n.payload.activeDataKey,t.itemInteraction.click.coordinate=n.payload.activeCoordinate},setMouseOverAxisIndex(t,n){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=n.payload.activeIndex,t.axisInteraction.hover.dataKey=n.payload.activeDataKey,t.axisInteraction.hover.coordinate=n.payload.activeCoordinate},setMouseClickAxisIndex(t,n){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=n.payload.activeIndex,t.axisInteraction.click.dataKey=n.payload.activeDataKey,t.axisInteraction.click.coordinate=n.payload.activeCoordinate},setSyncInteraction(t,n){t.syncInteraction=n.payload},setKeyboardInteraction(t,n){t.keyboardInteraction.active=n.payload.active,t.keyboardInteraction.index=n.payload.activeIndex,t.keyboardInteraction.coordinate=n.payload.activeCoordinate,t.keyboardInteraction.dataKey=n.payload.activeDataKey}}}),{addTooltipEntrySettings:y_e,removeTooltipEntrySettings:b_e,setTooltipSettingsState:v_e,setActiveMouseOverItemIndex:bH,mouseLeaveItem:w_e,mouseLeaveChart:vH,setActiveClickItemIndex:N_e,setMouseOverAxisIndex:wH,setMouseClickAxisIndex:j_e,setSyncInteraction:D_,setKeyboardInteraction:R_}=yH.actions,S_e=yH.reducer;function LO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function sg(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?LO(Object(s),!0).forEach(function(r){__e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):LO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function __e(t,n,s){return(n=C_e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function C_e(t){var n=A_e(t,"string");return typeof n=="symbol"?n:n+""}function A_e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function k_e(t,n,s){return n==="axis"?s==="click"?t.axisInteraction.click:t.axisInteraction.hover:s==="click"?t.itemInteraction.click:t.itemInteraction.hover}function E_e(t){return t.index!=null}var NH=(t,n,s,r)=>{if(n==null)return mc;var i=k_e(t,n,s);if(i==null)return mc;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var l=t.settings.active===!0;if(E_e(i)){if(l)return sg(sg({},i),{},{active:!0})}else if(r!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return sg(sg({},mc),{},{coordinate:i.coordinate})},mE=(t,n)=>{var s=t==null?void 0:t.index;if(s==null)return null;var r=Number(s);if(!Ns(r))return s;var i=0,l=1/0;return n.length>0&&(l=n.length-1),String(Math.max(i,Math.min(r,l)))},jH=(t,n,s,r,i,l,o,c)=>{if(!(l==null||c==null)){var d=o[0],u=d==null?void 0:c(d.positions,l);if(u!=null)return u;var h=i==null?void 0:i[Number(l)];if(h)switch(s){case"horizontal":return{x:h.coordinate,y:(r.top+n)/2};default:return{x:(r.left+t)/2,y:h.coordinate}}}},SH=(t,n,s,r)=>{if(n==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return s==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&r!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(l=>{var o;return((o=l.settings)===null||o===void 0?void 0:o.dataKey)===i})},Vx=t=>t.options.tooltipPayloadSearcher,Bh=t=>t.tooltip;function BO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function FO(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?BO(Object(s),!0).forEach(function(r){T_e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):BO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function T_e(t,n,s){return(n=I_e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function I_e(t){var n=P_e(t,"string");return typeof n=="symbol"?n:n+""}function P_e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function M_e(t,n){return t??n}var _H=(t,n,s,r,i,l,o)=>{if(!(n==null||l==null)){var{chartData:c,computedData:d,dataStartIndex:u,dataEndIndex:h}=s,m=[];return t.reduce((x,b)=>{var w,{dataDefinedOnItem:j,settings:S}=b,C=M_e(j,c),A=Array.isArray(C)?uU(C,u,h):C,k=(w=S==null?void 0:S.dataKey)!==null&&w!==void 0?w:r,T=S==null?void 0:S.nameKey,I;if(r&&Array.isArray(A)&&!Array.isArray(A[0])&&o==="axis"?I=Dye(A,r,i):I=l(A,n,d,T),Array.isArray(I))I.forEach(O=>{var R=FO(FO({},S),{},{name:O.name,unit:O.unit,color:void 0,fill:void 0});x.push(wM({tooltipEntrySettings:R,dataKey:O.dataKey,payload:O.payload,value:ns(O.payload,O.dataKey),name:O.name}))});else{var D;x.push(wM({tooltipEntrySettings:S,dataKey:k,payload:I,value:ns(I,k),name:(D=ns(I,T))!==null&&D!==void 0?D:S==null?void 0:S.name}))}return x},m)}},pE=Se([tr,cn,WV,Fk,er],rH),O_e=Se([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,n)=>[...t,...n]),D_e=Se([er,Oh],Gk),Hx=Se([O_e,tr,D_e],Yk,{memoizeOptions:{resultEqualityCheck:Tv}}),R_e=Se([Hx],t=>t.filter(kv)),L_e=Se([Hx],Xk,{memoizeOptions:{resultEqualityCheck:Tv}}),Fh=Se([L_e,ld],Qk),B_e=Se([R_e,ld,tr],UV),xE=Se([Fh,tr,Hx],Jk),CH=Se([tr],eE),F_e=Se([tr],t=>t.allowDataOverflow),AH=Se([CH,F_e],bV),$_e=Se([Hx],t=>t.filter(kv)),z_e=Se([B_e,$_e,Bx],XV),U_e=Se([z_e,ld,er,AH],QV),V_e=Se([Hx],GV),H_e=Se([Fh,tr,V_e,Pv,er],sE,{memoizeOptions:{resultEqualityCheck:Ev}}),W_e=Se([ZV,er,Oh],Dh),q_e=Se([W_e,er],tH),G_e=Se([JV,er,Oh],Dh),K_e=Se([G_e,er],nH),Y_e=Se([eH,er,Oh],Dh),X_e=Se([Y_e,er],sH),Q_e=Se([q_e,X_e,K_e],Ey),Z_e=Se([tr,CH,AH,U_e,H_e,Q_e,cn,er],rE),kH=Se([tr,cn,Fh,xE,Bx,er,Z_e],aE),J_e=Se([kH,tr,pE],oE),eCe=Se([tr,kH,J_e,er],dE),EH=t=>{var n=er(t),s=Oh(t),r=!1;return Ux(t,n,s,r)},TH=Se([tr,EH],Cv),IH=Se([tr,pE,eCe,TH],lE),tCe=Se([cn,xE,tr,er],uH),nCe=Se([cn,xE,tr,er],fH),sCe=(t,n,s,r,i,l,o,c)=>{if(n){var{type:d}=n,u=Lu(t,c);if(r){var h=s==="scaleBand"&&r.bandwidth?r.bandwidth()/2:2,m=d==="category"&&r.bandwidth?r.bandwidth()/h:0;return m=c==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Cr(i[0]-i[1])*2*m:m,u&&o?o.map((x,b)=>({coordinate:r(x)+m,value:x,index:b,offset:m})):r.domain().map((x,b)=>({coordinate:r(x)+m,value:l?l[x]:x,index:b,offset:m}))}}},Vo=Se([cn,tr,pE,IH,EH,tCe,nCe,er],sCe),gE=Se([mH,pH,x_e],(t,n,s)=>xH(s.shared,t,n)),PH=t=>t.tooltip.settings.trigger,yE=t=>t.tooltip.settings.defaultIndex,Dv=Se([Bh,gE,PH,yE],NH),wu=Se([Dv,Fh],mE),MH=Se([Vo,wu],gH),OH=Se([Dv],t=>{if(t)return t.dataKey}),DH=Se([Bh,gE,PH,yE],SH),rCe=Se([Bo,Fo,cn,Zs,Vo,yE,DH,Vx],jH),aCe=Se([Dv,rCe],(t,n)=>t!=null&&t.coordinate?t.coordinate:n),iCe=Se([Dv],t=>t.active),lCe=Se([DH,wu,ld,YV,MH,Vx,gE],_H);Se([lCe],t=>{if(t!=null){var n=t.map(s=>s.payload).filter(s=>s!=null);return Array.from(new Set(n))}});function $O(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function zO(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?$O(Object(s),!0).forEach(function(r){oCe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$O(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function oCe(t,n,s){return(n=cCe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function cCe(t){var n=dCe(t,"string");return typeof n=="symbol"?n:n+""}function dCe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var uCe=()=>yt(tr),fCe=()=>{var t=uCe(),n=yt(Vo),s=yt(IH);return fy(!t||!s?void 0:zO(zO({},t),{},{scale:s}),n)};function UO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Qu(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?UO(Object(s),!0).forEach(function(r){hCe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):UO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function hCe(t,n,s){return(n=mCe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function mCe(t){var n=pCe(t,"string");return typeof n=="symbol"?n:n+""}function pCe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var xCe=(t,n,s,r)=>{var i=n.find(l=>l&&l.index===s);if(i){if(t==="horizontal")return{x:i.coordinate,y:r.chartY};if(t==="vertical")return{x:r.chartX,y:i.coordinate}}return{x:0,y:0}},gCe=(t,n,s,r)=>{var i=n.find(u=>u&&u.index===s);if(i){if(t==="centric"){var l=i.coordinate,{radius:o}=r;return Qu(Qu(Qu({},r),Is(r.cx,r.cy,o,l)),{},{angle:l,radius:o})}var c=i.coordinate,{angle:d}=r;return Qu(Qu(Qu({},r),Is(r.cx,r.cy,c,d)),{},{angle:d,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function yCe(t,n){var{chartX:s,chartY:r}=t;return s>=n.left&&s<=n.left+n.width&&r>=n.top&&r<=n.top+n.height}var RH=(t,n,s,r,i)=>{var l,o=-1,c=(l=n==null?void 0:n.length)!==null&&l!==void 0?l:0;if(c<=1||t==null)return 0;if(r==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<c;d++){var u=d>0?s[d-1].coordinate:s[c-1].coordinate,h=s[d].coordinate,m=d>=c-1?s[0].coordinate:s[d+1].coordinate,x=void 0;if(Cr(h-u)!==Cr(m-h)){var b=[];if(Cr(m-h)===Cr(i[1]-i[0])){x=m;var w=h+i[1]-i[0];b[0]=Math.min(w,(w+u)/2),b[1]=Math.max(w,(w+u)/2)}else{x=u;var j=m+i[1]-i[0];b[0]=Math.min(h,(j+h)/2),b[1]=Math.max(h,(j+h)/2)}var S=[Math.min(h,(x+h)/2),Math.max(h,(x+h)/2)];if(t>S[0]&&t<=S[1]||t>=b[0]&&t<=b[1]){({index:o}=s[d]);break}}else{var C=Math.min(u,m),A=Math.max(u,m);if(t>(C+h)/2&&t<=(A+h)/2){({index:o}=s[d]);break}}}else if(n){for(var k=0;k<c;k++)if(k===0&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k>0&&k<c-1&&t>(n[k].coordinate+n[k-1].coordinate)/2&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k===c-1&&t>(n[k].coordinate+n[k-1].coordinate)/2){({index:o}=n[k]);break}}return o},bCe=()=>yt(Fk),bE=(t,n)=>n,LH=(t,n,s)=>s,vE=(t,n,s,r)=>r,vCe=Se(Vo,t=>sv(t,n=>n.coordinate)),wE=Se([Bh,bE,LH,vE],NH),BH=Se([wE,Fh],mE),wCe=(t,n,s)=>{if(n!=null){var r=Bh(t);return n==="axis"?s==="hover"?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:s==="hover"?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}},FH=Se([Bh,bE,LH,vE],SH),Ty=Se([Bo,Fo,cn,Zs,Vo,vE,FH,Vx],jH),NCe=Se([wE,Ty],(t,n)=>{var s;return(s=t.coordinate)!==null&&s!==void 0?s:n}),$H=Se([Vo,BH],gH),jCe=Se([FH,BH,ld,YV,$H,Vx,bE],_H),SCe=Se([wE],t=>({isActive:t.active,activeIndex:t.index})),_Ce=(t,n,s,r,i,l,o)=>{if(!(!t||!s||!r||!i)&&yCe(t,o)){var c=Eve(t,n),d=RH(c,l,i,s,r),u=xCe(n,i,d,t);return{activeIndex:String(d),activeCoordinate:u}}},CCe=(t,n,s,r,i,l,o)=>{if(!(!t||!r||!i||!l||!s)){var c=yNe(t,s);if(c){var d=Tve(c,n),u=RH(d,o,l,r,i),h=gCe(n,l,u,c);return{activeIndex:String(u),activeCoordinate:h}}}},ACe=(t,n,s,r,i,l,o,c)=>{if(!(!t||!n||!r||!i||!l))return n==="horizontal"||n==="vertical"?_Ce(t,n,r,i,l,o,c):CCe(t,n,s,r,i,l,o)},kCe=Se(t=>t.zIndex.zIndexMap,(t,n)=>n,(t,n,s)=>s,(t,n,s)=>{if(n!=null){var r=t[n];if(r!=null)return s?r.panoramaElementId:r.elementId}}),ECe=Se(t=>t.zIndex.zIndexMap,t=>{var n=Object.keys(t).map(r=>parseInt(r,10)).concat(Object.values($r)),s=Array.from(new Set(n));return s.sort((r,i)=>r-i)},{memoizeOptions:{resultEqualityCheck:gSe}});function VO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function HO(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?VO(Object(s),!0).forEach(function(r){TCe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):VO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function TCe(t,n,s){return(n=ICe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function ICe(t){var n=PCe(t,"string");return typeof n=="symbol"?n:n+""}function PCe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var MCe={},OCe={zIndexMap:Object.values($r).reduce((t,n)=>HO(HO({},t),{},{[n]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),MCe)},DCe=new Set(Object.values($r));function RCe(t){return DCe.has(t)}var zH=ka({name:"zIndex",initialState:OCe,reducers:{registerZIndexPortal:{reducer:(t,n)=>{var{zIndex:s}=n.payload;t.zIndexMap[s]?t.zIndexMap[s].consumers+=1:t.zIndexMap[s]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:qs()},unregisterZIndexPortal:{reducer:(t,n)=>{var{zIndex:s}=n.payload;t.zIndexMap[s]&&(t.zIndexMap[s].consumers-=1,t.zIndexMap[s].consumers<=0&&!RCe(s)&&delete t.zIndexMap[s])},prepare:qs()},registerZIndexPortalId:{reducer:(t,n)=>{var{zIndex:s,elementId:r,isPanorama:i}=n.payload;t.zIndexMap[s]?i?t.zIndexMap[s].panoramaElementId=r:t.zIndexMap[s].elementId=r:t.zIndexMap[s]={consumers:0,elementId:i?void 0:r,panoramaElementId:i?r:void 0}},prepare:qs()},unregisterZIndexPortalId:{reducer:(t,n)=>{var{zIndex:s}=n.payload;t.zIndexMap[s]&&(n.payload.isPanorama?t.zIndexMap[s].panoramaElementId=void 0:t.zIndexMap[s].elementId=void 0)},prepare:qs()}}}),{registerZIndexPortal:LCe,unregisterZIndexPortal:BCe,registerZIndexPortalId:FCe,unregisterZIndexPortalId:$Ce}=zH.actions,zCe=zH.reducer;function Gl(t){var{zIndex:n,children:s}=t,r=awe(),i=r&&n!==void 0&&n!==0,l=ti(),o=Yn();y.useLayoutEffect(()=>i?(o(LCe({zIndex:n})),()=>{o(BCe({zIndex:n}))}):Ru,[o,n,i]);var c=yt(u=>kCe(u,n,l));if(!i)return s;if(!c)return null;var d=document.getElementById(c);return d?Zc.createPortal(s,d):null}function L_(){return L_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},L_.apply(null,arguments)}function WO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function rg(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?WO(Object(s),!0).forEach(function(r){UCe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):WO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function UCe(t,n,s){return(n=VCe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function VCe(t){var n=HCe(t,"string");return typeof n=="symbol"?n:n+""}function HCe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function WCe(t){var{cursor:n,cursorComp:s,cursorProps:r}=t;return y.isValidElement(n)?y.cloneElement(n,r):y.createElement(s,r)}function qCe(t){var n,{coordinate:s,payload:r,index:i,offset:l,tooltipAxisBandSize:o,layout:c,cursor:d,tooltipEventType:u,chartName:h}=t,m=s,x=r,b=i;if(!d||!m||h!=="ScatterChart"&&u!=="axis")return null;var w,j,S;if(h==="ScatterChart")w=m,j=Owe,S=$r.cursorLine;else if(h==="BarChart")w=Dwe(c,m,l,o),j=TU,S=$r.cursorRectangle;else if(c==="radial"&&mz(m)){var{cx:C,cy:A,radius:k,startAngle:T,endAngle:I}=PU(m);w={cx:C,cy:A,startAngle:T,endAngle:I,innerRadius:k,outerRadius:k},j=OU,S=$r.cursorLine}else w={points:NNe(c,m,l)},j=uk,S=$r.cursorLine;var D=typeof d=="object"&&"className"in d?d.className:void 0,O=rg(rg(rg(rg({stroke:"#ccc",pointerEvents:"none"},l),w),qp(d)),{},{payload:x,payloadIndex:b,className:fn("recharts-tooltip-cursor",D)});return y.createElement(Gl,{zIndex:(n=t.zIndex)!==null&&n!==void 0?n:S},y.createElement(WCe,{cursor:d,cursorComp:j,cursorProps:O}))}function GCe(t){var n=fCe(),s=nwe(),r=pv(),i=bCe();return n==null||s==null||r==null||i==null?null:y.createElement(qCe,L_({},t,{offset:s,layout:r,tooltipAxisBandSize:n,chartName:i}))}var UH=y.createContext(null),KCe=()=>y.useContext(UH),VH={exports:{}};(function(t){var n=Object.prototype.hasOwnProperty,s="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(s=!1));function i(d,u,h){this.fn=d,this.context=u,this.once=h||!1}function l(d,u,h,m,x){if(typeof h!="function")throw new TypeError("The listener must be a function");var b=new i(h,m||d,x),w=s?s+u:u;return d._events[w]?d._events[w].fn?d._events[w]=[d._events[w],b]:d._events[w].push(b):(d._events[w]=b,d._eventsCount++),d}function o(d,u){--d._eventsCount===0?d._events=new r:delete d._events[u]}function c(){this._events=new r,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],h,m;if(this._eventsCount===0)return u;for(m in h=this._events)n.call(h,m)&&u.push(s?m.slice(1):m);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},c.prototype.listeners=function(u){var h=s?s+u:u,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,b=m.length,w=new Array(b);x<b;x++)w[x]=m[x].fn;return w},c.prototype.listenerCount=function(u){var h=s?s+u:u,m=this._events[h];return m?m.fn?1:m.length:0},c.prototype.emit=function(u,h,m,x,b,w){var j=s?s+u:u;if(!this._events[j])return!1;var S=this._events[j],C=arguments.length,A,k;if(S.fn){switch(S.once&&this.removeListener(u,S.fn,void 0,!0),C){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,h),!0;case 3:return S.fn.call(S.context,h,m),!0;case 4:return S.fn.call(S.context,h,m,x),!0;case 5:return S.fn.call(S.context,h,m,x,b),!0;case 6:return S.fn.call(S.context,h,m,x,b,w),!0}for(k=1,A=new Array(C-1);k<C;k++)A[k-1]=arguments[k];S.fn.apply(S.context,A)}else{var T=S.length,I;for(k=0;k<T;k++)switch(S[k].once&&this.removeListener(u,S[k].fn,void 0,!0),C){case 1:S[k].fn.call(S[k].context);break;case 2:S[k].fn.call(S[k].context,h);break;case 3:S[k].fn.call(S[k].context,h,m);break;case 4:S[k].fn.call(S[k].context,h,m,x);break;default:if(!A)for(I=1,A=new Array(C-1);I<C;I++)A[I-1]=arguments[I];S[k].fn.apply(S[k].context,A)}}return!0},c.prototype.on=function(u,h,m){return l(this,u,h,m,!1)},c.prototype.once=function(u,h,m){return l(this,u,h,m,!0)},c.prototype.removeListener=function(u,h,m,x){var b=s?s+u:u;if(!this._events[b])return this;if(!h)return o(this,b),this;var w=this._events[b];if(w.fn)w.fn===h&&(!x||w.once)&&(!m||w.context===m)&&o(this,b);else{for(var j=0,S=[],C=w.length;j<C;j++)(w[j].fn!==h||x&&!w[j].once||m&&w[j].context!==m)&&S.push(w[j]);S.length?this._events[b]=S.length===1?S[0]:S:o(this,b)}return this},c.prototype.removeAllListeners=function(u){var h;return u?(h=s?s+u:u,this._events[h]&&o(this,h)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,t.exports=c})(VH);var YCe=VH.exports;const XCe=Ii(YCe);var sx=new XCe,B_="recharts.syncEvent.tooltip",qO="recharts.syncEvent.brush";function HH(t,n){if(n){var s=Number.parseInt(n,10);if(!Fl(s))return t==null?void 0:t[s]}}var QCe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},WH=ka({name:"options",initialState:QCe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),ZCe=WH.reducer,{createEventEmitter:JCe}=WH.actions;function e3e(t){return t.tooltip.syncInteraction}var t3e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},qH=ka({name:"chartData",initialState:t3e,reducers:{setChartData(t,n){if(t.chartData=n.payload,n.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}n.payload.length>0&&t.dataEndIndex!==n.payload.length-1&&(t.dataEndIndex=n.payload.length-1)},setComputedData(t,n){t.computedData=n.payload},setDataStartEndIndexes(t,n){var{startIndex:s,endIndex:r}=n.payload;s!=null&&(t.dataStartIndex=s),r!=null&&(t.dataEndIndex=r)}}}),{setChartData:GO,setDataStartEndIndexes:n3e,setComputedData:ULe}=qH.actions,s3e=qH.reducer,r3e=["x","y"];function KO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Zu(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?KO(Object(s),!0).forEach(function(r){a3e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):KO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function a3e(t,n,s){return(n=i3e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function i3e(t){var n=l3e(t,"string");return typeof n=="symbol"?n:n+""}function l3e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function o3e(t,n){if(t==null)return{};var s,r,i=c3e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function c3e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function d3e(){var t=yt($k),n=yt(zk),s=Yn(),r=yt(RV),i=yt(Vo),l=pv(),o=mv(),c=yt(d=>d.rootProps.className);y.useEffect(()=>{if(t==null)return Ru;var d=(u,h,m)=>{if(n!==m&&t===u){if(r==="index"){var x;if(o&&h!==null&&h!==void 0&&(x=h.payload)!==null&&x!==void 0&&x.coordinate&&h.payload.sourceViewBox){var b=h.payload.coordinate,{x:w,y:j}=b,S=o3e(b,r3e),{x:C,y:A,width:k,height:T}=h.payload.sourceViewBox,I=Zu(Zu({},S),{},{x:o.x+(k?(w-C)/k:0)*o.width,y:o.y+(T?(j-A)/T:0)*o.height});s(Zu(Zu({},h),{},{payload:Zu(Zu({},h.payload),{},{coordinate:I})}))}else s(h);return}if(i!=null){var D;if(typeof r=="function"){var O={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},R=r(i,O);D=i[R]}else r==="value"&&(D=i.find(H=>String(H.value)===h.payload.label));var{coordinate:P}=h.payload;if(D==null||h.payload.active===!1||P==null||o==null){s(D_({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:L,y:$}=P,B=Math.min(L,o.x+o.width),V=Math.min($,o.y+o.height),K={x:l==="horizontal"?D.coordinate:B,y:l==="horizontal"?V:D.coordinate},z=D_({active:h.payload.active,coordinate:K,dataKey:h.payload.dataKey,index:String(D.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox});s(z)}}};return sx.on(B_,d),()=>{sx.off(B_,d)}},[c,s,n,t,r,i,l,o])}function u3e(){var t=yt($k),n=yt(zk),s=Yn();y.useEffect(()=>{if(t==null)return Ru;var r=(i,l,o)=>{n!==o&&t===i&&s(n3e(l))};return sx.on(qO,r),()=>{sx.off(qO,r)}},[s,n,t])}function f3e(){var t=Yn();y.useEffect(()=>{t(JCe())},[t]),d3e(),u3e()}function h3e(t,n,s,r,i,l){var o=yt(b=>wCe(b,t,n)),c=yt(zk),d=yt($k),u=yt(RV),h=yt(e3e),m=h==null?void 0:h.active,x=mv();y.useEffect(()=>{if(!m&&d!=null&&c!=null){var b=D_({active:l,coordinate:s,dataKey:o,index:i,label:typeof r=="number"?String(r):r,sourceViewBox:x});sx.emit(B_,d,b,c)}},[m,s,o,i,r,c,d,u,l,x])}function YO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function XO(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?YO(Object(s),!0).forEach(function(r){m3e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):YO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function m3e(t,n,s){return(n=p3e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function p3e(t){var n=x3e(t,"string");return typeof n=="symbol"?n:n+""}function x3e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function g3e(t){return t.dataKey}function y3e(t,n){return y.isValidElement(t)?y.cloneElement(t,n):typeof t=="function"?y.createElement(t,n):y.createElement(fwe,n)}var QO=[],b3e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Bu.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function zd(t){var n,s,r=oa(t,b3e),{active:i,allowEscapeViewBox:l,animationDuration:o,animationEasing:c,content:d,filterNull:u,isAnimationActive:h,offset:m,payloadUniqBy:x,position:b,reverseDirection:w,useTranslate3d:j,wrapperStyle:S,cursor:C,shared:A,trigger:k,defaultIndex:T,portal:I,axisId:D}=r,O=Yn(),R=typeof T=="number"?String(T):T;y.useEffect(()=>{O(v_e({shared:A,trigger:k,axisId:D,active:i,defaultIndex:R}))},[O,A,k,D,i,R]);var P=mv(),L=_U(),$=p_e(A),{activeIndex:B,isActive:V}=(n=yt(ce=>SCe(ce,$,k,R)))!==null&&n!==void 0?n:{},K=yt(ce=>jCe(ce,$,k,R)),z=yt(ce=>$H(ce,$,k,R)),H=yt(ce=>NCe(ce,$,k,R)),Y=K,G=KCe(),J=(s=i??V)!==null&&s!==void 0?s:!1,[ee,ye]=gbe([Y,J]),ie=$==="axis"?z:void 0;h3e($,k,H,ie,B,J);var he=I??G;if(he==null||P==null||$==null)return null;var be=Y??QO;J||(be=QO),u&&be.length&&(be=ebe(be.filter(ce=>ce.value!=null&&(ce.hide!==!0||r.includeHidden)),x,g3e));var we=be.length>0,Z=y.createElement(bwe,{allowEscapeViewBox:l,animationDuration:o,animationEasing:c,isAnimationActive:h,active:J,coordinate:H,hasPayload:we,offset:m,position:b,reverseDirection:w,useTranslate3d:j,viewBox:P,wrapperStyle:S,lastBoundingBox:ee,innerRef:ye,hasPortalFromProps:!!I},y3e(d,XO(XO({},r),{},{payload:be,label:ie,active:J,activeIndex:B,coordinate:H,accessibilityLayer:L})));return y.createElement(y.Fragment,null,Zc.createPortal(Z,he),J&&y.createElement(GCe,{cursor:C,tooltipEventType:$,coordinate:H,payload:be,index:B}))}var Al=t=>null;Al.displayName="Cell";function v3e(t,n,s){return(n=w3e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function w3e(t){var n=N3e(t,"string");return typeof n=="symbol"?n:n+""}function N3e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}class j3e{constructor(n){v3e(this,"cache",new Map),this.maxSize=n}get(n){var s=this.cache.get(n);return s!==void 0&&(this.cache.delete(n),this.cache.set(n,s)),s}set(n,s){if(this.cache.has(n))this.cache.delete(n);else if(this.cache.size>=this.maxSize){var r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(n,s)}clear(){this.cache.clear()}size(){return this.cache.size}}function ZO(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function S3e(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?ZO(Object(s),!0).forEach(function(r){_3e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ZO(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function _3e(t,n,s){return(n=C3e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function C3e(t){var n=A3e(t,"string");return typeof n=="symbol"?n:n+""}function A3e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var k3e={cacheSize:2e3,enableCache:!0},GH=S3e({},k3e),JO=new j3e(GH.cacheSize),E3e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},eD="recharts_measurement_span";function T3e(t,n){var s=n.fontSize||"",r=n.fontFamily||"",i=n.fontWeight||"",l=n.fontStyle||"",o=n.letterSpacing||"",c=n.textTransform||"";return"".concat(t,"|").concat(s,"|").concat(r,"|").concat(i,"|").concat(l,"|").concat(o,"|").concat(c)}var tD=(t,n)=>{try{var s=document.getElementById(eD);s||(s=document.createElement("span"),s.setAttribute("id",eD),s.setAttribute("aria-hidden","true"),document.body.appendChild(s)),Object.assign(s.style,E3e,n),s.textContent="".concat(t);var r=s.getBoundingClientRect();return{width:r.width,height:r.height}}catch{return{width:0,height:0}}},sp=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n==null||Bu.isSsr)return{width:0,height:0};if(!GH.enableCache)return tD(n,s);var r=T3e(n,s),i=JO.get(r);if(i)return i;var l=tD(n,s);return JO.set(r,l),l},nD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,sD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,I3e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,P3e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,KH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},M3e=Object.keys(KH),Cf="NaN";function O3e(t,n){return t*KH[n]}class ha{static parse(n){var s,[,r,i]=(s=P3e.exec(n))!==null&&s!==void 0?s:[];return new ha(parseFloat(r),i??"")}constructor(n,s){this.num=n,this.unit=s,this.num=n,this.unit=s,Fl(n)&&(this.unit=""),s!==""&&!I3e.test(s)&&(this.num=NaN,this.unit=""),M3e.includes(s)&&(this.num=O3e(n,s),this.unit="px")}add(n){return this.unit!==n.unit?new ha(NaN,""):new ha(this.num+n.num,this.unit)}subtract(n){return this.unit!==n.unit?new ha(NaN,""):new ha(this.num-n.num,this.unit)}multiply(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new ha(NaN,""):new ha(this.num*n.num,this.unit||n.unit)}divide(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new ha(NaN,""):new ha(this.num/n.num,this.unit||n.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Fl(this.num)}}function YH(t){if(t.includes(Cf))return Cf;for(var n=t;n.includes("*")||n.includes("/");){var s,[,r,i,l]=(s=nD.exec(n))!==null&&s!==void 0?s:[],o=ha.parse(r??""),c=ha.parse(l??""),d=i==="*"?o.multiply(c):o.divide(c);if(d.isNaN())return Cf;n=n.replace(nD,d.toString())}for(;n.includes("+")||/.-\d+(?:\.\d+)?/.test(n);){var u,[,h,m,x]=(u=sD.exec(n))!==null&&u!==void 0?u:[],b=ha.parse(h??""),w=ha.parse(x??""),j=m==="+"?b.add(w):b.subtract(w);if(j.isNaN())return Cf;n=n.replace(sD,j.toString())}return n}var rD=/\(([^()]*)\)/;function D3e(t){for(var n=t,s;(s=rD.exec(n))!=null;){var[,r]=s;n=n.replace(rD,YH(r))}return n}function R3e(t){var n=t.replace(/\s+/g,"");return n=D3e(n),n=YH(n),n}function L3e(t){try{return R3e(t)}catch{return Cf}}function g2(t){var n=L3e(t.slice(5,-1));return n===Cf?"":n}var B3e=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],F3e=["dx","dy","angle","className","breakAll"];function F_(){return F_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},F_.apply(null,arguments)}function aD(t,n){if(t==null)return{};var s,r,i=$3e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function $3e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var XH=/[ \f\n\r\t\v\u2028\u2029]+/,QH=t=>{var{children:n,breakAll:s,style:r}=t;try{var i=[];dr(n)||(s?i=n.toString().split(""):i=n.toString().split(XH));var l=i.map(c=>({word:c,width:sp(c,r).width})),o=s?0:sp("",r).width;return{wordsWithComputedWidth:l,spaceWidth:o}}catch{return null}};function z3e(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var ZH=(t,n,s,r)=>t.reduce((i,l)=>{var{word:o,width:c}=l,d=i[i.length-1];if(d&&c!=null&&(n==null||r||d.width+c+s<Number(n)))d.words.push(o),d.width+=c+s;else{var u={words:[o],width:c};i.push(u)}return i},[]),JH=t=>t.reduce((n,s)=>n.width>s.width?n:s),U3e="",iD=(t,n,s,r,i,l,o,c)=>{var d=t.slice(0,n),u=QH({breakAll:s,style:r,children:d+U3e});if(!u)return[!1,[]];var h=ZH(u.wordsWithComputedWidth,l,o,c),m=h.length>i||JH(h).width>Number(l);return[m,h]},V3e=(t,n,s,r,i)=>{var{maxLines:l,children:o,style:c,breakAll:d}=t,u=Ct(l),h=String(o),m=ZH(n,r,s,i);if(!u||i)return m;var x=m.length>l||JH(m).width>Number(r);if(!x)return m;for(var b=0,w=h.length-1,j=0,S;b<=w&&j<=h.length-1;){var C=Math.floor((b+w)/2),A=C-1,[k,T]=iD(h,A,d,c,l,r,s,i),[I]=iD(h,C,d,c,l,r,s,i);if(!k&&!I&&(b=C+1),k&&I&&(w=C-1),!k&&I){S=T;break}j++}return S||m},lD=t=>{var n=dr(t)?[]:t.toString().split(XH);return[{words:n,width:void 0}]},H3e=t=>{var{width:n,scaleToFit:s,children:r,style:i,breakAll:l,maxLines:o}=t;if((n||s)&&!Bu.isSsr){var c,d,u=QH({breakAll:l,children:r,style:i});if(u){var{wordsWithComputedWidth:h,spaceWidth:m}=u;c=h,d=m}else return lD(r);return V3e({breakAll:l,children:r,maxLines:o,style:i},c,d,n,!!s)}return lD(r)},eW="#808080",W3e={breakAll:!1,capHeight:"0.71em",fill:eW,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Rv=y.forwardRef((t,n)=>{var s=oa(t,W3e),{x:r,y:i,lineHeight:l,capHeight:o,fill:c,scaleToFit:d,textAnchor:u,verticalAnchor:h}=s,m=aD(s,B3e),x=y.useMemo(()=>H3e({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:d,style:m.style,width:m.width}),[m.breakAll,m.children,m.maxLines,d,m.style,m.width]),{dx:b,dy:w,angle:j,className:S,breakAll:C}=m,A=aD(m,F3e);if(!$l(r)||!$l(i)||x.length===0)return null;var k=Number(r)+(Ct(b)?b:0),T=Number(i)+(Ct(w)?w:0);if(!Ns(k)||!Ns(T))return null;var I;switch(h){case"start":I=g2("calc(".concat(o,")"));break;case"middle":I=g2("calc(".concat((x.length-1)/2," * -").concat(l," + (").concat(o," / 2))"));break;default:I=g2("calc(".concat(x.length-1," * -").concat(l,")"));break}var D=[];if(d){var O=x[0].width,{width:R}=m;D.push("scale(".concat(Ct(R)&&Ct(O)?R/O:1,")"))}return j&&D.push("rotate(".concat(j,", ").concat(k,", ").concat(T,")")),D.length&&(A.transform=D.join(" ")),y.createElement("text",F_({},ki(A),{ref:n,x:k,y:T,className:fn("recharts-text",S),textAnchor:u,fill:c.includes("url")?eW:c}),x.map((P,L)=>{var $=P.words.join(C?"":" ");return y.createElement("tspan",{x:k,dy:L===0?I:l,key:"".concat($,"-").concat(L)},$)}))});Rv.displayName="Text";var q3e=["labelRef"];function G3e(t,n){if(t==null)return{};var s,r,i=K3e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function K3e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function oD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function gs(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?oD(Object(s),!0).forEach(function(r){Y3e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):oD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Y3e(t,n,s){return(n=X3e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function X3e(t){var n=Q3e(t,"string");return typeof n=="symbol"?n:n+""}function Q3e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function oo(){return oo=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},oo.apply(null,arguments)}var tW=y.createContext(null),Z3e=t=>{var{x:n,y:s,upperWidth:r,lowerWidth:i,width:l,height:o,children:c}=t,d=y.useMemo(()=>({x:n,y:s,upperWidth:r,lowerWidth:i,width:l,height:o}),[n,s,r,i,l,o]);return y.createElement(tW.Provider,{value:d},c)},nW=()=>{var t=y.useContext(tW),n=mv();return t||wU(n)},J3e=y.createContext(null),eAe=()=>{var t=y.useContext(J3e),n=yt(zV);return t||n},tAe=t=>{var{value:n,formatter:s}=t,r=dr(t.children)?n:t.children;return typeof s=="function"?s(r):r},NE=t=>t!=null&&typeof t=="function",nAe=(t,n)=>{var s=Cr(n-t),r=Math.min(Math.abs(n-t),360);return s*r},sAe=(t,n,s,r,i)=>{var{offset:l,className:o}=t,{cx:c,cy:d,innerRadius:u,outerRadius:h,startAngle:m,endAngle:x,clockWise:b}=i,w=(u+h)/2,j=nAe(m,x),S=j>=0?1:-1,C,A;switch(n){case"insideStart":C=m+S*l,A=b;break;case"insideEnd":C=x-S*l,A=!b;break;case"end":C=x+S*l,A=b;break;default:throw new Error("Unsupported position ".concat(n))}A=j<=0?A:!A;var k=Is(c,d,w,C),T=Is(c,d,w,C+(A?1:-1)*359),I="M".concat(k.x,",").concat(k.y,`
    A`).concat(w,",").concat(w,",0,1,").concat(A?0:1,`,
    `).concat(T.x,",").concat(T.y),D=dr(t.id)?Gp("recharts-radial-line-"):t.id;return y.createElement("text",oo({},r,{dominantBaseline:"central",className:fn("recharts-radial-bar-label",o)}),y.createElement("defs",null,y.createElement("path",{id:D,d:I})),y.createElement("textPath",{xlinkHref:"#".concat(D)},s))},rAe=(t,n,s)=>{var{cx:r,cy:i,innerRadius:l,outerRadius:o,startAngle:c,endAngle:d}=t,u=(c+d)/2;if(s==="outside"){var{x:h,y:m}=Is(r,i,o+n,u);return{x:h,y:m,textAnchor:h>=r?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:r,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:r,y:i,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:r,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(l+o)/2,{x:b,y:w}=Is(r,i,x,u);return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},$_=t=>"cx"in t&&Ct(t.cx),aAe=(t,n)=>{var{parentViewBox:s,offset:r,position:i}=t,l;s!=null&&!$_(s)&&(l=s);var{x:o,y:c,upperWidth:d,lowerWidth:u,height:h}=n,m=o,x=o+(d-u)/2,b=(m+x)/2,w=(d+u)/2,j=m+d/2,S=h>=0?1:-1,C=S*r,A=S>0?"end":"start",k=S>0?"start":"end",T=d>=0?1:-1,I=T*r,D=T>0?"end":"start",O=T>0?"start":"end";if(i==="top"){var R={x:m+d/2,y:c-C,textAnchor:"middle",verticalAnchor:A};return gs(gs({},R),l?{height:Math.max(c-l.y,0),width:d}:{})}if(i==="bottom"){var P={x:x+u/2,y:c+h+C,textAnchor:"middle",verticalAnchor:k};return gs(gs({},P),l?{height:Math.max(l.y+l.height-(c+h),0),width:u}:{})}if(i==="left"){var L={x:b-I,y:c+h/2,textAnchor:D,verticalAnchor:"middle"};return gs(gs({},L),l?{width:Math.max(L.x-l.x,0),height:h}:{})}if(i==="right"){var $={x:b+w+I,y:c+h/2,textAnchor:O,verticalAnchor:"middle"};return gs(gs({},$),l?{width:Math.max(l.x+l.width-$.x,0),height:h}:{})}var B=l?{width:w,height:h}:{};return i==="insideLeft"?gs({x:b+I,y:c+h/2,textAnchor:O,verticalAnchor:"middle"},B):i==="insideRight"?gs({x:b+w-I,y:c+h/2,textAnchor:D,verticalAnchor:"middle"},B):i==="insideTop"?gs({x:m+d/2,y:c+C,textAnchor:"middle",verticalAnchor:k},B):i==="insideBottom"?gs({x:x+u/2,y:c+h-C,textAnchor:"middle",verticalAnchor:A},B):i==="insideTopLeft"?gs({x:m+I,y:c+C,textAnchor:O,verticalAnchor:k},B):i==="insideTopRight"?gs({x:m+d-I,y:c+C,textAnchor:D,verticalAnchor:k},B):i==="insideBottomLeft"?gs({x:x+I,y:c+h-C,textAnchor:O,verticalAnchor:A},B):i==="insideBottomRight"?gs({x:x+u-I,y:c+h-C,textAnchor:D,verticalAnchor:A},B):i&&typeof i=="object"&&(Ct(i.x)||Co(i.x))&&(Ct(i.y)||Co(i.y))?gs({x:o+Vr(i.x,w),y:c+Vr(i.y,h),textAnchor:"end",verticalAnchor:"end"},B):gs({x:j,y:c+h/2,textAnchor:"middle",verticalAnchor:"middle"},B)},iAe={offset:5,zIndex:$r.label};function dc(t){var n=oa(t,iAe),{viewBox:s,position:r,value:i,children:l,content:o,className:c="",textBreakAll:d,labelRef:u}=n,h=eAe(),m=nW(),x=r==="center"?m:h??m,b,w,j;if(s==null?b=x:$_(s)?b=s:b=wU(s),!b||dr(i)&&dr(l)&&!y.isValidElement(o)&&typeof o!="function")return null;var S=gs(gs({},n),{},{viewBox:b});if(y.isValidElement(o)){var{labelRef:C}=S,A=G3e(S,q3e);return y.cloneElement(o,A)}if(typeof o=="function"){if(w=y.createElement(o,S),y.isValidElement(w))return w}else w=tAe(n);var k=ki(n);if($_(b)){if(r==="insideStart"||r==="insideEnd"||r==="end")return sAe(n,r,w,k,b);j=rAe(b,n.offset,n.position)}else j=aAe(n,b);return y.createElement(Gl,{zIndex:n.zIndex},y.createElement(Rv,oo({ref:u,className:fn("recharts-label",c)},k,j,{textAnchor:z3e(k.textAnchor)?k.textAnchor:j.textAnchor,breakAll:d}),w))}dc.displayName="Label";var lAe=(t,n,s)=>{if(!t)return null;var r={viewBox:n,labelRef:s};return t===!0?y.createElement(dc,oo({key:"label-implicit"},r)):$l(t)?y.createElement(dc,oo({key:"label-implicit",value:t},r)):y.isValidElement(t)?t.type===dc?y.cloneElement(t,gs({key:"label-implicit"},r)):y.createElement(dc,oo({key:"label-implicit",content:t},r)):NE(t)?y.createElement(dc,oo({key:"label-implicit",content:t},r)):t&&typeof t=="object"?y.createElement(dc,oo({},t,{key:"label-implicit"},r)):null};function oAe(t){var{label:n,labelRef:s}=t,r=nW();return lAe(n,r,s)||null}var sW={},rW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return s[s.length-1]}t.last=n})(rW);var aW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){return Array.isArray(s)?s:Array.from(s)}t.toArray=n})(aW);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=rW,s=aW,r=nv;function i(l){if(r.isArrayLike(l))return n.last(s.toArray(l))}t.last=i})(sW);var cAe=sW.last;const dAe=Ii(cAe);var uAe=["valueAccessor"],fAe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Iy(){return Iy=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Iy.apply(null,arguments)}function cD(t,n){if(t==null)return{};var s,r,i=hAe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function hAe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var mAe=t=>Array.isArray(t.value)?dAe(t.value):t.value,iW=y.createContext(void 0),pAe=iW.Provider,lW=y.createContext(void 0),xAe=lW.Provider;function gAe(){return y.useContext(iW)}function yAe(){return y.useContext(lW)}function Gg(t){var{valueAccessor:n=mAe}=t,s=cD(t,uAe),{dataKey:r,clockWise:i,id:l,textBreakAll:o,zIndex:c}=s,d=cD(s,fAe),u=gAe(),h=yAe(),m=u||h;return!m||!m.length?null:y.createElement(Gl,{zIndex:c??$r.label},y.createElement(aa,{className:"recharts-label-list"},m.map((x,b)=>{var w,j=dr(r)?n(x,b):ns(x&&x.payload,r),S=dr(l)?{}:{id:"".concat(l,"-").concat(b)};return y.createElement(dc,Iy({key:"label-".concat(b)},ki(x),d,S,{fill:(w=s.fill)!==null&&w!==void 0?w:x.fill,parentViewBox:x.parentViewBox,value:j,textBreakAll:o,viewBox:x.viewBox,index:b,zIndex:0}))})))}Gg.displayName="LabelList";function oW(t){var{label:n}=t;return n?n===!0?y.createElement(Gg,{key:"labelList-implicit"}):y.isValidElement(n)||NE(n)?y.createElement(Gg,{key:"labelList-implicit",content:n}):typeof n=="object"?y.createElement(Gg,Iy({key:"labelList-implicit"},n,{type:String(n.type)})):null:null}var cW=t=>t.graphicalItems.polarItems,bAe=Se([Xn,Fx],Gk),Lv=Se([cW,is,bAe],Yk),vAe=Se([Lv],Xk),Bv=Se([vAe,Dk],Qk),wAe=Se([Bv,is,Lv],Jk);Se([Bv,is,Lv],(t,n,s)=>s.length>0?t.flatMap(r=>s.flatMap(i=>{var l,o=ns(r,(l=n.dataKey)!==null&&l!==void 0?l:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(n==null?void 0:n.dataKey)!=null?t.map(r=>({value:ns(r,n.dataKey),errorDomain:[]})):t.map(r=>({value:r,errorDomain:[]})));var dD=()=>{},NAe=Se([Bv,is,Lv,Pv,Xn],sE),jAe=Se([is,tE,nE,dD,NAe,dD,cn,Xn],rE),dW=Se([is,cn,Bv,wAe,Bx,Xn,jAe],aE),SAe=Se([dW,is,Rh],oE);Se([is,dW,SAe,Xn],dE);var _Ae={radiusAxis:{},angleAxis:{}},uW=ka({name:"polarAxis",initialState:_Ae,reducers:{addRadiusAxis(t,n){t.radiusAxis[n.payload.id]=n.payload},removeRadiusAxis(t,n){delete t.radiusAxis[n.payload.id]},addAngleAxis(t,n){t.angleAxis[n.payload.id]=n.payload},removeAngleAxis(t,n){delete t.angleAxis[n.payload.id]}}}),{addRadiusAxis:VLe,removeRadiusAxis:HLe,addAngleAxis:WLe,removeAngleAxis:qLe}=uW.actions,CAe=uW.reducer;function uD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function fD(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?uD(Object(s),!0).forEach(function(r){AAe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):uD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function AAe(t,n,s){return(n=kAe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function kAe(t){var n=EAe(t,"string");return typeof n=="symbol"?n:n+""}function EAe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var TAe=(t,n)=>n,jE=Se([cW,TAe],(t,n)=>t.filter(s=>s.type==="pie").find(s=>s.id===n)),IAe=[],SE=(t,n,s)=>(s==null?void 0:s.length)===0?IAe:s,fW=Se([Dk,jE,SE],(t,n,s)=>{var{chartData:r}=t;if(n!=null){var i;if((n==null?void 0:n.data)!=null&&n.data.length>0?i=n.data:i=r,(!i||!i.length)&&s!=null&&(i=s.map(l=>fD(fD({},n.presentationProps),l.props))),i!=null)return i}}),PAe=Se([fW,jE,SE],(t,n,s)=>{if(!(t==null||n==null))return t.map((r,i)=>{var l,o=ns(r,n.nameKey,n.name),c;return s!=null&&(l=s[i])!==null&&l!==void 0&&(l=l.props)!==null&&l!==void 0&&l.fill?c=s[i].props.fill:typeof r=="object"&&r!=null&&"fill"in r?c=r.fill:c=n.fill,{value:cv(o,n.dataKey),color:c,payload:r,type:n.legendType}})}),MAe=Se([fW,jE,SE,Zs],(t,n,s,r)=>{if(!(n==null||t==null))return Dke({offset:r,pieSettings:n,displayedData:t,cells:s})}),hW={exports:{}},gn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hr=typeof Symbol=="function"&&Symbol.for,_E=hr?Symbol.for("react.element"):60103,CE=hr?Symbol.for("react.portal"):60106,Fv=hr?Symbol.for("react.fragment"):60107,$v=hr?Symbol.for("react.strict_mode"):60108,zv=hr?Symbol.for("react.profiler"):60114,Uv=hr?Symbol.for("react.provider"):60109,Vv=hr?Symbol.for("react.context"):60110,AE=hr?Symbol.for("react.async_mode"):60111,Hv=hr?Symbol.for("react.concurrent_mode"):60111,Wv=hr?Symbol.for("react.forward_ref"):60112,qv=hr?Symbol.for("react.suspense"):60113,OAe=hr?Symbol.for("react.suspense_list"):60120,Gv=hr?Symbol.for("react.memo"):60115,Kv=hr?Symbol.for("react.lazy"):60116,DAe=hr?Symbol.for("react.block"):60121,RAe=hr?Symbol.for("react.fundamental"):60117,LAe=hr?Symbol.for("react.responder"):60118,BAe=hr?Symbol.for("react.scope"):60119;function ni(t){if(typeof t=="object"&&t!==null){var n=t.$$typeof;switch(n){case _E:switch(t=t.type,t){case AE:case Hv:case Fv:case zv:case $v:case qv:return t;default:switch(t=t&&t.$$typeof,t){case Vv:case Wv:case Kv:case Gv:case Uv:return t;default:return n}}case CE:return n}}}function mW(t){return ni(t)===Hv}gn.AsyncMode=AE;gn.ConcurrentMode=Hv;gn.ContextConsumer=Vv;gn.ContextProvider=Uv;gn.Element=_E;gn.ForwardRef=Wv;gn.Fragment=Fv;gn.Lazy=Kv;gn.Memo=Gv;gn.Portal=CE;gn.Profiler=zv;gn.StrictMode=$v;gn.Suspense=qv;gn.isAsyncMode=function(t){return mW(t)||ni(t)===AE};gn.isConcurrentMode=mW;gn.isContextConsumer=function(t){return ni(t)===Vv};gn.isContextProvider=function(t){return ni(t)===Uv};gn.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===_E};gn.isForwardRef=function(t){return ni(t)===Wv};gn.isFragment=function(t){return ni(t)===Fv};gn.isLazy=function(t){return ni(t)===Kv};gn.isMemo=function(t){return ni(t)===Gv};gn.isPortal=function(t){return ni(t)===CE};gn.isProfiler=function(t){return ni(t)===zv};gn.isStrictMode=function(t){return ni(t)===$v};gn.isSuspense=function(t){return ni(t)===qv};gn.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Fv||t===Hv||t===zv||t===$v||t===qv||t===OAe||typeof t=="object"&&t!==null&&(t.$$typeof===Kv||t.$$typeof===Gv||t.$$typeof===Uv||t.$$typeof===Vv||t.$$typeof===Wv||t.$$typeof===RAe||t.$$typeof===LAe||t.$$typeof===BAe||t.$$typeof===DAe)};gn.typeOf=ni;hW.exports=gn;var FAe=hW.exports,hD=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",mD=null,y2=null,pW=t=>{if(t===mD&&Array.isArray(y2))return y2;var n=[];return y.Children.forEach(t,s=>{dr(s)||(FAe.isFragment(s)?n=n.concat(pW(s.props.children)):n.push(s))}),y2=n,mD=t,n};function kE(t,n){var s=[],r=[];return Array.isArray(n)?r=n.map(i=>hD(i)):r=[hD(n)],pW(t).forEach(i=>{var l=xu(i,"type.displayName")||xu(i,"type.name");l&&r.indexOf(l)!==-1&&s.push(i)}),s}var xW={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function n(s){var i;if(typeof s!="object"||s==null)return!1;if(Object.getPrototypeOf(s)===null)return!0;if(Object.prototype.toString.call(s)!=="[object Object]"){const l=s[Symbol.toStringTag];return l==null||!((i=Object.getOwnPropertyDescriptor(s,Symbol.toStringTag))!=null&&i.writable)?!1:s.toString()===`[object ${l}]`}let r=s;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(s)===r}t.isPlainObject=n})(xW);var $Ae=xW.isPlainObject;const zAe=Ii($Ae);function pD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function xD(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?pD(Object(s),!0).forEach(function(r){UAe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):pD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function UAe(t,n,s){return(n=VAe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function VAe(t){var n=HAe(t,"string");return typeof n=="symbol"?n:n+""}function HAe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Py(){return Py=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Py.apply(null,arguments)}var gD=(t,n,s,r,i)=>{var l=s-r,o;return o="M ".concat(t,",").concat(n),o+="L ".concat(t+s,",").concat(n),o+="L ".concat(t+s-l/2,",").concat(n+i),o+="L ".concat(t+s-l/2-r,",").concat(n+i),o+="L ".concat(t,",").concat(n," Z"),o},WAe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},qAe=t=>{var n=oa(t,WAe),{x:s,y:r,upperWidth:i,lowerWidth:l,height:o,className:c}=n,{animationEasing:d,animationDuration:u,animationBegin:h,isUpdateAnimationActive:m}=n,x=y.useRef(null),[b,w]=y.useState(-1),j=y.useRef(i),S=y.useRef(l),C=y.useRef(o),A=y.useRef(s),k=y.useRef(r),T=yv(t,"trapezoid-");if(y.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var K=x.current.getTotalLength();K&&w(K)}catch{}},[]),s!==+s||r!==+r||i!==+i||l!==+l||o!==+o||i===0&&l===0||o===0)return null;var I=fn("recharts-trapezoid",c);if(!m)return y.createElement("g",null,y.createElement("path",Py({},ki(n),{className:I,d:gD(s,r,i,l,o)})));var D=j.current,O=S.current,R=C.current,P=A.current,L=k.current,$="0px ".concat(b===-1?1:b,"px"),B="".concat(b,"px 0px"),V=CU(["strokeDasharray"],u,d);return y.createElement(gv,{animationId:T,key:T,canBegin:b>0,duration:u,easing:d,isActive:m,begin:h},K=>{var z=Vs(D,i,K),H=Vs(O,l,K),Y=Vs(R,o,K),G=Vs(P,s,K),J=Vs(L,r,K);x.current&&(j.current=z,S.current=H,C.current=Y,A.current=G,k.current=J);var ee=K>0?{transition:V,strokeDasharray:B}:{strokeDasharray:$};return y.createElement("path",Py({},ki(n),{className:I,d:gD(G,J,z,H,Y),ref:x,style:xD(xD({},ee),n.style)}))})},GAe=["option","shapeType","propTransformer","activeClassName","isActive"];function KAe(t,n){if(t==null)return{};var s,r,i=YAe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function YAe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function yD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function My(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?yD(Object(s),!0).forEach(function(r){XAe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):yD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function XAe(t,n,s){return(n=QAe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function QAe(t){var n=ZAe(t,"string");return typeof n=="symbol"?n:n+""}function ZAe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function JAe(t,n){return My(My({},n),t)}function eke(t,n){return t==="symbols"}function bD(t){var{shapeType:n,elementProps:s}=t;switch(n){case"rectangle":return y.createElement(TU,s);case"trapezoid":return y.createElement(qAe,s);case"sector":return y.createElement(OU,s);case"symbols":if(eke(n))return y.createElement(hz,s);break;case"curve":return y.createElement(uk,s);default:return null}}function tke(t){return y.isValidElement(t)?t.props:t}function gW(t){var{option:n,shapeType:s,propTransformer:r=JAe,activeClassName:i="recharts-active-shape",isActive:l}=t,o=KAe(t,GAe),c;if(y.isValidElement(n))c=y.cloneElement(n,My(My({},o),tke(n)));else if(typeof n=="function")c=n(o);else if(zAe(n)&&typeof n!="boolean"){var d=r(n,o);c=y.createElement(bD,{shapeType:s,elementProps:d})}else{var u=o;c=y.createElement(bD,{shapeType:s,elementProps:u})}return l?y.createElement(aa,{className:i},c):c}var EE=(t,n)=>{var s=Yn();return(r,i)=>l=>{t==null||t(r,i,l),s(bH({activeIndex:String(i),activeDataKey:n,activeCoordinate:r.tooltipPosition}))}},TE=t=>{var n=Yn();return(s,r)=>i=>{t==null||t(s,r,i),n(w_e())}},IE=(t,n)=>{var s=Yn();return(r,i)=>l=>{t==null||t(r,i,l),s(N_e({activeIndex:String(i),activeDataKey:n,activeCoordinate:r.tooltipPosition}))}};function yW(t){var{fn:n,args:s}=t,r=Yn(),i=ti();return y.useLayoutEffect(()=>{if(!i){var l=n(s);return r(y_e(l)),()=>{r(b_e(l))}}},[n,s,r,i]),null}function nke(t){var{legendPayload:n}=t,s=Yn(),r=ti();return y.useLayoutEffect(()=>r?Ru:(s(jU(n)),()=>{s(SU(n))}),[s,r,n]),null}function ske(t){var{legendPayload:n}=t,s=Yn(),r=yt(cn);return y.useLayoutEffect(()=>r!=="centric"&&r!=="radial"?Ru:(s(jU(n)),()=>{s(SU(n))}),[s,r,n]),null}var b2,rke=()=>{var[t]=y.useState(()=>Gp("uid-"));return t},ake=(b2=tb.useId)!==null&&b2!==void 0?b2:rke;function bW(t,n){var s=ake();return n||(t?"".concat(t,"-").concat(s):s)}var ike=y.createContext(void 0),vW=t=>{var{id:n,type:s,children:r}=t,i=bW("recharts-".concat(s),n);return y.createElement(ike.Provider,{value:i},r(i))},lke={cartesianItems:[],polarItems:[]},wW=ka({name:"graphicalItems",initialState:lke,reducers:{addCartesianGraphicalItem:{reducer(t,n){t.cartesianItems.push(n.payload)},prepare:qs()},replaceCartesianGraphicalItem:{reducer(t,n){var{prev:s,next:r}=n.payload,i=xo(t).cartesianItems.indexOf(s);i>-1&&(t.cartesianItems[i]=r)},prepare:qs()},removeCartesianGraphicalItem:{reducer(t,n){var s=xo(t).cartesianItems.indexOf(n.payload);s>-1&&t.cartesianItems.splice(s,1)},prepare:qs()},addPolarGraphicalItem:{reducer(t,n){t.polarItems.push(n.payload)},prepare:qs()},removePolarGraphicalItem:{reducer(t,n){var s=xo(t).polarItems.indexOf(n.payload);s>-1&&t.polarItems.splice(s,1)},prepare:qs()}}}),{addCartesianGraphicalItem:oke,replaceCartesianGraphicalItem:cke,removeCartesianGraphicalItem:dke,addPolarGraphicalItem:uke,removePolarGraphicalItem:fke}=wW.actions,hke=wW.reducer;function mke(t){var n=Yn(),s=y.useRef(null);return y.useLayoutEffect(()=>{s.current===null?n(oke(t)):s.current!==t&&n(cke({prev:s.current,next:t})),s.current=t},[n,t]),y.useLayoutEffect(()=>()=>{s.current&&(n(dke(s.current)),s.current=null)},[n]),null}function pke(t){var n=Yn();return y.useLayoutEffect(()=>(n(uke(t)),()=>{n(fke(t))}),[n,t]),null}var xke=["onMouseEnter","onClick","onMouseLeave"],gke=["id"],yke=["id"];function PE(t,n){if(t==null)return{};var s,r,i=bke(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function bke(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function vD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Hn(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?vD(Object(s),!0).forEach(function(r){vke(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):vD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function vke(t,n,s){return(n=wke(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function wke(t){var n=Nke(t,"string");return typeof n=="symbol"?n:n+""}function Nke(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Wc(){return Wc=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Wc.apply(null,arguments)}function jke(t){var n=y.useMemo(()=>kE(t.children,Al),[t.children]),s=yt(r=>PAe(r,t.id,n));return s==null?null:y.createElement(ske,{legendPayload:s})}function Ske(t){var{dataKey:n,nameKey:s,sectors:r,stroke:i,strokeWidth:l,fill:o,name:c,hide:d,tooltipType:u}=t;return{dataDefinedOnItem:r.map(h=>h.tooltipPayload),positions:r.map(h=>h.tooltipPosition),settings:{stroke:i,strokeWidth:l,fill:o,dataKey:n,nameKey:s,name:cv(c,n),hide:d,type:u,color:o,unit:""}}}var _ke=(t,n)=>t>n?"start":t<n?"end":"middle",Cke=(t,n,s)=>Vr(typeof n=="function"?n(t):n,s,s*.8),Ake=(t,n,s)=>{var{top:r,left:i,width:l,height:o}=n,c=IU(l,o),d=i+Vr(t.cx,l,l/2),u=r+Vr(t.cy,o,o/2),h=Vr(t.innerRadius,c,0),m=Cke(s,t.outerRadius,c),x=t.maxRadius||Math.sqrt(l*l+o*o)/2;return{cx:d,cy:u,innerRadius:h,outerRadius:m,maxRadius:x}},kke=(t,n)=>{var s=Cr(n-t),r=Math.min(Math.abs(n-t),360);return s*r};function Eke(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var Tke=(t,n)=>{if(y.isValidElement(t))return y.cloneElement(t,n);if(typeof t=="function")return t(n);var s=fn("recharts-pie-label-line",typeof t!="boolean"?t.className:"");return y.createElement(uk,Wc({},n,{type:"linear",className:s}))},Ike=(t,n,s)=>{if(y.isValidElement(t))return y.cloneElement(t,n);var r=s;if(typeof t=="function"&&(r=t(n),y.isValidElement(r)))return r;var i=fn("recharts-pie-label-text",Eke(t));return y.createElement(Rv,Wc({},n,{alignmentBaseline:"middle",className:i}),r)};function Pke(t){var{sectors:n,props:s,showLabels:r}=t,{label:i,labelLine:l,dataKey:o}=s;if(!r||!i||!n)return null;var c=Bl(s),d=qp(i),u=qp(l),h=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,m=n.map((x,b)=>{var w=(x.startAngle+x.endAngle)/2,j=Is(x.cx,x.cy,x.outerRadius+h,w),S=Hn(Hn(Hn(Hn({},c),x),{},{stroke:"none"},d),{},{index:b,textAnchor:_ke(j.x,x.cx)},j),C=Hn(Hn(Hn(Hn({},c),x),{},{fill:"none",stroke:x.fill},u),{},{index:b,points:[Is(x.cx,x.cy,x.outerRadius,w),j],key:"line"});return y.createElement(Gl,{zIndex:$r.label,key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(b)},y.createElement(aa,null,l&&Tke(l,C),Ike(i,S,ns(x,o))))});return y.createElement(aa,{className:"recharts-pie-labels"},m)}function Mke(t){var{sectors:n,props:s,showLabels:r}=t,{label:i}=s;return typeof i=="object"&&i!=null&&"position"in i?y.createElement(oW,{label:i}):y.createElement(Pke,{sectors:n,props:s,showLabels:r})}function Oke(t){var{sectors:n,activeShape:s,inactiveShape:r,allOtherPieProps:i}=t,l=yt(wu),{onMouseEnter:o,onClick:c,onMouseLeave:d}=i,u=PE(i,xke),h=EE(o,i.dataKey),m=TE(d),x=IE(c,i.dataKey);return n==null||n.length===0?null:y.createElement(y.Fragment,null,n.map((b,w)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&n.length!==1)return null;var j=s&&String(w)===l,S=l?r:null,C=j?s:S,A=Hn(Hn({},b),{},{stroke:b.stroke,tabIndex:-1,[hU]:w,[mU]:i.dataKey});return y.createElement(aa,Wc({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},tv(u,b,w),{onMouseEnter:h(b,w),onMouseLeave:m(b,w),onClick:x(b,w)}),y.createElement(gW,Wc({option:C,isActive:j,shapeType:"sector"},A)))}))}function Dke(t){var n,{pieSettings:s,displayedData:r,cells:i,offset:l}=t,{cornerRadius:o,startAngle:c,endAngle:d,dataKey:u,nameKey:h,tooltipType:m}=s,x=Math.abs(s.minAngle),b=kke(c,d),w=Math.abs(b),j=r.length<=1?0:(n=s.paddingAngle)!==null&&n!==void 0?n:0,S=r.filter(D=>ns(D,u,0)!==0).length,C=(w>=360?S:S-1)*j,A=w-S*x-C,k=r.reduce((D,O)=>{var R=ns(O,u,0);return D+(Ct(R)?R:0)},0),T;if(k>0){var I;T=r.map((D,O)=>{var R=ns(D,u,0),P=ns(D,h,O),L=Ake(s,l,D),$=(Ct(R)?R:0)/k,B,V=Hn(Hn({},D),i&&i[O]&&i[O].props);O?B=I.endAngle+Cr(b)*j*(R!==0?1:0):B=c;var K=B+Cr(b)*((R!==0?x:0)+$*A),z=(B+K)/2,H=(L.innerRadius+L.outerRadius)/2,Y=[{name:P,value:R,payload:V,dataKey:u,type:m}],G=Is(L.cx,L.cy,H,z);return I=Hn(Hn(Hn(Hn({},s.presentationProps),{},{percent:$,cornerRadius:typeof o=="string"?parseFloat(o):o,name:P,tooltipPayload:Y,midAngle:z,middleRadius:H,tooltipPosition:G},V),L),{},{value:R,startAngle:B,endAngle:K,payload:V,paddingAngle:Cr(b)*j}),I})}return T}function Rke(t){var{showLabels:n,sectors:s,children:r}=t,i=y.useMemo(()=>!n||!s?[]:s.map(l=>({value:l.value,payload:l.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:l.cx,cy:l.cy,innerRadius:l.innerRadius,outerRadius:l.outerRadius,startAngle:l.startAngle,endAngle:l.endAngle,clockWise:!1},fill:l.fill})),[s,n]);return y.createElement(xAe,{value:n?i:void 0},r)}function Lke(t){var{props:n,previousSectorsRef:s}=t,{sectors:r,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:h,onAnimationEnd:m}=n,x=yv(n,"recharts-pie-"),b=s.current,[w,j]=y.useState(!1),S=y.useCallback(()=>{typeof m=="function"&&m(),j(!1)},[m]),C=y.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return y.createElement(Rke,{showLabels:!w,sectors:r},y.createElement(gv,{animationId:x,begin:l,duration:o,isActive:i,easing:c,onAnimationStart:C,onAnimationEnd:S,key:x},A=>{var k=[],T=r&&r[0],I=T==null?void 0:T.startAngle;return r==null||r.forEach((D,O)=>{var R=b&&b[O],P=O>0?xu(D,"paddingAngle",0):0;if(R){var L=Vs(R.endAngle-R.startAngle,D.endAngle-D.startAngle,A),$=Hn(Hn({},D),{},{startAngle:I+P,endAngle:I+L+P});k.push($),I=$.endAngle}else{var{endAngle:B,startAngle:V}=D,K=Vs(0,B-V,A),z=Hn(Hn({},D),{},{startAngle:I+P,endAngle:I+K+P});k.push(z),I=z.endAngle}}),s.current=k,y.createElement(aa,null,y.createElement(Oke,{sectors:k,activeShape:d,inactiveShape:u,allOtherPieProps:n}))}),y.createElement(Mke,{showLabels:!w,sectors:r,props:n}),n.children)}var Bke={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Bu.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:$r.area};function Fke(t){var{id:n}=t,s=PE(t,gke),{hide:r,className:i,rootTabIndex:l}=t,o=y.useMemo(()=>kE(t.children,Al),[t.children]),c=yt(h=>MAe(h,n,o)),d=y.useRef(null),u=fn("recharts-pie",i);return r||c==null?(d.current=null,y.createElement(aa,{tabIndex:l,className:u})):y.createElement(Gl,{zIndex:t.zIndex},y.createElement(yW,{fn:Ske,args:Hn(Hn({},t),{},{sectors:c})}),y.createElement(aa,{tabIndex:l,className:u},y.createElement(Lke,{props:Hn(Hn({},s),{},{sectors:c}),previousSectorsRef:d})))}function Oy(t){var n=oa(t,Bke),{id:s}=n,r=PE(n,yke),i=Bl(r);return y.createElement(vW,{id:s,type:"pie"},l=>y.createElement(y.Fragment,null,y.createElement(pke,{type:"pie",id:l,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:i,maxRadius:n.maxRadius}),y.createElement(jke,Wc({},r,{id:l})),y.createElement(Fke,Wc({},r,{id:l}))))}Oy.displayName="Pie";function wD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function ND(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?wD(Object(s),!0).forEach(function(r){$ke(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):wD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function $ke(t,n,s){return(n=zke(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function zke(t){var n=Uke(t,"string");return typeof n=="symbol"?n:n+""}function Uke(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Vke={xAxis:{},yAxis:{},zAxis:{}},NW=ka({name:"cartesianAxis",initialState:Vke,reducers:{addXAxis:{reducer(t,n){t.xAxis[n.payload.id]=n.payload},prepare:qs()},removeXAxis:{reducer(t,n){delete t.xAxis[n.payload.id]},prepare:qs()},addYAxis:{reducer(t,n){t.yAxis[n.payload.id]=n.payload},prepare:qs()},removeYAxis:{reducer(t,n){delete t.yAxis[n.payload.id]},prepare:qs()},addZAxis:{reducer(t,n){t.zAxis[n.payload.id]=n.payload},prepare:qs()},removeZAxis:{reducer(t,n){delete t.zAxis[n.payload.id]},prepare:qs()},updateYAxisWidth(t,n){var{id:s,width:r}=n.payload,i=t.yAxis[s];if(i){var l=i.widthHistory||[];if(l.length===3&&l[0]===l[2]&&r===l[1]&&r!==i.width&&Math.abs(r-l[0])<=1)return;var o=[...l,r].slice(-3);t.yAxis[s]=ND(ND({},t.yAxis[s]),{},{width:r,widthHistory:o})}}}}),{addXAxis:Hke,removeXAxis:Wke,addYAxis:qke,removeYAxis:Gke,addZAxis:GLe,removeZAxis:KLe,updateYAxisWidth:Kke}=NW.actions,Yke=NW.reducer,Xke=Se([Zs],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),Qke=Se([Xke,Bo,Fo],(t,n,s)=>{if(!(!t||n==null||s==null))return{x:t.left,y:t.top,width:Math.max(0,n-t.left-t.right),height:Math.max(0,s-t.top-t.bottom)}}),jW=()=>yt(Qke),Zke="Invariant failed";function Jke(t,n){throw new Error(Zke)}var eEe=["x","y"];function z_(){return z_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},z_.apply(null,arguments)}function jD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function jm(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?jD(Object(s),!0).forEach(function(r){tEe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):jD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function tEe(t,n,s){return(n=nEe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function nEe(t){var n=sEe(t,"string");return typeof n=="symbol"?n:n+""}function sEe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function rEe(t,n){if(t==null)return{};var s,r,i=aEe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function aEe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function iEe(t,n){var{x:s,y:r}=t,i=rEe(t,eEe),l="".concat(s),o=parseInt(l,10),c="".concat(r),d=parseInt(c,10),u="".concat(n.height||i.height),h=parseInt(u,10),m="".concat(n.width||i.width),x=parseInt(m,10);return jm(jm(jm(jm(jm({},n),i),o?{x:o}:{}),d?{y:d}:{}),{},{height:h,width:x,name:n.name,radius:n.radius})}function Dy(t){return y.createElement(gW,z_({shapeType:"rectangle",propTransformer:iEe,activeClassName:"recharts-active-bar"},t))}var lEe=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,i)=>{if(Ct(n))return n;var l=Ct(r)||dr(r);return l?n(r,i):(l||Jke(),s)}},oEe={},SW=ka({name:"errorBars",initialState:oEe,reducers:{addErrorBar:(t,n)=>{var{itemId:s,errorBar:r}=n.payload;t[s]||(t[s]=[]),t[s].push(r)},replaceErrorBar:(t,n)=>{var{itemId:s,prev:r,next:i}=n.payload;t[s]&&(t[s]=t[s].map(l=>l.dataKey===r.dataKey&&l.direction===r.direction?i:l))},removeErrorBar:(t,n)=>{var{itemId:s,errorBar:r}=n.payload;t[s]&&(t[s]=t[s].filter(i=>i.dataKey!==r.dataKey||i.direction!==r.direction))}}}),{addErrorBar:YLe,replaceErrorBar:XLe,removeErrorBar:QLe}=SW.actions,cEe=SW.reducer,dEe=["children"];function uEe(t,n){if(t==null)return{};var s,r,i=fEe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function fEe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var hEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},mEe=y.createContext(hEe);function pEe(t){var{children:n}=t,s=uEe(t,dEe);return y.createElement(mEe.Provider,{value:s},n)}function _W(t,n){var s,r,i=yt(u=>zo(u,t)),l=yt(u=>Uo(u,n)),o=(s=i==null?void 0:i.allowDataOverflow)!==null&&s!==void 0?s:Ia.allowDataOverflow,c=(r=l==null?void 0:l.allowDataOverflow)!==null&&r!==void 0?r:Pa.allowDataOverflow,d=o||c;return{needClip:d,needClipX:o,needClipY:c}}function xEe(t){var{xAxisId:n,yAxisId:s,clipPathId:r}=t,i=jW(),{needClipX:l,needClipY:o,needClip:c}=_W(n,s);if(!c||!i)return null;var{x:d,y:u,width:h,height:m}=i;return y.createElement("clipPath",{id:"clipPath-".concat(r)},y.createElement("rect",{x:l?d:d-h/2,y:o?u:u-m/2,width:l?h:h*2,height:o?m:m*2}))}function gEe(t,n){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&Ns(t.zIndex)?t.zIndex:n}var yEe=["onMouseEnter","onMouseLeave","onClick"],bEe=["value","background","tooltipPosition"],vEe=["id"],wEe=["onMouseEnter","onClick","onMouseLeave"];function Po(){return Po=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Po.apply(null,arguments)}function SD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Zr(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?SD(Object(s),!0).forEach(function(r){NEe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):SD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function NEe(t,n,s){return(n=jEe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function jEe(t){var n=SEe(t,"string");return typeof n=="symbol"?n:n+""}function SEe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Ry(t,n){if(t==null)return{};var s,r,i=_Ee(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function _Ee(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var CEe=t=>{var{dataKey:n,name:s,fill:r,legendType:i,hide:l}=t;return[{inactive:l,dataKey:n,type:i,color:r,value:cv(s,n),payload:t}]};function AEe(t){var{dataKey:n,stroke:s,strokeWidth:r,fill:i,name:l,hide:o,unit:c}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:s,strokeWidth:r,fill:i,dataKey:n,nameKey:void 0,name:cv(l,n),hide:o,type:t.tooltipType,color:t.fill,unit:c}}}function kEe(t){var n=yt(wu),{data:s,dataKey:r,background:i,allOtherBarProps:l}=t,{onMouseEnter:o,onMouseLeave:c,onClick:d}=l,u=Ry(l,yEe),h=EE(o,r),m=TE(c),x=IE(d,r);if(!i||s==null)return null;var b=qp(i);return y.createElement(Gl,{zIndex:gEe(i,$r.barBackground)},s.map((w,j)=>{var{value:S,background:C,tooltipPosition:A}=w,k=Ry(w,bEe);if(!C)return null;var T=h(w,j),I=m(w,j),D=x(w,j),O=Zr(Zr(Zr(Zr(Zr({option:i,isActive:String(j)===n},k),{},{fill:"#eee"},C),b),tv(u,w,j)),{},{onMouseEnter:T,onMouseLeave:I,onClick:D,dataKey:r,index:j,className:"recharts-bar-background-rectangle"});return y.createElement(Dy,Po({key:"background-bar-".concat(j)},O))}))}function EEe(t){var{showLabels:n,children:s,rects:r}=t,i=r==null?void 0:r.map(l=>{var o={x:l.x,y:l.y,width:l.width,lowerWidth:l.width,upperWidth:l.width,height:l.height};return Zr(Zr({},o),{},{value:l.value,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:o,fill:l.fill})});return y.createElement(pAe,{value:n?i:void 0},s)}function TEe(t){var{shape:n,activeBar:s,baseProps:r,entry:i,index:l,dataKey:o}=t,c=yt(wu),d=yt(OH),u=s&&String(l)===c&&(d==null||o===d),h=u?s:n;return u?y.createElement(Gl,{zIndex:$r.activeBar},y.createElement(Dy,Po({},r,{name:String(r.name)},i,{isActive:u,option:h,index:l,dataKey:o}))):y.createElement(Dy,Po({},r,{name:String(r.name)},i,{isActive:u,option:h,index:l,dataKey:o}))}function IEe(t){var{shape:n,baseProps:s,entry:r,index:i,dataKey:l}=t;return y.createElement(Dy,Po({},s,{name:String(s.name)},r,{isActive:!1,option:n,index:i,dataKey:l}))}function PEe(t){var n,{data:s,props:r}=t,i=(n=Bl(r))!==null&&n!==void 0?n:{},{id:l}=i,o=Ry(i,vEe),{shape:c,dataKey:d,activeBar:u}=r,{onMouseEnter:h,onClick:m,onMouseLeave:x}=r,b=Ry(r,wEe),w=EE(h,d),j=TE(x),S=IE(m,d);return s?y.createElement(y.Fragment,null,s.map((C,A)=>y.createElement(aa,Po({key:"rectangle-".concat(C==null?void 0:C.x,"-").concat(C==null?void 0:C.y,"-").concat(C==null?void 0:C.value,"-").concat(A),className:"recharts-bar-rectangle"},tv(b,C,A),{onMouseEnter:w(C,A),onMouseLeave:j(C,A),onClick:S(C,A)}),u?y.createElement(TEe,{shape:c,activeBar:u,baseProps:o,entry:C,index:A,dataKey:d}):y.createElement(IEe,{shape:c,baseProps:o,entry:C,index:A,dataKey:d})))):null}function MEe(t){var{props:n,previousRectanglesRef:s}=t,{data:r,layout:i,isAnimationActive:l,animationBegin:o,animationDuration:c,animationEasing:d,onAnimationEnd:u,onAnimationStart:h}=n,m=s.current,x=yv(n,"recharts-bar-"),[b,w]=y.useState(!1),j=!b,S=y.useCallback(()=>{typeof u=="function"&&u(),w(!1)},[u]),C=y.useCallback(()=>{typeof h=="function"&&h(),w(!0)},[h]);return y.createElement(EEe,{showLabels:j,rects:r},y.createElement(gv,{animationId:x,begin:o,duration:c,isActive:l,easing:d,onAnimationEnd:S,onAnimationStart:C,key:x},A=>{var k=A===1?r:r==null?void 0:r.map((T,I)=>{var D=m&&m[I];if(D)return Zr(Zr({},T),{},{x:Vs(D.x,T.x,A),y:Vs(D.y,T.y,A),width:Vs(D.width,T.width,A),height:Vs(D.height,T.height,A)});if(i==="horizontal"){var O=Vs(0,T.height,A),R=Vs(T.stackedBarStart,T.y,A);return Zr(Zr({},T),{},{y:R,height:O})}var P=Vs(0,T.width,A),L=Vs(T.stackedBarStart,T.x,A);return Zr(Zr({},T),{},{width:P,x:L})});return A>0&&(s.current=k??null),k==null?null:y.createElement(aa,null,y.createElement(PEe,{props:n,data:k}))}),y.createElement(oW,{label:n.label}),n.children)}function OEe(t){var n=y.useRef(null);return y.createElement(MEe,{previousRectanglesRef:n,props:t})}var CW=0,DEe=(t,n)=>{var s=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:s,errorVal:ns(t,n)}};class REe extends y.PureComponent{render(){var{hide:n,data:s,dataKey:r,className:i,xAxisId:l,yAxisId:o,needClip:c,background:d,id:u}=this.props;if(n||s==null)return null;var h=fn("recharts-bar",i),m=u;return y.createElement(aa,{className:h,id:u},c&&y.createElement("defs",null,y.createElement(xEe,{clipPathId:m,xAxisId:l,yAxisId:o})),y.createElement(aa,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},y.createElement(kEe,{data:s,dataKey:r,background:d,allOtherBarProps:this.props}),y.createElement(OEe,this.props)))}}var LEe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Bu.isSsr,legendType:"rect",minPointSize:CW,xAxisId:0,yAxisId:0,zIndex:$r.bar};function BEe(t){var{xAxisId:n,yAxisId:s,hide:r,legendType:i,minPointSize:l,activeBar:o,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h}=t,{needClip:m}=_W(n,s),x=pv(),b=ti(),w=kE(t.children,Al),j=yt(A=>f5e(A,n,s,b,t.id,w));if(x!=="vertical"&&x!=="horizontal")return null;var S,C=j==null?void 0:j[0];return C==null||C.height==null||C.width==null?S=0:S=x==="vertical"?C.height/2:C.width/2,y.createElement(pEe,{xAxisId:n,yAxisId:s,data:j,dataPointFormatter:DEe,errorBarOffset:S},y.createElement(REe,Po({},t,{layout:x,needClip:m,data:j,xAxisId:n,yAxisId:s,hide:r,legendType:i,minPointSize:l,activeBar:o,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:h})))}function FEe(t){var{layout:n,barSettings:{dataKey:s,minPointSize:r},pos:i,bandSize:l,xAxis:o,yAxis:c,xAxisTicks:d,yAxisTicks:u,stackedData:h,displayedData:m,offset:x,cells:b,parentViewBox:w,dataStartIndex:j}=t,S=n==="horizontal"?c:o,C=h?S.scale.domain():null,A=_ve({numericAxis:S}),k=S.scale(A);return m.map((T,I)=>{var D,O,R,P,L,$;h?D=bve(h[I+j],C):(D=ns(T,s),Array.isArray(D)||(D=[A,D]));var B=lEe(r,CW)(D[1],I);if(n==="horizontal"){var V,[K,z]=[c.scale(D[0]),c.scale(D[1])];O=yM({axis:o,ticks:d,bandSize:l,offset:i.offset,entry:T,index:I}),R=(V=z??K)!==null&&V!==void 0?V:void 0,P=i.size;var H=K-z;if(L=Fl(H)?0:H,$={x:O,y:x.top,width:P,height:x.height},Math.abs(B)>0&&Math.abs(L)<Math.abs(B)){var Y=Cr(L||B)*(Math.abs(B)-Math.abs(L));R-=Y,L+=Y}}else{var[G,J]=[o.scale(D[0]),o.scale(D[1])];if(O=G,R=yM({axis:c,ticks:u,bandSize:l,offset:i.offset,entry:T,index:I}),P=J-G,L=i.size,$={x:x.left,y:R,width:x.width,height:L},Math.abs(B)>0&&Math.abs(P)<Math.abs(B)){var ee=Cr(P||B)*(Math.abs(B)-Math.abs(P));P+=ee}}if(O==null||R==null||P==null||L==null)return null;var ye=Zr(Zr({},T),{},{stackedBarStart:k,x:O,y:R,width:P,height:L,value:h?D:D[1],payload:T,background:$,tooltipPosition:{x:O+P/2,y:R+L/2},parentViewBox:w},b&&b[I]&&b[I].props);return ye}).filter(Boolean)}function $Ee(t){var n=oa(t,LEe),s=ti();return y.createElement(vW,{id:n.id,type:"bar"},r=>y.createElement(y.Fragment,null,y.createElement(nke,{legendPayload:CEe(n)}),y.createElement(yW,{fn:AEe,args:n}),y.createElement(mke,{type:"bar",id:r,data:void 0,xAxisId:n.xAxisId,yAxisId:n.yAxisId,zAxisId:0,dataKey:n.dataKey,stackId:Sve(n.stackId),hide:n.hide,barSize:n.barSize,minPointSize:n.minPointSize,maxBarSize:n.maxBarSize,isPanorama:s}),y.createElement(Gl,{zIndex:n.zIndex},y.createElement(BEe,Po({},n,{id:r})))))}var rx=y.memo($Ee);rx.displayName="Bar";function _D(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function ag(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?_D(Object(s),!0).forEach(function(r){zEe(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_D(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function zEe(t,n,s){return(n=UEe(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function UEe(t){var n=VEe(t,"string");return typeof n=="symbol"?n:n+""}function VEe(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var HEe=(t,n)=>n,WEe=(t,n,s)=>s,qEe=(t,n,s,r)=>r,GEe=(t,n,s,r,i)=>i,Wx=Se([Kk,GEe],(t,n)=>t.filter(s=>s.type==="bar").find(s=>s.id===n)),KEe=Se([Wx],t=>t==null?void 0:t.maxBarSize),YEe=(t,n,s,r,i,l)=>l,CD=(t,n,s)=>{var r=s??t;if(!dr(r))return Vr(r,n,0)},XEe=Se([cn,Kk,HEe,WEe,qEe],(t,n,s,r,i)=>n.filter(l=>t==="horizontal"?l.xAxisId===s:l.yAxisId===r).filter(l=>l.isPanorama===i).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),QEe=(t,n,s,r)=>{var i=cn(t);return i==="horizontal"?O_(t,"yAxis",s,r):O_(t,"xAxis",n,r)},ZEe=(t,n,s)=>{var r=cn(t);return r==="horizontal"?RO(t,"xAxis",n):RO(t,"yAxis",s)},JEe=(t,n,s)=>{var r={},i=t.filter(kv),l=t.filter(u=>u.stackId==null),o=i.reduce((u,h)=>(u[h.stackId]||(u[h.stackId]=[]),u[h.stackId].push(h),u),r),c=Object.entries(o).map(u=>{var[h,m]=u,x=m.map(w=>w.dataKey),b=CD(n,s,m[0].barSize);return{stackId:h,dataKeys:x,barSize:b}}),d=l.map(u=>{var h=[u.dataKey].filter(x=>x!=null),m=CD(n,s,u.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...c,...d]},e5e=Se([XEe,uSe,ZEe],JEe),t5e=(t,n,s,r,i)=>{var l,o,c=Wx(t,n,s,r,i);if(c!=null){var d=cn(t),u=OV(t),{maxBarSize:h}=c,m=dr(h)?u:h,x,b;return d==="horizontal"?(x=dh(t,"xAxis",n,r),b=ch(t,"xAxis",n,r)):(x=dh(t,"yAxis",s,r),b=ch(t,"yAxis",s,r)),(l=(o=fy(x,b,!0))!==null&&o!==void 0?o:m)!==null&&l!==void 0?l:0}},AW=(t,n,s,r)=>{var i=cn(t),l,o;return i==="horizontal"?(l=dh(t,"xAxis",n,r),o=ch(t,"xAxis",n,r)):(l=dh(t,"yAxis",s,r),o=ch(t,"yAxis",s,r)),fy(l,o)};function n5e(t,n,s,r,i){var l=r.length;if(!(l<1)){var o=Vr(t,s,0,!0),c,d=[];if(Ns(r[0].barSize)){var u=!1,h=s/l,m=r.reduce((C,A)=>C+(A.barSize||0),0);m+=(l-1)*o,m>=s&&(m-=(l-1)*o,o=0),m>=s&&h>0&&(u=!0,h*=.9,m=l*h);var x=(s-m)/2>>0,b={offset:x-o,size:0};c=r.reduce((C,A)=>{var k,T={stackId:A.stackId,dataKeys:A.dataKeys,position:{offset:b.offset+b.size+o,size:u?h:(k=A.barSize)!==null&&k!==void 0?k:0}},I=[...C,T];return b=I[I.length-1].position,I},d)}else{var w=Vr(n,s,0,!0);s-2*w-(l-1)*o<=0&&(o=0);var j=(s-2*w-(l-1)*o)/l;j>1&&(j>>=0);var S=Ns(i)?Math.min(j,i):j;c=r.reduce((C,A,k)=>[...C,{stackId:A.stackId,dataKeys:A.dataKeys,position:{offset:w+(j+o)*k+(j-S)/2,size:S}}],d)}return c}}var s5e=(t,n,s,r,i,l,o)=>{var c=dr(o)?n:o,d=n5e(s,r,i!==l?i:l,t,c);return i!==l&&d!=null&&(d=d.map(u=>ag(ag({},u),{},{position:ag(ag({},u.position),{},{offset:u.position.offset-i/2})}))),d},r5e=Se([e5e,OV,dSe,DV,t5e,AW,KEe],s5e),a5e=(t,n,s,r)=>dh(t,"xAxis",n,r),i5e=(t,n,s,r)=>dh(t,"yAxis",s,r),l5e=(t,n,s,r)=>ch(t,"xAxis",n,r),o5e=(t,n,s,r)=>ch(t,"yAxis",s,r),c5e=Se([r5e,Wx],(t,n)=>{if(!(t==null||n==null)){var s=t.find(r=>r.stackId===n.stackId&&n.dataKey!=null&&r.dataKeys.includes(n.dataKey));if(s!=null)return s.position}}),d5e=(t,n)=>{var s=Wk(n);if(!(!t||s==null||n==null)){var{stackId:r}=n;if(r!=null){var i=t[r];if(i){var{stackedData:l}=i;if(l)return l.find(o=>o.key===s)}}}},u5e=Se([QEe,Wx],d5e),f5e=Se([Zs,ck,a5e,i5e,l5e,o5e,c5e,cn,Rk,AW,u5e,Wx,YEe],(t,n,s,r,i,l,o,c,d,u,h,m,x)=>{var{chartData:b,dataStartIndex:w,dataEndIndex:j}=d;if(!(m==null||o==null||n==null||c!=="horizontal"&&c!=="vertical"||s==null||r==null||i==null||l==null||u==null)){var{data:S}=m,C;if(S!=null&&S.length>0?C=S:C=b==null?void 0:b.slice(w,j+1),C!=null)return FEe({layout:c,barSettings:m,pos:o,parentViewBox:n,bandSize:u,xAxis:s,yAxis:r,xAxisTicks:i,yAxisTicks:l,stackedData:h,displayedData:C,offset:t,cells:x,dataStartIndex:w})}}),kW=t=>{var{chartData:n}=t,s=Yn(),r=ti();return y.useEffect(()=>r?()=>{}:(s(GO(n)),()=>{s(GO(void 0))}),[n,s,r]),null},AD={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},EW=ka({name:"brush",initialState:AD,reducers:{setBrushSettings(t,n){return n.payload==null?AD:n.payload}}}),{setBrushSettings:ZLe}=EW.actions,h5e=EW.reducer;function m5e(t,n,s){return(n=p5e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function p5e(t){var n=x5e(t,"string");return typeof n=="symbol"?n:n+""}function x5e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}class ME{static create(n){return new ME(n)}constructor(n){this.scale=n}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(n){var{bandAware:s,position:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n!==void 0){if(r)switch(r){case"start":return this.scale(n);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(n)+l}default:return this.scale(n)}if(s){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+o}return this.scale(n)}}isInRange(n){var s=this.range(),r=s[0],i=s[s.length-1];return r<=i?n>=r&&n<=i:n>=i&&n<=r}}m5e(ME,"EPS",1e-4);function g5e(t){return(t%180+180)%180}var y5e=function(n){var{width:s,height:r}=n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=g5e(i),o=l*Math.PI/180,c=Math.atan(r/s),d=o>c&&o<Math.PI-c?r/Math.sin(o):s/Math.cos(o);return Math.abs(d)},b5e={dots:[],areas:[],lines:[]},TW=ka({name:"referenceElements",initialState:b5e,reducers:{addDot:(t,n)=>{t.dots.push(n.payload)},removeDot:(t,n)=>{var s=xo(t).dots.findIndex(r=>r===n.payload);s!==-1&&t.dots.splice(s,1)},addArea:(t,n)=>{t.areas.push(n.payload)},removeArea:(t,n)=>{var s=xo(t).areas.findIndex(r=>r===n.payload);s!==-1&&t.areas.splice(s,1)},addLine:(t,n)=>{t.lines.push(n.payload)},removeLine:(t,n)=>{var s=xo(t).lines.findIndex(r=>r===n.payload);s!==-1&&t.lines.splice(s,1)}}}),{addDot:JLe,removeDot:e7e,addArea:t7e,removeArea:n7e,addLine:s7e,removeLine:r7e}=TW.actions,v5e=TW.reducer,w5e=y.createContext(void 0),N5e=t=>{var{children:n}=t,[s]=y.useState("".concat(Gp("recharts"),"-clip")),r=jW();if(r==null)return null;var{x:i,y:l,width:o,height:c}=r;return y.createElement(w5e.Provider,{value:s},y.createElement("defs",null,y.createElement("clipPath",{id:s},y.createElement("rect",{x:i,y:l,height:c,width:o}))),n)};function uh(t,n){for(var s in t)if({}.hasOwnProperty.call(t,s)&&(!{}.hasOwnProperty.call(n,s)||t[s]!==n[s]))return!1;for(var r in n)if({}.hasOwnProperty.call(n,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function IW(t,n){if(n<1)return[];if(n===1)return t;for(var s=[],r=0;r<t.length;r+=n)s.push(t[r]);return s}function j5e(t,n,s){var r={width:t.width+n.width,height:t.height+n.height};return y5e(r,s)}function S5e(t,n,s){var r=s==="width",{x:i,y:l,width:o,height:c}=t;return n===1?{start:r?i:l,end:r?i+o:l+c}:{start:r?i+o:l+c,end:r?i:l}}function Ly(t,n,s,r,i){if(t*n<t*r||t*n>t*i)return!1;var l=s();return t*(n-t*l/2-r)>=0&&t*(n+t*l/2-i)<=0}function _5e(t,n){return IW(t,n+1)}function C5e(t,n,s,r,i){for(var l=(r||[]).slice(),{start:o,end:c}=n,d=0,u=1,h=o,m=function(){var w=r==null?void 0:r[d];if(w===void 0)return{v:IW(r,u)};var j=d,S,C=()=>(S===void 0&&(S=s(w,j)),S),A=w.coordinate,k=d===0||Ly(t,A,C,h,c);k||(d=0,h=o,u+=1),k&&(h=A+t*(C()/2+i),d+=u)},x;u<=l.length;)if(x=m(),x)return x.v;return[]}function kD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function Dr(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?kD(Object(s),!0).forEach(function(r){A5e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):kD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function A5e(t,n,s){return(n=k5e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function k5e(t){var n=E5e(t,"string");return typeof n=="symbol"?n:n+""}function E5e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function T5e(t,n,s,r,i){for(var l=(r||[]).slice(),o=l.length,{start:c}=n,{end:d}=n,u=function(x){var b=l[x],w,j=()=>(w===void 0&&(w=s(b,x)),w);if(x===o-1){var S=t*(b.coordinate+t*j()/2-d);l[x]=b=Dr(Dr({},b),{},{tickCoord:S>0?b.coordinate-S*t:b.coordinate})}else l[x]=b=Dr(Dr({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var C=Ly(t,b.tickCoord,j,c,d);C&&(d=b.tickCoord-t*(j()/2+i),l[x]=Dr(Dr({},b),{},{isShow:!0}))}},h=o-1;h>=0;h--)u(h);return l}function I5e(t,n,s,r,i,l){var o=(r||[]).slice(),c=o.length,{start:d,end:u}=n;if(l){var h=r[c-1],m=s(h,c-1),x=t*(h.coordinate+t*m/2-u);if(o[c-1]=h=Dr(Dr({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate}),h.tickCoord!=null){var b=Ly(t,h.tickCoord,()=>m,d,u);b&&(u=h.tickCoord-t*(m/2+i),o[c-1]=Dr(Dr({},h),{},{isShow:!0}))}}for(var w=l?c-1:c,j=function(A){var k=o[A],T,I=()=>(T===void 0&&(T=s(k,A)),T);if(A===0){var D=t*(k.coordinate-t*I()/2-d);o[A]=k=Dr(Dr({},k),{},{tickCoord:D<0?k.coordinate-D*t:k.coordinate})}else o[A]=k=Dr(Dr({},k),{},{tickCoord:k.coordinate});if(k.tickCoord!=null){var O=Ly(t,k.tickCoord,I,d,u);O&&(d=k.tickCoord+t*(I()/2+i),o[A]=Dr(Dr({},k),{},{isShow:!0}))}},S=0;S<w;S++)j(S);return o}function P5e(t,n,s){var{tick:r,ticks:i,viewBox:l,minTickGap:o,orientation:c,interval:d,tickFormatter:u,unit:h,angle:m}=t;if(!i||!i.length||!r)return[];if(Ct(d)||Bu.isSsr){var x;return(x=_5e(i,Ct(d)?d:0))!==null&&x!==void 0?x:[]}var b=[],w=c==="top"||c==="bottom"?"width":"height",j=h&&w==="width"?sp(h,{fontSize:n,letterSpacing:s}):{width:0,height:0},S=(k,T)=>{var I=typeof u=="function"?u(k.value,T):k.value;return w==="width"?j5e(sp(I,{fontSize:n,letterSpacing:s}),j,m):sp(I,{fontSize:n,letterSpacing:s})[w]},C=i.length>=2?Cr(i[1].coordinate-i[0].coordinate):1,A=S5e(l,C,w);return d==="equidistantPreserveStart"?C5e(C,A,S,i,o):(d==="preserveStart"||d==="preserveStartEnd"?b=I5e(C,A,S,i,o,d==="preserveStartEnd"):b=T5e(C,A,S,i,o),b.filter(k=>k.isShow))}var M5e=t=>{var{ticks:n,label:s,labelGapWithTick:r=5,tickSize:i=0,tickMargin:l=0}=t,o=0;if(n){Array.from(n).forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>o&&(o=m.width)}});var c=s?s.getBoundingClientRect().width:0,d=i+l,u=o+d+c+(s?r:0);return Math.round(u)}return 0},O5e=["axisLine","width","height","className","hide","ticks","axisType"],D5e=["viewBox"],R5e=["viewBox"];function U_(t,n){if(t==null)return{};var s,r,i=L5e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function L5e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function Nu(){return Nu=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Nu.apply(null,arguments)}function ED(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function ks(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?ED(Object(s),!0).forEach(function(r){B5e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ED(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function B5e(t,n,s){return(n=F5e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function F5e(t){var n=$5e(t,"string");return typeof n=="symbol"?n:n+""}function $5e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var z5e={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:$r.axis};function U5e(t){var{x:n,y:s,width:r,height:i,orientation:l,mirror:o,axisLine:c,otherSvgProps:d}=t;if(!c)return null;var u=ks(ks(ks({},d),Bl(c)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!o||l==="bottom"&&o);u=ks(ks({},u),{},{x1:n,y1:s+h*i,x2:n+r,y2:s+h*i})}else{var m=+(l==="left"&&!o||l==="right"&&o);u=ks(ks({},u),{},{x1:n+m*r,y1:s,x2:n+m*r,y2:s+i})}return y.createElement("line",Nu({},u,{className:fn("recharts-cartesian-axis-line",xu(c,"className"))}))}function V5e(t,n,s,r,i,l,o,c,d){var u,h,m,x,b,w,j=c?-1:1,S=t.tickSize||o,C=Ct(t.tickCoord)?t.tickCoord:t.coordinate;switch(l){case"top":u=h=t.coordinate,x=s+ +!c*i,m=x-j*S,w=m-j*d,b=C;break;case"left":m=x=t.coordinate,h=n+ +!c*r,u=h-j*S,b=u-j*d,w=C;break;case"right":m=x=t.coordinate,h=n+ +c*r,u=h+j*S,b=u+j*d,w=C;break;default:u=h=t.coordinate,x=s+ +c*i,m=x+j*S,w=m+j*d,b=C;break}return{line:{x1:u,y1:m,x2:h,y2:x},tick:{x:b,y:w}}}function H5e(t,n){switch(t){case"left":return n?"start":"end";case"right":return n?"end":"start";default:return"middle"}}function W5e(t,n){switch(t){case"left":case"right":return"middle";case"top":return n?"start":"end";default:return n?"end":"start"}}function q5e(t){var{option:n,tickProps:s,value:r}=t,i,l=fn(s.className,"recharts-cartesian-axis-tick-value");if(y.isValidElement(n))i=y.cloneElement(n,ks(ks({},s),{},{className:l}));else if(typeof n=="function")i=n(ks(ks({},s),{},{className:l}));else{var o="recharts-cartesian-axis-tick-value";typeof n!="boolean"&&(o=fn(o,n==null?void 0:n.className)),i=y.createElement(Rv,Nu({},s,{className:o}),r)}return i}var G5e=y.forwardRef((t,n)=>{var{ticks:s=[],tick:r,tickLine:i,stroke:l,tickFormatter:o,unit:c,padding:d,tickTextProps:u,orientation:h,mirror:m,x,y:b,width:w,height:j,tickSize:S,tickMargin:C,fontSize:A,letterSpacing:k,getTicksConfig:T,events:I,axisType:D}=t,O=P5e(ks(ks({},T),{},{ticks:s}),A,k),R=H5e(h,m),P=W5e(h,m),L=Bl(T),$=qp(r),B={};typeof i=="object"&&(B=i);var V=ks(ks({},L),{},{fill:"none"},B),K=O.map(Y=>ks({entry:Y},V5e(Y,x,b,w,j,h,S,m,C))),z=K.map(Y=>{var{entry:G,line:J}=Y;return y.createElement(aa,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(G.value,"-").concat(G.coordinate,"-").concat(G.tickCoord)},i&&y.createElement("line",Nu({},V,J,{className:fn("recharts-cartesian-axis-tick-line",xu(i,"className"))})))}),H=K.map((Y,G)=>{var{entry:J,tick:ee}=Y,ye=ks(ks(ks(ks({textAnchor:R,verticalAnchor:P},L),{},{stroke:"none",fill:l},$),ee),{},{index:G,payload:J,visibleTicksCount:O.length,tickFormatter:o,padding:d},u);return y.createElement(aa,Nu({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(J.value,"-").concat(J.coordinate,"-").concat(J.tickCoord)},tv(I,J,G)),r&&y.createElement(q5e,{option:r,tickProps:ye,value:"".concat(typeof o=="function"?o(J.value,G):J.value).concat(c||"")}))});return y.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(D,"-ticks")},H.length>0&&y.createElement(Gl,{zIndex:$r.label},y.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(D,"-tick-labels"),ref:n},H)),z.length>0&&y.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(D,"-tick-lines")},z))}),K5e=y.forwardRef((t,n)=>{var{axisLine:s,width:r,height:i,className:l,hide:o,ticks:c,axisType:d}=t,u=U_(t,O5e),[h,m]=y.useState(""),[x,b]=y.useState(""),w=y.useRef(null);y.useImperativeHandle(n,()=>({getCalculatedWidth:()=>{var S;return M5e({ticks:w.current,label:(S=t.labelRef)===null||S===void 0?void 0:S.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var j=y.useCallback(S=>{if(S){var C=S.getElementsByClassName("recharts-cartesian-axis-tick-value");w.current=C;var A=C[0];if(A){var k=window.getComputedStyle(A),T=k.fontSize,I=k.letterSpacing;(T!==h||I!==x)&&(m(T),b(I))}}},[h,x]);return o||r!=null&&r<=0||i!=null&&i<=0?null:y.createElement(Gl,{zIndex:t.zIndex},y.createElement(aa,{className:fn("recharts-cartesian-axis",l)},y.createElement(U5e,{x:t.x,y:t.y,width:r,height:i,orientation:t.orientation,mirror:t.mirror,axisLine:s,otherSvgProps:Bl(t)}),y.createElement(G5e,{ref:j,axisType:d,events:u,fontSize:h,getTicksConfig:t,height:t.height,letterSpacing:x,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:c,unit:t.unit,width:t.width,x:t.x,y:t.y}),y.createElement(Z3e,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},y.createElement(oAe,{label:t.label,labelRef:t.labelRef}),t.children)))}),Y5e=y.memo(K5e,(t,n)=>{var{viewBox:s}=t,r=U_(t,D5e),{viewBox:i}=n,l=U_(n,R5e);return uh(s,i)&&uh(r,l)}),OE=y.forwardRef((t,n)=>{var s=oa(t,z5e);return y.createElement(Y5e,Nu({},s,{ref:n}))});OE.displayName="CartesianAxis";var X5e=["dangerouslySetInnerHTML","ticks"],Q5e=["id"],Z5e=["domain"],J5e=["domain"];function V_(){return V_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},V_.apply(null,arguments)}function By(t,n){if(t==null)return{};var s,r,i=eTe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function eTe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function tTe(t){var n=Yn();return y.useLayoutEffect(()=>(n(Hke(t)),()=>{n(Wke(t))}),[t,n]),null}var nTe=t=>{var{xAxisId:n,className:s}=t,r=yt(ck),i=ti(),l="xAxis",o=yt(S=>Lh(S,l,n,i)),c=yt(S=>hH(S,l,n,i)),d=yt(S=>cH(S,n)),u=yt(S=>o_e(S,n)),h=yt(S=>VV(S,n));if(d==null||u==null||h==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=t,b=By(t,X5e),{id:w}=h,j=By(h,Q5e);return y.createElement(OE,V_({},b,j,{scale:o,x:u.x,y:u.y,width:d.width,height:d.height,className:fn("recharts-".concat(l," ").concat(l),s),viewBox:r,ticks:c,axisType:l}))},sTe={allowDataOverflow:Ia.allowDataOverflow,allowDecimals:Ia.allowDecimals,allowDuplicatedCategory:Ia.allowDuplicatedCategory,height:Ia.height,hide:!1,mirror:Ia.mirror,orientation:Ia.orientation,padding:Ia.padding,reversed:Ia.reversed,scale:Ia.scale,tickCount:Ia.tickCount,type:Ia.type,xAxisId:0},rTe=t=>{var n,s,r,i,l,o=oa(t,sTe);return y.createElement(y.Fragment,null,y.createElement(tTe,{interval:(n=o.interval)!==null&&n!==void 0?n:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(s=o.includeHidden)!==null&&s!==void 0?s:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(r=o.angle)!==null&&r!==void 0?r:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(l=o.tick)!==null&&l!==void 0?l:!0,tickFormatter:o.tickFormatter}),y.createElement(nTe,o))},aTe=(t,n)=>{var{domain:s}=t,r=By(t,Z5e),{domain:i}=n,l=By(n,J5e);return uh(r,l)?Array.isArray(s)&&s.length===2&&Array.isArray(i)&&i.length===2?s[0]===i[0]&&s[1]===i[1]:uh({domain:s},{domain:i}):!1},ax=y.memo(rTe,aTe);ax.displayName="XAxis";var iTe=["dangerouslySetInnerHTML","ticks"],lTe=["id"],oTe=["domain"],cTe=["domain"];function H_(){return H_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},H_.apply(null,arguments)}function Fy(t,n){if(t==null)return{};var s,r,i=dTe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function dTe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function uTe(t){var n=Yn();return y.useLayoutEffect(()=>(n(qke(t)),()=>{n(Gke(t))}),[t,n]),null}var fTe=t=>{var{yAxisId:n,className:s,width:r,label:i}=t,l=y.useRef(null),o=y.useRef(null),c=yt(ck),d=ti(),u=Yn(),h="yAxis",m=yt(I=>Lh(I,h,n,d)),x=yt(I=>dH(I,n)),b=yt(I=>d_e(I,n)),w=yt(I=>hH(I,h,n,d)),j=yt(I=>HV(I,n));if(y.useLayoutEffect(()=>{if(!(r!=="auto"||!x||NE(i)||y.isValidElement(i)||j==null)){var I=l.current;if(I){var D=I.getCalculatedWidth();Math.round(x.width)!==Math.round(D)&&u(Kke({id:n,width:D}))}}},[w,x,u,i,n,r,j]),x==null||b==null||j==null)return null;var{dangerouslySetInnerHTML:S,ticks:C}=t,A=Fy(t,iTe),{id:k}=j,T=Fy(j,lTe);return y.createElement(OE,H_({},A,T,{ref:l,labelRef:o,scale:m,x:b.x,y:b.y,tickTextProps:r==="auto"?{width:void 0}:{width:r},width:x.width,height:x.height,className:fn("recharts-".concat(h," ").concat(h),s),viewBox:c,ticks:w,axisType:h}))},hTe={allowDataOverflow:Pa.allowDataOverflow,allowDecimals:Pa.allowDecimals,allowDuplicatedCategory:Pa.allowDuplicatedCategory,hide:!1,mirror:Pa.mirror,orientation:Pa.orientation,padding:Pa.padding,reversed:Pa.reversed,scale:Pa.scale,tickCount:Pa.tickCount,type:Pa.type,width:Pa.width,yAxisId:0},mTe=t=>{var n,s,r,i,l,o=oa(t,hTe);return y.createElement(y.Fragment,null,y.createElement(uTe,{interval:(n=o.interval)!==null&&n!==void 0?n:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(s=o.includeHidden)!==null&&s!==void 0?s:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(r=o.angle)!==null&&r!==void 0?r:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(l=o.tick)!==null&&l!==void 0?l:!0,tickFormatter:o.tickFormatter}),y.createElement(fTe,o))},pTe=(t,n)=>{var{domain:s}=t,r=Fy(t,oTe),{domain:i}=n,l=Fy(n,cTe);return uh(r,l)?Array.isArray(s)&&s.length===2&&Array.isArray(i)&&i.length===2?s[0]===i[0]&&s[1]===i[1]:uh({domain:s},{domain:i}):!1},ix=y.memo(mTe,pTe);ix.displayName="YAxis";var xTe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qx=y;function gTe(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var yTe=typeof Object.is=="function"?Object.is:gTe,bTe=qx.useSyncExternalStore,vTe=qx.useRef,wTe=qx.useEffect,NTe=qx.useMemo,jTe=qx.useDebugValue;xTe.useSyncExternalStoreWithSelector=function(t,n,s,r,i){var l=vTe(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=NTe(function(){function d(b){if(!u){if(u=!0,h=b,b=r(b),i!==void 0&&o.hasValue){var w=o.value;if(i(w,b))return m=w}return m=b}if(w=m,yTe(h,b))return w;var j=r(b);return i!==void 0&&i(w,j)?(h=b,w):(h=b,m=j)}var u=!1,h,m,x=s===void 0?null:s;return[function(){return d(n())},x===null?void 0:function(){return d(x())}]},[n,s,r,i]);var c=bTe(t,l[0],l[1]);return wTe(function(){o.hasValue=!0,o.value=c},[c]),jTe(c),c};function STe(t){t()}function _Te(){let t=null,n=null;return{clear(){t=null,n=null},notify(){STe(()=>{let s=t;for(;s;)s.callback(),s=s.next})},get(){const s=[];let r=t;for(;r;)s.push(r),r=r.next;return s},subscribe(s){let r=!0;const i=n={callback:s,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){!r||t===null||(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var TD={notify(){},get:()=>[]};function CTe(t,n){let s,r=TD,i=0,l=!1;function o(j){h();const S=r.subscribe(j);let C=!1;return()=>{C||(C=!0,S(),m())}}function c(){r.notify()}function d(){w.onStateChange&&w.onStateChange()}function u(){return l}function h(){i++,s||(s=t.subscribe(d),r=_Te())}function m(){i--,s&&i===0&&(s(),s=void 0,r.clear(),r=TD)}function x(){l||(l=!0,h())}function b(){l&&(l=!1,m())}const w={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:u,trySubscribe:x,tryUnsubscribe:b,getListeners:()=>r};return w}var ATe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kTe=ATe(),ETe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",TTe=ETe(),ITe=()=>kTe||TTe?y.useLayoutEffect:y.useEffect,PTe=ITe(),v2=Symbol.for("react-redux-context"),w2=typeof globalThis<"u"?globalThis:{};function MTe(){if(!y.createContext)return{};const t=w2[v2]??(w2[v2]=new Map);let n=t.get(y.createContext);return n||(n=y.createContext(null),t.set(y.createContext,n)),n}var OTe=MTe();function DTe(t){const{children:n,context:s,serverState:r,store:i}=t,l=y.useMemo(()=>{const d=CTe(i);return{store:i,subscription:d,getServerState:r?()=>r:void 0}},[i,r]),o=y.useMemo(()=>i.getState(),[i]);PTe(()=>{const{subscription:d}=l;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),o!==i.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[l,o]);const c=s||OTe;return y.createElement(c.Provider,{value:l},n)}var RTe=DTe,LTe=(t,n)=>n,DE=Se([LTe,cn,zV,er,TH,Vo,vCe,Zs],ACe),RE=t=>{var n=t.currentTarget.getBoundingClientRect(),s=n.width/t.currentTarget.offsetWidth,r=n.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-n.left)/s),chartY:Math.round((t.clientY-n.top)/r)}},PW=Ei("mouseClick"),MW=Px();MW.startListening({actionCreator:PW,effect:(t,n)=>{var s=t.payload,r=DE(n.getState(),RE(s));(r==null?void 0:r.activeIndex)!=null&&n.dispatch(j_e({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var W_=Ei("mouseMove"),OW=Px();OW.startListening({actionCreator:W_,effect:(t,n)=>{var s=t.payload,r=n.getState(),i=hE(r,r.tooltip.settings.shared),l=DE(r,RE(s));i==="axis"&&((l==null?void 0:l.activeIndex)!=null?n.dispatch(wH({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):n.dispatch(vH()))}});var ID={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},DW=ka({name:"rootProps",initialState:ID,reducers:{updateOptions:(t,n)=>{var s;t.accessibilityLayer=n.payload.accessibilityLayer,t.barCategoryGap=n.payload.barCategoryGap,t.barGap=(s=n.payload.barGap)!==null&&s!==void 0?s:ID.barGap,t.barSize=n.payload.barSize,t.maxBarSize=n.payload.maxBarSize,t.stackOffset=n.payload.stackOffset,t.syncId=n.payload.syncId,t.syncMethod=n.payload.syncMethod,t.className=n.payload.className,t.baseValue=n.payload.baseValue}}}),BTe=DW.reducer,{updateOptions:FTe}=DW.actions,RW=ka({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,n)=>n.payload}}),{updatePolarOptions:$Te}=RW.actions,zTe=RW.reducer,LW=Ei("keyDown"),BW=Ei("focus"),LE=Px();LE.startListening({actionCreator:LW,effect:(t,n)=>{var s=n.getState(),r=s.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:i}=s.tooltip,l=t.payload;if(!(l!=="ArrowRight"&&l!=="ArrowLeft"&&l!=="Enter")){var o=Number(mE(i,Fh(s))),c=Vo(s);if(l==="Enter"){var d=Ty(s,"axis","hover",String(i.index));n.dispatch(R_({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:d}));return}var u=m_e(s),h=u==="left-to-right"?1:-1,m=l==="ArrowRight"?1:-1,x=o+m*h;if(!(c==null||x>=c.length||x<0)){var b=Ty(s,"axis","hover",String(x));n.dispatch(R_({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:b}))}}}}});LE.startListening({actionCreator:BW,effect:(t,n)=>{var s=n.getState(),r=s.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:i}=s.tooltip;if(!i.active&&i.index==null){var l="0",o=Ty(s,"axis","hover",String(l));n.dispatch(R_({activeDataKey:void 0,active:!0,activeIndex:l,activeCoordinate:o}))}}}});var fi=Ei("externalEvent"),FW=Px();FW.startListening({actionCreator:fi,effect:(t,n)=>{if(t.payload.handler!=null){var s=n.getState(),r={activeCoordinate:aCe(s),activeDataKey:OH(s),activeIndex:wu(s),activeLabel:MH(s),activeTooltipIndex:wu(s),isTooltipActive:iCe(s)};t.payload.handler(r,t.payload.reactEvent)}}});var UTe=Se([Bh],t=>t.tooltipItemPayloads),VTe=Se([UTe,Vx,(t,n,s)=>n,(t,n,s)=>s],(t,n,s,r)=>{var i=t.find(c=>c.settings.dataKey===r);if(i!=null){var{positions:l}=i;if(l!=null){var o=n(l,s);return o}}}),$W=Ei("touchMove"),zW=Px();zW.startListening({actionCreator:$W,effect:(t,n)=>{var s=t.payload;if(!(s.touches==null||s.touches.length===0)){var r=n.getState(),i=hE(r,r.tooltip.settings.shared);if(i==="axis"){var l=DE(r,RE({clientX:s.touches[0].clientX,clientY:s.touches[0].clientY,currentTarget:s.currentTarget}));(l==null?void 0:l.activeIndex)!=null&&n.dispatch(wH({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}else if(i==="item"){var o,c=s.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(hU),h=(o=d.getAttribute(mU))!==null&&o!==void 0?o:void 0,m=VTe(n.getState(),u,h);n.dispatch(bH({activeDataKey:h,activeIndex:u,activeCoordinate:m}))}}}});var HTe=$z({brush:h5e,cartesianAxis:Yke,chartData:s3e,errorBars:cEe,graphicalItems:hke,layout:hve,legend:lwe,options:ZCe,polarAxis:CAe,polarOptions:zTe,referenceElements:v5e,rootProps:BTe,tooltip:S_e,zIndex:zCe}),WTe=function(n){return Bbe({reducer:HTe,preloadedState:n,middleware:s=>s({serializableCheck:!1}).concat([MW.middleware,OW.middleware,LE.middleware,FW.middleware,zW.middleware]),enhancers:s=>{var r=s;return typeof s=="function"&&(r=s()),r.concat(Zz({type:"raf"}))},devTools:Bu.devToolsEnabled})};function UW(t){var{preloadedState:n,children:s,reduxStoreName:r}=t,i=ti(),l=y.useRef(null);if(i)return s;l.current==null&&(l.current=WTe(n));var o=tk;return y.createElement(RTe,{context:o,store:l.current},s)}function VW(t){var{layout:n,margin:s}=t,r=Yn(),i=ti();return y.useEffect(()=>{i||(r(dve(n)),r(cve(s)))},[r,i,n,s]),null}function HW(t){var n=Yn();return y.useEffect(()=>{n(FTe(t))},[n,t]),null}function PD(t){var{zIndex:n,isPanorama:s}=t,r=s?"recharts-zindex-panorama-":"recharts-zindex-",i=bW("".concat(r).concat(n)),l=Yn();return y.useLayoutEffect(()=>(l(FCe({zIndex:n,elementId:i,isPanorama:s})),()=>{l($Ce({zIndex:n,isPanorama:s}))}),[l,n,i,s]),y.createElement("g",{id:i})}function MD(t){var{children:n,isPanorama:s}=t,r=yt(ECe);if(!r||r.length===0)return n;var i=r.filter(o=>o<0),l=r.filter(o=>o>0);return y.createElement(y.Fragment,null,i.map(o=>y.createElement(PD,{key:o,zIndex:o,isPanorama:s})),n,l.map(o=>y.createElement(PD,{key:o,zIndex:o,isPanorama:s})))}var qTe=["children"];function GTe(t,n){if(t==null)return{};var s,r,i=KTe(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function KTe(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function $y(){return $y=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},$y.apply(null,arguments)}var YTe={width:"100%",height:"100%",display:"block"},XTe=y.forwardRef((t,n)=>{var s=swe(),r=rwe(),i=_U();if(!Hc(s)||!Hc(r))return null;var{children:l,otherAttributes:o,title:c,desc:d}=t,u,h;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?h=o.role:h=i?"application":void 0),y.createElement(q$,$y({},o,{title:c,desc:d,role:h,tabIndex:u,width:s,height:r,style:YTe,ref:n}),l)}),QTe=t=>{var{children:n}=t,s=yt(hv);if(!s)return null;var{width:r,height:i,y:l,x:o}=s;return y.createElement(q$,{width:r,height:i,x:o,y:l},n)},OD=y.forwardRef((t,n)=>{var{children:s}=t,r=GTe(t,qTe),i=ti();return i?y.createElement(QTe,null,y.createElement(MD,{isPanorama:!0},s)):y.createElement(XTe,$y({ref:n},r),y.createElement(MD,{isPanorama:!1},s))});function ZTe(){var t=Yn(),[n,s]=y.useState(null),r=yt(Ive);return y.useEffect(()=>{if(n!=null){var i=n.getBoundingClientRect(),l=i.width/n.offsetWidth;Ns(l)&&l!==r&&t(fve(l))}},[n,t,r]),s}function DD(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),s.push.apply(s,r)}return s}function JTe(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?DD(Object(s),!0).forEach(function(r){e4e(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):DD(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function e4e(t,n,s){return(n=t4e(n))in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function t4e(t){var n=n4e(t,"string");return typeof n=="symbol"?n:n+""}function n4e(t,n){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function ju(){return ju=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},ju.apply(null,arguments)}var s4e=()=>(f3e(),null);function zy(t){if(typeof t=="number")return t;if(typeof t=="string"){var n=parseFloat(t);if(!Number.isNaN(n))return n}return 0}var r4e=y.forwardRef((t,n)=>{var s,r,i=y.useRef(null),[l,o]=y.useState({containerWidth:zy((s=t.style)===null||s===void 0?void 0:s.width),containerHeight:zy((r=t.style)===null||r===void 0?void 0:r.height)}),c=y.useCallback((u,h)=>{o(m=>{var x=Math.round(u),b=Math.round(h);return m.containerWidth===x&&m.containerHeight===b?m:{containerWidth:x,containerHeight:b}})},[]),d=y.useCallback(u=>{if(typeof n=="function"&&n(u),u!=null&&typeof ResizeObserver<"u"){var{width:h,height:m}=u.getBoundingClientRect();c(h,m);var x=w=>{var{width:j,height:S}=w[0].contentRect;c(j,S)},b=new ResizeObserver(x);b.observe(u),i.current=b}},[n,c]);return y.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[c]),y.createElement(y.Fragment,null,y.createElement(xv,{width:l.containerWidth,height:l.containerHeight}),y.createElement("div",ju({ref:d},t)))}),a4e=y.forwardRef((t,n)=>{var{width:s,height:r}=t,[i,l]=y.useState({containerWidth:zy(s),containerHeight:zy(r)}),o=y.useCallback((d,u)=>{l(h=>{var m=Math.round(d),x=Math.round(u);return h.containerWidth===m&&h.containerHeight===x?h:{containerWidth:m,containerHeight:x}})},[]),c=y.useCallback(d=>{if(typeof n=="function"&&n(d),d!=null){var{width:u,height:h}=d.getBoundingClientRect();o(u,h)}},[n,o]);return y.createElement(y.Fragment,null,y.createElement(xv,{width:i.containerWidth,height:i.containerHeight}),y.createElement("div",ju({ref:c},t)))}),i4e=y.forwardRef((t,n)=>{var{width:s,height:r}=t;return y.createElement(y.Fragment,null,y.createElement(xv,{width:s,height:r}),y.createElement("div",ju({ref:n},t)))}),l4e=y.forwardRef((t,n)=>{var{width:s,height:r}=t;return Co(s)||Co(r)?y.createElement(a4e,ju({},t,{ref:n})):y.createElement(i4e,ju({},t,{ref:n}))});function o4e(t){return t===!0?r4e:l4e}var c4e=y.forwardRef((t,n)=>{var{children:s,className:r,height:i,onClick:l,onContextMenu:o,onDoubleClick:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:h,onMouseMove:m,onMouseUp:x,onTouchEnd:b,onTouchMove:w,onTouchStart:j,style:S,width:C,responsive:A,dispatchTouchEvents:k=!0}=t,T=y.useRef(null),I=Yn(),[D,O]=y.useState(null),[R,P]=y.useState(null),L=ZTe(),$=dk(),B=($==null?void 0:$.width)>0?$.width:C,V=($==null?void 0:$.height)>0?$.height:i,K=y.useCallback(le=>{L(le),typeof n=="function"&&n(le),O(le),P(le),le!=null&&(T.current=le)},[L,n,O,P]),z=y.useCallback(le=>{I(PW(le)),I(fi({handler:l,reactEvent:le}))},[I,l]),H=y.useCallback(le=>{I(W_(le)),I(fi({handler:u,reactEvent:le}))},[I,u]),Y=y.useCallback(le=>{I(vH()),I(fi({handler:h,reactEvent:le}))},[I,h]),G=y.useCallback(le=>{I(W_(le)),I(fi({handler:m,reactEvent:le}))},[I,m]),J=y.useCallback(()=>{I(BW())},[I]),ee=y.useCallback(le=>{I(LW(le.key))},[I]),ye=y.useCallback(le=>{I(fi({handler:o,reactEvent:le}))},[I,o]),ie=y.useCallback(le=>{I(fi({handler:c,reactEvent:le}))},[I,c]),he=y.useCallback(le=>{I(fi({handler:d,reactEvent:le}))},[I,d]),be=y.useCallback(le=>{I(fi({handler:x,reactEvent:le}))},[I,x]),we=y.useCallback(le=>{I(fi({handler:j,reactEvent:le}))},[I,j]),Z=y.useCallback(le=>{k&&I($W(le)),I(fi({handler:w,reactEvent:le}))},[I,k,w]),ce=y.useCallback(le=>{I(fi({handler:b,reactEvent:le}))},[I,b]),Te=o4e(A);return y.createElement(UH.Provider,{value:D},y.createElement(J1e.Provider,{value:R},y.createElement(Te,{width:B??(S==null?void 0:S.width),height:V??(S==null?void 0:S.height),className:fn("recharts-wrapper",r),style:JTe({position:"relative",cursor:"default",width:B,height:V},S),onClick:z,onContextMenu:ye,onDoubleClick:ie,onFocus:J,onKeyDown:ee,onMouseDown:he,onMouseEnter:H,onMouseLeave:Y,onMouseMove:G,onMouseUp:be,onTouchEnd:ce,onTouchMove:Z,onTouchStart:we,ref:K},y.createElement(s4e,null),s)))}),d4e=["width","height","responsive","children","className","style","compact","title","desc"];function u4e(t,n){if(t==null)return{};var s,r,i=f4e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function f4e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var WW=y.forwardRef((t,n)=>{var{width:s,height:r,responsive:i,children:l,className:o,style:c,compact:d,title:u,desc:h}=t,m=u4e(t,d4e),x=Bl(m);return d?y.createElement(y.Fragment,null,y.createElement(xv,{width:s,height:r}),y.createElement(OD,{otherAttributes:x,title:u,desc:h},l)):y.createElement(c4e,{className:o,style:c,width:s,height:r,responsive:i??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},y.createElement(OD,{otherAttributes:x,title:u,desc:h,ref:n},y.createElement(N5e,null,l)))});function q_(){return q_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},q_.apply(null,arguments)}var h4e={top:5,right:5,bottom:5,left:5},m4e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:h4e,reverseStackOrder:!1,syncMethod:"index",responsive:!1},p4e=y.forwardRef(function(n,s){var r,i=oa(n.categoricalChartProps,m4e),{chartName:l,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:u}=n,h={chartName:l,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return y.createElement(UW,{preloadedState:{options:h},reduxStoreName:(r=u.id)!==null&&r!==void 0?r:l},y.createElement(kW,{chartData:u.data}),y.createElement(VW,{layout:i.layout,margin:i.margin}),y.createElement(HW,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),y.createElement(WW,q_({},i,{ref:s})))}),x4e=["axis","item"],Uy=y.forwardRef((t,n)=>y.createElement(p4e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:x4e,tooltipPayloadSearcher:HH,categoricalChartProps:t,ref:n}));function g4e(t){var n=Yn();return y.useEffect(()=>{n($Te(t))},[n,t]),null}var y4e=["layout"];function G_(){return G_=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},G_.apply(null,arguments)}function b4e(t,n){if(t==null)return{};var s,r,i=v4e(t,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)s=l[r],n.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(i[s]=t[s])}return i}function v4e(t,n){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(n.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var w4e={top:5,right:5,bottom:5,left:5},N4e={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:w4e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},j4e=y.forwardRef(function(n,s){var r,i=oa(n.categoricalChartProps,N4e),{layout:l}=i,o=b4e(i,y4e),{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h}=n,m={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return y.createElement(UW,{preloadedState:{options:m},reduxStoreName:(r=i.id)!==null&&r!==void 0?r:c},y.createElement(kW,{chartData:i.data}),y.createElement(VW,{layout:l,margin:i.margin}),y.createElement(HW,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),y.createElement(g4e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),y.createElement(WW,G_({},o,{ref:s})))}),S4e=["item"],_4e={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},K_=y.forwardRef((t,n)=>{var s=oa(t,_4e);return y.createElement(j4e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:S4e,tooltipPayloadSearcher:HH,categoricalChartProps:s,ref:n})});const ec=["#0f172a","#0284c7","#22c55e","#e11d48","#6366f1"];function eo(t){return t.toISOString().slice(0,10)}function RD(t,n){const s=new Date(t);return s.setDate(s.getDate()+n),s}const C4e={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.3,ease:"easeOut"}}},N2={hidden:{},visible:{transition:{staggerChildren:.08,delayChildren:.05}}},j2={hidden:{opacity:0,y:10,scale:.97},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}},LD={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};function BD(){var Te;const t=new Date,[n,s]=y.useState(()=>eo(t)),[r,i]=y.useState(()=>eo(t)),[l,o]=y.useState("today"),[c,d]=y.useState("overview"),[u,h]=y.useState(null),[m,x]=y.useState(null),[b,w]=y.useState(!0),[j,S]=y.useState(""),[C,A]=y.useState(0),k=!!(n&&r);y.useEffect(()=>{if(!k){w(!1),S(""),h(null);return}(async()=>{var de,ge;w(!0),S("");try{const Ve=await x1e({date_from:n,date_to:r});console.log("DASHBOARD DATA >>>",Ve.data),h(Ve.data),x(new Date)}catch(ae){console.error(ae),S(((ge=(de=ae==null?void 0:ae.response)==null?void 0:de.data)==null?void 0:ge.detail)||"Failed to load dashboard data. Please try again."),h(null)}finally{w(!1)}})()},[n,r,C,k]);const T=((Te=u==null?void 0:u.filters)==null?void 0:Te.caps)||{},I=Object.keys(T).length>0,D=y.useMemo(()=>{if(!I)return[];const le=[];return T.can_patients&&le.push({key:"patients",label:"Patients",icon:or}),T.can_opd&&le.push({key:"opd",label:"OPD",icon:un}),T.can_ipd&&le.push({key:"ipd",label:"IPD / Beds",icon:Ps}),T.can_lab&&le.push({key:"lab",label:"Lab",icon:Lc}),T.can_radiology&&le.push({key:"radiology",label:"Radiology",icon:T1}),T.can_pharmacy&&le.push({key:"pharmacy",label:"Pharmacy",icon:Ur}),T.can_billing&&le.push({key:"billing",label:"Billing",icon:_l}),T.can_ot&&le.push({key:"ot",label:"OT",icon:or}),le},[I,T]),O=y.useMemo(()=>{var le;return((le=u==null?void 0:u.widgets)==null?void 0:le.filter(de=>de.widget_type==="metric"))||[]},[u]),R=y.useMemo(()=>{var le;return((le=u==null?void 0:u.widgets)==null?void 0:le.filter(de=>de.widget_type==="table"))||[]},[u]),P=y.useMemo(()=>{var le;return((le=u==null?void 0:u.widgets)==null?void 0:le.filter(de=>de.widget_type==="chart"))||[]},[u]),L=P.find(le=>le.code==="patient_flow"),$=P.find(le=>le.code==="ipd_bed_occupancy"),B=P.find(le=>le.code==="revenue_by_stream"),V=P.find(le=>le.code==="appointment_status"),K=P.find(le=>le.code==="ipd_status"),z=P.find(le=>le.code==="payment_modes"),H=P.find(le=>le.code==="top_lab_tests"),Y=P.find(le=>le.code==="top_radiology_tests"),G=P.find(le=>le.code==="billing_summary"),J=P.find(le=>le.code==="top_medicines"),ee=R.find(le=>le.code==="recent_ipd_admissions"),ye=O.filter(le=>le.code.startsWith("revenue_")),ie=O.filter(le=>!le.code.startsWith("revenue_")),he=()=>A(le=>le+1),be=le=>{o(le);const de=new Date;if(le==="today"){const ge=eo(de);s(ge),i(ge)}else if(le==="7d"){const ge=eo(RD(de,-6)),ae=eo(de);s(ge),i(ae)}else if(le==="30d"){const ge=eo(RD(de,-29)),ae=eo(de);s(ge),i(ae)}else if(le==="month"){const ge=new Date(de.getFullYear(),de.getMonth(),1),ae=eo(ge),Ve=eo(de);s(ae),i(Ve)}},we=le=>de=>{o("custom"),le(de.target.value)},Z=y.useMemo(()=>{if(!u)return[];const le=Me=>{var qe;return((qe=O.find(oe=>oe.code===Me))==null?void 0:qe.data)??0},de=Number(le("metric_new_patients"))||0,ge=Number(le("metric_opd_visits"))||0,ae=Number(le("metric_ipd_admissions"))||0,nt=(($==null?void 0:$.data)||{}).occupancy_pct??0,wt=(B==null?void 0:B.data)||[],jt=Array.isArray(wt)&&wt.length?[...wt].sort((Me,qe)=>(qe.value||0)-(Me.value||0))[0]:null,ct=[];return T.can_patients&&O.length&&ct.push({key:"patients",label:"New Patients",value:de,helper:"Registered in period",icon:or,tone:"sky"}),T.can_opd&&O.length&&ct.push({key:"opd",label:"OPD Visits",value:ge,helper:"Completed consults",icon:un,tone:"emerald"}),T.can_ipd&&O.length&&ct.push({key:"ipd",label:"IPD Admissions",value:ae,helper:"Admitted cases",icon:Ps,tone:"violet"}),T.can_ipd&&$&&ct.push({key:"beds",label:"Bed Occupancy",value:nt,suffix:"%",helper:"Across all wards",icon:Ps,tone:"amber"}),jt&&(T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology)&&ct.push({key:"revenue",label:"Top Revenue Stream",value:jt.value||0,helper:jt.label||"",icon:jt.label==="Pharmacy"?Ur:jt.label==="Lab"?Lc:jt.label==="Radiology"?T1:_l,tone:"rose"}),ct.filter(Boolean)},[u,O,$,B,T.can_patients,T.can_opd,T.can_ipd,T.can_billing,T.can_pharmacy,T.can_lab,T.can_radiology]),ce=y.useMemo(()=>[{key:"overview",label:"Overview",show:!0},{key:"clinical",label:"Clinical",show:T.can_patients||T.can_opd||T.can_ipd},{key:"revenue",label:"Revenue",show:T.can_billing||T.can_pharmacy||T.can_lab||T.can_radiology},{key:"operations",label:"Operations",show:T.can_ipd||T.can_pharmacy||T.can_lab||T.can_radiology}].filter(de=>de.show),[T]);return y.useEffect(()=>{ce.find(le=>le.key===c)||ce.length>0&&d(ce[0].key)},[ce,c]),a.jsxs(gt.div,{className:"relative min-h-[calc(100vh-4rem)]  px-3 py-3 md:px-6 md:py-6 rounded",variants:C4e,initial:"hidden",animate:"visible",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0 -z-10",children:[a.jsx("div",{className:"absolute -top-24 right-0 h-40 w-40 rounded-full bg-sky-200/40 blur-3xl"}),a.jsx("div",{className:"absolute -bottom-24 left-4 h-40 w-40 rounded-full bg-emerald-200/40 blur-3xl"})]}),a.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs(gt.div,{className:It("flex flex-col md:flex-row md:items-start md:justify-between gap-3","rounded-2xl border border-slate-200/70 bg-white/90 backdrop-blur-sm p-3 md:p-5 shadow-sm"),children:[a.jsxs("div",{className:"space-y-2 md:max-w-md",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-[10px] md:text-[11px] font-medium text-sky-700",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),"Live operations & clinical overview"]}),a.jsxs("h1",{className:"text-xl md:text-3xl font-semibold tracking-tight text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"inline-flex h-8 w-8 md:h-9 md:w-9 items-center justify-center rounded-xl bg-sky-100 text-sky-600 border border-sky-200",children:a.jsx(Im,{className:"w-4 h-4 md:w-5 md:h-5"})}),"Dashboard"]}),a.jsx("p",{className:"text-xs md:text-sm text-slate-600",children:"Monitor patients, beds, diagnostics, pharmacy and revenue in one live dashboard designed for hospital admins & clinical teams."}),I&&D.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:D.map(le=>a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 border border-slate-200 px-2 py-0.5 text-[10px] text-slate-700",children:[a.jsx("span",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-white shadow-inner",children:a.jsx(le.icon,{className:"w-3 h-3"})}),a.jsx("span",{className:"font-medium",children:le.label})]},le.key))}),m&&a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-100 px-2.5 py-1 mt-1 text-[10px] text-slate-600",children:[a.jsx(Ys,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:"Last updated:"}),a.jsx("span",{children:m.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})})]})]}),a.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[a.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(le=>a.jsx("button",{type:"button",onClick:()=>be(le.key),className:It("px-2.5 py-1 rounded-full text-[10px] font-medium border transition-colors",l===le.key?"bg-sky-600 text-white border-sky-600 shadow-sm":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:le.label},le.key))}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[a.jsxs("div",{className:"flex flex-1 items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2 shadow-inner",children:[a.jsx(sS,{className:"w-4 h-4 text-slate-500 shrink-0"}),a.jsxs("div",{className:"flex flex-col gap-1 w-full text-[11px] text-slate-700 sm:flex-row sm:items-center",children:[a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"hidden sm:inline",children:"From"}),a.jsx("input",{type:"date",value:n,onChange:we(s),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]}),a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"hidden sm:inline",children:"To"}),a.jsx("input",{type:"date",value:r,onChange:we(i),className:"w-full border border-slate-200 bg-slate-50 rounded px-1.5 py-0.5 text-[11px] text-slate-800 focus:outline-none focus:ring-1 focus:ring-sky-500"})]})]})]}),a.jsxs(gt.button,{onClick:he,whileTap:{scale:.96},className:It("inline-flex items-center justify-center gap-2 rounded-xl","border border-sky-600 bg-sky-600 text-white shadow-sm","px-3 py-2 text-xs sm:text-sm font-medium w-full sm:w-auto","hover:bg-sky-500 hover:border-sky-500 transition-colors"),children:[a.jsx(cu,{className:"w-4 h-4"}),"Refresh"]})]})]})]}),a.jsx(du,{children:j&&a.jsx(gt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:a.jsxs($c,{variant:"destructive",children:[a.jsx(Ms,{className:"h-4 w-4 mt-0.5"}),a.jsxs("div",{children:[a.jsx(zc,{children:"Dashboard error"}),a.jsx(Uc,{children:j})]})]})})}),!b&&u&&Z.length>0&&a.jsxs(gt.div,{className:"rounded-2xl border border-slate-200 bg-white px-2.5 py-3 shadow-sm",variants:LD,initial:"hidden",animate:"visible",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2 px-1",children:[a.jsx("h2",{className:"text-xs font-semibold text-slate-700",children:"At a glance"}),a.jsx("span",{className:"h-px flex-1 bg-slate-200"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(le=>a.jsx(A4e,{pill:le},le.key))})]})]}),!k&&!b&&!j&&a.jsx(Le,{className:"rounded-2xl border border-dashed border-slate-300 bg-slate-50/70",children:a.jsxs(ze,{className:"py-6 flex flex-col items-center text-center gap-2",children:[a.jsx(sS,{className:"w-8 h-8 text-slate-400 mb-1"}),a.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Select a date range to see live dashboard data."}),a.jsxs("p",{className:"text-xs text-slate-500 max-w-xs",children:["Choose both ",a.jsx("span",{className:"font-semibold",children:"From"})," and"," ",a.jsx("span",{className:"font-semibold",children:"To"})," dates above. Well show patient, revenue, pharmacy and diagnostics insights."]})]})}),b&&k&&!u&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[a.jsx(Ze,{className:"h-20 rounded-2xl"}),a.jsx(Ze,{className:"h-20 rounded-2xl"}),a.jsx(Ze,{className:"h-20 rounded-2xl"}),a.jsx(Ze,{className:"h-20 rounded-2xl"})]}),a.jsx(Ze,{className:"h-56 rounded-2xl"}),a.jsx(Ze,{className:"h-56 rounded-2xl"})]}),!b&&k&&u&&a.jsx(gt.div,{variants:LD,initial:"hidden",animate:"visible",className:"pb-4",children:a.jsxs(_o,{value:c,onValueChange:d,className:"w-full",children:[a.jsx("div",{className:"flex justify-between items-center mb-2",children:a.jsx(Ll,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100/80 p-1",children:ce.map(le=>a.jsx(dn,{value:le.key,className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:shadow-sm",children:le.label},le.key))})}),a.jsxs(mn,{value:"overview",className:"space-y-4 mt-2",children:[O.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Key metrics"}),a.jsx(gt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",variants:N2,initial:"hidden",animate:"visible",children:O.map(le=>a.jsx(gt.div,{variants:j2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:a.jsx(S2,{widget:le})},le.code))})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Activity & revenue mix"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[L&&a.jsx(yr,{widget:L}),B&&a.jsx(yr,{widget:B})]})]})]}),a.jsxs(mn,{value:"clinical",className:"space-y-4 mt-2",children:[ie.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Clinical metrics"}),a.jsx(gt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:N2,initial:"hidden",animate:"visible",children:ie.map(le=>a.jsx(gt.div,{variants:j2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:a.jsx(S2,{widget:le})},le.code))})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Patient flow & statuses"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[L&&a.jsx(yr,{widget:L}),V&&a.jsx(yr,{widget:V})]})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"IPD beds & admissions"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[$&&a.jsx(yr,{widget:$}),K&&a.jsx(yr,{widget:K})]})]}),ee&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Recent IPD admissions"}),a.jsx(FD,{widget:ee})]})]}),a.jsxs(mn,{value:"revenue",className:"space-y-4 mt-2",children:[ye.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue KPIs"}),a.jsx(gt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",variants:N2,initial:"hidden",animate:"visible",children:ye.map(le=>a.jsx(gt.div,{variants:j2,whileHover:{y:-2,scale:1.01,boxShadow:"0 18px 35px rgba(15, 23, 42, 0.12)"},transition:{type:"spring",stiffness:220,damping:20},children:a.jsx(S2,{widget:le})},le.code))})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Revenue & payment mix"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[B&&a.jsx(yr,{widget:B}),z&&a.jsx(yr,{widget:z})]})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Billed vs pending & top tests"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[G&&a.jsx(yr,{widget:G}),H&&a.jsx(yr,{widget:H}),Y&&a.jsx(yr,{widget:Y})]})]}),J&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Top 10 medicines (by quantity)"}),a.jsx(yr,{widget:J})]})]}),a.jsxs(mn,{value:"operations",className:"space-y-4 mt-2",children:[a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Capacity & utilization"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 md:gap-4",children:[$&&a.jsx(yr,{widget:$}),L&&a.jsx(yr,{widget:L})]})]}),a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Pharmacy & diagnostics focus"}),a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3 md:gap-4",children:[J&&a.jsx(yr,{widget:J}),H&&a.jsx(yr,{widget:H}),Y&&a.jsx(yr,{widget:Y})]})]}),ee&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-700",children:"Latest IPD activity"}),a.jsx(FD,{widget:ee})]})]})]})})]})]})}function A4e({pill:t}){const{label:n,value:s,helper:r,icon:i,tone:l,suffix:o}=t,c={sky:"bg-sky-50 border-sky-100 text-sky-800",emerald:"bg-emerald-50 border-emerald-100 text-emerald-800",violet:"bg-violet-50 border-violet-100 text-violet-800",amber:"bg-amber-50 border-amber-100 text-amber-800",rose:"bg-rose-50 border-rose-100 text-rose-800"}[l||"sky"];return a.jsxs(gt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:260,damping:18},className:It("flex-1 min-w-[140px] sm:min-w-[160px] rounded-2xl border px-2.5 py-2","flex items-center gap-2 sm:gap-3 shadow-[0_8px_18px_rgba(15,23,42,0.04)]",c),children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-white/70 text-slate-700 shadow-sm shrink-0",children:i&&a.jsx(i,{className:"w-4 h-4"})}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide font-semibold opacity-90",children:n}),a.jsxs("div",{className:"text-base sm:text-lg font-semibold leading-tight",children:[typeof s=="number"?s.toLocaleString("en-IN",{maximumFractionDigits:o==="%"?1:0}):s,o&&a.jsx("span",{className:"ml-0.5 text-[10px]",children:o})]}),r&&a.jsx("div",{className:"text-[10px] leading-tight opacity-80",children:r})]})]})}function S2({widget:t}){const n=t.data,s=typeof n=="number"||typeof n=="string"?n:typeof n=="object"&&n!==null?n.value??n.total??n.amount??0:0,r=typeof s=="number"?s.toLocaleString("en-IN",{maximumFractionDigits:(t.code.includes("revenue"),0)}):s;return a.jsxs(Le,{className:It("rounded-2xl shadow-sm overflow-hidden border border-slate-200 bg-white","hover:border-sky-200 transition-colors"),children:[a.jsxs(Je,{className:"flex flex-row items-start justify-between space-y-0 pb-1",children:[a.jsxs(st,{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-400 shadow-[0_0_0_3px_rgba(52,211,153,0.35)]"}),t.title]}),a.jsx(Xe,{variant:"outline",className:"text-[9px] uppercase tracking-wide border-slate-200 text-slate-500",children:t.code})]}),a.jsxs(ze,{className:"pt-0",children:[a.jsx("div",{className:"text-2xl md:text-3xl font-semibold tracking-tight mt-1 text-slate-900",children:r}),t.description&&a.jsx("p",{className:"text-[11px] text-slate-500 mt-1",children:t.description})]})]})}function yr({widget:t}){var i,l,o;const n=((i=t.config)==null?void 0:i.chart_type)||"bar";if(n==="donut"){const c=t.data||{},d=[{label:"Occupied",value:c.occupied||0},{label:"Available",value:c.available||0}];return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Snapshot"})]}),a.jsxs(ze,{className:"h-56 sm:h-64",children:[a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(K_,{children:[a.jsx(Oy,{dataKey:"value",data:d,innerRadius:50,outerRadius:80,paddingAngle:3,children:d.map((u,h)=>a.jsx(Al,{fill:ec[h%ec.length]},`cell-${h}`))}),a.jsx(zd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})}),typeof c.occupancy_pct=="number"&&a.jsxs("p",{className:"text-xs text-slate-600 text-center mt-2",children:["Occupancy:"," ",a.jsxs("span",{className:"font-medium text-emerald-600",children:[c.occupancy_pct,"%"]})," ",a.jsxs("span",{className:"opacity-80",children:["(",c.occupied,"/",c.total," beds)"]})]})]})]})}if(n==="pie"){const c=Array.isArray(t.data)?t.data:[];return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Distribution"})]}),a.jsx(ze,{className:"h-56 sm:h-64",children:c.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(K_,{children:[a.jsx(Oy,{data:c,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:d=>`${d.label}: ${d.value??0}`,children:c.map((d,u)=>a.jsx(Al,{fill:ec[u%ec.length]},`cell-${u}`))}),a.jsx(zd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}})]})})})]})}if(n==="multi_bar"){const c=Array.isArray(t.data)?t.data:[],d=((l=t.config)==null?void 0:l.series)||[],u=((o=t.config)==null?void 0:o.x_key)||"label";return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsx(Je,{className:"pb-2",children:a.jsx(st,{className:"text-base font-semibold text-slate-800",children:t.title})}),a.jsx(ze,{className:"h-56 sm:h-64",children:c.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(Uy,{data:c,margin:{left:8,right:8,top:8,bottom:8},children:[a.jsx(ax,{dataKey:u,stroke:"#6b7280",fontSize:11}),a.jsx(ix,{stroke:"#6b7280",fontSize:11}),a.jsx(zd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),d.map((h,m)=>a.jsx(rx,{dataKey:h.key,name:h.label,radius:[4,4,0,0],children:c.map((x,b)=>a.jsx(Al,{fill:ec[(m+b)%ec.length]},`cell-${h.key}-${b}`))},h.key))]})})})]})}const s=Array.isArray(t.data)?t.data:[],r=s.length>0?s.map((c,d)=>({label:c.label??c.name??`Item ${d+1}`,value:c.value??c.amount??0})):[];return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:t.description?"Insight":"Summary"})]}),a.jsx(ze,{className:"h-56 sm:h-64",children:r.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(Uy,{data:r,margin:{left:8,right:8,top:8,bottom:8},children:[a.jsx(ax,{dataKey:"label",stroke:"#6b7280",fontSize:11}),a.jsx(ix,{stroke:"#6b7280",fontSize:11}),a.jsx(zd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12}}),a.jsx(rx,{dataKey:"value",radius:[4,4,0,0],children:r.map((c,d)=>a.jsx(Al,{fill:ec[d%ec.length]},`cell-${d}`))})]})})})]})}function FD({widget:t}){var r;const n=Array.isArray(t.data)?t.data:[],s=((r=t.config)==null?void 0:r.columns)||(n[0]?Object.keys(n[0]):[]);return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-base font-semibold text-slate-800",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-500",children:"Latest records"})]}),a.jsx(ze,{className:"space-y-2",children:n.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"No records found."}):a.jsx("div",{className:"flex flex-col gap-2",children:n.map((i,l)=>a.jsx("div",{className:It("rounded-xl border border-slate-200 bg-slate-50/60 px-3 py-2.5","flex flex-col gap-1 text-xs md:text-sm"),children:s.map((o,c)=>a.jsxs("div",{className:It("flex justify-between gap-2",c===0?"font-semibold text-slate-900":"text-slate-700"),children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:o.replace(/_/g," ")}),a.jsx("span",{className:"text-right",children:k4e(i[o])})]},o))},l))})})]})}function k4e(t){return t==null?"-":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>40?t.slice(0,40)+"":String(t)}function E4e(){return ne.get("/mis/definitions")}function T4e(t,n){return ne.post(`/mis/reports/${t}`,n)}function Y_(t,[n,s]){return Math.min(s,Math.max(n,t))}function I4e(t,n=globalThis==null?void 0:globalThis.document){const s=Jr(t);y.useEffect(()=>{const r=i=>{i.key==="Escape"&&s(i)};return n.addEventListener("keydown",r,{capture:!0}),()=>n.removeEventListener("keydown",r,{capture:!0})},[s,n])}var P4e="DismissableLayer",X_="dismissableLayer.update",M4e="dismissableLayer.pointerDownOutside",O4e="dismissableLayer.focusOutside",$D,qW=y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),BE=y.forwardRef((t,n)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:l,onInteractOutside:o,onDismiss:c,...d}=t,u=y.useContext(qW),[h,m]=y.useState(null),x=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,b]=y.useState({}),w=Sn(n,O=>m(O)),j=Array.from(u.layers),[S]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),C=j.indexOf(S),A=h?j.indexOf(h):-1,k=u.layersWithOutsidePointerEventsDisabled.size>0,T=A>=C,I=L4e(O=>{const R=O.target,P=[...u.branches].some(L=>L.contains(R));!T||P||(i==null||i(O),o==null||o(O),O.defaultPrevented||c==null||c())},x),D=B4e(O=>{const R=O.target;[...u.branches].some(L=>L.contains(R))||(l==null||l(O),o==null||o(O),O.defaultPrevented||c==null||c())},x);return I4e(O=>{A===u.layers.size-1&&(r==null||r(O),!O.defaultPrevented&&c&&(O.preventDefault(),c()))},x),y.useEffect(()=>{if(h)return s&&(u.layersWithOutsidePointerEventsDisabled.size===0&&($D=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),zD(),()=>{s&&u.layersWithOutsidePointerEventsDisabled.size===1&&(x.body.style.pointerEvents=$D)}},[h,x,s,u]),y.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),zD())},[h,u]),y.useEffect(()=>{const O=()=>b({});return document.addEventListener(X_,O),()=>document.removeEventListener(X_,O)},[]),a.jsx(Yt.div,{...d,ref:w,style:{pointerEvents:k?T?"auto":"none":void 0,...t.style},onFocusCapture:Vt(t.onFocusCapture,D.onFocusCapture),onBlurCapture:Vt(t.onBlurCapture,D.onBlurCapture),onPointerDownCapture:Vt(t.onPointerDownCapture,I.onPointerDownCapture)})});BE.displayName=P4e;var D4e="DismissableLayerBranch",R4e=y.forwardRef((t,n)=>{const s=y.useContext(qW),r=y.useRef(null),i=Sn(n,r);return y.useEffect(()=>{const l=r.current;if(l)return s.branches.add(l),()=>{s.branches.delete(l)}},[s.branches]),a.jsx(Yt.div,{...t,ref:i})});R4e.displayName=D4e;function L4e(t,n=globalThis==null?void 0:globalThis.document){const s=Jr(t),r=y.useRef(!1),i=y.useRef(()=>{});return y.useEffect(()=>{const l=c=>{if(c.target&&!r.current){let d=function(){GW(M4e,s,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(n.removeEventListener("click",i.current),i.current=d,n.addEventListener("click",i.current,{once:!0})):d()}else n.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{n.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(o),n.removeEventListener("pointerdown",l),n.removeEventListener("click",i.current)}},[n,s]),{onPointerDownCapture:()=>r.current=!0}}function B4e(t,n=globalThis==null?void 0:globalThis.document){const s=Jr(t),r=y.useRef(!1);return y.useEffect(()=>{const i=l=>{l.target&&!r.current&&GW(O4e,s,{originalEvent:l},{discrete:!1})};return n.addEventListener("focusin",i),()=>n.removeEventListener("focusin",i)},[n,s]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function zD(){const t=new CustomEvent(X_);document.dispatchEvent(t)}function GW(t,n,s,{discrete:r}){const i=s.originalEvent.target,l=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:s});n&&i.addEventListener(t,n,{once:!0}),r?N1e(i,l):i.dispatchEvent(l)}var _2=0;function KW(){y.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??UD()),document.body.insertAdjacentElement("beforeend",t[1]??UD()),_2++,()=>{_2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),_2--}},[])}function UD(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var C2="focusScope.autoFocusOnMount",A2="focusScope.autoFocusOnUnmount",VD={bubbles:!1,cancelable:!0},F4e="FocusScope",FE=y.forwardRef((t,n)=>{const{loop:s=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:l,...o}=t,[c,d]=y.useState(null),u=Jr(i),h=Jr(l),m=y.useRef(null),x=Sn(n,j=>d(j)),b=y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;y.useEffect(()=>{if(r){let j=function(k){if(b.paused||!c)return;const T=k.target;c.contains(T)?m.current=T:rc(m.current,{select:!0})},S=function(k){if(b.paused||!c)return;const T=k.relatedTarget;T!==null&&(c.contains(T)||rc(m.current,{select:!0}))},C=function(k){if(document.activeElement===document.body)for(const I of k)I.removedNodes.length>0&&rc(c)};document.addEventListener("focusin",j),document.addEventListener("focusout",S);const A=new MutationObserver(C);return c&&A.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",j),document.removeEventListener("focusout",S),A.disconnect()}}},[r,c,b.paused]),y.useEffect(()=>{if(c){WD.add(b);const j=document.activeElement;if(!c.contains(j)){const C=new CustomEvent(C2,VD);c.addEventListener(C2,u),c.dispatchEvent(C),C.defaultPrevented||($4e(W4e(YW(c)),{select:!0}),document.activeElement===j&&rc(c))}return()=>{c.removeEventListener(C2,u),setTimeout(()=>{const C=new CustomEvent(A2,VD);c.addEventListener(A2,h),c.dispatchEvent(C),C.defaultPrevented||rc(j??document.body,{select:!0}),c.removeEventListener(A2,h),WD.remove(b)},0)}}},[c,u,h,b]);const w=y.useCallback(j=>{if(!s&&!r||b.paused)return;const S=j.key==="Tab"&&!j.altKey&&!j.ctrlKey&&!j.metaKey,C=document.activeElement;if(S&&C){const A=j.currentTarget,[k,T]=z4e(A);k&&T?!j.shiftKey&&C===T?(j.preventDefault(),s&&rc(k,{select:!0})):j.shiftKey&&C===k&&(j.preventDefault(),s&&rc(T,{select:!0})):C===A&&j.preventDefault()}},[s,r,b.paused]);return a.jsx(Yt.div,{tabIndex:-1,...o,ref:x,onKeyDown:w})});FE.displayName=F4e;function $4e(t,{select:n=!1}={}){const s=document.activeElement;for(const r of t)if(rc(r,{select:n}),document.activeElement!==s)return}function z4e(t){const n=YW(t),s=HD(n,t),r=HD(n.reverse(),t);return[s,r]}function YW(t){const n=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)n.push(s.currentNode);return n}function HD(t,n){for(const s of t)if(!U4e(s,{upTo:n}))return s}function U4e(t,{upTo:n}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n!==void 0&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function V4e(t){return t instanceof HTMLInputElement&&"select"in t}function rc(t,{select:n=!1}={}){if(t&&t.focus){const s=document.activeElement;t.focus({preventScroll:!0}),t!==s&&V4e(t)&&n&&t.select()}}var WD=H4e();function H4e(){let t=[];return{add(n){const s=t[0];n!==s&&(s==null||s.pause()),t=qD(t,n),t.unshift(n)},remove(n){var s;t=qD(t,n),(s=t[0])==null||s.resume()}}}function qD(t,n){const s=[...t],r=s.indexOf(n);return r!==-1&&s.splice(r,1),s}function W4e(t){return t.filter(n=>n.tagName!=="A")}const q4e=["top","right","bottom","left"],qc=Math.min,La=Math.max,Vy=Math.round,ig=Math.floor,Dl=t=>({x:t,y:t}),G4e={left:"right",right:"left",bottom:"top",top:"bottom"},K4e={start:"end",end:"start"};function Q_(t,n,s){return La(t,qc(n,s))}function Mo(t,n){return typeof t=="function"?t(n):t}function Oo(t){return t.split("-")[0]}function $h(t){return t.split("-")[1]}function $E(t){return t==="x"?"y":"x"}function zE(t){return t==="y"?"height":"width"}const Y4e=new Set(["top","bottom"]);function kl(t){return Y4e.has(Oo(t))?"y":"x"}function UE(t){return $E(kl(t))}function X4e(t,n,s){s===void 0&&(s=!1);const r=$h(t),i=UE(t),l=zE(i);let o=i==="x"?r===(s?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[l]>n.floating[l]&&(o=Hy(o)),[o,Hy(o)]}function Q4e(t){const n=Hy(t);return[Z_(t),n,Z_(n)]}function Z_(t){return t.replace(/start|end/g,n=>K4e[n])}const GD=["left","right"],KD=["right","left"],Z4e=["top","bottom"],J4e=["bottom","top"];function eIe(t,n,s){switch(t){case"top":case"bottom":return s?n?KD:GD:n?GD:KD;case"left":case"right":return n?Z4e:J4e;default:return[]}}function tIe(t,n,s,r){const i=$h(t);let l=eIe(Oo(t),s==="start",r);return i&&(l=l.map(o=>o+"-"+i),n&&(l=l.concat(l.map(Z_)))),l}function Hy(t){return t.replace(/left|right|bottom|top/g,n=>G4e[n])}function nIe(t){return{top:0,right:0,bottom:0,left:0,...t}}function XW(t){return typeof t!="number"?nIe(t):{top:t,right:t,bottom:t,left:t}}function Wy(t){const{x:n,y:s,width:r,height:i}=t;return{width:r,height:i,top:s,left:n,right:n+r,bottom:s+i,x:n,y:s}}function YD(t,n,s){let{reference:r,floating:i}=t;const l=kl(n),o=UE(n),c=zE(o),d=Oo(n),u=l==="y",h=r.x+r.width/2-i.width/2,m=r.y+r.height/2-i.height/2,x=r[c]/2-i[c]/2;let b;switch(d){case"top":b={x:h,y:r.y-i.height};break;case"bottom":b={x:h,y:r.y+r.height};break;case"right":b={x:r.x+r.width,y:m};break;case"left":b={x:r.x-i.width,y:m};break;default:b={x:r.x,y:r.y}}switch($h(n)){case"start":b[o]-=x*(s&&u?-1:1);break;case"end":b[o]+=x*(s&&u?-1:1);break}return b}const sIe=async(t,n,s)=>{const{placement:r="bottom",strategy:i="absolute",middleware:l=[],platform:o}=s,c=l.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(n));let u=await o.getElementRects({reference:t,floating:n,strategy:i}),{x:h,y:m}=YD(u,r,d),x=r,b={},w=0;for(let j=0;j<c.length;j++){const{name:S,fn:C}=c[j],{x:A,y:k,data:T,reset:I}=await C({x:h,y:m,initialPlacement:r,placement:x,strategy:i,middlewareData:b,rects:u,platform:o,elements:{reference:t,floating:n}});h=A??h,m=k??m,b={...b,[S]:{...b[S],...T}},I&&w<=50&&(w++,typeof I=="object"&&(I.placement&&(x=I.placement),I.rects&&(u=I.rects===!0?await o.getElementRects({reference:t,floating:n,strategy:i}):I.rects),{x:h,y:m}=YD(u,x,d)),j=-1)}return{x:h,y:m,placement:x,strategy:i,middlewareData:b}};async function lx(t,n){var s;n===void 0&&(n={});const{x:r,y:i,platform:l,rects:o,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:x=!1,padding:b=0}=Mo(n,t),w=XW(b),S=c[x?m==="floating"?"reference":"floating":m],C=Wy(await l.getClippingRect({element:(s=await(l.isElement==null?void 0:l.isElement(S)))==null||s?S:S.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(c.floating)),boundary:u,rootBoundary:h,strategy:d})),A=m==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,k=await(l.getOffsetParent==null?void 0:l.getOffsetParent(c.floating)),T=await(l.isElement==null?void 0:l.isElement(k))?await(l.getScale==null?void 0:l.getScale(k))||{x:1,y:1}:{x:1,y:1},I=Wy(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:A,offsetParent:k,strategy:d}):A);return{top:(C.top-I.top+w.top)/T.y,bottom:(I.bottom-C.bottom+w.bottom)/T.y,left:(C.left-I.left+w.left)/T.x,right:(I.right-C.right+w.right)/T.x}}const rIe=t=>({name:"arrow",options:t,async fn(n){const{x:s,y:r,placement:i,rects:l,platform:o,elements:c,middlewareData:d}=n,{element:u,padding:h=0}=Mo(t,n)||{};if(u==null)return{};const m=XW(h),x={x:s,y:r},b=UE(i),w=zE(b),j=await o.getDimensions(u),S=b==="y",C=S?"top":"left",A=S?"bottom":"right",k=S?"clientHeight":"clientWidth",T=l.reference[w]+l.reference[b]-x[b]-l.floating[w],I=x[b]-l.reference[b],D=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let O=D?D[k]:0;(!O||!await(o.isElement==null?void 0:o.isElement(D)))&&(O=c.floating[k]||l.floating[w]);const R=T/2-I/2,P=O/2-j[w]/2-1,L=qc(m[C],P),$=qc(m[A],P),B=L,V=O-j[w]-$,K=O/2-j[w]/2+R,z=Q_(B,K,V),H=!d.arrow&&$h(i)!=null&&K!==z&&l.reference[w]/2-(K<B?L:$)-j[w]/2<0,Y=H?K<B?K-B:K-V:0;return{[b]:x[b]+Y,data:{[b]:z,centerOffset:K-z-Y,...H&&{alignmentOffset:Y}},reset:H}}}),aIe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(n){var s,r;const{placement:i,middlewareData:l,rects:o,initialPlacement:c,platform:d,elements:u}=n,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:x,fallbackStrategy:b="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:j=!0,...S}=Mo(t,n);if((s=l.arrow)!=null&&s.alignmentOffset)return{};const C=Oo(i),A=kl(c),k=Oo(c)===c,T=await(d.isRTL==null?void 0:d.isRTL(u.floating)),I=x||(k||!j?[Hy(c)]:Q4e(c)),D=w!=="none";!x&&D&&I.push(...tIe(c,j,w,T));const O=[c,...I],R=await lx(n,S),P=[];let L=((r=l.flip)==null?void 0:r.overflows)||[];if(h&&P.push(R[C]),m){const K=X4e(i,o,T);P.push(R[K[0]],R[K[1]])}if(L=[...L,{placement:i,overflows:P}],!P.every(K=>K<=0)){var $,B;const K=((($=l.flip)==null?void 0:$.index)||0)+1,z=O[K];if(z&&(!(m==="alignment"?A!==kl(z):!1)||L.every(G=>kl(G.placement)===A?G.overflows[0]>0:!0)))return{data:{index:K,overflows:L},reset:{placement:z}};let H=(B=L.filter(Y=>Y.overflows[0]<=0).sort((Y,G)=>Y.overflows[1]-G.overflows[1])[0])==null?void 0:B.placement;if(!H)switch(b){case"bestFit":{var V;const Y=(V=L.filter(G=>{if(D){const J=kl(G.placement);return J===A||J==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(J=>J>0).reduce((J,ee)=>J+ee,0)]).sort((G,J)=>G[1]-J[1])[0])==null?void 0:V[0];Y&&(H=Y);break}case"initialPlacement":H=c;break}if(i!==H)return{reset:{placement:H}}}return{}}}};function XD(t,n){return{top:t.top-n.height,right:t.right-n.width,bottom:t.bottom-n.height,left:t.left-n.width}}function QD(t){return q4e.some(n=>t[n]>=0)}const iIe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(n){const{rects:s}=n,{strategy:r="referenceHidden",...i}=Mo(t,n);switch(r){case"referenceHidden":{const l=await lx(n,{...i,elementContext:"reference"}),o=XD(l,s.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:QD(o)}}}case"escaped":{const l=await lx(n,{...i,altBoundary:!0}),o=XD(l,s.floating);return{data:{escapedOffsets:o,escaped:QD(o)}}}default:return{}}}}},QW=new Set(["left","top"]);async function lIe(t,n){const{placement:s,platform:r,elements:i}=t,l=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Oo(s),c=$h(s),d=kl(s)==="y",u=QW.has(o)?-1:1,h=l&&d?-1:1,m=Mo(n,t);let{mainAxis:x,crossAxis:b,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof w=="number"&&(b=c==="end"?w*-1:w),d?{x:b*h,y:x*u}:{x:x*u,y:b*h}}const oIe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(n){var s,r;const{x:i,y:l,placement:o,middlewareData:c}=n,d=await lIe(n,t);return o===((s=c.offset)==null?void 0:s.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:i+d.x,y:l+d.y,data:{...d,placement:o}}}}},cIe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(n){const{x:s,y:r,placement:i}=n,{mainAxis:l=!0,crossAxis:o=!1,limiter:c={fn:S=>{let{x:C,y:A}=S;return{x:C,y:A}}},...d}=Mo(t,n),u={x:s,y:r},h=await lx(n,d),m=kl(Oo(i)),x=$E(m);let b=u[x],w=u[m];if(l){const S=x==="y"?"top":"left",C=x==="y"?"bottom":"right",A=b+h[S],k=b-h[C];b=Q_(A,b,k)}if(o){const S=m==="y"?"top":"left",C=m==="y"?"bottom":"right",A=w+h[S],k=w-h[C];w=Q_(A,w,k)}const j=c.fn({...n,[x]:b,[m]:w});return{...j,data:{x:j.x-s,y:j.y-r,enabled:{[x]:l,[m]:o}}}}}},dIe=function(t){return t===void 0&&(t={}),{options:t,fn(n){const{x:s,y:r,placement:i,rects:l,middlewareData:o}=n,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=Mo(t,n),h={x:s,y:r},m=kl(i),x=$E(m);let b=h[x],w=h[m];const j=Mo(c,n),S=typeof j=="number"?{mainAxis:j,crossAxis:0}:{mainAxis:0,crossAxis:0,...j};if(d){const k=x==="y"?"height":"width",T=l.reference[x]-l.floating[k]+S.mainAxis,I=l.reference[x]+l.reference[k]-S.mainAxis;b<T?b=T:b>I&&(b=I)}if(u){var C,A;const k=x==="y"?"width":"height",T=QW.has(Oo(i)),I=l.reference[m]-l.floating[k]+(T&&((C=o.offset)==null?void 0:C[m])||0)+(T?0:S.crossAxis),D=l.reference[m]+l.reference[k]+(T?0:((A=o.offset)==null?void 0:A[m])||0)-(T?S.crossAxis:0);w<I?w=I:w>D&&(w=D)}return{[x]:b,[m]:w}}}},uIe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(n){var s,r;const{placement:i,rects:l,platform:o,elements:c}=n,{apply:d=()=>{},...u}=Mo(t,n),h=await lx(n,u),m=Oo(i),x=$h(i),b=kl(i)==="y",{width:w,height:j}=l.floating;let S,C;m==="top"||m==="bottom"?(S=m,C=x===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(C=m,S=x==="end"?"top":"bottom");const A=j-h.top-h.bottom,k=w-h.left-h.right,T=qc(j-h[S],A),I=qc(w-h[C],k),D=!n.middlewareData.shift;let O=T,R=I;if((s=n.middlewareData.shift)!=null&&s.enabled.x&&(R=k),(r=n.middlewareData.shift)!=null&&r.enabled.y&&(O=A),D&&!x){const L=La(h.left,0),$=La(h.right,0),B=La(h.top,0),V=La(h.bottom,0);b?R=w-2*(L!==0||$!==0?L+$:La(h.left,h.right)):O=j-2*(B!==0||V!==0?B+V:La(h.top,h.bottom))}await d({...n,availableWidth:R,availableHeight:O});const P=await o.getDimensions(c.floating);return w!==P.width||j!==P.height?{reset:{rects:!0}}:{}}}};function Yv(){return typeof window<"u"}function zh(t){return ZW(t)?(t.nodeName||"").toLowerCase():"#document"}function Ga(t){var n;return(t==null||(n=t.ownerDocument)==null?void 0:n.defaultView)||window}function Kl(t){var n;return(n=(ZW(t)?t.ownerDocument:t.document)||window.document)==null?void 0:n.documentElement}function ZW(t){return Yv()?t instanceof Node||t instanceof Ga(t).Node:!1}function tl(t){return Yv()?t instanceof Element||t instanceof Ga(t).Element:!1}function Ul(t){return Yv()?t instanceof HTMLElement||t instanceof Ga(t).HTMLElement:!1}function ZD(t){return!Yv()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ga(t).ShadowRoot}const fIe=new Set(["inline","contents"]);function Gx(t){const{overflow:n,overflowX:s,overflowY:r,display:i}=nl(t);return/auto|scroll|overlay|hidden|clip/.test(n+r+s)&&!fIe.has(i)}const hIe=new Set(["table","td","th"]);function mIe(t){return hIe.has(zh(t))}const pIe=[":popover-open",":modal"];function Xv(t){return pIe.some(n=>{try{return t.matches(n)}catch{return!1}})}const xIe=["transform","translate","scale","rotate","perspective"],gIe=["transform","translate","scale","rotate","perspective","filter"],yIe=["paint","layout","strict","content"];function VE(t){const n=HE(),s=tl(t)?nl(t):t;return xIe.some(r=>s[r]?s[r]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!n&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!n&&(s.filter?s.filter!=="none":!1)||gIe.some(r=>(s.willChange||"").includes(r))||yIe.some(r=>(s.contain||"").includes(r))}function bIe(t){let n=Gc(t);for(;Ul(n)&&!fh(n);){if(VE(n))return n;if(Xv(n))return null;n=Gc(n)}return null}function HE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const vIe=new Set(["html","body","#document"]);function fh(t){return vIe.has(zh(t))}function nl(t){return Ga(t).getComputedStyle(t)}function Qv(t){return tl(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Gc(t){if(zh(t)==="html")return t;const n=t.assignedSlot||t.parentNode||ZD(t)&&t.host||Kl(t);return ZD(n)?n.host:n}function JW(t){const n=Gc(t);return fh(n)?t.ownerDocument?t.ownerDocument.body:t.body:Ul(n)&&Gx(n)?n:JW(n)}function ox(t,n,s){var r;n===void 0&&(n=[]),s===void 0&&(s=!0);const i=JW(t),l=i===((r=t.ownerDocument)==null?void 0:r.body),o=Ga(i);if(l){const c=J_(o);return n.concat(o,o.visualViewport||[],Gx(i)?i:[],c&&s?ox(c):[])}return n.concat(i,ox(i,[],s))}function J_(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function eq(t){const n=nl(t);let s=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const i=Ul(t),l=i?t.offsetWidth:s,o=i?t.offsetHeight:r,c=Vy(s)!==l||Vy(r)!==o;return c&&(s=l,r=o),{width:s,height:r,$:c}}function WE(t){return tl(t)?t:t.contextElement}function Ff(t){const n=WE(t);if(!Ul(n))return Dl(1);const s=n.getBoundingClientRect(),{width:r,height:i,$:l}=eq(n);let o=(l?Vy(s.width):s.width)/r,c=(l?Vy(s.height):s.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const wIe=Dl(0);function tq(t){const n=Ga(t);return!HE()||!n.visualViewport?wIe:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function NIe(t,n,s){return n===void 0&&(n=!1),!s||n&&s!==Ga(t)?!1:n}function Su(t,n,s,r){n===void 0&&(n=!1),s===void 0&&(s=!1);const i=t.getBoundingClientRect(),l=WE(t);let o=Dl(1);n&&(r?tl(r)&&(o=Ff(r)):o=Ff(t));const c=NIe(l,s,r)?tq(l):Dl(0);let d=(i.left+c.x)/o.x,u=(i.top+c.y)/o.y,h=i.width/o.x,m=i.height/o.y;if(l){const x=Ga(l),b=r&&tl(r)?Ga(r):r;let w=x,j=J_(w);for(;j&&r&&b!==w;){const S=Ff(j),C=j.getBoundingClientRect(),A=nl(j),k=C.left+(j.clientLeft+parseFloat(A.paddingLeft))*S.x,T=C.top+(j.clientTop+parseFloat(A.paddingTop))*S.y;d*=S.x,u*=S.y,h*=S.x,m*=S.y,d+=k,u+=T,w=Ga(j),j=J_(w)}}return Wy({width:h,height:m,x:d,y:u})}function Zv(t,n){const s=Qv(t).scrollLeft;return n?n.left+s:Su(Kl(t)).left+s}function nq(t,n){const s=t.getBoundingClientRect(),r=s.left+n.scrollLeft-Zv(t,s),i=s.top+n.scrollTop;return{x:r,y:i}}function jIe(t){let{elements:n,rect:s,offsetParent:r,strategy:i}=t;const l=i==="fixed",o=Kl(r),c=n?Xv(n.floating):!1;if(r===o||c&&l)return s;let d={scrollLeft:0,scrollTop:0},u=Dl(1);const h=Dl(0),m=Ul(r);if((m||!m&&!l)&&((zh(r)!=="body"||Gx(o))&&(d=Qv(r)),Ul(r))){const b=Su(r);u=Ff(r),h.x=b.x+r.clientLeft,h.y=b.y+r.clientTop}const x=o&&!m&&!l?nq(o,d):Dl(0);return{width:s.width*u.x,height:s.height*u.y,x:s.x*u.x-d.scrollLeft*u.x+h.x+x.x,y:s.y*u.y-d.scrollTop*u.y+h.y+x.y}}function SIe(t){return Array.from(t.getClientRects())}function _Ie(t){const n=Kl(t),s=Qv(t),r=t.ownerDocument.body,i=La(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),l=La(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let o=-s.scrollLeft+Zv(t);const c=-s.scrollTop;return nl(r).direction==="rtl"&&(o+=La(n.clientWidth,r.clientWidth)-i),{width:i,height:l,x:o,y:c}}const JD=25;function CIe(t,n){const s=Ga(t),r=Kl(t),i=s.visualViewport;let l=r.clientWidth,o=r.clientHeight,c=0,d=0;if(i){l=i.width,o=i.height;const h=HE();(!h||h&&n==="fixed")&&(c=i.offsetLeft,d=i.offsetTop)}const u=Zv(r);if(u<=0){const h=r.ownerDocument,m=h.body,x=getComputedStyle(m),b=h.compatMode==="CSS1Compat"&&parseFloat(x.marginLeft)+parseFloat(x.marginRight)||0,w=Math.abs(r.clientWidth-m.clientWidth-b);w<=JD&&(l-=w)}else u<=JD&&(l+=u);return{width:l,height:o,x:c,y:d}}const AIe=new Set(["absolute","fixed"]);function kIe(t,n){const s=Su(t,!0,n==="fixed"),r=s.top+t.clientTop,i=s.left+t.clientLeft,l=Ul(t)?Ff(t):Dl(1),o=t.clientWidth*l.x,c=t.clientHeight*l.y,d=i*l.x,u=r*l.y;return{width:o,height:c,x:d,y:u}}function eR(t,n,s){let r;if(n==="viewport")r=CIe(t,s);else if(n==="document")r=_Ie(Kl(t));else if(tl(n))r=kIe(n,s);else{const i=tq(t);r={x:n.x-i.x,y:n.y-i.y,width:n.width,height:n.height}}return Wy(r)}function sq(t,n){const s=Gc(t);return s===n||!tl(s)||fh(s)?!1:nl(s).position==="fixed"||sq(s,n)}function EIe(t,n){const s=n.get(t);if(s)return s;let r=ox(t,[],!1).filter(c=>tl(c)&&zh(c)!=="body"),i=null;const l=nl(t).position==="fixed";let o=l?Gc(t):t;for(;tl(o)&&!fh(o);){const c=nl(o),d=VE(o);!d&&c.position==="fixed"&&(i=null),(l?!d&&!i:!d&&c.position==="static"&&!!i&&AIe.has(i.position)||Gx(o)&&!d&&sq(t,o))?r=r.filter(h=>h!==o):i=c,o=Gc(o)}return n.set(t,r),r}function TIe(t){let{element:n,boundary:s,rootBoundary:r,strategy:i}=t;const o=[...s==="clippingAncestors"?Xv(n)?[]:EIe(n,this._c):[].concat(s),r],c=o[0],d=o.reduce((u,h)=>{const m=eR(n,h,i);return u.top=La(m.top,u.top),u.right=qc(m.right,u.right),u.bottom=qc(m.bottom,u.bottom),u.left=La(m.left,u.left),u},eR(n,c,i));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function IIe(t){const{width:n,height:s}=eq(t);return{width:n,height:s}}function PIe(t,n,s){const r=Ul(n),i=Kl(n),l=s==="fixed",o=Su(t,!0,l,n);let c={scrollLeft:0,scrollTop:0};const d=Dl(0);function u(){d.x=Zv(i)}if(r||!r&&!l)if((zh(n)!=="body"||Gx(i))&&(c=Qv(n)),r){const b=Su(n,!0,l,n);d.x=b.x+n.clientLeft,d.y=b.y+n.clientTop}else i&&u();l&&!r&&i&&u();const h=i&&!r&&!l?nq(i,c):Dl(0),m=o.left+c.scrollLeft-d.x-h.x,x=o.top+c.scrollTop-d.y-h.y;return{x:m,y:x,width:o.width,height:o.height}}function k2(t){return nl(t).position==="static"}function tR(t,n){if(!Ul(t)||nl(t).position==="fixed")return null;if(n)return n(t);let s=t.offsetParent;return Kl(t)===s&&(s=s.ownerDocument.body),s}function rq(t,n){const s=Ga(t);if(Xv(t))return s;if(!Ul(t)){let i=Gc(t);for(;i&&!fh(i);){if(tl(i)&&!k2(i))return i;i=Gc(i)}return s}let r=tR(t,n);for(;r&&mIe(r)&&k2(r);)r=tR(r,n);return r&&fh(r)&&k2(r)&&!VE(r)?s:r||bIe(t)||s}const MIe=async function(t){const n=this.getOffsetParent||rq,s=this.getDimensions,r=await s(t.floating);return{reference:PIe(t.reference,await n(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function OIe(t){return nl(t).direction==="rtl"}const DIe={convertOffsetParentRelativeRectToViewportRelativeRect:jIe,getDocumentElement:Kl,getClippingRect:TIe,getOffsetParent:rq,getElementRects:MIe,getClientRects:SIe,getDimensions:IIe,getScale:Ff,isElement:tl,isRTL:OIe};function aq(t,n){return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}function RIe(t,n){let s=null,r;const i=Kl(t);function l(){var c;clearTimeout(r),(c=s)==null||c.disconnect(),s=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),l();const u=t.getBoundingClientRect(),{left:h,top:m,width:x,height:b}=u;if(c||n(),!x||!b)return;const w=ig(m),j=ig(i.clientWidth-(h+x)),S=ig(i.clientHeight-(m+b)),C=ig(h),k={rootMargin:-w+"px "+-j+"px "+-S+"px "+-C+"px",threshold:La(0,qc(1,d))||1};let T=!0;function I(D){const O=D[0].intersectionRatio;if(O!==d){if(!T)return o();O?o(!1,O):r=setTimeout(()=>{o(!1,1e-7)},1e3)}O===1&&!aq(u,t.getBoundingClientRect())&&o(),T=!1}try{s=new IntersectionObserver(I,{...k,root:i.ownerDocument})}catch{s=new IntersectionObserver(I,k)}s.observe(t)}return o(!0),l}function LIe(t,n,s,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:l=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=r,u=WE(t),h=i||l?[...u?ox(u):[],...ox(n)]:[];h.forEach(C=>{i&&C.addEventListener("scroll",s,{passive:!0}),l&&C.addEventListener("resize",s)});const m=u&&c?RIe(u,s):null;let x=-1,b=null;o&&(b=new ResizeObserver(C=>{let[A]=C;A&&A.target===u&&b&&(b.unobserve(n),cancelAnimationFrame(x),x=requestAnimationFrame(()=>{var k;(k=b)==null||k.observe(n)})),s()}),u&&!d&&b.observe(u),b.observe(n));let w,j=d?Su(t):null;d&&S();function S(){const C=Su(t);j&&!aq(j,C)&&s(),j=C,w=requestAnimationFrame(S)}return s(),()=>{var C;h.forEach(A=>{i&&A.removeEventListener("scroll",s),l&&A.removeEventListener("resize",s)}),m==null||m(),(C=b)==null||C.disconnect(),b=null,d&&cancelAnimationFrame(w)}}const BIe=oIe,FIe=cIe,$Ie=aIe,zIe=uIe,UIe=iIe,nR=rIe,VIe=dIe,HIe=(t,n,s)=>{const r=new Map,i={platform:DIe,...s},l={...i.platform,_c:r};return sIe(t,n,{...i,platform:l})};var WIe=typeof document<"u",qIe=function(){},Kg=WIe?y.useLayoutEffect:qIe;function qy(t,n){if(t===n)return!0;if(typeof t!=typeof n)return!1;if(typeof t=="function"&&t.toString()===n.toString())return!0;let s,r,i;if(t&&n&&typeof t=="object"){if(Array.isArray(t)){if(s=t.length,s!==n.length)return!1;for(r=s;r--!==0;)if(!qy(t[r],n[r]))return!1;return!0}if(i=Object.keys(t),s=i.length,s!==Object.keys(n).length)return!1;for(r=s;r--!==0;)if(!{}.hasOwnProperty.call(n,i[r]))return!1;for(r=s;r--!==0;){const l=i[r];if(!(l==="_owner"&&t.$$typeof)&&!qy(t[l],n[l]))return!1}return!0}return t!==t&&n!==n}function iq(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function sR(t,n){const s=iq(t);return Math.round(n*s)/s}function E2(t){const n=y.useRef(t);return Kg(()=>{n.current=t}),n}function GIe(t){t===void 0&&(t={});const{placement:n="bottom",strategy:s="absolute",middleware:r=[],platform:i,elements:{reference:l,floating:o}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[h,m]=y.useState({x:0,y:0,strategy:s,placement:n,middlewareData:{},isPositioned:!1}),[x,b]=y.useState(r);qy(x,r)||b(r);const[w,j]=y.useState(null),[S,C]=y.useState(null),A=y.useCallback(G=>{G!==D.current&&(D.current=G,j(G))},[]),k=y.useCallback(G=>{G!==O.current&&(O.current=G,C(G))},[]),T=l||w,I=o||S,D=y.useRef(null),O=y.useRef(null),R=y.useRef(h),P=d!=null,L=E2(d),$=E2(i),B=E2(u),V=y.useCallback(()=>{if(!D.current||!O.current)return;const G={placement:n,strategy:s,middleware:x};$.current&&(G.platform=$.current),HIe(D.current,O.current,G).then(J=>{const ee={...J,isPositioned:B.current!==!1};K.current&&!qy(R.current,ee)&&(R.current=ee,Zc.flushSync(()=>{m(ee)}))})},[x,n,s,$,B]);Kg(()=>{u===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,m(G=>({...G,isPositioned:!1})))},[u]);const K=y.useRef(!1);Kg(()=>(K.current=!0,()=>{K.current=!1}),[]),Kg(()=>{if(T&&(D.current=T),I&&(O.current=I),T&&I){if(L.current)return L.current(T,I,V);V()}},[T,I,V,L,P]);const z=y.useMemo(()=>({reference:D,floating:O,setReference:A,setFloating:k}),[A,k]),H=y.useMemo(()=>({reference:T,floating:I}),[T,I]),Y=y.useMemo(()=>{const G={position:s,left:0,top:0};if(!H.floating)return G;const J=sR(H.floating,h.x),ee=sR(H.floating,h.y);return c?{...G,transform:"translate("+J+"px, "+ee+"px)",...iq(H.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:J,top:ee}},[s,c,H.floating,h.x,h.y]);return y.useMemo(()=>({...h,update:V,refs:z,elements:H,floatingStyles:Y}),[h,V,z,H,Y])}const KIe=t=>{function n(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:t,fn(s){const{element:r,padding:i}=typeof t=="function"?t(s):t;return r&&n(r)?r.current!=null?nR({element:r.current,padding:i}).fn(s):{}:r?nR({element:r,padding:i}).fn(s):{}}}},YIe=(t,n)=>({...BIe(t),options:[t,n]}),XIe=(t,n)=>({...FIe(t),options:[t,n]}),QIe=(t,n)=>({...VIe(t),options:[t,n]}),ZIe=(t,n)=>({...$Ie(t),options:[t,n]}),JIe=(t,n)=>({...zIe(t),options:[t,n]}),ePe=(t,n)=>({...UIe(t),options:[t,n]}),tPe=(t,n)=>({...KIe(t),options:[t,n]});var nPe="Arrow",lq=y.forwardRef((t,n)=>{const{children:s,width:r=10,height:i=5,...l}=t;return a.jsx(Yt.svg,{...l,ref:n,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?s:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});lq.displayName=nPe;var sPe=lq;function rPe(t){const[n,s]=y.useState(void 0);return Tr(()=>{if(t){s({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const l=i[0];let o,c;if("borderBoxSize"in l){const d=l.borderBoxSize,u=Array.isArray(d)?d[0]:d;o=u.inlineSize,c=u.blockSize}else o=t.offsetWidth,c=t.offsetHeight;s({width:o,height:c})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else s(void 0)},[t]),n}var qE="Popper",[oq,cq]=Du(qE),[aPe,dq]=oq(qE),uq=t=>{const{__scopePopper:n,children:s}=t,[r,i]=y.useState(null);return a.jsx(aPe,{scope:n,anchor:r,onAnchorChange:i,children:s})};uq.displayName=qE;var fq="PopperAnchor",hq=y.forwardRef((t,n)=>{const{__scopePopper:s,virtualRef:r,...i}=t,l=dq(fq,s),o=y.useRef(null),c=Sn(n,o),d=y.useRef(null);return y.useEffect(()=>{const u=d.current;d.current=(r==null?void 0:r.current)||o.current,u!==d.current&&l.onAnchorChange(d.current)}),r?null:a.jsx(Yt.div,{...i,ref:c})});hq.displayName=fq;var GE="PopperContent",[iPe,lPe]=oq(GE),mq=y.forwardRef((t,n)=>{var ce,Te,le,de,ge,ae;const{__scopePopper:s,side:r="bottom",sideOffset:i=0,align:l="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:h=0,sticky:m="partial",hideWhenDetached:x=!1,updatePositionStrategy:b="optimized",onPlaced:w,...j}=t,S=dq(GE,s),[C,A]=y.useState(null),k=Sn(n,Ve=>A(Ve)),[T,I]=y.useState(null),D=rPe(T),O=(D==null?void 0:D.width)??0,R=(D==null?void 0:D.height)??0,P=r+(l!=="center"?"-"+l:""),L=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},$=Array.isArray(u)?u:[u],B=$.length>0,V={padding:L,boundary:$.filter(cPe),altBoundary:B},{refs:K,floatingStyles:z,placement:H,isPositioned:Y,middlewareData:G}=GIe({strategy:"fixed",placement:P,whileElementsMounted:(...Ve)=>LIe(...Ve,{animationFrame:b==="always"}),elements:{reference:S.anchor},middleware:[YIe({mainAxis:i+R,alignmentAxis:o}),d&&XIe({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?QIe():void 0,...V}),d&&ZIe({...V}),JIe({...V,apply:({elements:Ve,rects:nt,availableWidth:wt,availableHeight:jt})=>{const{width:ct,height:Me}=nt.reference,qe=Ve.floating.style;qe.setProperty("--radix-popper-available-width",`${wt}px`),qe.setProperty("--radix-popper-available-height",`${jt}px`),qe.setProperty("--radix-popper-anchor-width",`${ct}px`),qe.setProperty("--radix-popper-anchor-height",`${Me}px`)}}),T&&tPe({element:T,padding:c}),dPe({arrowWidth:O,arrowHeight:R}),x&&ePe({strategy:"referenceHidden",...V})]}),[J,ee]=gq(H),ye=Jr(w);Tr(()=>{Y&&(ye==null||ye())},[Y,ye]);const ie=(ce=G.arrow)==null?void 0:ce.x,he=(Te=G.arrow)==null?void 0:Te.y,be=((le=G.arrow)==null?void 0:le.centerOffset)!==0,[we,Z]=y.useState();return Tr(()=>{C&&Z(window.getComputedStyle(C).zIndex)},[C]),a.jsx("div",{ref:K.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:Y?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:we,"--radix-popper-transform-origin":[(de=G.transformOrigin)==null?void 0:de.x,(ge=G.transformOrigin)==null?void 0:ge.y].join(" "),...((ae=G.hide)==null?void 0:ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(iPe,{scope:s,placedSide:J,onArrowChange:I,arrowX:ie,arrowY:he,shouldHideArrow:be,children:a.jsx(Yt.div,{"data-side":J,"data-align":ee,...j,ref:k,style:{...j.style,animation:Y?void 0:"none"}})})})});mq.displayName=GE;var pq="PopperArrow",oPe={top:"bottom",right:"left",bottom:"top",left:"right"},xq=y.forwardRef(function(n,s){const{__scopePopper:r,...i}=n,l=lPe(pq,r),o=oPe[l.placedSide];return a.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:a.jsx(sPe,{...i,ref:s,style:{...i.style,display:"block"}})})});xq.displayName=pq;function cPe(t){return t!==null}var dPe=t=>({name:"transformOrigin",options:t,fn(n){var S,C,A;const{placement:s,rects:r,middlewareData:i}=n,o=((S=i.arrow)==null?void 0:S.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[u,h]=gq(s),m={start:"0%",center:"50%",end:"100%"}[h],x=(((C=i.arrow)==null?void 0:C.x)??0)+c/2,b=(((A=i.arrow)==null?void 0:A.y)??0)+d/2;let w="",j="";return u==="bottom"?(w=o?m:`${x}px`,j=`${-d}px`):u==="top"?(w=o?m:`${x}px`,j=`${r.floating.height+d}px`):u==="right"?(w=`${-d}px`,j=o?m:`${b}px`):u==="left"&&(w=`${r.floating.width+d}px`,j=o?m:`${b}px`),{data:{x:w,y:j}}}});function gq(t){const[n,s="center"]=t.split("-");return[n,s]}var uPe=uq,fPe=hq,hPe=mq,mPe=xq,pPe="Portal",KE=y.forwardRef((t,n)=>{var c;const{container:s,...r}=t,[i,l]=y.useState(!1);Tr(()=>l(!0),[]);const o=s||i&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?oL.createPortal(a.jsx(Yt.div,{...r,ref:n}),o):null});KE.displayName=pPe;function xPe(t){const n=y.useRef({value:t,previous:t});return y.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var yq=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),gPe="VisuallyHidden",yPe=y.forwardRef((t,n)=>a.jsx(Yt.span,{...t,ref:n,style:{...yq,...t.style}}));yPe.displayName=gPe;var bPe=function(t){if(typeof document>"u")return null;var n=Array.isArray(t)?t[0]:t;return n.ownerDocument.body},Ju=new WeakMap,lg=new WeakMap,og={},T2=0,bq=function(t){return t&&(t.host||bq(t.parentNode))},vPe=function(t,n){return n.map(function(s){if(t.contains(s))return s;var r=bq(s);return r&&t.contains(r)?r:(console.error("aria-hidden",s,"in not contained inside",t,". Doing nothing"),null)}).filter(function(s){return!!s})},wPe=function(t,n,s,r){var i=vPe(n,Array.isArray(t)?t:[t]);og[s]||(og[s]=new WeakMap);var l=og[s],o=[],c=new Set,d=new Set(i),u=function(m){!m||c.has(m)||(c.add(m),u(m.parentNode))};i.forEach(u);var h=function(m){!m||d.has(m)||Array.prototype.forEach.call(m.children,function(x){if(c.has(x))h(x);else try{var b=x.getAttribute(r),w=b!==null&&b!=="false",j=(Ju.get(x)||0)+1,S=(l.get(x)||0)+1;Ju.set(x,j),l.set(x,S),o.push(x),j===1&&w&&lg.set(x,!0),S===1&&x.setAttribute(s,"true"),w||x.setAttribute(r,"true")}catch(C){console.error("aria-hidden: cannot operate on ",x,C)}})};return h(n),c.clear(),T2++,function(){o.forEach(function(m){var x=Ju.get(m)-1,b=l.get(m)-1;Ju.set(m,x),l.set(m,b),x||(lg.has(m)||m.removeAttribute(r),lg.delete(m)),b||m.removeAttribute(s)}),T2--,T2||(Ju=new WeakMap,Ju=new WeakMap,lg=new WeakMap,og={})}},vq=function(t,n,s){s===void 0&&(s="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=bPe(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live], script"))),wPe(r,i,s,"aria-hidden")):function(){return null}},Sl=function(){return Sl=Object.assign||function(n){for(var s,r=1,i=arguments.length;r<i;r++){s=arguments[r];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(n[l]=s[l])}return n},Sl.apply(this,arguments)};function wq(t,n){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(s[r[i]]=t[r[i]]);return s}function NPe(t,n,s){if(s||arguments.length===2)for(var r=0,i=n.length,l;r<i;r++)(l||!(r in n))&&(l||(l=Array.prototype.slice.call(n,0,r)),l[r]=n[r]);return t.concat(l||Array.prototype.slice.call(n))}var Yg="right-scroll-bar-position",Xg="width-before-scroll-bar",jPe="with-scroll-bars-hidden",SPe="--removed-body-scroll-bar-size";function I2(t,n){return typeof t=="function"?t(n):t&&(t.current=n),t}function _Pe(t,n){var s=y.useState(function(){return{value:t,callback:n,facade:{get current(){return s.value},set current(r){var i=s.value;i!==r&&(s.value=r,s.callback(r,i))}}}})[0];return s.callback=n,s.facade}var CPe=typeof window<"u"?y.useLayoutEffect:y.useEffect,rR=new WeakMap;function APe(t,n){var s=_Pe(null,function(r){return t.forEach(function(i){return I2(i,r)})});return CPe(function(){var r=rR.get(s);if(r){var i=new Set(r),l=new Set(t),o=s.current;i.forEach(function(c){l.has(c)||I2(c,null)}),l.forEach(function(c){i.has(c)||I2(c,o)})}rR.set(s,t)},[t]),s}function kPe(t){return t}function EPe(t,n){n===void 0&&(n=kPe);var s=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:t},useMedium:function(l){var o=n(l,r);return s.push(o),function(){s=s.filter(function(c){return c!==o})}},assignSyncMedium:function(l){for(r=!0;s.length;){var o=s;s=[],o.forEach(l)}s={push:function(c){return l(c)},filter:function(){return s}}},assignMedium:function(l){r=!0;var o=[];if(s.length){var c=s;s=[],c.forEach(l),o=s}var d=function(){var h=o;o=[],h.forEach(l)},u=function(){return Promise.resolve().then(d)};u(),s={push:function(h){o.push(h),u()},filter:function(h){return o=o.filter(h),s}}}};return i}function TPe(t){t===void 0&&(t={});var n=EPe(null);return n.options=Sl({async:!0,ssr:!1},t),n}var Nq=function(t){var n=t.sideCar,s=wq(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=n.read();if(!r)throw new Error("Sidecar medium not found");return y.createElement(r,Sl({},s))};Nq.isSideCarExport=!0;function IPe(t,n){return t.useMedium(n),Nq}var jq=TPe(),P2=function(){},Jv=y.forwardRef(function(t,n){var s=y.useRef(null),r=y.useState({onScrollCapture:P2,onWheelCapture:P2,onTouchMoveCapture:P2}),i=r[0],l=r[1],o=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,h=t.enabled,m=t.shards,x=t.sideCar,b=t.noRelative,w=t.noIsolation,j=t.inert,S=t.allowPinchZoom,C=t.as,A=C===void 0?"div":C,k=t.gapMode,T=wq(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),I=x,D=APe([s,n]),O=Sl(Sl({},T),i);return y.createElement(y.Fragment,null,h&&y.createElement(I,{sideCar:jq,removeScrollBar:u,shards:m,noRelative:b,noIsolation:w,inert:j,setCallbacks:l,allowPinchZoom:!!S,lockRef:s,gapMode:k}),o?y.cloneElement(y.Children.only(c),Sl(Sl({},O),{ref:D})):y.createElement(A,Sl({},O,{className:d,ref:D}),c))});Jv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Jv.classNames={fullWidth:Xg,zeroRight:Yg};var PPe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function MPe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var n=PPe();return n&&t.setAttribute("nonce",n),t}function OPe(t,n){t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}function DPe(t){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(t)}var RPe=function(){var t=0,n=null;return{add:function(s){t==0&&(n=MPe())&&(OPe(n,s),DPe(n)),t++},remove:function(){t--,!t&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},LPe=function(){var t=RPe();return function(n,s){y.useEffect(function(){return t.add(n),function(){t.remove()}},[n&&s])}},Sq=function(){var t=LPe(),n=function(s){var r=s.styles,i=s.dynamic;return t(r,i),null};return n},BPe={left:0,top:0,right:0,gap:0},M2=function(t){return parseInt(t||"",10)||0},FPe=function(t){var n=window.getComputedStyle(document.body),s=n[t==="padding"?"paddingLeft":"marginLeft"],r=n[t==="padding"?"paddingTop":"marginTop"],i=n[t==="padding"?"paddingRight":"marginRight"];return[M2(s),M2(r),M2(i)]},$Pe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return BPe;var n=FPe(t),s=document.documentElement.clientWidth,r=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,r-s+n[2]-n[0])}},zPe=Sq(),$f="data-scroll-locked",UPe=function(t,n,s,r){var i=t.left,l=t.top,o=t.right,c=t.gap;return s===void 0&&(s="margin"),`
  .`.concat(jPe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(c,"px ").concat(r,`;
  }
  body[`).concat($f,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(r,";"),s==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(r,`;
    `),s==="padding"&&"padding-right: ".concat(c,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Yg,` {
    right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Xg,` {
    margin-right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Yg," .").concat(Yg,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Xg," .").concat(Xg,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat($f,`] {
    `).concat(SPe,": ").concat(c,`px;
  }
`)},aR=function(){var t=parseInt(document.body.getAttribute($f)||"0",10);return isFinite(t)?t:0},VPe=function(){y.useEffect(function(){return document.body.setAttribute($f,(aR()+1).toString()),function(){var t=aR()-1;t<=0?document.body.removeAttribute($f):document.body.setAttribute($f,t.toString())}},[])},HPe=function(t){var n=t.noRelative,s=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;VPe();var l=y.useMemo(function(){return $Pe(i)},[i]);return y.createElement(zPe,{styles:UPe(l,!n,i,s?"":"!important")})},eC=!1;if(typeof window<"u")try{var cg=Object.defineProperty({},"passive",{get:function(){return eC=!0,!0}});window.addEventListener("test",cg,cg),window.removeEventListener("test",cg,cg)}catch{eC=!1}var ef=eC?{passive:!1}:!1,WPe=function(t){return t.tagName==="TEXTAREA"},_q=function(t,n){if(!(t instanceof Element))return!1;var s=window.getComputedStyle(t);return s[n]!=="hidden"&&!(s.overflowY===s.overflowX&&!WPe(t)&&s[n]==="visible")},qPe=function(t){return _q(t,"overflowY")},GPe=function(t){return _q(t,"overflowX")},iR=function(t,n){var s=n.ownerDocument,r=n;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=Cq(t,r);if(i){var l=Aq(t,r),o=l[1],c=l[2];if(o>c)return!0}r=r.parentNode}while(r&&r!==s.body);return!1},KPe=function(t){var n=t.scrollTop,s=t.scrollHeight,r=t.clientHeight;return[n,s,r]},YPe=function(t){var n=t.scrollLeft,s=t.scrollWidth,r=t.clientWidth;return[n,s,r]},Cq=function(t,n){return t==="v"?qPe(n):GPe(n)},Aq=function(t,n){return t==="v"?KPe(n):YPe(n)},XPe=function(t,n){return t==="h"&&n==="rtl"?-1:1},QPe=function(t,n,s,r,i){var l=XPe(t,window.getComputedStyle(n).direction),o=l*r,c=s.target,d=n.contains(c),u=!1,h=o>0,m=0,x=0;do{if(!c)break;var b=Aq(t,c),w=b[0],j=b[1],S=b[2],C=j-S-l*w;(w||C)&&Cq(t,c)&&(m+=C,x+=w);var A=c.parentNode;c=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!d&&c!==document.body||d&&(n.contains(c)||n===c));return(h&&Math.abs(m)<1||!h&&Math.abs(x)<1)&&(u=!0),u},dg=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},lR=function(t){return[t.deltaX,t.deltaY]},oR=function(t){return t&&"current"in t?t.current:t},ZPe=function(t,n){return t[0]===n[0]&&t[1]===n[1]},JPe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},eMe=0,tf=[];function tMe(t){var n=y.useRef([]),s=y.useRef([0,0]),r=y.useRef(),i=y.useState(eMe++)[0],l=y.useState(Sq)[0],o=y.useRef(t);y.useEffect(function(){o.current=t},[t]),y.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var j=NPe([t.lockRef.current],(t.shards||[]).map(oR),!0).filter(Boolean);return j.forEach(function(S){return S.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),j.forEach(function(S){return S.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var c=y.useCallback(function(j,S){if("touches"in j&&j.touches.length===2||j.type==="wheel"&&j.ctrlKey)return!o.current.allowPinchZoom;var C=dg(j),A=s.current,k="deltaX"in j?j.deltaX:A[0]-C[0],T="deltaY"in j?j.deltaY:A[1]-C[1],I,D=j.target,O=Math.abs(k)>Math.abs(T)?"h":"v";if("touches"in j&&O==="h"&&D.type==="range")return!1;var R=iR(O,D);if(!R)return!0;if(R?I=O:(I=O==="v"?"h":"v",R=iR(O,D)),!R)return!1;if(!r.current&&"changedTouches"in j&&(k||T)&&(r.current=I),!I)return!0;var P=r.current||I;return QPe(P,S,j,P==="h"?k:T)},[]),d=y.useCallback(function(j){var S=j;if(!(!tf.length||tf[tf.length-1]!==l)){var C="deltaY"in S?lR(S):dg(S),A=n.current.filter(function(I){return I.name===S.type&&(I.target===S.target||S.target===I.shadowParent)&&ZPe(I.delta,C)})[0];if(A&&A.should){S.cancelable&&S.preventDefault();return}if(!A){var k=(o.current.shards||[]).map(oR).filter(Boolean).filter(function(I){return I.contains(S.target)}),T=k.length>0?c(S,k[0]):!o.current.noIsolation;T&&S.cancelable&&S.preventDefault()}}},[]),u=y.useCallback(function(j,S,C,A){var k={name:j,delta:S,target:C,should:A,shadowParent:nMe(C)};n.current.push(k),setTimeout(function(){n.current=n.current.filter(function(T){return T!==k})},1)},[]),h=y.useCallback(function(j){s.current=dg(j),r.current=void 0},[]),m=y.useCallback(function(j){u(j.type,lR(j),j.target,c(j,t.lockRef.current))},[]),x=y.useCallback(function(j){u(j.type,dg(j),j.target,c(j,t.lockRef.current))},[]);y.useEffect(function(){return tf.push(l),t.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:x}),document.addEventListener("wheel",d,ef),document.addEventListener("touchmove",d,ef),document.addEventListener("touchstart",h,ef),function(){tf=tf.filter(function(j){return j!==l}),document.removeEventListener("wheel",d,ef),document.removeEventListener("touchmove",d,ef),document.removeEventListener("touchstart",h,ef)}},[]);var b=t.removeScrollBar,w=t.inert;return y.createElement(y.Fragment,null,w?y.createElement(l,{styles:JPe(i)}):null,b?y.createElement(HPe,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function nMe(t){for(var n=null;t!==null;)t instanceof ShadowRoot&&(n=t.host,t=t.host),t=t.parentNode;return n}const sMe=IPe(jq,tMe);var YE=y.forwardRef(function(t,n){return y.createElement(Jv,Sl({},t,{ref:n,sideCar:sMe}))});YE.classNames=Jv.classNames;var rMe=[" ","Enter","ArrowUp","ArrowDown"],aMe=[" ","Enter"],_u="Select",[ew,tw,iMe]=S$(_u),[Uh]=Du(_u,[iMe,cq]),nw=cq(),[lMe,od]=Uh(_u),[oMe,cMe]=Uh(_u),kq=t=>{const{__scopeSelect:n,children:s,open:r,defaultOpen:i,onOpenChange:l,value:o,defaultValue:c,onValueChange:d,dir:u,name:h,autoComplete:m,disabled:x,required:b,form:w}=t,j=nw(n),[S,C]=y.useState(null),[A,k]=y.useState(null),[T,I]=y.useState(!1),D=Gb(u),[O,R]=Wp({prop:r,defaultProp:i??!1,onChange:l,caller:_u}),[P,L]=Wp({prop:o,defaultProp:c,onChange:d,caller:_u}),$=y.useRef(null),B=S?w||!!S.closest("form"):!0,[V,K]=y.useState(new Set),z=Array.from(V).map(H=>H.props.value).join(";");return a.jsx(uPe,{...j,children:a.jsxs(lMe,{required:b,scope:n,trigger:S,onTriggerChange:C,valueNode:A,onValueNodeChange:k,valueNodeHasChildren:T,onValueNodeHasChildrenChange:I,contentId:Pc(),value:P,onValueChange:L,open:O,onOpenChange:R,dir:D,triggerPointerDownPosRef:$,disabled:x,children:[a.jsx(ew.Provider,{scope:n,children:a.jsx(oMe,{scope:t.__scopeSelect,onNativeOptionAdd:y.useCallback(H=>{K(Y=>new Set(Y).add(H))},[]),onNativeOptionRemove:y.useCallback(H=>{K(Y=>{const G=new Set(Y);return G.delete(H),G})},[]),children:s})}),B?a.jsxs(Zq,{"aria-hidden":!0,required:b,tabIndex:-1,name:h,autoComplete:m,value:P,onChange:H=>L(H.target.value),disabled:x,form:w,children:[P===void 0?a.jsx("option",{value:""}):null,Array.from(V)]},z):null]})})};kq.displayName=_u;var Eq="SelectTrigger",Tq=y.forwardRef((t,n)=>{const{__scopeSelect:s,disabled:r=!1,...i}=t,l=nw(s),o=od(Eq,s),c=o.disabled||r,d=Sn(n,o.onTriggerChange),u=tw(s),h=y.useRef("touch"),[m,x,b]=eG(j=>{const S=u().filter(k=>!k.disabled),C=S.find(k=>k.value===o.value),A=tG(S,j,C);A!==void 0&&o.onValueChange(A.value)}),w=j=>{c||(o.onOpenChange(!0),b()),j&&(o.triggerPointerDownPosRef.current={x:Math.round(j.pageX),y:Math.round(j.pageY)})};return a.jsx(fPe,{asChild:!0,...l,children:a.jsx(Yt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":Jq(o.value)?"":void 0,...i,ref:d,onClick:Vt(i.onClick,j=>{j.currentTarget.focus(),h.current!=="mouse"&&w(j)}),onPointerDown:Vt(i.onPointerDown,j=>{h.current=j.pointerType;const S=j.target;S.hasPointerCapture(j.pointerId)&&S.releasePointerCapture(j.pointerId),j.button===0&&j.ctrlKey===!1&&j.pointerType==="mouse"&&(w(j),j.preventDefault())}),onKeyDown:Vt(i.onKeyDown,j=>{const S=m.current!=="";!(j.ctrlKey||j.altKey||j.metaKey)&&j.key.length===1&&x(j.key),!(S&&j.key===" ")&&rMe.includes(j.key)&&(w(),j.preventDefault())})})})});Tq.displayName=Eq;var Iq="SelectValue",Pq=y.forwardRef((t,n)=>{const{__scopeSelect:s,className:r,style:i,children:l,placeholder:o="",...c}=t,d=od(Iq,s),{onValueNodeHasChildrenChange:u}=d,h=l!==void 0,m=Sn(n,d.onValueNodeChange);return Tr(()=>{u(h)},[u,h]),a.jsx(Yt.span,{...c,ref:m,style:{pointerEvents:"none"},children:Jq(d.value)?a.jsx(a.Fragment,{children:o}):l})});Pq.displayName=Iq;var dMe="SelectIcon",Mq=y.forwardRef((t,n)=>{const{__scopeSelect:s,children:r,...i}=t;return a.jsx(Yt.span,{"aria-hidden":!0,...i,ref:n,children:r||""})});Mq.displayName=dMe;var uMe="SelectPortal",Oq=t=>a.jsx(KE,{asChild:!0,...t});Oq.displayName=uMe;var Cu="SelectContent",Dq=y.forwardRef((t,n)=>{const s=od(Cu,t.__scopeSelect),[r,i]=y.useState();if(Tr(()=>{i(new DocumentFragment)},[]),!s.open){const l=r;return l?Zc.createPortal(a.jsx(Rq,{scope:t.__scopeSelect,children:a.jsx(ew.Slot,{scope:t.__scopeSelect,children:a.jsx("div",{children:t.children})})}),l):null}return a.jsx(Lq,{...t,ref:n})});Dq.displayName=Cu;var $i=10,[Rq,cd]=Uh(Cu),fMe="SelectContentImpl",hMe=Jf("SelectContent.RemoveScroll"),Lq=y.forwardRef((t,n)=>{const{__scopeSelect:s,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:l,onPointerDownOutside:o,side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:m,collisionBoundary:x,collisionPadding:b,sticky:w,hideWhenDetached:j,avoidCollisions:S,...C}=t,A=od(Cu,s),[k,T]=y.useState(null),[I,D]=y.useState(null),O=Sn(n,ce=>T(ce)),[R,P]=y.useState(null),[L,$]=y.useState(null),B=tw(s),[V,K]=y.useState(!1),z=y.useRef(!1);y.useEffect(()=>{if(k)return vq(k)},[k]),KW();const H=y.useCallback(ce=>{const[Te,...le]=B().map(ae=>ae.ref.current),[de]=le.slice(-1),ge=document.activeElement;for(const ae of ce)if(ae===ge||(ae==null||ae.scrollIntoView({block:"nearest"}),ae===Te&&I&&(I.scrollTop=0),ae===de&&I&&(I.scrollTop=I.scrollHeight),ae==null||ae.focus(),document.activeElement!==ge))return},[B,I]),Y=y.useCallback(()=>H([R,k]),[H,R,k]);y.useEffect(()=>{V&&Y()},[V,Y]);const{onOpenChange:G,triggerPointerDownPosRef:J}=A;y.useEffect(()=>{if(k){let ce={x:0,y:0};const Te=de=>{var ge,ae;ce={x:Math.abs(Math.round(de.pageX)-(((ge=J.current)==null?void 0:ge.x)??0)),y:Math.abs(Math.round(de.pageY)-(((ae=J.current)==null?void 0:ae.y)??0))}},le=de=>{ce.x<=10&&ce.y<=10?de.preventDefault():k.contains(de.target)||G(!1),document.removeEventListener("pointermove",Te),J.current=null};return J.current!==null&&(document.addEventListener("pointermove",Te),document.addEventListener("pointerup",le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Te),document.removeEventListener("pointerup",le,{capture:!0})}}},[k,G,J]),y.useEffect(()=>{const ce=()=>G(!1);return window.addEventListener("blur",ce),window.addEventListener("resize",ce),()=>{window.removeEventListener("blur",ce),window.removeEventListener("resize",ce)}},[G]);const[ee,ye]=eG(ce=>{const Te=B().filter(ge=>!ge.disabled),le=Te.find(ge=>ge.ref.current===document.activeElement),de=tG(Te,ce,le);de&&setTimeout(()=>de.ref.current.focus())}),ie=y.useCallback((ce,Te,le)=>{const de=!z.current&&!le;(A.value!==void 0&&A.value===Te||de)&&(P(ce),de&&(z.current=!0))},[A.value]),he=y.useCallback(()=>k==null?void 0:k.focus(),[k]),be=y.useCallback((ce,Te,le)=>{const de=!z.current&&!le;(A.value!==void 0&&A.value===Te||de)&&$(ce)},[A.value]),we=r==="popper"?tC:Bq,Z=we===tC?{side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:m,collisionBoundary:x,collisionPadding:b,sticky:w,hideWhenDetached:j,avoidCollisions:S}:{};return a.jsx(Rq,{scope:s,content:k,viewport:I,onViewportChange:D,itemRefCallback:ie,selectedItem:R,onItemLeave:he,itemTextRefCallback:be,focusSelectedItem:Y,selectedItemText:L,position:r,isPositioned:V,searchRef:ee,children:a.jsx(YE,{as:hMe,allowPinchZoom:!0,children:a.jsx(FE,{asChild:!0,trapped:A.open,onMountAutoFocus:ce=>{ce.preventDefault()},onUnmountAutoFocus:Vt(i,ce=>{var Te;(Te=A.trigger)==null||Te.focus({preventScroll:!0}),ce.preventDefault()}),children:a.jsx(BE,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:o,onFocusOutside:ce=>ce.preventDefault(),onDismiss:()=>A.onOpenChange(!1),children:a.jsx(we,{role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:ce=>ce.preventDefault(),...C,...Z,onPlaced:()=>K(!0),ref:O,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:Vt(C.onKeyDown,ce=>{const Te=ce.ctrlKey||ce.altKey||ce.metaKey;if(ce.key==="Tab"&&ce.preventDefault(),!Te&&ce.key.length===1&&ye(ce.key),["ArrowUp","ArrowDown","Home","End"].includes(ce.key)){let de=B().filter(ge=>!ge.disabled).map(ge=>ge.ref.current);if(["ArrowUp","End"].includes(ce.key)&&(de=de.slice().reverse()),["ArrowUp","ArrowDown"].includes(ce.key)){const ge=ce.target,ae=de.indexOf(ge);de=de.slice(ae+1)}setTimeout(()=>H(de)),ce.preventDefault()}})})})})})})});Lq.displayName=fMe;var mMe="SelectItemAlignedPosition",Bq=y.forwardRef((t,n)=>{const{__scopeSelect:s,onPlaced:r,...i}=t,l=od(Cu,s),o=cd(Cu,s),[c,d]=y.useState(null),[u,h]=y.useState(null),m=Sn(n,O=>h(O)),x=tw(s),b=y.useRef(!1),w=y.useRef(!0),{viewport:j,selectedItem:S,selectedItemText:C,focusSelectedItem:A}=o,k=y.useCallback(()=>{if(l.trigger&&l.valueNode&&c&&u&&j&&S&&C){const O=l.trigger.getBoundingClientRect(),R=u.getBoundingClientRect(),P=l.valueNode.getBoundingClientRect(),L=C.getBoundingClientRect();if(l.dir!=="rtl"){const ge=L.left-R.left,ae=P.left-ge,Ve=O.left-ae,nt=O.width+Ve,wt=Math.max(nt,R.width),jt=window.innerWidth-$i,ct=Y_(ae,[$i,Math.max($i,jt-wt)]);c.style.minWidth=nt+"px",c.style.left=ct+"px"}else{const ge=R.right-L.right,ae=window.innerWidth-P.right-ge,Ve=window.innerWidth-O.right-ae,nt=O.width+Ve,wt=Math.max(nt,R.width),jt=window.innerWidth-$i,ct=Y_(ae,[$i,Math.max($i,jt-wt)]);c.style.minWidth=nt+"px",c.style.right=ct+"px"}const $=x(),B=window.innerHeight-$i*2,V=j.scrollHeight,K=window.getComputedStyle(u),z=parseInt(K.borderTopWidth,10),H=parseInt(K.paddingTop,10),Y=parseInt(K.borderBottomWidth,10),G=parseInt(K.paddingBottom,10),J=z+H+V+G+Y,ee=Math.min(S.offsetHeight*5,J),ye=window.getComputedStyle(j),ie=parseInt(ye.paddingTop,10),he=parseInt(ye.paddingBottom,10),be=O.top+O.height/2-$i,we=B-be,Z=S.offsetHeight/2,ce=S.offsetTop+Z,Te=z+H+ce,le=J-Te;if(Te<=be){const ge=$.length>0&&S===$[$.length-1].ref.current;c.style.bottom="0px";const ae=u.clientHeight-j.offsetTop-j.offsetHeight,Ve=Math.max(we,Z+(ge?he:0)+ae+Y),nt=Te+Ve;c.style.height=nt+"px"}else{const ge=$.length>0&&S===$[0].ref.current;c.style.top="0px";const Ve=Math.max(be,z+j.offsetTop+(ge?ie:0)+Z)+le;c.style.height=Ve+"px",j.scrollTop=Te-be+j.offsetTop}c.style.margin=`${$i}px 0`,c.style.minHeight=ee+"px",c.style.maxHeight=B+"px",r==null||r(),requestAnimationFrame(()=>b.current=!0)}},[x,l.trigger,l.valueNode,c,u,j,S,C,l.dir,r]);Tr(()=>k(),[k]);const[T,I]=y.useState();Tr(()=>{u&&I(window.getComputedStyle(u).zIndex)},[u]);const D=y.useCallback(O=>{O&&w.current===!0&&(k(),A==null||A(),w.current=!1)},[k,A]);return a.jsx(xMe,{scope:s,contentWrapper:c,shouldExpandOnScrollRef:b,onScrollButtonChange:D,children:a.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:a.jsx(Yt.div,{...i,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Bq.displayName=mMe;var pMe="SelectPopperPosition",tC=y.forwardRef((t,n)=>{const{__scopeSelect:s,align:r="start",collisionPadding:i=$i,...l}=t,o=nw(s);return a.jsx(hPe,{...o,...l,ref:n,align:r,collisionPadding:i,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});tC.displayName=pMe;var[xMe,XE]=Uh(Cu,{}),nC="SelectViewport",Fq=y.forwardRef((t,n)=>{const{__scopeSelect:s,nonce:r,...i}=t,l=cd(nC,s),o=XE(nC,s),c=Sn(n,l.onViewportChange),d=y.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),a.jsx(ew.Slot,{scope:s,children:a.jsx(Yt.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Vt(i.onScroll,u=>{const h=u.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:x}=o;if(x!=null&&x.current&&m){const b=Math.abs(d.current-h.scrollTop);if(b>0){const w=window.innerHeight-$i*2,j=parseFloat(m.style.minHeight),S=parseFloat(m.style.height),C=Math.max(j,S);if(C<w){const A=C+b,k=Math.min(w,A),T=A-k;m.style.height=k+"px",m.style.bottom==="0px"&&(h.scrollTop=T>0?T:0,m.style.justifyContent="flex-end")}}}d.current=h.scrollTop})})})]})});Fq.displayName=nC;var $q="SelectGroup",[gMe,yMe]=Uh($q),bMe=y.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t,i=Pc();return a.jsx(gMe,{scope:s,id:i,children:a.jsx(Yt.div,{role:"group","aria-labelledby":i,...r,ref:n})})});bMe.displayName=$q;var zq="SelectLabel",Uq=y.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t,i=yMe(zq,s);return a.jsx(Yt.div,{id:i.id,...r,ref:n})});Uq.displayName=zq;var Gy="SelectItem",[vMe,Vq]=Uh(Gy),Hq=y.forwardRef((t,n)=>{const{__scopeSelect:s,value:r,disabled:i=!1,textValue:l,...o}=t,c=od(Gy,s),d=cd(Gy,s),u=c.value===r,[h,m]=y.useState(l??""),[x,b]=y.useState(!1),w=Sn(n,A=>{var k;return(k=d.itemRefCallback)==null?void 0:k.call(d,A,r,i)}),j=Pc(),S=y.useRef("touch"),C=()=>{i||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(vMe,{scope:s,value:r,disabled:i,textId:j,isSelected:u,onItemTextChange:y.useCallback(A=>{m(k=>k||((A==null?void 0:A.textContent)??"").trim())},[]),children:a.jsx(ew.ItemSlot,{scope:s,value:r,disabled:i,textValue:h,children:a.jsx(Yt.div,{role:"option","aria-labelledby":j,"data-highlighted":x?"":void 0,"aria-selected":u&&x,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...o,ref:w,onFocus:Vt(o.onFocus,()=>b(!0)),onBlur:Vt(o.onBlur,()=>b(!1)),onClick:Vt(o.onClick,()=>{S.current!=="mouse"&&C()}),onPointerUp:Vt(o.onPointerUp,()=>{S.current==="mouse"&&C()}),onPointerDown:Vt(o.onPointerDown,A=>{S.current=A.pointerType}),onPointerMove:Vt(o.onPointerMove,A=>{var k;S.current=A.pointerType,i?(k=d.onItemLeave)==null||k.call(d):S.current==="mouse"&&A.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Vt(o.onPointerLeave,A=>{var k;A.currentTarget===document.activeElement&&((k=d.onItemLeave)==null||k.call(d))}),onKeyDown:Vt(o.onKeyDown,A=>{var T;((T=d.searchRef)==null?void 0:T.current)!==""&&A.key===" "||(aMe.includes(A.key)&&C(),A.key===" "&&A.preventDefault())})})})})});Hq.displayName=Gy;var Lm="SelectItemText",Wq=y.forwardRef((t,n)=>{const{__scopeSelect:s,className:r,style:i,...l}=t,o=od(Lm,s),c=cd(Lm,s),d=Vq(Lm,s),u=cMe(Lm,s),[h,m]=y.useState(null),x=Sn(n,C=>m(C),d.onItemTextChange,C=>{var A;return(A=c.itemTextRefCallback)==null?void 0:A.call(c,C,d.value,d.disabled)}),b=h==null?void 0:h.textContent,w=y.useMemo(()=>a.jsx("option",{value:d.value,disabled:d.disabled,children:b},d.value),[d.disabled,d.value,b]),{onNativeOptionAdd:j,onNativeOptionRemove:S}=u;return Tr(()=>(j(w),()=>S(w)),[j,S,w]),a.jsxs(a.Fragment,{children:[a.jsx(Yt.span,{id:d.textId,...l,ref:x}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Zc.createPortal(l.children,o.valueNode):null]})});Wq.displayName=Lm;var qq="SelectItemIndicator",Gq=y.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t;return Vq(qq,s).isSelected?a.jsx(Yt.span,{"aria-hidden":!0,...r,ref:n}):null});Gq.displayName=qq;var sC="SelectScrollUpButton",Kq=y.forwardRef((t,n)=>{const s=cd(sC,t.__scopeSelect),r=XE(sC,t.__scopeSelect),[i,l]=y.useState(!1),o=Sn(n,r.onScrollButtonChange);return Tr(()=>{if(s.viewport&&s.isPositioned){let c=function(){const u=d.scrollTop>0;l(u)};const d=s.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[s.viewport,s.isPositioned]),i?a.jsx(Xq,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=s;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});Kq.displayName=sC;var rC="SelectScrollDownButton",Yq=y.forwardRef((t,n)=>{const s=cd(rC,t.__scopeSelect),r=XE(rC,t.__scopeSelect),[i,l]=y.useState(!1),o=Sn(n,r.onScrollButtonChange);return Tr(()=>{if(s.viewport&&s.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,h=Math.ceil(d.scrollTop)<u;l(h)};const d=s.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[s.viewport,s.isPositioned]),i?a.jsx(Xq,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=s;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});Yq.displayName=rC;var Xq=y.forwardRef((t,n)=>{const{__scopeSelect:s,onAutoScroll:r,...i}=t,l=cd("SelectScrollButton",s),o=y.useRef(null),c=tw(s),d=y.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return y.useEffect(()=>()=>d(),[d]),Tr(()=>{var h;const u=c().find(m=>m.ref.current===document.activeElement);(h=u==null?void 0:u.ref.current)==null||h.scrollIntoView({block:"nearest"})},[c]),a.jsx(Yt.div,{"aria-hidden":!0,...i,ref:n,style:{flexShrink:0,...i.style},onPointerDown:Vt(i.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:Vt(i.onPointerMove,()=>{var u;(u=l.onItemLeave)==null||u.call(l),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:Vt(i.onPointerLeave,()=>{d()})})}),wMe="SelectSeparator",Qq=y.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t;return a.jsx(Yt.div,{"aria-hidden":!0,...r,ref:n})});Qq.displayName=wMe;var aC="SelectArrow",NMe=y.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t,i=nw(s),l=od(aC,s),o=cd(aC,s);return l.open&&o.position==="popper"?a.jsx(mPe,{...i,...r,ref:n}):null});NMe.displayName=aC;var jMe="SelectBubbleInput",Zq=y.forwardRef(({__scopeSelect:t,value:n,...s},r)=>{const i=y.useRef(null),l=Sn(r,i),o=xPe(n);return y.useEffect(()=>{const c=i.current;if(!c)return;const d=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==n&&h){const m=new Event("change",{bubbles:!0});h.call(c,n),c.dispatchEvent(m)}},[o,n]),a.jsx(Yt.select,{...s,style:{...yq,...s.style},ref:l,defaultValue:n})});Zq.displayName=jMe;function Jq(t){return t===""||t===void 0}function eG(t){const n=Jr(t),s=y.useRef(""),r=y.useRef(0),i=y.useCallback(o=>{const c=s.current+o;n(c),function d(u){s.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>d(""),1e3))}(c)},[n]),l=y.useCallback(()=>{s.current="",window.clearTimeout(r.current)},[]);return y.useEffect(()=>()=>window.clearTimeout(r.current),[]),[s,i,l]}function tG(t,n,s){const i=n.length>1&&Array.from(n).every(u=>u===n[0])?n[0]:n,l=s?t.indexOf(s):-1;let o=SMe(t,Math.max(l,0));i.length===1&&(o=o.filter(u=>u!==s));const d=o.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return d!==s?d:void 0}function SMe(t,n){return t.map((s,r)=>t[(n+r)%t.length])}var _Me=kq,nG=Tq,CMe=Pq,AMe=Mq,kMe=Oq,sG=Dq,EMe=Fq,rG=Uq,aG=Hq,TMe=Wq,IMe=Gq,iG=Kq,lG=Yq,oG=Qq;const Mn=_Me,On=CMe,An=y.forwardRef(({className:t,children:n,...s},r)=>a.jsxs(nG,{ref:r,className:It("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[n,a.jsx(AMe,{asChild:!0,children:a.jsx(u3,{className:"h-4 w-4 opacity-50"})})]}));An.displayName=nG.displayName;const cG=y.forwardRef(({className:t,...n},s)=>a.jsx(iG,{ref:s,className:It("flex cursor-default items-center justify-center py-1",t),...n,children:a.jsx(vte,{className:"h-4 w-4"})}));cG.displayName=iG.displayName;const dG=y.forwardRef(({className:t,...n},s)=>a.jsx(lG,{ref:s,className:It("flex cursor-default items-center justify-center py-1",t),...n,children:a.jsx(u3,{className:"h-4 w-4"})}));dG.displayName=lG.displayName;const kn=y.forwardRef(({className:t,children:n,position:s="popper",...r},i)=>a.jsx(kMe,{children:a.jsxs(sG,{ref:i,className:It("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...r,children:[a.jsx(cG,{}),a.jsx(EMe,{className:It("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),a.jsx(dG,{})]})}));kn.displayName=sG.displayName;const PMe=y.forwardRef(({className:t,...n},s)=>a.jsx(rG,{ref:s,className:It("px-2 py-1.5 text-sm font-semibold",t),...n}));PMe.displayName=rG.displayName;const Et=y.forwardRef(({className:t,children:n,...s},r)=>a.jsxs(aG,{ref:r,className:It("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[a.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(IMe,{children:a.jsx(d3,{className:"h-4 w-4"})})}),a.jsx(TMe,{children:n})]}));Et.displayName=aG.displayName;const MMe=y.forwardRef(({className:t,...n},s)=>a.jsx(oG,{ref:s,className:It("-mx-1 my-1 h-px bg-muted",t),...n}));MMe.displayName=oG.displayName;const ug=["#0f172a","#1e293b","#475569","#64748b","#94a3b8"];function to(t){return t.toISOString().slice(0,10)}function cR(t,n){const s=new Date(t);return s.setDate(s.getDate()+n),s}function OMe(t){if(!t)return"";const n=t.value!==null&&t.value!==void 0?t.value:0;return`${t.label}: ${n}`}const DMe={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35,ease:"easeOut"}}},Sm={hidden:{opacity:0,y:8},visible:(t=0)=>({opacity:1,y:0,transition:{duration:.3,ease:"easeOut",delay:t}})},dR={hidden:{},visible:{transition:{staggerChildren:.06}}},O2={hidden:{opacity:0,y:6,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.25,ease:"easeOut"}}};function RMe(){const t=new Date,[n,s]=y.useState(()=>to(t)),[r,i]=y.useState(()=>to(t)),[l,o]=y.useState([]),[c,d]=y.useState(!0),[u,h]=y.useState(""),[m,x]=y.useState({}),[b,w]=y.useState("today"),[j,S]=y.useState(null),[C,A]=y.useState(!1),[k,T]=y.useState(""),I=!!(n&&r);y.useEffect(()=>{let J=!0;return(async()=>{var ye,ie;d(!0),T("");try{const he=await E4e();if(!J)return;const be=(he==null?void 0:he.data)||[];o(be),be.length>0&&h(be[0].code)}catch(he){if(console.error(he),!J)return;T(((ie=(ye=he==null?void 0:he.response)==null?void 0:ye.data)==null?void 0:ie.detail)||"Failed to load MIS report definitions.")}finally{J&&d(!1)}})(),()=>{J=!1}},[]);const D=y.useMemo(()=>l.find(J=>J.code===u)||null,[l,u]),O=J=>{w(J);const ee=new Date;if(J==="today"){const ye=to(ee);s(ye),i(ye)}else if(J==="7d")s(to(cR(ee,-6))),i(to(ee));else if(J==="30d")s(to(cR(ee,-29))),i(to(ee));else if(J==="month"){const ye=new Date(ee.getFullYear(),ee.getMonth(),1);s(to(ye)),i(to(ee))}},R=J=>ee=>{w("custom"),J(ee.target.value)},P=(J,ee)=>{x(ye=>({...ye,[J]:ee}))},L=async()=>{var J,ee;if(!u||!I){T("Please select a report and valid date range.");return}A(!0),T(""),S(null);try{const ie=await T4e(u,{date_from:n,date_to:r,filters:m});S((ie==null?void 0:ie.data)||null)}catch(ye){console.error(ye),T(((ee=(J=ye==null?void 0:ye.response)==null?void 0:J.data)==null?void 0:ee.detail)||"Failed to run MIS report. Please check filters and try again.")}finally{A(!1)}},$=y.useMemo(()=>j!=null&&j.cards&&Array.isArray(j.cards)?j.cards:[],[j]),B=y.useMemo(()=>j!=null&&j.charts&&Array.isArray(j.charts)?j.charts:[],[j]),V=(D==null?void 0:D.category)||"MIS",K=B.filter(J=>J.type==="bar"),z=B.filter(J=>J.type==="pie"),H=(D==null?void 0:D.name)||"No report selected",Y=I?`${n}  ${r}`:"Select a date range",G=C?"Running report":j?"Showing latest results":"Awaiting first run";return a.jsx(gt.div,{className:"relative min-h-[calc(100vh-4rem)] bg-slate-50 px-2.5 py-3 sm:px-3 sm:py-4 md:px-6 md:py-6 lg:px-8",variants:DMe,initial:"hidden",animate:"visible",children:a.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-4 md:space-y-5 lg:space-y-6",children:[a.jsxs(gt.div,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-[10px] md:text-[11px]",custom:0,variants:Sm,initial:"hidden",animate:"visible",children:[a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-800 shadow-sm",children:[a.jsx(Wte,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:"MIS  Management Information System"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx("span",{className:"inline-flex h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),a.jsx("span",{className:"inline-flex md:hidden rounded-full bg-white px-2 py-0.5 text-[9px] uppercase tracking-wide border border-slate-200",children:"Mobile view"}),a.jsx("span",{className:"hidden md:inline-flex lg:hidden rounded-full bg-white px-2 py-0.5 text-[9px] uppercase tracking-wide border border-slate-200",children:"Tablet / Laptop"}),a.jsx("span",{className:"hidden lg:inline-flex rounded-full bg-white px-2 py-0.5 text-[9px] uppercase tracking-wide border border-slate-200",children:"Desktop workspace"})]})]}),a.jsx(gt.div,{variants:Sm,custom:.05,initial:"hidden",animate:"visible",children:a.jsx(Le,{className:"rounded-3xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:a.jsxs(ze,{className:"p-4 sm:p-5 md:p-6 lg:p-7 flex flex-col gap-4 md:gap-5 lg:gap-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"space-y-3 max-w-xl",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-1 text-[10px] md:text-[11px] font-medium text-slate-700",children:[a.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-900 text-white text-[10px]",children:"MIS"}),"Clean, light-weight analytics console"]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"inline-flex h-10 w-10 md:h-11 md:w-11 items-center justify-center rounded-3xl bg-slate-900 text-slate-50 shadow-sm",children:a.jsx(Im,{className:"w-5 h-5"})}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("h1",{className:"text-[20px] md:text-[24px] lg:text-[28px] font-semibold tracking-tight text-slate-900",children:"MIS Reports Console"}),a.jsxs("p",{className:"text-[11px] md:text-[12px] text-slate-600 leading-relaxed",children:["Generate"," ",a.jsx("span",{className:"font-medium text-slate-900",children:"clinical, operational and financial"})," ","MIS reports for your hospital in a simple, distraction-free, light theme workspace."]})]})]}),D&&a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.jsx(Xe,{variant:"outline",className:"border-slate-200 text-slate-700 bg-slate-50 text-[10px] px-2 py-0.5",children:V}),Array.isArray(D.tags)&&D.tags.map(J=>a.jsx(Xe,{variant:"outline",className:"border-slate-200 text-slate-600 bg-white text-[10px] px-2 py-0.5",children:J},J))]})]}),a.jsx("div",{className:"w-full md:w-auto",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 md:gap-3 text-[11px]",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5 flex flex-col gap-1 shadow-xs",children:[a.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide",children:"Active report"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900 line-clamp-2",children:H})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2.5 flex flex-col gap-1 shadow-xs",children:[a.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide",children:"Date range"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:Y})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5 flex flex-col gap-1 shadow-xs",children:[a.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wide",children:"Status"}),a.jsxs("span",{className:"text-[11px] font-semibold text-slate-900 flex items-center gap-1.5",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),G]})]})]})})]}),(D==null?void 0:D.description)&&a.jsx("div",{className:"pt-2 border-t border-slate-100 text-[11px] text-slate-600",children:D.description})]})})}),a.jsx(du,{children:k&&a.jsx(gt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},children:a.jsxs($c,{variant:"destructive",className:"bg-rose-50 border-rose-300 text-rose-900",children:[a.jsx(Ms,{className:"h-4 w-4 mt-0.5"}),a.jsxs("div",{children:[a.jsx(zc,{className:"text-rose-900",children:"MIS error"}),a.jsx(Uc,{className:"text-rose-800/90",children:k})]})]})})}),a.jsxs(gt.div,{variants:Sm,custom:.1,initial:"hidden",animate:"visible",className:"grid gap-4 lg:gap-5 lg:grid-cols-[minmax(0,320px)_minmax(0,1fr)] xl:grid-cols-[minmax(0,340px)_minmax(0,1fr)]",children:[a.jsxs("div",{className:"space-y-3 lg:space-y-4 lg:sticky lg:top-20 self-start",children:[a.jsxs(Le,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-7 w-7 rounded-xl bg-slate-900 text-white flex items-center justify-center",children:a.jsx(Im,{className:"w-4 h-4"})}),a.jsxs("div",{children:[a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Report & Date"}),a.jsx("p",{className:"text-[10px] text-slate-500",children:"Choose MIS view and time window"})]})]})}),a.jsxs(ze,{className:"space-y-3 pb-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:"Report"}),a.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(Ai,{className:"w-3 h-3"}),"MIS group"]})]}),c?a.jsx(Ze,{className:"h-9 rounded-xl bg-slate-100"}):a.jsxs(Mn,{value:u,onValueChange:J=>{h(J),S(null)},children:[a.jsx(An,{className:"h-9 rounded-xl border-slate-200 bg-white text-xs text-slate-900 focus:ring-slate-400",children:a.jsx(On,{placeholder:"Select report"})}),a.jsx(kn,{className:"bg-white border-slate-200 text-slate-900 max-h-72",children:l.map(J=>a.jsx(Et,{value:String(J.code),className:"text-xs",children:J.name},J.code))})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:"Quick ranges"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"today",label:"Today"},{key:"7d",label:"Last 7 days"},{key:"30d",label:"Last 30 days"},{key:"month",label:"This month"},{key:"custom",label:"Custom"}].map(J=>a.jsx("button",{type:"button",onClick:()=>O(J.key),className:It("px-2.5 py-1 rounded-full text-[10px] font-medium border transition-colors",b===J.key?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:J.label},J.key))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:"Custom date range"}),a.jsx("div",{className:"flex flex-col gap-2",children:a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-2.5 py-2",children:[a.jsx(sS,{className:"w-4 h-4 text-slate-500 shrink-0"}),a.jsxs("div",{className:"flex flex-col gap-1 w-full text-[11px] text-slate-800",children:[a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"w-10 text-[10px] text-slate-500",children:"From"}),a.jsx(_e,{type:"date",value:n,onChange:R(s),className:"h-7 w-full border-slate-200 bg-slate-50 text-[11px] text-slate-900"})]}),a.jsxs("div",{className:"flex items-center gap-1 w-full",children:[a.jsx("span",{className:"w-10 text-[10px] text-slate-500",children:"To"}),a.jsx(_e,{type:"date",value:r,onChange:R(i),className:"h-7 w-full border-slate-200 bg-slate-50 text-[11px] text-slate-900"})]})]})]})})]}),a.jsx("div",{className:"pt-1",children:a.jsx(Pe,{size:"sm",className:"h-9 w-full rounded-xl inline-flex items-center justify-center gap-2 bg-slate-900 hover:bg-slate-800 text-white",onClick:L,disabled:C||!u||!I,children:C?a.jsxs(a.Fragment,{children:[a.jsx(cu,{className:"w-4 h-4 animate-spin"}),"Running report"]}):a.jsxs(a.Fragment,{children:[a.jsx(cu,{className:"w-4 h-4"}),"Run MIS report"]})})})]})]}),D&&Array.isArray(D.filters)&&D.filters.length>0&&a.jsxs(Le,{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between gap-2",children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(Ai,{className:"w-4 h-4 text-slate-500"}),"Advanced filters"]}),a.jsx("span",{className:"text-[10px] text-slate-500",children:"Tailor output for this report"})]}),a.jsx(ze,{className:"pb-3",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:D.filters.map(J=>J.type==="select"&&Array.isArray(J.options)?a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:J.label}),J.required&&a.jsx("span",{className:"text-[10px] text-rose-500",children:"*"})]}),a.jsxs(Mn,{value:m[J.key]!==void 0?String(m[J.key]):"",onValueChange:ee=>P(J.key,ee),children:[a.jsx(An,{className:"h-8 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900",children:a.jsx(On,{placeholder:`All ${J.label}`})}),a.jsxs(kn,{className:"bg-white border-slate-200 text-slate-900 max-h-64",children:[a.jsx(Et,{value:"__ALL__",className:"text-xs text-slate-500",children:"All"}),J.options.map(ee=>a.jsx(Et,{value:String(ee.value),className:"text-xs",children:ee.label},ee.value))]})]})]},J.key):a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-800",children:J.label}),J.required&&a.jsx("span",{className:"text-[10px] text-rose-500",children:"*"})]}),a.jsx(_e,{value:m[J.key]??"",onChange:ee=>P(J.key,ee.target.value),placeholder:`Filter by ${J.label}`,className:"h-8 rounded-xl border-slate-200 bg-slate-50 text-xs text-slate-900 placeholder:text-slate-400"})]},J.key))})})]})]}),a.jsxs("div",{className:"space-y-3 lg:space-y-4",children:[!C&&!j&&a.jsx(Le,{className:"rounded-2xl border border-dashed border-slate-300 bg-white shadow-none",children:a.jsxs(ze,{className:"py-10 px-4 sm:px-8 flex flex-col items-center justify-center text-center gap-3",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center border border-slate-200 mb-1",children:a.jsx(Im,{className:"w-6 h-6 text-slate-700"})}),a.jsx("h2",{className:"text-sm md:text-base font-semibold text-slate-900",children:"Run your first MIS report"}),a.jsxs("p",{className:"text-[11px] md:text-[12px] text-slate-600 max-w-md",children:["Select a report on the left, choose a date range, add filters if needed and click"," ",a.jsx("span",{className:"font-medium text-slate-900",children:"Run MIS report"})," ","to see KPIs, charts and detailed records."]})]})}),C&&a.jsxs(gt.div,{className:"space-y-4",variants:Sm,custom:.15,initial:"hidden",animate:"visible",children:[a.jsx(Ze,{className:"h-16 rounded-2xl bg-white/80"}),a.jsx(Ze,{className:"h-64 rounded-2xl bg-white/80"}),a.jsx(Ze,{className:"h-64 rounded-2xl bg-white/80"})]}),!C&&j&&a.jsx(gt.div,{variants:Sm,custom:.15,initial:"hidden",animate:"visible",children:a.jsxs(_o,{defaultValue:"summary",className:"w-full",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-2",children:[a.jsxs(Ll,{className:"flex flex-nowrap overflow-x-auto gap-1 rounded-full bg-slate-100 p-1 border border-slate-200",children:[a.jsx(dn,{value:"summary",className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:"Summary"}),a.jsx(dn,{value:"charts",className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:"Charts"}),j.table&&a.jsx(dn,{value:"details",className:"px-3 py-1.5 text-xs sm:text-sm rounded-full data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm",children:"Detailed view"})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 text-[10px] text-slate-500",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"}),a.jsxs("span",{children:["Generated for"," ",a.jsx("span",{className:"font-medium text-slate-800",children:j.name})]})]})]}),a.jsxs(mn,{value:"summary",className:"space-y-4 mt-2",children:[$.length>0&&a.jsxs("section",{className:"space-y-2",children:[a.jsxs("h2",{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:a.jsx(Im,{className:"w-3 h-3"})}),"Key indicators"]}),a.jsx(gt.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-4",variants:dR,initial:"hidden",animate:"visible",children:$.map((J,ee)=>a.jsx(gt.div,{variants:O2,children:a.jsx(LMe,{card:J})},ee))})]}),K[0]&&a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Primary trend"}),a.jsx(D2,{chart:K[0]})]})]}),a.jsx(mn,{value:"charts",className:"space-y-4 mt-2",children:a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Chart views"}),a.jsxs(gt.div,{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-3 md:gap-4",variants:dR,initial:"hidden",animate:"visible",children:[K.map(J=>a.jsx(gt.div,{variants:O2,children:a.jsx(D2,{chart:J})},J.code)),z.map(J=>a.jsx(gt.div,{variants:O2,children:a.jsx(D2,{chart:J})},J.code))]})]})}),j.table&&a.jsx(mn,{value:"details",className:"space-y-4 mt-2",children:a.jsxs("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"Detailed records"}),a.jsx(BMe,{table:j.table})]})})]})})]})]})]})})}function LMe({card:t}){return a.jsxs(gt.div,{whileHover:{y:-2,scale:1.01},transition:{type:"spring",stiffness:240,damping:22},className:It("rounded-2xl border border-slate-200 bg-white px-3 py-2.5 shadow-sm","flex flex-col gap-1"),children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide font-semibold text-slate-500",children:t.label}),a.jsx("div",{className:"text-xl md:text-2xl font-semibold leading-tight text-slate-900",children:typeof t.value=="number"?t.value.toLocaleString("en-IN",{maximumFractionDigits:1}):t.value}),t.helper&&a.jsx("div",{className:"text-[11px] text-slate-500",children:t.helper})]})}function D2({chart:t}){const n=t.type||"bar",s=Array.isArray(t.data)?t.data:[],r=t.config||{};if(n==="pie"){const l=s.length>0?s.map((o,c)=>({label:o.label??o.name??`Item ${c+1}`,value:o.value??o.amount??0})):[];return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-base font-semibold text-slate-900",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600 border border-slate-200",children:"Distribution"})]}),a.jsx(ze,{className:"h-56 sm:h-64",children:l.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(K_,{children:[a.jsx(Oy,{data:l,dataKey:"value",nameKey:"label",outerRadius:80,paddingAngle:3,labelLine:!1,label:OMe,children:l.map((o,c)=>a.jsx(Al,{fill:ug[c%ug.length]},`cell-${c}`))}),a.jsx(zd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}})]})})})]})}const i=s.length>0?s.map((l,o)=>({label:l.label??l.name??`Item ${o+1}`,value:l.value??l.amount??0})):[];return a.jsxs(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-base font-semibold text-slate-900",children:t.title}),a.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600 border border-slate-200",children:(r==null?void 0:r.label)||"Trend"})]}),a.jsx(ze,{className:"h-56 sm:h-64",children:i.length===0?a.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No data to display."}):a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(Uy,{data:i,margin:{left:8,right:8,top:8,bottom:8},children:[a.jsx(ax,{dataKey:"label",stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),a.jsx(ix,{stroke:"#9ca3af",fontSize:11,tickLine:!1,axisLine:{stroke:"#e5e7eb"}}),a.jsx(zd,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,color:"#111827"}}),a.jsx(rx,{dataKey:"value",radius:[4,4,0,0],children:i.map((l,o)=>a.jsx(Al,{fill:ug[o%ug.length]},`cell-${o}`))})]})})})]})}function BMe({table:t}){const n=Array.isArray(t.rows)?t.rows:[],s=t.columns&&t.columns.length>0?t.columns:n[0]?Object.keys(n[0]):[];return n.length===0?a.jsx(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:a.jsx(ze,{className:"py-6 flex items-center justify-center",children:a.jsx("p",{className:"text-sm text-slate-500",children:"No records found."})})}):a.jsx(Le,{className:"rounded-2xl shadow-sm border border-slate-200 bg-white",children:a.jsx(ze,{className:"py-3 flex flex-col gap-2 max-h-[480px] overflow-y-auto pr-1",children:a.jsx(du,{children:n.map((r,i)=>a.jsx(gt.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.2,ease:"easeOut"},className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5 flex flex-col gap-1 text-xs md:text-sm",children:s.map((l,o)=>a.jsxs("div",{className:It("flex justify-between gap-2",o===0?"font-semibold text-slate-900":"text-slate-700"),children:[a.jsx("span",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:l.replace(/_/g," ")}),a.jsx("span",{className:"text-right truncate max-w-[60%]",children:FMe(r[l])})]},l))},i))})})})}function FMe(t){return t==null?"-":typeof t=="number"?t.toLocaleString("en-IN",{maximumFractionDigits:1}):typeof t=="string"&&t.length>60?t.slice(0,60)+"":String(t)}const uG=t=>{let n={};return typeof t=="string"?t&&(n.q=t):t&&typeof t=="object"&&(n=t),ne.get("/patients",{params:n})};function $Me(t){return ne.get(`/patients/${t}`)}function zMe(t){return ne.post("/patients",t)}function UMe(t,n){return ne.put(`/patients/${t}`,n)}function VMe(t){return ne.patch(`/patients/${t}/deactivate`)}function HMe(t,{type:n,file:s}){const r=new FormData;return r.append("type",n||"other"),r.append("file",s),ne.post(`/patients/${t}/documents`,r,{headers:{"Content-Type":"multipart/form-data"}})}function WMe(t){return ne.get(`/patients/${t}/documents`)}function qMe(t){return ne.get(`/patients/${t}/consents`)}function GMe(t,n){return ne.post(`/patients/${t}/consents`,n)}async function KMe(t){const n=await ne.get(`/patients/${t}/print-info`,{responseType:"blob"}),s=n.headers["content-type"]||"application/octet-stream",r=new Blob([n.data],{type:s}),i=URL.createObjectURL(r);window.open(i,"_blank")}function YMe(){return ne.get("/patient-masters/all")}function XMe(t){return ne.get("/patients/export",{params:t,responseType:"blob"})}function QMe(t,n={}){const s={table_name:"patients",record_id:t,...n};return ne.get("/audit-logs",{params:s})}const ZMe=["","A+","A-","B+","B-","O+","O-","AB+","AB-"],JMe=["","Single","Married","Widowed","Divorced"],eOe=["","Mr","Ms","Mrs","Dr","Baby","Master"],tOe=[{code:"OPD",name:"OPD"},{code:"IPD",name:"IPD"},{code:"EMERGENCY",name:"Emergency"},{code:"HEALTH_CHECK",name:"Health Check"},{code:"CAMP",name:"Camp"},{code:"CORPORATE",name:"Corporate"},{code:"INSURANCE",name:"Insurance"}],nOe=["","insurance","corporate","govt","other"],sOe={prefix:"",first_name:"",last_name:"",gender:"",dob:"",phone:"",email:"",blood_group:"",marital_status:"",ref_source:"",ref_doctor_id:"",ref_details:"",id_proof_type:"",id_proof_no:"",guardian_name:"",guardian_phone:"",guardian_relation:"",patient_type:"",tag:"",religion:"",occupation:"",file_number:"",file_location:"",credit_type:"",credit_payer_id:"",credit_tpa_id:"",credit_plan_id:"",principal_member_name:"",principal_member_address:"",policy_number:"",policy_name:"",family_id:"",address:{type:"current",line1:"",line2:"",city:"",state:"",pincode:"",country:"India"}};function iC(){return JSON.parse(JSON.stringify(sOe))}function rOe(t){if(!t)return iC();const n=t.addresses&&t.addresses[0]||null;return{prefix:t.prefix||"",first_name:t.first_name||"",last_name:t.last_name||"",gender:t.gender||"",dob:t.dob||"",phone:t.phone||"",email:t.email||"",blood_group:t.blood_group||"",marital_status:t.marital_status||"",ref_source:t.ref_source||"",ref_doctor_id:t.ref_doctor_id||"",ref_details:t.ref_details||"",id_proof_type:t.id_proof_type||"",id_proof_no:t.id_proof_no||"",guardian_name:t.guardian_name||"",guardian_phone:t.guardian_phone||"",guardian_relation:t.guardian_relation||"",patient_type:t.patient_type||"",tag:t.tag||"",religion:t.religion||"",occupation:t.occupation||"",file_number:t.file_number||"",file_location:t.file_location||"",credit_type:t.credit_type||"",credit_payer_id:t.credit_payer_id||"",credit_tpa_id:t.credit_tpa_id||"",credit_plan_id:t.credit_plan_id||"",principal_member_name:t.principal_member_name||"",principal_member_address:t.principal_member_address||"",policy_number:t.policy_number||"",policy_name:t.policy_name||"",family_id:t.family_id||"",address:{type:(n==null?void 0:n.type)||"current",line1:(n==null?void 0:n.line1)||"",line2:(n==null?void 0:n.line2)||"",city:(n==null?void 0:n.city)||"",state:(n==null?void 0:n.state)||"",pincode:(n==null?void 0:n.pincode)||"",country:(n==null?void 0:n.country)||"India"}}}function _m(t){if(t==null||t==="")return null;const n=Number(t);return Number.isNaN(n)?null:n}function aOe(t){var i,l,o;let n="Failed to save patient";const s={},r=(l=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:l.detail;if(Array.isArray(r)){n="Please correct the highlighted fields.";for(const c of r){const d=c.loc||[],u=c.msg||"Invalid value";if(d[0]==="body"&&d.length>=2)if(d[1]==="address"&&d[2]){const h=`address.${d[2]}`;s[h]=s[h]?`${s[h]}; ${u}`:u}else{const h=d[1];s[h]=s[h]?`${s[h]}; ${u}`:u}}!Object.keys(s).length&&((o=r[0])!=null&&o.msg)&&(n=r[0].msg)}else typeof r=="string"?n=r:r&&typeof r=="object"&&r.msg?n=r.msg:t!=null&&t.message&&(n=t.message);return{generalMessage:n,fieldErrors:s}}function iOe({open:t,onClose:n,onSaved:s,initialPatient:r,lookups:i}){const[l,o]=y.useState(iC),[c,d]=y.useState(!1),[u,h]=y.useState(""),[m,x]=y.useState({}),b=y.useMemo(()=>r?"edit":"create",[r]);if(y.useEffect(()=>{t&&(h(""),x({}),o(r?rOe(r):iC()))},[t,r]),!t)return null;const w=L=>$=>{let B=$.target.value;L==="phone"&&(B=B.replace(/\D/g,"").slice(0,10)),o(V=>({...V,[L]:B})),x(V=>{const K={...V};return delete K[L],K})},j=L=>$=>{const B=$.target.value;o(V=>({...V,address:{...V.address,[L]:B}})),x(V=>{const K=`address.${L}`,z={...V};return delete z[K],z})},S=async L=>{var $;L.preventDefault(),h(""),x({}),d(!0);try{const B={...l,ref_doctor_id:_m(l.ref_doctor_id),credit_payer_id:_m(l.credit_payer_id),credit_tpa_id:_m(l.credit_tpa_id),credit_plan_id:_m(l.credit_plan_id),family_id:_m(l.family_id),credit_type:l.credit_type||null,patient_type:l.patient_type||null};let V;b==="create"?V=await zMe(B):V=await UMe(r.id,B),s&&s(V.data),n&&n()}catch(B){console.error("Patient save error:",(($=B==null?void 0:B.response)==null?void 0:$.data)||B);const{generalMessage:V,fieldErrors:K}=aOe(B);h(V),x(K)}finally{d(!1)}},{refSources:C,doctors:A,payers:k,tpas:T,creditPlans:I,patientTypes:D}=i||{},O=D&&D.length?D:tOe,R=L=>!!m[L],P=L=>m[L]?a.jsx("p",{className:"mt-0.5 text-[11px] text-red-600",children:m[L]}):null;return a.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-stretch justify-center",children:[a.jsx("div",{className:"absolute inset-0",onClick:n,"aria-hidden":"true"}),a.jsxs("div",{className:"relative z-10 w-full max-w-6xl h-full sm:h-[95vh] mx-auto my-0 sm:my-4 bg-white rounded-none sm:rounded-3xl shadow-xl flex flex-col overflow-hidden",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:b==="create"?"New Patient":"Edit Patient"}),a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900/5 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:b==="create"?"Create":"Update"})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Fill basic details, address and credit / insurance information."})]}),a.jsx("button",{type:"button",onClick:n,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]}),a.jsxs("form",{onSubmit:S,className:"flex-1 flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-6 bg-slate-50/60",children:[u&&a.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:u}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Basic Information"}),(r==null?void 0:r.uhid)&&a.jsxs("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-slate-900/5 text-slate-700 border border-slate-200",children:["UHID: ",r.uhid]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Prefix",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("prefix")?"border-red-300":"border-slate-200"}`,value:l.prefix,onChange:w("prefix"),required:!0,children:eOe.map(L=>a.jsx("option",{value:L,children:L||"Select"},L))}),P("prefix")]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["First Name",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{className:`w-full border rounded-lg px-2.5 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-900/10 ${R("first_name")?"border-red-300":"border-slate-200"}`,value:l.first_name,onChange:w("first_name"),required:!0}),P("first_name")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Last Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.last_name,onChange:w("last_name")})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Gender",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("gender")?"border-red-300":"border-slate-200"}`,value:l.gender,onChange:w("gender"),required:!0,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{value:"male",children:"Male"}),a.jsx("option",{value:"female",children:"Female"}),a.jsx("option",{value:"other",children:"Other"})]}),P("gender")]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Date of Birth",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("dob")?"border-red-300":"border-slate-200"}`,value:l.dob||"",onChange:w("dob"),required:!0}),P("dob")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Blood Group"}),a.jsx("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.blood_group,onChange:w("blood_group"),children:ZMe.map(L=>a.jsx("option",{value:L,children:L||"Select"},L))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Marital Status",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("marital_status")?"border-red-300":"border-slate-200"}`,value:l.marital_status,onChange:w("marital_status"),required:!0,children:JMe.map(L=>a.jsx("option",{value:L,children:L||"Select"},L))}),P("marital_status")]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Mobile",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("phone")?"border-red-300":"border-slate-200"}`,value:l.phone,onChange:w("phone"),required:!0}),a.jsx("p",{className:"mt-0.5 text-[11px] text-slate-400",children:"10 digit mobile number"}),P("phone")]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Email",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("email")?"border-red-300":"border-slate-200"}`,value:l.email,onChange:w("email"),required:!0}),P("email")]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Patient Type",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("patient_type")?"border-red-300":"border-slate-200"}`,value:l.patient_type||"",onChange:w("patient_type"),required:!0,children:[a.jsx("option",{value:"",children:"Select"}),O.map(L=>a.jsx("option",{value:L.code||L.name,children:L.name||L.code},L.code||L.name))]}),P("patient_type")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Tag"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.tag,onChange:w("tag")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Religion"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.religion,onChange:w("religion")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Occupation"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.occupation,onChange:w("occupation")})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Reference & Guardian"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Reference Source"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.ref_source,onChange:w("ref_source"),children:[a.jsx("option",{value:"",children:"Select"}),C==null?void 0:C.map(L=>a.jsx("option",{value:L.code,children:L.label},L.code))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Referring Doctor"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.ref_doctor_id||"",onChange:w("ref_doctor_id"),children:[a.jsx("option",{value:"",children:"Select"}),A==null?void 0:A.map(L=>a.jsxs("option",{value:L.id,children:[L.name,L.department_name?` (${L.department_name})`:""]},L.id))]})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Reference Details"}),a.jsx("textarea",{rows:2,className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.ref_details,onChange:w("ref_details")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Guardian Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.guardian_name,onChange:w("guardian_name")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Guardian Phone"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.guardian_phone,onChange:w("guardian_phone")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Guardian Relation"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.guardian_relation,onChange:w("guardian_relation")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"ID Proof Type"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.id_proof_type,onChange:w("id_proof_type")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"ID Proof No"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.id_proof_no,onChange:w("id_proof_no")})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Address"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Address Line 1"}),a.jsx("input",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("address.line1")?"border-red-300":"border-slate-200"}`,value:l.address.line1,onChange:j("line1")}),P("address.line1")]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Address Line 2"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.address.line2,onChange:j("line2")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"City"}),a.jsx("input",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("address.city")?"border-red-300":"border-slate-200"}`,value:l.address.city,onChange:j("city")}),P("address.city")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"State"}),a.jsx("input",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("address.state")?"border-red-300":"border-slate-200"}`,value:l.address.state,onChange:j("state")}),P("address.state")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Pincode"}),a.jsx("input",{className:`w-full border rounded-lg px-2.5 py-2 text-sm ${R("address.pincode")?"border-red-300":"border-slate-200"}`,value:l.address.pincode,onChange:j("pincode")}),P("address.pincode")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Country"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.address.country,onChange:j("country")})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl px-3 sm:px-4 py-3 sm:py-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"File & Credit / Insurance"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"File Number"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.file_number,onChange:w("file_number")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"File Location"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.file_location,onChange:w("file_location")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Credit Type"}),a.jsx("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.credit_type,onChange:w("credit_type"),children:nOe.map(L=>a.jsx("option",{value:L,children:L||"Select"},L))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Payer"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.credit_payer_id||"",onChange:w("credit_payer_id"),children:[a.jsx("option",{value:"",children:"Select"}),k==null?void 0:k.map(L=>a.jsx("option",{value:L.id,children:L.display_name||L.name},L.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"TPA"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.credit_tpa_id||"",onChange:w("credit_tpa_id"),children:[a.jsx("option",{value:"",children:"Select"}),T==null?void 0:T.map(L=>a.jsx("option",{value:L.id,children:L.display_name||L.name},L.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Credit Plan"}),a.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.credit_plan_id||"",onChange:w("credit_plan_id"),children:[a.jsx("option",{value:"",children:"Select"}),I==null?void 0:I.map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Principal Member Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.principal_member_name,onChange:w("principal_member_name")})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Principal Member Address"}),a.jsx("textarea",{rows:2,className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.principal_member_address,onChange:w("principal_member_address")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Policy Number"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.policy_number,onChange:w("policy_number")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Policy Name"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.policy_name,onChange:w("policy_name")})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Family ID"}),a.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2.5 py-2 text-sm",value:l.family_id,onChange:w("family_id")})]})]})]})]}),a.jsxs("div",{className:"border-t border-slate-200 px-4 sm:px-6 py-3 bg-white flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[a.jsxs("p",{className:"text-[11px] text-slate-500",children:["Fields marked with ",a.jsx("span",{className:"text-red-500",children:"*"})," are mandatory."]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm border border-slate-200 rounded-lg text-slate-700 hover:bg-slate-50",disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-1.5 text-sm rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",disabled:c,children:c?b==="create"?"Creating...":"Saving...":b==="create"?"Create Patient":"Save Changes"})]})]})]})]})]})}function Jn(t){return t||""}function lOe(t){return t?{doctor:"Doctor",google:"Google",social_media:"Social Media",ads:"Advertisements",other:"Other"}[t]||t:""}function uR(t){if(t==null)return"";if(typeof t=="string"){const n=t.trim();return n?n.length>24?`${n.slice(0,24)}`:n:""}if(typeof t=="number"||typeof t=="boolean")return String(t);try{const n=JSON.stringify(t);return n.length>24?`${n.slice(0,24)}`:n}catch{return""}}function oOe(t){const n=(t==null?void 0:t.old_values)||{},s=(t==null?void 0:t.new_values)||{},r=Array.from(new Set([...Object.keys(n||{}),...Object.keys(s||{})])),i=[];for(const l of r){const o=n?n[l]:void 0,c=s?s[l]:void 0,d=o===void 0?void 0:JSON.stringify(o),u=c===void 0?void 0:JSON.stringify(c);d!==u&&i.push({field:l,before:o,after:c})}return i}function cOe({open:t,onClose:n,patient:s,onUpdated:r}){const[i,l]=y.useState(null),[o,c]=y.useState([]),[d,u]=y.useState([]),[h,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(!1),[S,C]=y.useState(!1),[A,k]=y.useState(!1),[T,I]=y.useState(""),[D,O]=y.useState(null),[R,P]=y.useState("other"),[L,$]=y.useState(""),[B,V]=y.useState(""),[K,z]=y.useState(""),[H,Y]=y.useState(""),[G,J]=y.useState("idle"),[ee,ye]=y.useState(null),[ie,he]=y.useState(""),[be,we]=y.useState("");y.useEffect(()=>{t&&s&&Z(s.id)},[t,s==null?void 0:s.id]);const Z=async Me=>{var qe,oe;b(!0),I("");try{const[ue,De,St]=await Promise.all([$Me(Me),WMe(Me),qMe(Me)]);l(ue.data),c(De.data||[]),u(St.data||[]),r&&r(ue.data)}catch(ue){const De=((oe=(qe=ue==null?void 0:ue.response)==null?void 0:qe.data)==null?void 0:oe.detail)||(ue==null?void 0:ue.message)||"Failed to load patient details";I(De)}finally{b(!1)}k(!0);try{const ue=await QMe(Me,{limit:30});m(ue.data||[])}catch{}finally{k(!1)}};if(!t||!s)return null;const ce=i||s,Te=ce.addresses&&ce.addresses[0]||null,le=ce.age_text||"",de=async Me=>{var qe,oe;if(Me.preventDefault(),!!D){j(!0),I("");try{const ue=await HMe(ce.id,{type:R,file:D});c(De=>[ue.data,...De]),O(null),P("other")}catch(ue){const De=((oe=(qe=ue==null?void 0:ue.response)==null?void 0:qe.data)==null?void 0:oe.detail)||(ue==null?void 0:ue.message)||"Failed to upload document";I(De)}finally{j(!1)}}},ge=async Me=>{var qe,oe;if(Me.preventDefault(),!(!L||!B)){C(!0),I("");try{const ue=await GMe(ce.id,{type:L,text:B});u(De=>[ue.data,...De]),$(""),V("")}catch(ue){const De=((oe=(qe=ue==null?void 0:ue.response)==null?void 0:qe.data)==null?void 0:oe.detail)||(ue==null?void 0:ue.message)||"Failed to save consent";I(De)}finally{C(!1)}}},ae=async()=>{var Me,qe;try{await KMe(ce.id)}catch(oe){const ue=((qe=(Me=oe==null?void 0:oe.response)==null?void 0:Me.data)==null?void 0:qe.detail)||(oe==null?void 0:oe.message)||"Failed to open print view";I(ue)}},Ve=async Me=>{var qe,oe;I("");try{const ue=await ne.get(`/patients/documents/${Me.id}/file`,{responseType:"blob"}),De=ue.data,St=ue.headers["content-type"]||Me.mime||Me.content_type||Me.mime_type||"",tn=URL.createObjectURL(St?new Blob([De],{type:St}):De);ye(Me),he(tn),we(St)}catch(ue){const De=((oe=(qe=ue==null?void 0:ue.response)==null?void 0:qe.data)==null?void 0:oe.detail)||(ue==null?void 0:ue.message)||"Failed to load attachment for preview";I(De)}},nt=()=>{ie&&URL.revokeObjectURL(ie),ye(null),he(""),we("")},wt=async Me=>{var qe,oe;I("");try{const ue=await ne.get(`/patients/documents/${Me.id}/file`,{responseType:"blob"}),De=ue.data,St=ue.headers["content-type"]||Me.mime||Me.content_type||Me.mime_type||"application/octet-stream",tn=URL.createObjectURL(St?new Blob([De],{type:St}):De),Lt=document.createElement("a");Lt.href=tn,Lt.download=Me.filename||"document",document.body.appendChild(Lt),Lt.click(),Lt.remove(),URL.revokeObjectURL(tn)}catch(ue){const De=((oe=(qe=ue==null?void 0:ue.response)==null?void 0:qe.data)==null?void 0:oe.detail)||(ue==null?void 0:ue.message)||"Failed to download attachment";I(De)}},jt=ee&&((be==null?void 0:be.startsWith("image/"))||/\.(png|jpe?g|gif|webp|bmp)$/i.test(ee.filename||"")),ct=ee&&(be==="application/pdf"||/\.pdf$/i.test(ee.filename||""));return a.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-stretch justify-center",children:[a.jsx("div",{className:"absolute inset-0",onClick:n,"aria-hidden":"true"}),a.jsxs("div",{className:"relative z-10 w-full max-w-5xl h-full sm:h-[95vh] mx-auto my-0 sm:my-4 bg-white rounded-none sm:rounded-3xl shadow-xl flex flex-col overflow-hidden",onClick:Me=>Me.stopPropagation(),children:[a.jsxs("div",{className:"px-4 sm:px-6 py-3 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900",children:[ce.first_name," ",ce.last_name||""]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["UHID: ",ce.uhid,"  Age: ",le||""]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[ce.patient_type&&a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-900/5 text-[11px] text-slate-700 border border-slate-200",children:ce.patient_type}),ce.tag&&a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-[11px] text-emerald-700 border border-emerald-100",children:ce.tag}),a.jsx("button",{type:"button",onClick:n,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 space-y-4 bg-slate-50/60",children:[x&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading details"}),T&&a.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:T}),a.jsx("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 flex flex-wrap gap-2 items-center",children:a.jsx("button",{type:"button",onClick:ae,className:"px-3 py-1.5 text-sm rounded-lg border border-slate-200 text-black bg-green-500 hover:bg-slate-50",children:"Print Info / PDF"})}),a.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800 mb-1.5",children:"Patient Info"}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-xs",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Gender: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.gender)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"DOB: "}),a.jsx("span",{className:"font-medium text-slate-800",children:ce.dob||""})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Age: "}),a.jsx("span",{className:"font-medium text-slate-800",children:le||""})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Blood Group:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.blood_group)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Marital Status:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.marital_status)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Mobile: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.phone)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Email: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.email)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Patient Type:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.patient_type)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Tag: "}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.tag)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Religion:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.religion)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Occupation:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.occupation)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["File No:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.file_number)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["File Location:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.file_location)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.guardian_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Guardian Phone:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.guardian_phone)})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800 mb-1.5",children:"Reference & Credit / Insurance"}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 text-xs",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Reference Source:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:lOe(ce.ref_source)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Referring Doctor:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.ref_doctor_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Type:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.credit_type)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Payer:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.credit_payer_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["TPA:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.credit_tpa_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Credit Plan:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.credit_plan_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Number:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.policy_number)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Policy Name:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.policy_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.principal_member_name)})]}),a.jsxs("div",{children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Family ID:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.family_id)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsxs("span",{className:"font-medium text-slate-600",children:["Principal Member Address:"," "]}),a.jsx("span",{className:"font-medium text-slate-800",children:Jn(ce.principal_member_address)})]})]})]}),a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800 mb-1.5",children:"Address"}),a.jsx("p",{className:"text-xs text-slate-700",children:Te?a.jsxs(a.Fragment,{children:[Te.line1,a.jsx("br",{}),Te.line2&&a.jsxs(a.Fragment,{children:[Te.line2,a.jsx("br",{})]}),[Te.city,Te.state,Te.pincode].filter(Boolean).join(", "),a.jsx("br",{}),Te.country]}):""})]})]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("div",{className:"flex items-center justify-between gap-2",children:a.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Attachments"})}),a.jsxs("form",{onSubmit:de,className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 text-xs",children:[a.jsxs("select",{className:"border border-slate-200 rounded-lg px-1.5 py-1 text-xs text-black",value:R,onChange:Me=>P(Me.target.value),children:[a.jsx("option",{value:"other",children:"Other"}),a.jsx("option",{value:"id_proof",children:"ID Proof"}),a.jsx("option",{value:"report",children:"Report"}),a.jsx("option",{value:"photo",children:"Photo"})]}),a.jsx("input",{type:"file",className:"flex-1 text-xs text-gray-700",onChange:Me=>O(Me.target.files[0]||null)}),a.jsx("button",{type:"submit",disabled:w||!D,className:"px-2 py-1 rounded-lg bg-slate-900 text-white disabled:opacity-60",children:w?"Uploading":"Upload"})]}),a.jsxs("ul",{className:"divide-y border border-slate-200 rounded-lg bg-slate-50/60",children:[o.length===0&&a.jsx("li",{className:"text-xs text-slate-500 px-2 py-2",children:"No attachments yet."}),o.map(Me=>a.jsxs("li",{className:"px-2 py-1.5 text-xs flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium text-slate-800 truncate",children:Me.filename}),a.jsxs("div",{className:"text-[10px] text-slate-500",children:[Me.type||"other"," "," ",Me.size?`${(Me.size/1024).toFixed(1)} KB`:""]})]}),a.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[a.jsx("button",{type:"button",onClick:()=>Ve(Me),className:"px-2 py-1 rounded-lg border border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-100",children:"Preview"}),a.jsx("button",{type:"button",onClick:()=>wt(Me),className:"px-2 py-1 rounded-lg bg-slate-900 text-white text-[11px] hover:bg-slate-800",children:"Download"})]})]},Me.id))]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Consents"}),a.jsxs("form",{onSubmit:ge,className:"space-y-1.5 text-xs",children:[a.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:a.jsx("input",{className:"flex-1 border border-slate-200 rounded-lg px-2 py-1 text-xs",placeholder:"Consent type (eg. General, Surgery)",value:L,onChange:Me=>$(Me.target.value)})}),a.jsx("textarea",{rows:2,className:"w-full border border-slate-200 rounded-lg px-2 py-1 text-xs",placeholder:"Consent text",value:B,onChange:Me=>V(Me.target.value)}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"submit",disabled:S||!L||!B,className:"px-3 py-1 rounded-lg bg-slate-900 text-white disabled:opacity-60",children:S?"Saving":"Add Consent"})})]}),a.jsxs("ul",{className:"divide-y border border-slate-200 rounded-lg bg-slate-50/60",children:[d.length===0&&a.jsx("li",{className:"text-xs text-slate-500 px-2 py-2",children:"No consents captured yet."}),d.map(Me=>a.jsxs("li",{className:"px-2 py-1.5 text-xs",children:[a.jsx("div",{className:"font-medium text-slate-800",children:Me.type}),a.jsx("div",{className:"text-[11px] text-slate-500 mb-0.5",children:new Date(Me.captured_at).toLocaleString()}),a.jsx("div",{className:"text-xs text-slate-800 whitespace-pre-line",children:Me.text})]},Me.id))]})]}),a.jsxs("section",{className:"bg-white border border-slate-200 rounded-2xl p-3 sm:p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-slate-800",children:"Activity / Audit Trail"}),a.jsx("div",{className:"text-[11px] text-slate-500",children:A?"Loading":h.length?`Latest ${h.length} change${h.length>1?"s":""}`:"No history yet"})]}),h.length===0&&!A&&a.jsx("p",{className:"text-[11px] text-slate-500",children:"No change history captured yet for this patient."}),h.length>0&&a.jsx("ol",{className:"space-y-2",children:h.map(Me=>{const qe=oOe(Me),oe=qe.length>3?qe.length-3:0,ue=Me.user_name||Me.user_email||(Me.user_id?`User #${Me.user_id}`:"System"),De=Me.created_at?new Date(Me.created_at).toLocaleString():"";return a.jsxs("li",{className:"flex gap-2",children:[a.jsxs("div",{className:"flex flex-col items-center pt-1",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-900"}),a.jsx("div",{className:"mt-1 flex-1 w-px bg-slate-200"})]}),a.jsxs("div",{className:"flex-1 rounded-xl border border-slate-200 bg-slate-50/80 px-2.5 py-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-[11px]",children:[a.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-900 text-white px-1.5 py-0.5 text-[10px] tracking-wide",children:Me.action||"UPDATE"}),a.jsx("span",{className:"text-slate-700",children:ue})]}),De&&a.jsx("div",{className:"text-[10px] text-slate-500",children:De})]}),qe.length>0&&a.jsxs("ul",{className:"mt-1.5 space-y-0.5 text-[11px] text-slate-700",children:[qe.slice(0,3).map(St=>a.jsxs("li",{className:"flex flex-wrap gap-1",children:[a.jsx("span",{className:"font-medium",children:St.field}),a.jsx("span",{className:"text-slate-500",children:"changed"}),a.jsx("span",{className:"line-through text-slate-400",children:uR(St.before)}),a.jsx("span",{className:"mx-1 text-slate-400",children:""}),a.jsx("span",{className:"font-medium",children:uR(St.after)})]},St.field)),oe>0&&a.jsxs("li",{className:"text-[10px] text-slate-500",children:["+",oe," more field",oe>1?"s":""," updated"]})]}),qe.length===0&&(Me.old_values||Me.new_values)&&a.jsx("p",{className:"mt-1.5 text-[11px] text-slate-600",children:"Multiple fields updated."}),(Me.ip_address||Me.user_agent)&&a.jsxs("p",{className:"mt-1 text-[10px] text-slate-400",children:[Me.ip_address&&a.jsxs("span",{children:["IP: ",Me.ip_address]}),Me.ip_address&&Me.user_agent&&a.jsx("span",{className:"mx-1",children:""}),Me.user_agent&&a.jsx("span",{className:"line-clamp-1",children:Me.user_agent})]})]})]},Me.id)})})]})]})]}),ee&&a.jsx("div",{className:"fixed inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center",children:a.jsxs("div",{className:"relative w-full max-w-3xl h-[80vh] bg-white rounded-2xl shadow-xl flex flex-col overflow-hidden",onClick:Me=>Me.stopPropagation(),children:[a.jsxs("div",{className:"px-4 py-2 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-slate-900",children:["Preview  ",ee.filename]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:be||"Unknown type"})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",onClick:nt,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-900 text-lg leading-none",children:""})})]}),a.jsxs("div",{className:"flex-1 bg-slate-50 flex items-center justify-center",children:[jt&&a.jsx("img",{src:ie,alt:ee.filename,className:"max-h-full max-w-full object-contain"}),ct&&a.jsx("iframe",{src:ie,title:ee.filename,className:"w-full h-full"}),!jt&&!ct&&a.jsxs("div",{className:"text-xs text-slate-600 px-4 text-center space-y-2",children:[a.jsx("p",{children:"This file type cannot be previewed inline."}),a.jsx("button",{type:"button",onClick:()=>wt(ee),className:"inline-flex px-3 py-1.5 rounded-lg bg-slate-900 text-white text-xs hover:bg-slate-800",children:"Download file"})]})]})]})})]})}function dOe(){const[t,n]=y.useState([]),[s,r]=y.useState(!1),[i,l]=y.useState(""),[o,c]=y.useState(!1),[d,u]=y.useState(!1),[h,m]=y.useState(null),[x,b]=y.useState(null),[w,j]=y.useState({refSources:[],doctors:[],payers:[],tpas:[],creditPlans:[],patientTypes:[]}),[S,C]=y.useState(""),[A,k]=y.useState(""),[T,I]=y.useState(""),[D,O]=y.useState(""),[R,P]=y.useState(!1);y.useEffect(()=>{L(),$()},[]);const L=async(ie=i)=>{var he,be;r(!0),C("");try{const we={};ie&&(we.q=ie),A&&(we.patient_type=A);const Z=await uG(we);n(Z.data||[])}catch(we){const Z=((be=(he=we==null?void 0:we.response)==null?void 0:he.data)==null?void 0:be.detail)||(we==null?void 0:we.message)||"Failed to load patients";C(Z),xe.error("Failed to load patients",{description:Z})}finally{r(!1)}},$=async()=>{try{const he=(await YMe()).data||{};j({refSources:he.reference_sources||[],doctors:he.doctors||[],payers:he.payers||[],tpas:he.tpas||[],creditPlans:he.credit_plans||[],patientTypes:he.patient_types||[]})}catch{}},B=ie=>{ie.preventDefault(),L(i)},V=()=>{L(i)},K=()=>{k(""),l(""),L("")},z=()=>{b(null),c(!0)},H=ie=>{b(ie),c(!0)},Y=ie=>{m(ie),u(!0)},G=async ie=>{var he,be;if(window.confirm(`Deactivate patient ${ie.first_name}?`))try{await VMe(ie.id),xe.success("Patient deactivated"),await L()}catch(we){const Z=((be=(he=we==null?void 0:we.response)==null?void 0:he.data)==null?void 0:be.detail)||(we==null?void 0:we.message)||"Failed to deactivate patient";xe.error("Failed to deactivate patient",{description:Z})}},J=ie=>{n(he=>{const be=he.findIndex(Z=>Z.id===ie.id);if(be===-1)return he;const we=[...he];return we[be]=ie,we})},ee=async()=>{var ie,he;if(!T||!D){xe.warning("Please select From and To date for Excel export");return}if(D<T){xe.warning("To Date must be on or after From Date");return}P(!0);try{const be={from_date:T,to_date:D};A&&(be.patient_type=A);const we=await XMe(be),Z=new Blob([we.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ce=window.URL.createObjectURL(Z),Te=document.createElement("a");Te.href=ce,Te.download=`patients_${T}_to_${D}.xlsx`,document.body.appendChild(Te),Te.click(),Te.remove(),window.URL.revokeObjectURL(ce),xe.success("Patient Excel report downloaded")}catch(be){const we=((he=(ie=be==null?void 0:be.response)==null?void 0:ie.data)==null?void 0:he.detail)||(be==null?void 0:be.message)||"Failed to export Excel";xe.error("Failed to export Excel",{description:we})}finally{P(!1)}},ye=y.useMemo(()=>w.patientTypes||[],[w.patientTypes]);return a.jsxs("div",{className:"h-full flex flex-col px-3 py-3 sm:px-5 sm:py-4 gap-3 text-black rounded",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Patient Management"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Register patients, manage profiles, attachments, consents and ABHA."})]}),a.jsx("button",{type:"button",onClick:z,className:"self-start px-3 py-1.5 text-sm rounded-lg bg-slate-900 text-white hover:bg-slate-800",children:"+ New Patient"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("form",{onSubmit:B,className:"flex flex-col sm:flex-row gap-2",children:[a.jsx("input",{className:"flex-1 border border-slate-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-900/10",placeholder:"Search by UHID, name, mobile, email...",value:i,onChange:ie=>l(ie.target.value)}),a.jsx("button",{type:"submit",className:"px-3 py-2 text-sm rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50",children:"Search"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-end md:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-[11px] text-slate-500 mb-0.5",children:"Patient Type"}),a.jsxs("select",{className:"min-w-[160px] border border-slate-200 rounded-lg px-2.5 py-1.5 text-sm",value:A,onChange:ie=>k(ie.target.value),children:[a.jsx("option",{value:"",children:"All Types"}),ye.map(ie=>a.jsx("option",{value:ie.code||ie.name,children:ie.name||ie.code},ie.code||ie.name))]})]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("button",{type:"button",onClick:V,className:"px-3 py-1.5 text-xs rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50",children:"Apply Filter"}),a.jsx("button",{type:"button",onClick:K,className:"px-3 py-1.5 text-xs rounded-lg border border-slate-200 bg-white text-slate-500 hover:bg-slate-50",children:"Reset"})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 items-end",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-[11px] text-slate-500 mb-0.5",children:"From Date"}),a.jsx("input",{type:"date",className:"border border-slate-200 rounded-lg px-2.5 py-1.5 text-sm",value:T,onChange:ie=>I(ie.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-[11px] text-slate-500 mb-0.5",children:"To Date"}),a.jsx("input",{type:"date",className:"border border-slate-200 rounded-lg px-2.5 py-1.5 text-sm",value:D,onChange:ie=>O(ie.target.value)})]}),a.jsx("button",{type:"button",onClick:ee,disabled:R,className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",children:R?"Exporting":"Export Excel"})]})]})]}),S&&a.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:S}),a.jsx("div",{className:"hidden md:block flex-1 border border-slate-200 rounded-2xl overflow-auto bg-white shadow-sm",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"UHID / Name"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Demographics"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Contact"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Tags"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),a.jsxs("tbody",{children:[s&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-xs text-slate-500",children:"Loading patients"})}),!s&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-xs text-slate-500",children:"No patients found."})}),t.map((ie,he)=>a.jsxs("tr",{className:`border-t border-slate-100 hover:bg-slate-50/70 ${he%2===1?"bg-slate-50/40":""}`,children:[a.jsxs("td",{className:"px-3 py-2 align-top",children:[a.jsxs("div",{className:"font-medium text-slate-900",children:[ie.first_name," ",ie.last_name||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",ie.uhid]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Age: ",ie.age_text||""]})]}),a.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{children:["Gender: ",ie.gender]}),a.jsxs("div",{children:["Blood: ",ie.blood_group||""]}),a.jsxs("div",{children:["Marital: ",ie.marital_status||""]})]}),a.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{children:["Mobile: ",ie.phone||""]}),a.jsxs("div",{children:["Email: ",ie.email||""]})]}),a.jsxs("td",{className:"px-3 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{children:["Type: ",ie.patient_type||""]}),a.jsxs("div",{children:["Tag: ",ie.tag||""]})]}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-xs",children:a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx("button",{type:"button",onClick:()=>Y(ie),className:"px-2 py-1 rounded-md border border-slate-200 text-slate-700 hover:bg-slate-50",children:"View"}),a.jsx("button",{type:"button",onClick:()=>H(ie),className:"px-2 py-1 rounded-md border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Edit"}),a.jsx("button",{type:"button",onClick:()=>G(ie),className:"px-2 py-1 rounded-md border border-red-200 text-red-600 hover:bg-red-50",children:"Deactivate"})]})})]},ie.id))]})]})}),a.jsxs("div",{className:"md:hidden space-y-2",children:[s&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading patients"}),!s&&t.length===0&&a.jsx("div",{className:"text-xs text-slate-500",children:"No patients found."}),t.map(ie=>a.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl px-3 py-2 shadow-sm",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[ie.first_name," ",ie.last_name||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",ie.uhid,"  Age: ",ie.age_text||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[ie.gender,"  Blood: ",ie.blood_group||""]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:ie.phone||"No mobile"})]}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("button",{type:"button",onClick:()=>Y(ie),className:"px-2 py-1 text-[11px] rounded-md border border-slate-200 text-slate-700",children:"View"}),a.jsx("button",{type:"button",onClick:()=>H(ie),className:"px-2 py-1 text-[11px] rounded-md border border-slate-200 text-slate-700",children:"Edit"}),a.jsx("button",{type:"button",onClick:()=>G(ie),className:"px-2 py-1 text-[11px] rounded-md border border-red-200 text-red-600",children:"Deactivate"})]})]}),a.jsxs("div",{className:"mt-1.5 flex flex-wrap gap-1 text-[10px] text-slate-600",children:[ie.patient_type&&a.jsx("span",{className:"px-1.5 py-0.5 rounded-full bg-slate-900/5 text-slate-900 border border-slate-200",children:ie.patient_type}),ie.tag&&a.jsx("span",{className:"px-1.5 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:ie.tag})]})]},ie.id))]}),a.jsx(iOe,{open:o,onClose:()=>c(!1),onSaved:()=>L(),initialPatient:x,lookups:w}),a.jsx(cOe,{open:d,onClose:()=>u(!1),patient:h,onUpdated:J})]})}function et(t){const n=kr(o=>o.user),s=kr(o=>o.modules)||{};if(!t||!n)return!1;if(n.is_admin||(n.roles||[]).some(o=>o.name==="Admin"||o.code==="admin"))return!0;const[i]=t.split(".");return(s[i]||[]).some(o=>o.code===t)}const uOe=[{value:"insurance",label:"Insurance"},{value:"corporate",label:"Corporate"},{value:"govt",label:"Govt Scheme"},{value:"other",label:"Other"}];function fOe(){const[t,n]=y.useState("payers"),s=et("patients.masters.view"),r=et("patients.view");return s||r?a.jsxs("div",{className:"space-y-4 bg-white p-3 rounded",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ya,{className:"h-5 w-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-black",children:"Patient Masters"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Configure patient types, payers, TPAs and credit plans used in registration & billing."})]})]})}),a.jsxs("div",{className:"flex flex-wrap gap-2 border-b",children:[a.jsx(fg,{label:"Patient Types",active:t==="types",onClick:()=>n("types")}),a.jsx(fg,{label:"Payers",active:t==="payers",onClick:()=>n("payers")}),a.jsx(fg,{label:"TPAs",active:t==="tpas",onClick:()=>n("tpas")}),a.jsx(fg,{label:"Credit Plans",active:t==="plans",onClick:()=>n("plans")})]}),a.jsxs("div",{children:[t==="types"&&a.jsx(hOe,{}),t==="payers"&&a.jsx(pOe,{}),t==="tpas"&&a.jsx(gOe,{}),t==="plans"&&a.jsx(bOe,{})]})]}):a.jsx("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-4 text-sm text-yellow-800",children:"You do not have permission to view patient masters."})}function fg({label:t,active:n,onClick:s}){return a.jsx("button",{onClick:s,className:`px-3 py-2 text-sm transition ${n?"border-b-2 border-blue-600 font-medium text-blue-700":"text-gray-600 hover:text-gray-800"}`,children:t})}function hOe(){const t=et("patients.view")||et("patients.masters.view"),n=et("patients.update")||et("patients.masters.manage"),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(""),[d,u]=y.useState(""),[h,m]=y.useState(!1),[x,b]=y.useState(null),w=y.useCallback(async()=>{var T,I;if(t){l(!0),c("");try{const{data:D}=await ne.get("/patient-types",{params:{include_inactive:!0}});r(D||[])}catch(D){c(((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to load patient types")}finally{l(!1)}}},[t]);y.useEffect(()=>{w()},[w]);const j=y.useMemo(()=>{if(!d)return s;const T=d.toLowerCase();return s.filter(I=>{var D,O,R;return((D=I.name)==null?void 0:D.toLowerCase().includes(T))||((O=I.code)==null?void 0:O.toLowerCase().includes(T))||((R=I.description)==null?void 0:R.toLowerCase().includes(T))})},[s,d]),S=()=>{b(null),m(!0)},C=T=>{n&&(b(T),m(!0))},A=()=>{m(!1),b(null),w()},k=()=>{w()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(Ji,{className:"h-4 w-4"}),a.jsx("span",{children:"Patient types used in registration: Emergency, OPD, IPD, Health Checkup, etc."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:d,onChange:T=>u(T.target.value),placeholder:"Search code, name, description",className:"w-60 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(jn,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:S,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(Nn,{className:"h-4 w-4"}),"New Patient Type"]})]})]}),o&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:o}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[i&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!i&&j.map(T=>a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold",children:[T.name," ",T.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:T.code})]}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-xs text-gray-500",children:[a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] ${T.is_active?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-gray-100 text-gray-500 border border-gray-200"}`,children:T.is_active?"Active":"Inactive"}),a.jsxs("span",{className:"text-[11px] text-gray-400",children:["Sort: ",T.sort_order??0]})]})]}),n&&a.jsxs("button",{onClick:()=>C(T),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),T.description&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:T.description})]},T.id)),!i&&j.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No patient types found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Description"}),a.jsx("th",{className:"p-2",children:"Sort"}),a.jsx("th",{className:"p-2",children:"Status"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!i&&j.map((T,I)=>a.jsxs("tr",{className:`border-t text-xs ${T.is_active?"text-black":"text-gray-400 bg-gray-50"}`,children:[a.jsx("td",{className:"p-2",children:I+1}),a.jsx("td",{className:"p-2 font-mono text-[11px]",children:T.code}),a.jsx("td",{className:"p-2",children:T.name}),a.jsx("td",{className:"p-2 max-w-xs",children:a.jsx("div",{className:"line-clamp-2 text-[11px] text-gray-600",children:T.description||""})}),a.jsx("td",{className:"p-2",children:T.sort_order??0}),a.jsx("td",{className:"p-2",children:a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] ${T.is_active?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-gray-100 text-gray-500 border border-gray-200"}`,children:T.is_active?"Active":"Inactive"})}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>C(T),className:"inline-flex items-center gap-1 rounded border px-2 py-1 text-[11px] bg-green-300 hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},T.id)),!i&&j.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-6 text-center text-sm text-gray-500",children:"No patient types found."})})]})]})}),h&&a.jsx(mOe,{existing:x,onClose:()=>{m(!1),b(null)},onSaved:A,onDeleted:k})]})}function mOe({existing:t,onClose:n,onSaved:s,onDeleted:r}){const i=et("patients.update")||et("patients.masters.manage"),[l,o]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",is_active:(t==null?void 0:t.is_active)??!0,sort_order:(t==null?void 0:t.sort_order)??0})),[c,d]=y.useState(!1),[u,h]=y.useState(""),m=async b=>{var w,j;if(b.preventDefault(),!!i){d(!0),h("");try{const S={...l,sort_order:Number(l.sort_order)||0};t?await ne.put(`/patient-types/${t.id}`,S):await ne.post("/patient-types",S),s&&s()}catch(S){h(((j=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to save patient type")}finally{d(!1)}}},x=async()=>{var b,w;if(!(!t||!i)&&window.confirm("Deactivate this patient type?")){d(!0),h("");try{await ne.delete(`/patient-types/${t.id}`),r&&r(),n&&n()}catch(j){h(((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to deactivate patient type")}finally{d(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-black",children:t?"Edit Patient Type":"New Patient Type"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Define master types like Emergency, OPD, IPD, Health Checkup, etc."})]}),a.jsx("button",{onClick:n,className:"rounded-xl p-2 hover:bg-gray-100",children:a.jsx(Os,{className:"h-5 w-5"})})]}),u&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:u}),a.jsxs("form",{onSubmit:m,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Code"}),a.jsx("input",{className:"input text-gray-800",value:l.code,onChange:b=>o({...l,code:b.target.value.toUpperCase()}),required:!0}),a.jsx("p",{className:"mt-0.5 text-[10px] text-gray-400",children:"Example: EMERGENCY, OPD, IPD, HC"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Name"}),a.jsx("input",{className:"input text-gray-800",value:l.name,onChange:b=>o({...l,name:b.target.value}),required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Description (optional)"}),a.jsx("textarea",{className:"input min-h-[80px] text-gray-800",value:l.description,onChange:b=>o({...l,description:b.target.value})})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2 items-center",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Sort Order"}),a.jsx("input",{className:"input text-gray-800",type:"number",value:l.sort_order,onChange:b=>o({...l,sort_order:b.target.value})}),a.jsx("p",{className:"mt-0.5 text-[10px] text-gray-400",children:"Lower number shows earlier in dropdowns."})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-4 md:mt-7",children:[a.jsx("input",{id:"pt-active",type:"checkbox",className:"h-4 w-4",checked:l.is_active,onChange:b=>o({...l,is_active:b.target.checked})}),a.jsx("label",{htmlFor:"pt-active",className:"text-xs font-medium text-black",children:"Active"})]})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"rounded-xl border px-4 py-1.5 text-xs hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})})}function pOe(){const t=et("patients.masters.view"),n=et("patients.masters.view"),s=et("patients.masters.manage"),r=n||s,[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,m]=y.useState(""),[x,b]=y.useState(!1),[w,j]=y.useState(null),S=y.useCallback(async()=>{var D,O;if(t){c(!0),u("");try{const{data:R}=await ne.get("/patient-masters/payers");l(R||[])}catch(R){u(((O=(D=R==null?void 0:R.response)==null?void 0:D.data)==null?void 0:O.detail)||"Failed to load payers")}finally{c(!1)}}},[t]);y.useEffect(()=>{S()},[S]);const C=y.useMemo(()=>{if(!h)return i;const D=h.toLowerCase();return i.filter(O=>{var R,P,L;return((R=O.name)==null?void 0:R.toLowerCase().includes(D))||((P=O.code)==null?void 0:P.toLowerCase().includes(D))||((L=O.payer_type)==null?void 0:L.toLowerCase().includes(D))})},[i,h]),A=()=>{j(null),b(!0)},k=D=>{r&&(j(D),b(!0))},T=()=>{b(!1),j(null),S()},I=()=>{S()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(Ji,{className:"h-4 w-4"}),a.jsx("span",{children:"Payers (Insurance / Corporate / Govt schemes)"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:h,onChange:D=>m(D.target.value),placeholder:"Search code, name, type",className:"w-52 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(jn,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),r&&a.jsxs("button",{onClick:A,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(Nn,{className:"h-4 w-4"}),"New Payer"]})]})]}),d&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:d}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[o&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!o&&C.map(D=>a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold ",children:[D.name," ",D.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:D.code})]}),a.jsx("div",{className:"mt-1 text-xs text-gray-500 capitalize",children:D.payer_type||""})]}),r&&a.jsxs("button",{onClick:()=>k(D),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-gray-600",children:[D.contact_person&&a.jsxs("div",{children:["Contact: ",D.contact_person]}),D.phone&&a.jsxs("div",{children:["Phone: ",D.phone]}),D.email&&a.jsxs("div",{children:["Email: ",D.email]}),D.address&&a.jsxs("div",{className:"line-clamp-2",children:["Address: ",D.address]})]})]},D.id)),!o&&C.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No payers found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Type"}),a.jsx("th",{className:"p-2",children:"Contact"}),a.jsx("th",{className:"p-2",children:"Phone / Email"}),a.jsx("th",{className:"p-2",children:"Address"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[o&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!o&&C.map((D,O)=>a.jsxs("tr",{className:"border-t text-xs text-black",children:[a.jsx("td",{className:"p-2",children:O+1}),a.jsx("td",{className:"p-2 font-mono text-[11px]",children:D.code}),a.jsx("td",{className:"p-2",children:D.name}),a.jsx("td",{className:"p-2 capitalize",children:D.payer_type||""}),a.jsx("td",{className:"p-2",children:D.contact_person||""}),a.jsxs("td",{className:"p-2",children:[a.jsx("div",{children:D.phone||""}),a.jsx("div",{className:"text-[11px] text-gray-500",children:D.email||""})]}),a.jsx("td",{className:"p-2 max-w-xs",children:a.jsx("div",{className:"line-clamp-2 text-[11px] text-gray-600",children:D.address||""})}),a.jsx("td",{className:"p-2 text-right",children:r&&a.jsxs("button",{onClick:()=>k(D),className:"inline-flex items-center gap-1 rounded border px-2 py-1 text-[11px] bg-green-300 hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},D.id)),!o&&C.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-6 text-center text-sm text-gray-500",children:"No payers found."})})]})]})}),x&&a.jsx(xOe,{onClose:()=>{b(!1),j(null)},existing:w,onSaved:T,onDeleted:I})]})}function xOe({existing:t,onClose:n,onSaved:s,onDeleted:r}){const i=et("patients.masters.manage"),[l,o]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_type:(t==null?void 0:t.payer_type)||"insurance",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||"",address:(t==null?void 0:t.address)||""})),[c,d]=y.useState(!1),[u,h]=y.useState(""),m=async b=>{var w,j;if(b.preventDefault(),!!i){d(!0),h("");try{t?await ne.put(`/patient-masters/payers/${t.id}`,l):await ne.post("/patient-masters/payers",l),s&&s()}catch(S){h(((j=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to save payer")}finally{d(!1)}}},x=async()=>{var b,w;if(!(!t||!i)&&window.confirm("Deactivate this payer?")){d(!0),h("");try{await ne.delete(`/patient-masters/payers/${t.id}`),r&&r(),n&&n()}catch(j){h(((w=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:w.detail)||"Failed to deactivate payer")}finally{d(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-black",children:t?"Edit Payer":"New Payer"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Master record used for credit / insurance patients."})]}),a.jsx("button",{onClick:n,className:"rounded-xl p-2 bg-yellow-300 hover:bg-gray-100 text-black",children:a.jsx(Os,{className:"h-5 w-5"})})]}),u&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:u}),a.jsxs("form",{onSubmit:m,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Code"}),a.jsx("input",{className:"input text-gray-800",value:l.code,onChange:b=>o({...l,code:b.target.value.toUpperCase()}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Name"}),a.jsx("input",{className:"input text-gray-800",value:l.name,onChange:b=>o({...l,name:b.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Type"}),a.jsx("select",{className:"input text-gray-800",value:l.payer_type,onChange:b=>o({...l,payer_type:b.target.value}),children:uOe.map(b=>a.jsx("option",{value:b.value,children:b.label},b.value))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Contact Person"}),a.jsx("input",{className:"input text-gray-800",value:l.contact_person,onChange:b=>o({...l,contact_person:b.target.value})})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Phone"}),a.jsx("input",{className:"input text-gray-800",value:l.phone,onChange:b=>o({...l,phone:b.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Email"}),a.jsx("input",{className:"input text-gray-800",type:"email",value:l.email,onChange:b=>o({...l,email:b.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium text-black",children:"Address"}),a.jsx("textarea",{className:"input min-h-[80px] text-gray-800",value:l.address,onChange:b=>o({...l,address:b.target.value})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"rounded-xl border px-4 py-1.5 text-xs bg-red-700 hover:bg-red-500",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:c||!i,children:c?"Saving":"Save"})]})]})]})]})})}function gOe(){const t=et("patients.masters.view"),n=et("patients.masters.manage"),[s,r]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(""),[h,m]=y.useState(""),[x,b]=y.useState(!1),[w,j]=y.useState(null),S=y.useCallback(async()=>{var O,R;if(t){c(!0),u("");try{const[P,L]=await Promise.all([ne.get("/patient-masters/tpas"),ne.get("/patient-masters/payers")]);r(P.data||[]),l(L.data||[])}catch(P){u(((R=(O=P==null?void 0:P.response)==null?void 0:O.data)==null?void 0:R.detail)||"Failed to load TPAs")}finally{c(!1)}}},[t]);y.useEffect(()=>{S()},[S]);const C=y.useMemo(()=>{const O={};for(const R of i)O[R.id]=R;return O},[i]),A=y.useMemo(()=>{if(!h)return s;const O=h.toLowerCase();return s.filter(R=>{var P,L,$,B;return((P=R.name)==null?void 0:P.toLowerCase().includes(O))||((L=R.code)==null?void 0:L.toLowerCase().includes(O))||((B=($=C[R.payer_id])==null?void 0:$.name)==null?void 0:B.toLowerCase().includes(O))})},[s,h,C]),k=()=>{j(null),b(!0)},T=O=>{n&&(j(O),b(!0))},I=()=>{b(!1),j(null),S()},D=()=>{S()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(Ji,{className:"h-4 w-4"}),a.jsx("span",{children:"Third-party administrators (TPAs) linked to payers."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:h,onChange:O=>m(O.target.value),placeholder:"Search code, name, payer",className:"w-52 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(jn,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(Nn,{className:"h-4 w-4"}),"New TPA"]})]})]}),d&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:d}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[o&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!o&&A.map(O=>{var R;return a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold",children:[O.name," ",O.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:O.code})]}),a.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Payer: ",((R=C[O.payer_id])==null?void 0:R.name)||""]})]}),n&&a.jsxs("button",{onClick:()=>T(O),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-gray-600",children:[O.contact_person&&a.jsxs("div",{children:["Contact: ",O.contact_person]}),O.phone&&a.jsxs("div",{children:["Phone: ",O.phone]}),O.email&&a.jsxs("div",{children:["Email: ",O.email]})]})]},O.id)}),!o&&A.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No TPAs found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Payer"}),a.jsx("th",{className:"p-2",children:"Contact"}),a.jsx("th",{className:"p-2",children:"Phone / Email"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[o&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!o&&A.map((O,R)=>{var P;return a.jsxs("tr",{className:"border-t text-xs",children:[a.jsx("td",{className:"p-2 text-gray-800",children:R+1}),a.jsx("td",{className:"p-2 font-mono text-[11px] text-gray-800",children:O.code}),a.jsx("td",{className:"p-2 text-gray-800",children:O.name}),a.jsx("td",{className:"p-2 text-gray-800",children:((P=C[O.payer_id])==null?void 0:P.name)||""}),a.jsx("td",{className:"p-2 text-gray-800",children:O.contact_person||""}),a.jsxs("td",{className:"p-2 text-gray-800",children:[a.jsx("div",{children:O.phone||""}),a.jsx("div",{className:"text-[11px] text-gray-500",children:O.email||""})]}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>T(O),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-[11px] hover:bg-gray-500 bg-green-300",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},O.id)}),!o&&A.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-6 text-center text-sm text-gray-500",children:"No TPAs found."})})]})]})}),x&&a.jsx(yOe,{existing:w,onClose:()=>{b(!1),j(null)},payers:i,onSaved:I,onDeleted:D})]})}function yOe({existing:t,payers:n,onClose:s,onSaved:r,onDeleted:i}){const l=et("patients.masters.manage"),[o,c]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",contact_person:(t==null?void 0:t.contact_person)||"",phone:(t==null?void 0:t.phone)||"",email:(t==null?void 0:t.email)||""})),[d,u]=y.useState(!1),[h,m]=y.useState(""),x=async w=>{var j,S;if(w.preventDefault(),!!l){u(!0),m("");try{const C={...o,payer_id:o.payer_id?Number(o.payer_id):null};t?await ne.put(`/patient-masters/tpas/${t.id}`,C):await ne.post("/patient-masters/tpas",C),r&&r()}catch(C){m(((S=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:S.detail)||"Failed to save TPA")}finally{u(!1)}}},b=async()=>{var w,j;if(!(!t||!l)&&window.confirm("Deactivate this TPA?")){u(!0),m("");try{await ne.delete(`/patient-masters/tpas/${t.id}`),i&&i(),s&&s()}catch(S){m(((j=(w=S==null?void 0:S.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to deactivate TPA")}finally{u(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:t?"Edit TPA":"New TPA"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Third-party administrator master, mapped to payer."})]}),a.jsx("button",{onClick:s,className:"rounded-xl p-2 hover:bg-gray-100",children:a.jsx(Os,{className:"h-5 w-5"})})]}),h&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:h}),a.jsxs("form",{onSubmit:x,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Code"}),a.jsx("input",{className:"input",value:o.code,onChange:w=>c({...o,code:w.target.value.toUpperCase()}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Name"}),a.jsx("input",{className:"input",value:o.name,onChange:w=>c({...o,name:w.target.value}),required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Payer"}),a.jsxs("select",{className:"input",value:o.payer_id||"",onChange:w=>c({...o,payer_id:w.target.value||""}),required:!0,children:[a.jsx("option",{value:"",children:"Select payer"}),n.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Contact Person"}),a.jsx("input",{className:"input",value:o.contact_person,onChange:w=>c({...o,contact_person:w.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Phone"}),a.jsx("input",{className:"input",value:o.phone,onChange:w=>c({...o,phone:w.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Email"}),a.jsx("input",{className:"input",type:"email",value:o.email,onChange:w=>c({...o,email:w.target.value})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:b,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:s,className:"rounded-xl border px-4 py-1.5 text-xs hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:d||!l,children:d?"Saving":"Save"})]})]})]})]})})}function bOe(){const t=et("patients.masters.view"),n=et("patients.masters.manage"),[s,r]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),[S,C]=y.useState(null),A=y.useCallback(async()=>{var L,$;if(t){u(!0),m("");try{const[B,V,K]=await Promise.all([ne.get("/patient-masters/credit-plans"),ne.get("/patient-masters/payers"),ne.get("/patient-masters/tpas")]);r(B.data||[]),l(V.data||[]),c(K.data||[])}catch(B){m((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to load credit plans")}finally{u(!1)}}},[t]);y.useEffect(()=>{A()},[A]);const k=y.useMemo(()=>{const L={};for(const $ of i)L[$.id]=$;return L},[i]),T=y.useMemo(()=>{const L={};for(const $ of o)L[$.id]=$;return L},[o]),I=y.useMemo(()=>{if(!x)return s;const L=x.toLowerCase();return s.filter($=>{var B,V,K,z,H,Y;return((B=$.name)==null?void 0:B.toLowerCase().includes(L))||((V=$.code)==null?void 0:V.toLowerCase().includes(L))||((z=(K=k[$.payer_id])==null?void 0:K.name)==null?void 0:z.toLowerCase().includes(L))||((Y=(H=T[$.tpa_id])==null?void 0:H.name)==null?void 0:Y.toLowerCase().includes(L))})},[s,x,k,T]),D=()=>{C(null),j(!0)},O=L=>{n&&(C(L),j(!0))},R=()=>{j(!1),C(null),A()},P=()=>{A()};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(n7,{className:"h-4 w-4"}),a.jsx("span",{children:"Credit / insurance plans used for IPD/OPD billing & authorization."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{value:x,onChange:L=>b(L.target.value),placeholder:"Search code, name, payer, TPA",className:"w-60 max-w-full rounded-xl border px-8 py-1.5 text-sm"}),a.jsx(jn,{className:"pointer-events-none absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"})]}),n&&a.jsxs("button",{onClick:D,className:"inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700 active:scale-95",children:[a.jsx(Nn,{className:"h-4 w-4"}),"New Plan"]})]})]}),h&&a.jsx("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:h}),a.jsxs("div",{className:"grid gap-3 sm:hidden",children:[d&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"Loading"}),!d&&I.map(L=>{var $,B;return a.jsxs("div",{className:"rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-semibold",children:[L.name," ",L.code&&a.jsx("span",{className:"ml-1 rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-mono text-gray-600",children:L.code})]}),a.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Payer: ",(($=k[L.payer_id])==null?void 0:$.name)||""]}),a.jsxs("div",{className:"mt-0.5 text-xs text-gray-500",children:["TPA: ",((B=T[L.tpa_id])==null?void 0:B.name)||""]})]}),n&&a.jsxs("button",{onClick:()=>O(L),className:"inline-flex items-center gap-1 rounded-xl border px-2 py-1 text-xs hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})]}),L.description&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:L.description})]},L.id)}),!d&&I.length===0&&a.jsx("div",{className:"rounded-2xl border bg-white p-4 text-center text-sm text-gray-500",children:"No credit plans found."})]}),a.jsx("div",{className:"hidden overflow-x-auto rounded-2xl border bg-white sm:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"text-left text-xs font-medium text-gray-600",children:[a.jsx("th",{className:"p-2",children:"#"}),a.jsx("th",{className:"p-2",children:"Code"}),a.jsx("th",{className:"p-2",children:"Name"}),a.jsx("th",{className:"p-2",children:"Payer"}),a.jsx("th",{className:"p-2",children:"TPA"}),a.jsx("th",{className:"p-2",children:"Description"}),a.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[d&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-sm text-gray-500",children:"Loading"})}),!d&&I.map((L,$)=>{var B,V;return a.jsxs("tr",{className:"border-t text-xs text-black",children:[a.jsx("td",{className:"p-2",children:$+1}),a.jsx("td",{className:"p-2 font-mono text-[11px]",children:L.code}),a.jsx("td",{className:"p-2",children:L.name}),a.jsx("td",{className:"p-2",children:((B=k[L.payer_id])==null?void 0:B.name)||""}),a.jsx("td",{className:"p-2",children:((V=T[L.tpa_id])==null?void 0:V.name)||""}),a.jsx("td",{className:"p-2 max-w-xs",children:a.jsx("div",{className:"line-clamp-2 text-[11px] text-gray-600",children:L.description||""})}),a.jsx("td",{className:"p-2 text-right",children:n&&a.jsxs("button",{onClick:()=>O(L),className:"inline-flex items-center gap-1 rounded border px-2 py-1 text-[11px] bg-green-300 hover:bg-gray-50",children:[a.jsx(Xa,{className:"h-3.5 w-3.5"}),"Edit"]})})]},L.id)}),!d&&I.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-6 text-center text-sm text-gray-500",children:"No credit plans found."})})]})]})}),w&&a.jsx(vOe,{existing:S,payers:i,tpas:o,onClose:()=>{j(!1),C(null)},onSaved:R,onDeleted:P})]})}function vOe({existing:t,payers:n,tpas:s,onClose:r,onSaved:i,onDeleted:l}){const o=et("patients.masters.manage"),[c,d]=y.useState(()=>({code:(t==null?void 0:t.code)||"",name:(t==null?void 0:t.name)||"",payer_id:(t==null?void 0:t.payer_id)||"",tpa_id:(t==null?void 0:t.tpa_id)||"",description:(t==null?void 0:t.description)||""})),[u,h]=y.useState(!1),[m,x]=y.useState(""),b=async j=>{var S,C;if(j.preventDefault(),!!o){h(!0),x("");try{const A={...c,payer_id:c.payer_id?Number(c.payer_id):null,tpa_id:c.tpa_id?Number(c.tpa_id):null};t?await ne.put(`/patient-masters/credit-plans/${t.id}`,A):await ne.post("/patient-masters/credit-plans",A),i&&i()}catch(A){x(((C=(S=A==null?void 0:A.response)==null?void 0:S.data)==null?void 0:C.detail)||"Failed to save credit plan")}finally{h(!1)}}},w=async()=>{var j,S;if(!(!t||!o)&&window.confirm("Deactivate this credit plan?")){h(!0),x("");try{await ne.delete(`/patient-masters/credit-plans/${t.id}`),l&&l(),r&&r()}catch(C){x(((S=(j=C==null?void 0:C.response)==null?void 0:j.data)==null?void 0:S.detail)||"Failed to deactivate credit plan")}finally{h(!1)}}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:a.jsxs("div",{className:"max-h-[90vh] w-full max-w-xl overflow-y-auto rounded-2xl bg-white p-5 shadow-xl",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:t?"Edit Credit Plan":"New Credit Plan"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Map plan to payer & optional TPA for billing workflows."})]}),a.jsx("button",{onClick:r,className:"rounded-xl p-2 hover:bg-gray-100",children:a.jsx(Os,{className:"h-5 w-5"})})]}),m&&a.jsx("div",{className:"mb-3 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:m}),a.jsxs("form",{onSubmit:b,className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Code"}),a.jsx("input",{className:"input",value:c.code,onChange:j=>d({...c,code:j.target.value.toUpperCase()}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Name"}),a.jsx("input",{className:"input",value:c.name,onChange:j=>d({...c,name:j.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Payer"}),a.jsxs("select",{className:"input",value:c.payer_id||"",onChange:j=>d({...c,payer_id:j.target.value||""}),required:!0,children:[a.jsx("option",{value:"",children:"Select payer"}),n.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"TPA (optional)"}),a.jsxs("select",{className:"input",value:c.tpa_id||"",onChange:j=>d({...c,tpa_id:j.target.value||""}),children:[a.jsx("option",{value:"",children:"No TPA"}),s.map(j=>a.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-xs font-medium",children:"Description / Notes"}),a.jsx("textarea",{className:"input min-h-[80px]",value:c.description,onChange:j=>d({...c,description:j.target.value})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[t&&a.jsxs("button",{type:"button",onClick:w,className:"inline-flex items-center gap-2 rounded-xl border border-rose-200 px-3 py-1.5 text-xs font-medium text-rose-700 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3.5 w-3.5"}),"Deactivate"]}),a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx("button",{type:"button",onClick:r,className:"rounded-xl border px-4 py-1.5 text-xs hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{className:"btn",disabled:u||!o,children:u?"Saving":"Save"})]})]})]})]})})}const fR=[{key:"all",label:"All"},{key:"op_billing",label:"OP Billing"},{key:"ip_billing",label:"IP Billing"},{key:"lab",label:"Lab"},{key:"pharmacy",label:"Pharmacy"},{key:"radiology",label:"Radiology"},{key:"general",label:"General"}],wOe={draft:"bg-yellow-100 text-yellow-800",finalized:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},Cm=10;function R2(t){return Number(t||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function NOe(){var K;const[t,n]=y.useState("all"),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState({doctors:[],credit_providers:[],packages:[],payers:[],tpas:[],credit_plans:[]}),[d,u]=y.useState(!1),[h,m]=y.useState(""),[x,b]=y.useState(1),[w,j]=y.useState({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),S=Aa();y.useEffect(()=>{C()},[]),y.useEffect(()=>{A()},[t]);async function C(){try{const{data:z}=await eA();c({doctors:(z==null?void 0:z.doctors)||[],credit_providers:(z==null?void 0:z.credit_providers)||[],packages:(z==null?void 0:z.packages)||[],payers:(z==null?void 0:z.payers)||[],tpas:(z==null?void 0:z.tpas)||[],credit_plans:(z==null?void 0:z.credit_plans)||[]})}catch(z){console.error("Failed to load billing masters",z)}}async function A(){l(!0),m("");try{const z={};t!=="all"&&(z.billing_type=t);const{data:H}=await qde(z);r(H||[]),b(1)}catch(z){console.error("Failed to load invoices",z),m("Unable to load invoices. Please try again.")}finally{l(!1)}}function k(z){S(`/billing/invoices/${z}`)}function T(z){n(z)}function I(z){const{name:H,value:Y}=z.target;j(G=>({...G,[H]:Y}))}function D(z){j(typeof z=="number"?H=>({...H,patient_id:z}):z&&typeof z=="object"?H=>({...H,patient_id:z.id}):H=>({...H,patient_id:null}))}async function O(z){if(z.preventDefault(),m(""),!w.patient_id){m("Please select a patient to create an invoice.");return}try{const H={patient_id:Number(w.patient_id),billing_type:w.billing_type||null,context_type:w.context_type||null,context_id:w.context_id?Number(w.context_id):null,remarks:w.remarks||null},{data:Y}=await Hde(H);u(!1),j({patient_id:null,billing_type:"op_billing",context_type:"opd",context_id:"",remarks:""}),S(`/billing/invoices/${Y.id}`)}catch(H){console.error("Create invoice failed",H),m("Unable to create invoice. Please check details and try again.")}}const R=y.useMemo(()=>Math.max(1,Math.ceil(s.length/Cm)),[s.length]),P=y.useMemo(()=>{const z=(x-1)*Cm;return s.slice(z,z+Cm)},[s,x]);function L(){b(z=>Math.max(1,z-1))}function $(){b(z=>Math.min(R,z+1))}const B=s.length===0?0:(x-1)*Cm+1,V=s.length===0?0:Math.min(x*Cm,s.length);return a.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-gradient-to-b from-slate-50 via-slate-100 to-slate-50 py-4 px-3 md:px-6",children:[a.jsxs("div",{className:"max-w-6xl mx-auto space-y-4",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Billing Console"}),a.jsx("p",{className:"text-xs md:text-sm text-slate-500",children:"One place to manage OP / IP / Lab / Pharmacy billing, refunds and credit tracking."})]}),a.jsx("button",{type:"button",onClick:()=>u(!0),className:"inline-flex items-center justify-center rounded-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 px-4 py-2 text-xs md:text-sm font-medium text-white shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"+ New Invoice"})]}),a.jsx("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-50 via-sky-50 to-purple-50 p-2 shadow-sm border border-slate-100",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:fR.map(z=>{const H=t===z.key;return a.jsx("button",{type:"button",onClick:()=>T(z.key),className:`whitespace-nowrap rounded-full px-3.5 py-1.5 text-xs md:text-[13px] font-medium transition-all ${H?"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 text-white shadow-md":"bg-white/70 text-slate-700 hover:bg-white hover:text-slate-900 border border-slate-200"}`,children:z.label},z.key)})})}),a.jsxs("div",{className:"rounded-2xl bg-white shadow-sm border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 md:px-4 py-2 border-b border-slate-100",children:[a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Invoices"}),a.jsx("span",{className:"text-[11px] text-slate-400",children:t==="all"?"All billing types":`Filtered by ${((K=fR.find(z=>z.key===t))==null?void 0:K.label)||""}`})]}),a.jsx("button",{type:"button",onClick:A,className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Refresh"})]}),h&&a.jsx("div",{className:"px-3 md:px-4 py-2 bg-red-50 text-[11px] text-red-700",children:h}),i?a.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"Loading invoices..."}):s.length===0?a.jsx("div",{className:"px-3 md:px-4 py-8 text-center text-xs text-slate-500",children:"No invoices found for this filter."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto text-xs",children:a.jsxs("table",{className:"min-w-full divide-y divide-slate-100",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Inv #"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Billing Type"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Patient"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Net"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Paid"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-right font-medium text-slate-500",children:"Balance"}),a.jsx("th",{className:"px-3 md:px-4 py-2 text-left font-medium text-slate-500",children:"Status"}),a.jsx("th",{className:"px-3 md:px-4 py-2"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:P.map(z=>a.jsxs("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>k(z.id),children:[a.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-800 whitespace-nowrap",children:z.invoice_number||z.id}),a.jsx("td",{className:"px-3 md:px-4 py-2 text-slate-600 whitespace-nowrap",children:z.billing_type||"general"}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-slate-500 whitespace-nowrap",children:["#",z.patient_id]}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",R2(z.net_total)]}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-600 whitespace-nowrap",children:[" ",R2(z.amount_paid)]}),a.jsxs("td",{className:"px-3 md:px-4 py-2 text-right text-slate-800 whitespace-nowrap",children:[" ",R2(z.balance_due)]}),a.jsx("td",{className:"px-3 md:px-4 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-[10px] font-medium ${wOe[z.status]||"bg-slate-100 text-slate-700"}`,children:z.status})}),a.jsx("td",{className:"px-3 md:px-4 py-2 text-right whitespace-nowrap",children:a.jsx("span",{className:"text-[11px] text-indigo-600 hover:text-indigo-800",children:"Open "})})]},z.id))})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 px-3 md:px-4 py-3 border-t border-slate-100 text-[11px]",children:[a.jsxs("div",{className:"text-slate-500",children:["Showing ",a.jsx("span",{className:"font-medium",children:B}),"",a.jsx("span",{className:"font-medium",children:V})," of"," ",a.jsx("span",{className:"font-medium",children:s.length})," ","invoices"]}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:L,disabled:x===1,className:`px-2.5 py-1 rounded-md border text-[11px] ${x===1?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Prev"}),a.jsxs("span",{className:"text-slate-500",children:["Page"," ",a.jsx("span",{className:"font-semibold text-slate-800",children:x})," ","/ ",R]}),a.jsx("button",{type:"button",onClick:$,disabled:x===R,className:`px-2.5 py-1 rounded-md border text-[11px] ${x===R?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-300 text-slate-700 hover:bg-slate-50"}`,children:"Next"})]})]})]})]})]}),d&&a.jsx("div",{className:"fixed inset-0 z-30 flex items-end sm:items-center justify-center bg-black/40",children:a.jsxs("div",{className:"w-full sm:max-w-md bg-white rounded-t-2xl sm:rounded-2xl shadow-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"New Invoice"}),a.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-xs text-slate-400 hover:text-slate-600",children:""})]}),a.jsxs("form",{className:"space-y-3",onSubmit:O,children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient"}),a.jsx(j$,{value:w.patient_id,onChange:D}),a.jsx("p",{className:"text-[10px] text-slate-400",children:"Search by name / UHID / phone and pick the patient for billing."})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Billing Type"}),a.jsxs("select",{name:"billing_type",value:w.billing_type,onChange:I,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[a.jsx("option",{value:"op_billing",children:"OP Billing"}),a.jsx("option",{value:"ip_billing",children:"IP Billing"}),a.jsx("option",{value:"lab",children:"Lab"}),a.jsx("option",{value:"pharmacy",children:"Pharmacy"}),a.jsx("option",{value:"radiology",children:"Radiology"}),a.jsx("option",{value:"general",children:"General"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context Type (optional)"}),a.jsxs("select",{name:"context_type",value:w.context_type,onChange:I,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[a.jsx("option",{value:"",children:"None"}),a.jsx("option",{value:"opd",children:"OPD"}),a.jsx("option",{value:"ipd",children:"IPD"}),a.jsx("option",{value:"lab",children:"Lab"}),a.jsx("option",{value:"radiology",children:"Radiology"}),a.jsx("option",{value:"pharmacy",children:"Pharmacy"}),a.jsx("option",{value:"other",children:"Other"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Context ID (optional)"}),a.jsx("input",{type:"number",name:"context_id",value:w.context_id,onChange:I,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Visit / admission / order id"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Remarks (optional)"}),a.jsx("input",{type:"text",name:"remarks",value:w.remarks,onChange:I,className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"Any note for this invoice"})]})]}),h&&a.jsx("p",{className:"text-[11px] text-red-600",children:h}),a.jsxs("div",{className:"flex gap-2 justify-end pt-1",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-3 py-1.5 rounded-md bg-indigo-600 text-xs font-medium text-white hover:bg-indigo-700",children:"Create & Open"})]})]})]})})]})}var jOe="Label",fG=y.forwardRef((t,n)=>a.jsx(Yt.label,{...t,ref:n,onMouseDown:s=>{var i;s.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));fG.displayName=jOe;var hG=fG;const SOe=Ob("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ye=y.forwardRef(({className:t,...n},s)=>a.jsx(hG,{ref:s,className:It(SOe(),t),...n}));Ye.displayName=hG.displayName;function bl({label:t,name:n,value:s,onChange:r}){return a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:t}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(_e,{type:"color",value:s||"#ffffff",onChange:i=>r(n,i.target.value),className:"w-12 h-9 p-1 cursor-pointer"}),a.jsx(_e,{type:"text",value:s||"",onChange:i=>r(n,i.target.value),placeholder:"#0f172a",className:"flex-1"})]})]})}function _Oe(){const{branding:t,setBranding:n,loading:s}=kh()||{},[r,i]=y.useState({}),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[m,x]=y.useState(null),[b,w]=y.useState(null),[j,S]=y.useState(null),[C,A]=y.useState(null),[k,T]=y.useState(null),[I,D]=y.useState("background");y.useEffect(()=>{t&&(D(t.letterhead_position||"background"),i({org_name:t.org_name||"",org_tagline:t.org_tagline||"",org_address:t.org_address||"",org_phone:t.org_phone||"",org_email:t.org_email||"",org_website:t.org_website||"",org_gstin:t.org_gstin||"",primary_color:t.primary_color||"",primary_color_dark:t.primary_color_dark||"",sidebar_bg_color:t.sidebar_bg_color||"",content_bg_color:t.content_bg_color||"",card_bg_color:t.card_bg_color||"",border_color:t.border_color||"",text_color:t.text_color||"",text_muted_color:t.text_muted_color||"",icon_color:t.icon_color||"",icon_bg_color:t.icon_bg_color||"",pdf_header_height_mm:typeof t.pdf_header_height_mm=="number"?t.pdf_header_height_mm:"",pdf_footer_height_mm:typeof t.pdf_footer_height_mm=="number"?t.pdf_footer_height_mm:"",pdf_show_page_number:typeof t.pdf_show_page_number=="boolean"?t.pdf_show_page_number:!0}))},[t]);const O=(Y,G)=>{i(J=>({...J,[Y]:G}))},R=Y=>G=>{O(Y,G.target.value)},P=Y=>G=>{const J=G.target.value;O(Y,J===""?"":Number(J))},L=Y=>G=>{O(Y,!!G.target.checked)},$=(Y,G)=>{O(Y,G)},B=async()=>{var Y,G,J,ee;o(!0);try{const ye={...r,pdf_header_height_mm:r.pdf_header_height_mm===""?null:Number(r.pdf_header_height_mm),pdf_footer_height_mm:r.pdf_footer_height_mm===""?null:Number(r.pdf_footer_height_mm)},{data:ie}=await Xoe(ye);n==null||n(ie),xe.success("Branding settings updated")}catch(ye){console.error("Failed to update branding settings",ye);const ie=((G=(Y=ye==null?void 0:ye.response)==null?void 0:Y.data)==null?void 0:G.detail)||((ee=(J=ye==null?void 0:ye.response)==null?void 0:J.data)==null?void 0:ee.message)||(ye==null?void 0:ye.message)||"Could not save branding settings";xe.error(ie)}finally{o(!1)}},V=async Y=>{Y.preventDefault(),await B()},K=async Y=>{Y.preventDefault(),await B()},z=async()=>{var G,J,ee,ye;if(!k){xe.warning("Select a letterhead file first");return}const Y=new FormData;Y.append("file",k),Y.append("position",I);try{const{data:ie}=await Zoe(Y);n==null||n(ie),xe.success("Letterhead updated successfully"),T(null)}catch(ie){console.error("Failed to upload letterhead",ie);const he=((J=(G=ie==null?void 0:ie.response)==null?void 0:G.data)==null?void 0:J.detail)||((ye=(ee=ie==null?void 0:ie.response)==null?void 0:ee.data)==null?void 0:ye.message)||(ie==null?void 0:ie.message)||"Could not upload letterhead";xe.error(he)}},H=async Y=>{var J,ee,ye,ie;if(Y.preventDefault(),!u&&!m&&!b&&!j&&!C){xe.warning("Select at least one file to upload");return}const G=new FormData;u&&G.append("logo",u),m&&G.append("login_logo",m),b&&G.append("favicon",b),j&&G.append("pdf_header",j),C&&G.append("pdf_footer",C),d(!0);try{const{data:he}=await Qoe(G);n==null||n(he),xe.success("Branding files uploaded"),h(null),x(null),w(null),S(null),A(null)}catch(he){console.error("Failed to upload branding files",he);const be=((ee=(J=he==null?void 0:he.response)==null?void 0:J.data)==null?void 0:ee.detail)||((ie=(ye=he==null?void 0:he.response)==null?void 0:ye.data)==null?void 0:ie.message)||(he==null?void 0:he.message)||"Could not upload branding files";xe.error(be)}finally{d(!1)}};return s||!t?a.jsxs("div",{className:"p-6",children:[a.jsx(Ze,{className:"h-7 w-64 mb-3"}),a.jsx(Ze,{className:"h-64 w-full"})]}):a.jsxs(gt.div,{className:"p-6 space-y-4",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2},children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Customization & Templates"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Configure organisation identity, logo, UI colors, and global PDF header/footer for all NABH HIMS documents."})]})}),a.jsxs(Le,{className:"border border-slate-200 rounded-2xl shadow-sm bg-white",children:[a.jsx(Je,{className:"pb-2",children:a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Global Branding & PDF Settings"})}),a.jsx(ze,{children:a.jsxs(_o,{defaultValue:"branding",children:[a.jsxs(Ll,{className:"mb-4",children:[a.jsx(dn,{value:"branding",children:"Branding & Organisation"}),a.jsx(dn,{value:"pdf",children:"PDF Header / Footer & Behaviour"})]}),a.jsx(mn,{value:"branding",className:"space-y-6",children:a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Organisation details"}),a.jsx("p",{className:"text-xs text-slate-500",children:"These values appear on letterheads, EMR PDFs, discharge summaries and other NABH documents."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Organisation name"}),a.jsx(_e,{value:r.org_name||"",onChange:R("org_name"),placeholder:"Hospital / Clinic name"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Tagline"}),a.jsx(_e,{value:r.org_tagline||"",onChange:R("org_tagline"),placeholder:"Smart  Secure  NABH-Standard"})]}),a.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Address"}),a.jsx(_e,{value:r.org_address||"",onChange:R("org_address"),placeholder:"Address line for letterhead & PDFs"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Phone"}),a.jsx(_e,{value:r.org_phone||"",onChange:R("org_phone"),placeholder:"+91-XXXXXXXXXX"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Email"}),a.jsx(_e,{type:"email",value:r.org_email||"",onChange:R("org_email"),placeholder:"info@example.com"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Website"}),a.jsx(_e,{value:r.org_website||"",onChange:R("org_website"),placeholder:"https://your-hospital.com"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"GSTIN"}),a.jsx(_e,{value:r.org_gstin||"",onChange:R("org_gstin"),placeholder:"GSTIN (optional, for bills)"})]})]})]}),a.jsx("div",{className:"border-t border-slate-100"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Color palette"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Tune application colors. These drive sidebar, primary buttons and card backgrounds."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(bl,{label:"Primary color (buttons, highlights)",name:"primary_color",value:r.primary_color,onChange:$}),a.jsx(bl,{label:"Primary dark (topbar / hover)",name:"primary_color_dark",value:r.primary_color_dark,onChange:$}),a.jsx(bl,{label:"Sidebar background color",name:"sidebar_bg_color",value:r.sidebar_bg_color,onChange:$}),a.jsx(bl,{label:"Content background color",name:"content_bg_color",value:r.content_bg_color,onChange:$}),a.jsx(bl,{label:"Card background color",name:"card_bg_color",value:r.card_bg_color,onChange:$}),a.jsx(bl,{label:"Border color",name:"border_color",value:r.border_color,onChange:$}),a.jsx(bl,{label:"Text color",name:"text_color",value:r.text_color,onChange:$}),a.jsx(bl,{label:"Muted text color",name:"text_muted_color",value:r.text_muted_color,onChange:$}),a.jsx(bl,{label:"Icon color",name:"icon_color",value:r.icon_color,onChange:$}),a.jsx(bl,{label:"Icon background color",name:"icon_bg_color",value:r.icon_bg_color,onChange:$})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[(t==null?void 0:t.logo_url)&&a.jsx("img",{src:t.logo_url,alt:"Logo preview",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white"}),a.jsxs("span",{className:"text-xs text-slate-500",children:["Logos & PDF artwork are managed in the"," ",a.jsx("span",{className:"font-medium",children:"PDF Header / Footer"})," tab."]})]}),a.jsx(Pe,{type:"submit",disabled:l,className:"min-w-[140px]",children:l?"Saving":"Save branding"})]})]})}),a.jsxs(mn,{value:"pdf",className:"space-y-6",children:[a.jsxs("form",{onSubmit:H,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:"Application logo (sidebar / topbar)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.logo_url)&&a.jsx("img",{src:t.logo_url,alt:"Logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(fm,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose logo (PNG / JPG)"})]}),a.jsx(_e,{type:"file",accept:"image/*",className:"hidden",onChange:Y=>{var G;return h(((G=Y.target.files)==null?void 0:G[0])||null)}})]}),u&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:u.name})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:"Login-page logo (optional)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.login_logo_url)&&a.jsx("img",{src:t.login_logo_url,alt:"Login logo",className:"h-8 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(fm,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose login logo"})]}),a.jsx(_e,{type:"file",accept:"image/*",className:"hidden",onChange:Y=>{var G;return x(((G=Y.target.files)==null?void 0:G[0])||null)}})]}),m&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:m.name})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:"Favicon (browser tab icon)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.favicon_url)&&a.jsx("img",{src:t.favicon_url,alt:"Favicon",className:"h-6 w-6 rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(fm,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose favicon (PNG / ICO)"})]}),a.jsx(_e,{type:"file",accept:"image/*,.ico",className:"hidden",onChange:Y=>{var G;return w(((G=Y.target.files)==null?void 0:G[0])||null)}})]}),b&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:b.name})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:"PDF header template (all documents)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_header_url)&&a.jsx("img",{src:t.pdf_header_url,alt:"PDF header",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(fm,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose header image"})]}),a.jsx(_e,{type:"file",accept:"image/*",className:"hidden",onChange:Y=>{var G;return S(((G=Y.target.files)==null?void 0:G[0])||null)}})]}),j&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:j.name})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:"PDF footer template (all documents)"}),a.jsxs("div",{className:"border border-dashed border-slate-300 rounded-2xl p-3 flex flex-col items-center gap-2",children:[(t==null?void 0:t.pdf_footer_url)&&a.jsx("img",{src:t.pdf_footer_url,alt:"PDF footer",className:"h-12 w-auto rounded-sm border border-slate-200 bg-white mb-1"}),a.jsxs("label",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs cursor-pointer",children:[a.jsx(fm,{className:"h-4 w-4"}),a.jsx("span",{children:"Choose footer image"})]}),a.jsx(_e,{type:"file",accept:"image/*",className:"hidden",onChange:Y=>{var G;return A(((G=Y.target.files)==null?void 0:G[0])||null)}})]}),C&&a.jsx("p",{className:"text-[11px] text-slate-500 truncate w-full text-center",children:C.name})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-2",children:[a.jsx("p",{className:"text-[11px] text-slate-500 max-w-xl",children:"These logo/header/footer templates will be applied to all PDF downloads (EMR, discharge summary, lab reports, invoices, etc.) to keep NABH-compliant formatting."}),a.jsx(Pe,{type:"submit",disabled:c,className:"min-w-[160px]",children:c?"Uploading":"Upload artwork"})]})]}),a.jsxs("form",{onSubmit:K,className:"space-y-4",children:[a.jsx("div",{className:"border-t border-slate-100 pt-4"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"PDF layout behaviour"}),a.jsx("p",{className:"text-xs text-slate-500",children:'Control reserved space for header/footer and whether to show "Page X of Y" in the footer.'}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Header height (mm)"}),a.jsx(_e,{type:"number",min:0,value:r.pdf_header_height_mm===""?"":r.pdf_header_height_mm,onChange:P("pdf_header_height_mm"),placeholder:"Auto"}),a.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on header image."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Footer height (mm)"}),a.jsx(_e,{type:"number",min:0,value:r.pdf_footer_height_mm===""?"":r.pdf_footer_height_mm,onChange:P("pdf_footer_height_mm"),placeholder:"Auto"}),a.jsx("p",{className:"text-[11px] text-slate-400",children:"Leave blank to auto-calc based on footer image."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Page number in footer"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300",checked:!!r.pdf_show_page_number,onChange:L("pdf_show_page_number")}),a.jsx("span",{children:'Show "Page X of Y" on all PDFs'})]})]})]})]}),a.jsx("div",{className:"flex items-center justify-end pt-1",children:a.jsx(Pe,{type:"submit",disabled:l,className:"min-w-[160px]",children:l?"Saving":"Save PDF settings"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ye,{className:"text-xs font-medium text-slate-600",children:"Upload Letterhead (PDF / JPG / PNG / DOCX)"}),a.jsxs("div",{className:"border border-dashed p-3 rounded-xl space-y-3",children:[(t==null?void 0:t.letterhead_url)&&a.jsxs("p",{className:"text-xs text-slate-600",children:["Current file:"," ",a.jsx("span",{className:"font-medium",children:t.letterhead_url.split("/").pop()})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-slate-600",children:[a.jsxs("label",{className:"inline-flex items-center gap-1",children:[a.jsx("input",{type:"radio",className:"h-3 w-3",value:"background",checked:I==="background",onChange:Y=>D(Y.target.value)}),a.jsx("span",{children:"Full-page background"})]}),a.jsxs("label",{className:"inline-flex items-center gap-1",children:[a.jsx("input",{type:"radio",className:"h-3 w-3",value:"none",checked:I==="none",onChange:Y=>D(Y.target.value)}),a.jsx("span",{children:"Disable letterhead background (use header/footer only)"})]})]}),a.jsx(_e,{type:"file",accept:"image/*,application/pdf,.doc,.docx",onChange:Y=>{var G;return T(((G=Y.target.files)==null?void 0:G[0])||null)}}),k&&a.jsx("p",{className:"text-xs mt-1 text-slate-600",children:k.name}),a.jsx(Pe,{disabled:!k,onClick:z,className:"mt-2",children:"Upload Letterhead"})]})]})]})]})})]})]})}const hR=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function COe(){const[t,n]=y.useState(null),[s,r]=y.useState("0"),[i,l]=y.useState("09:00"),[o,c]=y.useState("13:00"),[d,u]=y.useState("15"),[h,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(!1),[S,C]=y.useState(null),A=y.useCallback(R=>{n(R)},[]),k=y.useCallback(async()=>{if(!t){m([]);return}try{b(!0);const{data:R}=await Dce(t);m(R||[])}catch(R){console.error(R),xe.error("Failed to load schedules")}finally{b(!1)}},[t]);y.useEffect(()=>{k()},[k]);const T=async R=>{var L,$,B;if((L=R==null?void 0:R.preventDefault)==null||L.call(R),!t){xe.error("Select doctor first");return}const P=Number(s);if(h.some(V=>V.weekday===P)){xe.error("Schedule for this weekday already exists. Edit / delete existing slot instead.");return}try{j(!0),await Rce({doctor_user_id:t,weekday:P,start_time:i,end_time:o,slot_minutes:Number(d)||15}),xe.success("Schedule saved"),k()}catch(V){console.error(V),xe.error(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Failed to save schedule")}finally{j(!1)}},I=async R=>{var P,L;if(window.confirm("Delete this schedule slot?"))try{C(R),await Lce(R),xe.success("Schedule deleted"),m($=>$.filter(B=>B.id!==R))}catch($){console.error($),xe.error(((L=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:L.detail)||"Failed to delete schedule")}finally{C(null)}},D=!!t,O=y.useMemo(()=>`${h.length} weekday slot${h.length===1?"":"s"} configured`,[h.length]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"OPD Scheduling"}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor OPD Schedules"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure weekday-wise OPD timings for each doctor. Duplicate weekday entries are blocked to keep the roster clean."})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-4",children:a.jsxs(st,{className:"flex items-center justify-between text-base font-semibold text-slate-900",children:[a.jsx("span",{children:"Schedule Setup"}),a.jsx("span",{className:"text-xs font-normal text-slate-500",children:O})]})}),a.jsxs(ze,{className:"pt-4 space-y-4",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.5fr]",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),a.jsx(Hl,{value:t,onChange:A}),!t&&a.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to view and update OPD schedules."})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"Weekday"]}),a.jsxs(Mn,{value:s,onValueChange:r,children:[a.jsx(An,{className:"h-9 text-sm",children:a.jsx(On,{placeholder:"Select weekday"})}),a.jsx(kn,{children:hR.map((R,P)=>a.jsx(Et,{value:String(P),children:R},P))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Ni,{className:"h-3 w-3"}),"Start"]}),a.jsx(_e,{type:"time",value:i,onChange:R=>l(R.target.value),className:"h-9 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Ni,{className:"h-3 w-3"}),"End"]}),a.jsx(_e,{type:"time",value:o,onChange:R=>c(R.target.value),className:"h-9 text-sm"})]})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,auto] md:items-end",children:[a.jsxs("div",{className:"space-y-1.5 max-w-xs",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Slot duration (minutes)"}),a.jsx(_e,{type:"number",min:5,step:5,value:d,onChange:R=>u(R.target.value),className:"h-9 text-sm"}),a.jsx("p",{className:"mt-1 text-[11px] text-slate-400",children:"Used when generating appointment slots (e.g., 10 / 15 / 20)."})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(Pe,{type:"button",className:"px-5",disabled:!D||w,onClick:T,children:w?"Saving":"Add Weekday Slot"})})]})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-3",children:a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Existing Schedules"})}),a.jsxs(ze,{className:"pt-4",children:[x&&a.jsx("div",{className:"space-y-2",children:[1,2,3].map(R=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ze,{className:"h-4 w-40"}),a.jsx(Ze,{className:"h-3 w-24"})]}),a.jsx(Ze,{className:"h-8 w-8 rounded-full"})]},R))}),!x&&(!h||h.length===0)&&a.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No schedules configured yet for this doctor."}),!x&&h&&h.length>0&&a.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:h.map(R=>{var P,L;return a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 text-sm shadow-sm",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:a.jsxs("span",{className:"font-semibold text-slate-900",children:[hR[R.weekday]," "," ",(P=R.start_time)==null?void 0:P.slice(0,5),"",(L=R.end_time)==null?void 0:L.slice(0,5)]})}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsxs(Xe,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:["Slot: ",R.slot_minutes||15," min"]}),R.location&&a.jsx(Xe,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:R.location})]})]}),a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>I(R.id),disabled:S===R.id,children:a.jsx(Wr,{className:"h-4 w-4"})})]},R.id)})})]})]})]})})}function AOe(t,n){return y.useReducer((s,r)=>n[s][r]??s,t)}var QE="ScrollArea",[mG]=Du(QE),[kOe,Mi]=mG(QE),pG=y.forwardRef((t,n)=>{const{__scopeScrollArea:s,type:r="hover",dir:i,scrollHideDelay:l=600,...o}=t,[c,d]=y.useState(null),[u,h]=y.useState(null),[m,x]=y.useState(null),[b,w]=y.useState(null),[j,S]=y.useState(null),[C,A]=y.useState(0),[k,T]=y.useState(0),[I,D]=y.useState(!1),[O,R]=y.useState(!1),P=Sn(n,$=>d($)),L=Gb(i);return a.jsx(kOe,{scope:s,type:r,dir:L,scrollHideDelay:l,scrollArea:c,viewport:u,onViewportChange:h,content:m,onContentChange:x,scrollbarX:b,onScrollbarXChange:w,scrollbarXEnabled:I,onScrollbarXEnabledChange:D,scrollbarY:j,onScrollbarYChange:S,scrollbarYEnabled:O,onScrollbarYEnabledChange:R,onCornerWidthChange:A,onCornerHeightChange:T,children:a.jsx(Yt.div,{dir:L,...o,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":C+"px","--radix-scroll-area-corner-height":k+"px",...t.style}})})});pG.displayName=QE;var xG="ScrollAreaViewport",gG=y.forwardRef((t,n)=>{const{__scopeScrollArea:s,children:r,nonce:i,...l}=t,o=Mi(xG,s),c=y.useRef(null),d=Sn(n,c,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),a.jsx(Yt.div,{"data-radix-scroll-area-viewport":"",...l,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});gG.displayName=xG;var Yl="ScrollAreaScrollbar",ZE=y.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=Mi(Yl,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:o}=i,c=t.orientation==="horizontal";return y.useEffect(()=>(c?l(!0):o(!0),()=>{c?l(!1):o(!1)}),[c,l,o]),i.type==="hover"?a.jsx(EOe,{...r,ref:n,forceMount:s}):i.type==="scroll"?a.jsx(TOe,{...r,ref:n,forceMount:s}):i.type==="auto"?a.jsx(yG,{...r,ref:n,forceMount:s}):i.type==="always"?a.jsx(JE,{...r,ref:n}):null});ZE.displayName=Yl;var EOe=y.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=Mi(Yl,t.__scopeScrollArea),[l,o]=y.useState(!1);return y.useEffect(()=>{const c=i.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},h=()=>{d=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",h)}}},[i.scrollArea,i.scrollHideDelay]),a.jsx(Lo,{present:s||l,children:a.jsx(yG,{"data-state":l?"visible":"hidden",...r,ref:n})})}),TOe=y.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=Mi(Yl,t.__scopeScrollArea),l=t.orientation==="horizontal",o=rw(()=>d("SCROLL_END"),100),[c,d]=AOe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return y.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,i.scrollHideDelay,d]),y.useEffect(()=>{const u=i.viewport,h=l?"scrollLeft":"scrollTop";if(u){let m=u[h];const x=()=>{const b=u[h];m!==b&&(d("SCROLL"),o()),m=b};return u.addEventListener("scroll",x),()=>u.removeEventListener("scroll",x)}},[i.viewport,l,d,o]),a.jsx(Lo,{present:s||c!=="hidden",children:a.jsx(JE,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:n,onPointerEnter:Vt(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Vt(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),yG=y.forwardRef((t,n)=>{const s=Mi(Yl,t.__scopeScrollArea),{forceMount:r,...i}=t,[l,o]=y.useState(!1),c=t.orientation==="horizontal",d=rw(()=>{if(s.viewport){const u=s.viewport.offsetWidth<s.viewport.scrollWidth,h=s.viewport.offsetHeight<s.viewport.scrollHeight;o(c?u:h)}},10);return hh(s.viewport,d),hh(s.content,d),a.jsx(Lo,{present:r||l,children:a.jsx(JE,{"data-state":l?"visible":"hidden",...i,ref:n})})}),JE=y.forwardRef((t,n)=>{const{orientation:s="vertical",...r}=t,i=Mi(Yl,t.__scopeScrollArea),l=y.useRef(null),o=y.useRef(0),[c,d]=y.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=jG(c.viewport,c.content),h={...r,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:x=>l.current=x,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:x=>o.current=x};function m(x,b){return ROe(x,o.current,c,b)}return s==="horizontal"?a.jsx(IOe,{...h,ref:n,onThumbPositionChange:()=>{if(i.viewport&&l.current){const x=i.viewport.scrollLeft,b=mR(x,c,i.dir);l.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:x=>{i.viewport&&(i.viewport.scrollLeft=x)},onDragScroll:x=>{i.viewport&&(i.viewport.scrollLeft=m(x,i.dir))}}):s==="vertical"?a.jsx(POe,{...h,ref:n,onThumbPositionChange:()=>{if(i.viewport&&l.current){const x=i.viewport.scrollTop,b=mR(x,c);l.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:x=>{i.viewport&&(i.viewport.scrollTop=x)},onDragScroll:x=>{i.viewport&&(i.viewport.scrollTop=m(x))}}):null}),IOe=y.forwardRef((t,n)=>{const{sizes:s,onSizesChange:r,...i}=t,l=Mi(Yl,t.__scopeScrollArea),[o,c]=y.useState(),d=y.useRef(null),u=Sn(n,d,l.onScrollbarXChange);return y.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),a.jsx(vG,{"data-orientation":"horizontal",...i,ref:u,sizes:s,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":sw(s)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,m)=>{if(l.viewport){const x=l.viewport.scrollLeft+h.deltaX;t.onWheelScroll(x),_G(x,m)&&h.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&r({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:Yy(o.paddingLeft),paddingEnd:Yy(o.paddingRight)}})}})}),POe=y.forwardRef((t,n)=>{const{sizes:s,onSizesChange:r,...i}=t,l=Mi(Yl,t.__scopeScrollArea),[o,c]=y.useState(),d=y.useRef(null),u=Sn(n,d,l.onScrollbarYChange);return y.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),a.jsx(vG,{"data-orientation":"vertical",...i,ref:u,sizes:s,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":sw(s)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,m)=>{if(l.viewport){const x=l.viewport.scrollTop+h.deltaY;t.onWheelScroll(x),_G(x,m)&&h.preventDefault()}},onResize:()=>{d.current&&l.viewport&&o&&r({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:Yy(o.paddingTop),paddingEnd:Yy(o.paddingBottom)}})}})}),[MOe,bG]=mG(Yl),vG=y.forwardRef((t,n)=>{const{__scopeScrollArea:s,sizes:r,hasThumb:i,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:h,onResize:m,...x}=t,b=Mi(Yl,s),[w,j]=y.useState(null),S=Sn(n,P=>j(P)),C=y.useRef(null),A=y.useRef(""),k=b.viewport,T=r.content-r.viewport,I=Jr(h),D=Jr(d),O=rw(m,10);function R(P){if(C.current){const L=P.clientX-C.current.left,$=P.clientY-C.current.top;u({x:L,y:$})}}return y.useEffect(()=>{const P=L=>{const $=L.target;(w==null?void 0:w.contains($))&&I(L,T)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[k,w,T,I]),y.useEffect(D,[r,D]),hh(w,O),hh(b.content,O),a.jsx(MOe,{scope:s,scrollbar:w,hasThumb:i,onThumbChange:Jr(l),onThumbPointerUp:Jr(o),onThumbPositionChange:D,onThumbPointerDown:Jr(c),children:a.jsx(Yt.div,{...x,ref:S,style:{position:"absolute",...x.style},onPointerDown:Vt(t.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),C.current=w.getBoundingClientRect(),A.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),R(P))}),onPointerMove:Vt(t.onPointerMove,R),onPointerUp:Vt(t.onPointerUp,P=>{const L=P.target;L.hasPointerCapture(P.pointerId)&&L.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=A.current,b.viewport&&(b.viewport.style.scrollBehavior=""),C.current=null})})})}),Ky="ScrollAreaThumb",wG=y.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=bG(Ky,t.__scopeScrollArea);return a.jsx(Lo,{present:s||i.hasThumb,children:a.jsx(OOe,{ref:n,...r})})}),OOe=y.forwardRef((t,n)=>{const{__scopeScrollArea:s,style:r,...i}=t,l=Mi(Ky,s),o=bG(Ky,s),{onThumbPositionChange:c}=o,d=Sn(n,m=>o.onThumbChange(m)),u=y.useRef(void 0),h=rw(()=>{u.current&&(u.current(),u.current=void 0)},100);return y.useEffect(()=>{const m=l.viewport;if(m){const x=()=>{if(h(),!u.current){const b=LOe(m,c);u.current=b,c()}};return c(),m.addEventListener("scroll",x),()=>m.removeEventListener("scroll",x)}},[l.viewport,h,c]),a.jsx(Yt.div,{"data-state":o.hasThumb?"visible":"hidden",...i,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Vt(t.onPointerDownCapture,m=>{const b=m.target.getBoundingClientRect(),w=m.clientX-b.left,j=m.clientY-b.top;o.onThumbPointerDown({x:w,y:j})}),onPointerUp:Vt(t.onPointerUp,o.onThumbPointerUp)})});wG.displayName=Ky;var e5="ScrollAreaCorner",NG=y.forwardRef((t,n)=>{const s=Mi(e5,t.__scopeScrollArea),r=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&r?a.jsx(DOe,{...t,ref:n}):null});NG.displayName=e5;var DOe=y.forwardRef((t,n)=>{const{__scopeScrollArea:s,...r}=t,i=Mi(e5,s),[l,o]=y.useState(0),[c,d]=y.useState(0),u=!!(l&&c);return hh(i.scrollbarX,()=>{var m;const h=((m=i.scrollbarX)==null?void 0:m.offsetHeight)||0;i.onCornerHeightChange(h),d(h)}),hh(i.scrollbarY,()=>{var m;const h=((m=i.scrollbarY)==null?void 0:m.offsetWidth)||0;i.onCornerWidthChange(h),o(h)}),u?a.jsx(Yt.div,{...r,ref:n,style:{width:l,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Yy(t){return t?parseInt(t,10):0}function jG(t,n){const s=t/n;return isNaN(s)?0:s}function sw(t){const n=jG(t.viewport,t.content),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-s)*n;return Math.max(r,18)}function ROe(t,n,s,r="ltr"){const i=sw(s),l=i/2,o=n||l,c=i-o,d=s.scrollbar.paddingStart+o,u=s.scrollbar.size-s.scrollbar.paddingEnd-c,h=s.content-s.viewport,m=r==="ltr"?[0,h]:[h*-1,0];return SG([d,u],m)(t)}function mR(t,n,s="ltr"){const r=sw(n),i=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,l=n.scrollbar.size-i,o=n.content-n.viewport,c=l-r,d=s==="ltr"?[0,o]:[o*-1,0],u=Y_(t,d);return SG([0,o],[0,c])(u)}function SG(t,n){return s=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(t[1]-t[0]);return n[0]+r*(s-t[0])}}function _G(t,n){return t>0&&t<n}var LOe=(t,n=()=>{})=>{let s={left:t.scrollLeft,top:t.scrollTop},r=0;return function i(){const l={left:t.scrollLeft,top:t.scrollTop},o=s.left!==l.left,c=s.top!==l.top;(o||c)&&n(),s=l,r=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(r)};function rw(t,n){const s=Jr(t),r=y.useRef(0);return y.useEffect(()=>()=>window.clearTimeout(r.current),[]),y.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(s,n)},[s,n])}function hh(t,n){const s=Jr(n);Tr(()=>{let r=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(s)});return i.observe(t),()=>{window.cancelAnimationFrame(r),i.unobserve(t)}}},[t,s])}var CG=pG,BOe=gG,FOe=NG;const pa=y.forwardRef(({className:t,children:n,...s},r)=>a.jsxs(CG,{ref:r,className:It("relative overflow-hidden",t),...s,children:[a.jsx(BOe,{className:"h-full w-full rounded-[inherit]",children:n}),a.jsx(AG,{}),a.jsx(FOe,{})]}));pa.displayName=CG.displayName;const AG=y.forwardRef(({className:t,orientation:n="vertical",...s},r)=>a.jsx(ZE,{ref:r,orientation:n,className:It("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:a.jsx(wG,{className:"relative flex-1 rounded-full bg-border"})}));AG.displayName=ZE.displayName;var $Oe="Separator",pR="horizontal",zOe=["horizontal","vertical"],kG=y.forwardRef((t,n)=>{const{decorative:s,orientation:r=pR,...i}=t,l=UOe(r)?r:pR,c=s?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return a.jsx(Yt.div,{"data-orientation":l,...c,...i,ref:n})});kG.displayName=$Oe;function UOe(t){return zOe.includes(t)}var EG=kG;const Xy=y.forwardRef(({className:t,orientation:n="horizontal",decorative:s=!0,...r},i)=>a.jsx(EG,{ref:i,decorative:s,orientation:n,className:It("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Xy.displayName=EG.displayName;const VOe=()=>new Date().toISOString().slice(0,10);function HOe(){const[t,n]=y.useState(VOe()),[s,r]=y.useState(null),[i,l]=y.useState(null),[o,c]=y.useState(null),[d,u]=y.useState("Consultation"),[h,m]=y.useState([]),[x,b]=y.useState(""),[w,j]=y.useState(!1),[S,C]=y.useState([]),[A,k]=y.useState(!1),T=(P,L)=>{r(P),l((L==null?void 0:L.department_id)||null),b("")},I=P=>{c(P)};y.useEffect(()=>{(async()=>{if(!s||!t){m([]),C([]);return}try{j(!0);const{data:L}=await DI({doctorUserId:Number(s),date:t,detailed:!0}),$=Array.isArray(L)?L:(L==null?void 0:L.slots)||[];m($)}catch{m([])}finally{j(!1)}try{k(!0);const{data:L}=await RI({date:t,doctor_id:Number(s)});C(L||[])}catch{C([])}finally{k(!1)}})()},[s,t]);const D=y.useMemo(()=>h.filter(P=>P.status==="free"||!P.status),[h]),O=y.useMemo(()=>{var B;const P=S.length,L=D.length,$=x||((B=D[0])!=null&&B.start?`Earliest ${D[0].start}`:"Not selected");return{total:P,free:L,selected:$}},[S,D,x]),R=async P=>{if(P.preventDefault(),!o){xe.error("Please select a patient");return}if(!s||!i){xe.error("Please select department & doctor");return}if(!x){xe.error("Please choose a time slot");return}try{await Bce({patient_id:o,department_id:i,doctor_user_id:s,date:t,slot_start:x,purpose:d||"Consultation"}),xe.success("Appointment booked"),b("");const{data:L}=await RI({date:t,doctor_id:Number(s)});C(L||[]);const{data:$}=await DI({doctorUserId:Number(s),date:t,detailed:!0}),B=Array.isArray($)?$:($==null?void 0:$.slots)||[];m(B)}catch{}};return a.jsx("div",{className:"h-full w-full bg-[#eee] rounded",children:a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),a.jsx("span",{children:"Live OPD  Booking & Queue"})]}),a.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Appointment Booking"}),a.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Quickly book patient appointments, view doctor schedule, and monitor today's queue."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(Gs,{className:"h-3 w-3"}),t]}),s&&a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(un,{className:"h-3 w-3"}),"Doctor ID ",s]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[a.jsx(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Today's appointments"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:O.total})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(Cp,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Free slots"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:O.free})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(Ni,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Selected time"}),a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:O.selected})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(or,{className:"h-5 w-5 text-slate-700"})})]})})]}),a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.6fr),minmax(0,1.4fr)] lg:gap-6",children:[a.jsx(gt.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Je,{className:"pb-3",children:[a.jsxs(st,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Book a new appointment"]}),a.jsx(Sa,{className:"text-xs text-slate-500 sm:text-sm",children:"Choose patient, doctor, date and slot. All fields are optimized for quick keyboard + mouse workflow."})]}),a.jsx(ze,{className:"space-y-4",children:a.jsxs("form",{onSubmit:R,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[a.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:a.jsx(Cp,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Patient details"})]}),a.jsx("div",{className:"space-y-2 sm:space-y-3",children:a.jsx(Rb,{value:o,onChange:I})})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/60 p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[a.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:a.jsx(un,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Department & doctor"})]}),a.jsx(Hl,{value:s,onChange:T})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),a.jsx(_e,{type:"date",value:t,onChange:P=>n(P.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Purpose"}),a.jsx(_e,{value:d,onChange:P=>u(P.target.value),placeholder:"Consultation / Review / Procedure",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Time slot"}),a.jsxs("span",{className:"text-[11px] text-slate-400",children:[D.length," free slot(s) available"]})]}),w?a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:5}).map((P,L)=>a.jsx(Ze,{className:"h-7 w-16 rounded-full bg-slate-100"},L))}):D.length===0?a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-800",children:"No free slots for this date / doctor. Choose another date or doctor."}):a.jsx(pa,{className:"max-h-40 rounded-2xl border border-slate-100 bg-slate-50/80 px-2 py-2",children:a.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(P=>a.jsxs("button",{type:"button",onClick:()=>b(P.start),className:["inline-flex items-center gap-1 rounded-full border px-3 py-1 text-[11px] font-medium transition",x===P.start?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-700 hover:bg-slate-100"].join(" "),children:[a.jsx(Ni,{className:"h-3 w-3"}),P.start,"",P.end]},P.start))})})]}),a.jsx(Xy,{className:"my-1"}),a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("p",{className:"text-[11px] text-slate-400",children:"Booking will immediately reflect in OPD queue & doctor view."}),a.jsx(Pe,{type:"submit",className:"h-9 rounded-2xl bg-slate-900 px-4 text-xs font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:!o||!s||!x,children:"Book appointment"})]})]})})]})}),a.jsx(gt.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx(Gs,{className:"h-4 w-4 text-slate-600"}),"Appointments for the day"]}),a.jsx(Sa,{className:"text-xs text-slate-500 sm:text-sm",children:"See all appointments for the selected doctor and date."})]}),(A||w)&&a.jsxs(Xe,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[a.jsx(nn,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),a.jsxs(ze,{className:"pb-3",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] text-slate-400",children:[a.jsxs("span",{children:[t," ",s?` Doctor ID ${s}`:""]}),a.jsxs("span",{children:[S.length," appointment(s)"]})]}),A?a.jsx("div",{className:"space-y-2",children:Array.from({length:4}).map((P,L)=>a.jsx(Ze,{className:"h-14 w-full rounded-2xl bg-slate-100"},L))}):S.length===0?a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this filter yet.",a.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Start by booking a new appointment on the left."})]}):a.jsx(pa,{className:"max-h-[380px] pr-1",children:a.jsx("div",{className:"space-y-2 text-sm",children:a.jsx(du,{initial:!1,children:S.map(P=>a.jsxs(gt.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-1 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[a.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[P.slot_start,"",P.slot_end]}),a.jsx("span",{className:"font-medium",children:P.patient_name}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",P.uhid,")"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[P.department_name,"  ",P.doctor_name," ",a.jsx("span",{className:"ml-1 inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-white",children:P.status})]})]}),a.jsx("div",{className:"text-[11px] text-slate-500 sm:text-right",children:P.vitals_registered?a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[a.jsx(or,{className:"h-3 w-3"}),"Vitals done"]}):a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[a.jsx(or,{className:"h-3 w-3"}),"No vitals yet"]})})]},P.id))})})})]})]})})]})]})})}const WOe=()=>new Date().toISOString().slice(0,10),qOe={booked:"Booked",checked_in:"Checked-in",in_progress:"In progress",completed:"Completed",no_show:"No-show",cancelled:"Cancelled"},GOe={booked:"bg-slate-100 text-slate-700",checked_in:"bg-blue-100 text-blue-700",in_progress:"bg-amber-100 text-amber-700",completed:"bg-emerald-100 text-emerald-700",no_show:"bg-rose-100 text-rose-700",cancelled:"bg-slate-200 text-slate-600"};function KOe(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function YOe(t,n){if(!(t!=null&&t.time)||!["booked","checked_in","in_progress"].includes(t.status))return null;try{const s=new Date;if(!(n===s.toISOString().slice(0,10)))return null;const i=new Date(`${n}T${t.time}:00`),l=s.getTime()-i.getTime(),o=Math.floor(l/(1e3*60));if(o<=0)return"0 min";if(o<60)return`${o} min`;const c=Math.floor(o/60),d=o%60;return c>=5?`${c} hrs+`:d===0?`${c} hr${c>1?"s":""}`:`${c}h ${d}m`}catch{return null}}function XOe(){const{user:t}=kr()||{},[n,s]=y.useState(null),[r,i]=y.useState(WOe()),[l,o]=y.useState([]),[c,d]=y.useState(!1),[u,h]=y.useState("active"),m=Aa();y.useEffect(()=>{t!=null&&t.is_doctor&&!n&&s(t.id)},[t,n]);const x=!!(n&&r),b=y.useCallback(async()=>{if(!n||!r){o([]);return}try{d(!0);const A={doctor_user_id:Number(n),for_date:r};t!=null&&t.department_id&&(A.department_id=t.department_id);const{data:k}=await e9(A);o(k||[])}catch(A){console.error(A),o([])}finally{d(!1)}},[n,r,t]);y.useEffect(()=>{b()},[b]);const w=async(A,k,T={})=>{try{const{data:I}=await Fce(A.appointment_id,k);xe.success(`Status updated to ${I.status.toUpperCase()}`),T.goToVisit&&I.visit_id?m(`/opd/visit/${I.visit_id}`):b()}catch{}},j=A=>{s(A)},S=y.useMemo(()=>{const A={total:l.length,booked:0,checked_in:0,in_progress:0,completed:0,no_show:0,cancelled:0};for(const k of l)A[k.status]!==void 0&&(A[k.status]+=1);return A},[l]),C=y.useMemo(()=>u==="all"?l:u==="active"?l.filter(A=>["booked","checked_in","in_progress"].includes(A.status)):l.filter(A=>A.status===u),[l,u]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Live OPD Queue"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Queue Management"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track today's appointments, check-in patients, and start / complete visits in real-time."})]}),a.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[a.jsx(or,{className:"h-3 w-3"}),a.jsx("span",{children:"Doctor OPD"})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[a.jsx(Gs,{className:"h-3 w-3"}),a.jsx("span",{children:KOe(r)})]})]})]}),a.jsxs(Le,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsxs(Je,{className:"border-b border-slate-100 pb-4",children:[a.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[a.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.2fr] md:items-end",children:[a.jsxs("div",{children:[a.jsx(Hl,{value:n,onChange:j,autoSelectCurrentDoctor:!0}),(t==null?void 0:t.is_doctor)&&a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:"Defaulted to your OPD queue."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"Date"]}),a.jsx(_e,{type:"date",value:r,onChange:A=>i(A.target.value),className:"h-9"})]})]}),a.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:a.jsxs(Pe,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:b,disabled:c||!x,children:[a.jsx(cu,{className:"h-3 w-3"}),"Refresh"]})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[a.jsx(Ni,{className:"h-3 w-3"}),a.jsx("span",{children:"Total"}),a.jsx("span",{className:"font-semibold",children:S.total})]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50",children:["Booked: ",S.booked]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Checked-in: ",S.checked_in]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["In progress: ",S.in_progress]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",S.completed]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-rose-50 text-rose-700",children:["No-show: ",S.no_show]})]})]}),a.jsxs(ze,{className:"pt-4",children:[a.jsx("div",{className:"mb-3 flex flex-wrap gap-1.5 text-xs",children:[{key:"active",label:"Active (Booked / Checked-in / In progress)"},{key:"all",label:"All"},{key:"booked",label:"Booked"},{key:"checked_in",label:"Checked-in"},{key:"in_progress",label:"In progress"},{key:"completed",label:"Completed"},{key:"no_show",label:"No-show"}].map(A=>a.jsx("button",{type:"button",onClick:()=>h(A.key),className:["rounded-full border px-3 py-1 transition text-[11px]",u===A.key?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white"].join(" "),children:A.label},A.key))}),!x&&a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(un,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"Select doctor & date to view queue"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Choose a consultant and date above to see the live OPD queue, update statuses, and open visits."})]}),x&&c&&a.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(A=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Ze,{className:"h-4 w-40"}),a.jsx(Ze,{className:"h-3 w-64"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ze,{className:"h-7 w-16"}),a.jsx(Ze,{className:"h-7 w-20"})]})]},A))}),x&&!c&&C.length===0&&a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(Ni,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"No appointments for this doctor / date"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Try changing the status filter above or pick a different date to see previous or upcoming OPD queues."})]}),x&&!c&&C.length>0&&a.jsx("div",{className:"space-y-2 pt-1 text-sm",children:C.map(A=>{var I,D,O;const k=GOe[A.status]||"bg-slate-100 text-slate-700",T=YOe(A,r);return a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsx("span",{className:"text-xs font-semibold text-slate-900",children:A.time}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-500"}),(I=A.patient)==null?void 0:I.name]}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",(D=A.patient)==null?void 0:D.uhid,"  ",(O=A.patient)==null?void 0:O.phone]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[a.jsx("span",{children:"Status:"}),a.jsx(Xe,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${k}`,children:qOe[A.status]||A.status}),a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsxs("span",{children:["Purpose:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:A.visit_purpose||"Consultation"})]}),a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(jp,{className:"h-3 w-3"}),"Vitals:"," ",a.jsx("span",{className:"font-medium",children:A.has_vitals?"Yes":"No"})]}),T&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(Ni,{className:"h-3 w-3"}),"Waiting:"," ",a.jsx("span",{className:"font-medium",children:T})]})]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:[A.status==="booked"&&a.jsxs(a.Fragment,{children:[a.jsx(Pe,{size:"sm",onClick:()=>w(A,"checked_in"),children:"Check-in"}),a.jsx(Pe,{size:"sm",variant:"outline",onClick:()=>w(A,"no_show"),children:"Mark No-show"})]}),A.status==="checked_in"&&a.jsx(Pe,{size:"sm",onClick:()=>w(A,"in_progress",{goToVisit:!0}),children:"Start Visit"}),A.status==="in_progress"&&a.jsx(Pe,{size:"sm",onClick:()=>w(A,"completed"),children:"Complete Visit"}),A.visit_id&&a.jsx(Pe,{size:"sm",variant:"outline",onClick:()=>m(`/opd/visit/${A.visit_id}`),children:"Open Visit"})]})]},A.appointment_id)})})]})]})]})})}const mh=y.forwardRef(({className:t,...n},s)=>a.jsx("textarea",{className:It("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n}));mh.displayName="Textarea";const QOe=()=>new Date().toISOString().slice(0,10);function ZOe(){const[t,n]=y.useState(null),[s,r]=y.useState(QOe()),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(null),[h,m]=y.useState({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),[x,b]=y.useState(!1),w=async()=>{if(!t||!s){l([]);return}try{c(!0);const{data:O}=await e9({doctor_user_id:Number(t),for_date:s});l(O||[])}catch{l([])}finally{c(!1)}};y.useEffect(()=>{w()},[t,s]);const j=O=>{n(O)},S=()=>({height_cm:"",weight_kg:"",temp_c:"",pulse:"",resp_rate:"",spo2:"",bp_sys:"",bp_dia:"",notes:""}),C=O=>{u(O),m(S()),setTimeout(()=>{const R=document.getElementById("triage-vitals-form");R&&R.scrollIntoView({behavior:"smooth",block:"start"})},80)},A=async O=>{if(O.preventDefault(),!!d)try{b(!0);const R={appointment_id:d.appointment_id,height_cm:h.height_cm?Number(h.height_cm):void 0,weight_kg:h.weight_kg?Number(h.weight_kg):void 0,temp_c:h.temp_c?Number(h.temp_c):void 0,pulse:h.pulse?Number(h.pulse):void 0,resp_rate:h.resp_rate?Number(h.resp_rate):void 0,spo2:h.spo2?Number(h.spo2):void 0,bp_sys:h.bp_sys?Number(h.bp_sys):void 0,bp_dia:h.bp_dia?Number(h.bp_dia):void 0,notes:h.notes||void 0};await Hce(R),xe.success("Vitals recorded"),u(null),await w()}catch{}finally{b(!1)}},k=(O,R)=>m(P=>({...P,[O]:R})),T=i.length,I=i.filter(O=>O.has_vitals).length,D=T-I;return a.jsx("div",{className:"h-full w-full bg-slate-50",children:a.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-4 px-3 py-4 sm:px-4 lg:px-6 lg:py-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-500 shadow-sm",children:[a.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-500 animate-pulse"}),a.jsx("span",{children:"Live OPD  Triage & Vitals"})]}),a.jsx("h1",{className:"text-xl font-semibold text-slate-900 sm:text-2xl",children:"OPD Triage (Vitals)"}),a.jsx("p",{className:"text-xs text-slate-500 sm:text-sm",children:"Nursing staff can quickly capture vitals for patients waiting in the doctor's queue."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(Gs,{className:"h-3 w-3"}),s]}),t&&a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1 text-[11px] font-normal text-slate-700 shadow-sm",children:[a.jsx(un,{className:"h-3 w-3"}),"Doctor ID ",t]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:[a.jsx(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Queue size"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:T})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(Cp,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Vitals completed"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:I})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(or,{className:"h-5 w-5 text-slate-700"})})]})}),a.jsx(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"flex items-center justify-between gap-3 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Pending vitals"}),a.jsx("p",{className:"text-xl font-semibold text-slate-900",children:D})]}),a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-2",children:a.jsx(jp,{className:"h-5 w-5 text-slate-700"})})]})})]}),a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr),minmax(0,1.6fr)] lg:gap-6",children:[a.jsx(gt.div,{layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsxs(Je,{className:"pb-3",children:[a.jsxs(st,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-2xl bg-slate-900 text-xs text-white",children:"1"}),"Select doctor & view queue"]}),a.jsx(Sa,{className:"text-xs text-slate-500 sm:text-sm",children:"Pick the doctor and date to load today's OPD queue for triage."})]}),a.jsxs(ze,{className:"space-y-4",children:[a.jsxs("div",{className:"grid items-end gap-3 md:grid-cols-[2fr,1.3fr]",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 sm:p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[a.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-white text-[11px] font-semibold text-slate-900 shadow-sm",children:a.jsx(un,{className:"h-3 w-3"})}),a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-slate-500",children:"Doctor"})]}),a.jsx(Hl,{value:t,onChange:j})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Date"}),a.jsx(_e,{type:"date",value:s,onChange:O=>r(O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),a.jsx(Xy,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-slate-400",children:[a.jsx("span",{children:t?"Queue for selected doctor":"Select a doctor to load queue"}),a.jsxs("span",{children:[T," patient(s)"]})]}),o?a.jsx("div",{className:"space-y-2 mt-1",children:Array.from({length:4}).map((O,R)=>a.jsx(Ze,{className:"h-14 w-full rounded-2xl bg-slate-100"},R))}):i.length===0?a.jsxs("div",{className:"mt-2 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No appointments for this doctor / date.",a.jsx("div",{className:"mt-1 text-[11px] text-slate-400",children:"Use the Appointment Booking screen to add new patients."})]}):a.jsx(pa,{className:"mt-1 max-h-[380px] pr-1",children:a.jsx("div",{className:"space-y-2 text-sm",children:a.jsx(du,{initial:!1,children:i.map(O=>a.jsxs(gt.div,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},transition:{duration:.15},className:"flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[a.jsx("span",{className:"rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:O.time}),a.jsx("span",{className:"font-medium",children:O.patient.name}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",O.patient.uhid,")"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[a.jsx("span",{children:"Vitals:"}),O.has_vitals?a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 border border-emerald-100",children:[a.jsx(or,{className:"h-3 w-3"}),"Already recorded"]}):a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-medium text-slate-600 border border-slate-200",children:[a.jsx(or,{className:"h-3 w-3"}),"Not recorded"]})]})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(Pe,{type:"button",variant:O.has_vitals?"outline":"default",size:"sm",className:`rounded-2xl text-[11px] px-3 ${O.has_vitals?"bg-white text-slate-800 border-slate-300":"bg-slate-900 text-white hover:bg-slate-800"}`,onClick:()=>C(O),children:"Record vitals"})})]},O.appointment_id))})})})]})]})]})}),a.jsx(gt.div,{id:"triage-vitals-form",layout:!0,initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.2,delay:.05},className:"lg:sticky lg:top-24",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 bg-white shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"flex items-center gap-2 text-base font-semibold text-slate-900 sm:text-lg",children:[a.jsx(jp,{className:"h-4 w-4 text-slate-700"}),"Record patient vitals"]}),a.jsx(Sa,{className:"text-xs text-slate-500 sm:text-sm",children:"Select a patient from the queue to start capturing vitals."})]}),(x||o)&&a.jsxs(Xe,{variant:"outline",className:"inline-flex items-center gap-1 rounded-full border-slate-200 bg-slate-50 px-2 py-1 text-[11px] text-slate-500",children:[a.jsx(nn,{className:"h-3 w-3 animate-spin"}),"Syncing"]})]})}),a.jsx(ze,{className:"pb-4",children:d?a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsx("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/80 px-3 py-2 text-xs text-slate-700",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 text-[11px] font-medium text-slate-800 border border-slate-200",children:[a.jsx(Cp,{className:"h-3 w-3"}),d.patient.name]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",d.patient.uhid]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[" Time ",d.time]})]})}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Height (cm)"}),a.jsx(_e,{value:h.height_cm,onChange:O=>k("height_cm",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Weight (kg)"}),a.jsx(_e,{value:h.weight_kg,onChange:O=>k("weight_kg",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium text-slate-600",children:["Temperature (C)",a.jsx(f3,{className:"h-3 w-3 text-slate-500"})]}),a.jsx(_e,{value:h.temp_c,onChange:O=>k("temp_c",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Pulse (bpm)"}),a.jsx(_e,{value:h.pulse,onChange:O=>k("pulse",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Resp. rate"}),a.jsx(_e,{value:h.resp_rate,onChange:O=>k("resp_rate",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"SpO (%)"}),a.jsx(_e,{value:h.spo2,onChange:O=>k("spo2",O.target.value),className:"h-9 rounded-2xl border-slate-200 text-sm"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"BP (sys / dia)"}),a.jsxs("div",{className:"flex gap-1.5",children:[a.jsx(_e,{value:h.bp_sys,onChange:O=>k("bp_sys",O.target.value),placeholder:"Sys",className:"h-9 rounded-2xl border-slate-200 text-sm"}),a.jsx(_e,{value:h.bp_dia,onChange:O=>k("bp_dia",O.target.value),placeholder:"Dia",className:"h-9 rounded-2xl border-slate-200 text-sm"})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"Notes"}),a.jsx(mh,{value:h.notes,onChange:O=>k("notes",O.target.value),className:"min-h-[70px] rounded-2xl border-slate-200 text-sm",placeholder:"Enter any triage notes, pain score, alerts"})]}),a.jsx(Xy,{}),a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsx("p",{className:"text-[11px] text-slate-400",children:"Saved vitals will be visible in the doctor's EMR view for this visit."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-9 rounded-2xl border-slate-300 bg-white text-[11px]",onClick:()=>u(null),disabled:x,children:"Cancel"}),a.jsx(Pe,{type:"submit",size:"sm",className:"h-9 rounded-2xl bg-slate-900 px-4 text-[11px] font-semibold uppercase tracking-wide text-white hover:bg-slate-800 disabled:opacity-50",disabled:x,children:x?"Saving":"Save vitals"})]})]})]}):a.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-3 py-4 text-center text-xs text-slate-500",children:["No patient selected.",a.jsxs("div",{className:"mt-1 text-[11px] text-slate-400",children:["Click ",a.jsx("span",{className:"font-medium",children:"Record vitals"})," on any patient in the queue to begin."]})]})})]})})]})]})})}function JOe(){const{id:t}=Tu(),n=Number(t),[s,r]=y.useState(!0),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState({chief_complaint:"",symptoms:"",soap_subjective:"",soap_objective:"",soap_assessment:"",plan:""}),[h,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),S=async()=>{try{r(!0);const{data:I}=await Uce(n);c(I),u({chief_complaint:I.chief_complaint||"",symptoms:I.symptoms||"",soap_subjective:I.soap_subjective||"",soap_objective:I.soap_objective||"",soap_assessment:I.soap_assessment||"",plan:I.plan||""})}catch{c(null)}finally{r(!1)}};y.useEffect(()=>{n&&S()},[n]);const C=(I,D)=>u(O=>({...O,[I]:D})),A=async()=>{try{l(!0),await Vce(n,d),xe.success("Visit updated"),await S()}catch{}finally{l(!1)}},k=I=>{if(!I)return"";const D=new Date(I);return Number.isNaN(D.getTime())?I:D.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})},T=async()=>{if(!h){xe.error("Select follow-up date");return}try{j(!0),await Wce(n,{due_date:h,note:x||void 0}),xe.success("Follow-up created"),m(""),b(""),await S()}catch{}finally{j(!1)}};return n?s?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"Loading visit"}):o?a.jsxs("div",{className:"space-y-4 p-4",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"OPD Visit"}),a.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3 text-sm",children:[a.jsxs("div",{className:"flex flex-wrap justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:[o.patient_name," ",a.jsxs("span",{className:"text-[11px] text-slate-500",children:["(UHID ",o.uhid,")"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[o.department_name,"  Dr. ",o.doctor_name]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500 text-right",children:["Episode: ",o.episode_id," ",a.jsx("br",{}),"Visit at: ",k(o.visit_at)]})]}),o.current_vitals&&a.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:[a.jsx("div",{className:"font-semibold mb-1",children:"Latest vitals"}),a.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1",children:[o.current_vitals.height_cm&&a.jsxs("span",{children:["Ht: ",o.current_vitals.height_cm," cm"]}),o.current_vitals.weight_kg&&a.jsxs("span",{children:["Wt: ",o.current_vitals.weight_kg," kg"]}),o.current_vitals.temp_c&&a.jsxs("span",{children:["Temp: ",o.current_vitals.temp_c," C"]}),o.current_vitals.bp_systolic&&a.jsxs("span",{children:["BP: ",o.current_vitals.bp_systolic,"/",o.current_vitals.bp_diastolic," mmHg"]}),o.current_vitals.pulse&&a.jsxs("span",{children:["Pulse: ",o.current_vitals.pulse]}),o.current_vitals.rr&&a.jsxs("span",{children:["RR: ",o.current_vitals.rr]}),o.current_vitals.spo2&&a.jsxs("span",{children:["SpO: ",o.current_vitals.spo2,"%"]})]})]})]}),a.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[a.jsx("h3",{className:"font-medium text-sm",children:"Clinical notes (SOAP)"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Chief Complaint"}),a.jsx("textarea",{className:"input min-h-[60px]",value:d.chief_complaint,onChange:I=>C("chief_complaint",I.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Symptoms"}),a.jsx("textarea",{className:"input min-h-[60px]",value:d.symptoms,onChange:I=>C("symptoms",I.target.value)})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Subjective"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_subjective,onChange:I=>C("soap_subjective",I.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Objective"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_objective,onChange:I=>C("soap_objective",I.target.value)})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Assessment"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.soap_assessment,onChange:I=>C("soap_assessment",I.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Plan"}),a.jsx("textarea",{className:"input min-h-[80px]",value:d.plan,onChange:I=>C("plan",I.target.value)})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"btn",onClick:A,disabled:i,children:i?"Saving":"Save notes"})})]}),a.jsxs("div",{className:"rounded-2xl border bg-white p-4 space-y-3",children:[a.jsx("h3",{className:"font-medium text-sm",children:"Follow-up"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] items-end",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Follow-up date"}),a.jsx("input",{type:"date",className:"input",value:h,onChange:I=>m(I.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium",children:"Note (optional)"}),a.jsx("input",{className:"input",value:x,onChange:I=>b(I.target.value),placeholder:"Review in 2 weeks / discuss reports"})]}),a.jsx("button",{className:"btn",onClick:T,disabled:w,children:w?"Creating":"Create Follow-up"})]})]})]}):a.jsx("div",{className:"p-4 text-sm text-red-600",children:"Visit not found."}):a.jsx("div",{className:"p-4 text-sm",children:"Invalid visit ID."})}const xR=()=>new Date().toISOString().slice(0,10),eDe={waiting:"Waiting",scheduled:"Scheduled",completed:"Completed",cancelled:"Cancelled","*":"All"},tDe={waiting:"bg-amber-50 text-amber-700",scheduled:"bg-blue-50 text-blue-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-slate-100 text-slate-700"};function L2(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function nDe(){const[t,n]=y.useState("waiting"),[s,r]=y.useState(null),[i,l]=y.useState(xR()),[o,c]=y.useState(xR()),[d,u]=y.useState([]),[h,m]=y.useState(!1),[x,b]=y.useState(null),[w,j]=y.useState(""),[S,C]=y.useState(""),[A,k]=y.useState(!1),[T,I]=y.useState(null),[D,O]=y.useState(""),[R,P]=y.useState(""),[L,$]=y.useState([]),[B,V]=y.useState(!1),[K,z]=y.useState(!1),H=async()=>{try{m(!0);const we={status:t,doctor_id:s||void 0,date_from:i||void 0,date_to:o||void 0},{data:Z}=await qce(we);u(Z||[])}catch{u([])}finally{m(!1)}};y.useEffect(()=>{H()},[t,s,i,o]);const Y=we=>{r(we)},G=we=>{b(we),j(we.due_date),C(we.note||"")},J=async we=>{if(we.preventDefault(),!!x)try{k(!0),await Gce(x.id,{due_date:w,note:S||void 0}),xe.success("Follow-up updated"),b(null),await H()}catch{}finally{k(!1)}},ee=async(we,Z)=>{if(!(we!=null&&we.doctor_id)||!Z){$([]);return}try{z(!0);const{data:ce}=await Oce({doctorUserId:we.doctor_id,date:Z});$(ce||[])}catch{$([])}finally{z(!1)}},ye=async we=>{I(we);const Z=we.due_date;O(Z),P(""),await ee(we,Z)},ie=async we=>{const Z=we.target.value;O(Z),T&&await ee(T,Z)},he=async we=>{if(we.preventDefault(),!!T){if(!R){xe.error("Select a time slot");return}try{V(!0),await Kce(T.id,{date:D||void 0,slot_start:R}),xe.success("Follow-up scheduled"),I(null),$([]),await H()}catch{}finally{V(!1)}}},be=y.useMemo(()=>{const we={total:d.length,waiting:0,scheduled:0,completed:0,cancelled:0};for(const Z of d)we[Z.status]!==void 0&&(we[Z.status]+=1);return we},[d]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-sky-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-sky-500"})]}),a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-sky-700",children:"Follow-up Tracker"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Follow-ups"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"View pending follow-ups, reschedule due dates, and confirm them into real OPD appointments."})]}),a.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[a.jsx(_r,{className:"h-3 w-3"}),a.jsx("span",{children:"Continuity of care"})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[a.jsx(Gs,{className:"h-3 w-3"}),a.jsxs("span",{children:[L2(i),"  ",L2(o)]})]})]})]}),a.jsxs(Le,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsxs(Je,{className:"border-b border-slate-100 pb-4",children:[a.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[a.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1.3fr,1fr,1fr] md:items-end",children:[a.jsx(Hl,{value:s,onChange:Y}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(tte,{className:"h-3 w-3"}),"Status"]}),a.jsxs(Mn,{value:t,onValueChange:we=>n(we),children:[a.jsx(An,{className:"h-9 text-xs",children:a.jsx(On,{placeholder:"Select status"})}),a.jsxs(kn,{children:[a.jsx(Et,{value:"waiting",children:"Waiting"}),a.jsx(Et,{value:"scheduled",children:"Scheduled"}),a.jsx(Et,{value:"completed",children:"Completed"}),a.jsx(Et,{value:"cancelled",children:"Cancelled"}),a.jsx(Et,{value:"*",children:"All"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"From"]}),a.jsx(_e,{type:"date",className:"h-9",value:i,onChange:we=>l(we.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"To"]}),a.jsx(_e,{type:"date",className:"h-9",value:o,onChange:we=>c(we.target.value)})]})]}),a.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:a.jsxs(Pe,{type:"button",size:"sm",variant:"outline",onClick:H,disabled:h,className:"gap-1",children:[a.jsx(Ni,{className:"h-3 w-3"}),"Refresh"]})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-xs",children:[a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[a.jsx(_r,{className:"h-3 w-3"}),a.jsx("span",{children:"Total"}),a.jsx("span",{className:"font-semibold",children:be.total})]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-amber-50 text-amber-700",children:["Waiting: ",be.waiting]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-blue-50 text-blue-700",children:["Scheduled: ",be.scheduled]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-emerald-50 text-emerald-700",children:["Completed: ",be.completed]}),a.jsxs(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-100 text-slate-700",children:["Cancelled: ",be.cancelled]})]})]}),a.jsx(ze,{className:"pt-4",children:h?a.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(we=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Ze,{className:"h-4 w-52"}),a.jsx(Ze,{className:"h-3 w-64"})]}),a.jsx(Ze,{className:"h-7 w-20"})]},we))}):d.length===0?a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(Ms,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"No follow-ups for this filter"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Adjust status, doctor, or date range above to see past and upcoming follow-ups."})]}):a.jsx("div",{className:"space-y-2 pt-1 text-sm",children:d.map(we=>{const Z=tDe[we.status]||"bg-slate-100 text-slate-700";return a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsx("span",{className:"text-xs font-semibold text-slate-900",children:L2(we.due_date)}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-500"}),we.patient_name]}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",we.patient_uhid]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px] text-slate-500",children:[a.jsxs("span",{children:["Dr. ",we.doctor_name,"  ",we.department_name]}),a.jsx("span",{className:"mx-1 text-slate-300",children:""}),a.jsx("span",{children:"Status:"}),a.jsx(Xe,{className:`border-none px-2 py-0.5 text-[11px] font-semibold uppercase ${Z}`,children:eDe[we.status]||we.status})]}),we.note&&a.jsxs("div",{className:"text-[11px] text-slate-600",children:["Note: ",we.note]}),we.status==="scheduled"&&we.appointment_id&&a.jsxs("div",{className:"text-[11px] text-emerald-700",children:["Linked to appointment # ",we.appointment_id]})]}),a.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:we.status==="waiting"&&a.jsxs(a.Fragment,{children:[a.jsx(Pe,{size:"sm",variant:"outline",onClick:()=>G(we),children:"Edit"}),a.jsx(Pe,{size:"sm",onClick:()=>ye(we),children:"Schedule"})]})})]},we.id)})})})]}),x&&a.jsxs(Le,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{className:"text-base",children:"Edit Follow-up Date & Note"}),a.jsxs(Sa,{className:"text-xs",children:[x.patient_name,"  UHID ",x.patient_uhid]})]}),a.jsx(Pe,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>b(null),children:"Close"})]})}),a.jsx(ze,{children:a.jsxs("form",{onSubmit:J,className:"grid gap-3 md:grid-cols-[1fr,2fr,auto] md:items-end",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"Due date"]}),a.jsx(_e,{type:"date",value:w,onChange:we=>j(we.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(un,{className:"h-3 w-3"}),"Note"]}),a.jsx(_e,{value:S,onChange:we=>C(we.target.value),placeholder:"Short instruction for next visit"})]}),a.jsx(Pe,{type:"submit",disabled:A,children:A?"Saving":"Save changes"})]})})]}),T&&a.jsxs(Le,{className:"border-slate-200 shadow-sm rounded-3xl",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{className:"text-base",children:"Schedule Follow-up Appointment"}),a.jsxs(Sa,{className:"text-xs",children:[T.patient_name,"  UHID ",T.patient_uhid,"  Dr. ",T.doctor_name]})]}),a.jsx(Pe,{variant:"ghost",size:"sm",className:"text-xs text-slate-500",type:"button",onClick:()=>{I(null),$([])},children:"Close"})]})}),a.jsx(ze,{children:a.jsxs("form",{onSubmit:he,className:"space-y-4 text-sm",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-[1fr,2fr] md:items-start",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"Date"]}),a.jsx(_e,{type:"date",value:D,onChange:ie})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Ni,{className:"h-3 w-3"}),"Time slot"]}),K?a.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading slots"}):L.length===0?a.jsxs("div",{className:"flex items-start gap-2 rounded-xl border border-amber-200 bg-amber-50 px-3 py-2 text-[11px] text-amber-800",children:[a.jsx(Ms,{className:"mt-[1px] h-3 w-3"}),a.jsx("span",{children:"No free slots found for this date. You can still type a custom time below."})]}):a.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(we=>a.jsx("button",{type:"button",onClick:()=>P(we),className:["rounded-full border px-3 py-1 text-[11px] transition",R===we?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-slate-50 hover:bg-slate-100"].join(" "),children:we},we))}),a.jsx(_e,{type:"time",className:"mt-2",value:R,onChange:we=>P(we.target.value)})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(Pe,{type:"submit",disabled:B,children:B?"Scheduling":"Confirm schedule"})})]})})]})]})})}const sDe=()=>new Date().toISOString().slice(0,10);function gR(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})}catch{return t}}function rDe(){const[t,n]=y.useState(null),[s,r]=y.useState(sDe()),[i,l]=y.useState([]),[o,c]=y.useState(!1),[d,u]=y.useState(null),[h,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(!1),S=async()=>{try{c(!0);const I={for_date:s,doctor_id:t||void 0},{data:D}=await zce(I);l(D||[])}catch{l([])}finally{c(!1)}};y.useEffect(()=>{S()},[t,s]);const C=I=>{n(I)},A=I=>{u(I),m(I.date),b(I.slot_start)},k=async I=>{if(I.preventDefault(),!!d){if(!h||!x){xe.error("Select date and time");return}try{j(!0),await $ce(d.id,{date:h,slot_start:x,create_new:!0}),xe.success("No-show rescheduled as new appointment"),u(null),await S()}catch{}finally{j(!1)}}},T=y.useMemo(()=>i.length,[i]);return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-rose-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-rose-500"})]}),a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-rose-700",children:"No-Show Recovery"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"No-show Appointments"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Track patients who missed their appointment and quickly reschedule them into the OPD calendar."})]}),a.jsxs("div",{className:"hidden text-right text-xs text-slate-500 md:block",children:[a.jsxs("div",{className:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1",children:[a.jsx(ji,{className:"h-3 w-3"}),a.jsx("span",{children:"Improve utilisation"})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-end gap-1",children:[a.jsx(Gs,{className:"h-3 w-3"}),a.jsx("span",{children:gR(s)})]})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"border-b border-slate-100 pb-4",children:[a.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[a.jsxs("div",{className:"grid w-full gap-3 md:grid-cols-[2fr,1fr] md:items-end",children:[a.jsx(Hl,{value:t,onChange:C}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"For date"]}),a.jsx(_e,{type:"date",className:"h-9",value:s,onChange:I=>r(I.target.value)})]})]}),a.jsx("div",{className:"flex items-center gap-2 md:w-auto",children:a.jsxs(Pe,{type:"button",size:"sm",variant:"outline",onClick:S,disabled:o,className:"gap-1",children:[a.jsx(Ni,{className:"h-3 w-3"}),"Refresh"]})})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-slate-50",children:[a.jsx(Ms,{className:"h-3 w-3 text-rose-600"}),a.jsx("span",{children:"Total no-shows"}),a.jsx("span",{className:"font-semibold",children:T})]}),a.jsx("span",{className:"text-[11px] text-slate-500",children:"Recover missed visits by creating a fresh appointment."})]})]}),a.jsx(ze,{className:"pt-4",children:o?a.jsx("div",{className:"space-y-3 py-4",children:[1,2,3].map(I=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50/80 px-3 py-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(Ze,{className:"h-4 w-52"}),a.jsx(Ze,{className:"h-3 w-64"})]}),a.jsx(Ze,{className:"h-7 w-28"})]},I))}):i.length===0?a.jsxs("div",{className:"flex flex-col items-center gap-2 py-10 text-center text-sm text-slate-500",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100",children:a.jsx(Ms,{className:"h-5 w-5 text-slate-500"})}),a.jsx("div",{className:"font-medium text-slate-700",children:"No no-show appointments for this filter"}),a.jsx("p",{className:"max-w-md text-xs text-slate-500",children:"Change the doctor or date above to check other days."})]}):a.jsx("div",{className:"space-y-2 pt-1 text-sm",children:i.map(I=>a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[a.jsxs("span",{className:"text-xs font-semibold text-slate-900",children:[gR(I.date),"  ",I.slot_start]}),a.jsx("span",{className:"mx-0.5 text-slate-300",children:""}),a.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-900",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-500"}),I.patient_name]}),a.jsx("span",{className:"mx-0.5 text-slate-400",children:""}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID ",I.uhid]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[I.department_name,"  Dr. ",I.doctor_name,"  Purpose:"," ",I.purpose||"Consultation"]})]}),a.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:()=>A(I),children:[a.jsx(ji,{className:"h-3 w-3"}),"Reschedule"]})})]},I.id))})})]}),d&&a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{className:"text-base",children:"Reschedule No-show"}),a.jsxs(Sa,{className:"text-xs",children:[d.patient_name,"  UHID ",d.uhid,"  Dr."," ",d.doctor_name]})]}),a.jsx(Pe,{type:"button",variant:"ghost",size:"sm",className:"text-xs text-slate-500",onClick:()=>u(null),children:"Close"})]})}),a.jsx(ze,{children:a.jsxs("form",{onSubmit:k,className:"grid gap-3 md:grid-cols-[1fr,1fr,auto] md:items-end text-sm",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Gs,{className:"h-3 w-3"}),"New date"]}),a.jsx(_e,{type:"date",value:h,onChange:I=>m(I.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:[a.jsx(Ni,{className:"h-3 w-3"}),"New time"]}),a.jsx(_e,{type:"time",value:x,onChange:I=>b(I.target.value)})]}),a.jsx(Pe,{type:"submit",disabled:w,children:w?"Rescheduling":"Create new appointment"})]})})]})]})})}function yR(){return new Date().toISOString().slice(0,10)}function bR(t,n){const s=new Date(t);return s.setDate(s.getDate()+n),s.toISOString().slice(0,10)}function vR(t,n){if(!t||!n)return"";try{const s=new Date(t),r=new Date(n),l={day:"2-digit",month:"short",...s.getFullYear()===r.getFullYear()?{}:{year:"numeric"}},o={day:"2-digit",month:"short",year:"numeric"};return`${s.toLocaleDateString("en-IN",l)}  ${r.toLocaleDateString("en-IN",o)}`}catch{return`${t}  ${n}`}}function aDe(){const[t,n]=y.useState(""),[s,r]=y.useState(""),[i,l]=y.useState(null),[o,c]=y.useState(!1),[d,u]=y.useState(null);y.useEffect(()=>{const I=yR(),D=bR(I,-6);n(D),r(I)},[]);const h=y.useCallback(async(I={})=>{var R,P;const D=I.dateFrom||t,O=I.dateTo||s;if(!(!D||!O))try{c(!0);const{data:L}=await Jce({dateFrom:D,dateTo:O,doctorId:i||void 0});u(L)}catch(L){console.error(L),xe.error(((P=(R=L==null?void 0:L.response)==null?void 0:R.data)==null?void 0:P.detail)||"Failed to load OPD dashboard")}finally{c(!1)}},[t,s,i]);y.useEffect(()=>{t&&s&&h()},[t,s,i,h]);const m=I=>{l(I)},x=d||{},b=x.appointments||{},w=x.followups||{},j=x.doctor_stats||[],S=y.useMemo(()=>(j||[]).map(I=>({name:I.doctor_name||`#${I.doctor_id}`,total:I.total_appointments||0,completed:I.completed||0,no_show:I.no_show||0})),[j]),C=x.range||{},A=C.date_from&&C.date_to?vR(C.date_from,C.date_to):vR(t,s),k=b.total??0,T=o&&!d;return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-6xl space-y-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"relative flex h-2 w-2",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-500 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),a.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-700",children:"OPD Analytics"})]}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"OPD Dashboard"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Quick view of OPD appointments, follow-ups and doctor workload for the selected date range."})]}),a.jsxs("div",{className:"flex flex-col items-start gap-2 text-xs text-slate-500 md:items-end",children:[a.jsxs(Xe,{variant:"outline",className:"flex items-center gap-1 rounded-full border-slate-200 bg-white px-3 py-1",children:[a.jsx(yf,{className:"h-3 w-3"}),a.jsx("span",{children:A})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx(Xe,{variant:"outline",className:"rounded-full border-slate-200 bg-slate-50 text-[11px]",children:i?"Filtered by specific doctor":"All doctors in OPD"}),a.jsx("span",{className:"text-[11px] text-slate-400",children:o?"Refreshing":"Live clinical summary"})]})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"border-b border-slate-100 pb-3",children:[a.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[a.jsx(yf,{className:"h-4 w-4"}),"Date & Doctor Filters"]}),a.jsx(Pe,{type:"button",variant:"outline",size:"sm",onClick:()=>{const I=yR(),D=bR(I,-6);n(D),r(I),l(null)},children:"Last 7 days"})]}),a.jsx(Sa,{className:"mt-1 text-xs text-slate-500",children:"Use this view daily for clinical huddle, OPD utilisation review and doctor-wise load balancing."})]}),a.jsxs(ze,{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"From date"}),a.jsx(_e,{type:"date",value:t,onChange:I=>n(I.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"To date"}),a.jsx(_e,{type:"date",value:s,onChange:I=>r(I.target.value)})]}),a.jsx("div",{className:"flex items-end",children:a.jsx(Pe,{type:"button",className:"w-full",variant:"outline",onClick:()=>h({dateFrom:t,dateTo:s}),disabled:o,children:o?"Refreshing":"Refresh"})})]}),a.jsx(Hl,{value:i,onChange:m,label:"Filter by doctor (optional)"})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-1",children:a.jsxs(st,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Total appointments",a.jsx(or,{className:"h-4 w-4 text-slate-400"})]})}),a.jsx(ze,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Ze,{className:"mb-1 h-7 w-16"}),a.jsx(Ze,{className:"h-3 w-32"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.total??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Unique patients:"," ",a.jsx("span",{className:"font-semibold",children:b.unique_patients??""})]})]})})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-1",children:a.jsxs(st,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Completed visits",a.jsx(zr,{className:"h-4 w-4 text-emerald-500"})]})}),a.jsx(ze,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Ze,{className:"mb-1 h-7 w-16"}),a.jsx(Ze,{className:"h-3 w-40"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.completed??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["In progress:"," ",a.jsx("span",{className:"font-semibold",children:b.in_progress??0})," "," Checked-in:"," ",a.jsx("span",{className:"font-semibold",children:b.checked_in??0})]})]})})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-1",children:a.jsxs(st,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["No-show & cancellations",a.jsx(No,{className:"h-4 w-4 text-amber-500"})]})}),a.jsx(ze,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Ze,{className:"mb-1 h-7 w-16"}),a.jsx(Ze,{className:"h-3 w-32"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:b.no_show??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Cancelled:"," ",a.jsx("span",{className:"font-semibold",children:b.cancelled??0})]})]})})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-1",children:a.jsxs(st,{className:"flex items-center justify-between text-xs font-medium text-slate-500",children:["Follow-ups",a.jsx(un,{className:"h-4 w-4 text-sky-500"})]})}),a.jsx(ze,{children:T?a.jsxs(a.Fragment,{children:[a.jsx(Ze,{className:"mb-1 h-7 w-16"}),a.jsx(Ze,{className:"h-3 w-44"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:w.total??""}),a.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Waiting:"," ",a.jsx("span",{className:"font-semibold",children:w.waiting??0})," "," Scheduled:"," ",a.jsx("span",{className:"font-semibold",children:w.scheduled??0})]})]})})]})]}),a.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm lg:col-span-2",children:[a.jsxs(Je,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(st,{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["Doctor-wise OPD load",a.jsx(Ap,{className:"h-4 w-4 text-slate-400"})]}),k>0&&a.jsxs(Xe,{className:"rounded-full bg-slate-900 text-[11px] font-normal text-white",children:["Total: ",k]})]}),a.jsx(Sa,{className:"mt-1 text-xs text-slate-500",children:"Each bar represents total appointments per doctor in the chosen period."})]}),a.jsx(ze,{className:"h-72 pt-2",children:S.length===0?a.jsx("div",{className:"flex h-full items-center justify-center text-sm text-slate-500",children:o?"Loading":"No data in selected range"}):a.jsx(Bd,{width:"100%",height:"100%",children:a.jsxs(Uy,{data:S,children:[a.jsx(ax,{dataKey:"name",tick:{fontSize:11},interval:0,height:40}),a.jsx(ix,{}),a.jsx(zd,{}),a.jsx(rx,{dataKey:"total"})]})})})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-2",children:a.jsxs(st,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Highlights",a.jsx(rse,{className:"h-4 w-4 text-slate-400"})]})}),a.jsxs(ze,{className:"space-y-4 pt-1 text-xs",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50/60 px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-800",children:"Top by appointments"}),a.jsx(Xe,{variant:"outline",className:"rounded-full border-emerald-200 bg-emerald-50 text-[10px] text-emerald-700",children:"Volume"})]}),x.top_doctor_by_appointments?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:x.top_doctor_by_appointments.doctor_name}),a.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",x.top_doctor_by_appointments.department_name||""]}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Total appointments:"," ",a.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.total_appointments}),a.jsx("br",{}),"No-show:"," ",a.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.no_show}),a.jsx("br",{}),"Follow-ups in range:"," ",a.jsx("span",{className:"font-semibold",children:x.top_doctor_by_appointments.followups_in_range})]})]}):a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:o?"Calculating":"No doctor data in this range."})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-800",children:"Top by completed visits"}),a.jsx(Xe,{variant:"outline",className:"rounded-full border-sky-200 bg-sky-50 text-[10px] text-sky-700",children:"Quality"})]}),x.top_doctor_by_completed?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-1 text-[13px] font-medium text-slate-900",children:x.top_doctor_by_completed.doctor_name}),a.jsxs("p",{className:"mt-0.5 text-[11px] text-slate-500",children:["Dept:"," ",x.top_doctor_by_completed.department_name||""]}),a.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Completed visits:"," ",a.jsx("span",{className:"font-semibold",children:x.top_doctor_by_completed.completed})]})]}):a.jsx("p",{className:"mt-1 text-[11px] text-slate-500",children:o?"Calculating":"Waiting for enough completed visits."})]}),a.jsx("p",{className:"text-[10px] leading-relaxed text-slate-500",children:"Use these insights for scheduling next weeks OPD, balancing high-load doctors and monitoring no-show trends."})]})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"pb-2",children:[a.jsxs(st,{className:"flex items-center justify-between text-sm font-medium text-slate-700",children:["Doctor-wise breakdown",a.jsx(Ap,{className:"h-4 w-4 text-slate-400"})]}),a.jsx(Sa,{className:"mt-1 text-xs text-slate-500",children:"Each row shows total load, outcomes and follow-ups for a doctor in the selected range."})]}),a.jsx(ze,{className:"overflow-x-auto pt-2",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b text-xs text-slate-500",children:[a.jsx("th",{className:"py-2 pr-2 text-left",children:"Doctor"}),a.jsx("th",{className:"py-2 px-2 text-left",children:"Department"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"Total"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"Completed"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"No-show"}),a.jsx("th",{className:"py-2 px-2 text-right",children:"Cancelled"}),a.jsx("th",{className:"py-2 pl-2 text-right",children:"Follow-ups"})]})}),a.jsxs("tbody",{children:[j.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"py-4 text-center text-xs text-slate-500",children:o?"Loading":"No data to show"})}),j.map(I=>a.jsxs("tr",{className:"border-b last:border-0 hover:bg-slate-50/70",children:[a.jsx("td",{className:"py-2 pr-2 text-slate-800",children:I.doctor_name}),a.jsx("td",{className:"py-2 px-2 text-slate-600",children:I.department_name||""}),a.jsx("td",{className:"py-2 px-2 text-right",children:I.total_appointments}),a.jsx("td",{className:"py-2 px-2 text-right",children:I.completed}),a.jsx("td",{className:"py-2 px-2 text-right",children:I.no_show}),a.jsx("td",{className:"py-2 px-2 text-right",children:I.cancelled}),a.jsx("td",{className:"py-2 pl-2 text-right",children:I.followups_in_range})]},I.doctor_id))]})]})})]})]})})}function aw(){return ne.get("/inventory/locations")}function iDe(t){return ne.post("/inventory/locations",t)}function lDe(t,n){return ne.put(`/inventory/locations/${t}`,n)}function oDe(t=""){const n=t?{q:t}:{};return ne.get("/inventory/suppliers",{params:n})}function cDe(t){return ne.post("/inventory/suppliers",t)}function dDe(t,n){return ne.put(`/inventory/suppliers/${t}`,n)}function t5(t={}){return ne.get("/inventory/items",{params:t})}function uDe(t){return ne.post("/inventory/items",t)}function fDe(t,n){return ne.put(`/inventory/items/${t}`,n)}function hDe(){return ne.get("/inventory/items/sample-csv",{responseType:"blob"})}function mDe(t){const n=new FormData;return n.append("file",t),ne.post("/inventory/items/bulk-upload",n,{headers:{"Content-Type":"multipart/form-data"}})}function pDe(t={}){return ne.get("/inventory/stock",{params:t})}function xDe(t={}){return ne.get("/inventory/alerts/expiry",{params:t})}function gDe(t={}){return ne.get("/inventory/alerts/expired",{params:t})}function yDe(t={}){return ne.get("/inventory/stock/quarantine",{params:t})}function bDe(t={}){return ne.get("/inventory/alerts/low-stock",{params:t})}function vDe(t={}){return ne.get("/inventory/alerts/max-stock",{params:t})}function wDe(t){return ne.post("/inventory/purchase-orders",t)}function NDe(t={}){return ne.get("/inventory/purchase-orders",{params:t})}function jDe(t,n){return ne.post(`/inventory/purchase-orders/${t}/status`,null,{params:{status:n}})}function SDe(t){return ne.get(`/inventory/purchase-orders/${t}/pdf`,{responseType:"blob"})}function _De(t,n){return ne.post(`/inventory/purchase-orders/${t}/mark-sent`,null,{params:{email_to:n}})}function CDe(t){return ne.post("/inventory/grn",t)}function ADe(t={}){return ne.get("/inventory/grn",{params:t})}function kDe(t){return ne.post(`/inventory/grn/${t}/post`)}function EDe(t){return ne.post("/inventory/returns",t)}function TDe(t={}){return ne.get("/inventory/returns",{params:t})}function IDe(t){return ne.post(`/inventory/returns/${t}/post`)}function PDe(t={}){return ne.get("/inventory/transactions",{params:t})}function MDe(t){return ne.get(`/inventory/items/by-qr/${encodeURIComponent(t)}`)}function ODe(t){return ne.get("/inventory/items/by-qr-number",{params:{qr_number:t}})}function wR(t){return ne.get(`/inventory/items/${t}/qr`,{responseType:"blob"})}var iw="Dialog",[TG]=Du(iw),[DDe,cl]=TG(iw),IG=t=>{const{__scopeDialog:n,children:s,open:r,defaultOpen:i,onOpenChange:l,modal:o=!0}=t,c=y.useRef(null),d=y.useRef(null),[u,h]=Wp({prop:r,defaultProp:i??!1,onChange:l,caller:iw});return a.jsx(DDe,{scope:n,triggerRef:c,contentRef:d,contentId:Pc(),titleId:Pc(),descriptionId:Pc(),open:u,onOpenChange:h,onOpenToggle:y.useCallback(()=>h(m=>!m),[h]),modal:o,children:s})};IG.displayName=iw;var PG="DialogTrigger",RDe=y.forwardRef((t,n)=>{const{__scopeDialog:s,...r}=t,i=cl(PG,s),l=Sn(n,i.triggerRef);return a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":r5(i.open),...r,ref:l,onClick:Vt(t.onClick,i.onOpenToggle)})});RDe.displayName=PG;var n5="DialogPortal",[LDe,MG]=TG(n5,{forceMount:void 0}),OG=t=>{const{__scopeDialog:n,forceMount:s,children:r,container:i}=t,l=cl(n5,n);return a.jsx(LDe,{scope:n,forceMount:s,children:y.Children.map(r,o=>a.jsx(Lo,{present:s||l.open,children:a.jsx(KE,{asChild:!0,container:i,children:o})}))})};OG.displayName=n5;var Qy="DialogOverlay",DG=y.forwardRef((t,n)=>{const s=MG(Qy,t.__scopeDialog),{forceMount:r=s.forceMount,...i}=t,l=cl(Qy,t.__scopeDialog);return l.modal?a.jsx(Lo,{present:r||l.open,children:a.jsx(FDe,{...i,ref:n})}):null});DG.displayName=Qy;var BDe=Jf("DialogOverlay.RemoveScroll"),FDe=y.forwardRef((t,n)=>{const{__scopeDialog:s,...r}=t,i=cl(Qy,s);return a.jsx(YE,{as:BDe,allowPinchZoom:!0,shards:[i.contentRef],children:a.jsx(Yt.div,{"data-state":r5(i.open),...r,ref:n,style:{pointerEvents:"auto",...r.style}})})}),Au="DialogContent",RG=y.forwardRef((t,n)=>{const s=MG(Au,t.__scopeDialog),{forceMount:r=s.forceMount,...i}=t,l=cl(Au,t.__scopeDialog);return a.jsx(Lo,{present:r||l.open,children:l.modal?a.jsx($De,{...i,ref:n}):a.jsx(zDe,{...i,ref:n})})});RG.displayName=Au;var $De=y.forwardRef((t,n)=>{const s=cl(Au,t.__scopeDialog),r=y.useRef(null),i=Sn(n,s.contentRef,r);return y.useEffect(()=>{const l=r.current;if(l)return vq(l)},[]),a.jsx(LG,{...t,ref:i,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vt(t.onCloseAutoFocus,l=>{var o;l.preventDefault(),(o=s.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Vt(t.onPointerDownOutside,l=>{const o=l.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&l.preventDefault()}),onFocusOutside:Vt(t.onFocusOutside,l=>l.preventDefault())})}),zDe=y.forwardRef((t,n)=>{const s=cl(Au,t.__scopeDialog),r=y.useRef(!1),i=y.useRef(!1);return a.jsx(LG,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,l),l.defaultPrevented||(r.current||(c=s.triggerRef.current)==null||c.focus(),l.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:l=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,l),l.defaultPrevented||(r.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=l.target;((u=s.triggerRef.current)==null?void 0:u.contains(o))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),LG=y.forwardRef((t,n)=>{const{__scopeDialog:s,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:l,...o}=t,c=cl(Au,s),d=y.useRef(null),u=Sn(n,d);return KW(),a.jsxs(a.Fragment,{children:[a.jsx(FE,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:l,children:a.jsx(BE,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":r5(c.open),...o,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(UDe,{titleId:c.titleId}),a.jsx(HDe,{contentRef:d,descriptionId:c.descriptionId})]})]})}),s5="DialogTitle",BG=y.forwardRef((t,n)=>{const{__scopeDialog:s,...r}=t,i=cl(s5,s);return a.jsx(Yt.h2,{id:i.titleId,...r,ref:n})});BG.displayName=s5;var FG="DialogDescription",$G=y.forwardRef((t,n)=>{const{__scopeDialog:s,...r}=t,i=cl(FG,s);return a.jsx(Yt.p,{id:i.descriptionId,...r,ref:n})});$G.displayName=FG;var zG="DialogClose",UG=y.forwardRef((t,n)=>{const{__scopeDialog:s,...r}=t,i=cl(zG,s);return a.jsx(Yt.button,{type:"button",...r,ref:n,onClick:Vt(t.onClick,()=>i.onOpenChange(!1))})});UG.displayName=zG;function r5(t){return t?"open":"closed"}var VG="DialogTitleWarning",[a7e,HG]=g1e(VG,{contentName:Au,titleName:s5,docsSlug:"dialog"}),UDe=({titleId:t})=>{const n=HG(VG),s=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return y.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},VDe="DialogDescriptionWarning",HDe=({contentRef:t,descriptionId:n})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${HG(VDe).contentName}}.`;return y.useEffect(()=>{var l;const i=(l=t.current)==null?void 0:l.getAttribute("aria-describedby");n&&i&&(document.getElementById(n)||console.warn(r))},[r,t,n]),null},WG=IG,qG=OG,lw=DG,ow=RG,cw=BG,dw=$G,GG=UG;const rf=WG,WDe=qG,KG=y.forwardRef(({className:t,...n},s)=>a.jsx(lw,{ref:s,className:It("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));KG.displayName=lw.displayName;const _d=y.forwardRef(({className:t,children:n,...s},r)=>a.jsxs(WDe,{children:[a.jsx(KG,{}),a.jsxs(ow,{ref:r,className:It("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[n,a.jsxs(GG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Os,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));_d.displayName=ow.displayName;const Cd=({className:t,...n})=>a.jsx("div",{className:It("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});Cd.displayName="DialogHeader";const Ad=({className:t,...n})=>a.jsx("div",{className:It("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});Ad.displayName="DialogFooter";const kd=y.forwardRef(({className:t,...n},s)=>a.jsx(cw,{ref:s,className:It("text-lg font-semibold leading-none tracking-tight",t),...n}));kd.displayName=cw.displayName;const Ed=y.forwardRef(({className:t,...n},s)=>a.jsx(dw,{ref:s,className:It("text-sm text-muted-foreground",t),...n}));Ed.displayName=dw.displayName;const B2=WG,qDe=qG,YG=y.forwardRef(({className:t,...n},s)=>a.jsx(lw,{className:It("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:s}));YG.displayName=lw.displayName;const GDe=Ob("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Qg=y.forwardRef(({side:t="right",className:n,children:s,...r},i)=>a.jsxs(qDe,{children:[a.jsx(YG,{}),a.jsxs(ow,{ref:i,className:It(GDe({side:t}),n),...r,children:[a.jsxs(GG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[a.jsx(Os,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]}),s]})]}));Qg.displayName=ow.displayName;const Zg=({className:t,...n})=>a.jsx("div",{className:It("flex flex-col space-y-2 text-center sm:text-left",t),...n});Zg.displayName="SheetHeader";const Jg=y.forwardRef(({className:t,...n},s)=>a.jsx(cw,{ref:s,className:It("text-lg font-semibold text-foreground",t),...n}));Jg.displayName=cw.displayName;const e1=y.forwardRef(({className:t,...n},s)=>a.jsx(dw,{ref:s,className:It("text-sm text-muted-foreground",t),...n}));e1.displayName=dw.displayName;function Bi(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return t}}function Or(t){return t==null?"0":Number(t).toLocaleString(void 0,{maximumFractionDigits:2})}function KDe(){const[t,n]=y.useState("dashboard"),[s,r]=y.useState([]),[i,l]=y.useState([]),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,m]=y.useState([]),[x,b]=y.useState([]),[w,j]=y.useState([]),[S,C]=y.useState([]),[A,k]=y.useState([]),[T,I]=y.useState([]),[D,O]=y.useState(!1),[R,P]=y.useState([]),[L,$]=y.useState(!1),[B,V]=y.useState([]),[K,z]=y.useState(!1),[H,Y]=y.useState([]),[G,J]=y.useState(!1),[ee,ye]=y.useState([]),[ie,he]=y.useState(!1),[be,we]=y.useState("ALL"),[Z,ce]=y.useState(""),[Te,le]=y.useState("saleable"),[de,ge]=y.useState(!1),[ae,Ve]=y.useState(null),[nt,wt]=y.useState(!1),[jt,ct]=y.useState(!1),[Me,qe]=y.useState([]),[oe,ue]=y.useState({supplier_id:"",location_id:"",expected_date:"",notes:""}),[De,St]=y.useState({open:!1,poId:null,email:""}),[tn,Lt]=y.useState(!1),[Dt,Un]=y.useState({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),[yn,re]=y.useState([]),[Ce,Ue]=y.useState(!1),[Qe,ht]=y.useState({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),[$e,Xt]=y.useState([]),[Ut,en]=y.useState(!1),[Tn,Rs]=y.useState(null),[Xl,Bt]=y.useState(!1),[Wt,si]=y.useState(null);y.useEffect(()=>{pe(),Tt()},[]);function Tt(){at(),lt(),qt(),Rt(),Ft(),Qn()}async function pe(){try{const[X,je]=await Promise.all([aw(),oDe()]);r(X.data||[]),l(je.data||[])}catch(X){console.error(X)}}async function at(){u(!0);try{const X=await t5({q:Z||void 0,is_active:!0});c(X.data||[])}catch(X){console.error(X)}finally{u(!1)}}async function lt(){O(!0);const X=be&&be!=="ALL"?{location_id:be}:{};try{const[je,Ie,it,Ot,ve,te]=await Promise.all([pDe(X),xDe(X),gDe(X),yDe(X),bDe(X),vDe(X)]);m(je.data||[]),b(Ie.data||[]),j(it.data||[]),C(Ot.data||[]),k(ve.data||[]),I(te.data||[])}catch(je){console.error(je)}finally{O(!1)}}async function qt(){$(!0);try{const X=await NDe({});P(X.data||[])}catch(X){console.error(X)}finally{$(!1)}}async function Rt(){z(!0);try{const X=await ADe({});V(X.data||[])}catch(X){console.error(X)}finally{z(!1)}}async function Ft(){J(!0);try{const X=await TDe({});Y(X.data||[])}catch(X){console.error(X)}finally{J(!1)}}async function Qn(){he(!0);try{const X=await PDe({});ye(X.data||[])}catch(X){console.error(X)}finally{he(!1)}}const bn=y.useMemo(()=>o.length,[o]),Ls=y.useMemo(()=>x.length,[x]),ls=y.useMemo(()=>A.length,[A]),Bs=y.useMemo(()=>w.length,[w]),nr=y.useMemo(()=>S.length,[S]),rt=y.useMemo(()=>R.filter(X=>X.status!=="COMPLETED"&&X.status!=="CANCELLED"&&X.status!=="CLOSED").length,[R]);function Oi(){Ve(null),ge(!0)}function dl(X){Ve(X),ge(!0)}const Ir=async X=>{var Ot,ve;X.preventDefault();const je=X.currentTarget,Ie={code:je.code.value.trim(),name:je.name.value.trim(),generic_name:je.generic_name.value.trim()||null,form:je.form.value.trim()||null,strength:je.strength.value.trim()||null,unit:je.unit.value.trim()||"tablet",pack_size:je.pack_size.value||"10",manufacturer:je.manufacturer.value.trim()||null,default_price:je.default_price.value||null,default_mrp:je.default_mrp.value||null,default_tax_percent:je.default_tax_percent.value||null,reorder_level:je.reorder_level.value||null,max_level:je.max_level.value||null,class_name:je.class_name.value.trim()||null,atc_code:je.atc_code.value.trim()||null,hsn_code:je.hsn_code.value.trim()||null,is_consumable:je.is_consumable.checked,lasa_flag:je.lasa_flag.checked},it=(ve=(Ot=je.qr_number)==null?void 0:Ot.value)==null?void 0:ve.trim();it&&(Ie.qr_number=it);try{ae!=null&&ae.id?(await fDe(ae.id,Ie),xe.success("Item updated")):(await uDe(Ie),xe.success("Item created")),ge(!1),je.reset(),await Promise.all([at(),lt()])}catch(te){console.error("Failed to save item",te)}};function Ho(){Rs(null),en(!0)}function zu(X){Rs(X),en(!0)}async function Uu(X){X.preventDefault();const je=new FormData(X.target),Ie={code:je.get("code")||"",name:je.get("name")||"",description:je.get("description")||"",is_active:!0};if(!Ie.name){xe.error("Location name is required");return}try{Tn?(await lDe(Tn.id,Ie),xe.success("Location updated")):(await iDe(Ie),xe.success("Location created")),en(!1),Rs(null),await pe(),await lt()}catch(it){console.error(it)}}function ri(){si(null),Bt(!0)}function mw(X){si(X),Bt(!0)}async function pw(X){X.preventDefault();const je=new FormData(X.target),Ie={code:je.get("code")||"",name:je.get("name")||"",contact_person:je.get("contact_person")||"",phone:je.get("phone")||"",email:je.get("email")||"",gst_number:je.get("gst_number")||"",address:je.get("address")||"",is_active:!0};if(!Ie.name){xe.error("Supplier name is required");return}try{Wt?(await dDe(Wt.id,Ie),xe.success("Supplier updated")):(await cDe(Ie),xe.success("Supplier created")),Bt(!1),si(null),await pe(),await qt(),await Rt(),await Ft()}catch(it){console.error(it)}}async function ai(){try{const X=await hDe(),je=new Blob([X.data],{type:"text/csv"}),Ie=URL.createObjectURL(je),it=document.createElement("a");it.href=Ie,it.download="pharmacy_items_sample.csv",it.click(),URL.revokeObjectURL(Ie)}catch(X){console.error(X)}}async function mr(X){var Ie,it;X.preventDefault();const je=(it=(Ie=X.target.file)==null?void 0:Ie.files)==null?void 0:it[0];if(!je){xe.error("Please choose a CSV file");return}try{const Ot=await mDe(je);xe.success(`Items uploaded  created: ${Ot.data.created}, updated: ${Ot.data.updated}`),wt(!1),at(),lt()}catch(Ot){console.error(Ot)}}function In(){qe(X=>[...X,{item_id:"",ordered_qty:1,unit_cost:0,tax_percent:0,mrp:0}])}function dd(X,je,Ie){qe(it=>it.map((Ot,ve)=>ve===X?{...Ot,[je]:Ie}:Ot))}function ul(X){qe(je=>je.filter((Ie,it)=>it!==X))}async function Hh(X){if(X.preventDefault(),!oe.supplier_id||!oe.location_id||Me.length===0){xe.error("Supplier, location and at least one line are required");return}const je={supplier_id:Number(oe.supplier_id),location_id:Number(oe.location_id),order_date:new Date().toISOString().slice(0,10),expected_date:oe.expected_date||null,notes:oe.notes||"",items:Me.filter(Ie=>Ie.item_id).map(Ie=>({item_id:Number(Ie.item_id),ordered_qty:Number(Ie.ordered_qty||0),unit_cost:Number(Ie.unit_cost||0),tax_percent:Number(Ie.tax_percent||0),mrp:Number(Ie.mrp||0)}))};if(je.items.length===0){xe.error("Add at least one valid line");return}try{await wDe(je),xe.success("Purchase order created"),ct(!1),qe([]),ue({supplier_id:"",location_id:"",expected_date:"",notes:""}),qt()}catch(Ie){console.error(Ie)}}async function Re(X,je){try{await jDe(X,je),xe.success(`PO marked as ${je}`),qt()}catch(Ie){console.error(Ie)}}async function xw(X){try{const je=await SDe(X),Ie=new Blob([je.data],{type:"application/pdf"}),it=URL.createObjectURL(Ie);window.open(it,"_blank"),setTimeout(()=>URL.revokeObjectURL(it),1e4)}catch(je){console.error(je)}}async function Vn(X){X.preventDefault();const{poId:je,email:Ie}=De;if(!Ie){xe.error("Email is required");return}try{await _De(je,Ie),xe.success("PO marked as SENT"),St({open:!1,poId:null,email:""}),qt()}catch(it){console.error(it)}}function Wo(){re(X=>[...X,{item_id:"",po_item_id:null,batch_no:"",expiry_date:"",quantity:0,free_quantity:0,unit_cost:0,tax_percent:0,mrp:0}])}function ud(X,je,Ie){re(it=>it.map((Ot,ve)=>ve===X?{...Ot,[je]:Ie}:Ot))}function ln(X){re(je=>je.filter((Ie,it)=>it!==X))}async function sn(X){if(X.preventDefault(),!Dt.supplier_id||!Dt.location_id||yn.length===0){xe.error("Supplier, location and at least one line are required");return}const je={po_id:null,supplier_id:Number(Dt.supplier_id),location_id:Number(Dt.location_id),received_date:new Date().toISOString().slice(0,10),invoice_number:Dt.invoice_number||"",invoice_date:Dt.invoice_date||null,notes:Dt.notes||"",items:yn.filter(Ie=>Ie.item_id&&Ie.batch_no).map(Ie=>({item_id:Number(Ie.item_id),po_item_id:Ie.po_item_id?Number(Ie.po_item_id):null,batch_no:Ie.batch_no,expiry_date:Ie.expiry_date||null,quantity:Number(Ie.quantity||0),free_quantity:Number(Ie.free_quantity||0),unit_cost:Number(Ie.unit_cost||0),tax_percent:Number(Ie.tax_percent||0),mrp:Number(Ie.mrp||0)}))};if(je.items.length===0){xe.error("Add at least one valid GRN line");return}try{await CDe(je),xe.success("GRN created in DRAFT"),Lt(!1),re([]),Un({supplier_id:"",location_id:"",invoice_number:"",invoice_date:"",notes:""}),Rt(),lt()}catch(Ie){console.error(Ie)}}async function Qt(X){try{await kDe(X),xe.success("GRN posted & stock updated"),Rt(),lt(),qt()}catch(je){console.error(je)}}function Wh(){Xt(X=>[...X,{item_id:"",batch_id:"",batch_no:"",quantity:0,reason:""}])}function qo(X,je,Ie){Xt(it=>it.map((Ot,ve)=>ve===X?{...Ot,[je]:Ie}:Ot))}function qh(X){Xt(je=>je.filter((Ie,it)=>it!==X))}async function xs(X){if(X.preventDefault(),!Qe.location_id||$e.length===0){xe.error("Location and at least one line are required");return}const je={type:Qe.type,supplier_id:Qe.supplier_id?Number(Qe.supplier_id):null,location_id:Number(Qe.location_id),return_date:new Date().toISOString().slice(0,10),reason:Qe.reason||"",items:$e.filter(Ie=>Ie.item_id&&Ie.quantity).map(Ie=>({item_id:Number(Ie.item_id),batch_id:Ie.batch_id?Number(Ie.batch_id):null,batch_no:Ie.batch_no?Ie.batch_no.trim():null,quantity:Number(Ie.quantity||0),reason:Ie.reason||""}))};if(je.items.length===0){xe.error("Add at least one valid return line");return}try{await EDe(je),xe.success("Return created in DRAFT"),Ue(!1),Xt([]),ht({type:"TO_SUPPLIER",supplier_id:"",location_id:"",reason:""}),Ft(),lt()}catch(Ie){console.error(Ie)}}function Di(X,je="EXPIRED"){var Ot;if(!X)return;const Ie=((Ot=X.item)==null?void 0:Ot.name)||X.name||X.item_name||`Item #${X.item_id??""}`,it=je==="EXPIRED"?`Expired batch ${X.batch_no||""} (${Ie})`:`Quarantine batch ${X.batch_no||""} (${Ie})`;Ue(!0),ht(ve=>({...ve,type:je==="EXPIRED"?"INTERNAL":ve.type,location_id:X.location_id?String(X.location_id):ve.location_id,reason:it})),Xt([{item_id:String(X.item_id),batch_id:String(X.id),batch_no:X.batch_no||"",quantity:Number(X.current_qty??0),reason:je==="EXPIRED"?"Expired":"Quarantine / quality issue"}])}async function gw(X){try{await IDe(X),xe.success("Return posted & stock updated"),Ft(),lt()}catch(je){console.error(je)}}const vn=s.find(X=>String(X.id)===String(be));return a.jsxs(gt.div,{className:"p-4 sm:p-6 lg:p-8 bg-slate-50 min-h-screen",initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},children:[a.jsxs("div",{className:"mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:"Pharmacy Inventory"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Batch-wise stock, purchase  GRN  returns, and full transaction audit for NABH-compliant pharmacy management."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs(Mn,{value:be,onValueChange:X=>{we(X),setTimeout(lt,0)},children:[a.jsx(An,{className:"w-48 bg-white",children:a.jsx(On,{placeholder:"All locations","aria-label":"Location filter"})}),a.jsxs(kn,{children:[a.jsx(Et,{value:"ALL",children:"All locations"}),s.map(X=>a.jsx(Et,{value:String(X.id),children:X.code?`${X.code}  ${X.name}`:X.name},X.id))]})]}),a.jsx(Pe,{variant:"outline",size:"icon",className:"rounded-full",onClick:Tt,children:a.jsx(cu,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"grid gap-4 mb-6 md:grid-cols-4",children:[a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-xs font-medium text-slate-500",children:"Active items"}),a.jsx(Ur,{className:"w-4 h-4 text-slate-400"})]}),a.jsxs(ze,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:bn}),a.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Medicines & consumables in catalogue"})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-xs font-medium text-slate-500",children:"Near-expiry batches"}),a.jsx(No,{className:"w-4 h-4 text-amber-500"})]}),a.jsxs(ze,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:Ls}),a.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Within alert window  Expired on shelf: ",Bs]})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-xs font-medium text-slate-500",children:"Low-stock items"}),a.jsx(vne,{className:"w-4 h-4 text-sky-500"})]}),a.jsxs(ze,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:ls}),a.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Below reorder threshold  Quarantine: ",nr]})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"pb-2 flex flex-row items-center justify-between",children:[a.jsx(st,{className:"text-xs font-medium text-slate-500",children:"Open purchase orders"}),a.jsx(lse,{className:"w-4 h-4 text-emerald-500"})]}),a.jsxs(ze,{children:[a.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:rt}),a.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Draft / sent / partially received"})]})]})]}),a.jsxs(_o,{value:t,onValueChange:n,className:"space-y-4",children:[a.jsxs(Ll,{className:"bg-slate-100 rounded-full p-1 flex flex-wrap gap-1",children:[a.jsx(dn,{value:"dashboard",children:"Dashboard"}),a.jsx(dn,{value:"items",children:"Items"}),a.jsx(dn,{value:"locations",children:"Locations"}),a.jsx(dn,{value:"suppliers",children:"Suppliers"}),a.jsx(dn,{value:"stock",children:"Stock & Alerts"}),a.jsx(dn,{value:"po",children:"Purchase Orders"}),a.jsx(dn,{value:"grn",children:"GRN"}),a.jsx(dn,{value:"returns",children:"Returns"}),a.jsx(dn,{value:"txns",children:"Transactions"})]}),a.jsx(mn,{value:"dashboard",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Expiry alerts",a.jsx(Xe,{variant:"outline",className:"text-xs",children:x.length})]}),a.jsx(No,{className:"w-4 h-4 text-amber-500"})]}),a.jsx(ze,{className:"space-y-3 max-h-[320px] overflow-auto",children:D?a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ze,{className:"h-8 w-full"}),a.jsx(Ze,{className:"h-8 w-full"}),a.jsx(Ze,{className:"h-8 w-full"})]}):x.length===0&&w.length===0?a.jsxs("p",{className:"text-sm text-slate-500",children:["No batches approaching expiry or expired on shelf for"," ",vn?vn.name:"all locations","."]}):a.jsxs(a.Fragment,{children:[w.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-rose-600 uppercase tracking-wide",children:"Expired on shelf"}),a.jsx("div",{className:"space-y-1.5",children:w.map(X=>{var je;return a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-rose-200 bg-rose-50 px-3 py-2",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((je=X.item)==null?void 0:je.name)||X.name||X.item_name||`Item #${X.item_id??""}`,X.batch_no&&a.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",X.batch_no,")"]})]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Or(X.current_qty)," "," Expired:"," ",Bi(X.expiry_date)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Xe,{variant:"outline",className:"text-xs border-rose-300 text-rose-700",children:["Exp:"," ",Bi(X.expiry_date)]}),a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Di(X,"EXPIRED"),children:"Create return"})]})]},`expired-${X.id}`)})})]}),x.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-amber-600 uppercase tracking-wide",children:"Near expiry"}),a.jsx("div",{className:"space-y-1.5",children:x.map(X=>{var je;return a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 px-3 py-2 bg-slate-50",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:[((je=X.item)==null?void 0:je.name)||X.name||X.item_name||`Item #${X.item_id??""}`,X.batch_no&&a.jsxs("span",{className:"text-xs text-slate-500",children:[" ","(",X.batch_no,")"]})]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Qty:"," ",Or(X.current_qty)," "," Exp:"," ",Bi(X.expiry_date)]})]}),a.jsxs(Xe,{variant:"outline",className:"text-xs",children:["Exp:"," ",Bi(X.expiry_date)]})]},`near-${X.id}`)})})]})]})})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock alerts",a.jsx(Xe,{variant:"outline",className:"text-xs",children:A.length+T.length})]}),a.jsx(or,{className:"w-4 h-4 text-sky-500"})]}),a.jsx(ze,{className:"space-y-2 max-h-[320px] overflow-auto",children:D?a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ze,{className:"h-8 w-full"}),a.jsx(Ze,{className:"h-8 w-full"}),a.jsx(Ze,{className:"h-8 w-full"})]}):A.length===0&&T.length===0?a.jsxs("p",{className:"text-sm text-slate-500",children:["No low / max stock issues for"," ",vn?vn.name:"all locations","."]}):a.jsxs(a.Fragment,{children:[A.map(X=>a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:X.name}),a.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Or(X.total_qty)," / Reorder:"," ",Or(X.reorder_level)]})]}),a.jsx(Xe,{variant:"outline",className:"text-xs border-amber-300 text-amber-700",children:"Low stock"})]},`low-${X.item_id}-${X.location_id||"all"}`)),T.map(X=>a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-sky-200 bg-sky-50 px-3 py-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:X.name}),a.jsxs("p",{className:"text-xs text-slate-600",children:["Qty: ",Or(X.total_qty)," / Max:"," ",Or(X.max_level)]})]}),a.jsx(Xe,{variant:"outline",className:"text-xs border-sky-300 text-sky-700",children:"Over-stock"})]},`max-${X.item_id}-${X.location_id||"all"}`))]})})]})]})}),a.jsx(mn,{value:"items",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Pharmacy items",a.jsx(Xe,{variant:"outline",className:"text-xs",children:o.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Medicines & consumables master  supports manual and CSV bulk upload."})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(Pe,{variant:"outline",size:"sm",className:"gap-1",onClick:()=>wt(!0),children:[a.jsx(iS,{className:"w-3 h-3"}),"CSV upload"]}),a.jsxs(Pe,{variant:"outline",size:"sm",className:"gap-1",onClick:ai,children:[a.jsx(Wd,{className:"w-3 h-3"}),"Sample CSV"]}),a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:Oi,children:[a.jsx(Nn,{className:"w-3 h-3"}),"New item"]})]})]}),a.jsxs(ze,{className:"space-y-3",children:[a.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:a.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[a.jsx(_e,{placeholder:"Search by name / code / generic...",className:"w-full sm:w-80 bg-white",value:Z,onChange:X=>ce(X.target.value),onKeyDown:X=>{X.key==="Enter"&&at()}}),a.jsx(Pe,{variant:"outline",size:"icon",className:"rounded-full",onClick:at,children:a.jsx(Ai,{className:"w-4 h-4"})})]})}),a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Name / code"}),a.jsx("span",{children:"Generic / form"}),a.jsx("span",{children:"Default price / MRP"}),a.jsx("span",{children:"Reorder / Max"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[420px] overflow-auto divide-y divide-slate-100",children:d?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):o.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No items found. Use New item or CSV upload to add catalogue."}):o.map(X=>a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr,0.6fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-slate-900",children:X.name}),a.jsxs("div",{className:"text-slate-500 flex flex-wrap items-center gap-1",children:[a.jsx("span",{children:X.code}),X.is_consumable&&a.jsx(Xe,{variant:"outline",className:"text-[10px]",children:"Consumable"}),X.lasa_flag&&a.jsx(Xe,{variant:"outline",className:"text-[10px] border-rose-300 text-rose-600",children:"LASA"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-700",children:X.generic_name||""}),a.jsxs("div",{className:"text-slate-500",children:[X.form||""," ",X.strength&&` ${X.strength}`]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-slate-700",children:["Price: ",Or(X.default_price)]}),a.jsxs("div",{className:"text-slate-500",children:["MRP: ",Or(X.default_mrp),"  Tax:"," ",Or(X.default_tax_percent),"%"]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-slate-700",children:["Reorder: ",Or(X.reorder_level)]}),a.jsxs("div",{className:"text-slate-500",children:["Max: ",Or(X.max_level)]})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>dl(X),children:a.jsx(Gm,{className:"w-3 h-3"})})})]},X.id))})]})]})]})}),a.jsx(mn,{value:"locations",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Inventory locations",a.jsx(Xe,{variant:"outline",className:"text-xs",children:s.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Define pharmacy / store locations for stock segregation and reporting."})]}),a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:Ho,children:[a.jsx(Nn,{className:"w-3 h-3"}),"New location"]})]}),a.jsx(ze,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Code"}),a.jsx("span",{children:"Name"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:s.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No locations defined yet. Click New location to add."}):s.map(X=>a.jsxs("div",{className:"grid grid-cols-[0.6fr,1.4fr,1fr] items-center px-3 py-2 text-xs",children:[a.jsx("div",{className:"text-slate-900 font-medium",children:X.code||""}),a.jsxs("div",{className:"text-slate-900",children:[X.name,X.description&&a.jsx("div",{className:"text-[11px] text-slate-500",children:X.description})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>zu(X),children:a.jsx(Gm,{className:"w-3 h-3"})})})]},X.id))})]})})]})}),a.jsx(mn,{value:"suppliers",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Suppliers",a.jsx(Xe,{variant:"outline",className:"text-xs",children:i.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Maintain vendor master for purchase orders, GRN, and returns."})]}),a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:ri,children:[a.jsx(Nn,{className:"w-3 h-3"}),"New supplier"]})]}),a.jsx(ze,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Code"}),a.jsx("span",{children:"Name / contact"}),a.jsx("span",{children:"Contact details"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:i.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No suppliers defined yet. Click New supplier to add."}):i.map(X=>a.jsxs("div",{className:"grid grid-cols-[0.8fr,1.4fr,1.4fr,0.8fr] items-center px-3 py-2 text-xs",children:[a.jsx("div",{className:"text-slate-900 font-medium",children:X.code||""}),a.jsxs("div",{className:"text-slate-900",children:[X.name,X.contact_person&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Contact: ",X.contact_person]})]}),a.jsxs("div",{className:"text-slate-700 text-[11px] space-y-0.5",children:[X.phone&&a.jsxs("div",{children:[" ",X.phone]}),X.email&&a.jsxs("div",{children:[" ",X.email]}),X.gst_number&&a.jsxs("div",{className:"text-slate-500",children:["GST: ",X.gst_number]})]}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>mw(X),children:a.jsx(Gm,{className:"w-3 h-3"})})})]},X.id))})]})})]})}),a.jsx(mn,{value:"stock",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock summary",a.jsx(Xe,{variant:"outline",className:"text-xs",children:h.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Location-wise quantities with low / max level indicators."})]}),a.jsx(qne,{className:"w-4 h-4 text-slate-400"})]}),a.jsx(ze,{className:"space-y-4",children:a.jsxs(_o,{value:Te,onValueChange:le,className:"space-y-3",children:[a.jsxs(Ll,{className:"bg-slate-100 rounded-full p-1 inline-flex gap-1",children:[a.jsx(dn,{value:"saleable",children:"Saleable stock"}),a.jsx(dn,{value:"quarantine",children:"Expired & quarantine"})]}),a.jsx(mn,{value:"saleable",className:"space-y-3",children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Item"}),a.jsx("span",{children:"Location"}),a.jsx("span",{children:"Qty"}),a.jsx("span",{children:"Status"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:D?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):h.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock summary yet."}):h.map(X=>{const je=[];return X.is_low&&je.push(a.jsx(Xe,{variant:"outline",className:"border-amber-300 text-amber-700 text-[10px]",children:"Low"},"low")),X.is_over&&je.push(a.jsx(Xe,{variant:"outline",className:"border-sky-300 text-sky-700 text-[10px]",children:"Max"},"max")),je.length||je.push(a.jsx(Xe,{variant:"outline",className:"text-[10px]",children:"OK"},"ok")),a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,0.8fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:X.name}),a.jsx("p",{className:"text-slate-500",children:X.code})]}),a.jsx("div",{className:"text-slate-700",children:X.location_name||"All locations"}),a.jsx("div",{className:"text-slate-700",children:Or(X.total_qty)}),a.jsx("div",{className:"flex gap-1 flex-wrap",children:je})]},`${X.item_id}-${X.location_id||"all"}`)})})]})}),a.jsx(mn,{value:"quarantine",className:"space-y-3",children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Item / batch"}),a.jsx("span",{children:"Location"}),a.jsx("span",{children:"Qty / expiry"}),a.jsx("span",{className:"text-right",children:"Status / actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:D?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):S.length===0?a.jsxs("div",{className:"p-4 text-sm text-slate-500",children:["No quarantine / written-off / returned batches for"," ",vn?vn.name:"all locations","."]}):S.map(X=>{var it,Ot,ve;const je=(X.status||"").toUpperCase();let Ie="text-[10px]";return je==="EXPIRED"||je==="WRITTEN_OFF"?Ie+=" border-rose-300 text-rose-700":je==="QUARANTINE"?Ie+=" border-amber-300 text-amber-700":je==="RETURNED"&&(Ie+=" border-slate-300 text-slate-600"),a.jsxs("div",{className:"grid grid-cols-[2fr,1.2fr,1fr,1fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:((it=X.item)==null?void 0:it.name)||X.name||X.item_name||`Item #${X.item_id??""}`}),a.jsxs("p",{className:"text-[11px] text-slate-500",children:["Batch:"," ",X.batch_no||"","  Code:"," ",((Ot=X.item)==null?void 0:Ot.code)||""]})]}),a.jsx("div",{className:"text-slate-700",children:((ve=X.location)==null?void 0:ve.name)||""}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-slate-700",children:["Qty:"," ",Or(X.current_qty)]}),a.jsxs("p",{className:"text-[11px] text-slate-500",children:["Exp:"," ",Bi(X.expiry_date)||""]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(Xe,{variant:"outline",className:Ie,children:je||"UNKNOWN"}),je!=="RETURNED"&&a.jsx(Pe,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Di(X,"QUARANTINE"),children:"Create return"})]})]},`q-${X.id}`)})})]})})]})})]})}),a.jsx(mn,{value:"po",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Purchase orders",a.jsx(Xe,{variant:"outline",className:"text-xs",children:R.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Create POs, print PDF, mark sent, and track status."})]}),a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:()=>ct(!0),children:[a.jsx(Nn,{className:"w-3 h-3"}),"New PO"]})]}),a.jsx(ze,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"PO number"}),a.jsx("span",{children:"Supplier"}),a.jsx("span",{children:"Location / dates"}),a.jsx("span",{children:"Status"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:L?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):R.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No purchase orders created yet."}):R.map(X=>{var je,Ie,it,Ot;return a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:X.po_number}),a.jsxs("p",{className:"text-slate-500",children:["Created: ",Bi(X.order_date)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(je=X.supplier)==null?void 0:je.name}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:((Ie=X.supplier)==null?void 0:Ie.phone)||((it=X.supplier)==null?void 0:it.email)||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(Ot=X.location)==null?void 0:Ot.name}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Exp:"," ",X.expected_date?Bi(X.expected_date):""]})]}),a.jsx("div",{children:a.jsx(Xe,{variant:"outline",className:"text-[10px] capitalize",children:X.status.toLowerCase()})}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>xw(X.id),children:a.jsx(rS,{className:"w-3 h-3"})}),a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>St({open:!0,poId:X.id,email:X.email_sent_to||""}),children:a.jsx(_p,{className:"w-3 h-3"})}),X.status==="DRAFT"||X.status==="SENT"?a.jsxs(Mn,{defaultValue:X.status,onValueChange:ve=>Re(X.id,ve),children:[a.jsx(An,{className:"h-7 w-24 text-[11px] bg-white",children:a.jsx(On,{})}),a.jsxs(kn,{children:[a.jsx(Et,{value:"DRAFT",children:"DRAFT"}),a.jsx(Et,{value:"SENT",children:"SENT"}),a.jsx(Et,{value:"PARTIALLY_RECEIVED",children:"PARTIAL"}),a.jsx(Et,{value:"COMPLETED",children:"COMPLETED"}),a.jsx(Et,{value:"CANCELLED",children:"CANCELLED"}),a.jsx(Et,{value:"CLOSED",children:"CLOSED"})]})]}):a.jsx(Xe,{variant:"outline",className:"text-[10px] capitalize",children:X.status.toLowerCase()})]})]},X.id)})})]})})]})}),a.jsx(mn,{value:"grn",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Goods Receipt Notes",a.jsx(Xe,{variant:"outline",className:"text-xs",children:B.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Post GRNs to create batches and update stock (GRN  Stock transactions)."})]}),a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:()=>Lt(!0),children:[a.jsx(Nn,{className:"w-3 h-3"}),"New GRN"]})]}),a.jsx(ze,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"GRN number"}),a.jsx("span",{children:"Supplier"}),a.jsx("span",{children:"Location / invoice"}),a.jsx("span",{children:"Status"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:K?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):B.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No GRNs created yet."}):B.map(X=>{var je,Ie,it,Ot;return a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:X.grn_number}),a.jsxs("p",{className:"text-slate-500",children:["Received: ",Bi(X.received_date)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(je=X.supplier)==null?void 0:je.name}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:((Ie=X.supplier)==null?void 0:Ie.phone)||((it=X.supplier)==null?void 0:it.email)||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(Ot=X.location)==null?void 0:Ot.name}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Inv: ",X.invoice_number||""," ",X.invoice_date&&` ${Bi(X.invoice_date)}`]})]}),a.jsx("div",{children:a.jsx(Xe,{variant:"outline",className:"text-[10px] capitalize",children:X.status.toLowerCase()})}),a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-7 w-7",children:a.jsx(_r,{className:"w-3 h-3"})}),X.status==="DRAFT"&&a.jsx(Pe,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>Qt(X.id),children:"Post GRN"})]})]},X.id)})})]})})]})}),a.jsx(mn,{value:"returns",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-row items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Returns",a.jsx(Xe,{variant:"outline",className:"text-xs",children:H.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Manage returns to suppliers, from customers, and internal adjustments."})]}),a.jsxs(Pe,{size:"sm",className:"gap-1",onClick:()=>Ue(!0),children:[a.jsx(Nn,{className:"w-3 h-3"}),"New return"]})]}),a.jsx(ze,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Return no."}),a.jsx("span",{children:"Type / supplier"}),a.jsx("span",{children:"Location / reason"}),a.jsx("span",{children:"Status"}),a.jsx("span",{className:"text-right",children:"Actions"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:G?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):H.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No returns recorded yet."}):H.map(X=>{var je,Ie;return a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.2fr,1.2fr,0.9fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:X.return_number}),a.jsxs("p",{className:"text-slate-500",children:["Date: ",Bi(X.return_date)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:X.type.replace("_"," ")}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:((je=X.supplier)==null?void 0:je.name)||""})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:(Ie=X.location)==null?void 0:Ie.name}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:X.reason||""})]}),a.jsx("div",{children:a.jsx(Xe,{variant:"outline",className:"text-[10px] capitalize",children:X.status.toLowerCase()})}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:X.status==="DRAFT"&&a.jsx(Pe,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",onClick:()=>gw(X.id),children:"Post return"})})]},X.id)})})]})})]})}),a.jsx(mn,{value:"txns",children:a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"flex flex-row items-center justify-between",children:a.jsxs("div",{children:[a.jsxs(st,{className:"text-sm font-semibold text-slate-900 flex items-center gap-2",children:["Stock transactions",a.jsx(Xe,{variant:"outline",className:"text-xs",children:ee.length})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Full audit trail of every stock movement (GRN, dispense, returns, adjustments)."})]})}),a.jsx(ze,{children:a.jsxs("div",{className:"border border-slate-200 rounded-2xl overflow-hidden bg-white",children:[a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] px-3 py-2 text-xs font-semibold text-slate-500 bg-slate-50",children:[a.jsx("span",{children:"Date / type"}),a.jsx("span",{children:"Item / batch"}),a.jsx("span",{children:"Location"}),a.jsx("span",{children:"Qty / cost"}),a.jsx("span",{children:"User / ref"})]}),a.jsx("div",{className:"max-h-[440px] overflow-auto divide-y divide-slate-100",children:ie?a.jsxs("div",{className:"p-3 space-y-2",children:[a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"}),a.jsx(Ze,{className:"h-7 w-full"})]}):ee.length===0?a.jsx("div",{className:"p-4 text-sm text-slate-500",children:"No stock transactions yet."}):ee.map(X=>a.jsxs("div",{className:"grid grid-cols-[1.1fr,1.4fr,1fr,1.1fr,0.9fr] items-center px-3 py-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-slate-900",children:Bi(X.txn_time)}),a.jsxs("p",{className:"text-slate-500",children:[X.txn_type," ",X.ref_display?` ${X.ref_display}`:X.ref_type&&X.ref_id?` ${X.ref_type} #${X.ref_id}`:""]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900",children:X.item_name||`Item #${X.item_id}`}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:[X.item_code&&a.jsxs("span",{children:["Code: ",X.item_code,"  "]}),"Batch:"," ",X.batch_no?X.batch_no:X.batch_id?`#${X.batch_id}`:""]})]}),a.jsx("div",{className:"text-slate-700",children:X.location_name||(X.location_id?`Location #${X.location_id}`:"")}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-slate-900",children:["Qty: ",Or(X.quantity_change)]}),a.jsxs("p",{className:"text-slate-500 text-[11px]",children:["Rate: ",Or(X.unit_cost),"  MRP: ",Or(X.mrp)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900 text-[11px]",children:X.user_name||(X.user_id?`User #${X.user_id}`:"System")}),a.jsx("p",{className:"text-slate-500 text-[11px]",children:X.ref_display||(X.ref_type&&X.ref_id?`${X.ref_type} #${X.ref_id}`:"")})]})]},X.id))})]})})]})})]}),a.jsx(rf,{open:de,onOpenChange:ge,children:a.jsxs(_d,{className:"max-w-2xl",children:[a.jsxs(Cd,{children:[a.jsx(kd,{className:"text-base font-semibold",children:ae?"Edit item":"New item"}),a.jsx(Ed,{className:"text-xs",children:"Maintain medicine / consumable master details, including LASA flag and stock thresholds."})]}),a.jsxs("form",{onSubmit:Ir,className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"code",children:"Code"}),a.jsx(_e,{id:"code",name:"code",defaultValue:(ae==null?void 0:ae.code)||"",required:!0})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"qr_number",children:"Barcode number (scan code)"}),a.jsx(_e,{id:"qr_number",name:"qr_number",placeholder:"Leave blank to auto-generate",defaultValue:(ae==null?void 0:ae.qr_number)||""}),a.jsx("p",{className:"text-[11px] text-slate-400 mt-0.5",children:"Optional. Empty =system will create MD_XXXX."})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"name",children:"Name (brand)"}),a.jsx(_e,{id:"name",name:"name",defaultValue:(ae==null?void 0:ae.name)||"",required:!0})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"generic_name",children:"Generic name"}),a.jsx(_e,{id:"generic_name",name:"generic_name",defaultValue:(ae==null?void 0:ae.generic_name)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"form",children:"Form"}),a.jsx(_e,{id:"form",name:"form",placeholder:"tablet / capsule / syrup...",defaultValue:(ae==null?void 0:ae.form)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"strength",children:"Strength"}),a.jsx(_e,{id:"strength",name:"strength",placeholder:"500 mg / 5 mg/ml",defaultValue:(ae==null?void 0:ae.strength)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"unit",children:"Unit"}),a.jsx(_e,{id:"unit",name:"unit",placeholder:"tablet / ml / vial",defaultValue:(ae==null?void 0:ae.unit)||"tablet"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"pack_size",children:"Pack size"}),a.jsx(_e,{id:"pack_size",name:"pack_size",defaultValue:(ae==null?void 0:ae.pack_size)||"10"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"manufacturer",children:"Manufacturer"}),a.jsx(_e,{id:"manufacturer",name:"manufacturer",defaultValue:(ae==null?void 0:ae.manufacturer)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"default_price",children:"Default price"}),a.jsx(_e,{id:"default_price",name:"default_price",type:"number",step:"0.01",defaultValue:(ae==null?void 0:ae.default_price)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"default_mrp",children:"Default MRP"}),a.jsx(_e,{id:"default_mrp",name:"default_mrp",type:"number",step:"0.01",defaultValue:(ae==null?void 0:ae.default_mrp)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"default_tax_percent",children:"Tax %"}),a.jsx(_e,{id:"default_tax_percent",name:"default_tax_percent",type:"number",step:"0.01",defaultValue:(ae==null?void 0:ae.default_tax_percent)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"reorder_level",children:"Reorder level"}),a.jsx(_e,{id:"reorder_level",name:"reorder_level",type:"number",step:"0.01",defaultValue:(ae==null?void 0:ae.reorder_level)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"max_level",children:"Max level"}),a.jsx(_e,{id:"max_level",name:"max_level",type:"number",step:"0.01",defaultValue:(ae==null?void 0:ae.max_level)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"class_name",children:"Therapeutic class"}),a.jsx(_e,{id:"class_name",name:"class_name",defaultValue:(ae==null?void 0:ae.class_name)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"atc_code",children:"ATC code"}),a.jsx(_e,{id:"atc_code",name:"atc_code",defaultValue:(ae==null?void 0:ae.atc_code)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"hsn_code",children:"HSN code"}),a.jsx(_e,{id:"hsn_code",name:"hsn_code",defaultValue:(ae==null?void 0:ae.hsn_code)||""})]}),a.jsxs("div",{className:"flex items-center gap-4 mt-6 text-xs",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",name:"is_consumable",defaultChecked:ae==null?void 0:ae.is_consumable,className:"rounded border-slate-300"}),"Consumable"]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",name:"lasa_flag",defaultChecked:ae==null?void 0:ae.lasa_flag,className:"rounded border-slate-300"}),"LASA (Look-alike / Sound-alike)"]})]})]}),a.jsxs(Ad,{className:"flex justify-between",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>ge(!1),children:"Cancel"}),a.jsx(Pe,{type:"submit",children:ae?"Save changes":"Create item"})]})]})]})}),a.jsx(rf,{open:nt,onOpenChange:wt,children:a.jsxs(_d,{children:[a.jsxs(Cd,{children:[a.jsx(kd,{className:"text-base font-semibold",children:"Bulk upload items (CSV)"}),a.jsx(Ed,{className:"text-xs",children:"Download the sample template, fill with medicines / consumables, then upload here. Existing codes will be updated."})]}),a.jsxs("form",{onSubmit:mr,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"file",children:"CSV file"}),a.jsx(_e,{id:"file",name:"file",type:"file",accept:".csv",required:!0,className:"bg-white"})]}),a.jsxs(Ad,{className:"flex justify-between",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>wt(!1),children:"Cancel"}),a.jsxs(Pe,{type:"submit",className:"gap-1",children:[a.jsx(iS,{className:"w-3 h-3"}),"Upload CSV"]})]})]})]})}),a.jsx(rf,{open:Ut,onOpenChange:en,children:a.jsxs(_d,{className:"max-w-md",children:[a.jsxs(Cd,{children:[a.jsx(kd,{className:"text-base font-semibold",children:Tn?"Edit location":"New location"}),a.jsx(Ed,{className:"text-xs",children:"Define pharmacy / store location used for stock and GRN posting."})]}),a.jsxs("form",{onSubmit:Uu,className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"loc_code",children:"Code"}),a.jsx(_e,{id:"loc_code",name:"code",defaultValue:(Tn==null?void 0:Tn.code)||"",placeholder:"PHARM1 / MAIN"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"loc_name",children:"Name"}),a.jsx(_e,{id:"loc_name",name:"name",required:!0,defaultValue:(Tn==null?void 0:Tn.name)||"",placeholder:"Main Pharmacy"})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"loc_desc",children:"Description"}),a.jsx(_e,{id:"loc_desc",name:"description",defaultValue:(Tn==null?void 0:Tn.description)||"",placeholder:"Optional description"})]}),a.jsxs(Ad,{className:"flex justify-between",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>en(!1),children:"Cancel"}),a.jsx(Pe,{type:"submit",children:Tn?"Save changes":"Create location"})]})]})]})}),a.jsx(rf,{open:Xl,onOpenChange:Bt,children:a.jsxs(_d,{className:"max-w-xl",children:[a.jsxs(Cd,{children:[a.jsx(kd,{className:"text-base font-semibold",children:Wt?"Edit supplier":"New supplier"}),a.jsx(Ed,{className:"text-xs",children:"Vendor details used for purchase orders, GRNs, and returns."})]}),a.jsxs("form",{onSubmit:pw,className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"sup_code",children:"Code"}),a.jsx(_e,{id:"sup_code",name:"code",defaultValue:(Wt==null?void 0:Wt.code)||"",placeholder:"SUPP001"})]}),a.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[a.jsx(Ye,{htmlFor:"sup_name",children:"Name"}),a.jsx(_e,{id:"sup_name",name:"name",required:!0,defaultValue:(Wt==null?void 0:Wt.name)||"",placeholder:"ABC Pharma Distributors"})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"sup_contact_person",children:"Contact person"}),a.jsx(_e,{id:"sup_contact_person",name:"contact_person",defaultValue:(Wt==null?void 0:Wt.contact_person)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"sup_phone",children:"Phone"}),a.jsx(_e,{id:"sup_phone",name:"phone",defaultValue:(Wt==null?void 0:Wt.phone)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"sup_email",children:"Email"}),a.jsx(_e,{id:"sup_email",type:"email",name:"email",defaultValue:(Wt==null?void 0:Wt.email)||""})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"sup_gst",children:"GST number"}),a.jsx(_e,{id:"sup_gst",name:"gst_number",defaultValue:(Wt==null?void 0:Wt.gst_number)||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{htmlFor:"sup_address",children:"Address"}),a.jsx(_e,{id:"sup_address",name:"address",defaultValue:(Wt==null?void 0:Wt.address)||"",placeholder:"City / area / address"})]})]}),a.jsxs(Ad,{className:"flex justify-between",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>Bt(!1),children:"Cancel"}),a.jsx(Pe,{type:"submit",children:Wt?"Save changes":"Create supplier"})]})]})]})}),a.jsx(B2,{open:jt,onOpenChange:ct,children:a.jsxs(Qg,{className:"w-full sm:max-w-xl overflow-y-auto",children:[a.jsxs(Zg,{className:"mb-4",children:[a.jsx(Jg,{className:"text-base font-semibold",children:"New Purchase Order"}),a.jsx(e1,{className:"text-xs",children:"Select supplier & location, then add items with quantities and pricing."})]}),a.jsxs("form",{onSubmit:Hh,className:"space-y-4 pb-6",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Supplier"}),a.jsxs(Mn,{value:oe.supplier_id,onValueChange:X=>ue(je=>({...je,supplier_id:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{placeholder:"Select supplier"})}),a.jsx(kn,{children:i.map(X=>a.jsx(Et,{value:String(X.id),children:X.name},X.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Location"}),a.jsxs(Mn,{value:oe.location_id,onValueChange:X=>ue(je=>({...je,location_id:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{placeholder:"Select location"})}),a.jsx(kn,{children:s.map(X=>a.jsx(Et,{value:String(X.id),children:X.name},X.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Expected date"}),a.jsx(_e,{type:"date",value:oe.expected_date,onChange:X=>ue(je=>({...je,expected_date:X.target.value}))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Notes"}),a.jsx(_e,{placeholder:"Any special instructions",value:oe.notes,onChange:X=>ue(je=>({...je,notes:X.target.value}))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ye,{children:"Line items"}),a.jsxs(Pe,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:In,children:[a.jsx(Nn,{className:"w-3 h-3"}),"Add line"]})]}),Me.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to start."}):a.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:Me.map((X,je)=>a.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[a.jsxs(Mn,{value:X.item_id?String(X.item_id):"",onValueChange:Ie=>dd(je,"item_id",Ie),children:[a.jsx(An,{className:"bg-white h-8",children:a.jsx(On,{placeholder:"Item"})}),a.jsx(kn,{children:o.map(Ie=>a.jsx(Et,{value:String(Ie.id),children:Ie.name},Ie.id))})]}),a.jsx(_e,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:X.ordered_qty,onChange:Ie=>dd(je,"ordered_qty",Ie.target.value)}),a.jsx(_e,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:X.unit_cost,onChange:Ie=>dd(je,"unit_cost",Ie.target.value)}),a.jsx(_e,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Tax %",value:X.tax_percent,onChange:Ie=>dd(je,"tax_percent",Ie.target.value)}),a.jsx(Pe,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ul(je),children:""})]},je))})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>ct(!1),children:"Cancel"}),a.jsx(Pe,{type:"submit",children:"Create PO"})]})]})]})}),a.jsx(rf,{open:De.open,onOpenChange:X=>St(je=>({...je,open:X})),children:a.jsxs(_d,{children:[a.jsxs(Cd,{children:[a.jsx(kd,{className:"text-base font-semibold",children:"Mark PO as sent"}),a.jsx(Ed,{className:"text-xs",children:"Enter supplier email used to send PO PDF. This will be stored in PO history."})]}),a.jsxs("form",{onSubmit:Vn,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Email"}),a.jsx(_e,{type:"email",value:De.email,onChange:X=>St(je=>({...je,email:X.target.value})),required:!0})]}),a.jsxs(Ad,{className:"flex justify-between",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>St({open:!1,poId:null,email:""}),children:"Cancel"}),a.jsxs(Pe,{type:"submit",className:"gap-1",children:[a.jsx(_p,{className:"w-3 h-3"}),"Mark as sent"]})]})]})]})}),a.jsx(B2,{open:tn,onOpenChange:Lt,children:a.jsxs(Qg,{className:"w-full sm:max-w-xl overflow-y-auto",children:[a.jsxs(Zg,{className:"mb-4",children:[a.jsx(Jg,{className:"text-base font-semibold",children:"New GRN (DRAFT)"}),a.jsx(e1,{className:"text-xs",children:"Capture invoice details, batch numbers, and quantities. Post later to update stock."})]}),a.jsxs("form",{onSubmit:sn,className:"space-y-4 pb-6",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Supplier"}),a.jsxs(Mn,{value:Dt.supplier_id,onValueChange:X=>Un(je=>({...je,supplier_id:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{placeholder:"Select supplier"})}),a.jsx(kn,{children:i.map(X=>a.jsx(Et,{value:String(X.id),children:X.name},X.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Location"}),a.jsxs(Mn,{value:Dt.location_id,onValueChange:X=>Un(je=>({...je,location_id:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{placeholder:"Select location"})}),a.jsx(kn,{children:s.map(X=>a.jsx(Et,{value:String(X.id),children:X.name},X.id))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Invoice number"}),a.jsx(_e,{value:Dt.invoice_number,onChange:X=>Un(je=>({...je,invoice_number:X.target.value}))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Invoice date"}),a.jsx(_e,{type:"date",value:Dt.invoice_date,onChange:X=>Un(je=>({...je,invoice_date:X.target.value}))})]}),a.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[a.jsx(Ye,{children:"Notes"}),a.jsx(_e,{value:Dt.notes,onChange:X=>Un(je=>({...je,notes:X.target.value}))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ye,{children:"Line items"}),a.jsxs(Pe,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Wo,children:[a.jsx(Nn,{className:"w-3 h-3"}),"Add line"]})]}),yn.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line to add received batches."}):a.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:yn.map((X,je)=>a.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.8fr,0.4fr]",children:[a.jsxs(Mn,{value:X.item_id?String(X.item_id):"",onValueChange:Ie=>ud(je,"item_id",Ie),children:[a.jsx(An,{className:"bg-white h-8",children:a.jsx(On,{placeholder:"Item"})}),a.jsx(kn,{children:o.map(Ie=>a.jsx(Et,{value:String(Ie.id),children:Ie.name},Ie.id))})]}),a.jsx(_e,{className:"h-8",placeholder:"Batch no.",value:X.batch_no,onChange:Ie=>ud(je,"batch_no",Ie.target.value)}),a.jsx(_e,{type:"date",className:"h-8",value:X.expiry_date,onChange:Ie=>ud(je,"expiry_date",Ie.target.value)}),a.jsx(_e,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:X.quantity,onChange:Ie=>ud(je,"quantity",Ie.target.value)}),a.jsx(_e,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Rate",value:X.unit_cost,onChange:Ie=>ud(je,"unit_cost",Ie.target.value)}),a.jsx(Pe,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ln(je),children:""})]},je))})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>Lt(!1),children:"Cancel"}),a.jsx(Pe,{type:"submit",children:"Create GRN (DRAFT)"})]})]})]})}),a.jsx(B2,{open:Ce,onOpenChange:Ue,children:a.jsxs(Qg,{className:"w-full sm:max-w-xl overflow-y-auto",children:[a.jsxs(Zg,{className:"mb-4",children:[a.jsx(Jg,{className:"text-base font-semibold",children:"New Return (DRAFT)"}),a.jsx(e1,{className:"text-xs",children:"Choose return type (to supplier / from customer / internal), and specify items & quantities."})]}),a.jsxs("form",{onSubmit:xs,className:"space-y-4 pb-6",children:[a.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Return type"}),a.jsxs(Mn,{value:Qe.type,onValueChange:X=>ht(je=>({...je,type:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{})}),a.jsxs(kn,{children:[a.jsx(Et,{value:"TO_SUPPLIER",children:"To Supplier"}),a.jsx(Et,{value:"FROM_CUSTOMER",children:"From Customer"}),a.jsx(Et,{value:"INTERNAL",children:"Internal"})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{children:"Location"}),a.jsxs(Mn,{value:Qe.location_id,onValueChange:X=>ht(je=>({...je,location_id:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{placeholder:"Select location"})}),a.jsx(kn,{children:s.map(X=>a.jsx(Et,{value:String(X.id),children:X.name},X.id))})]})]}),Qe.type==="TO_SUPPLIER"&&a.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[a.jsx(Ye,{children:"Supplier (for return)"}),a.jsxs(Mn,{value:Qe.supplier_id,onValueChange:X=>ht(je=>({...je,supplier_id:X})),children:[a.jsx(An,{className:"bg-white",children:a.jsx(On,{placeholder:"Select supplier"})}),a.jsx(kn,{children:i.map(X=>a.jsx(Et,{value:String(X.id),children:X.name},X.id))})]})]}),a.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[a.jsx(Ye,{children:"Reason"}),a.jsx(_e,{value:Qe.reason,onChange:X=>ht(je=>({...je,reason:X.target.value}))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ye,{children:"Line items"}),a.jsxs(Pe,{type:"button",size:"sm",variant:"outline",className:"gap-1",onClick:Wh,children:[a.jsx(Nn,{className:"w-3 h-3"}),"Add line"]})]}),$e.length===0?a.jsx("p",{className:"text-xs text-slate-500",children:"No lines yet. Click Add line or use Create return from Expired / Quarantine batches."}):a.jsx("div",{className:"space-y-2 max-h-[260px] overflow-auto pr-1",children:$e.map((X,je)=>a.jsxs("div",{className:"grid gap-2 rounded-xl border border-slate-200 p-2 sm:grid-cols-[1.6fr,1fr,0.8fr,0.8fr,0.4fr]",children:[a.jsxs(Mn,{value:X.item_id?String(X.item_id):"",onValueChange:Ie=>qo(je,"item_id",Ie),children:[a.jsx(An,{className:"bg-white h-8",children:a.jsx(On,{placeholder:"Item"})}),a.jsx(kn,{children:o.map(Ie=>a.jsx(Et,{value:String(Ie.id),children:Ie.name},Ie.id))})]}),a.jsx(_e,{className:"h-8",placeholder:"Batch no.",value:X.batch_no||"",onChange:Ie=>qo(je,"batch_no",Ie.target.value)}),a.jsx(_e,{type:"number",min:"0",step:"0.01",className:"h-8",placeholder:"Qty",value:X.quantity,onChange:Ie=>qo(je,"quantity",Ie.target.value)}),a.jsx(_e,{className:"h-8",placeholder:"Reason",value:X.reason,onChange:Ie=>qo(je,"reason",Ie.target.value)}),a.jsx(Pe,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>qh(je),children:""})]},je))})]}),a.jsxs("div",{className:"flex justify-between pt-2",children:[a.jsx(Pe,{type:"button",variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),a.jsx(Pe,{type:"submit",children:"Create Return (DRAFT)"})]})]})]})})]})}var ot;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ot||(ot={}));var NR=new Map([[ot.QR_CODE,"QR_CODE"],[ot.AZTEC,"AZTEC"],[ot.CODABAR,"CODABAR"],[ot.CODE_39,"CODE_39"],[ot.CODE_93,"CODE_93"],[ot.CODE_128,"CODE_128"],[ot.DATA_MATRIX,"DATA_MATRIX"],[ot.MAXICODE,"MAXICODE"],[ot.ITF,"ITF"],[ot.EAN_13,"EAN_13"],[ot.EAN_8,"EAN_8"],[ot.PDF_417,"PDF_417"],[ot.RSS_14,"RSS_14"],[ot.RSS_EXPANDED,"RSS_EXPANDED"],[ot.UPC_A,"UPC_A"],[ot.UPC_E,"UPC_E"],[ot.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),jR;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(jR||(jR={}));function YDe(t){return Object.values(ot).includes(t)}var Kc;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Kc||(Kc={}));var Vi=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[Kc.SCAN_TYPE_CAMERA,Kc.SCAN_TYPE_FILE],t}(),XG=function(){function t(n,s){this.format=n,this.formatName=s}return t.prototype.toString=function(){return this.formatName},t.create=function(n){if(!NR.has(n))throw"".concat(n," not in html5QrcodeSupportedFormatsTextMap");return new t(n,NR.get(n))},t}(),SR=function(){function t(){}return t.createFromText=function(n){var s={text:n};return{decodedText:n,result:s}},t.createFromQrcodeResult=function(n){return{decodedText:n.text,result:n}},t}(),lC;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(lC||(lC={}));var QG=function(){function t(){}return t.createFrom=function(n){return{errorMessage:n,type:lC.UNKWOWN_ERROR}},t}(),ZG=function(){function t(n){this.verbose=n}return t.prototype.log=function(n){this.verbose&&console.log(n)},t.prototype.warn=function(n){this.verbose&&console.warn(n)},t.prototype.logError=function(n,s){(this.verbose||s===!0)&&console.error(n)},t.prototype.logErrors=function(n){if(n.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(n)},t}();function Nl(t){return typeof t>"u"||t===null}function XDe(t,n,s){return t>s?s:t<n?n:t}var Af=function(){function t(){}return t.codeParseError=function(n){return"QR code parse error, error = ".concat(n)},t.errorGettingUserMedia=function(n){return"Error getting userMedia, error = ".concat(n)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),hn=function(){function t(){}return t.scanningStatus=function(){return"Scanning"},t.idleStatus=function(){return"Idle"},t.errorStatus=function(){return"Error"},t.permissionStatus=function(){return"Permission"},t.noCameraFoundErrorStatus=function(){return"No Cameras"},t.lastMatch=function(n){return"Last Match: ".concat(n)},t.codeScannerTitle=function(){return"Code Scanner"},t.cameraPermissionTitle=function(){return"Request Camera Permissions"},t.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},t.noCameraFound=function(){return"No camera found"},t.scanButtonStopScanningText=function(){return"Stop Scanning"},t.scanButtonStartScanningText=function(){return"Start Scanning"},t.torchOnButton=function(){return"Switch On Torch"},t.torchOffButton=function(){return"Switch Off Torch"},t.torchOnFailedMessage=function(){return"Failed to turn on torch"},t.torchOffFailedMessage=function(){return"Failed to turn off torch"},t.scanButtonScanningStarting=function(){return"Launching Camera..."},t.textIfCameraScanSelected=function(){return"Scan an Image File"},t.textIfFileScanSelected=function(){return"Scan using camera directly"},t.selectCamera=function(){return"Select Camera"},t.fileSelectionChooseImage=function(){return"Choose Image"},t.fileSelectionChooseAnother=function(){return"Choose Another"},t.fileSelectionNoImageSelected=function(){return"No image choosen"},t.anonymousCameraPrefix=function(){return"Anonymous Camera"},t.dragAndDropMessage=function(){return"Or drop an image to scan"},t.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},t.zoom=function(){return"zoom"},t.loadingImage=function(){return"Loading image..."},t.cameraScanAltText=function(){return"Camera based scan"},t.fileScanAltText=function(){return"Fule based scan"},t}(),_R=function(){function t(){}return t.poweredBy=function(){return"Powered by "},t.reportIssues=function(){return"Report issues"},t}(),JG=function(){function t(){}return t.isMediaStreamConstraintsValid=function(n,s){if(typeof n!="object"){var r=typeof n;return s.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(i),o=Object.keys(n),c=0,d=o;c<d.length;c++){var u=d[c];if(l.has(u))return s.logError("".concat(u," is not supported videoConstaints."),!0),!1}return!0},t}(),oC={exports:{}};(function(t,n){(function(s,r){r(n)})(tm,function(s){function r(W){return W==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(W,f){W.__proto__=f}||function(W,f){for(var p in f)f.hasOwnProperty(p)&&(W[p]=f[p])};function l(W,f){i(W,f);function p(){this.constructor=W}W.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}function o(W,f){var p=Object.setPrototypeOf;p?p(W,f):W.__proto__=f}function c(W,f){f===void 0&&(f=W.constructor);var p=Error.captureStackTrace;p&&p(W,f)}var d=function(W){l(f,W);function f(p){var g=this.constructor,v=W.call(this,p)||this;return Object.defineProperty(v,"name",{value:g.name,enumerable:!1}),o(v,g.prototype),c(v),v}return f}(Error);class u extends d{constructor(f=void 0){super(f),this.message=f}getKind(){return this.constructor.kind}}u.kind="Exception";class h extends u{}h.kind="ArgumentException";class m extends u{}m.kind="IllegalArgumentException";class x{constructor(f){if(this.binarizer=f,f===null)throw new m("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(f,p){return this.binarizer.getBlackRow(f,p)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(f,p,g,v){const N=this.binarizer.getLuminanceSource().crop(f,p,g,v);return new x(this.binarizer.createBinarizer(N))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const f=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new x(this.binarizer.createBinarizer(f))}rotateCounterClockwise45(){const f=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new x(this.binarizer.createBinarizer(f))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class b extends u{static getChecksumInstance(){return new b}}b.kind="ChecksumException";class w{constructor(f){this.source=f}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class j{static arraycopy(f,p,g,v,N){for(;N--;)g[v++]=f[p++]}static currentTimeMillis(){return Date.now()}}class S extends u{}S.kind="IndexOutOfBoundsException";class C extends S{constructor(f=void 0,p=void 0){super(p),this.index=f,this.message=p}}C.kind="ArrayIndexOutOfBoundsException";class A{static fill(f,p){for(let g=0,v=f.length;g<v;g++)f[g]=p}static fillWithin(f,p,g,v){A.rangeCheck(f.length,p,g);for(let N=p;N<g;N++)f[N]=v}static rangeCheck(f,p,g){if(p>g)throw new m("fromIndex("+p+") > toIndex("+g+")");if(p<0)throw new C(p);if(g>f)throw new C(g)}static asList(...f){return f}static create(f,p,g){return Array.from({length:f}).map(N=>Array.from({length:p}).fill(g))}static createInt32Array(f,p,g){return Array.from({length:f}).map(N=>Int32Array.from({length:p}).fill(g))}static equals(f,p){if(!f||!p||!f.length||!p.length||f.length!==p.length)return!1;for(let g=0,v=f.length;g<v;g++)if(f[g]!==p[g])return!1;return!0}static hashCode(f){if(f===null)return 0;let p=1;for(const g of f)p=31*p+g;return p}static fillUint8Array(f,p){for(let g=0;g!==f.length;g++)f[g]=p}static copyOf(f,p){return f.slice(0,p)}static copyOfUint8Array(f,p){if(f.length<=p){const g=new Uint8Array(p);return g.set(f),g}return f.slice(0,p)}static copyOfRange(f,p,g){const v=g-p,N=new Int32Array(v);return j.arraycopy(f,p,N,0,v),N}static binarySearch(f,p,g){g===void 0&&(g=A.numberComparator);let v=0,N=f.length-1;for(;v<=N;){const _=N+v>>1,E=g(p,f[_]);if(E>0)v=_+1;else if(E<0)N=_-1;else return _}return-v-1}static numberComparator(f,p){return f-p}}class k{static numberOfTrailingZeros(f){let p;if(f===0)return 32;let g=31;return p=f<<16,p!==0&&(g-=16,f=p),p=f<<8,p!==0&&(g-=8,f=p),p=f<<4,p!==0&&(g-=4,f=p),p=f<<2,p!==0&&(g-=2,f=p),g-(f<<1>>>31)}static numberOfLeadingZeros(f){if(f===0)return 32;let p=1;return f>>>16||(p+=16,f<<=16),f>>>24||(p+=8,f<<=8),f>>>28||(p+=4,f<<=4),f>>>30||(p+=2,f<<=2),p-=f>>>31,p}static toHexString(f){return f.toString(16)}static toBinaryString(f){return String(parseInt(String(f),2))}static bitCount(f){return f=f-(f>>>1&1431655765),f=(f&858993459)+(f>>>2&858993459),f=f+(f>>>4)&252645135,f=f+(f>>>8),f=f+(f>>>16),f&63}static truncDivision(f,p){return Math.trunc(f/p)}static parseInt(f,p=void 0){return parseInt(f,p)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class T{constructor(f,p){f===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=f,p==null?this.bits=T.makeArray(f):this.bits=p)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(f){if(f>this.bits.length*32){const p=T.makeArray(f);j.arraycopy(this.bits,0,p,0,this.bits.length),this.bits=p}}get(f){return(this.bits[Math.floor(f/32)]&1<<(f&31))!==0}set(f){this.bits[Math.floor(f/32)]|=1<<(f&31)}flip(f){this.bits[Math.floor(f/32)]^=1<<(f&31)}getNextSet(f){const p=this.size;if(f>=p)return p;const g=this.bits;let v=Math.floor(f/32),N=g[v];N&=~((1<<(f&31))-1);const _=g.length;for(;N===0;){if(++v===_)return p;N=g[v]}const E=v*32+k.numberOfTrailingZeros(N);return E>p?p:E}getNextUnset(f){const p=this.size;if(f>=p)return p;const g=this.bits;let v=Math.floor(f/32),N=~g[v];N&=~((1<<(f&31))-1);const _=g.length;for(;N===0;){if(++v===_)return p;N=~g[v]}const E=v*32+k.numberOfTrailingZeros(N);return E>p?p:E}setBulk(f,p){this.bits[Math.floor(f/32)]=p}setRange(f,p){if(p<f||f<0||p>this.size)throw new m;if(p===f)return;p--;const g=Math.floor(f/32),v=Math.floor(p/32),N=this.bits;for(let _=g;_<=v;_++){const E=_>g?0:f&31,F=(2<<(_<v?31:p&31))-(1<<E);N[_]|=F}}clear(){const f=this.bits.length,p=this.bits;for(let g=0;g<f;g++)p[g]=0}isRange(f,p,g){if(p<f||f<0||p>this.size)throw new m;if(p===f)return!0;p--;const v=Math.floor(f/32),N=Math.floor(p/32),_=this.bits;for(let E=v;E<=N;E++){const M=E>v?0:f&31,U=(2<<(E<N?31:p&31))-(1<<M)&4294967295;if((_[E]&U)!==(g?U:0))return!1}return!0}appendBit(f){this.ensureCapacity(this.size+1),f&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(f,p){if(p<0||p>32)throw new m("Num bits must be between 0 and 32");this.ensureCapacity(this.size+p);for(let g=p;g>0;g--)this.appendBit((f>>g-1&1)===1)}appendBitArray(f){const p=f.size;this.ensureCapacity(this.size+p);for(let g=0;g<p;g++)this.appendBit(f.get(g))}xor(f){if(this.size!==f.size)throw new m("Sizes don't match");const p=this.bits;for(let g=0,v=p.length;g<v;g++)p[g]^=f.bits[g]}toBytes(f,p,g,v){for(let N=0;N<v;N++){let _=0;for(let E=0;E<8;E++)this.get(f)&&(_|=1<<7-E),f++;p[g+N]=_}}getBitArray(){return this.bits}reverse(){const f=new Int32Array(this.bits.length),p=Math.floor((this.size-1)/32),g=p+1,v=this.bits;for(let N=0;N<g;N++){let _=v[N];_=_>>1&1431655765|(_&1431655765)<<1,_=_>>2&858993459|(_&858993459)<<2,_=_>>4&252645135|(_&252645135)<<4,_=_>>8&16711935|(_&16711935)<<8,_=_>>16&65535|(_&65535)<<16,f[p-N]=_}if(this.size!==g*32){const N=g*32-this.size;let _=f[0]>>>N;for(let E=1;E<g;E++){const M=f[E];_|=M<<32-N,f[E-1]=_,_=M>>>N}f[g-1]=_}this.bits=f}static makeArray(f){return new Int32Array(Math.floor((f+31)/32))}equals(f){if(!(f instanceof T))return!1;const p=f;return this.size===p.size&&A.equals(this.bits,p.bits)}hashCode(){return 31*this.size+A.hashCode(this.bits)}toString(){let f="";for(let p=0,g=this.size;p<g;p++)p&7||(f+=" "),f+=this.get(p)?"X":".";return f}clone(){return new T(this.size,this.bits.slice())}}var I;(function(W){W[W.OTHER=0]="OTHER",W[W.PURE_BARCODE=1]="PURE_BARCODE",W[W.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",W[W.TRY_HARDER=3]="TRY_HARDER",W[W.CHARACTER_SET=4]="CHARACTER_SET",W[W.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",W[W.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",W[W.ASSUME_GS1=7]="ASSUME_GS1",W[W.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",W[W.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",W[W.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(I||(I={}));var D=I;class O extends u{static getFormatInstance(){return new O}}O.kind="FormatException";var R;(function(W){W[W.Cp437=0]="Cp437",W[W.ISO8859_1=1]="ISO8859_1",W[W.ISO8859_2=2]="ISO8859_2",W[W.ISO8859_3=3]="ISO8859_3",W[W.ISO8859_4=4]="ISO8859_4",W[W.ISO8859_5=5]="ISO8859_5",W[W.ISO8859_6=6]="ISO8859_6",W[W.ISO8859_7=7]="ISO8859_7",W[W.ISO8859_8=8]="ISO8859_8",W[W.ISO8859_9=9]="ISO8859_9",W[W.ISO8859_10=10]="ISO8859_10",W[W.ISO8859_11=11]="ISO8859_11",W[W.ISO8859_13=12]="ISO8859_13",W[W.ISO8859_14=13]="ISO8859_14",W[W.ISO8859_15=14]="ISO8859_15",W[W.ISO8859_16=15]="ISO8859_16",W[W.SJIS=16]="SJIS",W[W.Cp1250=17]="Cp1250",W[W.Cp1251=18]="Cp1251",W[W.Cp1252=19]="Cp1252",W[W.Cp1256=20]="Cp1256",W[W.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",W[W.UTF8=22]="UTF8",W[W.ASCII=23]="ASCII",W[W.Big5=24]="Big5",W[W.GB18030=25]="GB18030",W[W.EUC_KR=26]="EUC_KR"})(R||(R={}));class P{constructor(f,p,g,...v){this.valueIdentifier=f,this.name=g,typeof p=="number"?this.values=Int32Array.from([p]):this.values=p,this.otherEncodingNames=v,P.VALUE_IDENTIFIER_TO_ECI.set(f,this),P.NAME_TO_ECI.set(g,this);const N=this.values;for(let _=0,E=N.length;_!==E;_++){const M=N[_];P.VALUES_TO_ECI.set(M,this)}for(const _ of v)P.NAME_TO_ECI.set(_,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(f){if(f<0||f>=900)throw new O("incorect value");const p=P.VALUES_TO_ECI.get(f);if(p===void 0)throw new O("incorect value");return p}static getCharacterSetECIByName(f){const p=P.NAME_TO_ECI.get(f);if(p===void 0)throw new O("incorect value");return p}equals(f){if(!(f instanceof P))return!1;const p=f;return this.getName()===p.getName()}}P.VALUE_IDENTIFIER_TO_ECI=new Map,P.VALUES_TO_ECI=new Map,P.NAME_TO_ECI=new Map,P.Cp437=new P(R.Cp437,Int32Array.from([0,2]),"Cp437"),P.ISO8859_1=new P(R.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),P.ISO8859_2=new P(R.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),P.ISO8859_3=new P(R.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),P.ISO8859_4=new P(R.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),P.ISO8859_5=new P(R.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),P.ISO8859_6=new P(R.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),P.ISO8859_7=new P(R.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),P.ISO8859_8=new P(R.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),P.ISO8859_9=new P(R.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),P.ISO8859_10=new P(R.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),P.ISO8859_11=new P(R.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),P.ISO8859_13=new P(R.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),P.ISO8859_14=new P(R.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),P.ISO8859_15=new P(R.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),P.ISO8859_16=new P(R.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),P.SJIS=new P(R.SJIS,20,"SJIS","Shift_JIS"),P.Cp1250=new P(R.Cp1250,21,"Cp1250","windows-1250"),P.Cp1251=new P(R.Cp1251,22,"Cp1251","windows-1251"),P.Cp1252=new P(R.Cp1252,23,"Cp1252","windows-1252"),P.Cp1256=new P(R.Cp1256,24,"Cp1256","windows-1256"),P.UnicodeBigUnmarked=new P(R.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),P.UTF8=new P(R.UTF8,26,"UTF8","UTF-8"),P.ASCII=new P(R.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),P.Big5=new P(R.Big5,28,"Big5"),P.GB18030=new P(R.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),P.EUC_KR=new P(R.EUC_KR,30,"EUC_KR","EUC-KR");class L extends u{}L.kind="UnsupportedOperationException";class ${static decode(f,p){const g=this.encodingName(p);return this.customDecoder?this.customDecoder(f,g):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(g)?this.decodeFallback(f,g):new TextDecoder(g).decode(f)}static shouldDecodeOnFallback(f){return!$.isBrowser()&&f==="ISO-8859-1"}static encode(f,p){const g=this.encodingName(p);return this.customEncoder?this.customEncoder(f,g):typeof TextEncoder>"u"?this.encodeFallback(f):new TextEncoder().encode(f)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(f){return typeof f=="string"?f:f.getName()}static encodingCharacterSet(f){return f instanceof P?f:P.getCharacterSetECIByName(f)}static decodeFallback(f,p){const g=this.encodingCharacterSet(p);if($.isDecodeFallbackSupported(g)){let v="";for(let N=0,_=f.length;N<_;N++){let E=f[N].toString(16);E.length<2&&(E="0"+E),v+="%"+E}return decodeURIComponent(v)}if(g.equals(P.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(f.buffer));throw new L(`Encoding ${this.encodingName(p)} not supported by fallback.`)}static isDecodeFallbackSupported(f){return f.equals(P.UTF8)||f.equals(P.ISO8859_1)||f.equals(P.ASCII)}static encodeFallback(f){const g=btoa(unescape(encodeURIComponent(f))).split(""),v=[];for(let N=0;N<g.length;N++)v.push(g[N].charCodeAt(0));return new Uint8Array(v)}}class B{static castAsNonUtf8Char(f,p=null){const g=p?p.getName():this.ISO88591;return $.decode(new Uint8Array([f]),g)}static guessEncoding(f,p){if(p!=null&&p.get(D.CHARACTER_SET)!==void 0)return p.get(D.CHARACTER_SET).toString();const g=f.length;let v=!0,N=!0,_=!0,E=0,M=0,F=0,U=0,q=0,Q=0,se=0,fe=0,me=0,Ne=0,ke=0;const We=f.length>3&&f[0]===239&&f[1]===187&&f[2]===191;for(let Ke=0;Ke<g&&(v||N||_);Ke++){const Fe=f[Ke]&255;_&&(E>0?Fe&128?E--:_=!1:Fe&128&&(Fe&64?(E++,Fe&32?(E++,Fe&16?(E++,Fe&8?_=!1:U++):F++):M++):_=!1)),v&&(Fe>127&&Fe<160?v=!1:Fe>159&&(Fe<192||Fe===215||Fe===247)&&ke++),N&&(q>0?Fe<64||Fe===127||Fe>252?N=!1:q--:Fe===128||Fe===160||Fe>239?N=!1:Fe>160&&Fe<224?(Q++,fe=0,se++,se>me&&(me=se)):Fe>127?(q++,se=0,fe++,fe>Ne&&(Ne=fe)):(se=0,fe=0))}return _&&E>0&&(_=!1),N&&q>0&&(N=!1),_&&(We||M+F+U>0)?B.UTF8:N&&(B.ASSUME_SHIFT_JIS||me>=3||Ne>=3)?B.SHIFT_JIS:v&&N?me===2&&Q===2||ke*10>=g?B.SHIFT_JIS:B.ISO88591:v?B.ISO88591:N?B.SHIFT_JIS:_?B.UTF8:B.PLATFORM_DEFAULT_ENCODING}static format(f,...p){let g=-1;function v(_,E,M,F,U,q){if(_==="%%")return"%";if(p[++g]===void 0)return;_=F?parseInt(F.substr(1)):void 0;let Q=U?parseInt(U.substr(1)):void 0,se;switch(q){case"s":se=p[g];break;case"c":se=p[g][0];break;case"f":se=parseFloat(p[g]).toFixed(_);break;case"p":se=parseFloat(p[g]).toPrecision(_);break;case"e":se=parseFloat(p[g]).toExponential(_);break;case"x":se=parseInt(p[g]).toString(Q||16);break;case"d":se=parseFloat(parseInt(p[g],Q||10).toPrecision(_)).toFixed(0);break}se=typeof se=="object"?JSON.stringify(se):(+se).toString(Q);let fe=parseInt(M),me=M&&M[0]+""=="0"?"0":" ";for(;se.length<fe;)se=E!==void 0?se+me:me+se;return se}let N=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return f.replace(N,v)}static getBytes(f,p){return $.encode(f,p)}static getCharCode(f,p=0){return f.charCodeAt(p)}static getCharAt(f){return String.fromCharCode(f)}}B.SHIFT_JIS=P.SJIS.getName(),B.GB2312="GB2312",B.ISO88591=P.ISO8859_1.getName(),B.EUC_JP="EUC_JP",B.UTF8=P.UTF8.getName(),B.PLATFORM_DEFAULT_ENCODING=B.UTF8,B.ASSUME_SHIFT_JIS=!1;class V{constructor(f=""){this.value=f}enableDecoding(f){return this.encoding=f,this}append(f){return typeof f=="string"?this.value+=f.toString():this.encoding?this.value+=B.castAsNonUtf8Char(f,this.encoding):this.value+=String.fromCharCode(f),this}appendChars(f,p,g){for(let v=p;p<p+g;v++)this.append(f[v]);return this}length(){return this.value.length}charAt(f){return this.value.charAt(f)}deleteCharAt(f){this.value=this.value.substr(0,f)+this.value.substring(f+1)}setCharAt(f,p){this.value=this.value.substr(0,f)+p+this.value.substr(f+1)}substring(f,p){return this.value.substring(f,p)}setLengthToZero(){this.value=""}toString(){return this.value}insert(f,p){this.value=this.value.substr(0,f)+p+this.value.substr(f+p.length)}}class K{constructor(f,p,g,v){if(this.width=f,this.height=p,this.rowSize=g,this.bits=v,p==null&&(p=f),this.height=p,f<1||p<1)throw new m("Both dimensions must be greater than 0");g==null&&(g=Math.floor((f+31)/32)),this.rowSize=g,v==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(f){const p=f.length,g=f[0].length,v=new K(g,p);for(let N=0;N<p;N++){const _=f[N];for(let E=0;E<g;E++)_[E]&&v.set(E,N)}return v}static parseFromString(f,p,g){if(f===null)throw new m("stringRepresentation cannot be null");const v=new Array(f.length);let N=0,_=0,E=-1,M=0,F=0;for(;F<f.length;)if(f.charAt(F)===`
`||f.charAt(F)==="\r"){if(N>_){if(E===-1)E=N-_;else if(N-_!==E)throw new m("row lengths do not match");_=N,M++}F++}else if(f.substring(F,F+p.length)===p)F+=p.length,v[N]=!0,N++;else if(f.substring(F,F+g.length)===g)F+=g.length,v[N]=!1,N++;else throw new m("illegal character encountered: "+f.substring(F));if(N>_){if(E===-1)E=N-_;else if(N-_!==E)throw new m("row lengths do not match");M++}const U=new K(E,M);for(let q=0;q<N;q++)v[q]&&U.set(Math.floor(q%E),Math.floor(q/E));return U}get(f,p){const g=p*this.rowSize+Math.floor(f/32);return(this.bits[g]>>>(f&31)&1)!==0}set(f,p){const g=p*this.rowSize+Math.floor(f/32);this.bits[g]|=1<<(f&31)&4294967295}unset(f,p){const g=p*this.rowSize+Math.floor(f/32);this.bits[g]&=~(1<<(f&31)&4294967295)}flip(f,p){const g=p*this.rowSize+Math.floor(f/32);this.bits[g]^=1<<(f&31)&4294967295}xor(f){if(this.width!==f.getWidth()||this.height!==f.getHeight()||this.rowSize!==f.getRowSize())throw new m("input matrix dimensions do not match");const p=new T(Math.floor(this.width/32)+1),g=this.rowSize,v=this.bits;for(let N=0,_=this.height;N<_;N++){const E=N*g,M=f.getRow(N,p).getBitArray();for(let F=0;F<g;F++)v[E+F]^=M[F]}}clear(){const f=this.bits,p=f.length;for(let g=0;g<p;g++)f[g]=0}setRegion(f,p,g,v){if(p<0||f<0)throw new m("Left and top must be nonnegative");if(v<1||g<1)throw new m("Height and width must be at least 1");const N=f+g,_=p+v;if(_>this.height||N>this.width)throw new m("The region must fit inside the matrix");const E=this.rowSize,M=this.bits;for(let F=p;F<_;F++){const U=F*E;for(let q=f;q<N;q++)M[U+Math.floor(q/32)]|=1<<(q&31)&4294967295}}getRow(f,p){p==null||p.getSize()<this.width?p=new T(this.width):p.clear();const g=this.rowSize,v=this.bits,N=f*g;for(let _=0;_<g;_++)p.setBulk(_*32,v[N+_]);return p}setRow(f,p){j.arraycopy(p.getBitArray(),0,this.bits,f*this.rowSize,this.rowSize)}rotate180(){const f=this.getWidth(),p=this.getHeight();let g=new T(f),v=new T(f);for(let N=0,_=Math.floor((p+1)/2);N<_;N++)g=this.getRow(N,g),v=this.getRow(p-1-N,v),g.reverse(),v.reverse(),this.setRow(N,v),this.setRow(p-1-N,g)}getEnclosingRectangle(){const f=this.width,p=this.height,g=this.rowSize,v=this.bits;let N=f,_=p,E=-1,M=-1;for(let F=0;F<p;F++)for(let U=0;U<g;U++){const q=v[F*g+U];if(q!==0){if(F<_&&(_=F),F>M&&(M=F),U*32<N){let Q=0;for(;!(q<<31-Q&4294967295);)Q++;U*32+Q<N&&(N=U*32+Q)}if(U*32+31>E){let Q=31;for(;!(q>>>Q);)Q--;U*32+Q>E&&(E=U*32+Q)}}}return E<N||M<_?null:Int32Array.from([N,_,E-N+1,M-_+1])}getTopLeftOnBit(){const f=this.rowSize,p=this.bits;let g=0;for(;g<p.length&&p[g]===0;)g++;if(g===p.length)return null;const v=g/f;let N=g%f*32;const _=p[g];let E=0;for(;!(_<<31-E&4294967295);)E++;return N+=E,Int32Array.from([N,v])}getBottomRightOnBit(){const f=this.rowSize,p=this.bits;let g=p.length-1;for(;g>=0&&p[g]===0;)g--;if(g<0)return null;const v=Math.floor(g/f);let N=Math.floor(g%f)*32;const _=p[g];let E=31;for(;!(_>>>E);)E--;return N+=E,Int32Array.from([N,v])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(f){if(!(f instanceof K))return!1;const p=f;return this.width===p.width&&this.height===p.height&&this.rowSize===p.rowSize&&A.equals(this.bits,p.bits)}hashCode(){let f=this.width;return f=31*f+this.width,f=31*f+this.height,f=31*f+this.rowSize,f=31*f+A.hashCode(this.bits),f}toString(f="X ",p="  ",g=`
`){return this.buildToString(f,p,g)}buildToString(f,p,g){let v=new V;for(let N=0,_=this.height;N<_;N++){for(let E=0,M=this.width;E<M;E++)v.append(this.get(E,N)?f:p);v.append(g)}return v.toString()}clone(){return new K(this.width,this.height,this.rowSize,this.bits.slice())}}class z extends u{static getNotFoundInstance(){return new z}}z.kind="NotFoundException";class H extends w{constructor(f){super(f),this.luminances=H.EMPTY,this.buckets=new Int32Array(H.LUMINANCE_BUCKETS)}getBlackRow(f,p){const g=this.getLuminanceSource(),v=g.getWidth();p==null||p.getSize()<v?p=new T(v):p.clear(),this.initArrays(v);const N=g.getRow(f,this.luminances),_=this.buckets;for(let M=0;M<v;M++)_[(N[M]&255)>>H.LUMINANCE_SHIFT]++;const E=H.estimateBlackPoint(_);if(v<3)for(let M=0;M<v;M++)(N[M]&255)<E&&p.set(M);else{let M=N[0]&255,F=N[1]&255;for(let U=1;U<v-1;U++){const q=N[U+1]&255;(F*4-M-q)/2<E&&p.set(U),M=F,F=q}}return p}getBlackMatrix(){const f=this.getLuminanceSource(),p=f.getWidth(),g=f.getHeight(),v=new K(p,g);this.initArrays(p);const N=this.buckets;for(let M=1;M<5;M++){const F=Math.floor(g*M/5),U=f.getRow(F,this.luminances),q=Math.floor(p*4/5);for(let Q=Math.floor(p/5);Q<q;Q++){const se=U[Q]&255;N[se>>H.LUMINANCE_SHIFT]++}}const _=H.estimateBlackPoint(N),E=f.getMatrix();for(let M=0;M<g;M++){const F=M*p;for(let U=0;U<p;U++)(E[F+U]&255)<_&&v.set(U,M)}return v}createBinarizer(f){return new H(f)}initArrays(f){this.luminances.length<f&&(this.luminances=new Uint8ClampedArray(f));const p=this.buckets;for(let g=0;g<H.LUMINANCE_BUCKETS;g++)p[g]=0}static estimateBlackPoint(f){const p=f.length;let g=0,v=0,N=0;for(let U=0;U<p;U++)f[U]>N&&(v=U,N=f[U]),f[U]>g&&(g=f[U]);let _=0,E=0;for(let U=0;U<p;U++){const q=U-v,Q=f[U]*q*q;Q>E&&(_=U,E=Q)}if(v>_){const U=v;v=_,_=U}if(_-v<=p/16)throw new z;let M=_-1,F=-1;for(let U=_-1;U>v;U--){const q=U-v,Q=q*q*(_-U)*(g-f[U]);Q>F&&(M=U,F=Q)}return M<<H.LUMINANCE_SHIFT}}H.LUMINANCE_BITS=5,H.LUMINANCE_SHIFT=8-H.LUMINANCE_BITS,H.LUMINANCE_BUCKETS=1<<H.LUMINANCE_BITS,H.EMPTY=Uint8ClampedArray.from([0]);class Y extends H{constructor(f){super(f),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const f=this.getLuminanceSource(),p=f.getWidth(),g=f.getHeight();if(p>=Y.MINIMUM_DIMENSION&&g>=Y.MINIMUM_DIMENSION){const v=f.getMatrix();let N=p>>Y.BLOCK_SIZE_POWER;p&Y.BLOCK_SIZE_MASK&&N++;let _=g>>Y.BLOCK_SIZE_POWER;g&Y.BLOCK_SIZE_MASK&&_++;const E=Y.calculateBlackPoints(v,N,_,p,g),M=new K(p,g);Y.calculateThresholdForBlock(v,N,_,p,g,E,M),this.matrix=M}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(f){return new Y(f)}static calculateThresholdForBlock(f,p,g,v,N,_,E){const M=N-Y.BLOCK_SIZE,F=v-Y.BLOCK_SIZE;for(let U=0;U<g;U++){let q=U<<Y.BLOCK_SIZE_POWER;q>M&&(q=M);const Q=Y.cap(U,2,g-3);for(let se=0;se<p;se++){let fe=se<<Y.BLOCK_SIZE_POWER;fe>F&&(fe=F);const me=Y.cap(se,2,p-3);let Ne=0;for(let We=-2;We<=2;We++){const Ke=_[Q+We];Ne+=Ke[me-2]+Ke[me-1]+Ke[me]+Ke[me+1]+Ke[me+2]}const ke=Ne/25;Y.thresholdBlock(f,fe,q,ke,v,E)}}}static cap(f,p,g){return f<p?p:f>g?g:f}static thresholdBlock(f,p,g,v,N,_){for(let E=0,M=g*N+p;E<Y.BLOCK_SIZE;E++,M+=N)for(let F=0;F<Y.BLOCK_SIZE;F++)(f[M+F]&255)<=v&&_.set(p+F,g+E)}static calculateBlackPoints(f,p,g,v,N){const _=N-Y.BLOCK_SIZE,E=v-Y.BLOCK_SIZE,M=new Array(g);for(let F=0;F<g;F++){M[F]=new Int32Array(p);let U=F<<Y.BLOCK_SIZE_POWER;U>_&&(U=_);for(let q=0;q<p;q++){let Q=q<<Y.BLOCK_SIZE_POWER;Q>E&&(Q=E);let se=0,fe=255,me=0;for(let ke=0,We=U*v+Q;ke<Y.BLOCK_SIZE;ke++,We+=v){for(let Ke=0;Ke<Y.BLOCK_SIZE;Ke++){const Fe=f[We+Ke]&255;se+=Fe,Fe<fe&&(fe=Fe),Fe>me&&(me=Fe)}if(me-fe>Y.MIN_DYNAMIC_RANGE)for(ke++,We+=v;ke<Y.BLOCK_SIZE;ke++,We+=v)for(let Ke=0;Ke<Y.BLOCK_SIZE;Ke++)se+=f[We+Ke]&255}let Ne=se>>Y.BLOCK_SIZE_POWER*2;if(me-fe<=Y.MIN_DYNAMIC_RANGE&&(Ne=fe/2,F>0&&q>0)){const ke=(M[F-1][q]+2*M[F][q-1]+M[F-1][q-1])/4;fe<ke&&(Ne=ke)}M[F][q]=Ne}}return M}}Y.BLOCK_SIZE_POWER=3,Y.BLOCK_SIZE=1<<Y.BLOCK_SIZE_POWER,Y.BLOCK_SIZE_MASK=Y.BLOCK_SIZE-1,Y.MINIMUM_DIMENSION=Y.BLOCK_SIZE*5,Y.MIN_DYNAMIC_RANGE=24;class G{constructor(f,p){this.width=f,this.height=p}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(f,p,g,v){throw new L("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new L("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new L("This luminance source does not support rotation by 45 degrees.")}toString(){const f=new Uint8ClampedArray(this.width);let p=new V;for(let g=0;g<this.height;g++){const v=this.getRow(g,f);for(let N=0;N<this.width;N++){const _=v[N]&255;let E;_<64?E="#":_<128?E="+":_<192?E=".":E=" ",p.append(E)}p.append(`
`)}return p.toString()}}class J extends G{constructor(f){super(f.getWidth(),f.getHeight()),this.delegate=f}getRow(f,p){const g=this.delegate.getRow(f,p),v=this.getWidth();for(let N=0;N<v;N++)g[N]=255-(g[N]&255);return g}getMatrix(){const f=this.delegate.getMatrix(),p=this.getWidth()*this.getHeight(),g=new Uint8ClampedArray(p);for(let v=0;v<p;v++)g[v]=255-(f[v]&255);return g}isCropSupported(){return this.delegate.isCropSupported()}crop(f,p,g,v){return new J(this.delegate.crop(f,p,g,v))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new J(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new J(this.delegate.rotateCounterClockwise45())}}class ee extends G{constructor(f){super(f.width,f.height),this.canvas=f,this.tempCanvasElement=null,this.buffer=ee.makeBufferFromCanvasImageData(f)}static makeBufferFromCanvasImageData(f){const p=f.getContext("2d").getImageData(0,0,f.width,f.height);return ee.toGrayscaleBuffer(p.data,f.width,f.height)}static toGrayscaleBuffer(f,p,g){const v=new Uint8ClampedArray(p*g);for(let N=0,_=0,E=f.length;N<E;N+=4,_++){let M;if(f[N+3]===0)M=255;else{const U=f[N],q=f[N+1],Q=f[N+2];M=306*U+601*q+117*Q+512>>10}v[_]=M}return v}getRow(f,p){if(f<0||f>=this.getHeight())throw new m("Requested row is outside the image: "+f);const g=this.getWidth(),v=f*g;return p===null?p=this.buffer.slice(v,v+g):(p.length<g&&(p=new Uint8ClampedArray(g)),p.set(this.buffer.slice(v,v+g))),p}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(f,p,g,v){return super.crop(f,p,g,v),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const f=this.canvas.ownerDocument.createElement("canvas");f.width=this.canvas.width,f.height=this.canvas.height,this.tempCanvasElement=f}return this.tempCanvasElement}rotate(f){const p=this.getTempCanvasElement(),g=p.getContext("2d"),v=f*ee.DEGREE_TO_RADIANS,N=this.canvas.width,_=this.canvas.height,E=Math.ceil(Math.abs(Math.cos(v))*N+Math.abs(Math.sin(v))*_),M=Math.ceil(Math.abs(Math.sin(v))*N+Math.abs(Math.cos(v))*_);return p.width=E,p.height=M,g.translate(E/2,M/2),g.rotate(v),g.drawImage(this.canvas,N/-2,_/-2),this.buffer=ee.makeBufferFromCanvasImageData(p),this}invert(){return new J(this)}}ee.DEGREE_TO_RADIANS=Math.PI/180;class ye{constructor(f,p,g){this.deviceId=f,this.label=p,this.kind="videoinput",this.groupId=g||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var ie=(globalThis||tm||self||window||void 0)&&(globalThis||tm||self||window||void 0).__awaiter||function(W,f,p,g){function v(N){return N instanceof p?N:new p(function(_){_(N)})}return new(p||(p=Promise))(function(N,_){function E(U){try{F(g.next(U))}catch(q){_(q)}}function M(U){try{F(g.throw(U))}catch(q){_(q)}}function F(U){U.done?N(U.value):v(U.value).then(E,M)}F((g=g.apply(W,f||[])).next())})};class he{constructor(f,p=500,g){this.reader=f,this.timeBetweenScansMillis=p,this._hints=g,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(f){this._timeBetweenDecodingAttempts=f<0?0:f}set hints(f){this._hints=f||null}get hints(){return this._hints}listVideoInputDevices(){return ie(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const f=yield navigator.mediaDevices.enumerateDevices(),p=[];for(const g of f){const v=g.kind==="video"?"videoinput":g.kind;if(v!=="videoinput")continue;const N=g.deviceId||g.id,_=g.label||`Video device ${p.length+1}`,E=g.groupId,M={deviceId:N,label:_,kind:v,groupId:E};p.push(M)}return p})}getVideoInputDevices(){return ie(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(p=>new ye(p.deviceId,p.label))})}findDeviceById(f){return ie(this,void 0,void 0,function*(){const p=yield this.listVideoInputDevices();return p?p.find(g=>g.deviceId===f):null})}decodeFromInputVideoDevice(f,p){return ie(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(f,p)})}decodeOnceFromVideoDevice(f,p){return ie(this,void 0,void 0,function*(){this.reset();let g;f?g={deviceId:{exact:f}}:g={facingMode:"environment"};const v={video:g};return yield this.decodeOnceFromConstraints(v,p)})}decodeOnceFromConstraints(f,p){return ie(this,void 0,void 0,function*(){const g=yield navigator.mediaDevices.getUserMedia(f);return yield this.decodeOnceFromStream(g,p)})}decodeOnceFromStream(f,p){return ie(this,void 0,void 0,function*(){this.reset();const g=yield this.attachStreamToVideo(f,p);return yield this.decodeOnce(g)})}decodeFromInputVideoDeviceContinuously(f,p,g){return ie(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(f,p,g)})}decodeFromVideoDevice(f,p,g){return ie(this,void 0,void 0,function*(){let v;f?v={deviceId:{exact:f}}:v={facingMode:"environment"};const N={video:v};return yield this.decodeFromConstraints(N,p,g)})}decodeFromConstraints(f,p,g){return ie(this,void 0,void 0,function*(){const v=yield navigator.mediaDevices.getUserMedia(f);return yield this.decodeFromStream(v,p,g)})}decodeFromStream(f,p,g){return ie(this,void 0,void 0,function*(){this.reset();const v=yield this.attachStreamToVideo(f,p);return yield this.decodeContinuously(v,g)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(f,p){return ie(this,void 0,void 0,function*(){const g=this.prepareVideoElement(p);return this.addVideoSource(g,f),this.videoElement=g,this.stream=f,yield this.playVideoOnLoadAsync(g),g})}playVideoOnLoadAsync(f){return new Promise((p,g)=>this.playVideoOnLoad(f,()=>p()))}playVideoOnLoad(f,p){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(f),f.addEventListener("ended",this.videoEndedListener),f.addEventListener("canplay",this.videoCanPlayListener),f.addEventListener("playing",p),this.tryPlayVideo(f)}isVideoPlaying(f){return f.currentTime>0&&!f.paused&&!f.ended&&f.readyState>2}tryPlayVideo(f){return ie(this,void 0,void 0,function*(){if(this.isVideoPlaying(f)){console.warn("Trying to play video that is already playing.");return}try{yield f.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(f,p){const g=document.getElementById(f);if(!g)throw new h(`element with id '${f}' not found`);if(g.nodeName.toLowerCase()!==p.toLowerCase())throw new h(`element with id '${f}' must be an ${p} element`);return g}decodeFromImage(f,p){if(!f&&!p)throw new h("either imageElement with a src set or an url must be provided");return p&&!f?this.decodeFromImageUrl(p):this.decodeFromImageElement(f)}decodeFromVideo(f,p){if(!f&&!p)throw new h("Either an element with a src set or an URL must be provided");return p&&!f?this.decodeFromVideoUrl(p):this.decodeFromVideoElement(f)}decodeFromVideoContinuously(f,p,g){if(f===void 0&&p===void 0)throw new h("Either an element with a src set or an URL must be provided");return p&&!f?this.decodeFromVideoUrlContinuously(p,g):this.decodeFromVideoElementContinuously(f,g)}decodeFromImageElement(f){if(!f)throw new h("An image element must be provided.");this.reset();const p=this.prepareImageElement(f);this.imageElement=p;let g;return this.isImageLoaded(p)?g=this.decodeOnce(p,!1,!0):g=this._decodeOnLoadImage(p),g}decodeFromVideoElement(f){const p=this._decodeFromVideoElementSetup(f);return this._decodeOnLoadVideo(p)}decodeFromVideoElementContinuously(f,p){const g=this._decodeFromVideoElementSetup(f);return this._decodeOnLoadVideoContinuously(g,p)}_decodeFromVideoElementSetup(f){if(!f)throw new h("A video element must be provided.");this.reset();const p=this.prepareVideoElement(f);return this.videoElement=p,p}decodeFromImageUrl(f){if(!f)throw new h("An URL must be provided.");this.reset();const p=this.prepareImageElement();this.imageElement=p;const g=this._decodeOnLoadImage(p);return p.src=f,g}decodeFromVideoUrl(f){if(!f)throw new h("An URL must be provided.");this.reset();const p=this.prepareVideoElement(),g=this.decodeFromVideoElement(p);return p.src=f,g}decodeFromVideoUrlContinuously(f,p){if(!f)throw new h("An URL must be provided.");this.reset();const g=this.prepareVideoElement(),v=this.decodeFromVideoElementContinuously(g,p);return g.src=f,v}_decodeOnLoadImage(f){return new Promise((p,g)=>{this.imageLoadedListener=()=>this.decodeOnce(f,!1,!0).then(p,g),f.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(f){return ie(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(f),yield this.decodeOnce(f)})}_decodeOnLoadVideoContinuously(f,p){return ie(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(f),this.decodeContinuously(f,p)})}isImageLoaded(f){return!(!f.complete||f.naturalWidth===0)}prepareImageElement(f){let p;return typeof f>"u"&&(p=document.createElement("img"),p.width=200,p.height=200),typeof f=="string"&&(p=this.getMediaElement(f,"img")),f instanceof HTMLImageElement&&(p=f),p}prepareVideoElement(f){let p;return!f&&typeof document<"u"&&(p=document.createElement("video"),p.width=200,p.height=200),typeof f=="string"&&(p=this.getMediaElement(f,"video")),f instanceof HTMLVideoElement&&(p=f),p.setAttribute("autoplay","true"),p.setAttribute("muted","true"),p.setAttribute("playsinline","true"),p}decodeOnce(f,p=!0,g=!0){this._stopAsyncDecode=!1;const v=(N,_)=>{if(this._stopAsyncDecode){_(new z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const E=this.decode(f);N(E)}catch(E){const M=p&&E instanceof z,U=(E instanceof b||E instanceof O)&&g;if(M||U)return setTimeout(v,this._timeBetweenDecodingAttempts,N,_);_(E)}};return new Promise((N,_)=>v(N,_))}decodeContinuously(f,p){this._stopContinuousDecode=!1;const g=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const v=this.decode(f);p(v,null),setTimeout(g,this.timeBetweenScansMillis)}catch(v){p(null,v);const N=v instanceof b||v instanceof O,_=v instanceof z;(N||_)&&setTimeout(g,this._timeBetweenDecodingAttempts)}};g()}decode(f){const p=this.createBinaryBitmap(f);return this.decodeBitmap(p)}_isHTMLVideoElement(f){return f.videoWidth!==0}drawFrameOnCanvas(f,p,g){p||(p={sx:0,sy:0,sWidth:f.videoWidth,sHeight:f.videoHeight,dx:0,dy:0,dWidth:f.videoWidth,dHeight:f.videoHeight}),g||(g=this.captureCanvasContext),g.drawImage(f,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}drawImageOnCanvas(f,p,g=this.captureCanvasContext){p||(p={sx:0,sy:0,sWidth:f.naturalWidth,sHeight:f.naturalHeight,dx:0,dy:0,dWidth:f.naturalWidth,dHeight:f.naturalHeight}),g||(g=this.captureCanvasContext),g.drawImage(f,p.sx,p.sy,p.sWidth,p.sHeight,p.dx,p.dy,p.dWidth,p.dHeight)}createBinaryBitmap(f){this.getCaptureCanvasContext(f),this._isHTMLVideoElement(f)?this.drawFrameOnCanvas(f):this.drawImageOnCanvas(f);const p=this.getCaptureCanvas(f),g=new ee(p),v=new Y(g);return new x(v)}getCaptureCanvasContext(f){if(!this.captureCanvasContext){const g=this.getCaptureCanvas(f).getContext("2d");this.captureCanvasContext=g}return this.captureCanvasContext}getCaptureCanvas(f){if(!this.captureCanvas){const p=this.createCaptureCanvas(f);this.captureCanvas=p}return this.captureCanvas}decodeBitmap(f){return this.reader.decode(f,this._hints)}createCaptureCanvas(f){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const p=document.createElement("canvas");let g,v;return typeof f<"u"&&(f instanceof HTMLVideoElement?(g=f.videoWidth,v=f.videoHeight):f instanceof HTMLImageElement&&(g=f.naturalWidth||f.width,v=f.naturalHeight||f.height)),p.style.width=g+"px",p.style.height=v+"px",p.width=g,p.height=v,p}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(f=>f.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(f,p){try{f.srcObject=p}catch{f.src=URL.createObjectURL(p)}}cleanVideoSource(f){try{f.srcObject=null}catch{f.src=""}this.videoElement.removeAttribute("src")}}class be{constructor(f,p,g=p==null?0:8*p.length,v,N,_=j.currentTimeMillis()){this.text=f,this.rawBytes=p,this.numBits=g,this.resultPoints=v,this.format=N,this.timestamp=_,this.text=f,this.rawBytes=p,g==null?this.numBits=p==null?0:8*p.length:this.numBits=g,this.resultPoints=v,this.format=N,this.resultMetadata=null,_==null?this.timestamp=j.currentTimeMillis():this.timestamp=_}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(f,p){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(f,p)}putAllMetadata(f){f!==null&&(this.resultMetadata===null?this.resultMetadata=f:this.resultMetadata=new Map(f))}addResultPoints(f){const p=this.resultPoints;if(p===null)this.resultPoints=f;else if(f!==null&&f.length>0){const g=new Array(p.length+f.length);j.arraycopy(p,0,g,0,p.length),j.arraycopy(f,0,g,p.length,f.length),this.resultPoints=g}}getTimestamp(){return this.timestamp}toString(){return this.text}}var we;(function(W){W[W.AZTEC=0]="AZTEC",W[W.CODABAR=1]="CODABAR",W[W.CODE_39=2]="CODE_39",W[W.CODE_93=3]="CODE_93",W[W.CODE_128=4]="CODE_128",W[W.DATA_MATRIX=5]="DATA_MATRIX",W[W.EAN_8=6]="EAN_8",W[W.EAN_13=7]="EAN_13",W[W.ITF=8]="ITF",W[W.MAXICODE=9]="MAXICODE",W[W.PDF_417=10]="PDF_417",W[W.QR_CODE=11]="QR_CODE",W[W.RSS_14=12]="RSS_14",W[W.RSS_EXPANDED=13]="RSS_EXPANDED",W[W.UPC_A=14]="UPC_A",W[W.UPC_E=15]="UPC_E",W[W.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(we||(we={}));var Z=we,ce;(function(W){W[W.OTHER=0]="OTHER",W[W.ORIENTATION=1]="ORIENTATION",W[W.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",W[W.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",W[W.ISSUE_NUMBER=4]="ISSUE_NUMBER",W[W.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",W[W.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",W[W.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",W[W.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",W[W.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",W[W.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ce||(ce={}));var Te=ce;class le{constructor(f,p,g,v,N=-1,_=-1){this.rawBytes=f,this.text=p,this.byteSegments=g,this.ecLevel=v,this.structuredAppendSequenceNumber=N,this.structuredAppendParity=_,this.numBits=f==null?0:8*f.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(f){this.numBits=f}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(f){this.errorsCorrected=f}getErasures(){return this.erasures}setErasures(f){this.erasures=f}getOther(){return this.other}setOther(f){this.other=f}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class de{exp(f){return this.expTable[f]}log(f){if(f===0)throw new m;return this.logTable[f]}static addOrSubtract(f,p){return f^p}}class ge{constructor(f,p){if(p.length===0)throw new m;this.field=f;const g=p.length;if(g>1&&p[0]===0){let v=1;for(;v<g&&p[v]===0;)v++;v===g?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(g-v),j.arraycopy(p,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(f){return this.coefficients[this.coefficients.length-1-f]}evaluateAt(f){if(f===0)return this.getCoefficient(0);const p=this.coefficients;let g;if(f===1){g=0;for(let _=0,E=p.length;_!==E;_++){const M=p[_];g=de.addOrSubtract(g,M)}return g}g=p[0];const v=p.length,N=this.field;for(let _=1;_<v;_++)g=de.addOrSubtract(N.multiply(f,g),p[_]);return g}addOrSubtract(f){if(!this.field.equals(f.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero())return f;if(f.isZero())return this;let p=this.coefficients,g=f.coefficients;if(p.length>g.length){const _=p;p=g,g=_}let v=new Int32Array(g.length);const N=g.length-p.length;j.arraycopy(g,0,v,0,N);for(let _=N;_<g.length;_++)v[_]=de.addOrSubtract(p[_-N],g[_]);return new ge(this.field,v)}multiply(f){if(!this.field.equals(f.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero()||f.isZero())return this.field.getZero();const p=this.coefficients,g=p.length,v=f.coefficients,N=v.length,_=new Int32Array(g+N-1),E=this.field;for(let M=0;M<g;M++){const F=p[M];for(let U=0;U<N;U++)_[M+U]=de.addOrSubtract(_[M+U],E.multiply(F,v[U]))}return new ge(E,_)}multiplyScalar(f){if(f===0)return this.field.getZero();if(f===1)return this;const p=this.coefficients.length,g=this.field,v=new Int32Array(p),N=this.coefficients;for(let _=0;_<p;_++)v[_]=g.multiply(N[_],f);return new ge(g,v)}multiplyByMonomial(f,p){if(f<0)throw new m;if(p===0)return this.field.getZero();const g=this.coefficients,v=g.length,N=new Int32Array(v+f),_=this.field;for(let E=0;E<v;E++)N[E]=_.multiply(g[E],p);return new ge(_,N)}divide(f){if(!this.field.equals(f.field))throw new m("GenericGFPolys do not have same GenericGF field");if(f.isZero())throw new m("Divide by 0");const p=this.field;let g=p.getZero(),v=this;const N=f.getCoefficient(f.getDegree()),_=p.inverse(N);for(;v.getDegree()>=f.getDegree()&&!v.isZero();){const E=v.getDegree()-f.getDegree(),M=p.multiply(v.getCoefficient(v.getDegree()),_),F=f.multiplyByMonomial(E,M),U=p.buildMonomial(E,M);g=g.addOrSubtract(U),v=v.addOrSubtract(F)}return[g,v]}toString(){let f="";for(let p=this.getDegree();p>=0;p--){let g=this.getCoefficient(p);if(g!==0){if(g<0?(f+=" - ",g=-g):f.length>0&&(f+=" + "),p===0||g!==1){const v=this.field.log(g);v===0?f+="1":v===1?f+="a":(f+="a^",f+=v)}p!==0&&(p===1?f+="x":(f+="x^",f+=p))}}return f}}class ae extends u{}ae.kind="ArithmeticException";class Ve extends de{constructor(f,p,g){super(),this.primitive=f,this.size=p,this.generatorBase=g;const v=new Int32Array(p);let N=1;for(let E=0;E<p;E++)v[E]=N,N*=2,N>=p&&(N^=f,N&=p-1);this.expTable=v;const _=new Int32Array(p);for(let E=0;E<p-1;E++)_[v[E]]=E;this.logTable=_,this.zero=new ge(this,Int32Array.from([0])),this.one=new ge(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(f,p){if(f<0)throw new m;if(p===0)return this.zero;const g=new Int32Array(f+1);return g[0]=p,new ge(this,g)}inverse(f){if(f===0)throw new ae;return this.expTable[this.size-this.logTable[f]-1]}multiply(f,p){return f===0||p===0?0:this.expTable[(this.logTable[f]+this.logTable[p])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(f){return f===this}}Ve.AZTEC_DATA_12=new Ve(4201,4096,1),Ve.AZTEC_DATA_10=new Ve(1033,1024,1),Ve.AZTEC_DATA_6=new Ve(67,64,1),Ve.AZTEC_PARAM=new Ve(19,16,1),Ve.QR_CODE_FIELD_256=new Ve(285,256,0),Ve.DATA_MATRIX_FIELD_256=new Ve(301,256,1),Ve.AZTEC_DATA_8=Ve.DATA_MATRIX_FIELD_256,Ve.MAXICODE_FIELD_64=Ve.AZTEC_DATA_6;class nt extends u{}nt.kind="ReedSolomonException";class wt extends u{}wt.kind="IllegalStateException";class jt{constructor(f){this.field=f}decode(f,p){const g=this.field,v=new ge(g,f),N=new Int32Array(p);let _=!0;for(let se=0;se<p;se++){const fe=v.evaluateAt(g.exp(se+g.getGeneratorBase()));N[N.length-1-se]=fe,fe!==0&&(_=!1)}if(_)return;const E=new ge(g,N),M=this.runEuclideanAlgorithm(g.buildMonomial(p,1),E,p),F=M[0],U=M[1],q=this.findErrorLocations(F),Q=this.findErrorMagnitudes(U,q);for(let se=0;se<q.length;se++){const fe=f.length-1-g.log(q[se]);if(fe<0)throw new nt("Bad error location");f[fe]=Ve.addOrSubtract(f[fe],Q[se])}}runEuclideanAlgorithm(f,p,g){if(f.getDegree()<p.getDegree()){const se=f;f=p,p=se}const v=this.field;let N=f,_=p,E=v.getZero(),M=v.getOne();for(;_.getDegree()>=(g/2|0);){let se=N,fe=E;if(N=_,E=M,N.isZero())throw new nt("r_{i-1} was zero");_=se;let me=v.getZero();const Ne=N.getCoefficient(N.getDegree()),ke=v.inverse(Ne);for(;_.getDegree()>=N.getDegree()&&!_.isZero();){const We=_.getDegree()-N.getDegree(),Ke=v.multiply(_.getCoefficient(_.getDegree()),ke);me=me.addOrSubtract(v.buildMonomial(We,Ke)),_=_.addOrSubtract(N.multiplyByMonomial(We,Ke))}if(M=me.multiply(E).addOrSubtract(fe),_.getDegree()>=N.getDegree())throw new wt("Division algorithm failed to reduce polynomial?")}const F=M.getCoefficient(0);if(F===0)throw new nt("sigmaTilde(0) was zero");const U=v.inverse(F),q=M.multiplyScalar(U),Q=_.multiplyScalar(U);return[q,Q]}findErrorLocations(f){const p=f.getDegree();if(p===1)return Int32Array.from([f.getCoefficient(1)]);const g=new Int32Array(p);let v=0;const N=this.field;for(let _=1;_<N.getSize()&&v<p;_++)f.evaluateAt(_)===0&&(g[v]=N.inverse(_),v++);if(v!==p)throw new nt("Error locator degree does not match number of roots");return g}findErrorMagnitudes(f,p){const g=p.length,v=new Int32Array(g),N=this.field;for(let _=0;_<g;_++){const E=N.inverse(p[_]);let M=1;for(let F=0;F<g;F++)if(_!==F){const U=N.multiply(p[F],E),q=U&1?U&-2:U|1;M=N.multiply(M,q)}v[_]=N.multiply(f.evaluateAt(E),N.inverse(M)),N.getGeneratorBase()!==0&&(v[_]=N.multiply(v[_],E))}return v}}var ct;(function(W){W[W.UPPER=0]="UPPER",W[W.LOWER=1]="LOWER",W[W.MIXED=2]="MIXED",W[W.DIGIT=3]="DIGIT",W[W.PUNCT=4]="PUNCT",W[W.BINARY=5]="BINARY"})(ct||(ct={}));class Me{decode(f){this.ddata=f;let p=f.getBits(),g=this.extractBits(p),v=this.correctBits(g),N=Me.convertBoolArrayToByteArray(v),_=Me.getEncodedData(v),E=new le(N,_,null,null);return E.setNumBits(v.length),E}static highLevelDecode(f){return this.getEncodedData(f)}static getEncodedData(f){let p=f.length,g=ct.UPPER,v=ct.UPPER,N="",_=0;for(;_<p;)if(v===ct.BINARY){if(p-_<5)break;let E=Me.readCode(f,_,5);if(_+=5,E===0){if(p-_<11)break;E=Me.readCode(f,_,11)+31,_+=11}for(let M=0;M<E;M++){if(p-_<8){_=p;break}const F=Me.readCode(f,_,8);N+=B.castAsNonUtf8Char(F),_+=8}v=g}else{let E=v===ct.DIGIT?4:5;if(p-_<E)break;let M=Me.readCode(f,_,E);_+=E;let F=Me.getCharacter(v,M);F.startsWith("CTRL_")?(g=v,v=Me.getTable(F.charAt(5)),F.charAt(6)==="L"&&(g=v)):(N+=F,v=g)}return N}static getTable(f){switch(f){case"L":return ct.LOWER;case"P":return ct.PUNCT;case"M":return ct.MIXED;case"D":return ct.DIGIT;case"B":return ct.BINARY;case"U":default:return ct.UPPER}}static getCharacter(f,p){switch(f){case ct.UPPER:return Me.UPPER_TABLE[p];case ct.LOWER:return Me.LOWER_TABLE[p];case ct.MIXED:return Me.MIXED_TABLE[p];case ct.PUNCT:return Me.PUNCT_TABLE[p];case ct.DIGIT:return Me.DIGIT_TABLE[p];default:throw new wt("Bad table")}}correctBits(f){let p,g;this.ddata.getNbLayers()<=2?(g=6,p=Ve.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(g=8,p=Ve.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(g=10,p=Ve.AZTEC_DATA_10):(g=12,p=Ve.AZTEC_DATA_12);let v=this.ddata.getNbDatablocks(),N=f.length/g;if(N<v)throw new O;let _=f.length%g,E=new Int32Array(N);for(let Q=0;Q<N;Q++,_+=g)E[Q]=Me.readCode(f,_,g);try{new jt(p).decode(E,N-v)}catch(Q){throw new O(Q)}let M=(1<<g)-1,F=0;for(let Q=0;Q<v;Q++){let se=E[Q];if(se===0||se===M)throw new O;(se===1||se===M-1)&&F++}let U=new Array(v*g-F),q=0;for(let Q=0;Q<v;Q++){let se=E[Q];if(se===1||se===M-1)U.fill(se>1,q,q+g-1),q+=g-1;else for(let fe=g-1;fe>=0;--fe)U[q++]=(se&1<<fe)!==0}return U}extractBits(f){let p=this.ddata.isCompact(),g=this.ddata.getNbLayers(),v=(p?11:14)+g*4,N=new Int32Array(v),_=new Array(this.totalBitsInLayer(g,p));if(p)for(let E=0;E<N.length;E++)N[E]=E;else{let E=v+1+2*k.truncDivision(k.truncDivision(v,2)-1,15),M=v/2,F=k.truncDivision(E,2);for(let U=0;U<M;U++){let q=U+k.truncDivision(U,15);N[M-U-1]=F-q-1,N[M+U]=F+q+1}}for(let E=0,M=0;E<g;E++){let F=(g-E)*4+(p?9:12),U=E*2,q=v-1-U;for(let Q=0;Q<F;Q++){let se=Q*2;for(let fe=0;fe<2;fe++)_[M+se+fe]=f.get(N[U+fe],N[U+Q]),_[M+2*F+se+fe]=f.get(N[U+Q],N[q-fe]),_[M+4*F+se+fe]=f.get(N[q-fe],N[q-Q]),_[M+6*F+se+fe]=f.get(N[q-Q],N[U+fe])}M+=F*8}return _}static readCode(f,p,g){let v=0;for(let N=p;N<p+g;N++)v<<=1,f[N]&&(v|=1);return v}static readByte(f,p){let g=f.length-p;return g>=8?Me.readCode(f,p,8):Me.readCode(f,p,g)<<8-g}static convertBoolArrayToByteArray(f){let p=new Uint8Array((f.length+7)/8);for(let g=0;g<p.length;g++)p[g]=Me.readByte(f,8*g);return p}totalBitsInLayer(f,p){return((p?88:112)+16*f)*f}}Me.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Me.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Me.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Me.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Me.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class qe{constructor(){}static round(f){return f===NaN?0:f<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:f>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:f+(f<0?-.5:.5)|0}static distance(f,p,g,v){const N=f-g,_=p-v;return Math.sqrt(N*N+_*_)}static sum(f){let p=0;for(let g=0,v=f.length;g!==v;g++){const N=f[g];p+=N}return p}}class oe{static floatToIntBits(f){return f}}oe.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ue{constructor(f,p){this.x=f,this.y=p}getX(){return this.x}getY(){return this.y}equals(f){if(f instanceof ue){const p=f;return this.x===p.x&&this.y===p.y}return!1}hashCode(){return 31*oe.floatToIntBits(this.x)+oe.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(f){const p=this.distance(f[0],f[1]),g=this.distance(f[1],f[2]),v=this.distance(f[0],f[2]);let N,_,E;if(g>=p&&g>=v?(_=f[0],N=f[1],E=f[2]):v>=g&&v>=p?(_=f[1],N=f[0],E=f[2]):(_=f[2],N=f[0],E=f[1]),this.crossProductZ(N,_,E)<0){const M=N;N=E,E=M}f[0]=N,f[1]=_,f[2]=E}static distance(f,p){return qe.distance(f.x,f.y,p.x,p.y)}static crossProductZ(f,p,g){const v=p.x,N=p.y;return(g.x-v)*(f.y-N)-(g.y-N)*(f.x-v)}}class De{constructor(f,p){this.bits=f,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class St extends De{constructor(f,p,g,v,N){super(f,p),this.compact=g,this.nbDatablocks=v,this.nbLayers=N}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class tn{constructor(f,p,g,v){this.image=f,this.height=f.getHeight(),this.width=f.getWidth(),p==null&&(p=tn.INIT_SIZE),g==null&&(g=f.getWidth()/2|0),v==null&&(v=f.getHeight()/2|0);const N=p/2|0;if(this.leftInit=g-N,this.rightInit=g+N,this.upInit=v-N,this.downInit=v+N,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new z}detect(){let f=this.leftInit,p=this.rightInit,g=this.upInit,v=this.downInit,N=!1,_=!0,E=!1,M=!1,F=!1,U=!1,q=!1;const Q=this.width,se=this.height;for(;_;){_=!1;let fe=!0;for(;(fe||!M)&&p<Q;)fe=this.containsBlackPoint(g,v,p,!1),fe?(p++,_=!0,M=!0):M||p++;if(p>=Q){N=!0;break}let me=!0;for(;(me||!F)&&v<se;)me=this.containsBlackPoint(f,p,v,!0),me?(v++,_=!0,F=!0):F||v++;if(v>=se){N=!0;break}let Ne=!0;for(;(Ne||!U)&&f>=0;)Ne=this.containsBlackPoint(g,v,f,!1),Ne?(f--,_=!0,U=!0):U||f--;if(f<0){N=!0;break}let ke=!0;for(;(ke||!q)&&g>=0;)ke=this.containsBlackPoint(f,p,g,!0),ke?(g--,_=!0,q=!0):q||g--;if(g<0){N=!0;break}_&&(E=!0)}if(!N&&E){const fe=p-f;let me=null;for(let Ke=1;me===null&&Ke<fe;Ke++)me=this.getBlackPointOnSegment(f,v-Ke,f+Ke,v);if(me==null)throw new z;let Ne=null;for(let Ke=1;Ne===null&&Ke<fe;Ke++)Ne=this.getBlackPointOnSegment(f,g+Ke,f+Ke,g);if(Ne==null)throw new z;let ke=null;for(let Ke=1;ke===null&&Ke<fe;Ke++)ke=this.getBlackPointOnSegment(p,g+Ke,p-Ke,g);if(ke==null)throw new z;let We=null;for(let Ke=1;We===null&&Ke<fe;Ke++)We=this.getBlackPointOnSegment(p,v-Ke,p-Ke,v);if(We==null)throw new z;return this.centerEdges(We,me,ke,Ne)}else throw new z}getBlackPointOnSegment(f,p,g,v){const N=qe.round(qe.distance(f,p,g,v)),_=(g-f)/N,E=(v-p)/N,M=this.image;for(let F=0;F<N;F++){const U=qe.round(f+F*_),q=qe.round(p+F*E);if(M.get(U,q))return new ue(U,q)}return null}centerEdges(f,p,g,v){const N=f.getX(),_=f.getY(),E=p.getX(),M=p.getY(),F=g.getX(),U=g.getY(),q=v.getX(),Q=v.getY(),se=tn.CORR;return N<this.width/2?[new ue(q-se,Q+se),new ue(E+se,M+se),new ue(F-se,U-se),new ue(N+se,_-se)]:[new ue(q+se,Q+se),new ue(E+se,M-se),new ue(F-se,U+se),new ue(N-se,_-se)]}containsBlackPoint(f,p,g,v){const N=this.image;if(v){for(let _=f;_<=p;_++)if(N.get(_,g))return!0}else for(let _=f;_<=p;_++)if(N.get(g,_))return!0;return!1}}tn.INIT_SIZE=10,tn.CORR=1;class Lt{static checkAndNudgePoints(f,p){const g=f.getWidth(),v=f.getHeight();let N=!0;for(let _=0;_<p.length&&N;_+=2){const E=Math.floor(p[_]),M=Math.floor(p[_+1]);if(E<-1||E>g||M<-1||M>v)throw new z;N=!1,E===-1?(p[_]=0,N=!0):E===g&&(p[_]=g-1,N=!0),M===-1?(p[_+1]=0,N=!0):M===v&&(p[_+1]=v-1,N=!0)}N=!0;for(let _=p.length-2;_>=0&&N;_-=2){const E=Math.floor(p[_]),M=Math.floor(p[_+1]);if(E<-1||E>g||M<-1||M>v)throw new z;N=!1,E===-1?(p[_]=0,N=!0):E===g&&(p[_]=g-1,N=!0),M===-1?(p[_+1]=0,N=!0):M===v&&(p[_+1]=v-1,N=!0)}}}class Dt{constructor(f,p,g,v,N,_,E,M,F){this.a11=f,this.a21=p,this.a31=g,this.a12=v,this.a22=N,this.a32=_,this.a13=E,this.a23=M,this.a33=F}static quadrilateralToQuadrilateral(f,p,g,v,N,_,E,M,F,U,q,Q,se,fe,me,Ne){const ke=Dt.quadrilateralToSquare(f,p,g,v,N,_,E,M);return Dt.squareToQuadrilateral(F,U,q,Q,se,fe,me,Ne).times(ke)}transformPoints(f){const p=f.length,g=this.a11,v=this.a12,N=this.a13,_=this.a21,E=this.a22,M=this.a23,F=this.a31,U=this.a32,q=this.a33;for(let Q=0;Q<p;Q+=2){const se=f[Q],fe=f[Q+1],me=N*se+M*fe+q;f[Q]=(g*se+_*fe+F)/me,f[Q+1]=(v*se+E*fe+U)/me}}transformPointsWithValues(f,p){const g=this.a11,v=this.a12,N=this.a13,_=this.a21,E=this.a22,M=this.a23,F=this.a31,U=this.a32,q=this.a33,Q=f.length;for(let se=0;se<Q;se++){const fe=f[se],me=p[se],Ne=N*fe+M*me+q;f[se]=(g*fe+_*me+F)/Ne,p[se]=(v*fe+E*me+U)/Ne}}static squareToQuadrilateral(f,p,g,v,N,_,E,M){const F=f-g+N-E,U=p-v+_-M;if(F===0&&U===0)return new Dt(g-f,N-g,f,v-p,_-v,p,0,0,1);{const q=g-N,Q=E-N,se=v-_,fe=M-_,me=q*fe-Q*se,Ne=(F*fe-Q*U)/me,ke=(q*U-F*se)/me;return new Dt(g-f+Ne*g,E-f+ke*E,f,v-p+Ne*v,M-p+ke*M,p,Ne,ke,1)}}static quadrilateralToSquare(f,p,g,v,N,_,E,M){return Dt.squareToQuadrilateral(f,p,g,v,N,_,E,M).buildAdjoint()}buildAdjoint(){return new Dt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(f){return new Dt(this.a11*f.a11+this.a21*f.a12+this.a31*f.a13,this.a11*f.a21+this.a21*f.a22+this.a31*f.a23,this.a11*f.a31+this.a21*f.a32+this.a31*f.a33,this.a12*f.a11+this.a22*f.a12+this.a32*f.a13,this.a12*f.a21+this.a22*f.a22+this.a32*f.a23,this.a12*f.a31+this.a22*f.a32+this.a32*f.a33,this.a13*f.a11+this.a23*f.a12+this.a33*f.a13,this.a13*f.a21+this.a23*f.a22+this.a33*f.a23,this.a13*f.a31+this.a23*f.a32+this.a33*f.a33)}}class Un extends Lt{sampleGrid(f,p,g,v,N,_,E,M,F,U,q,Q,se,fe,me,Ne,ke,We,Ke){const Fe=Dt.quadrilateralToQuadrilateral(v,N,_,E,M,F,U,q,Q,se,fe,me,Ne,ke,We,Ke);return this.sampleGridWithTransform(f,p,g,Fe)}sampleGridWithTransform(f,p,g,v){if(p<=0||g<=0)throw new z;const N=new K(p,g),_=new Float32Array(2*p);for(let E=0;E<g;E++){const M=_.length,F=E+.5;for(let U=0;U<M;U+=2)_[U]=U/2+.5,_[U+1]=F;v.transformPoints(_),Lt.checkAndNudgePoints(f,_);try{for(let U=0;U<M;U+=2)f.get(Math.floor(_[U]),Math.floor(_[U+1]))&&N.set(U/2,E)}catch{throw new z}}return N}}class yn{static setGridSampler(f){yn.gridSampler=f}static getInstance(){return yn.gridSampler}}yn.gridSampler=new Un;class re{constructor(f,p){this.x=f,this.y=p}toResultPoint(){return new ue(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Ce{constructor(f){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=f}detect(){return this.detectMirror(!1)}detectMirror(f){let p=this.getMatrixCenter(),g=this.getBullsEyeCorners(p);if(f){let _=g[0];g[0]=g[2],g[2]=_}this.extractParameters(g);let v=this.sampleGrid(this.image,g[this.shift%4],g[(this.shift+1)%4],g[(this.shift+2)%4],g[(this.shift+3)%4]),N=this.getMatrixCornerPoints(g);return new St(v,N,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(f){if(!this.isValidPoint(f[0])||!this.isValidPoint(f[1])||!this.isValidPoint(f[2])||!this.isValidPoint(f[3]))throw new z;let p=2*this.nbCenterLayers,g=new Int32Array([this.sampleLine(f[0],f[1],p),this.sampleLine(f[1],f[2],p),this.sampleLine(f[2],f[3],p),this.sampleLine(f[3],f[0],p)]);this.shift=this.getRotation(g,p);let v=0;for(let _=0;_<4;_++){let E=g[(this.shift+_)%4];this.compact?(v<<=7,v+=E>>1&127):(v<<=10,v+=(E>>2&992)+(E>>1&31))}let N=this.getCorrectedParameterData(v,this.compact);this.compact?(this.nbLayers=(N>>6)+1,this.nbDataBlocks=(N&63)+1):(this.nbLayers=(N>>11)+1,this.nbDataBlocks=(N&2047)+1)}getRotation(f,p){let g=0;f.forEach((v,N,_)=>{let E=(v>>p-2<<1)+(v&1);g=(g<<3)+E}),g=((g&1)<<11)+(g>>1);for(let v=0;v<4;v++)if(k.bitCount(g^this.EXPECTED_CORNER_BITS[v])<=2)return v;throw new z}getCorrectedParameterData(f,p){let g,v;p?(g=7,v=2):(g=10,v=4);let N=g-v,_=new Int32Array(g);for(let M=g-1;M>=0;--M)_[M]=f&15,f>>=4;try{new jt(Ve.AZTEC_PARAM).decode(_,N)}catch{throw new z}let E=0;for(let M=0;M<v;M++)E=(E<<4)+_[M];return E}getBullsEyeCorners(f){let p=f,g=f,v=f,N=f,_=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let q=this.getFirstDifferent(p,_,1,-1),Q=this.getFirstDifferent(g,_,1,1),se=this.getFirstDifferent(v,_,-1,1),fe=this.getFirstDifferent(N,_,-1,-1);if(this.nbCenterLayers>2){let me=this.distancePoint(fe,q)*this.nbCenterLayers/(this.distancePoint(N,p)*(this.nbCenterLayers+2));if(me<.75||me>1.25||!this.isWhiteOrBlackRectangle(q,Q,se,fe))break}p=q,g=Q,v=se,N=fe,_=!_}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new z;this.compact=this.nbCenterLayers===5;let E=new ue(p.getX()+.5,p.getY()-.5),M=new ue(g.getX()+.5,g.getY()+.5),F=new ue(v.getX()-.5,v.getY()+.5),U=new ue(N.getX()-.5,N.getY()-.5);return this.expandSquare([E,M,F,U],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let f,p,g,v;try{let E=new tn(this.image).detect();f=E[0],p=E[1],g=E[2],v=E[3]}catch{let M=this.image.getWidth()/2,F=this.image.getHeight()/2;f=this.getFirstDifferent(new re(M+7,F-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new re(M+7,F+7),!1,1,1).toResultPoint(),g=this.getFirstDifferent(new re(M-7,F+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new re(M-7,F-7),!1,-1,-1).toResultPoint()}let N=qe.round((f.getX()+v.getX()+p.getX()+g.getX())/4),_=qe.round((f.getY()+v.getY()+p.getY()+g.getY())/4);try{let E=new tn(this.image,15,N,_).detect();f=E[0],p=E[1],g=E[2],v=E[3]}catch{f=this.getFirstDifferent(new re(N+7,_-7),!1,1,-1).toResultPoint(),p=this.getFirstDifferent(new re(N+7,_+7),!1,1,1).toResultPoint(),g=this.getFirstDifferent(new re(N-7,_+7),!1,-1,1).toResultPoint(),v=this.getFirstDifferent(new re(N-7,_-7),!1,-1,-1).toResultPoint()}return N=qe.round((f.getX()+v.getX()+p.getX()+g.getX())/4),_=qe.round((f.getY()+v.getY()+p.getY()+g.getY())/4),new re(N,_)}getMatrixCornerPoints(f){return this.expandSquare(f,2*this.nbCenterLayers,this.getDimension())}sampleGrid(f,p,g,v,N){let _=yn.getInstance(),E=this.getDimension(),M=E/2-this.nbCenterLayers,F=E/2+this.nbCenterLayers;return _.sampleGrid(f,E,E,M,M,F,M,F,F,M,F,p.getX(),p.getY(),g.getX(),g.getY(),v.getX(),v.getY(),N.getX(),N.getY())}sampleLine(f,p,g){let v=0,N=this.distanceResultPoint(f,p),_=N/g,E=f.getX(),M=f.getY(),F=_*(p.getX()-f.getX())/N,U=_*(p.getY()-f.getY())/N;for(let q=0;q<g;q++)this.image.get(qe.round(E+q*F),qe.round(M+q*U))&&(v|=1<<g-q-1);return v}isWhiteOrBlackRectangle(f,p,g,v){let N=3;f=new re(f.getX()-N,f.getY()+N),p=new re(p.getX()-N,p.getY()-N),g=new re(g.getX()+N,g.getY()-N),v=new re(v.getX()+N,v.getY()+N);let _=this.getColor(v,f);if(_===0)return!1;let E=this.getColor(f,p);return E!==_||(E=this.getColor(p,g),E!==_)?!1:(E=this.getColor(g,v),E===_)}getColor(f,p){let g=this.distancePoint(f,p),v=(p.getX()-f.getX())/g,N=(p.getY()-f.getY())/g,_=0,E=f.getX(),M=f.getY(),F=this.image.get(f.getX(),f.getY()),U=Math.ceil(g);for(let Q=0;Q<U;Q++)E+=v,M+=N,this.image.get(qe.round(E),qe.round(M))!==F&&_++;let q=_/g;return q>.1&&q<.9?0:q<=.1===F?1:-1}getFirstDifferent(f,p,g,v){let N=f.getX()+g,_=f.getY()+v;for(;this.isValid(N,_)&&this.image.get(N,_)===p;)N+=g,_+=v;for(N-=g,_-=v;this.isValid(N,_)&&this.image.get(N,_)===p;)N+=g;for(N-=g;this.isValid(N,_)&&this.image.get(N,_)===p;)_+=v;return _-=v,new re(N,_)}expandSquare(f,p,g){let v=g/(2*p),N=f[0].getX()-f[2].getX(),_=f[0].getY()-f[2].getY(),E=(f[0].getX()+f[2].getX())/2,M=(f[0].getY()+f[2].getY())/2,F=new ue(E+v*N,M+v*_),U=new ue(E-v*N,M-v*_);N=f[1].getX()-f[3].getX(),_=f[1].getY()-f[3].getY(),E=(f[1].getX()+f[3].getX())/2,M=(f[1].getY()+f[3].getY())/2;let q=new ue(E+v*N,M+v*_),Q=new ue(E-v*N,M-v*_);return[F,q,U,Q]}isValid(f,p){return f>=0&&f<this.image.getWidth()&&p>0&&p<this.image.getHeight()}isValidPoint(f){let p=qe.round(f.getX()),g=qe.round(f.getY());return this.isValid(p,g)}distancePoint(f,p){return qe.distance(f.getX(),f.getY(),p.getX(),p.getY())}distanceResultPoint(f,p){return qe.distance(f.getX(),f.getY(),p.getX(),p.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class Ue{decode(f,p=null){let g=null,v=new Ce(f.getBlackMatrix()),N=null,_=null;try{let U=v.detectMirror(!1);N=U.getPoints(),this.reportFoundResultPoints(p,N),_=new Me().decode(U)}catch(U){g=U}if(_==null)try{let U=v.detectMirror(!0);N=U.getPoints(),this.reportFoundResultPoints(p,N),_=new Me().decode(U)}catch(U){throw g??U}let E=new be(_.getText(),_.getRawBytes(),_.getNumBits(),N,Z.AZTEC,j.currentTimeMillis()),M=_.getByteSegments();M!=null&&E.putMetadata(Te.BYTE_SEGMENTS,M);let F=_.getECLevel();return F!=null&&E.putMetadata(Te.ERROR_CORRECTION_LEVEL,F),E}reportFoundResultPoints(f,p){if(f!=null){let g=f.get(D.NEED_RESULT_POINT_CALLBACK);g!=null&&p.forEach((v,N,_)=>{g.foundPossibleResultPoint(v)})}}reset(){}}class Qe extends he{constructor(f=500){super(new Ue,f)}}class ht{decode(f,p){try{return this.doDecode(f,p)}catch{if(p&&p.get(D.TRY_HARDER)===!0&&f.isRotateSupported()){const N=f.rotateCounterClockwise(),_=this.doDecode(N,p),E=_.getResultMetadata();let M=270;E!==null&&E.get(Te.ORIENTATION)===!0&&(M=M+E.get(Te.ORIENTATION)%360),_.putMetadata(Te.ORIENTATION,M);const F=_.getResultPoints();if(F!==null){const U=N.getHeight();for(let q=0;q<F.length;q++)F[q]=new ue(U-F[q].getY()-1,F[q].getX())}return _}else throw new z}}reset(){}doDecode(f,p){const g=f.getWidth(),v=f.getHeight();let N=new T(g);const _=p&&p.get(D.TRY_HARDER)===!0,E=Math.max(1,v>>(_?8:5));let M;_?M=v:M=15;const F=Math.trunc(v/2);for(let U=0;U<M;U++){const q=Math.trunc((U+1)/2),Q=(U&1)===0,se=F+E*(Q?q:-q);if(se<0||se>=v)break;try{N=f.getBlackRow(se,N)}catch{continue}for(let fe=0;fe<2;fe++){if(fe===1&&(N.reverse(),p&&p.get(D.NEED_RESULT_POINT_CALLBACK)===!0)){const me=new Map;p.forEach((Ne,ke)=>me.set(ke,Ne)),me.delete(D.NEED_RESULT_POINT_CALLBACK),p=me}try{const me=this.decodeRow(se,N,p);if(fe===1){me.putMetadata(Te.ORIENTATION,180);const Ne=me.getResultPoints();Ne!==null&&(Ne[0]=new ue(g-Ne[0].getX()-1,Ne[0].getY()),Ne[1]=new ue(g-Ne[1].getX()-1,Ne[1].getY()))}return me}catch{}}}throw new z}static recordPattern(f,p,g){const v=g.length;for(let F=0;F<v;F++)g[F]=0;const N=f.getSize();if(p>=N)throw new z;let _=!f.get(p),E=0,M=p;for(;M<N;){if(f.get(M)!==_)g[E]++;else{if(++E===v)break;g[E]=1,_=!_}M++}if(!(E===v||E===v-1&&M===N))throw new z}static recordPatternInReverse(f,p,g){let v=g.length,N=f.get(p);for(;p>0&&v>=0;)f.get(--p)!==N&&(v--,N=!N);if(v>=0)throw new z;ht.recordPattern(f,p+1,g)}static patternMatchVariance(f,p,g){const v=f.length;let N=0,_=0;for(let F=0;F<v;F++)N+=f[F],_+=p[F];if(N<_)return Number.POSITIVE_INFINITY;const E=N/_;g*=E;let M=0;for(let F=0;F<v;F++){const U=f[F],q=p[F]*E,Q=U>q?U-q:q-U;if(Q>g)return Number.POSITIVE_INFINITY;M+=Q}return M/N}}class $e extends ht{static findStartPattern(f){const p=f.getSize(),g=f.getNextSet(0);let v=0,N=Int32Array.from([0,0,0,0,0,0]),_=g,E=!1;const M=6;for(let F=g;F<p;F++)if(f.get(F)!==E)N[v]++;else{if(v===M-1){let U=$e.MAX_AVG_VARIANCE,q=-1;for(let Q=$e.CODE_START_A;Q<=$e.CODE_START_C;Q++){const se=ht.patternMatchVariance(N,$e.CODE_PATTERNS[Q],$e.MAX_INDIVIDUAL_VARIANCE);se<U&&(U=se,q=Q)}if(q>=0&&f.isRange(Math.max(0,_-(F-_)/2),_,!1))return Int32Array.from([_,F,q]);_+=N[0]+N[1],N=N.slice(2,N.length-1),N[v-1]=0,N[v]=0,v--}else v++;N[v]=1,E=!E}throw new z}static decodeCode(f,p,g){ht.recordPattern(f,g,p);let v=$e.MAX_AVG_VARIANCE,N=-1;for(let _=0;_<$e.CODE_PATTERNS.length;_++){const E=$e.CODE_PATTERNS[_],M=this.patternMatchVariance(p,E,$e.MAX_INDIVIDUAL_VARIANCE);M<v&&(v=M,N=_)}if(N>=0)return N;throw new z}decodeRow(f,p,g){const v=g&&g.get(D.ASSUME_GS1)===!0,N=$e.findStartPattern(p),_=N[2];let E=0;const M=new Uint8Array(20);M[E++]=_;let F;switch(_){case $e.CODE_START_A:F=$e.CODE_CODE_A;break;case $e.CODE_START_B:F=$e.CODE_CODE_B;break;case $e.CODE_START_C:F=$e.CODE_CODE_C;break;default:throw new O}let U=!1,q=!1,Q="",se=N[0],fe=N[1];const me=Int32Array.from([0,0,0,0,0,0]);let Ne=0,ke=0,We=_,Ke=0,Fe=!0,Jt=!1,$t=!1;for(;!U;){const qu=q;switch(q=!1,Ne=ke,ke=$e.decodeCode(p,me,fe),M[E++]=ke,ke!==$e.CODE_STOP&&(Fe=!0),ke!==$e.CODE_STOP&&(Ke++,We+=Ke*ke),se=fe,fe+=me.reduce((RK,LK)=>RK+LK,0),ke){case $e.CODE_START_A:case $e.CODE_START_B:case $e.CODE_START_C:throw new O}switch(F){case $e.CODE_CODE_A:if(ke<64)$t===Jt?Q+=String.fromCharCode(32+ke):Q+=String.fromCharCode(32+ke+128),$t=!1;else if(ke<96)$t===Jt?Q+=String.fromCharCode(ke-64):Q+=String.fromCharCode(ke+64),$t=!1;else switch(ke!==$e.CODE_STOP&&(Fe=!1),ke){case $e.CODE_FNC_1:v&&(Q.length===0?Q+="]C1":Q+="");break;case $e.CODE_FNC_2:case $e.CODE_FNC_3:break;case $e.CODE_FNC_4_A:!Jt&&$t?(Jt=!0,$t=!1):Jt&&$t?(Jt=!1,$t=!1):$t=!0;break;case $e.CODE_SHIFT:q=!0,F=$e.CODE_CODE_B;break;case $e.CODE_CODE_B:F=$e.CODE_CODE_B;break;case $e.CODE_CODE_C:F=$e.CODE_CODE_C;break;case $e.CODE_STOP:U=!0;break}break;case $e.CODE_CODE_B:if(ke<96)$t===Jt?Q+=String.fromCharCode(32+ke):Q+=String.fromCharCode(32+ke+128),$t=!1;else switch(ke!==$e.CODE_STOP&&(Fe=!1),ke){case $e.CODE_FNC_1:v&&(Q.length===0?Q+="]C1":Q+="");break;case $e.CODE_FNC_2:case $e.CODE_FNC_3:break;case $e.CODE_FNC_4_B:!Jt&&$t?(Jt=!0,$t=!1):Jt&&$t?(Jt=!1,$t=!1):$t=!0;break;case $e.CODE_SHIFT:q=!0,F=$e.CODE_CODE_A;break;case $e.CODE_CODE_A:F=$e.CODE_CODE_A;break;case $e.CODE_CODE_C:F=$e.CODE_CODE_C;break;case $e.CODE_STOP:U=!0;break}break;case $e.CODE_CODE_C:if(ke<100)ke<10&&(Q+="0"),Q+=ke;else switch(ke!==$e.CODE_STOP&&(Fe=!1),ke){case $e.CODE_FNC_1:v&&(Q.length===0?Q+="]C1":Q+="");break;case $e.CODE_CODE_A:F=$e.CODE_CODE_A;break;case $e.CODE_CODE_B:F=$e.CODE_CODE_B;break;case $e.CODE_STOP:U=!0;break}break}qu&&(F=F===$e.CODE_CODE_A?$e.CODE_CODE_B:$e.CODE_CODE_A)}const da=fe-se;if(fe=p.getNextUnset(fe),!p.isRange(fe,Math.min(p.getSize(),fe+(fe-se)/2),!1))throw new z;if(We-=Ke*Ne,We%103!==Ne)throw new b;const Ri=Q.length;if(Ri===0)throw new z;Ri>0&&Fe&&(F===$e.CODE_CODE_C?Q=Q.substring(0,Ri-2):Q=Q.substring(0,Ri-1));const ua=(N[1]+N[0])/2,Cn=se+da/2,gr=M.length,Ea=new Uint8Array(gr);for(let qu=0;qu<gr;qu++)Ea[qu]=M[qu];const Wu=[new ue(ua,f),new ue(Cn,f)];return new be(Q,Ea,0,Wu,Z.CODE_128,new Date().getTime())}}$e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],$e.MAX_AVG_VARIANCE=.25,$e.MAX_INDIVIDUAL_VARIANCE=.7,$e.CODE_SHIFT=98,$e.CODE_CODE_C=99,$e.CODE_CODE_B=100,$e.CODE_CODE_A=101,$e.CODE_FNC_1=102,$e.CODE_FNC_2=97,$e.CODE_FNC_3=96,$e.CODE_FNC_4_A=101,$e.CODE_FNC_4_B=100,$e.CODE_START_A=103,$e.CODE_START_B=104,$e.CODE_START_C=105,$e.CODE_STOP=106;class Xt extends ht{constructor(f=!1,p=!1){super(),this.usingCheckDigit=f,this.extendedMode=p,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(f,p,g){let v=this.counters;v.fill(0),this.decodeRowResult="";let N=Xt.findAsteriskPattern(p,v),_=p.getNextSet(N[1]),E=p.getSize(),M,F;do{Xt.recordPattern(p,_,v);let me=Xt.toNarrowWidePattern(v);if(me<0)throw new z;M=Xt.patternToChar(me),this.decodeRowResult+=M,F=_;for(let Ne of v)_+=Ne;_=p.getNextSet(_)}while(M!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let U=0;for(let me of v)U+=me;let q=_-F-U;if(_!==E&&q*2<U)throw new z;if(this.usingCheckDigit){let me=this.decodeRowResult.length-1,Ne=0;for(let ke=0;ke<me;ke++)Ne+=Xt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ke));if(this.decodeRowResult.charAt(me)!==Xt.ALPHABET_STRING.charAt(Ne%43))throw new b;this.decodeRowResult=this.decodeRowResult.substring(0,me)}if(this.decodeRowResult.length===0)throw new z;let Q;this.extendedMode?Q=Xt.decodeExtended(this.decodeRowResult):Q=this.decodeRowResult;let se=(N[1]+N[0])/2,fe=F+U/2;return new be(Q,null,0,[new ue(se,f),new ue(fe,f)],Z.CODE_39,new Date().getTime())}static findAsteriskPattern(f,p){let g=f.getSize(),v=f.getNextSet(0),N=0,_=v,E=!1,M=p.length;for(let F=v;F<g;F++)if(f.get(F)!==E)p[N]++;else{if(N===M-1){if(this.toNarrowWidePattern(p)===Xt.ASTERISK_ENCODING&&f.isRange(Math.max(0,_-Math.floor((F-_)/2)),_,!1))return[_,F];_+=p[0]+p[1],p.copyWithin(0,2,2+N-1),p[N-1]=0,p[N]=0,N--}else N++;p[N]=1,E=!E}throw new z}static toNarrowWidePattern(f){let p=f.length,g=0,v;do{let N=2147483647;for(let M of f)M<N&&M>g&&(N=M);g=N,v=0;let _=0,E=0;for(let M=0;M<p;M++){let F=f[M];F>g&&(E|=1<<p-1-M,v++,_+=F)}if(v===3){for(let M=0;M<p&&v>0;M++){let F=f[M];if(F>g&&(v--,F*2>=_))return-1}return E}}while(v>3);return-1}static patternToChar(f){for(let p=0;p<Xt.CHARACTER_ENCODINGS.length;p++)if(Xt.CHARACTER_ENCODINGS[p]===f)return Xt.ALPHABET_STRING.charAt(p);if(f===Xt.ASTERISK_ENCODING)return"*";throw new z}static decodeExtended(f){let p=f.length,g="";for(let v=0;v<p;v++){let N=f.charAt(v);if(N==="+"||N==="$"||N==="%"||N==="/"){let _=f.charAt(v+1),E="\0";switch(N){case"+":if(_>="A"&&_<="Z")E=String.fromCharCode(_.charCodeAt(0)+32);else throw new O;break;case"$":if(_>="A"&&_<="Z")E=String.fromCharCode(_.charCodeAt(0)-64);else throw new O;break;case"%":if(_>="A"&&_<="E")E=String.fromCharCode(_.charCodeAt(0)-38);else if(_>="F"&&_<="J")E=String.fromCharCode(_.charCodeAt(0)-11);else if(_>="K"&&_<="O")E=String.fromCharCode(_.charCodeAt(0)+16);else if(_>="P"&&_<="T")E=String.fromCharCode(_.charCodeAt(0)+43);else if(_==="U")E="\0";else if(_==="V")E="@";else if(_==="W")E="`";else if(_==="X"||_==="Y"||_==="Z")E="";else throw new O;break;case"/":if(_>="A"&&_<="O")E=String.fromCharCode(_.charCodeAt(0)-32);else if(_==="Z")E=":";else throw new O;break}g+=E,v++}else g+=N}return g}}Xt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Xt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Xt.ASTERISK_ENCODING=148;class Ut extends ht{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(f,p,g){let v=this.decodeStart(p),N=this.decodeEnd(p),_=new V;Ut.decodeMiddle(p,v[1],N[0],_);let E=_.toString(),M=null;g!=null&&(M=g.get(D.ALLOWED_LENGTHS)),M==null&&(M=Ut.DEFAULT_ALLOWED_LENGTHS);let F=E.length,U=!1,q=0;for(let fe of M){if(F===fe){U=!0;break}fe>q&&(q=fe)}if(!U&&F>q&&(U=!0),!U)throw new O;const Q=[new ue(v[1],f),new ue(N[0],f)];return new be(E,null,0,Q,Z.ITF,new Date().getTime())}static decodeMiddle(f,p,g,v){let N=new Int32Array(10),_=new Int32Array(5),E=new Int32Array(5);for(N.fill(0),_.fill(0),E.fill(0);p<g;){ht.recordPattern(f,p,N);for(let F=0;F<5;F++){let U=2*F;_[F]=N[U],E[F]=N[U+1]}let M=Ut.decodeDigit(_);v.append(M.toString()),M=this.decodeDigit(E),v.append(M.toString()),N.forEach(function(F){p+=F})}}decodeStart(f){let p=Ut.skipWhiteSpace(f),g=Ut.findGuardPattern(f,p,Ut.START_PATTERN);return this.narrowLineWidth=(g[1]-g[0])/4,this.validateQuietZone(f,g[0]),g}validateQuietZone(f,p){let g=this.narrowLineWidth*10;g=g<p?g:p;for(let v=p-1;g>0&&v>=0&&!f.get(v);v--)g--;if(g!==0)throw new z}static skipWhiteSpace(f){const p=f.getSize(),g=f.getNextSet(0);if(g===p)throw new z;return g}decodeEnd(f){f.reverse();try{let p=Ut.skipWhiteSpace(f),g;try{g=Ut.findGuardPattern(f,p,Ut.END_PATTERN_REVERSED[0])}catch(N){N instanceof z&&(g=Ut.findGuardPattern(f,p,Ut.END_PATTERN_REVERSED[1]))}this.validateQuietZone(f,g[0]);let v=g[0];return g[0]=f.getSize()-g[1],g[1]=f.getSize()-v,g}finally{f.reverse()}}static findGuardPattern(f,p,g){let v=g.length,N=new Int32Array(v),_=f.getSize(),E=!1,M=0,F=p;N.fill(0);for(let U=p;U<_;U++)if(f.get(U)!==E)N[M]++;else{if(M===v-1){if(ht.patternMatchVariance(N,g,Ut.MAX_INDIVIDUAL_VARIANCE)<Ut.MAX_AVG_VARIANCE)return[F,U];F+=N[0]+N[1],j.arraycopy(N,2,N,0,M-1),N[M-1]=0,N[M]=0,M--}else M++;N[M]=1,E=!E}throw new z}static decodeDigit(f){let p=Ut.MAX_AVG_VARIANCE,g=-1,v=Ut.PATTERNS.length;for(let N=0;N<v;N++){let _=Ut.PATTERNS[N],E=ht.patternMatchVariance(f,_,Ut.MAX_INDIVIDUAL_VARIANCE);E<p?(p=E,g=N):E===p&&(g=-1)}if(g>=0)return g%10;throw new z}}Ut.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ut.MAX_AVG_VARIANCE=.38,Ut.MAX_INDIVIDUAL_VARIANCE=.5,Ut.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ut.START_PATTERN=Int32Array.from([1,1,1,1]),Ut.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class en extends ht{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(f){let p=!1,g,v=0,N=Int32Array.from([0,0,0]);for(;!p;){N=Int32Array.from([0,0,0]),g=en.findGuardPattern(f,v,!1,this.START_END_PATTERN,N);let _=g[0];v=g[1];let E=_-(v-_);E>=0&&(p=f.isRange(E,_,!1))}return g}static checkChecksum(f){return en.checkStandardUPCEANChecksum(f)}static checkStandardUPCEANChecksum(f){let p=f.length;if(p===0)return!1;let g=parseInt(f.charAt(p-1),10);return en.getStandardUPCEANChecksum(f.substring(0,p-1))===g}static getStandardUPCEANChecksum(f){let p=f.length,g=0;for(let v=p-1;v>=0;v-=2){let N=f.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new O;g+=N}g*=3;for(let v=p-2;v>=0;v-=2){let N=f.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new O;g+=N}return(1e3-g)%10}static decodeEnd(f,p){return en.findGuardPattern(f,p,!1,en.START_END_PATTERN,new Int32Array(en.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(f,p,g,v){return this.findGuardPattern(f,p,g,v,new Int32Array(v.length))}static findGuardPattern(f,p,g,v,N){let _=f.getSize();p=g?f.getNextUnset(p):f.getNextSet(p);let E=0,M=p,F=v.length,U=g;for(let q=p;q<_;q++)if(f.get(q)!==U)N[E]++;else{if(E===F-1){if(ht.patternMatchVariance(N,v,en.MAX_INDIVIDUAL_VARIANCE)<en.MAX_AVG_VARIANCE)return Int32Array.from([M,q]);M+=N[0]+N[1];let Q=N.slice(2,N.length-1);for(let se=0;se<E-1;se++)N[se]=Q[se];N[E-1]=0,N[E]=0,E--}else E++;N[E]=1,U=!U}throw new z}static decodeDigit(f,p,g,v){this.recordPattern(f,g,p);let N=this.MAX_AVG_VARIANCE,_=-1,E=v.length;for(let M=0;M<E;M++){let F=v[M],U=ht.patternMatchVariance(p,F,en.MAX_INDIVIDUAL_VARIANCE);U<N&&(N=U,_=M)}if(_>=0)return _;throw new z}}en.MAX_AVG_VARIANCE=.48,en.MAX_INDIVIDUAL_VARIANCE=.7,en.START_END_PATTERN=Int32Array.from([1,1,1]),en.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),en.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),en.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Tn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(f,p,g){let v=this.decodeRowStringBuffer,N=this.decodeMiddle(p,g,v),_=v.toString(),E=Tn.parseExtensionString(_),M=[new ue((g[0]+g[1])/2,f),new ue(N,f)],F=new be(_,null,0,M,Z.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&F.putAllMetadata(E),F}decodeMiddle(f,p,g){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=f.getSize(),_=p[1],E=0;for(let F=0;F<5&&_<N;F++){let U=en.decodeDigit(f,v,_,en.L_AND_G_PATTERNS);g+=String.fromCharCode(48+U%10);for(let q of v)_+=q;U>=10&&(E|=1<<4-F),F!==4&&(_=f.getNextSet(_),_=f.getNextUnset(_))}if(g.length!==5)throw new z;let M=this.determineCheckDigit(E);if(Tn.extensionChecksum(g.toString())!==M)throw new z;return _}static extensionChecksum(f){let p=f.length,g=0;for(let v=p-2;v>=0;v-=2)g+=f.charAt(v).charCodeAt(0)-48;g*=3;for(let v=p-1;v>=0;v-=2)g+=f.charAt(v).charCodeAt(0)-48;return g*=3,g%10}determineCheckDigit(f){for(let p=0;p<10;p++)if(f===this.CHECK_DIGIT_ENCODINGS[p])return p;throw new z}static parseExtensionString(f){if(f.length!==5)return null;let p=Tn.parseExtension5String(f);return p==null?null:new Map([[Te.SUGGESTED_PRICE,p]])}static parseExtension5String(f){let p;switch(f.charAt(0)){case"0":p="";break;case"5":p="$";break;case"9":switch(f){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}p="";break;default:p="";break}let g=parseInt(f.substring(1)),v=(g/100).toString(),N=g%100,_=N<10?"0"+N:N.toString();return p+v+"."+_}}class Rs{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(f,p,g){let v=this.decodeRowStringBuffer,N=this.decodeMiddle(p,g,v),_=v.toString(),E=Rs.parseExtensionString(_),M=[new ue((g[0]+g[1])/2,f),new ue(N,f)],F=new be(_,null,0,M,Z.UPC_EAN_EXTENSION,new Date().getTime());return E!=null&&F.putAllMetadata(E),F}decodeMiddle(f,p,g){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=f.getSize(),_=p[1],E=0;for(let M=0;M<2&&_<N;M++){let F=en.decodeDigit(f,v,_,en.L_AND_G_PATTERNS);g+=String.fromCharCode(48+F%10);for(let U of v)_+=U;F>=10&&(E|=1<<1-M),M!==1&&(_=f.getNextSet(_),_=f.getNextUnset(_))}if(g.length!==2)throw new z;if(parseInt(g.toString())%4!==E)throw new z;return _}static parseExtensionString(f){return f.length!==2?null:new Map([[Te.ISSUE_NUMBER,parseInt(f)]])}}class Xl{static decodeRow(f,p,g){let v=en.findGuardPattern(p,g,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Tn().decodeRow(f,p,v)}catch{return new Rs().decodeRow(f,p,v)}}}Xl.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Bt extends en{constructor(){super(),this.decodeRowStringBuffer="",Bt.L_AND_G_PATTERNS=Bt.L_PATTERNS.map(f=>Int32Array.from(f));for(let f=10;f<20;f++){let p=Bt.L_PATTERNS[f-10],g=new Int32Array(p.length);for(let v=0;v<p.length;v++)g[v]=p[p.length-v-1];Bt.L_AND_G_PATTERNS[f]=g}}decodeRow(f,p,g){let v=Bt.findStartGuardPattern(p),N=g==null?null:g.get(D.NEED_RESULT_POINT_CALLBACK);if(N!=null){const Fe=new ue((v[0]+v[1])/2,f);N.foundPossibleResultPoint(Fe)}let _=this.decodeMiddle(p,v,this.decodeRowStringBuffer),E=_.rowOffset,M=_.resultString;if(N!=null){const Fe=new ue(E,f);N.foundPossibleResultPoint(Fe)}let F=this.decodeEnd(p,E);if(N!=null){const Fe=new ue((F[0]+F[1])/2,f);N.foundPossibleResultPoint(Fe)}let U=F[1],q=U+(U-F[0]);if(q>=p.getSize()||!p.isRange(U,q,!1))throw new z;let Q=M.toString();if(Q.length<8)throw new O;if(!Bt.checkChecksum(Q))throw new b;let se=(v[1]+v[0])/2,fe=(F[1]+F[0])/2,me=this.getBarcodeFormat(),Ne=[new ue(se,f),new ue(fe,f)],ke=new be(Q,null,0,Ne,me,new Date().getTime()),We=0;try{let Fe=Xl.decodeRow(f,p,F[1]);ke.putMetadata(Te.UPC_EAN_EXTENSION,Fe.getText()),ke.putAllMetadata(Fe.getResultMetadata()),ke.addResultPoints(Fe.getResultPoints()),We=Fe.getText().length}catch{}let Ke=g==null?null:g.get(D.ALLOWED_EAN_EXTENSIONS);if(Ke!=null){let Fe=!1;for(let Jt in Ke)if(We.toString()===Jt){Fe=!0;break}if(!Fe)throw new z}return ke}decodeEnd(f,p){return Bt.findGuardPattern(f,p,!1,Bt.START_END_PATTERN,new Int32Array(Bt.START_END_PATTERN.length).fill(0))}static checkChecksum(f){return Bt.checkStandardUPCEANChecksum(f)}static checkStandardUPCEANChecksum(f){let p=f.length;if(p===0)return!1;let g=parseInt(f.charAt(p-1),10);return Bt.getStandardUPCEANChecksum(f.substring(0,p-1))===g}static getStandardUPCEANChecksum(f){let p=f.length,g=0;for(let v=p-1;v>=0;v-=2){let N=f.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new O;g+=N}g*=3;for(let v=p-2;v>=0;v-=2){let N=f.charAt(v).charCodeAt(0)-48;if(N<0||N>9)throw new O;g+=N}return(1e3-g)%10}}class Wt extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(f,p,g){let v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=f.getSize(),_=p[1],E=0;for(let F=0;F<6&&_<N;F++){let U=Bt.decodeDigit(f,v,_,Bt.L_AND_G_PATTERNS);g+=String.fromCharCode(48+U%10);for(let q of v)_+=q;U>=10&&(E|=1<<5-F)}g=Wt.determineFirstDigit(g,E),_=Bt.findGuardPattern(f,_,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let F=0;F<6&&_<N;F++){let U=Bt.decodeDigit(f,v,_,Bt.L_PATTERNS);g+=String.fromCharCode(48+U);for(let q of v)_+=q}return{rowOffset:_,resultString:g}}getBarcodeFormat(){return Z.EAN_13}static determineFirstDigit(f,p){for(let g=0;g<10;g++)if(p===this.FIRST_DIGIT_ENCODINGS[g])return f=String.fromCharCode(48+g)+f,f;throw new z}}Wt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class si extends Bt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(f,p,g){const v=this.decodeMiddleCounters;v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=f.getSize(),_=p[1];for(let M=0;M<4&&_<N;M++){let F=Bt.decodeDigit(f,v,_,Bt.L_PATTERNS);g+=String.fromCharCode(48+F);for(let U of v)_+=U}_=Bt.findGuardPattern(f,_,!0,Bt.MIDDLE_PATTERN,new Int32Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let M=0;M<4&&_<N;M++){let F=Bt.decodeDigit(f,v,_,Bt.L_PATTERNS);g+=String.fromCharCode(48+F);for(let U of v)_+=U}return{rowOffset:_,resultString:g}}getBarcodeFormat(){return Z.EAN_8}}class Tt extends Bt{constructor(){super(...arguments),this.ean13Reader=new Wt}getBarcodeFormat(){return Z.UPC_A}decode(f,p){return this.maybeReturnResult(this.ean13Reader.decode(f))}decodeRow(f,p,g){return this.maybeReturnResult(this.ean13Reader.decodeRow(f,p,g))}decodeMiddle(f,p,g){return this.ean13Reader.decodeMiddle(f,p,g)}maybeReturnResult(f){let p=f.getText();if(p.charAt(0)==="0"){let g=new be(p.substring(1),null,null,f.getResultPoints(),Z.UPC_A);return f.getResultMetadata()!=null&&g.putAllMetadata(f.getResultMetadata()),g}else throw new z}reset(){this.ean13Reader.reset()}}class pe extends Bt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(f,p,g){const v=this.decodeMiddleCounters.map(F=>F);v[0]=0,v[1]=0,v[2]=0,v[3]=0;const N=f.getSize();let _=p[1],E=0;for(let F=0;F<6&&_<N;F++){const U=pe.decodeDigit(f,v,_,pe.L_AND_G_PATTERNS);g+=String.fromCharCode(48+U%10);for(let q of v)_+=q;U>=10&&(E|=1<<5-F)}let M=pe.determineNumSysAndCheckDigit(g,E);return{rowOffset:_,resultString:M}}decodeEnd(f,p){return pe.findGuardPatternWithoutCounters(f,p,!0,pe.MIDDLE_END_PATTERN)}checkChecksum(f){return Bt.checkChecksum(pe.convertUPCEtoUPCA(f))}static determineNumSysAndCheckDigit(f,p){for(let g=0;g<=1;g++)for(let v=0;v<10;v++)if(p===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[g][v]){let N=String.fromCharCode(48+g),_=String.fromCharCode(48+v);return N+f+_}throw z.getNotFoundInstance()}getBarcodeFormat(){return Z.UPC_E}static convertUPCEtoUPCA(f){const p=f.slice(1,7).split("").map(N=>N.charCodeAt(0)),g=new V;g.append(f.charAt(0));let v=p[5];switch(v){case 0:case 1:case 2:g.appendChars(p,0,2),g.append(v),g.append("0000"),g.appendChars(p,2,3);break;case 3:g.appendChars(p,0,3),g.append("00000"),g.appendChars(p,3,2);break;case 4:g.appendChars(p,0,4),g.append("00000"),g.append(p[4]);break;default:g.appendChars(p,0,5),g.append("0000"),g.append(v);break}return f.length>=8&&g.append(f.charAt(7)),g.toString()}}pe.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),pe.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class at extends ht{constructor(f){super();let p=f==null?null:f.get(D.POSSIBLE_FORMATS),g=[];r(p)?(g.push(new Wt),g.push(new Tt),g.push(new si),g.push(new pe)):(p.indexOf(Z.EAN_13)>-1&&g.push(new Wt),p.indexOf(Z.UPC_A)>-1&&g.push(new Tt),p.indexOf(Z.EAN_8)>-1&&g.push(new si),p.indexOf(Z.UPC_E)>-1&&g.push(new pe)),this.readers=g}decodeRow(f,p,g){for(let v of this.readers)try{const N=v.decodeRow(f,p,g),_=N.getBarcodeFormat()===Z.EAN_13&&N.getText().charAt(0)==="0",E=g==null?null:g.get(D.POSSIBLE_FORMATS),M=E==null||E.includes(Z.UPC_A);if(_&&M){const F=N.getRawBytes(),U=new be(N.getText().substring(1),F,F?F.length:null,N.getResultPoints(),Z.UPC_A);return U.putAllMetadata(N.getResultMetadata()),U}return N}catch{}throw new z}reset(){for(let f of this.readers)f.reset()}}class lt extends ht{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(f,p){for(let g=0;g<p.length;g++)if(ht.patternMatchVariance(f,p[g],lt.MAX_INDIVIDUAL_VARIANCE)<lt.MAX_AVG_VARIANCE)return g;throw new z}static count(f){return qe.sum(new Int32Array(f))}static increment(f,p){let g=0,v=p[0];for(let N=1;N<f.length;N++)p[N]>v&&(v=p[N],g=N);f[g]++}static decrement(f,p){let g=0,v=p[0];for(let N=1;N<f.length;N++)p[N]<v&&(v=p[N],g=N);f[g]--}static isFinderPattern(f){let p=f[0]+f[1],g=p+f[2]+f[3],v=p/g;if(v>=lt.MIN_FINDER_PATTERN_RATIO&&v<=lt.MAX_FINDER_PATTERN_RATIO){let N=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER;for(let E of f)E>_&&(_=E),E<N&&(N=E);return _<10*N}return!1}}lt.MAX_AVG_VARIANCE=.2,lt.MAX_INDIVIDUAL_VARIANCE=.45,lt.MIN_FINDER_PATTERN_RATIO=9.5/12,lt.MAX_FINDER_PATTERN_RATIO=12.5/14;class qt{constructor(f,p){this.value=f,this.checksumPortion=p}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(f){if(!(f instanceof qt))return!1;const p=f;return this.value===p.value&&this.checksumPortion===p.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Rt{constructor(f,p,g,v,N){this.value=f,this.startEnd=p,this.value=f,this.startEnd=p,this.resultPoints=new Array,this.resultPoints.push(new ue(g,N)),this.resultPoints.push(new ue(v,N))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(f){if(!(f instanceof Rt))return!1;const p=f;return this.value===p.value}hashCode(){return this.value}}class Ft{constructor(){}static getRSSvalue(f,p,g){let v=0;for(let M of f)v+=M;let N=0,_=0,E=f.length;for(let M=0;M<E-1;M++){let F;for(F=1,_|=1<<M;F<f[M];F++,_&=~(1<<M)){let U=Ft.combins(v-F-1,E-M-2);if(g&&_===0&&v-F-(E-M-1)>=E-M-1&&(U-=Ft.combins(v-F-(E-M),E-M-2)),E-M-1>1){let q=0;for(let Q=v-F-(E-M-2);Q>p;Q--)q+=Ft.combins(v-F-Q-1,E-M-3);U-=q*(E-1-M)}else v-F>p&&U--;N+=U}v-=F}return N}static combins(f,p){let g,v;f-p>p?(v=p,g=f-p):(v=f-p,g=p);let N=1,_=1;for(let E=f;E>g;E--)N*=E,_<=v&&(N/=_,_++);for(;_<=v;)N/=_,_++;return N}}class Qn{static buildBitArray(f){let p=f.length*2-1;f[f.length-1].getRightChar()==null&&(p-=1);let g=12*p,v=new T(g),N=0,E=f[0].getRightChar().getValue();for(let M=11;M>=0;--M)E&1<<M&&v.set(N),N++;for(let M=1;M<f.length;++M){let F=f[M],U=F.getLeftChar().getValue();for(let q=11;q>=0;--q)U&1<<q&&v.set(N),N++;if(F.getRightChar()!=null){let q=F.getRightChar().getValue();for(let Q=11;Q>=0;--Q)q&1<<Q&&v.set(N),N++}}return v}}class bn{constructor(f,p){p?this.decodedInformation=null:(this.finished=f,this.decodedInformation=p)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Ls{constructor(f){this.newPosition=f}getNewPosition(){return this.newPosition}}class ls extends Ls{constructor(f,p){super(f),this.value=p}getValue(){return this.value}isFNC1(){return this.value===ls.FNC1}}ls.FNC1="$";class Bs extends Ls{constructor(f,p,g){super(f),g?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=p}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class nr extends Ls{constructor(f,p,g){if(super(f),p<0||p>10||g<0||g>10)throw new O;this.firstDigit=p,this.secondDigit=g}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===nr.FNC1}isSecondDigitFNC1(){return this.secondDigit===nr.FNC1}isAnyFNC1(){return this.firstDigit===nr.FNC1||this.secondDigit===nr.FNC1}}nr.FNC1=10;class rt{constructor(){}static parseFieldsInGeneralPurpose(f){if(!f)return null;if(f.length<2)throw new z;let p=f.substring(0,2);for(let N of rt.TWO_DIGIT_DATA_LENGTH)if(N[0]===p)return N[1]===rt.VARIABLE_LENGTH?rt.processVariableAI(2,N[2],f):rt.processFixedAI(2,N[1],f);if(f.length<3)throw new z;let g=f.substring(0,3);for(let N of rt.THREE_DIGIT_DATA_LENGTH)if(N[0]===g)return N[1]===rt.VARIABLE_LENGTH?rt.processVariableAI(3,N[2],f):rt.processFixedAI(3,N[1],f);for(let N of rt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(N[0]===g)return N[1]===rt.VARIABLE_LENGTH?rt.processVariableAI(4,N[2],f):rt.processFixedAI(4,N[1],f);if(f.length<4)throw new z;let v=f.substring(0,4);for(let N of rt.FOUR_DIGIT_DATA_LENGTH)if(N[0]===v)return N[1]===rt.VARIABLE_LENGTH?rt.processVariableAI(4,N[2],f):rt.processFixedAI(4,N[1],f);throw new z}static processFixedAI(f,p,g){if(g.length<f)throw new z;let v=g.substring(0,f);if(g.length<f+p)throw new z;let N=g.substring(f,f+p),_=g.substring(f+p),E="("+v+")"+N,M=rt.parseFieldsInGeneralPurpose(_);return M==null?E:E+M}static processVariableAI(f,p,g){let v=g.substring(0,f),N;g.length<f+p?N=g.length:N=f+p;let _=g.substring(f,N),E=g.substring(N),M="("+v+")"+_,F=rt.parseFieldsInGeneralPurpose(E);return F==null?M:M+F}}rt.VARIABLE_LENGTH=[],rt.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",rt.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",rt.VARIABLE_LENGTH,20],["22",rt.VARIABLE_LENGTH,29],["30",rt.VARIABLE_LENGTH,8],["37",rt.VARIABLE_LENGTH,8],["90",rt.VARIABLE_LENGTH,30],["91",rt.VARIABLE_LENGTH,30],["92",rt.VARIABLE_LENGTH,30],["93",rt.VARIABLE_LENGTH,30],["94",rt.VARIABLE_LENGTH,30],["95",rt.VARIABLE_LENGTH,30],["96",rt.VARIABLE_LENGTH,30],["97",rt.VARIABLE_LENGTH,3],["98",rt.VARIABLE_LENGTH,30],["99",rt.VARIABLE_LENGTH,30]],rt.THREE_DIGIT_DATA_LENGTH=[["240",rt.VARIABLE_LENGTH,30],["241",rt.VARIABLE_LENGTH,30],["242",rt.VARIABLE_LENGTH,6],["250",rt.VARIABLE_LENGTH,30],["251",rt.VARIABLE_LENGTH,30],["253",rt.VARIABLE_LENGTH,17],["254",rt.VARIABLE_LENGTH,20],["400",rt.VARIABLE_LENGTH,30],["401",rt.VARIABLE_LENGTH,30],["402",17],["403",rt.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",rt.VARIABLE_LENGTH,20],["421",rt.VARIABLE_LENGTH,15],["422",3],["423",rt.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],rt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",rt.VARIABLE_LENGTH,15],["391",rt.VARIABLE_LENGTH,18],["392",rt.VARIABLE_LENGTH,15],["393",rt.VARIABLE_LENGTH,18],["703",rt.VARIABLE_LENGTH,30]],rt.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",rt.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",rt.VARIABLE_LENGTH,20],["8003",rt.VARIABLE_LENGTH,30],["8004",rt.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",rt.VARIABLE_LENGTH,30],["8008",rt.VARIABLE_LENGTH,12],["8018",18],["8020",rt.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",rt.VARIABLE_LENGTH,70],["8200",rt.VARIABLE_LENGTH,70]];class Oi{constructor(f){this.buffer=new V,this.information=f}decodeAllCodes(f,p){let g=p,v=null;do{let N=this.decodeGeneralPurposeField(g,v),_=rt.parseFieldsInGeneralPurpose(N.getNewString());if(_!=null&&f.append(_),N.isRemaining()?v=""+N.getRemainingValue():v=null,g===N.getNewPosition())break;g=N.getNewPosition()}while(!0);return f.toString()}isStillNumeric(f){if(f+7>this.information.getSize())return f+4<=this.information.getSize();for(let p=f;p<f+3;++p)if(this.information.get(p))return!0;return this.information.get(f+3)}decodeNumeric(f){if(f+7>this.information.getSize()){let N=this.extractNumericValueFromBitArray(f,4);return N===0?new nr(this.information.getSize(),nr.FNC1,nr.FNC1):new nr(this.information.getSize(),N-1,nr.FNC1)}let p=this.extractNumericValueFromBitArray(f,7),g=(p-8)/11,v=(p-8)%11;return new nr(f+7,g,v)}extractNumericValueFromBitArray(f,p){return Oi.extractNumericValueFromBitArray(this.information,f,p)}static extractNumericValueFromBitArray(f,p,g){let v=0;for(let N=0;N<g;++N)f.get(p+N)&&(v|=1<<g-N-1);return v}decodeGeneralPurposeField(f,p){this.buffer.setLengthToZero(),p!=null&&this.buffer.append(p),this.current.setPosition(f);let g=this.parseBlocks();return g!=null&&g.isRemaining()?new Bs(this.current.getPosition(),this.buffer.toString(),g.getRemainingValue()):new Bs(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let f,p;do{let g=this.current.getPosition();if(this.current.isAlpha()?(p=this.parseAlphaBlock(),f=p.isFinished()):this.current.isIsoIec646()?(p=this.parseIsoIec646Block(),f=p.isFinished()):(p=this.parseNumericBlock(),f=p.isFinished()),!(g!==this.current.getPosition())&&!f)break}while(!f);return p.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let f=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(f.getNewPosition()),f.isFirstDigitFNC1()){let p;return f.isSecondDigitFNC1()?p=new Bs(this.current.getPosition(),this.buffer.toString()):p=new Bs(this.current.getPosition(),this.buffer.toString(),f.getSecondDigit()),new bn(!0,p)}if(this.buffer.append(f.getFirstDigit()),f.isSecondDigitFNC1()){let p=new Bs(this.current.getPosition(),this.buffer.toString());return new bn(!0,p)}this.buffer.append(f.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new bn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let f=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(f.getNewPosition()),f.isFNC1()){let p=new Bs(this.current.getPosition(),this.buffer.toString());return new bn(!0,p)}this.buffer.append(f.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new bn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let f=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(f.getNewPosition()),f.isFNC1()){let p=new Bs(this.current.getPosition(),this.buffer.toString());return new bn(!0,p)}this.buffer.append(f.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new bn(!1)}isStillIsoIec646(f){if(f+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(f,5);if(p>=5&&p<16)return!0;if(f+7>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(f,7);if(g>=64&&g<116)return!0;if(f+8>this.information.getSize())return!1;let v=this.extractNumericValueFromBitArray(f,8);return v>=232&&v<253}decodeIsoIec646(f){let p=this.extractNumericValueFromBitArray(f,5);if(p===15)return new ls(f+5,ls.FNC1);if(p>=5&&p<15)return new ls(f+5,"0"+(p-5));let g=this.extractNumericValueFromBitArray(f,7);if(g>=64&&g<90)return new ls(f+7,""+(g+1));if(g>=90&&g<116)return new ls(f+7,""+(g+7));let v=this.extractNumericValueFromBitArray(f,8),N;switch(v){case 232:N="!";break;case 233:N='"';break;case 234:N="%";break;case 235:N="&";break;case 236:N="'";break;case 237:N="(";break;case 238:N=")";break;case 239:N="*";break;case 240:N="+";break;case 241:N=",";break;case 242:N="-";break;case 243:N=".";break;case 244:N="/";break;case 245:N=":";break;case 246:N=";";break;case 247:N="<";break;case 248:N="=";break;case 249:N=">";break;case 250:N="?";break;case 251:N="_";break;case 252:N=" ";break;default:throw new O}return new ls(f+8,N)}isStillAlpha(f){if(f+5>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(f,5);if(p>=5&&p<16)return!0;if(f+6>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(f,6);return g>=16&&g<63}decodeAlphanumeric(f){let p=this.extractNumericValueFromBitArray(f,5);if(p===15)return new ls(f+5,ls.FNC1);if(p>=5&&p<15)return new ls(f+5,"0"+(p-5));let g=this.extractNumericValueFromBitArray(f,6);if(g>=32&&g<58)return new ls(f+6,""+(g+33));let v;switch(g){case 58:v="*";break;case 59:v=",";break;case 60:v="-";break;case 61:v=".";break;case 62:v="/";break;default:throw new wt("Decoding invalid alphanumeric value: "+g)}return new ls(f+6,v)}isAlphaTo646ToAlphaLatch(f){if(f+1>this.information.getSize())return!1;for(let p=0;p<5&&p+f<this.information.getSize();++p)if(p===2){if(!this.information.get(f+2))return!1}else if(this.information.get(f+p))return!1;return!0}isAlphaOr646ToNumericLatch(f){if(f+3>this.information.getSize())return!1;for(let p=f;p<f+3;++p)if(this.information.get(p))return!1;return!0}isNumericToAlphaNumericLatch(f){if(f+1>this.information.getSize())return!1;for(let p=0;p<4&&p+f<this.information.getSize();++p)if(this.information.get(f+p))return!1;return!0}}class dl{constructor(f){this.information=f,this.generalDecoder=new Oi(f)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Ir extends dl{constructor(f){super(f)}encodeCompressedGtin(f,p){f.append("(01)");let g=f.length();f.append("9"),this.encodeCompressedGtinWithoutAI(f,p,g)}encodeCompressedGtinWithoutAI(f,p,g){for(let v=0;v<4;++v){let N=this.getGeneralDecoder().extractNumericValueFromBitArray(p+10*v,10);N/100===0&&f.append("0"),N/10===0&&f.append("0"),f.append(N)}Ir.appendCheckDigit(f,g)}static appendCheckDigit(f,p){let g=0;for(let v=0;v<13;v++){let N=f.charAt(v+p).charCodeAt(0)-48;g+=v&1?N:3*N}g=10-g%10,g===10&&(g=0),f.append(g)}}Ir.GTIN_SIZE=40;class Ho extends Ir{constructor(f){super(f)}parseInformation(){let f=new V;f.append("(01)");let p=f.length(),g=this.getGeneralDecoder().extractNumericValueFromBitArray(Ho.HEADER_SIZE,4);return f.append(g),this.encodeCompressedGtinWithoutAI(f,Ho.HEADER_SIZE+4,p),this.getGeneralDecoder().decodeAllCodes(f,Ho.HEADER_SIZE+44)}}Ho.HEADER_SIZE=4;class zu extends dl{constructor(f){super(f)}parseInformation(){let f=new V;return this.getGeneralDecoder().decodeAllCodes(f,zu.HEADER_SIZE)}}zu.HEADER_SIZE=5;class Uu extends Ir{constructor(f){super(f)}encodeCompressedWeight(f,p,g){let v=this.getGeneralDecoder().extractNumericValueFromBitArray(p,g);this.addWeightCode(f,v);let N=this.checkWeight(v),_=1e5;for(let E=0;E<5;++E)N/_===0&&f.append("0"),_/=10;f.append(N)}}class ri extends Uu{constructor(f){super(f)}parseInformation(){if(this.getInformation().getSize()!=ri.HEADER_SIZE+Uu.GTIN_SIZE+ri.WEIGHT_SIZE)throw new z;let f=new V;return this.encodeCompressedGtin(f,ri.HEADER_SIZE),this.encodeCompressedWeight(f,ri.HEADER_SIZE+Uu.GTIN_SIZE,ri.WEIGHT_SIZE),f.toString()}}ri.HEADER_SIZE=5,ri.WEIGHT_SIZE=15;class mw extends ri{constructor(f){super(f)}addWeightCode(f,p){f.append("(3103)")}checkWeight(f){return f}}class pw extends ri{constructor(f){super(f)}addWeightCode(f,p){p<1e4?f.append("(3202)"):f.append("(3203)")}checkWeight(f){return f<1e4?f:f-1e4}}class ai extends Ir{constructor(f){super(f)}parseInformation(){if(this.getInformation().getSize()<ai.HEADER_SIZE+Ir.GTIN_SIZE)throw new z;let f=new V;this.encodeCompressedGtin(f,ai.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(ai.HEADER_SIZE+Ir.GTIN_SIZE,ai.LAST_DIGIT_SIZE);f.append("(392"),f.append(p),f.append(")");let g=this.getGeneralDecoder().decodeGeneralPurposeField(ai.HEADER_SIZE+Ir.GTIN_SIZE+ai.LAST_DIGIT_SIZE,null);return f.append(g.getNewString()),f.toString()}}ai.HEADER_SIZE=8,ai.LAST_DIGIT_SIZE=2;class mr extends Ir{constructor(f){super(f)}parseInformation(){if(this.getInformation().getSize()<mr.HEADER_SIZE+Ir.GTIN_SIZE)throw new z;let f=new V;this.encodeCompressedGtin(f,mr.HEADER_SIZE);let p=this.getGeneralDecoder().extractNumericValueFromBitArray(mr.HEADER_SIZE+Ir.GTIN_SIZE,mr.LAST_DIGIT_SIZE);f.append("(393"),f.append(p),f.append(")");let g=this.getGeneralDecoder().extractNumericValueFromBitArray(mr.HEADER_SIZE+Ir.GTIN_SIZE+mr.LAST_DIGIT_SIZE,mr.FIRST_THREE_DIGITS_SIZE);g/100==0&&f.append("0"),g/10==0&&f.append("0"),f.append(g);let v=this.getGeneralDecoder().decodeGeneralPurposeField(mr.HEADER_SIZE+Ir.GTIN_SIZE+mr.LAST_DIGIT_SIZE+mr.FIRST_THREE_DIGITS_SIZE,null);return f.append(v.getNewString()),f.toString()}}mr.HEADER_SIZE=8,mr.LAST_DIGIT_SIZE=2,mr.FIRST_THREE_DIGITS_SIZE=10;class In extends Uu{constructor(f,p,g){super(f),this.dateCode=g,this.firstAIdigits=p}parseInformation(){if(this.getInformation().getSize()!=In.HEADER_SIZE+In.GTIN_SIZE+In.WEIGHT_SIZE+In.DATE_SIZE)throw new z;let f=new V;return this.encodeCompressedGtin(f,In.HEADER_SIZE),this.encodeCompressedWeight(f,In.HEADER_SIZE+In.GTIN_SIZE,In.WEIGHT_SIZE),this.encodeCompressedDate(f,In.HEADER_SIZE+In.GTIN_SIZE+In.WEIGHT_SIZE),f.toString()}encodeCompressedDate(f,p){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(p,In.DATE_SIZE);if(g==38400)return;f.append("("),f.append(this.dateCode),f.append(")");let v=g%32;g/=32;let N=g%12+1;g/=12;let _=g;_/10==0&&f.append("0"),f.append(_),N/10==0&&f.append("0"),f.append(N),v/10==0&&f.append("0"),f.append(v)}addWeightCode(f,p){f.append("("),f.append(this.firstAIdigits),f.append(p/1e5),f.append(")")}checkWeight(f){return f%1e5}}In.HEADER_SIZE=8,In.WEIGHT_SIZE=20,In.DATE_SIZE=16;function dd(W){try{if(W.get(1))return new Ho(W);if(!W.get(2))return new zu(W);switch(Oi.extractNumericValueFromBitArray(W,1,4)){case 4:return new mw(W);case 5:return new pw(W)}switch(Oi.extractNumericValueFromBitArray(W,1,5)){case 12:return new ai(W);case 13:return new mr(W)}switch(Oi.extractNumericValueFromBitArray(W,1,7)){case 56:return new In(W,"310","11");case 57:return new In(W,"320","11");case 58:return new In(W,"310","13");case 59:return new In(W,"320","13");case 60:return new In(W,"310","15");case 61:return new In(W,"320","15");case 62:return new In(W,"310","17");case 63:return new In(W,"320","17")}}catch(f){throw console.log(f),new wt("unknown decoder: "+W)}}class ul{constructor(f,p,g,v){this.leftchar=f,this.rightchar=p,this.finderpattern=g,this.maybeLast=v}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(f,p){return f instanceof ul?ul.equalsOrNull(f.leftchar,p.leftchar)&&ul.equalsOrNull(f.rightchar,p.rightchar)&&ul.equalsOrNull(f.finderpattern,p.finderpattern):!1}static equalsOrNull(f,p){return f===null?p===null:ul.equals(f,p)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Hh{constructor(f,p,g){this.pairs=f,this.rowNumber=p,this.wasReversed=g}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(f){return this.checkEqualitity(this,f)}toString(){return"{ "+this.pairs+" }"}equals(f,p){return f instanceof Hh?this.checkEqualitity(f,p)&&f.wasReversed===p.wasReversed:!1}checkEqualitity(f,p){if(!f||!p)return;let g;return f.forEach((v,N)=>{p.forEach(_=>{v.getLeftChar().getValue()===_.getLeftChar().getValue()&&v.getRightChar().getValue()===_.getRightChar().getValue()&&v.getFinderPatter().getValue()===_.getFinderPatter().getValue()&&(g=!0)})}),g}}class Re extends lt{constructor(f){super(...arguments),this.pairs=new Array(Re.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=f===!0}decodeRow(f,p,g){this.pairs.length=0,this.startFromEven=!1;try{return Re.constructResult(this.decodeRow2pairs(f,p))}catch(v){this.verbose&&console.log(v)}return this.pairs.length=0,this.startFromEven=!0,Re.constructResult(this.decodeRow2pairs(f,p))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(f,p){let g=!1;for(;!g;)try{this.pairs.push(this.retrieveNextPair(p,this.pairs,f))}catch(N){if(N instanceof z){if(!this.pairs.length)throw new z;g=!0}}if(this.checkChecksum())return this.pairs;let v;if(this.rows.length?v=!0:v=!1,this.storeRow(f,!1),v){let N=this.checkRowsBoolean(!1);if(N!=null||(N=this.checkRowsBoolean(!0),N!=null))return N}throw new z}checkRowsBoolean(f){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,f&&(this.rows=this.rows.reverse());let p=null;try{p=this.checkRows(new Array,0)}catch(g){this.verbose&&console.log(g)}return f&&(this.rows=this.rows.reverse()),p}checkRows(f,p){for(let g=p;g<this.rows.length;g++){let v=this.rows[g];this.pairs.length=0;for(let _ of f)this.pairs.push(_.getPairs());if(this.pairs.push(v.getPairs()),!Re.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let N=new Array(f);N.push(v);try{return this.checkRows(N,g+1)}catch(_){this.verbose&&console.log(_)}}throw new z}static isValidSequence(f){for(let p of Re.FINDER_PATTERN_SEQUENCES){if(f.length>p.length)continue;let g=!0;for(let v=0;v<f.length;v++)if(f[v].getFinderPattern().getValue()!=p[v]){g=!1;break}if(g)return!0}return!1}storeRow(f,p){let g=0,v=!1,N=!1;for(;g<this.rows.length;){let _=this.rows[g];if(_.getRowNumber()>f){N=_.isEquivalent(this.pairs);break}v=_.isEquivalent(this.pairs),g++}N||v||Re.isPartialRow(this.pairs,this.rows)||(this.rows.push(g,new Hh(this.pairs,f,p)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(f,p){for(let g of p)if(g.getPairs().length!==f.length){for(let v of g.getPairs())for(let N of f)if(ul.equals(v,N))break}}static isPartialRow(f,p){for(let g of p){let v=!0;for(let N of f){let _=!1;for(let E of g.getPairs())if(N.equals(E)){_=!0;break}if(!_){v=!1;break}}if(v)return!0}return!1}getRows(){return this.rows}static constructResult(f){let p=Qn.buildBitArray(f),v=dd(p).parseInformation(),N=f[0].getFinderPattern().getResultPoints(),_=f[f.length-1].getFinderPattern().getResultPoints(),E=[N[0],N[1],_[0],_[1]];return new be(v,null,null,E,Z.RSS_EXPANDED,null)}checkChecksum(){let f=this.pairs.get(0),p=f.getLeftChar(),g=f.getRightChar();if(g==null)return!1;let v=g.getChecksumPortion(),N=2;for(let E=1;E<this.pairs.size();++E){let M=this.pairs.get(E);v+=M.getLeftChar().getChecksumPortion(),N++;let F=M.getRightChar();F!=null&&(v+=F.getChecksumPortion(),N++)}return v%=211,211*(N-4)+v==p.getValue()}static getNextSecondBar(f,p){let g;return f.get(p)?(g=f.getNextUnset(p),g=f.getNextSet(g)):(g=f.getNextSet(p),g=f.getNextUnset(g)),g}retrieveNextPair(f,p,g){let v=p.length%2==0;this.startFromEven&&(v=!v);let N,_=!0,E=-1;do this.findNextPair(f,p,E),N=this.parseFoundFinderPattern(f,g,v),N==null?E=Re.getNextSecondBar(f,this.startEnd[0]):_=!1;while(_);let M=this.decodeDataCharacter(f,N,v,!0);if(!this.isEmptyPair(p)&&p[p.length-1].mustBeLast())throw new z;let F;try{F=this.decodeDataCharacter(f,N,v,!1)}catch(U){F=null,this.verbose&&console.log(U)}return new ul(M,F,N,!0)}isEmptyPair(f){return f.length===0}findNextPair(f,p,g){let v=this.getDecodeFinderCounters();v[0]=0,v[1]=0,v[2]=0,v[3]=0;let N=f.getSize(),_;g>=0?_=g:this.isEmptyPair(p)?_=0:_=p[p.length-1].getFinderPattern().getStartEnd()[1];let E=p.length%2!=0;this.startFromEven&&(E=!E);let M=!1;for(;_<N&&(M=!f.get(_),!!M);)_++;let F=0,U=_;for(let q=_;q<N;q++)if(f.get(q)!=M)v[F]++;else{if(F==3){if(E&&Re.reverseCounters(v),Re.isFinderPattern(v)){this.startEnd[0]=U,this.startEnd[1]=q;return}E&&Re.reverseCounters(v),U+=v[0]+v[1],v[0]=v[2],v[1]=v[3],v[2]=0,v[3]=0,F--}else F++;v[F]=1,M=!M}throw new z}static reverseCounters(f){let p=f.length;for(let g=0;g<p/2;++g){let v=f[g];f[g]=f[p-g-1],f[p-g-1]=v}}parseFoundFinderPattern(f,p,g){let v,N,_;if(g){let F=this.startEnd[0]-1;for(;F>=0&&!f.get(F);)F--;F++,v=this.startEnd[0]-F,N=F,_=this.startEnd[1]}else N=this.startEnd[0],_=f.getNextUnset(this.startEnd[1]+1),v=_-this.startEnd[1];let E=this.getDecodeFinderCounters();j.arraycopy(E,0,E,1,E.length-1),E[0]=v;let M;try{M=this.parseFinderValue(E,Re.FINDER_PATTERNS)}catch{return null}return new Rt(M,[N,_],N,_,p)}decodeDataCharacter(f,p,g,v){let N=this.getDataCharacterCounters();for(let Cn=0;Cn<N.length;Cn++)N[Cn]=0;if(v)Re.recordPatternInReverse(f,p.getStartEnd()[0],N);else{Re.recordPattern(f,p.getStartEnd()[1],N);for(let Cn=0,gr=N.length-1;Cn<gr;Cn++,gr--){let Ea=N[Cn];N[Cn]=N[gr],N[gr]=Ea}}let _=17,E=qe.sum(new Int32Array(N))/_,M=(p.getStartEnd()[1]-p.getStartEnd()[0])/15;if(Math.abs(E-M)/M>.3)throw new z;let F=this.getOddCounts(),U=this.getEvenCounts(),q=this.getOddRoundingErrors(),Q=this.getEvenRoundingErrors();for(let Cn=0;Cn<N.length;Cn++){let gr=1*N[Cn]/E,Ea=gr+.5;if(Ea<1){if(gr<.3)throw new z;Ea=1}else if(Ea>8){if(gr>8.7)throw new z;Ea=8}let Wu=Cn/2;Cn&1?(U[Wu]=Ea,Q[Wu]=gr-Ea):(F[Wu]=Ea,q[Wu]=gr-Ea)}this.adjustOddEvenCounts(_);let se=4*p.getValue()+(g?0:2)+(v?0:1)-1,fe=0,me=0;for(let Cn=F.length-1;Cn>=0;Cn--){if(Re.isNotA1left(p,g,v)){let gr=Re.WEIGHTS[se][2*Cn];me+=F[Cn]*gr}fe+=F[Cn]}let Ne=0;for(let Cn=U.length-1;Cn>=0;Cn--)if(Re.isNotA1left(p,g,v)){let gr=Re.WEIGHTS[se][2*Cn+1];Ne+=U[Cn]*gr}let ke=me+Ne;if(fe&1||fe>13||fe<4)throw new z;let We=(13-fe)/2,Ke=Re.SYMBOL_WIDEST[We],Fe=9-Ke,Jt=Ft.getRSSvalue(F,Ke,!0),$t=Ft.getRSSvalue(U,Fe,!1),da=Re.EVEN_TOTAL_SUBSET[We],Ri=Re.GSUM[We],ua=Jt*da+$t+Ri;return new qt(ua,ke)}static isNotA1left(f,p,g){return!(f.getValue()==0&&p&&g)}adjustOddEvenCounts(f){let p=qe.sum(new Int32Array(this.getOddCounts())),g=qe.sum(new Int32Array(this.getEvenCounts())),v=!1,N=!1;p>13?N=!0:p<4&&(v=!0);let _=!1,E=!1;g>13?E=!0:g<4&&(_=!0);let M=p+g-f,F=(p&1)==1,U=(g&1)==0;if(M==1)if(F){if(U)throw new z;N=!0}else{if(!U)throw new z;E=!0}else if(M==-1)if(F){if(U)throw new z;v=!0}else{if(!U)throw new z;_=!0}else if(M==0){if(F){if(!U)throw new z;p<g?(v=!0,E=!0):(N=!0,_=!0)}else if(U)throw new z}else throw new z;if(v){if(N)throw new z;Re.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(N&&Re.decrement(this.getOddCounts(),this.getOddRoundingErrors()),_){if(E)throw new z;Re.increment(this.getEvenCounts(),this.getOddRoundingErrors())}E&&Re.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Re.SYMBOL_WIDEST=[7,5,4,3,1],Re.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Re.GSUM=[0,348,1388,2948,3988],Re.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Re.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Re.FINDER_PAT_A=0,Re.FINDER_PAT_B=1,Re.FINDER_PAT_C=2,Re.FINDER_PAT_D=3,Re.FINDER_PAT_E=4,Re.FINDER_PAT_F=5,Re.FINDER_PATTERN_SEQUENCES=[[Re.FINDER_PAT_A,Re.FINDER_PAT_A],[Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B],[Re.FINDER_PAT_A,Re.FINDER_PAT_C,Re.FINDER_PAT_B,Re.FINDER_PAT_D],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_C],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_D,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_D],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_E],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F]],Re.MAX_PAIRS=11;class xw extends qt{constructor(f,p,g){super(f,p),this.count=0,this.finderPattern=g}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Vn extends lt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(f,p,g){const v=this.decodePair(p,!1,f,g);Vn.addOrTally(this.possibleLeftPairs,v),p.reverse();let N=this.decodePair(p,!0,f,g);Vn.addOrTally(this.possibleRightPairs,N),p.reverse();for(let _ of this.possibleLeftPairs)if(_.getCount()>1){for(let E of this.possibleRightPairs)if(E.getCount()>1&&Vn.checkChecksum(_,E))return Vn.constructResult(_,E)}throw new z}static addOrTally(f,p){if(p==null)return;let g=!1;for(let v of f)if(v.getValue()===p.getValue()){v.incrementCount(),g=!0;break}g||f.push(p)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(f,p){let g=4537077*f.getValue()+p.getValue(),v=new String(g).toString(),N=new V;for(let F=13-v.length;F>0;F--)N.append("0");N.append(v);let _=0;for(let F=0;F<13;F++){let U=N.charAt(F).charCodeAt(0)-48;_+=F&1?U:3*U}_=10-_%10,_===10&&(_=0),N.append(_.toString());let E=f.getFinderPattern().getResultPoints(),M=p.getFinderPattern().getResultPoints();return new be(N.toString(),null,0,[E[0],E[1],M[0],M[1]],Z.RSS_14,new Date().getTime())}static checkChecksum(f,p){let g=(f.getChecksumPortion()+16*p.getChecksumPortion())%79,v=9*f.getFinderPattern().getValue()+p.getFinderPattern().getValue();return v>72&&v--,v>8&&v--,g===v}decodePair(f,p,g,v){try{let N=this.findFinderPattern(f,p),_=this.parseFoundFinderPattern(f,g,p,N),E=v==null?null:v.get(D.NEED_RESULT_POINT_CALLBACK);if(E!=null){let U=(N[0]+N[1])/2;p&&(U=f.getSize()-1-U),E.foundPossibleResultPoint(new ue(U,g))}let M=this.decodeDataCharacter(f,_,!0),F=this.decodeDataCharacter(f,_,!1);return new xw(1597*M.getValue()+F.getValue(),M.getChecksumPortion()+4*F.getChecksumPortion(),_)}catch{return null}}decodeDataCharacter(f,p,g){let v=this.getDataCharacterCounters();for(let Ne=0;Ne<v.length;Ne++)v[Ne]=0;if(g)ht.recordPatternInReverse(f,p.getStartEnd()[0],v);else{ht.recordPattern(f,p.getStartEnd()[1]+1,v);for(let Ne=0,ke=v.length-1;Ne<ke;Ne++,ke--){let We=v[Ne];v[Ne]=v[ke],v[ke]=We}}let N=g?16:15,_=qe.sum(new Int32Array(v))/N,E=this.getOddCounts(),M=this.getEvenCounts(),F=this.getOddRoundingErrors(),U=this.getEvenRoundingErrors();for(let Ne=0;Ne<v.length;Ne++){let ke=v[Ne]/_,We=Math.floor(ke+.5);We<1?We=1:We>8&&(We=8);let Ke=Math.floor(Ne/2);Ne&1?(M[Ke]=We,U[Ke]=ke-We):(E[Ke]=We,F[Ke]=ke-We)}this.adjustOddEvenCounts(g,N);let q=0,Q=0;for(let Ne=E.length-1;Ne>=0;Ne--)Q*=9,Q+=E[Ne],q+=E[Ne];let se=0,fe=0;for(let Ne=M.length-1;Ne>=0;Ne--)se*=9,se+=M[Ne],fe+=M[Ne];let me=Q+3*se;if(g){if(q&1||q>12||q<4)throw new z;let Ne=(12-q)/2,ke=Vn.OUTSIDE_ODD_WIDEST[Ne],We=9-ke,Ke=Ft.getRSSvalue(E,ke,!1),Fe=Ft.getRSSvalue(M,We,!0),Jt=Vn.OUTSIDE_EVEN_TOTAL_SUBSET[Ne],$t=Vn.OUTSIDE_GSUM[Ne];return new qt(Ke*Jt+Fe+$t,me)}else{if(fe&1||fe>10||fe<4)throw new z;let Ne=(10-fe)/2,ke=Vn.INSIDE_ODD_WIDEST[Ne],We=9-ke,Ke=Ft.getRSSvalue(E,ke,!0),Fe=Ft.getRSSvalue(M,We,!1),Jt=Vn.INSIDE_ODD_TOTAL_SUBSET[Ne],$t=Vn.INSIDE_GSUM[Ne];return new qt(Fe*Jt+Ke+$t,me)}}findFinderPattern(f,p){let g=this.getDecodeFinderCounters();g[0]=0,g[1]=0,g[2]=0,g[3]=0;let v=f.getSize(),N=!1,_=0;for(;_<v&&(N=!f.get(_),p!==N);)_++;let E=0,M=_;for(let F=_;F<v;F++)if(f.get(F)!==N)g[E]++;else{if(E===3){if(lt.isFinderPattern(g))return[M,F];M+=g[0]+g[1],g[0]=g[2],g[1]=g[3],g[2]=0,g[3]=0,E--}else E++;g[E]=1,N=!N}throw new z}parseFoundFinderPattern(f,p,g,v){let N=f.get(v[0]),_=v[0]-1;for(;_>=0&&N!==f.get(_);)_--;_++;const E=v[0]-_,M=this.getDecodeFinderCounters(),F=new Int32Array(M.length);j.arraycopy(M,0,F,1,M.length-1),F[0]=E;const U=this.parseFinderValue(F,Vn.FINDER_PATTERNS);let q=_,Q=v[1];return g&&(q=f.getSize()-1-q,Q=f.getSize()-1-Q),new Rt(U,[_,v[1]],q,Q,p)}adjustOddEvenCounts(f,p){let g=qe.sum(new Int32Array(this.getOddCounts())),v=qe.sum(new Int32Array(this.getEvenCounts())),N=!1,_=!1,E=!1,M=!1;f?(g>12?_=!0:g<4&&(N=!0),v>12?M=!0:v<4&&(E=!0)):(g>11?_=!0:g<5&&(N=!0),v>10?M=!0:v<4&&(E=!0));let F=g+v-p,U=(g&1)===(f?1:0),q=(v&1)===1;if(F===1)if(U){if(q)throw new z;_=!0}else{if(!q)throw new z;M=!0}else if(F===-1)if(U){if(q)throw new z;N=!0}else{if(!q)throw new z;E=!0}else if(F===0){if(U){if(!q)throw new z;g<v?(N=!0,M=!0):(_=!0,E=!0)}else if(q)throw new z}else throw new z;if(N){if(_)throw new z;lt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(_&&lt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),E){if(M)throw new z;lt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}M&&lt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Vn.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Vn.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Vn.OUTSIDE_GSUM=[0,161,961,2015,2715],Vn.INSIDE_GSUM=[0,336,1036,1516],Vn.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Vn.INSIDE_ODD_WIDEST=[2,4,6,8],Vn.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Wo extends ht{constructor(f,p){super(),this.readers=[],this.verbose=p===!0;const g=f?f.get(D.POSSIBLE_FORMATS):null,v=f&&f.get(D.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;g?((g.includes(Z.EAN_13)||g.includes(Z.UPC_A)||g.includes(Z.EAN_8)||g.includes(Z.UPC_E))&&this.readers.push(new at(f)),g.includes(Z.CODE_39)&&this.readers.push(new Xt(v)),g.includes(Z.CODE_128)&&this.readers.push(new $e),g.includes(Z.ITF)&&this.readers.push(new Ut),g.includes(Z.RSS_14)&&this.readers.push(new Vn),g.includes(Z.RSS_EXPANDED)&&this.readers.push(new Re(this.verbose))):(this.readers.push(new at(f)),this.readers.push(new Xt),this.readers.push(new at(f)),this.readers.push(new $e),this.readers.push(new Ut),this.readers.push(new Vn),this.readers.push(new Re(this.verbose)))}decodeRow(f,p,g){for(let v=0;v<this.readers.length;v++)try{return this.readers[v].decodeRow(f,p,g)}catch{}throw new z}reset(){this.readers.forEach(f=>f.reset())}}class ud extends he{constructor(f=500,p){super(new Wo(p),f,p)}}class ln{constructor(f,p,g){this.ecCodewords=f,this.ecBlocks=[p],g&&this.ecBlocks.push(g)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class sn{constructor(f,p){this.count=f,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Qt{constructor(f,p,g,v,N,_){this.versionNumber=f,this.symbolSizeRows=p,this.symbolSizeColumns=g,this.dataRegionSizeRows=v,this.dataRegionSizeColumns=N,this.ecBlocks=_;let E=0;const M=_.getECCodewords(),F=_.getECBlocks();for(let U of F)E+=U.getCount()*(U.getDataCodewords()+M);this.totalCodewords=E}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(f,p){if(f&1||p&1)throw new O;for(let g of Qt.VERSIONS)if(g.symbolSizeRows===f&&g.symbolSizeColumns===p)return g;throw new O}toString(){return""+this.versionNumber}static buildVersions(){return[new Qt(1,10,10,8,8,new ln(5,new sn(1,3))),new Qt(2,12,12,10,10,new ln(7,new sn(1,5))),new Qt(3,14,14,12,12,new ln(10,new sn(1,8))),new Qt(4,16,16,14,14,new ln(12,new sn(1,12))),new Qt(5,18,18,16,16,new ln(14,new sn(1,18))),new Qt(6,20,20,18,18,new ln(18,new sn(1,22))),new Qt(7,22,22,20,20,new ln(20,new sn(1,30))),new Qt(8,24,24,22,22,new ln(24,new sn(1,36))),new Qt(9,26,26,24,24,new ln(28,new sn(1,44))),new Qt(10,32,32,14,14,new ln(36,new sn(1,62))),new Qt(11,36,36,16,16,new ln(42,new sn(1,86))),new Qt(12,40,40,18,18,new ln(48,new sn(1,114))),new Qt(13,44,44,20,20,new ln(56,new sn(1,144))),new Qt(14,48,48,22,22,new ln(68,new sn(1,174))),new Qt(15,52,52,24,24,new ln(42,new sn(2,102))),new Qt(16,64,64,14,14,new ln(56,new sn(2,140))),new Qt(17,72,72,16,16,new ln(36,new sn(4,92))),new Qt(18,80,80,18,18,new ln(48,new sn(4,114))),new Qt(19,88,88,20,20,new ln(56,new sn(4,144))),new Qt(20,96,96,22,22,new ln(68,new sn(4,174))),new Qt(21,104,104,24,24,new ln(56,new sn(6,136))),new Qt(22,120,120,18,18,new ln(68,new sn(6,175))),new Qt(23,132,132,20,20,new ln(62,new sn(8,163))),new Qt(24,144,144,22,22,new ln(62,new sn(8,156),new sn(2,155))),new Qt(25,8,18,6,16,new ln(7,new sn(1,5))),new Qt(26,8,32,6,14,new ln(11,new sn(1,10))),new Qt(27,12,26,10,24,new ln(14,new sn(1,16))),new Qt(28,12,36,10,16,new ln(18,new sn(1,22))),new Qt(29,16,36,14,16,new ln(24,new sn(1,32))),new Qt(30,16,48,14,22,new ln(28,new sn(1,49)))]}}Qt.VERSIONS=Qt.buildVersions();class Wh{constructor(f){const p=f.getHeight();if(p<8||p>144||p&1)throw new O;this.version=Wh.readVersion(f),this.mappingBitMatrix=this.extractDataRegion(f),this.readMappingMatrix=new K(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(f){const p=f.getHeight(),g=f.getWidth();return Qt.getVersionForDimensions(p,g)}readCodewords(){const f=new Int8Array(this.version.getTotalCodewords());let p=0,g=4,v=0;const N=this.mappingBitMatrix.getHeight(),_=this.mappingBitMatrix.getWidth();let E=!1,M=!1,F=!1,U=!1;do if(g===N&&v===0&&!E)f[p++]=this.readCorner1(N,_)&255,g-=2,v+=2,E=!0;else if(g===N-2&&v===0&&_&3&&!M)f[p++]=this.readCorner2(N,_)&255,g-=2,v+=2,M=!0;else if(g===N+4&&v===2&&!(_&7)&&!F)f[p++]=this.readCorner3(N,_)&255,g-=2,v+=2,F=!0;else if(g===N-2&&v===0&&(_&7)===4&&!U)f[p++]=this.readCorner4(N,_)&255,g-=2,v+=2,U=!0;else{do g<N&&v>=0&&!this.readMappingMatrix.get(v,g)&&(f[p++]=this.readUtah(g,v,N,_)&255),g-=2,v+=2;while(g>=0&&v<_);g+=1,v+=3;do g>=0&&v<_&&!this.readMappingMatrix.get(v,g)&&(f[p++]=this.readUtah(g,v,N,_)&255),g+=2,v-=2;while(g<N&&v>=0);g+=3,v+=1}while(g<N||v<_);if(p!==this.version.getTotalCodewords())throw new O;return f}readModule(f,p,g,v){return f<0&&(f+=g,p+=4-(g+4&7)),p<0&&(p+=v,f+=4-(v+4&7)),this.readMappingMatrix.set(p,f),this.mappingBitMatrix.get(p,f)}readUtah(f,p,g,v){let N=0;return this.readModule(f-2,p-2,g,v)&&(N|=1),N<<=1,this.readModule(f-2,p-1,g,v)&&(N|=1),N<<=1,this.readModule(f-1,p-2,g,v)&&(N|=1),N<<=1,this.readModule(f-1,p-1,g,v)&&(N|=1),N<<=1,this.readModule(f-1,p,g,v)&&(N|=1),N<<=1,this.readModule(f,p-2,g,v)&&(N|=1),N<<=1,this.readModule(f,p-1,g,v)&&(N|=1),N<<=1,this.readModule(f,p,g,v)&&(N|=1),N}readCorner1(f,p){let g=0;return this.readModule(f-1,0,f,p)&&(g|=1),g<<=1,this.readModule(f-1,1,f,p)&&(g|=1),g<<=1,this.readModule(f-1,2,f,p)&&(g|=1),g<<=1,this.readModule(0,p-2,f,p)&&(g|=1),g<<=1,this.readModule(0,p-1,f,p)&&(g|=1),g<<=1,this.readModule(1,p-1,f,p)&&(g|=1),g<<=1,this.readModule(2,p-1,f,p)&&(g|=1),g<<=1,this.readModule(3,p-1,f,p)&&(g|=1),g}readCorner2(f,p){let g=0;return this.readModule(f-3,0,f,p)&&(g|=1),g<<=1,this.readModule(f-2,0,f,p)&&(g|=1),g<<=1,this.readModule(f-1,0,f,p)&&(g|=1),g<<=1,this.readModule(0,p-4,f,p)&&(g|=1),g<<=1,this.readModule(0,p-3,f,p)&&(g|=1),g<<=1,this.readModule(0,p-2,f,p)&&(g|=1),g<<=1,this.readModule(0,p-1,f,p)&&(g|=1),g<<=1,this.readModule(1,p-1,f,p)&&(g|=1),g}readCorner3(f,p){let g=0;return this.readModule(f-1,0,f,p)&&(g|=1),g<<=1,this.readModule(f-1,p-1,f,p)&&(g|=1),g<<=1,this.readModule(0,p-3,f,p)&&(g|=1),g<<=1,this.readModule(0,p-2,f,p)&&(g|=1),g<<=1,this.readModule(0,p-1,f,p)&&(g|=1),g<<=1,this.readModule(1,p-3,f,p)&&(g|=1),g<<=1,this.readModule(1,p-2,f,p)&&(g|=1),g<<=1,this.readModule(1,p-1,f,p)&&(g|=1),g}readCorner4(f,p){let g=0;return this.readModule(f-3,0,f,p)&&(g|=1),g<<=1,this.readModule(f-2,0,f,p)&&(g|=1),g<<=1,this.readModule(f-1,0,f,p)&&(g|=1),g<<=1,this.readModule(0,p-2,f,p)&&(g|=1),g<<=1,this.readModule(0,p-1,f,p)&&(g|=1),g<<=1,this.readModule(1,p-1,f,p)&&(g|=1),g<<=1,this.readModule(2,p-1,f,p)&&(g|=1),g<<=1,this.readModule(3,p-1,f,p)&&(g|=1),g}extractDataRegion(f){const p=this.version.getSymbolSizeRows(),g=this.version.getSymbolSizeColumns();if(f.getHeight()!==p)throw new m("Dimension of bitMatrix must match the version size");const v=this.version.getDataRegionSizeRows(),N=this.version.getDataRegionSizeColumns(),_=p/v|0,E=g/N|0,M=_*v,F=E*N,U=new K(F,M);for(let q=0;q<_;++q){const Q=q*v;for(let se=0;se<E;++se){const fe=se*N;for(let me=0;me<v;++me){const Ne=q*(v+2)+1+me,ke=Q+me;for(let We=0;We<N;++We){const Ke=se*(N+2)+1+We;if(f.get(Ke,Ne)){const Fe=fe+We;U.set(Fe,ke)}}}}}return U}}class qo{constructor(f,p){this.numDataCodewords=f,this.codewords=p}static getDataBlocks(f,p){const g=p.getECBlocks();let v=0;const N=g.getECBlocks();for(let me of N)v+=me.getCount();const _=new Array(v);let E=0;for(let me of N)for(let Ne=0;Ne<me.getCount();Ne++){const ke=me.getDataCodewords(),We=g.getECCodewords()+ke;_[E++]=new qo(ke,new Uint8Array(We))}const F=_[0].codewords.length-g.getECCodewords(),U=F-1;let q=0;for(let me=0;me<U;me++)for(let Ne=0;Ne<E;Ne++)_[Ne].codewords[me]=f[q++];const Q=p.getVersionNumber()===24,se=Q?8:E;for(let me=0;me<se;me++)_[me].codewords[F-1]=f[q++];const fe=_[0].codewords.length;for(let me=F;me<fe;me++)for(let Ne=0;Ne<E;Ne++){const ke=Q?(Ne+8)%E:Ne,We=Q&&ke>7?me-1:me;_[ke].codewords[We]=f[q++]}if(q!==f.length)throw new m;return _}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class qh{constructor(f){this.bytes=f,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(f){if(f<1||f>32||f>this.available())throw new m(""+f);let p=0,g=this.bitOffset,v=this.byteOffset;const N=this.bytes;if(g>0){const _=8-g,E=f<_?f:_,M=_-E,F=255>>8-E<<M;p=(N[v]&F)>>M,f-=E,g+=E,g===8&&(g=0,v++)}if(f>0){for(;f>=8;)p=p<<8|N[v]&255,v++,f-=8;if(f>0){const _=8-f,E=255>>_<<_;p=p<<f|(N[v]&E)>>_,g+=f}}return this.bitOffset=g,this.byteOffset=v,p}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var xs;(function(W){W[W.PAD_ENCODE=0]="PAD_ENCODE",W[W.ASCII_ENCODE=1]="ASCII_ENCODE",W[W.C40_ENCODE=2]="C40_ENCODE",W[W.TEXT_ENCODE=3]="TEXT_ENCODE",W[W.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",W[W.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",W[W.BASE256_ENCODE=6]="BASE256_ENCODE"})(xs||(xs={}));class Di{static decode(f){const p=new qh(f),g=new V,v=new V,N=new Array;let _=xs.ASCII_ENCODE;do if(_===xs.ASCII_ENCODE)_=this.decodeAsciiSegment(p,g,v);else{switch(_){case xs.C40_ENCODE:this.decodeC40Segment(p,g);break;case xs.TEXT_ENCODE:this.decodeTextSegment(p,g);break;case xs.ANSIX12_ENCODE:this.decodeAnsiX12Segment(p,g);break;case xs.EDIFACT_ENCODE:this.decodeEdifactSegment(p,g);break;case xs.BASE256_ENCODE:this.decodeBase256Segment(p,g,N);break;default:throw new O}_=xs.ASCII_ENCODE}while(_!==xs.PAD_ENCODE&&p.available()>0);return v.length()>0&&g.append(v.toString()),new le(f,g.toString(),N.length===0?null:N,null)}static decodeAsciiSegment(f,p,g){let v=!1;do{let N=f.readBits(8);if(N===0)throw new O;if(N<=128)return v&&(N+=128),p.append(String.fromCharCode(N-1)),xs.ASCII_ENCODE;if(N===129)return xs.PAD_ENCODE;if(N<=229){const _=N-130;_<10&&p.append("0"),p.append(""+_)}else switch(N){case 230:return xs.C40_ENCODE;case 231:return xs.BASE256_ENCODE;case 232:p.append("");break;case 233:case 234:break;case 235:v=!0;break;case 236:p.append("[)>05"),g.insert(0,"");break;case 237:p.append("[)>06"),g.insert(0,"");break;case 238:return xs.ANSIX12_ENCODE;case 239:return xs.TEXT_ENCODE;case 240:return xs.EDIFACT_ENCODE;case 241:break;default:if(N!==254||f.available()!==0)throw new O;break}}while(f.available()>0);return xs.ASCII_ENCODE}static decodeC40Segment(f,p){let g=!1;const v=[];let N=0;do{if(f.available()===8)return;const _=f.readBits(8);if(_===254)return;this.parseTwoBytes(_,f.readBits(8),v);for(let E=0;E<3;E++){const M=v[E];switch(N){case 0:if(M<3)N=M+1;else if(M<this.C40_BASIC_SET_CHARS.length){const F=this.C40_BASIC_SET_CHARS[M];g?(p.append(String.fromCharCode(F.charCodeAt(0)+128)),g=!1):p.append(F)}else throw new O;break;case 1:g?(p.append(String.fromCharCode(M+128)),g=!1):p.append(String.fromCharCode(M)),N=0;break;case 2:if(M<this.C40_SHIFT2_SET_CHARS.length){const F=this.C40_SHIFT2_SET_CHARS[M];g?(p.append(String.fromCharCode(F.charCodeAt(0)+128)),g=!1):p.append(F)}else switch(M){case 27:p.append("");break;case 30:g=!0;break;default:throw new O}N=0;break;case 3:g?(p.append(String.fromCharCode(M+224)),g=!1):p.append(String.fromCharCode(M+96)),N=0;break;default:throw new O}}}while(f.available()>0)}static decodeTextSegment(f,p){let g=!1,v=[],N=0;do{if(f.available()===8)return;const _=f.readBits(8);if(_===254)return;this.parseTwoBytes(_,f.readBits(8),v);for(let E=0;E<3;E++){const M=v[E];switch(N){case 0:if(M<3)N=M+1;else if(M<this.TEXT_BASIC_SET_CHARS.length){const F=this.TEXT_BASIC_SET_CHARS[M];g?(p.append(String.fromCharCode(F.charCodeAt(0)+128)),g=!1):p.append(F)}else throw new O;break;case 1:g?(p.append(String.fromCharCode(M+128)),g=!1):p.append(String.fromCharCode(M)),N=0;break;case 2:if(M<this.TEXT_SHIFT2_SET_CHARS.length){const F=this.TEXT_SHIFT2_SET_CHARS[M];g?(p.append(String.fromCharCode(F.charCodeAt(0)+128)),g=!1):p.append(F)}else switch(M){case 27:p.append("");break;case 30:g=!0;break;default:throw new O}N=0;break;case 3:if(M<this.TEXT_SHIFT3_SET_CHARS.length){const F=this.TEXT_SHIFT3_SET_CHARS[M];g?(p.append(String.fromCharCode(F.charCodeAt(0)+128)),g=!1):p.append(F),N=0}else throw new O;break;default:throw new O}}}while(f.available()>0)}static decodeAnsiX12Segment(f,p){const g=[];do{if(f.available()===8)return;const v=f.readBits(8);if(v===254)return;this.parseTwoBytes(v,f.readBits(8),g);for(let N=0;N<3;N++){const _=g[N];switch(_){case 0:p.append("\r");break;case 1:p.append("*");break;case 2:p.append(">");break;case 3:p.append(" ");break;default:if(_<14)p.append(String.fromCharCode(_+44));else if(_<40)p.append(String.fromCharCode(_+51));else throw new O;break}}}while(f.available()>0)}static parseTwoBytes(f,p,g){let v=(f<<8)+p-1,N=Math.floor(v/1600);g[0]=N,v-=N*1600,N=Math.floor(v/40),g[1]=N,g[2]=v-N*40}static decodeEdifactSegment(f,p){do{if(f.available()<=16)return;for(let g=0;g<4;g++){let v=f.readBits(6);if(v===31){const N=8-f.getBitOffset();N!==8&&f.readBits(N);return}v&32||(v|=64),p.append(String.fromCharCode(v))}}while(f.available()>0)}static decodeBase256Segment(f,p,g){let v=1+f.getByteOffset();const N=this.unrandomize255State(f.readBits(8),v++);let _;if(N===0?_=f.available()/8|0:N<250?_=N:_=250*(N-249)+this.unrandomize255State(f.readBits(8),v++),_<0)throw new O;const E=new Uint8Array(_);for(let M=0;M<_;M++){if(f.available()<8)throw new O;E[M]=this.unrandomize255State(f.readBits(8),v++)}g.push(E);try{p.append($.decode(E,B.ISO88591))}catch(M){throw new wt("Platform does not support required encoding: "+M.message)}}static unrandomize255State(f,p){const g=149*p%255+1,v=f-g;return v>=0?v:v+256}}Di.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Di.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Di.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Di.TEXT_SHIFT2_SET_CHARS=Di.C40_SHIFT2_SET_CHARS,Di.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class gw{constructor(){this.rsDecoder=new jt(Ve.DATA_MATRIX_FIELD_256)}decode(f){const p=new Wh(f),g=p.getVersion(),v=p.readCodewords(),N=qo.getDataBlocks(v,g);let _=0;for(let F of N)_+=F.getNumDataCodewords();const E=new Uint8Array(_),M=N.length;for(let F=0;F<M;F++){const U=N[F],q=U.getCodewords(),Q=U.getNumDataCodewords();this.correctErrors(q,Q);for(let se=0;se<Q;se++)E[se*M+F]=q[se]}return Di.decode(E)}correctErrors(f,p){const g=new Int32Array(f);try{this.rsDecoder.decode(g,f.length-p)}catch{throw new b}for(let v=0;v<p;v++)f[v]=g[v]}}class vn{constructor(f){this.image=f,this.rectangleDetector=new tn(this.image)}detect(){const f=this.rectangleDetector.detect();let p=this.detectSolid1(f);if(p=this.detectSolid2(p),p[3]=this.correctTopRight(p),!p[3])throw new z;p=this.shiftToModuleCenter(p);const g=p[0],v=p[1],N=p[2],_=p[3];let E=this.transitionsBetween(g,_)+1,M=this.transitionsBetween(N,_)+1;(E&1)===1&&(E+=1),(M&1)===1&&(M+=1),4*E<7*M&&4*M<7*E&&(E=M=Math.max(E,M));let F=vn.sampleGrid(this.image,g,v,N,_,E,M);return new De(F,[g,v,N,_])}static shiftPoint(f,p,g){let v=(p.getX()-f.getX())/(g+1),N=(p.getY()-f.getY())/(g+1);return new ue(f.getX()+v,f.getY()+N)}static moveAway(f,p,g){let v=f.getX(),N=f.getY();return v<p?v-=1:v+=1,N<g?N-=1:N+=1,new ue(v,N)}detectSolid1(f){let p=f[0],g=f[1],v=f[3],N=f[2],_=this.transitionsBetween(p,g),E=this.transitionsBetween(g,v),M=this.transitionsBetween(v,N),F=this.transitionsBetween(N,p),U=_,q=[N,p,g,v];return U>E&&(U=E,q[0]=p,q[1]=g,q[2]=v,q[3]=N),U>M&&(U=M,q[0]=g,q[1]=v,q[2]=N,q[3]=p),U>F&&(q[0]=v,q[1]=N,q[2]=p,q[3]=g),q}detectSolid2(f){let p=f[0],g=f[1],v=f[2],N=f[3],_=this.transitionsBetween(p,N),E=vn.shiftPoint(g,v,(_+1)*4),M=vn.shiftPoint(v,g,(_+1)*4),F=this.transitionsBetween(E,p),U=this.transitionsBetween(M,N);return F<U?(f[0]=p,f[1]=g,f[2]=v,f[3]=N):(f[0]=g,f[1]=v,f[2]=N,f[3]=p),f}correctTopRight(f){let p=f[0],g=f[1],v=f[2],N=f[3],_=this.transitionsBetween(p,N),E=this.transitionsBetween(g,N),M=vn.shiftPoint(p,g,(E+1)*4),F=vn.shiftPoint(v,g,(_+1)*4);_=this.transitionsBetween(M,N),E=this.transitionsBetween(F,N);let U=new ue(N.getX()+(v.getX()-g.getX())/(_+1),N.getY()+(v.getY()-g.getY())/(_+1)),q=new ue(N.getX()+(p.getX()-g.getX())/(E+1),N.getY()+(p.getY()-g.getY())/(E+1));if(!this.isValid(U))return this.isValid(q)?q:null;if(!this.isValid(q))return U;let Q=this.transitionsBetween(M,U)+this.transitionsBetween(F,U),se=this.transitionsBetween(M,q)+this.transitionsBetween(F,q);return Q>se?U:q}shiftToModuleCenter(f){let p=f[0],g=f[1],v=f[2],N=f[3],_=this.transitionsBetween(p,N)+1,E=this.transitionsBetween(v,N)+1,M=vn.shiftPoint(p,g,E*4),F=vn.shiftPoint(v,g,_*4);_=this.transitionsBetween(M,N)+1,E=this.transitionsBetween(F,N)+1,(_&1)===1&&(_+=1),(E&1)===1&&(E+=1);let U=(p.getX()+g.getX()+v.getX()+N.getX())/4,q=(p.getY()+g.getY()+v.getY()+N.getY())/4;p=vn.moveAway(p,U,q),g=vn.moveAway(g,U,q),v=vn.moveAway(v,U,q),N=vn.moveAway(N,U,q);let Q,se;return M=vn.shiftPoint(p,g,E*4),M=vn.shiftPoint(M,N,_*4),Q=vn.shiftPoint(g,p,E*4),Q=vn.shiftPoint(Q,v,_*4),F=vn.shiftPoint(v,N,E*4),F=vn.shiftPoint(F,g,_*4),se=vn.shiftPoint(N,v,E*4),se=vn.shiftPoint(se,p,_*4),[M,Q,F,se]}isValid(f){return f.getX()>=0&&f.getX()<this.image.getWidth()&&f.getY()>0&&f.getY()<this.image.getHeight()}static sampleGrid(f,p,g,v,N,_,E){return yn.getInstance().sampleGrid(f,_,E,.5,.5,_-.5,.5,_-.5,E-.5,.5,E-.5,p.getX(),p.getY(),N.getX(),N.getY(),v.getX(),v.getY(),g.getX(),g.getY())}transitionsBetween(f,p){let g=Math.trunc(f.getX()),v=Math.trunc(f.getY()),N=Math.trunc(p.getX()),_=Math.trunc(p.getY()),E=Math.abs(_-v)>Math.abs(N-g);if(E){let me=g;g=v,v=me,me=N,N=_,_=me}let M=Math.abs(N-g),F=Math.abs(_-v),U=-M/2,q=v<_?1:-1,Q=g<N?1:-1,se=0,fe=this.image.get(E?v:g,E?g:v);for(let me=g,Ne=v;me!==N;me+=Q){let ke=this.image.get(E?Ne:me,E?me:Ne);if(ke!==fe&&(se++,fe=ke),U+=F,U>0){if(Ne===_)break;Ne+=q,U-=M}}return se}}class X{constructor(){this.decoder=new gw}decode(f,p=null){let g,v;if(p!=null&&p.has(D.PURE_BARCODE)){const F=X.extractPureBits(f.getBlackMatrix());g=this.decoder.decode(F),v=X.NO_POINTS}else{const F=new vn(f.getBlackMatrix()).detect();g=this.decoder.decode(F.getBits()),v=F.getPoints()}const N=g.getRawBytes(),_=new be(g.getText(),N,8*N.length,v,Z.DATA_MATRIX,j.currentTimeMillis()),E=g.getByteSegments();E!=null&&_.putMetadata(Te.BYTE_SEGMENTS,E);const M=g.getECLevel();return M!=null&&_.putMetadata(Te.ERROR_CORRECTION_LEVEL,M),_}reset(){}static extractPureBits(f){const p=f.getTopLeftOnBit(),g=f.getBottomRightOnBit();if(p==null||g==null)throw new z;const v=this.moduleSize(p,f);let N=p[1];const _=g[1];let E=p[0];const F=(g[0]-E+1)/v,U=(_-N+1)/v;if(F<=0||U<=0)throw new z;const q=v/2;N+=q,E+=q;const Q=new K(F,U);for(let se=0;se<U;se++){const fe=N+se*v;for(let me=0;me<F;me++)f.get(E+me*v,fe)&&Q.set(me,se)}return Q}static moduleSize(f,p){const g=p.getWidth();let v=f[0];const N=f[1];for(;v<g&&p.get(v,N);)v++;if(v===g)throw new z;const _=v-f[0];if(_===0)throw new z;return _}}X.NO_POINTS=[];class je extends he{constructor(f=500){super(new X,f)}}var Ie;(function(W){W[W.L=0]="L",W[W.M=1]="M",W[W.Q=2]="Q",W[W.H=3]="H"})(Ie||(Ie={}));class it{constructor(f,p,g){this.value=f,this.stringValue=p,this.bits=g,it.FOR_BITS.set(g,this),it.FOR_VALUE.set(f,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(f){switch(f){case"L":return it.L;case"M":return it.M;case"Q":return it.Q;case"H":return it.H;default:throw new h(f+"not available")}}toString(){return this.stringValue}equals(f){if(!(f instanceof it))return!1;const p=f;return this.value===p.value}static forBits(f){if(f<0||f>=it.FOR_BITS.size)throw new m;return it.FOR_BITS.get(f)}}it.FOR_BITS=new Map,it.FOR_VALUE=new Map,it.L=new it(Ie.L,"L",1),it.M=new it(Ie.M,"M",0),it.Q=new it(Ie.Q,"Q",3),it.H=new it(Ie.H,"H",2);class Ot{constructor(f){this.errorCorrectionLevel=it.forBits(f>>3&3),this.dataMask=f&7}static numBitsDiffering(f,p){return k.bitCount(f^p)}static decodeFormatInformation(f,p){const g=Ot.doDecodeFormatInformation(f,p);return g!==null?g:Ot.doDecodeFormatInformation(f^Ot.FORMAT_INFO_MASK_QR,p^Ot.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(f,p){let g=Number.MAX_SAFE_INTEGER,v=0;for(const N of Ot.FORMAT_INFO_DECODE_LOOKUP){const _=N[0];if(_===f||_===p)return new Ot(N[1]);let E=Ot.numBitsDiffering(f,_);E<g&&(v=N[1],g=E),f!==p&&(E=Ot.numBitsDiffering(p,_),E<g&&(v=N[1],g=E))}return g<=3?new Ot(v):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(f){if(!(f instanceof Ot))return!1;const p=f;return this.errorCorrectionLevel===p.errorCorrectionLevel&&this.dataMask===p.dataMask}}Ot.FORMAT_INFO_MASK_QR=21522,Ot.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ve{constructor(f,...p){this.ecCodewordsPerBlock=f,this.ecBlocks=p}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let f=0;const p=this.ecBlocks;for(const g of p)f+=g.getCount();return f}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class te{constructor(f,p){this.count=f,this.dataCodewords=p}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class bt{constructor(f,p,...g){this.versionNumber=f,this.alignmentPatternCenters=p,this.ecBlocks=g;let v=0;const N=g[0].getECCodewordsPerBlock(),_=g[0].getECBlocks();for(const E of _)v+=E.getCount()*(E.getDataCodewords()+N);this.totalCodewords=v}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(f){return this.ecBlocks[f.getValue()]}static getProvisionalVersionForDimension(f){if(f%4!==1)throw new O;try{return this.getVersionForNumber((f-17)/4)}catch{throw new O}}static getVersionForNumber(f){if(f<1||f>40)throw new m;return bt.VERSIONS[f-1]}static decodeVersionInformation(f){let p=Number.MAX_SAFE_INTEGER,g=0;for(let v=0;v<bt.VERSION_DECODE_INFO.length;v++){const N=bt.VERSION_DECODE_INFO[v];if(N===f)return bt.getVersionForNumber(v+7);const _=Ot.numBitsDiffering(f,N);_<p&&(g=v+7,p=_)}return p<=3?bt.getVersionForNumber(g):null}buildFunctionPattern(){const f=this.getDimensionForVersion(),p=new K(f);p.setRegion(0,0,9,9),p.setRegion(f-8,0,8,9),p.setRegion(0,f-8,9,8);const g=this.alignmentPatternCenters.length;for(let v=0;v<g;v++){const N=this.alignmentPatternCenters[v]-2;for(let _=0;_<g;_++)v===0&&(_===0||_===g-1)||v===g-1&&_===0||p.setRegion(this.alignmentPatternCenters[_]-2,N,5,5)}return p.setRegion(6,9,1,f-17),p.setRegion(9,6,f-17,1),this.versionNumber>6&&(p.setRegion(f-11,0,3,6),p.setRegion(0,f-11,6,3)),p}toString(){return""+this.versionNumber}}bt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),bt.VERSIONS=[new bt(1,new Int32Array(0),new ve(7,new te(1,19)),new ve(10,new te(1,16)),new ve(13,new te(1,13)),new ve(17,new te(1,9))),new bt(2,Int32Array.from([6,18]),new ve(10,new te(1,34)),new ve(16,new te(1,28)),new ve(22,new te(1,22)),new ve(28,new te(1,16))),new bt(3,Int32Array.from([6,22]),new ve(15,new te(1,55)),new ve(26,new te(1,44)),new ve(18,new te(2,17)),new ve(22,new te(2,13))),new bt(4,Int32Array.from([6,26]),new ve(20,new te(1,80)),new ve(18,new te(2,32)),new ve(26,new te(2,24)),new ve(16,new te(4,9))),new bt(5,Int32Array.from([6,30]),new ve(26,new te(1,108)),new ve(24,new te(2,43)),new ve(18,new te(2,15),new te(2,16)),new ve(22,new te(2,11),new te(2,12))),new bt(6,Int32Array.from([6,34]),new ve(18,new te(2,68)),new ve(16,new te(4,27)),new ve(24,new te(4,19)),new ve(28,new te(4,15))),new bt(7,Int32Array.from([6,22,38]),new ve(20,new te(2,78)),new ve(18,new te(4,31)),new ve(18,new te(2,14),new te(4,15)),new ve(26,new te(4,13),new te(1,14))),new bt(8,Int32Array.from([6,24,42]),new ve(24,new te(2,97)),new ve(22,new te(2,38),new te(2,39)),new ve(22,new te(4,18),new te(2,19)),new ve(26,new te(4,14),new te(2,15))),new bt(9,Int32Array.from([6,26,46]),new ve(30,new te(2,116)),new ve(22,new te(3,36),new te(2,37)),new ve(20,new te(4,16),new te(4,17)),new ve(24,new te(4,12),new te(4,13))),new bt(10,Int32Array.from([6,28,50]),new ve(18,new te(2,68),new te(2,69)),new ve(26,new te(4,43),new te(1,44)),new ve(24,new te(6,19),new te(2,20)),new ve(28,new te(6,15),new te(2,16))),new bt(11,Int32Array.from([6,30,54]),new ve(20,new te(4,81)),new ve(30,new te(1,50),new te(4,51)),new ve(28,new te(4,22),new te(4,23)),new ve(24,new te(3,12),new te(8,13))),new bt(12,Int32Array.from([6,32,58]),new ve(24,new te(2,92),new te(2,93)),new ve(22,new te(6,36),new te(2,37)),new ve(26,new te(4,20),new te(6,21)),new ve(28,new te(7,14),new te(4,15))),new bt(13,Int32Array.from([6,34,62]),new ve(26,new te(4,107)),new ve(22,new te(8,37),new te(1,38)),new ve(24,new te(8,20),new te(4,21)),new ve(22,new te(12,11),new te(4,12))),new bt(14,Int32Array.from([6,26,46,66]),new ve(30,new te(3,115),new te(1,116)),new ve(24,new te(4,40),new te(5,41)),new ve(20,new te(11,16),new te(5,17)),new ve(24,new te(11,12),new te(5,13))),new bt(15,Int32Array.from([6,26,48,70]),new ve(22,new te(5,87),new te(1,88)),new ve(24,new te(5,41),new te(5,42)),new ve(30,new te(5,24),new te(7,25)),new ve(24,new te(11,12),new te(7,13))),new bt(16,Int32Array.from([6,26,50,74]),new ve(24,new te(5,98),new te(1,99)),new ve(28,new te(7,45),new te(3,46)),new ve(24,new te(15,19),new te(2,20)),new ve(30,new te(3,15),new te(13,16))),new bt(17,Int32Array.from([6,30,54,78]),new ve(28,new te(1,107),new te(5,108)),new ve(28,new te(10,46),new te(1,47)),new ve(28,new te(1,22),new te(15,23)),new ve(28,new te(2,14),new te(17,15))),new bt(18,Int32Array.from([6,30,56,82]),new ve(30,new te(5,120),new te(1,121)),new ve(26,new te(9,43),new te(4,44)),new ve(28,new te(17,22),new te(1,23)),new ve(28,new te(2,14),new te(19,15))),new bt(19,Int32Array.from([6,30,58,86]),new ve(28,new te(3,113),new te(4,114)),new ve(26,new te(3,44),new te(11,45)),new ve(26,new te(17,21),new te(4,22)),new ve(26,new te(9,13),new te(16,14))),new bt(20,Int32Array.from([6,34,62,90]),new ve(28,new te(3,107),new te(5,108)),new ve(26,new te(3,41),new te(13,42)),new ve(30,new te(15,24),new te(5,25)),new ve(28,new te(15,15),new te(10,16))),new bt(21,Int32Array.from([6,28,50,72,94]),new ve(28,new te(4,116),new te(4,117)),new ve(26,new te(17,42)),new ve(28,new te(17,22),new te(6,23)),new ve(30,new te(19,16),new te(6,17))),new bt(22,Int32Array.from([6,26,50,74,98]),new ve(28,new te(2,111),new te(7,112)),new ve(28,new te(17,46)),new ve(30,new te(7,24),new te(16,25)),new ve(24,new te(34,13))),new bt(23,Int32Array.from([6,30,54,78,102]),new ve(30,new te(4,121),new te(5,122)),new ve(28,new te(4,47),new te(14,48)),new ve(30,new te(11,24),new te(14,25)),new ve(30,new te(16,15),new te(14,16))),new bt(24,Int32Array.from([6,28,54,80,106]),new ve(30,new te(6,117),new te(4,118)),new ve(28,new te(6,45),new te(14,46)),new ve(30,new te(11,24),new te(16,25)),new ve(30,new te(30,16),new te(2,17))),new bt(25,Int32Array.from([6,32,58,84,110]),new ve(26,new te(8,106),new te(4,107)),new ve(28,new te(8,47),new te(13,48)),new ve(30,new te(7,24),new te(22,25)),new ve(30,new te(22,15),new te(13,16))),new bt(26,Int32Array.from([6,30,58,86,114]),new ve(28,new te(10,114),new te(2,115)),new ve(28,new te(19,46),new te(4,47)),new ve(28,new te(28,22),new te(6,23)),new ve(30,new te(33,16),new te(4,17))),new bt(27,Int32Array.from([6,34,62,90,118]),new ve(30,new te(8,122),new te(4,123)),new ve(28,new te(22,45),new te(3,46)),new ve(30,new te(8,23),new te(26,24)),new ve(30,new te(12,15),new te(28,16))),new bt(28,Int32Array.from([6,26,50,74,98,122]),new ve(30,new te(3,117),new te(10,118)),new ve(28,new te(3,45),new te(23,46)),new ve(30,new te(4,24),new te(31,25)),new ve(30,new te(11,15),new te(31,16))),new bt(29,Int32Array.from([6,30,54,78,102,126]),new ve(30,new te(7,116),new te(7,117)),new ve(28,new te(21,45),new te(7,46)),new ve(30,new te(1,23),new te(37,24)),new ve(30,new te(19,15),new te(26,16))),new bt(30,Int32Array.from([6,26,52,78,104,130]),new ve(30,new te(5,115),new te(10,116)),new ve(28,new te(19,47),new te(10,48)),new ve(30,new te(15,24),new te(25,25)),new ve(30,new te(23,15),new te(25,16))),new bt(31,Int32Array.from([6,30,56,82,108,134]),new ve(30,new te(13,115),new te(3,116)),new ve(28,new te(2,46),new te(29,47)),new ve(30,new te(42,24),new te(1,25)),new ve(30,new te(23,15),new te(28,16))),new bt(32,Int32Array.from([6,34,60,86,112,138]),new ve(30,new te(17,115)),new ve(28,new te(10,46),new te(23,47)),new ve(30,new te(10,24),new te(35,25)),new ve(30,new te(19,15),new te(35,16))),new bt(33,Int32Array.from([6,30,58,86,114,142]),new ve(30,new te(17,115),new te(1,116)),new ve(28,new te(14,46),new te(21,47)),new ve(30,new te(29,24),new te(19,25)),new ve(30,new te(11,15),new te(46,16))),new bt(34,Int32Array.from([6,34,62,90,118,146]),new ve(30,new te(13,115),new te(6,116)),new ve(28,new te(14,46),new te(23,47)),new ve(30,new te(44,24),new te(7,25)),new ve(30,new te(59,16),new te(1,17))),new bt(35,Int32Array.from([6,30,54,78,102,126,150]),new ve(30,new te(12,121),new te(7,122)),new ve(28,new te(12,47),new te(26,48)),new ve(30,new te(39,24),new te(14,25)),new ve(30,new te(22,15),new te(41,16))),new bt(36,Int32Array.from([6,24,50,76,102,128,154]),new ve(30,new te(6,121),new te(14,122)),new ve(28,new te(6,47),new te(34,48)),new ve(30,new te(46,24),new te(10,25)),new ve(30,new te(2,15),new te(64,16))),new bt(37,Int32Array.from([6,28,54,80,106,132,158]),new ve(30,new te(17,122),new te(4,123)),new ve(28,new te(29,46),new te(14,47)),new ve(30,new te(49,24),new te(10,25)),new ve(30,new te(24,15),new te(46,16))),new bt(38,Int32Array.from([6,32,58,84,110,136,162]),new ve(30,new te(4,122),new te(18,123)),new ve(28,new te(13,46),new te(32,47)),new ve(30,new te(48,24),new te(14,25)),new ve(30,new te(42,15),new te(32,16))),new bt(39,Int32Array.from([6,26,54,82,110,138,166]),new ve(30,new te(20,117),new te(4,118)),new ve(28,new te(40,47),new te(7,48)),new ve(30,new te(43,24),new te(22,25)),new ve(30,new te(10,15),new te(67,16))),new bt(40,Int32Array.from([6,30,58,86,114,142,170]),new ve(30,new te(19,118),new te(6,119)),new ve(28,new te(18,47),new te(31,48)),new ve(30,new te(34,24),new te(34,25)),new ve(30,new te(20,15),new te(61,16)))];var sr;(function(W){W[W.DATA_MASK_000=0]="DATA_MASK_000",W[W.DATA_MASK_001=1]="DATA_MASK_001",W[W.DATA_MASK_010=2]="DATA_MASK_010",W[W.DATA_MASK_011=3]="DATA_MASK_011",W[W.DATA_MASK_100=4]="DATA_MASK_100",W[W.DATA_MASK_101=5]="DATA_MASK_101",W[W.DATA_MASK_110=6]="DATA_MASK_110",W[W.DATA_MASK_111=7]="DATA_MASK_111"})(sr||(sr={}));class ii{constructor(f,p){this.value=f,this.isMasked=p}unmaskBitMatrix(f,p){for(let g=0;g<p;g++)for(let v=0;v<p;v++)this.isMasked(g,v)&&f.flip(v,g)}}ii.values=new Map([[sr.DATA_MASK_000,new ii(sr.DATA_MASK_000,(W,f)=>(W+f&1)===0)],[sr.DATA_MASK_001,new ii(sr.DATA_MASK_001,(W,f)=>(W&1)===0)],[sr.DATA_MASK_010,new ii(sr.DATA_MASK_010,(W,f)=>f%3===0)],[sr.DATA_MASK_011,new ii(sr.DATA_MASK_011,(W,f)=>(W+f)%3===0)],[sr.DATA_MASK_100,new ii(sr.DATA_MASK_100,(W,f)=>(Math.floor(W/2)+Math.floor(f/3)&1)===0)],[sr.DATA_MASK_101,new ii(sr.DATA_MASK_101,(W,f)=>W*f%6===0)],[sr.DATA_MASK_110,new ii(sr.DATA_MASK_110,(W,f)=>W*f%6<3)],[sr.DATA_MASK_111,new ii(sr.DATA_MASK_111,(W,f)=>(W+f+W*f%3&1)===0)]]);class pK{constructor(f){const p=f.getHeight();if(p<21||(p&3)!==1)throw new O;this.bitMatrix=f}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let f=0;for(let N=0;N<6;N++)f=this.copyBit(N,8,f);f=this.copyBit(7,8,f),f=this.copyBit(8,8,f),f=this.copyBit(8,7,f);for(let N=5;N>=0;N--)f=this.copyBit(8,N,f);const p=this.bitMatrix.getHeight();let g=0;const v=p-7;for(let N=p-1;N>=v;N--)g=this.copyBit(8,N,g);for(let N=p-8;N<p;N++)g=this.copyBit(N,8,g);if(this.parsedFormatInfo=Ot.decodeFormatInformation(f,g),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new O}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const f=this.bitMatrix.getHeight(),p=Math.floor((f-17)/4);if(p<=6)return bt.getVersionForNumber(p);let g=0;const v=f-11;for(let _=5;_>=0;_--)for(let E=f-9;E>=v;E--)g=this.copyBit(E,_,g);let N=bt.decodeVersionInformation(g);if(N!==null&&N.getDimensionForVersion()===f)return this.parsedVersion=N,N;g=0;for(let _=5;_>=0;_--)for(let E=f-9;E>=v;E--)g=this.copyBit(_,E,g);if(N=bt.decodeVersionInformation(g),N!==null&&N.getDimensionForVersion()===f)return this.parsedVersion=N,N;throw new O}copyBit(f,p,g){return(this.isMirror?this.bitMatrix.get(p,f):this.bitMatrix.get(f,p))?g<<1|1:g<<1}readCodewords(){const f=this.readFormatInformation(),p=this.readVersion(),g=ii.values.get(f.getDataMask()),v=this.bitMatrix.getHeight();g.unmaskBitMatrix(this.bitMatrix,v);const N=p.buildFunctionPattern();let _=!0;const E=new Uint8Array(p.getTotalCodewords());let M=0,F=0,U=0;for(let q=v-1;q>0;q-=2){q===6&&q--;for(let Q=0;Q<v;Q++){const se=_?v-1-Q:Q;for(let fe=0;fe<2;fe++)N.get(q-fe,se)||(U++,F<<=1,this.bitMatrix.get(q-fe,se)&&(F|=1),U===8&&(E[M++]=F,U=0,F=0))}_=!_}if(M!==p.getTotalCodewords())throw new O;return E}remask(){if(this.parsedFormatInfo===null)return;const f=ii.values[this.parsedFormatInfo.getDataMask()],p=this.bitMatrix.getHeight();f.unmaskBitMatrix(this.bitMatrix,p)}setMirror(f){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=f}mirror(){const f=this.bitMatrix;for(let p=0,g=f.getWidth();p<g;p++)for(let v=p+1,N=f.getHeight();v<N;v++)f.get(p,v)!==f.get(v,p)&&(f.flip(v,p),f.flip(p,v))}}class yw{constructor(f,p){this.numDataCodewords=f,this.codewords=p}static getDataBlocks(f,p,g){if(f.length!==p.getTotalCodewords())throw new m;const v=p.getECBlocksForLevel(g);let N=0;const _=v.getECBlocks();for(const fe of _)N+=fe.getCount();const E=new Array(N);let M=0;for(const fe of _)for(let me=0;me<fe.getCount();me++){const Ne=fe.getDataCodewords(),ke=v.getECCodewordsPerBlock()+Ne;E[M++]=new yw(Ne,new Uint8Array(ke))}const F=E[0].codewords.length;let U=E.length-1;for(;U>=0&&E[U].codewords.length!==F;)U--;U++;const q=F-v.getECCodewordsPerBlock();let Q=0;for(let fe=0;fe<q;fe++)for(let me=0;me<M;me++)E[me].codewords[fe]=f[Q++];for(let fe=U;fe<M;fe++)E[fe].codewords[q]=f[Q++];const se=E[0].codewords.length;for(let fe=q;fe<se;fe++)for(let me=0;me<M;me++){const Ne=me<U?fe:fe+1;E[me].codewords[Ne]=f[Q++]}return E}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var li;(function(W){W[W.TERMINATOR=0]="TERMINATOR",W[W.NUMERIC=1]="NUMERIC",W[W.ALPHANUMERIC=2]="ALPHANUMERIC",W[W.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",W[W.BYTE=4]="BYTE",W[W.ECI=5]="ECI",W[W.KANJI=6]="KANJI",W[W.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",W[W.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",W[W.HANZI=9]="HANZI"})(li||(li={}));class _t{constructor(f,p,g,v){this.value=f,this.stringValue=p,this.characterCountBitsForVersions=g,this.bits=v,_t.FOR_BITS.set(v,this),_t.FOR_VALUE.set(f,this)}static forBits(f){const p=_t.FOR_BITS.get(f);if(p===void 0)throw new m;return p}getCharacterCountBits(f){const p=f.getVersionNumber();let g;return p<=9?g=0:p<=26?g=1:g=2,this.characterCountBitsForVersions[g]}getValue(){return this.value}getBits(){return this.bits}equals(f){if(!(f instanceof _t))return!1;const p=f;return this.value===p.value}toString(){return this.stringValue}}_t.FOR_BITS=new Map,_t.FOR_VALUE=new Map,_t.TERMINATOR=new _t(li.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),_t.NUMERIC=new _t(li.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),_t.ALPHANUMERIC=new _t(li.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),_t.STRUCTURED_APPEND=new _t(li.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),_t.BYTE=new _t(li.BYTE,"BYTE",Int32Array.from([8,16,16]),4),_t.ECI=new _t(li.ECI,"ECI",Int32Array.from([0,0,0]),7),_t.KANJI=new _t(li.KANJI,"KANJI",Int32Array.from([8,10,12]),8),_t.FNC1_FIRST_POSITION=new _t(li.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),_t.FNC1_SECOND_POSITION=new _t(li.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),_t.HANZI=new _t(li.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Zn{static decode(f,p,g,v){const N=new qh(f);let _=new V;const E=new Array;let M=-1,F=-1;try{let U=null,q=!1,Q;do{if(N.available()<4)Q=_t.TERMINATOR;else{const se=N.readBits(4);Q=_t.forBits(se)}switch(Q){case _t.TERMINATOR:break;case _t.FNC1_FIRST_POSITION:case _t.FNC1_SECOND_POSITION:q=!0;break;case _t.STRUCTURED_APPEND:if(N.available()<16)throw new O;M=N.readBits(8),F=N.readBits(8);break;case _t.ECI:const se=Zn.parseECIValue(N);if(U=P.getCharacterSetECIByValue(se),U===null)throw new O;break;case _t.HANZI:const fe=N.readBits(4),me=N.readBits(Q.getCharacterCountBits(p));fe===Zn.GB2312_SUBSET&&Zn.decodeHanziSegment(N,_,me);break;default:const Ne=N.readBits(Q.getCharacterCountBits(p));switch(Q){case _t.NUMERIC:Zn.decodeNumericSegment(N,_,Ne);break;case _t.ALPHANUMERIC:Zn.decodeAlphanumericSegment(N,_,Ne,q);break;case _t.BYTE:Zn.decodeByteSegment(N,_,Ne,U,E,v);break;case _t.KANJI:Zn.decodeKanjiSegment(N,_,Ne);break;default:throw new O}break}}while(Q!==_t.TERMINATOR)}catch{throw new O}return new le(f,_.toString(),E.length===0?null:E,g===null?null:g.toString(),M,F)}static decodeHanziSegment(f,p,g){if(g*13>f.available())throw new O;const v=new Uint8Array(2*g);let N=0;for(;g>0;){const _=f.readBits(13);let E=_/96<<8&4294967295|_%96;E<959?E+=41377:E+=42657,v[N]=E>>8&255,v[N+1]=E&255,N+=2,g--}try{p.append($.decode(v,B.GB2312))}catch(_){throw new O(_)}}static decodeKanjiSegment(f,p,g){if(g*13>f.available())throw new O;const v=new Uint8Array(2*g);let N=0;for(;g>0;){const _=f.readBits(13);let E=_/192<<8&4294967295|_%192;E<7936?E+=33088:E+=49472,v[N]=E>>8,v[N+1]=E,N+=2,g--}try{p.append($.decode(v,B.SHIFT_JIS))}catch(_){throw new O(_)}}static decodeByteSegment(f,p,g,v,N,_){if(8*g>f.available())throw new O;const E=new Uint8Array(g);for(let F=0;F<g;F++)E[F]=f.readBits(8);let M;v===null?M=B.guessEncoding(E,_):M=v.getName();try{p.append($.decode(E,M))}catch(F){throw new O(F)}N.push(E)}static toAlphaNumericChar(f){if(f>=Zn.ALPHANUMERIC_CHARS.length)throw new O;return Zn.ALPHANUMERIC_CHARS[f]}static decodeAlphanumericSegment(f,p,g,v){const N=p.length();for(;g>1;){if(f.available()<11)throw new O;const _=f.readBits(11);p.append(Zn.toAlphaNumericChar(Math.floor(_/45))),p.append(Zn.toAlphaNumericChar(_%45)),g-=2}if(g===1){if(f.available()<6)throw new O;p.append(Zn.toAlphaNumericChar(f.readBits(6)))}if(v)for(let _=N;_<p.length();_++)p.charAt(_)==="%"&&(_<p.length()-1&&p.charAt(_+1)==="%"?p.deleteCharAt(_+1):p.setCharAt(_,""))}static decodeNumericSegment(f,p,g){for(;g>=3;){if(f.available()<10)throw new O;const v=f.readBits(10);if(v>=1e3)throw new O;p.append(Zn.toAlphaNumericChar(Math.floor(v/100))),p.append(Zn.toAlphaNumericChar(Math.floor(v/10)%10)),p.append(Zn.toAlphaNumericChar(v%10)),g-=3}if(g===2){if(f.available()<7)throw new O;const v=f.readBits(7);if(v>=100)throw new O;p.append(Zn.toAlphaNumericChar(Math.floor(v/10))),p.append(Zn.toAlphaNumericChar(v%10))}else if(g===1){if(f.available()<4)throw new O;const v=f.readBits(4);if(v>=10)throw new O;p.append(Zn.toAlphaNumericChar(v))}}static parseECIValue(f){const p=f.readBits(8);if(!(p&128))return p&127;if((p&192)===128){const g=f.readBits(8);return(p&63)<<8&4294967295|g}if((p&224)===192){const g=f.readBits(16);return(p&31)<<16&4294967295|g}throw new O}}Zn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Zn.GB2312_SUBSET=1;class l5{constructor(f){this.mirrored=f}isMirrored(){return this.mirrored}applyMirroredCorrection(f){if(!this.mirrored||f===null||f.length<3)return;const p=f[0];f[0]=f[2],f[2]=p}}class xK{constructor(){this.rsDecoder=new jt(Ve.QR_CODE_FIELD_256)}decodeBooleanArray(f,p){return this.decodeBitMatrix(K.parseFromBooleanArray(f),p)}decodeBitMatrix(f,p){const g=new pK(f);let v=null;try{return this.decodeBitMatrixParser(g,p)}catch(N){v=N}try{g.remask(),g.setMirror(!0),g.readVersion(),g.readFormatInformation(),g.mirror();const N=this.decodeBitMatrixParser(g,p);return N.setOther(new l5(!0)),N}catch(N){throw v!==null?v:N}}decodeBitMatrixParser(f,p){const g=f.readVersion(),v=f.readFormatInformation().getErrorCorrectionLevel(),N=f.readCodewords(),_=yw.getDataBlocks(N,g,v);let E=0;for(const U of _)E+=U.getNumDataCodewords();const M=new Uint8Array(E);let F=0;for(const U of _){const q=U.getCodewords(),Q=U.getNumDataCodewords();this.correctErrors(q,Q);for(let se=0;se<Q;se++)M[F++]=q[se]}return Zn.decode(M,g,v,p)}correctErrors(f,p){const g=new Int32Array(f);try{this.rsDecoder.decode(g,f.length-p)}catch{throw new b}for(let v=0;v<p;v++)f[v]=g[v]}}class bw extends ue{constructor(f,p,g){super(f,p),this.estimatedModuleSize=g}aboutEquals(f,p,g){if(Math.abs(p-this.getY())<=f&&Math.abs(g-this.getX())<=f){const v=Math.abs(f-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(f,p,g){const v=(this.getX()+p)/2,N=(this.getY()+f)/2,_=(this.estimatedModuleSize+g)/2;return new bw(v,N,_)}}class Kx{constructor(f,p,g,v,N,_,E){this.image=f,this.startX=p,this.startY=g,this.width=v,this.height=N,this.moduleSize=_,this.resultPointCallback=E,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const f=this.startX,p=this.height,g=this.width,v=f+g,N=this.startY+p/2,_=new Int32Array(3),E=this.image;for(let M=0;M<p;M++){const F=N+(M&1?-Math.floor((M+1)/2):Math.floor((M+1)/2));_[0]=0,_[1]=0,_[2]=0;let U=f;for(;U<v&&!E.get(U,F);)U++;let q=0;for(;U<v;){if(E.get(U,F))if(q===1)_[1]++;else if(q===2){if(this.foundPatternCross(_)){const Q=this.handlePossibleCenter(_,F,U);if(Q!==null)return Q}_[0]=_[2],_[1]=1,_[2]=0,q=1}else _[++q]++;else q===1&&q++,_[q]++;U++}if(this.foundPatternCross(_)){const Q=this.handlePossibleCenter(_,F,v);if(Q!==null)return Q}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new z}static centerFromEnd(f,p){return p-f[2]-f[1]/2}foundPatternCross(f){const p=this.moduleSize,g=p/2;for(let v=0;v<3;v++)if(Math.abs(p-f[v])>=g)return!1;return!0}crossCheckVertical(f,p,g,v){const N=this.image,_=N.getHeight(),E=this.crossCheckStateCount;E[0]=0,E[1]=0,E[2]=0;let M=f;for(;M>=0&&N.get(p,M)&&E[1]<=g;)E[1]++,M--;if(M<0||E[1]>g)return NaN;for(;M>=0&&!N.get(p,M)&&E[0]<=g;)E[0]++,M--;if(E[0]>g)return NaN;for(M=f+1;M<_&&N.get(p,M)&&E[1]<=g;)E[1]++,M++;if(M===_||E[1]>g)return NaN;for(;M<_&&!N.get(p,M)&&E[2]<=g;)E[2]++,M++;if(E[2]>g)return NaN;const F=E[0]+E[1]+E[2];return 5*Math.abs(F-v)>=2*v?NaN:this.foundPatternCross(E)?Kx.centerFromEnd(E,M):NaN}handlePossibleCenter(f,p,g){const v=f[0]+f[1]+f[2],N=Kx.centerFromEnd(f,g),_=this.crossCheckVertical(p,N,2*f[1],v);if(!isNaN(_)){const E=(f[0]+f[1]+f[2])/3;for(const F of this.possibleCenters)if(F.aboutEquals(E,_,N))return F.combineEstimate(_,N,E);const M=new bw(N,_,E);this.possibleCenters.push(M),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(M)}return null}}class vw extends ue{constructor(f,p,g,v){super(f,p),this.estimatedModuleSize=g,this.count=v,v===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(f,p,g){if(Math.abs(p-this.getY())<=f&&Math.abs(g-this.getX())<=f){const v=Math.abs(f-this.estimatedModuleSize);return v<=1||v<=this.estimatedModuleSize}return!1}combineEstimate(f,p,g){const v=this.count+1,N=(this.count*this.getX()+p)/v,_=(this.count*this.getY()+f)/v,E=(this.count*this.estimatedModuleSize+g)/v;return new vw(N,_,E,v)}}class gK{constructor(f){this.bottomLeft=f[0],this.topLeft=f[1],this.topRight=f[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class rr{constructor(f,p){this.image=f,this.resultPointCallback=p,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=p}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(f){const p=f!=null&&f.get(D.TRY_HARDER)!==void 0,g=f!=null&&f.get(D.PURE_BARCODE)!==void 0,v=this.image,N=v.getHeight(),_=v.getWidth();let E=Math.floor(3*N/(4*rr.MAX_MODULES));(E<rr.MIN_SKIP||p)&&(E=rr.MIN_SKIP);let M=!1;const F=new Int32Array(5);for(let q=E-1;q<N&&!M;q+=E){F[0]=0,F[1]=0,F[2]=0,F[3]=0,F[4]=0;let Q=0;for(let se=0;se<_;se++)if(v.get(se,q))(Q&1)===1&&Q++,F[Q]++;else if(Q&1)F[Q]++;else if(Q===4)if(rr.foundPatternCross(F)){if(this.handlePossibleCenter(F,q,se,g)===!0)if(E=2,this.hasSkipped===!0)M=this.haveMultiplyConfirmedCenters();else{const me=this.findRowSkip();me>F[2]&&(q+=me-F[2]-E,se=_-1)}else{F[0]=F[2],F[1]=F[3],F[2]=F[4],F[3]=1,F[4]=0,Q=3;continue}Q=0,F[0]=0,F[1]=0,F[2]=0,F[3]=0,F[4]=0}else F[0]=F[2],F[1]=F[3],F[2]=F[4],F[3]=1,F[4]=0,Q=3;else F[++Q]++;rr.foundPatternCross(F)&&this.handlePossibleCenter(F,q,_,g)===!0&&(E=F[0],this.hasSkipped&&(M=this.haveMultiplyConfirmedCenters()))}const U=this.selectBestPatterns();return ue.orderBestPatterns(U),new gK(U)}static centerFromEnd(f,p){return p-f[4]-f[3]-f[2]/2}static foundPatternCross(f){let p=0;for(let N=0;N<5;N++){const _=f[N];if(_===0)return!1;p+=_}if(p<7)return!1;const g=p/7,v=g/2;return Math.abs(g-f[0])<v&&Math.abs(g-f[1])<v&&Math.abs(3*g-f[2])<3*v&&Math.abs(g-f[3])<v&&Math.abs(g-f[4])<v}getCrossCheckStateCount(){const f=this.crossCheckStateCount;return f[0]=0,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f}crossCheckDiagonal(f,p,g,v){const N=this.getCrossCheckStateCount();let _=0;const E=this.image;for(;f>=_&&p>=_&&E.get(p-_,f-_);)N[2]++,_++;if(f<_||p<_)return!1;for(;f>=_&&p>=_&&!E.get(p-_,f-_)&&N[1]<=g;)N[1]++,_++;if(f<_||p<_||N[1]>g)return!1;for(;f>=_&&p>=_&&E.get(p-_,f-_)&&N[0]<=g;)N[0]++,_++;if(N[0]>g)return!1;const M=E.getHeight(),F=E.getWidth();for(_=1;f+_<M&&p+_<F&&E.get(p+_,f+_);)N[2]++,_++;if(f+_>=M||p+_>=F)return!1;for(;f+_<M&&p+_<F&&!E.get(p+_,f+_)&&N[3]<g;)N[3]++,_++;if(f+_>=M||p+_>=F||N[3]>=g)return!1;for(;f+_<M&&p+_<F&&E.get(p+_,f+_)&&N[4]<g;)N[4]++,_++;if(N[4]>=g)return!1;const U=N[0]+N[1]+N[2]+N[3]+N[4];return Math.abs(U-v)<2*v&&rr.foundPatternCross(N)}crossCheckVertical(f,p,g,v){const N=this.image,_=N.getHeight(),E=this.getCrossCheckStateCount();let M=f;for(;M>=0&&N.get(p,M);)E[2]++,M--;if(M<0)return NaN;for(;M>=0&&!N.get(p,M)&&E[1]<=g;)E[1]++,M--;if(M<0||E[1]>g)return NaN;for(;M>=0&&N.get(p,M)&&E[0]<=g;)E[0]++,M--;if(E[0]>g)return NaN;for(M=f+1;M<_&&N.get(p,M);)E[2]++,M++;if(M===_)return NaN;for(;M<_&&!N.get(p,M)&&E[3]<g;)E[3]++,M++;if(M===_||E[3]>=g)return NaN;for(;M<_&&N.get(p,M)&&E[4]<g;)E[4]++,M++;if(E[4]>=g)return NaN;const F=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(F-v)>=2*v?NaN:rr.foundPatternCross(E)?rr.centerFromEnd(E,M):NaN}crossCheckHorizontal(f,p,g,v){const N=this.image,_=N.getWidth(),E=this.getCrossCheckStateCount();let M=f;for(;M>=0&&N.get(M,p);)E[2]++,M--;if(M<0)return NaN;for(;M>=0&&!N.get(M,p)&&E[1]<=g;)E[1]++,M--;if(M<0||E[1]>g)return NaN;for(;M>=0&&N.get(M,p)&&E[0]<=g;)E[0]++,M--;if(E[0]>g)return NaN;for(M=f+1;M<_&&N.get(M,p);)E[2]++,M++;if(M===_)return NaN;for(;M<_&&!N.get(M,p)&&E[3]<g;)E[3]++,M++;if(M===_||E[3]>=g)return NaN;for(;M<_&&N.get(M,p)&&E[4]<g;)E[4]++,M++;if(E[4]>=g)return NaN;const F=E[0]+E[1]+E[2]+E[3]+E[4];return 5*Math.abs(F-v)>=v?NaN:rr.foundPatternCross(E)?rr.centerFromEnd(E,M):NaN}handlePossibleCenter(f,p,g,v){const N=f[0]+f[1]+f[2]+f[3]+f[4];let _=rr.centerFromEnd(f,g),E=this.crossCheckVertical(p,Math.floor(_),f[2],N);if(!isNaN(E)&&(_=this.crossCheckHorizontal(Math.floor(_),Math.floor(E),f[2],N),!isNaN(_)&&(!v||this.crossCheckDiagonal(Math.floor(E),Math.floor(_),f[2],N)))){const M=N/7;let F=!1;const U=this.possibleCenters;for(let q=0,Q=U.length;q<Q;q++){const se=U[q];if(se.aboutEquals(M,E,_)){U[q]=se.combineEstimate(E,_,M),F=!0;break}}if(!F){const q=new vw(_,E,M);U.push(q),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(q)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let p=null;for(const g of this.possibleCenters)if(g.getCount()>=rr.CENTER_QUORUM)if(p==null)p=g;else return this.hasSkipped=!0,Math.floor((Math.abs(p.getX()-g.getX())-Math.abs(p.getY()-g.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let f=0,p=0;const g=this.possibleCenters.length;for(const _ of this.possibleCenters)_.getCount()>=rr.CENTER_QUORUM&&(f++,p+=_.getEstimatedModuleSize());if(f<3)return!1;const v=p/g;let N=0;for(const _ of this.possibleCenters)N+=Math.abs(_.getEstimatedModuleSize()-v);return N<=.05*p}selectBestPatterns(){const f=this.possibleCenters.length;if(f<3)throw new z;const p=this.possibleCenters;let g;if(f>3){let v=0,N=0;for(const M of this.possibleCenters){const F=M.getEstimatedModuleSize();v+=F,N+=F*F}g=v/f;let _=Math.sqrt(N/f-g*g);p.sort((M,F)=>{const U=Math.abs(F.getEstimatedModuleSize()-g),q=Math.abs(M.getEstimatedModuleSize()-g);return U<q?-1:U>q?1:0});const E=Math.max(.2*g,_);for(let M=0;M<p.length&&p.length>3;M++){const F=p[M];Math.abs(F.getEstimatedModuleSize()-g)>E&&(p.splice(M,1),M--)}}if(p.length>3){let v=0;for(const N of p)v+=N.getEstimatedModuleSize();g=v/p.length,p.sort((N,_)=>{if(_.getCount()===N.getCount()){const E=Math.abs(_.getEstimatedModuleSize()-g),M=Math.abs(N.getEstimatedModuleSize()-g);return E<M?1:E>M?-1:0}else return _.getCount()-N.getCount()}),p.splice(3)}return[p[0],p[1],p[2]]}}rr.CENTER_QUORUM=2,rr.MIN_SKIP=3,rr.MAX_MODULES=57;class Gh{constructor(f){this.image=f}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(f){this.resultPointCallback=f==null?null:f.get(D.NEED_RESULT_POINT_CALLBACK);const g=new rr(this.image,this.resultPointCallback).find(f);return this.processFinderPatternInfo(g)}processFinderPatternInfo(f){const p=f.getTopLeft(),g=f.getTopRight(),v=f.getBottomLeft(),N=this.calculateModuleSize(p,g,v);if(N<1)throw new z("No pattern found in proccess finder.");const _=Gh.computeDimension(p,g,v,N),E=bt.getProvisionalVersionForDimension(_),M=E.getDimensionForVersion()-7;let F=null;if(E.getAlignmentPatternCenters().length>0){const se=g.getX()-p.getX()+v.getX(),fe=g.getY()-p.getY()+v.getY(),me=1-3/M,Ne=Math.floor(p.getX()+me*(se-p.getX())),ke=Math.floor(p.getY()+me*(fe-p.getY()));for(let We=4;We<=16;We<<=1)try{F=this.findAlignmentInRegion(N,Ne,ke,We);break}catch(Ke){if(!(Ke instanceof z))throw Ke}}const U=Gh.createTransform(p,g,v,F,_),q=Gh.sampleGrid(this.image,U,_);let Q;return F===null?Q=[v,p,g]:Q=[v,p,g,F],new De(q,Q)}static createTransform(f,p,g,v,N){const _=N-3.5;let E,M,F,U;return v!==null?(E=v.getX(),M=v.getY(),F=_-3,U=F):(E=p.getX()-f.getX()+g.getX(),M=p.getY()-f.getY()+g.getY(),F=_,U=_),Dt.quadrilateralToQuadrilateral(3.5,3.5,_,3.5,F,U,3.5,_,f.getX(),f.getY(),p.getX(),p.getY(),E,M,g.getX(),g.getY())}static sampleGrid(f,p,g){return yn.getInstance().sampleGridWithTransform(f,g,g,p)}static computeDimension(f,p,g,v){const N=qe.round(ue.distance(f,p)/v),_=qe.round(ue.distance(f,g)/v);let E=Math.floor((N+_)/2)+7;switch(E&3){case 0:E++;break;case 2:E--;break;case 3:throw new z("Dimensions could be not found.")}return E}calculateModuleSize(f,p,g){return(this.calculateModuleSizeOneWay(f,p)+this.calculateModuleSizeOneWay(f,g))/2}calculateModuleSizeOneWay(f,p){const g=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(f.getX()),Math.floor(f.getY()),Math.floor(p.getX()),Math.floor(p.getY())),v=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(p.getX()),Math.floor(p.getY()),Math.floor(f.getX()),Math.floor(f.getY()));return isNaN(g)?v/7:isNaN(v)?g/7:(g+v)/14}sizeOfBlackWhiteBlackRunBothWays(f,p,g,v){let N=this.sizeOfBlackWhiteBlackRun(f,p,g,v),_=1,E=f-(g-f);E<0?(_=f/(f-E),E=0):E>=this.image.getWidth()&&(_=(this.image.getWidth()-1-f)/(E-f),E=this.image.getWidth()-1);let M=Math.floor(p-(v-p)*_);return _=1,M<0?(_=p/(p-M),M=0):M>=this.image.getHeight()&&(_=(this.image.getHeight()-1-p)/(M-p),M=this.image.getHeight()-1),E=Math.floor(f+(E-f)*_),N+=this.sizeOfBlackWhiteBlackRun(f,p,E,M),N-1}sizeOfBlackWhiteBlackRun(f,p,g,v){const N=Math.abs(v-p)>Math.abs(g-f);if(N){let se=f;f=p,p=se,se=g,g=v,v=se}const _=Math.abs(g-f),E=Math.abs(v-p);let M=-_/2;const F=f<g?1:-1,U=p<v?1:-1;let q=0;const Q=g+F;for(let se=f,fe=p;se!==Q;se+=F){const me=N?fe:se,Ne=N?se:fe;if(q===1===this.image.get(me,Ne)){if(q===2)return qe.distance(se,fe,f,p);q++}if(M+=E,M>0){if(fe===v)break;fe+=U,M-=_}}return q===2?qe.distance(g+F,v,f,p):NaN}findAlignmentInRegion(f,p,g,v){const N=Math.floor(v*f),_=Math.max(0,p-N),E=Math.min(this.image.getWidth()-1,p+N);if(E-_<f*3)throw new z("Alignment top exceeds estimated module size.");const M=Math.max(0,g-N),F=Math.min(this.image.getHeight()-1,g+N);if(F-M<f*3)throw new z("Alignment bottom exceeds estimated module size.");return new Kx(this.image,_,M,E-_,F-M,f,this.resultPointCallback).find()}}class Go{constructor(){this.decoder=new xK}getDecoder(){return this.decoder}decode(f,p){let g,v;if(p!=null&&p.get(D.PURE_BARCODE)!==void 0){const M=Go.extractPureBits(f.getBlackMatrix());g=this.decoder.decodeBitMatrix(M,p),v=Go.NO_POINTS}else{const M=new Gh(f.getBlackMatrix()).detect(p);g=this.decoder.decodeBitMatrix(M.getBits(),p),v=M.getPoints()}g.getOther()instanceof l5&&g.getOther().applyMirroredCorrection(v);const N=new be(g.getText(),g.getRawBytes(),void 0,v,Z.QR_CODE,void 0),_=g.getByteSegments();_!==null&&N.putMetadata(Te.BYTE_SEGMENTS,_);const E=g.getECLevel();return E!==null&&N.putMetadata(Te.ERROR_CORRECTION_LEVEL,E),g.hasStructuredAppend()&&(N.putMetadata(Te.STRUCTURED_APPEND_SEQUENCE,g.getStructuredAppendSequenceNumber()),N.putMetadata(Te.STRUCTURED_APPEND_PARITY,g.getStructuredAppendParity())),N}reset(){}static extractPureBits(f){const p=f.getTopLeftOnBit(),g=f.getBottomRightOnBit();if(p===null||g===null)throw new z;const v=this.moduleSize(p,f);let N=p[1],_=g[1],E=p[0],M=g[0];if(E>=M||N>=_)throw new z;if(_-N!==M-E&&(M=E+(_-N),M>=f.getWidth()))throw new z;const F=Math.round((M-E+1)/v),U=Math.round((_-N+1)/v);if(F<=0||U<=0)throw new z;if(U!==F)throw new z;const q=Math.floor(v/2);N+=q,E+=q;const Q=E+Math.floor((F-1)*v)-M;if(Q>0){if(Q>q)throw new z;E-=Q}const se=N+Math.floor((U-1)*v)-_;if(se>0){if(se>q)throw new z;N-=se}const fe=new K(F,U);for(let me=0;me<U;me++){const Ne=N+Math.floor(me*v);for(let ke=0;ke<F;ke++)f.get(E+Math.floor(ke*v),Ne)&&fe.set(ke,me)}return fe}static moduleSize(f,p){const g=p.getHeight(),v=p.getWidth();let N=f[0],_=f[1],E=!0,M=0;for(;N<v&&_<g;){if(E!==p.get(N,_)){if(++M===5)break;E=!E}N++,_++}if(N===v||_===g)throw new z;return(N-f[0])/7}}Go.NO_POINTS=new Array;class Pt{PDF417Common(){}static getBitCountSum(f){return qe.sum(f)}static toIntArray(f){if(f==null||!f.length)return Pt.EMPTY_INT_ARRAY;const p=new Int32Array(f.length);let g=0;for(const v of f)p[g++]=v;return p}static getCodeword(f){const p=A.binarySearch(Pt.SYMBOL_TABLE,f&262143);return p<0?-1:(Pt.CODEWORD_TABLE[p]-1)%Pt.NUMBER_OF_CODEWORDS}}Pt.NUMBER_OF_CODEWORDS=929,Pt.MAX_CODEWORDS_IN_BARCODE=Pt.NUMBER_OF_CODEWORDS-1,Pt.MIN_ROWS_IN_BARCODE=3,Pt.MAX_ROWS_IN_BARCODE=90,Pt.MODULES_IN_CODEWORD=17,Pt.MODULES_IN_STOP_PATTERN=18,Pt.BARS_IN_MODULE=8,Pt.EMPTY_INT_ARRAY=new Int32Array([]),Pt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Pt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class yK{constructor(f,p){this.bits=f,this.points=p}getBits(){return this.bits}getPoints(){return this.points}}class Ht{static detectMultiple(f,p,g){let v=f.getBlackMatrix(),N=Ht.detect(g,v);return N.length||(v=v.clone(),v.rotate180(),N=Ht.detect(g,v)),new yK(v,N)}static detect(f,p){const g=new Array;let v=0,N=0,_=!1;for(;v<p.getHeight();){const E=Ht.findVertices(p,v,N);if(E[0]==null&&E[3]==null){if(!_)break;_=!1,N=0;for(const M of g)M[1]!=null&&(v=Math.trunc(Math.max(v,M[1].getY()))),M[3]!=null&&(v=Math.max(v,Math.trunc(M[3].getY())));v+=Ht.ROW_STEP;continue}if(_=!0,g.push(E),!f)break;E[2]!=null?(N=Math.trunc(E[2].getX()),v=Math.trunc(E[2].getY())):(N=Math.trunc(E[4].getX()),v=Math.trunc(E[4].getY()))}return g}static findVertices(f,p,g){const v=f.getHeight(),N=f.getWidth(),_=new Array(8);return Ht.copyToResult(_,Ht.findRowsWithPattern(f,v,N,p,g,Ht.START_PATTERN),Ht.INDEXES_START_PATTERN),_[4]!=null&&(g=Math.trunc(_[4].getX()),p=Math.trunc(_[4].getY())),Ht.copyToResult(_,Ht.findRowsWithPattern(f,v,N,p,g,Ht.STOP_PATTERN),Ht.INDEXES_STOP_PATTERN),_}static copyToResult(f,p,g){for(let v=0;v<g.length;v++)f[g[v]]=p[v]}static findRowsWithPattern(f,p,g,v,N,_){const E=new Array(4);let M=!1;const F=new Int32Array(_.length);for(;v<p;v+=Ht.ROW_STEP){let q=Ht.findGuardPattern(f,N,v,g,!1,_,F);if(q!=null){for(;v>0;){const Q=Ht.findGuardPattern(f,N,--v,g,!1,_,F);if(Q!=null)q=Q;else{v++;break}}E[0]=new ue(q[0],v),E[1]=new ue(q[1],v),M=!0;break}}let U=v+1;if(M){let q=0,Q=Int32Array.from([Math.trunc(E[0].getX()),Math.trunc(E[1].getX())]);for(;U<p;U++){const se=Ht.findGuardPattern(f,Q[0],U,g,!1,_,F);if(se!=null&&Math.abs(Q[0]-se[0])<Ht.MAX_PATTERN_DRIFT&&Math.abs(Q[1]-se[1])<Ht.MAX_PATTERN_DRIFT)Q=se,q=0;else{if(q>Ht.SKIPPED_ROW_COUNT_MAX)break;q++}}U-=q+1,E[2]=new ue(Q[0],U),E[3]=new ue(Q[1],U)}return U-v<Ht.BARCODE_MIN_HEIGHT&&A.fill(E,null),E}static findGuardPattern(f,p,g,v,N,_,E){A.fillWithin(E,0,E.length,0);let M=p,F=0;for(;f.get(M,g)&&M>0&&F++<Ht.MAX_PIXEL_DRIFT;)M--;let U=M,q=0,Q=_.length;for(let se=N;U<v;U++)if(f.get(U,g)!==se)E[q]++;else{if(q===Q-1){if(Ht.patternMatchVariance(E,_,Ht.MAX_INDIVIDUAL_VARIANCE)<Ht.MAX_AVG_VARIANCE)return new Int32Array([M,U]);M+=E[0]+E[1],j.arraycopy(E,2,E,0,q-1),E[q-1]=0,E[q]=0,q--}else q++;E[q]=1,se=!se}return q===Q-1&&Ht.patternMatchVariance(E,_,Ht.MAX_INDIVIDUAL_VARIANCE)<Ht.MAX_AVG_VARIANCE?new Int32Array([M,U-1]):null}static patternMatchVariance(f,p,g){let v=f.length,N=0,_=0;for(let F=0;F<v;F++)N+=f[F],_+=p[F];if(N<_)return 1/0;let E=N/_;g*=E;let M=0;for(let F=0;F<v;F++){let U=f[F],q=p[F]*E,Q=U>q?U-q:q-U;if(Q>g)return 1/0;M+=Q}return M/N}}Ht.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ht.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ht.MAX_AVG_VARIANCE=.42,Ht.MAX_INDIVIDUAL_VARIANCE=.8,Ht.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ht.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ht.MAX_PIXEL_DRIFT=3,Ht.MAX_PATTERN_DRIFT=5,Ht.SKIPPED_ROW_COUNT_MAX=25,Ht.ROW_STEP=5,Ht.BARCODE_MIN_HEIGHT=10;class pr{constructor(f,p){if(p.length===0)throw new m;this.field=f;let g=p.length;if(g>1&&p[0]===0){let v=1;for(;v<g&&p[v]===0;)v++;v===g?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(g-v),j.arraycopy(p,v,this.coefficients,0,this.coefficients.length))}else this.coefficients=p}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(f){return this.coefficients[this.coefficients.length-1-f]}evaluateAt(f){if(f===0)return this.getCoefficient(0);if(f===1){let v=0;for(let N of this.coefficients)v=this.field.add(v,N);return v}let p=this.coefficients[0],g=this.coefficients.length;for(let v=1;v<g;v++)p=this.field.add(this.field.multiply(f,p),this.coefficients[v]);return p}add(f){if(!this.field.equals(f.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero())return f;if(f.isZero())return this;let p=this.coefficients,g=f.coefficients;if(p.length>g.length){let _=p;p=g,g=_}let v=new Int32Array(g.length),N=g.length-p.length;j.arraycopy(g,0,v,0,N);for(let _=N;_<g.length;_++)v[_]=this.field.add(p[_-N],g[_]);return new pr(this.field,v)}subtract(f){if(!this.field.equals(f.field))throw new m("ModulusPolys do not have same ModulusGF field");return f.isZero()?this:this.add(f.negative())}multiply(f){return f instanceof pr?this.multiplyOther(f):this.multiplyScalar(f)}multiplyOther(f){if(!this.field.equals(f.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero()||f.isZero())return new pr(this.field,new Int32Array([0]));let p=this.coefficients,g=p.length,v=f.coefficients,N=v.length,_=new Int32Array(g+N-1);for(let E=0;E<g;E++){let M=p[E];for(let F=0;F<N;F++)_[E+F]=this.field.add(_[E+F],this.field.multiply(M,v[F]))}return new pr(this.field,_)}negative(){let f=this.coefficients.length,p=new Int32Array(f);for(let g=0;g<f;g++)p[g]=this.field.subtract(0,this.coefficients[g]);return new pr(this.field,p)}multiplyScalar(f){if(f===0)return new pr(this.field,new Int32Array([0]));if(f===1)return this;let p=this.coefficients.length,g=new Int32Array(p);for(let v=0;v<p;v++)g[v]=this.field.multiply(this.coefficients[v],f);return new pr(this.field,g)}multiplyByMonomial(f,p){if(f<0)throw new m;if(p===0)return new pr(this.field,new Int32Array([0]));let g=this.coefficients.length,v=new Int32Array(g+f);for(let N=0;N<g;N++)v[N]=this.field.multiply(this.coefficients[N],p);return new pr(this.field,v)}toString(){let f=new V;for(let p=this.getDegree();p>=0;p--){let g=this.getCoefficient(p);g!==0&&(g<0?(f.append(" - "),g=-g):f.length()>0&&f.append(" + "),(p===0||g!==1)&&f.append(g),p!==0&&(p===1?f.append("x"):(f.append("x^"),f.append(p))))}return f.toString()}}class bK{add(f,p){return(f+p)%this.modulus}subtract(f,p){return(this.modulus+f-p)%this.modulus}exp(f){return this.expTable[f]}log(f){if(f===0)throw new m;return this.logTable[f]}inverse(f){if(f===0)throw new ae;return this.expTable[this.modulus-this.logTable[f]-1]}multiply(f,p){return f===0||p===0?0:this.expTable[(this.logTable[f]+this.logTable[p])%(this.modulus-1)]}getSize(){return this.modulus}equals(f){return f===this}}class ww extends bK{constructor(f,p){super(),this.modulus=f,this.expTable=new Int32Array(f),this.logTable=new Int32Array(f);let g=1;for(let v=0;v<f;v++)this.expTable[v]=g,g=g*p%f;for(let v=0;v<f-1;v++)this.logTable[this.expTable[v]]=v;this.zero=new pr(this,new Int32Array([0])),this.one=new pr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(f,p){if(f<0)throw new m;if(p===0)return this.zero;let g=new Int32Array(f+1);return g[0]=p,new pr(this,g)}}ww.PDF417_GF=new ww(Pt.NUMBER_OF_CODEWORDS,3);class o5{constructor(){this.field=ww.PDF417_GF}decode(f,p,g){let v=new pr(this.field,f),N=new Int32Array(p),_=!1;for(let fe=p;fe>0;fe--){let me=v.evaluateAt(this.field.exp(fe));N[p-fe]=me,me!==0&&(_=!0)}if(!_)return 0;let E=this.field.getOne();if(g!=null)for(const fe of g){let me=this.field.exp(f.length-1-fe),Ne=new pr(this.field,new Int32Array([this.field.subtract(0,me),1]));E=E.multiply(Ne)}let M=new pr(this.field,N),F=this.runEuclideanAlgorithm(this.field.buildMonomial(p,1),M,p),U=F[0],q=F[1],Q=this.findErrorLocations(U),se=this.findErrorMagnitudes(q,U,Q);for(let fe=0;fe<Q.length;fe++){let me=f.length-1-this.field.log(Q[fe]);if(me<0)throw b.getChecksumInstance();f[me]=this.field.subtract(f[me],se[fe])}return Q.length}runEuclideanAlgorithm(f,p,g){if(f.getDegree()<p.getDegree()){let Q=f;f=p,p=Q}let v=f,N=p,_=this.field.getZero(),E=this.field.getOne();for(;N.getDegree()>=Math.round(g/2);){let Q=v,se=_;if(v=N,_=E,v.isZero())throw b.getChecksumInstance();N=Q;let fe=this.field.getZero(),me=v.getCoefficient(v.getDegree()),Ne=this.field.inverse(me);for(;N.getDegree()>=v.getDegree()&&!N.isZero();){let ke=N.getDegree()-v.getDegree(),We=this.field.multiply(N.getCoefficient(N.getDegree()),Ne);fe=fe.add(this.field.buildMonomial(ke,We)),N=N.subtract(v.multiplyByMonomial(ke,We))}E=fe.multiply(_).subtract(se).negative()}let M=E.getCoefficient(0);if(M===0)throw b.getChecksumInstance();let F=this.field.inverse(M),U=E.multiply(F),q=N.multiply(F);return[U,q]}findErrorLocations(f){let p=f.getDegree(),g=new Int32Array(p),v=0;for(let N=1;N<this.field.getSize()&&v<p;N++)f.evaluateAt(N)===0&&(g[v]=this.field.inverse(N),v++);if(v!==p)throw b.getChecksumInstance();return g}findErrorMagnitudes(f,p,g){let v=p.getDegree(),N=new Int32Array(v);for(let F=1;F<=v;F++)N[v-F]=this.field.multiply(F,p.getCoefficient(F));let _=new pr(this.field,N),E=g.length,M=new Int32Array(E);for(let F=0;F<E;F++){let U=this.field.inverse(g[F]),q=this.field.subtract(0,f.evaluateAt(U)),Q=this.field.inverse(_.evaluateAt(U));M[F]=this.field.multiply(q,Q)}return M}}class fd{constructor(f,p,g,v,N){f instanceof fd?this.constructor_2(f):this.constructor_1(f,p,g,v,N)}constructor_1(f,p,g,v,N){const _=p==null||g==null,E=v==null||N==null;if(_&&E)throw new z;_?(p=new ue(0,v.getY()),g=new ue(0,N.getY())):E&&(v=new ue(f.getWidth()-1,p.getY()),N=new ue(f.getWidth()-1,g.getY())),this.image=f,this.topLeft=p,this.bottomLeft=g,this.topRight=v,this.bottomRight=N,this.minX=Math.trunc(Math.min(p.getX(),g.getX())),this.maxX=Math.trunc(Math.max(v.getX(),N.getX())),this.minY=Math.trunc(Math.min(p.getY(),v.getY())),this.maxY=Math.trunc(Math.max(g.getY(),N.getY()))}constructor_2(f){this.image=f.image,this.topLeft=f.getTopLeft(),this.bottomLeft=f.getBottomLeft(),this.topRight=f.getTopRight(),this.bottomRight=f.getBottomRight(),this.minX=f.getMinX(),this.maxX=f.getMaxX(),this.minY=f.getMinY(),this.maxY=f.getMaxY()}static merge(f,p){return f==null?p:p==null?f:new fd(f.image,f.topLeft,f.bottomLeft,p.topRight,p.bottomRight)}addMissingRows(f,p,g){let v=this.topLeft,N=this.bottomLeft,_=this.topRight,E=this.bottomRight;if(f>0){let M=g?this.topLeft:this.topRight,F=Math.trunc(M.getY()-f);F<0&&(F=0);let U=new ue(M.getX(),F);g?v=U:_=U}if(p>0){let M=g?this.bottomLeft:this.bottomRight,F=Math.trunc(M.getY()+p);F>=this.image.getHeight()&&(F=this.image.getHeight()-1);let U=new ue(M.getX(),F);g?N=U:E=U}return new fd(this.image,v,N,_,E)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class vK{constructor(f,p,g,v){this.columnCount=f,this.errorCorrectionLevel=v,this.rowCountUpperPart=p,this.rowCountLowerPart=g,this.rowCount=p+g}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Kh{constructor(){this.buffer=""}static form(f,p){let g=-1;function v(_,E,M,F,U,q){if(_==="%%")return"%";if(p[++g]===void 0)return;_=F?parseInt(F.substr(1)):void 0;let Q=U?parseInt(U.substr(1)):void 0,se;switch(q){case"s":se=p[g];break;case"c":se=p[g][0];break;case"f":se=parseFloat(p[g]).toFixed(_);break;case"p":se=parseFloat(p[g]).toPrecision(_);break;case"e":se=parseFloat(p[g]).toExponential(_);break;case"x":se=parseInt(p[g]).toString(Q||16);break;case"d":se=parseFloat(parseInt(p[g],Q||10).toPrecision(_)).toFixed(0);break}se=typeof se=="object"?JSON.stringify(se):(+se).toString(Q);let fe=parseInt(M),me=M&&M[0]+""=="0"?"0":" ";for(;se.length<fe;)se=E!==void 0?se+me:me+se;return se}let N=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return f.replace(N,v)}format(f,...p){this.buffer+=Kh.form(f,p)}toString(){return this.buffer}}class Yh{constructor(f){this.boundingBox=new fd(f),this.codewords=new Array(f.getMaxY()-f.getMinY()+1)}getCodewordNearby(f){let p=this.getCodeword(f);if(p!=null)return p;for(let g=1;g<Yh.MAX_NEARBY_DISTANCE;g++){let v=this.imageRowToCodewordIndex(f)-g;if(v>=0&&(p=this.codewords[v],p!=null)||(v=this.imageRowToCodewordIndex(f)+g,v<this.codewords.length&&(p=this.codewords[v],p!=null)))return p}return null}imageRowToCodewordIndex(f){return f-this.boundingBox.getMinY()}setCodeword(f,p){this.codewords[this.imageRowToCodewordIndex(f)]=p}getCodeword(f){return this.codewords[this.imageRowToCodewordIndex(f)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const f=new Kh;let p=0;for(const g of this.codewords){if(g==null){f.format("%3d:    |   %n",p++);continue}f.format("%3d: %3d|%3d%n",p++,g.getRowNumber(),g.getValue())}return f.toString()}}Yh.MAX_NEARBY_DISTANCE=5;class Xh{constructor(){this.values=new Map}setValue(f){f=Math.trunc(f);let p=this.values.get(f);p==null&&(p=0),p++,this.values.set(f,p)}getValue(){let f=-1,p=new Array;for(const[g,v]of this.values.entries()){const N={getKey:()=>g,getValue:()=>v};N.getValue()>f?(f=N.getValue(),p=[],p.push(N.getKey())):N.getValue()===f&&p.push(N.getKey())}return Pt.toIntArray(p)}getConfidence(f){return this.values.get(f)}}class c5 extends Yh{constructor(f,p){super(f),this._isLeft=p}setRowNumbers(){for(let f of this.getCodewords())f!=null&&f.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(f){let p=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(p,f);let g=this.getBoundingBox(),v=this._isLeft?g.getTopLeft():g.getTopRight(),N=this._isLeft?g.getBottomLeft():g.getBottomRight(),_=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.imageRowToCodewordIndex(Math.trunc(N.getY())),M=-1,F=1,U=0;for(let q=_;q<E;q++){if(p[q]==null)continue;let Q=p[q],se=Q.getRowNumber()-M;if(se===0)U++;else if(se===1)F=Math.max(F,U),U=1,M=Q.getRowNumber();else if(se<0||Q.getRowNumber()>=f.getRowCount()||se>q)p[q]=null;else{let fe;F>2?fe=(F-2)*se:fe=se;let me=fe>=q;for(let Ne=1;Ne<=fe&&!me;Ne++)me=p[q-Ne]!=null;me?p[q]=null:(M=Q.getRowNumber(),U=1)}}}getRowHeights(){let f=this.getBarcodeMetadata();if(f==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(f);let p=new Int32Array(f.getRowCount());for(let g of this.getCodewords())if(g!=null){let v=g.getRowNumber();if(v>=p.length)continue;p[v]++}return p}adjustIncompleteIndicatorColumnRowNumbers(f){let p=this.getBoundingBox(),g=this._isLeft?p.getTopLeft():p.getTopRight(),v=this._isLeft?p.getBottomLeft():p.getBottomRight(),N=this.imageRowToCodewordIndex(Math.trunc(g.getY())),_=this.imageRowToCodewordIndex(Math.trunc(v.getY())),E=this.getCodewords(),M=-1;for(let F=N;F<_;F++){if(E[F]==null)continue;let U=E[F];U.setRowNumberAsRowIndicatorColumn();let q=U.getRowNumber()-M;q===0||(q===1?M=U.getRowNumber():U.getRowNumber()>=f.getRowCount()?E[F]=null:M=U.getRowNumber())}}getBarcodeMetadata(){let f=this.getCodewords(),p=new Xh,g=new Xh,v=new Xh,N=new Xh;for(let E of f){if(E==null)continue;E.setRowNumberAsRowIndicatorColumn();let M=E.getValue()%30,F=E.getRowNumber();switch(this._isLeft||(F+=2),F%3){case 0:g.setValue(M*3+1);break;case 1:N.setValue(M/3),v.setValue(M%3);break;case 2:p.setValue(M+1);break}}if(p.getValue().length===0||g.getValue().length===0||v.getValue().length===0||N.getValue().length===0||p.getValue()[0]<1||g.getValue()[0]+v.getValue()[0]<Pt.MIN_ROWS_IN_BARCODE||g.getValue()[0]+v.getValue()[0]>Pt.MAX_ROWS_IN_BARCODE)return null;let _=new vK(p.getValue()[0],g.getValue()[0],v.getValue()[0],N.getValue()[0]);return this.removeIncorrectCodewords(f,_),_}removeIncorrectCodewords(f,p){for(let g=0;g<f.length;g++){let v=f[g];if(f[g]==null)continue;let N=v.getValue()%30,_=v.getRowNumber();if(_>p.getRowCount()){f[g]=null;continue}switch(this._isLeft||(_+=2),_%3){case 0:N*3+1!==p.getRowCountUpperPart()&&(f[g]=null);break;case 1:(Math.trunc(N/3)!==p.getErrorCorrectionLevel()||N%3!==p.getRowCountLowerPart())&&(f[g]=null);break;case 2:N+1!==p.getColumnCount()&&(f[g]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Qh{constructor(f,p){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=f,this.barcodeColumnCount=f.getColumnCount(),this.boundingBox=p,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let f=Pt.MAX_CODEWORDS_IN_BARCODE,p;do p=f,f=this.adjustRowNumbersAndGetCount();while(f>0&&f<p);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(f){f!=null&&f.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let f=this.adjustRowNumbersByRow();if(f===0)return 0;for(let p=1;p<this.barcodeColumnCount+1;p++){let g=this.detectionResultColumns[p].getCodewords();for(let v=0;v<g.length;v++)g[v]!=null&&(g[v].hasValidRowNumber()||this.adjustRowNumbers(p,v,g))}return f}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let f=this.detectionResultColumns[0].getCodewords(),p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let g=0;g<f.length;g++)if(f[g]!=null&&p[g]!=null&&f[g].getRowNumber()===p[g].getRowNumber())for(let v=1;v<=this.barcodeColumnCount;v++){let N=this.detectionResultColumns[v].getCodewords()[g];N!=null&&(N.setRowNumber(f[g].getRowNumber()),N.hasValidRowNumber()||(this.detectionResultColumns[v].getCodewords()[g]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let f=0,p=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let g=0;g<p.length;g++){if(p[g]==null)continue;let v=p[g].getRowNumber(),N=0;for(let _=this.barcodeColumnCount+1;_>0&&N<this.ADJUST_ROW_NUMBER_SKIP;_--){let E=this.detectionResultColumns[_].getCodewords()[g];E!=null&&(N=Qh.adjustRowNumberIfValid(v,N,E),E.hasValidRowNumber()||f++)}}return f}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let f=0,p=this.detectionResultColumns[0].getCodewords();for(let g=0;g<p.length;g++){if(p[g]==null)continue;let v=p[g].getRowNumber(),N=0;for(let _=1;_<this.barcodeColumnCount+1&&N<this.ADJUST_ROW_NUMBER_SKIP;_++){let E=this.detectionResultColumns[_].getCodewords()[g];E!=null&&(N=Qh.adjustRowNumberIfValid(v,N,E),E.hasValidRowNumber()||f++)}}return f}static adjustRowNumberIfValid(f,p,g){return g==null||g.hasValidRowNumber()||(g.isValidRowNumber(f)?(g.setRowNumber(f),p=0):++p),p}adjustRowNumbers(f,p,g){if(!this.detectionResultColumns[f-1])return;let v=g[p],N=this.detectionResultColumns[f-1].getCodewords(),_=N;this.detectionResultColumns[f+1]!=null&&(_=this.detectionResultColumns[f+1].getCodewords());let E=new Array(14);E[2]=N[p],E[3]=_[p],p>0&&(E[0]=g[p-1],E[4]=N[p-1],E[5]=_[p-1]),p>1&&(E[8]=g[p-2],E[10]=N[p-2],E[11]=_[p-2]),p<g.length-1&&(E[1]=g[p+1],E[6]=N[p+1],E[7]=_[p+1]),p<g.length-2&&(E[9]=g[p+2],E[12]=N[p+2],E[13]=_[p+2]);for(let M of E)if(Qh.adjustRowNumber(v,M))return}static adjustRowNumber(f,p){return p==null?!1:p.hasValidRowNumber()&&p.getBucket()===f.getBucket()?(f.setRowNumber(p.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(f){this.boundingBox=f}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(f,p){this.detectionResultColumns[f]=p}getDetectionResultColumn(f){return this.detectionResultColumns[f]}toString(){let f=this.detectionResultColumns[0];f==null&&(f=this.detectionResultColumns[this.barcodeColumnCount+1]);let p=new Kh;for(let g=0;g<f.getCodewords().length;g++){p.format("CW %3d:",g);for(let v=0;v<this.barcodeColumnCount+2;v++){if(this.detectionResultColumns[v]==null){p.format("    |   ");continue}let N=this.detectionResultColumns[v].getCodewords()[g];if(N==null){p.format("    |   ");continue}p.format(" %3d|%3d",N.getRowNumber(),N.getValue())}p.format("%n")}return p.toString()}}class Zh{constructor(f,p,g,v){this.rowNumber=Zh.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(f),this.endX=Math.trunc(p),this.bucket=Math.trunc(g),this.value=Math.trunc(v)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(f){return f!==Zh.BARCODE_ROW_UNKNOWN&&this.bucket===f%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(f){this.rowNumber=f}toString(){return this.rowNumber+"|"+this.value}}Zh.BARCODE_ROW_UNKNOWN=-1;class ca{static initialize(){for(let f=0;f<Pt.SYMBOL_TABLE.length;f++){let p=Pt.SYMBOL_TABLE[f],g=p&1;for(let v=0;v<Pt.BARS_IN_MODULE;v++){let N=0;for(;(p&1)===g;)N+=1,p>>=1;g=p&1,ca.RATIOS_TABLE[f]||(ca.RATIOS_TABLE[f]=new Array(Pt.BARS_IN_MODULE)),ca.RATIOS_TABLE[f][Pt.BARS_IN_MODULE-v-1]=Math.fround(N/Pt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(f){let p=ca.getDecodedCodewordValue(ca.sampleBitCounts(f));return p!==-1?p:ca.getClosestDecodedValue(f)}static sampleBitCounts(f){let p=qe.sum(f),g=new Int32Array(Pt.BARS_IN_MODULE),v=0,N=0;for(let _=0;_<Pt.MODULES_IN_CODEWORD;_++){let E=p/(2*Pt.MODULES_IN_CODEWORD)+_*p/Pt.MODULES_IN_CODEWORD;N+f[v]<=E&&(N+=f[v],v++),g[v]++}return g}static getDecodedCodewordValue(f){let p=ca.getBitValue(f);return Pt.getCodeword(p)===-1?-1:p}static getBitValue(f){let p=0;for(let g=0;g<f.length;g++)for(let v=0;v<f[g];v++)p=p<<1|(g%2===0?1:0);return Math.trunc(p)}static getClosestDecodedValue(f){let p=qe.sum(f),g=new Array(Pt.BARS_IN_MODULE);if(p>1)for(let _=0;_<g.length;_++)g[_]=Math.fround(f[_]/p);let v=oe.MAX_VALUE,N=-1;this.bSymbolTableReady||ca.initialize();for(let _=0;_<ca.RATIOS_TABLE.length;_++){let E=0,M=ca.RATIOS_TABLE[_];for(let F=0;F<Pt.BARS_IN_MODULE;F++){let U=Math.fround(M[F]-g[F]);if(E+=Math.fround(U*U),E>=v)break}E<v&&(v=E,N=Pt.SYMBOL_TABLE[_])}return N}}ca.bSymbolTableReady=!1,ca.RATIOS_TABLE=new Array(Pt.SYMBOL_TABLE.length).map(W=>new Array(Pt.BARS_IN_MODULE));class d5{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(f){this.segmentIndex=f}getFileId(){return this.fileId}setFileId(f){this.fileId=f}getOptionalData(){return this.optionalData}setOptionalData(f){this.optionalData=f}isLastSegment(){return this.lastSegment}setLastSegment(f){this.lastSegment=f}getSegmentCount(){return this.segmentCount}setSegmentCount(f){this.segmentCount=f}getSender(){return this.sender||null}setSender(f){this.sender=f}getAddressee(){return this.addressee||null}setAddressee(f){this.addressee=f}getFileName(){return this.fileName}setFileName(f){this.fileName=f}getFileSize(){return this.fileSize}setFileSize(f){this.fileSize=f}getChecksum(){return this.checksum}setChecksum(f){this.checksum=f}getTimestamp(){return this.timestamp}setTimestamp(f){this.timestamp=f}}class u5{static parseLong(f,p=void 0){return parseInt(f,p)}}class f5 extends u{}f5.kind="NullPointerException";class wK{writeBytes(f){this.writeBytesOffset(f,0,f.length)}writeBytesOffset(f,p,g){if(f==null)throw new f5;if(p<0||p>f.length||g<0||p+g>f.length||p+g<0)throw new S;if(g===0)return;for(let v=0;v<g;v++)this.write(f[p+v])}flush(){}close(){}}class NK extends u{}class jK extends wK{constructor(f=32){if(super(),this.count=0,f<0)throw new m("Negative initial size: "+f);this.buf=new Uint8Array(f)}ensureCapacity(f){f-this.buf.length>0&&this.grow(f)}grow(f){let g=this.buf.length<<1;if(g-f<0&&(g=f),g<0){if(f<0)throw new NK;g=k.MAX_VALUE}this.buf=A.copyOfUint8Array(this.buf,g)}write(f){this.ensureCapacity(this.count+1),this.buf[this.count]=f,this.count+=1}writeBytesOffset(f,p,g){if(p<0||p>f.length||g<0||p+g-f.length>0)throw new S;this.ensureCapacity(this.count+g),j.arraycopy(f,p,this.buf,this.count,g),this.count+=g}writeTo(f){f.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return A.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(f){return f?typeof f=="string"?this.toString_string(f):this.toString_number(f):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(f){return new String(this.buf).toString()}toString_number(f){return new String(this.buf).toString()}close(){}}var wn;(function(W){W[W.ALPHA=0]="ALPHA",W[W.LOWER=1]="LOWER",W[W.MIXED=2]="MIXED",W[W.PUNCT=3]="PUNCT",W[W.ALPHA_SHIFT=4]="ALPHA_SHIFT",W[W.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(wn||(wn={}));function h5(){if(typeof window<"u")return window.BigInt||null;if(typeof tm<"u")return tm.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Yx;function Ko(W){if(typeof Yx>"u"&&(Yx=h5()),Yx===null)throw new Error("BigInt is not supported!");return Yx(W)}function SK(){let W=[];W[0]=Ko(1);let f=Ko(900);W[1]=f;for(let p=2;p<16;p++)W[p]=W[p-1]*f;return W}class Ae{static decode(f,p){let g=new V(""),v=P.ISO8859_1;g.enableDecoding(v);let N=1,_=f[N++],E=new d5;for(;N<f[0];){switch(_){case Ae.TEXT_COMPACTION_MODE_LATCH:N=Ae.textCompaction(f,N,g);break;case Ae.BYTE_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH_6:N=Ae.byteCompaction(_,f,v,N,g);break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(f[N++]);break;case Ae.NUMERIC_COMPACTION_MODE_LATCH:N=Ae.numericCompaction(f,N,g);break;case Ae.ECI_CHARSET:P.getCharacterSetECIByValue(f[N++]);break;case Ae.ECI_GENERAL_PURPOSE:N+=2;break;case Ae.ECI_USER_DEFINED:N++;break;case Ae.BEGIN_MACRO_PDF417_CONTROL_BLOCK:N=Ae.decodeMacroBlock(f,N,E);break;case Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ae.MACRO_PDF417_TERMINATOR:throw new O;default:N--,N=Ae.textCompaction(f,N,g);break}if(N<f.length)_=f[N++];else throw O.getFormatInstance()}if(g.length()===0)throw O.getFormatInstance();let M=new le(null,g.toString(),null,p);return M.setOther(E),M}static decodeMacroBlock(f,p,g){if(p+Ae.NUMBER_OF_SEQUENCE_CODEWORDS>f[0])throw O.getFormatInstance();let v=new Int32Array(Ae.NUMBER_OF_SEQUENCE_CODEWORDS);for(let E=0;E<Ae.NUMBER_OF_SEQUENCE_CODEWORDS;E++,p++)v[E]=f[p];g.setSegmentIndex(k.parseInt(Ae.decodeBase900toBase10(v,Ae.NUMBER_OF_SEQUENCE_CODEWORDS)));let N=new V;p=Ae.textCompaction(f,p,N),g.setFileId(N.toString());let _=-1;for(f[p]===Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(_=p+1);p<f[0];)switch(f[p]){case Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(p++,f[p]){case Ae.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let E=new V;p=Ae.textCompaction(f,p+1,E),g.setFileName(E.toString());break;case Ae.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let M=new V;p=Ae.textCompaction(f,p+1,M),g.setSender(M.toString());break;case Ae.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let F=new V;p=Ae.textCompaction(f,p+1,F),g.setAddressee(F.toString());break;case Ae.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let U=new V;p=Ae.numericCompaction(f,p+1,U),g.setSegmentCount(k.parseInt(U.toString()));break;case Ae.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let q=new V;p=Ae.numericCompaction(f,p+1,q),g.setTimestamp(u5.parseLong(q.toString()));break;case Ae.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Q=new V;p=Ae.numericCompaction(f,p+1,Q),g.setChecksum(k.parseInt(Q.toString()));break;case Ae.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let se=new V;p=Ae.numericCompaction(f,p+1,se),g.setFileSize(u5.parseLong(se.toString()));break;default:throw O.getFormatInstance()}break;case Ae.MACRO_PDF417_TERMINATOR:p++,g.setLastSegment(!0);break;default:throw O.getFormatInstance()}if(_!==-1){let E=p-_;g.isLastSegment()&&E--,g.setOptionalData(A.copyOfRange(f,_,_+E))}return p}static textCompaction(f,p,g){let v=new Int32Array((f[0]-p)*2),N=new Int32Array((f[0]-p)*2),_=0,E=!1;for(;p<f[0]&&!E;){let M=f[p++];if(M<Ae.TEXT_COMPACTION_MODE_LATCH)v[_]=M/30,v[_+1]=M%30,_+=2;else switch(M){case Ae.TEXT_COMPACTION_MODE_LATCH:v[_++]=Ae.TEXT_COMPACTION_MODE_LATCH;break;case Ae.BYTE_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH_6:case Ae.NUMERIC_COMPACTION_MODE_LATCH:case Ae.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ae.MACRO_PDF417_TERMINATOR:p--,E=!0;break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v[_]=Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,M=f[p++],N[_]=M,_++;break}}return Ae.decodeTextCompaction(v,N,_,g),p}static decodeTextCompaction(f,p,g,v){let N=wn.ALPHA,_=wn.ALPHA,E=0;for(;E<g;){let M=f[E],F="";switch(N){case wn.ALPHA:if(M<26)F=String.fromCharCode(65+M);else switch(M){case 26:F=" ";break;case Ae.LL:N=wn.LOWER;break;case Ae.ML:N=wn.MIXED;break;case Ae.PS:_=N,N=wn.PUNCT_SHIFT;break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ae.TEXT_COMPACTION_MODE_LATCH:N=wn.ALPHA;break}break;case wn.LOWER:if(M<26)F=String.fromCharCode(97+M);else switch(M){case 26:F=" ";break;case Ae.AS:_=N,N=wn.ALPHA_SHIFT;break;case Ae.ML:N=wn.MIXED;break;case Ae.PS:_=N,N=wn.PUNCT_SHIFT;break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ae.TEXT_COMPACTION_MODE_LATCH:N=wn.ALPHA;break}break;case wn.MIXED:if(M<Ae.PL)F=Ae.MIXED_CHARS[M];else switch(M){case Ae.PL:N=wn.PUNCT;break;case 26:F=" ";break;case Ae.LL:N=wn.LOWER;break;case Ae.AL:N=wn.ALPHA;break;case Ae.PS:_=N,N=wn.PUNCT_SHIFT;break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ae.TEXT_COMPACTION_MODE_LATCH:N=wn.ALPHA;break}break;case wn.PUNCT:if(M<Ae.PAL)F=Ae.PUNCT_CHARS[M];else switch(M){case Ae.PAL:N=wn.ALPHA;break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ae.TEXT_COMPACTION_MODE_LATCH:N=wn.ALPHA;break}break;case wn.ALPHA_SHIFT:if(N=_,M<26)F=String.fromCharCode(65+M);else switch(M){case 26:F=" ";break;case Ae.TEXT_COMPACTION_MODE_LATCH:N=wn.ALPHA;break}break;case wn.PUNCT_SHIFT:if(N=_,M<Ae.PAL)F=Ae.PUNCT_CHARS[M];else switch(M){case Ae.PAL:N=wn.ALPHA;break;case Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:v.append(p[E]);break;case Ae.TEXT_COMPACTION_MODE_LATCH:N=wn.ALPHA;break}break}F!==""&&v.append(F),E++}}static byteCompaction(f,p,g,v,N){let _=new jK,E=0,M=0,F=!1;switch(f){case Ae.BYTE_COMPACTION_MODE_LATCH:let U=new Int32Array(6),q=p[v++];for(;v<p[0]&&!F;)switch(U[E++]=q,M=900*M+q,q=p[v++],q){case Ae.TEXT_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH:case Ae.NUMERIC_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH_6:case Ae.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ae.MACRO_PDF417_TERMINATOR:v--,F=!0;break;default:if(E%5===0&&E>0){for(let Q=0;Q<6;++Q)_.write(Number(Ko(M)>>Ko(8*(5-Q))));M=0,E=0}break}v===p[0]&&q<Ae.TEXT_COMPACTION_MODE_LATCH&&(U[E++]=q);for(let Q=0;Q<E;Q++)_.write(U[Q]);break;case Ae.BYTE_COMPACTION_MODE_LATCH_6:for(;v<p[0]&&!F;){let Q=p[v++];if(Q<Ae.TEXT_COMPACTION_MODE_LATCH)E++,M=900*M+Q;else switch(Q){case Ae.TEXT_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH:case Ae.NUMERIC_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH_6:case Ae.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ae.MACRO_PDF417_TERMINATOR:v--,F=!0;break}if(E%5===0&&E>0){for(let se=0;se<6;++se)_.write(Number(Ko(M)>>Ko(8*(5-se))));M=0,E=0}}break}return N.append($.decode(_.toByteArray(),g)),v}static numericCompaction(f,p,g){let v=0,N=!1,_=new Int32Array(Ae.MAX_NUMERIC_CODEWORDS);for(;p<f[0]&&!N;){let E=f[p++];if(p===f[0]&&(N=!0),E<Ae.TEXT_COMPACTION_MODE_LATCH)_[v]=E,v++;else switch(E){case Ae.TEXT_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH:case Ae.BYTE_COMPACTION_MODE_LATCH_6:case Ae.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ae.MACRO_PDF417_TERMINATOR:p--,N=!0;break}(v%Ae.MAX_NUMERIC_CODEWORDS===0||E===Ae.NUMERIC_COMPACTION_MODE_LATCH||N)&&v>0&&(g.append(Ae.decodeBase900toBase10(_,v)),v=0)}return p}static decodeBase900toBase10(f,p){let g=Ko(0);for(let N=0;N<p;N++)g+=Ae.EXP900[p-N-1]*Ko(f[N]);let v=g.toString();if(v.charAt(0)!=="1")throw new O;return v.substring(1)}}Ae.TEXT_COMPACTION_MODE_LATCH=900,Ae.BYTE_COMPACTION_MODE_LATCH=901,Ae.NUMERIC_COMPACTION_MODE_LATCH=902,Ae.BYTE_COMPACTION_MODE_LATCH_6=924,Ae.ECI_USER_DEFINED=925,Ae.ECI_GENERAL_PURPOSE=926,Ae.ECI_CHARSET=927,Ae.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ae.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ae.MACRO_PDF417_TERMINATOR=922,Ae.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ae.MAX_NUMERIC_CODEWORDS=15,Ae.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ae.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ae.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ae.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ae.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ae.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ae.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ae.PL=25,Ae.LL=27,Ae.AS=27,Ae.ML=28,Ae.AL=28,Ae.PS=29,Ae.PAL=29,Ae.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Ae.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Ae.EXP900=h5()?SK():[],Ae.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Gt{constructor(){}static decode(f,p,g,v,N,_,E){let M=new fd(f,p,g,v,N),F=null,U=null,q;for(let fe=!0;;fe=!1){if(p!=null&&(F=Gt.getRowIndicatorColumn(f,M,p,!0,_,E)),v!=null&&(U=Gt.getRowIndicatorColumn(f,M,v,!1,_,E)),q=Gt.merge(F,U),q==null)throw z.getNotFoundInstance();let me=q.getBoundingBox();if(fe&&me!=null&&(me.getMinY()<M.getMinY()||me.getMaxY()>M.getMaxY()))M=me;else break}q.setBoundingBox(M);let Q=q.getBarcodeColumnCount()+1;q.setDetectionResultColumn(0,F),q.setDetectionResultColumn(Q,U);let se=F!=null;for(let fe=1;fe<=Q;fe++){let me=se?fe:Q-fe;if(q.getDetectionResultColumn(me)!==void 0)continue;let Ne;me===0||me===Q?Ne=new c5(M,me===0):Ne=new Yh(M),q.setDetectionResultColumn(me,Ne);let ke=-1,We=ke;for(let Ke=M.getMinY();Ke<=M.getMaxY();Ke++){if(ke=Gt.getStartColumn(q,me,Ke,se),ke<0||ke>M.getMaxX()){if(We===-1)continue;ke=We}let Fe=Gt.detectCodeword(f,M.getMinX(),M.getMaxX(),se,ke,Ke,_,E);Fe!=null&&(Ne.setCodeword(Ke,Fe),We=ke,_=Math.min(_,Fe.getWidth()),E=Math.max(E,Fe.getWidth()))}}return Gt.createDecoderResult(q)}static merge(f,p){if(f==null&&p==null)return null;let g=Gt.getBarcodeMetadata(f,p);if(g==null)return null;let v=fd.merge(Gt.adjustBoundingBox(f),Gt.adjustBoundingBox(p));return new Qh(g,v)}static adjustBoundingBox(f){if(f==null)return null;let p=f.getRowHeights();if(p==null)return null;let g=Gt.getMax(p),v=0;for(let E of p)if(v+=g-E,E>0)break;let N=f.getCodewords();for(let E=0;v>0&&N[E]==null;E++)v--;let _=0;for(let E=p.length-1;E>=0&&(_+=g-p[E],!(p[E]>0));E--);for(let E=N.length-1;_>0&&N[E]==null;E--)_--;return f.getBoundingBox().addMissingRows(v,_,f.isLeft())}static getMax(f){let p=-1;for(let g of f)p=Math.max(p,g);return p}static getBarcodeMetadata(f,p){let g;if(f==null||(g=f.getBarcodeMetadata())==null)return p==null?null:p.getBarcodeMetadata();let v;return p==null||(v=p.getBarcodeMetadata())==null?g:g.getColumnCount()!==v.getColumnCount()&&g.getErrorCorrectionLevel()!==v.getErrorCorrectionLevel()&&g.getRowCount()!==v.getRowCount()?null:g}static getRowIndicatorColumn(f,p,g,v,N,_){let E=new c5(p,v);for(let M=0;M<2;M++){let F=M===0?1:-1,U=Math.trunc(Math.trunc(g.getX()));for(let q=Math.trunc(Math.trunc(g.getY()));q<=p.getMaxY()&&q>=p.getMinY();q+=F){let Q=Gt.detectCodeword(f,0,f.getWidth(),v,U,q,N,_);Q!=null&&(E.setCodeword(q,Q),v?U=Q.getStartX():U=Q.getEndX())}}return E}static adjustCodewordCount(f,p){let g=p[0][1],v=g.getValue(),N=f.getBarcodeColumnCount()*f.getBarcodeRowCount()-Gt.getNumberOfECCodeWords(f.getBarcodeECLevel());if(v.length===0){if(N<1||N>Pt.MAX_CODEWORDS_IN_BARCODE)throw z.getNotFoundInstance();g.setValue(N)}else v[0]!==N&&g.setValue(N)}static createDecoderResult(f){let p=Gt.createBarcodeMatrix(f);Gt.adjustCodewordCount(f,p);let g=new Array,v=new Int32Array(f.getBarcodeRowCount()*f.getBarcodeColumnCount()),N=[],_=new Array;for(let M=0;M<f.getBarcodeRowCount();M++)for(let F=0;F<f.getBarcodeColumnCount();F++){let U=p[M][F+1].getValue(),q=M*f.getBarcodeColumnCount()+F;U.length===0?g.push(q):U.length===1?v[q]=U[0]:(_.push(q),N.push(U))}let E=new Array(N.length);for(let M=0;M<E.length;M++)E[M]=N[M];return Gt.createDecoderResultFromAmbiguousValues(f.getBarcodeECLevel(),v,Pt.toIntArray(g),Pt.toIntArray(_),E)}static createDecoderResultFromAmbiguousValues(f,p,g,v,N){let _=new Int32Array(v.length),E=100;for(;E-- >0;){for(let M=0;M<_.length;M++)p[v[M]]=N[M][_[M]];try{return Gt.decodeCodewords(p,f,g)}catch(M){if(!(M instanceof b))throw M}if(_.length===0)throw b.getChecksumInstance();for(let M=0;M<_.length;M++)if(_[M]<N[M].length-1){_[M]++;break}else if(_[M]=0,M===_.length-1)throw b.getChecksumInstance()}throw b.getChecksumInstance()}static createBarcodeMatrix(f){let p=Array.from({length:f.getBarcodeRowCount()},()=>new Array(f.getBarcodeColumnCount()+2));for(let v=0;v<p.length;v++)for(let N=0;N<p[v].length;N++)p[v][N]=new Xh;let g=0;for(let v of f.getDetectionResultColumns()){if(v!=null){for(let N of v.getCodewords())if(N!=null){let _=N.getRowNumber();if(_>=0){if(_>=p.length)continue;p[_][g].setValue(N.getValue())}}}g++}return p}static isValidBarcodeColumn(f,p){return p>=0&&p<=f.getBarcodeColumnCount()+1}static getStartColumn(f,p,g,v){let N=v?1:-1,_=null;if(Gt.isValidBarcodeColumn(f,p-N)&&(_=f.getDetectionResultColumn(p-N).getCodeword(g)),_!=null)return v?_.getEndX():_.getStartX();if(_=f.getDetectionResultColumn(p).getCodewordNearby(g),_!=null)return v?_.getStartX():_.getEndX();if(Gt.isValidBarcodeColumn(f,p-N)&&(_=f.getDetectionResultColumn(p-N).getCodewordNearby(g)),_!=null)return v?_.getEndX():_.getStartX();let E=0;for(;Gt.isValidBarcodeColumn(f,p-N);){p-=N;for(let M of f.getDetectionResultColumn(p).getCodewords())if(M!=null)return(v?M.getEndX():M.getStartX())+N*E*(M.getEndX()-M.getStartX());E++}return v?f.getBoundingBox().getMinX():f.getBoundingBox().getMaxX()}static detectCodeword(f,p,g,v,N,_,E,M){N=Gt.adjustCodewordStartColumn(f,p,g,v,N,_);let F=Gt.getModuleBitCount(f,p,g,v,N,_);if(F==null)return null;let U,q=qe.sum(F);if(v)U=N+q;else{for(let fe=0;fe<F.length/2;fe++){let me=F[fe];F[fe]=F[F.length-1-fe],F[F.length-1-fe]=me}U=N,N=U-q}if(!Gt.checkCodewordSkew(q,E,M))return null;let Q=ca.getDecodedValue(F),se=Pt.getCodeword(Q);return se===-1?null:new Zh(N,U,Gt.getCodewordBucketNumber(Q),se)}static getModuleBitCount(f,p,g,v,N,_){let E=N,M=new Int32Array(8),F=0,U=v?1:-1,q=v;for(;(v?E<g:E>=p)&&F<M.length;)f.get(E,_)===q?(M[F]++,E+=U):(F++,q=!q);return F===M.length||E===(v?g:p)&&F===M.length-1?M:null}static getNumberOfECCodeWords(f){return 2<<f}static adjustCodewordStartColumn(f,p,g,v,N,_){let E=N,M=v?-1:1;for(let F=0;F<2;F++){for(;(v?E>=p:E<g)&&v===f.get(E,_);){if(Math.abs(N-E)>Gt.CODEWORD_SKEW_SIZE)return N;E+=M}M=-M,v=!v}return E}static checkCodewordSkew(f,p,g){return p-Gt.CODEWORD_SKEW_SIZE<=f&&f<=g+Gt.CODEWORD_SKEW_SIZE}static decodeCodewords(f,p,g){if(f.length===0)throw O.getFormatInstance();let v=1<<p+1,N=Gt.correctErrors(f,g,v);Gt.verifyCodewordCount(f,v);let _=Ae.decode(f,""+p);return _.setErrorsCorrected(N),_.setErasures(g.length),_}static correctErrors(f,p,g){if(p!=null&&p.length>g/2+Gt.MAX_ERRORS||g<0||g>Gt.MAX_EC_CODEWORDS)throw b.getChecksumInstance();return Gt.errorCorrection.decode(f,g,p)}static verifyCodewordCount(f,p){if(f.length<4)throw O.getFormatInstance();let g=f[0];if(g>f.length)throw O.getFormatInstance();if(g===0)if(p<f.length)f[0]=f.length-p;else throw O.getFormatInstance()}static getBitCountForCodeword(f){let p=new Int32Array(8),g=0,v=p.length-1;for(;!((f&1)!==g&&(g=f&1,v--,v<0));)p[v]++,f>>=1;return p}static getCodewordBucketNumber(f){return f instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(f):this.getCodewordBucketNumber_number(f)}static getCodewordBucketNumber_number(f){return Gt.getCodewordBucketNumber(Gt.getBitCountForCodeword(f))}static getCodewordBucketNumber_Int32Array(f){return(f[0]-f[2]+f[4]-f[6]+9)%9}static toString(f){let p=new Kh;for(let g=0;g<f.length;g++){p.format("Row %2d: ",g);for(let v=0;v<f[g].length;v++){let N=f[g][v];N.getValue().length===0?p.format("        ",null):p.format("%4d(%2d)",N.getValue()[0],N.getConfidence(N.getValue()[0]))}p.format("%n")}return p.toString()}}Gt.CODEWORD_SKEW_SIZE=2,Gt.MAX_ERRORS=3,Gt.MAX_EC_CODEWORDS=512,Gt.errorCorrection=new o5;class xr{decode(f,p=null){let g=xr.decode(f,p,!1);if(g==null||g.length===0||g[0]==null)throw z.getNotFoundInstance();return g[0]}decodeMultiple(f,p=null){try{return xr.decode(f,p,!0)}catch(g){throw g instanceof O||g instanceof b?z.getNotFoundInstance():g}}static decode(f,p,g){const v=new Array,N=Ht.detectMultiple(f,p,g);for(const _ of N.getPoints()){const E=Gt.decode(N.getBits(),_[4],_[5],_[6],_[7],xr.getMinCodewordWidth(_),xr.getMaxCodewordWidth(_)),M=new be(E.getText(),E.getRawBytes(),void 0,_,Z.PDF_417);M.putMetadata(Te.ERROR_CORRECTION_LEVEL,E.getECLevel());const F=E.getOther();F!=null&&M.putMetadata(Te.PDF417_EXTRA_METADATA,F),v.push(M)}return v.map(_=>_)}static getMaxWidth(f,p){return f==null||p==null?0:Math.trunc(Math.abs(f.getX()-p.getX()))}static getMinWidth(f,p){return f==null||p==null?k.MAX_VALUE:Math.trunc(Math.abs(f.getX()-p.getX()))}static getMaxCodewordWidth(f){return Math.floor(Math.max(Math.max(xr.getMaxWidth(f[0],f[4]),xr.getMaxWidth(f[6],f[2])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN),Math.max(xr.getMaxWidth(f[1],f[5]),xr.getMaxWidth(f[7],f[3])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(f){return Math.floor(Math.min(Math.min(xr.getMinWidth(f[0],f[4]),xr.getMinWidth(f[6],f[2])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN),Math.min(xr.getMinWidth(f[1],f[5]),xr.getMinWidth(f[7],f[3])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Xx extends u{}Xx.kind="ReaderException";class m5{constructor(f,p){this.verbose=f===!0,p&&this.setHints(p)}decode(f,p){return p&&this.setHints(p),this.decodeInternal(f)}decodeWithState(f){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(f)}setHints(f){this.hints=f;const p=!r(f)&&f.get(D.TRY_HARDER)===!0,g=r(f)?null:f.get(D.POSSIBLE_FORMATS),v=new Array;if(!r(g)){const N=g.some(_=>_===Z.UPC_A||_===Z.UPC_E||_===Z.EAN_13||_===Z.EAN_8||_===Z.CODABAR||_===Z.CODE_39||_===Z.CODE_93||_===Z.CODE_128||_===Z.ITF||_===Z.RSS_14||_===Z.RSS_EXPANDED);N&&!p&&v.push(new Wo(f,this.verbose)),g.includes(Z.QR_CODE)&&v.push(new Go),g.includes(Z.DATA_MATRIX)&&v.push(new X),g.includes(Z.AZTEC)&&v.push(new Ue),g.includes(Z.PDF_417)&&v.push(new xr),N&&p&&v.push(new Wo(f,this.verbose))}v.length===0&&(p||v.push(new Wo(f,this.verbose)),v.push(new Go),v.push(new X),v.push(new Ue),v.push(new xr),p&&v.push(new Wo(f,this.verbose))),this.readers=v}reset(){if(this.readers!==null)for(const f of this.readers)f.reset()}decodeInternal(f){if(this.readers===null)throw new Xx("No readers where selected, nothing can be read.");for(const p of this.readers)try{return p.decode(f,this.hints)}catch(g){if(g instanceof Xx)continue}throw new z("No MultiFormat Readers were able to detect the code.")}}class _K extends he{constructor(f=null,p=500){const g=new m5;g.setHints(f),super(g,p)}decodeBitmap(f){return this.reader.decodeWithState(f)}}class CK extends he{constructor(f=500){super(new xr,f)}}class AK extends he{constructor(f=500){super(new Go,f)}}var Nw;(function(W){W[W.ERROR_CORRECTION=0]="ERROR_CORRECTION",W[W.CHARACTER_SET=1]="CHARACTER_SET",W[W.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",W[W.MIN_SIZE=3]="MIN_SIZE",W[W.MAX_SIZE=4]="MAX_SIZE",W[W.MARGIN=5]="MARGIN",W[W.PDF417_COMPACT=6]="PDF417_COMPACT",W[W.PDF417_COMPACTION=7]="PDF417_COMPACTION",W[W.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",W[W.AZTEC_LAYERS=9]="AZTEC_LAYERS",W[W.QR_VERSION=10]="QR_VERSION"})(Nw||(Nw={}));var Fs=Nw;class jw{constructor(f){this.field=f,this.cachedGenerators=[],this.cachedGenerators.push(new ge(f,Int32Array.from([1])))}buildGenerator(f){const p=this.cachedGenerators;if(f>=p.length){let g=p[p.length-1];const v=this.field;for(let N=p.length;N<=f;N++){const _=g.multiply(new ge(v,Int32Array.from([1,v.exp(N-1+v.getGeneratorBase())])));p.push(_),g=_}}return p[f]}encode(f,p){if(p===0)throw new m("No error correction bytes");const g=f.length-p;if(g<=0)throw new m("No data bytes provided");const v=this.buildGenerator(p),N=new Int32Array(g);j.arraycopy(f,0,N,0,g);let _=new ge(this.field,N);_=_.multiplyByMonomial(p,1);const M=_.divide(v)[1].getCoefficients(),F=p-M.length;for(let U=0;U<F;U++)f[g+U]=0;j.arraycopy(M,0,f,g+F,M.length)}}class cs{constructor(){}static applyMaskPenaltyRule1(f){return cs.applyMaskPenaltyRule1Internal(f,!0)+cs.applyMaskPenaltyRule1Internal(f,!1)}static applyMaskPenaltyRule2(f){let p=0;const g=f.getArray(),v=f.getWidth(),N=f.getHeight();for(let _=0;_<N-1;_++){const E=g[_];for(let M=0;M<v-1;M++){const F=E[M];F===E[M+1]&&F===g[_+1][M]&&F===g[_+1][M+1]&&p++}}return cs.N2*p}static applyMaskPenaltyRule3(f){let p=0;const g=f.getArray(),v=f.getWidth(),N=f.getHeight();for(let _=0;_<N;_++)for(let E=0;E<v;E++){const M=g[_];E+6<v&&M[E]===1&&M[E+1]===0&&M[E+2]===1&&M[E+3]===1&&M[E+4]===1&&M[E+5]===0&&M[E+6]===1&&(cs.isWhiteHorizontal(M,E-4,E)||cs.isWhiteHorizontal(M,E+7,E+11))&&p++,_+6<N&&g[_][E]===1&&g[_+1][E]===0&&g[_+2][E]===1&&g[_+3][E]===1&&g[_+4][E]===1&&g[_+5][E]===0&&g[_+6][E]===1&&(cs.isWhiteVertical(g,E,_-4,_)||cs.isWhiteVertical(g,E,_+7,_+11))&&p++}return p*cs.N3}static isWhiteHorizontal(f,p,g){p=Math.max(p,0),g=Math.min(g,f.length);for(let v=p;v<g;v++)if(f[v]===1)return!1;return!0}static isWhiteVertical(f,p,g,v){g=Math.max(g,0),v=Math.min(v,f.length);for(let N=g;N<v;N++)if(f[N][p]===1)return!1;return!0}static applyMaskPenaltyRule4(f){let p=0;const g=f.getArray(),v=f.getWidth(),N=f.getHeight();for(let M=0;M<N;M++){const F=g[M];for(let U=0;U<v;U++)F[U]===1&&p++}const _=f.getHeight()*f.getWidth();return Math.floor(Math.abs(p*2-_)*10/_)*cs.N4}static getDataMaskBit(f,p,g){let v,N;switch(f){case 0:v=g+p&1;break;case 1:v=g&1;break;case 2:v=p%3;break;case 3:v=(g+p)%3;break;case 4:v=Math.floor(g/2)+Math.floor(p/3)&1;break;case 5:N=g*p,v=(N&1)+N%3;break;case 6:N=g*p,v=(N&1)+N%3&1;break;case 7:N=g*p,v=N%3+(g+p&1)&1;break;default:throw new m("Invalid mask pattern: "+f)}return v===0}static applyMaskPenaltyRule1Internal(f,p){let g=0;const v=p?f.getHeight():f.getWidth(),N=p?f.getWidth():f.getHeight(),_=f.getArray();for(let E=0;E<v;E++){let M=0,F=-1;for(let U=0;U<N;U++){const q=p?_[E][U]:_[U][E];q===F?M++:(M>=5&&(g+=cs.N1+(M-5)),M=1,F=q)}M>=5&&(g+=cs.N1+(M-5))}return g}}cs.N1=3,cs.N2=3,cs.N3=40,cs.N4=10;class Qx{constructor(f,p){this.width=f,this.height=p;const g=new Array(p);for(let v=0;v!==p;v++)g[v]=new Uint8Array(f);this.bytes=g}getHeight(){return this.height}getWidth(){return this.width}get(f,p){return this.bytes[p][f]}getArray(){return this.bytes}setNumber(f,p,g){this.bytes[p][f]=g}setBoolean(f,p,g){this.bytes[p][f]=g?1:0}clear(f){for(const p of this.bytes)A.fill(p,f)}equals(f){if(!(f instanceof Qx))return!1;const p=f;if(this.width!==p.width||this.height!==p.height)return!1;for(let g=0,v=this.height;g<v;++g){const N=this.bytes[g],_=p.bytes[g];for(let E=0,M=this.width;E<M;++E)if(N[E]!==_[E])return!1}return!0}toString(){const f=new V;for(let p=0,g=this.height;p<g;++p){const v=this.bytes[p];for(let N=0,_=this.width;N<_;++N)switch(v[N]){case 0:f.append(" 0");break;case 1:f.append(" 1");break;default:f.append("  ");break}f.append(`
`)}return f.toString()}}class hd{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const f=new V;return f.append(`<<
`),f.append(" mode: "),f.append(this.mode?this.mode.toString():"null"),f.append(`
 ecLevel: `),f.append(this.ecLevel?this.ecLevel.toString():"null"),f.append(`
 version: `),f.append(this.version?this.version.toString():"null"),f.append(`
 maskPattern: `),f.append(this.maskPattern.toString()),this.matrix?(f.append(`
 matrix:
`),f.append(this.matrix.toString())):f.append(`
 matrix: null
`),f.append(`>>
`),f.toString()}setMode(f){this.mode=f}setECLevel(f){this.ecLevel=f}setVersion(f){this.version=f}setMaskPattern(f){this.maskPattern=f}setMatrix(f){this.matrix=f}static isValidMaskPattern(f){return f>=0&&f<hd.NUM_MASK_PATTERNS}}hd.NUM_MASK_PATTERNS=8;class _n extends u{}_n.kind="WriterException";class kt{constructor(){}static clearMatrix(f){f.clear(255)}static buildMatrix(f,p,g,v,N){kt.clearMatrix(N),kt.embedBasicPatterns(g,N),kt.embedTypeInfo(p,v,N),kt.maybeEmbedVersionInfo(g,N),kt.embedDataBits(f,v,N)}static embedBasicPatterns(f,p){kt.embedPositionDetectionPatternsAndSeparators(p),kt.embedDarkDotAtLeftBottomCorner(p),kt.maybeEmbedPositionAdjustmentPatterns(f,p),kt.embedTimingPatterns(p)}static embedTypeInfo(f,p,g){const v=new T;kt.makeTypeInfoBits(f,p,v);for(let N=0,_=v.getSize();N<_;++N){const E=v.get(v.getSize()-1-N),M=kt.TYPE_INFO_COORDINATES[N],F=M[0],U=M[1];if(g.setBoolean(F,U,E),N<8){const q=g.getWidth()-N-1;g.setBoolean(q,8,E)}else{const Q=g.getHeight()-7+(N-8);g.setBoolean(8,Q,E)}}}static maybeEmbedVersionInfo(f,p){if(f.getVersionNumber()<7)return;const g=new T;kt.makeVersionInfoBits(f,g);let v=6*3-1;for(let N=0;N<6;++N)for(let _=0;_<3;++_){const E=g.get(v);v--,p.setBoolean(N,p.getHeight()-11+_,E),p.setBoolean(p.getHeight()-11+_,N,E)}}static embedDataBits(f,p,g){let v=0,N=-1,_=g.getWidth()-1,E=g.getHeight()-1;for(;_>0;){for(_===6&&(_-=1);E>=0&&E<g.getHeight();){for(let M=0;M<2;++M){const F=_-M;if(!kt.isEmpty(g.get(F,E)))continue;let U;v<f.getSize()?(U=f.get(v),++v):U=!1,p!==255&&cs.getDataMaskBit(p,F,E)&&(U=!U),g.setBoolean(F,E,U)}E+=N}N=-N,E+=N,_-=2}if(v!==f.getSize())throw new _n("Not all bits consumed: "+v+"/"+f.getSize())}static findMSBSet(f){return 32-k.numberOfLeadingZeros(f)}static calculateBCHCode(f,p){if(p===0)throw new m("0 polynomial");const g=kt.findMSBSet(p);for(f<<=g-1;kt.findMSBSet(f)>=g;)f^=p<<kt.findMSBSet(f)-g;return f}static makeTypeInfoBits(f,p,g){if(!hd.isValidMaskPattern(p))throw new _n("Invalid mask pattern");const v=f.getBits()<<3|p;g.appendBits(v,5);const N=kt.calculateBCHCode(v,kt.TYPE_INFO_POLY);g.appendBits(N,10);const _=new T;if(_.appendBits(kt.TYPE_INFO_MASK_PATTERN,15),g.xor(_),g.getSize()!==15)throw new _n("should not happen but we got: "+g.getSize())}static makeVersionInfoBits(f,p){p.appendBits(f.getVersionNumber(),6);const g=kt.calculateBCHCode(f.getVersionNumber(),kt.VERSION_INFO_POLY);if(p.appendBits(g,12),p.getSize()!==18)throw new _n("should not happen but we got: "+p.getSize())}static isEmpty(f){return f===255}static embedTimingPatterns(f){for(let p=8;p<f.getWidth()-8;++p){const g=(p+1)%2;kt.isEmpty(f.get(p,6))&&f.setNumber(p,6,g),kt.isEmpty(f.get(6,p))&&f.setNumber(6,p,g)}}static embedDarkDotAtLeftBottomCorner(f){if(f.get(8,f.getHeight()-8)===0)throw new _n;f.setNumber(8,f.getHeight()-8,1)}static embedHorizontalSeparationPattern(f,p,g){for(let v=0;v<8;++v){if(!kt.isEmpty(g.get(f+v,p)))throw new _n;g.setNumber(f+v,p,0)}}static embedVerticalSeparationPattern(f,p,g){for(let v=0;v<7;++v){if(!kt.isEmpty(g.get(f,p+v)))throw new _n;g.setNumber(f,p+v,0)}}static embedPositionAdjustmentPattern(f,p,g){for(let v=0;v<5;++v){const N=kt.POSITION_ADJUSTMENT_PATTERN[v];for(let _=0;_<5;++_)g.setNumber(f+_,p+v,N[_])}}static embedPositionDetectionPattern(f,p,g){for(let v=0;v<7;++v){const N=kt.POSITION_DETECTION_PATTERN[v];for(let _=0;_<7;++_)g.setNumber(f+_,p+v,N[_])}}static embedPositionDetectionPatternsAndSeparators(f){const p=kt.POSITION_DETECTION_PATTERN[0].length;kt.embedPositionDetectionPattern(0,0,f),kt.embedPositionDetectionPattern(f.getWidth()-p,0,f),kt.embedPositionDetectionPattern(0,f.getWidth()-p,f);const g=8;kt.embedHorizontalSeparationPattern(0,g-1,f),kt.embedHorizontalSeparationPattern(f.getWidth()-g,g-1,f),kt.embedHorizontalSeparationPattern(0,f.getWidth()-g,f);const v=7;kt.embedVerticalSeparationPattern(v,0,f),kt.embedVerticalSeparationPattern(f.getHeight()-v-1,0,f),kt.embedVerticalSeparationPattern(v,f.getHeight()-v,f)}static maybeEmbedPositionAdjustmentPatterns(f,p){if(f.getVersionNumber()<2)return;const g=f.getVersionNumber()-1,v=kt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[g];for(let N=0,_=v.length;N!==_;N++){const E=v[N];if(E>=0)for(let M=0;M!==_;M++){const F=v[M];F>=0&&kt.isEmpty(p.get(F,E))&&kt.embedPositionAdjustmentPattern(F-2,E-2,p)}}}}kt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),kt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),kt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),kt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),kt.VERSION_INFO_POLY=7973,kt.TYPE_INFO_POLY=1335,kt.TYPE_INFO_MASK_PATTERN=21522;class kK{constructor(f,p){this.dataBytes=f,this.errorCorrectionBytes=p}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ln{constructor(){}static calculateMaskPenalty(f){return cs.applyMaskPenaltyRule1(f)+cs.applyMaskPenaltyRule2(f)+cs.applyMaskPenaltyRule3(f)+cs.applyMaskPenaltyRule4(f)}static encode(f,p,g=null){let v=Ln.DEFAULT_BYTE_MODE_ENCODING;const N=g!==null&&g.get(Fs.CHARACTER_SET)!==void 0;N&&(v=g.get(Fs.CHARACTER_SET).toString());const _=this.chooseMode(f,v),E=new T;if(_===_t.BYTE&&(N||Ln.DEFAULT_BYTE_MODE_ENCODING!==v)){const Ke=P.getCharacterSetECIByName(v);Ke!==void 0&&this.appendECI(Ke,E)}this.appendModeInfo(_,E);const M=new T;this.appendBytes(f,_,M,v);let F;if(g!==null&&g.get(Fs.QR_VERSION)!==void 0){const Ke=Number.parseInt(g.get(Fs.QR_VERSION).toString(),10);F=bt.getVersionForNumber(Ke);const Fe=this.calculateBitsNeeded(_,E,M,F);if(!this.willFit(Fe,F,p))throw new _n("Data too big for requested version")}else F=this.recommendVersion(p,_,E,M);const U=new T;U.appendBitArray(E);const q=_===_t.BYTE?M.getSizeInBytes():f.length;this.appendLengthInfo(q,F,_,U),U.appendBitArray(M);const Q=F.getECBlocksForLevel(p),se=F.getTotalCodewords()-Q.getTotalECCodewords();this.terminateBits(se,U);const fe=this.interleaveWithECBytes(U,F.getTotalCodewords(),se,Q.getNumBlocks()),me=new hd;me.setECLevel(p),me.setMode(_),me.setVersion(F);const Ne=F.getDimensionForVersion(),ke=new Qx(Ne,Ne),We=this.chooseMaskPattern(fe,p,F,ke);return me.setMaskPattern(We),kt.buildMatrix(fe,p,F,We,ke),me.setMatrix(ke),me}static recommendVersion(f,p,g,v){const N=this.calculateBitsNeeded(p,g,v,bt.getVersionForNumber(1)),_=this.chooseVersion(N,f),E=this.calculateBitsNeeded(p,g,v,_);return this.chooseVersion(E,f)}static calculateBitsNeeded(f,p,g,v){return p.getSize()+f.getCharacterCountBits(v)+g.getSize()}static getAlphanumericCode(f){return f<Ln.ALPHANUMERIC_TABLE.length?Ln.ALPHANUMERIC_TABLE[f]:-1}static chooseMode(f,p=null){if(P.SJIS.getName()===p&&this.isOnlyDoubleByteKanji(f))return _t.KANJI;let g=!1,v=!1;for(let N=0,_=f.length;N<_;++N){const E=f.charAt(N);if(Ln.isDigit(E))g=!0;else if(this.getAlphanumericCode(E.charCodeAt(0))!==-1)v=!0;else return _t.BYTE}return v?_t.ALPHANUMERIC:g?_t.NUMERIC:_t.BYTE}static isOnlyDoubleByteKanji(f){let p;try{p=$.encode(f,P.SJIS)}catch{return!1}const g=p.length;if(g%2!==0)return!1;for(let v=0;v<g;v+=2){const N=p[v]&255;if((N<129||N>159)&&(N<224||N>235))return!1}return!0}static chooseMaskPattern(f,p,g,v){let N=Number.MAX_SAFE_INTEGER,_=-1;for(let E=0;E<hd.NUM_MASK_PATTERNS;E++){kt.buildMatrix(f,p,g,E,v);let M=this.calculateMaskPenalty(v);M<N&&(N=M,_=E)}return _}static chooseVersion(f,p){for(let g=1;g<=40;g++){const v=bt.getVersionForNumber(g);if(Ln.willFit(f,v,p))return v}throw new _n("Data too big")}static willFit(f,p,g){const v=p.getTotalCodewords(),_=p.getECBlocksForLevel(g).getTotalECCodewords(),E=v-_,M=(f+7)/8;return E>=M}static terminateBits(f,p){const g=f*8;if(p.getSize()>g)throw new _n("data bits cannot fit in the QR Code"+p.getSize()+" > "+g);for(let _=0;_<4&&p.getSize()<g;++_)p.appendBit(!1);const v=p.getSize()&7;if(v>0)for(let _=v;_<8;_++)p.appendBit(!1);const N=f-p.getSizeInBytes();for(let _=0;_<N;++_)p.appendBits(_&1?17:236,8);if(p.getSize()!==g)throw new _n("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(f,p,g,v,N,_){if(v>=g)throw new _n("Block ID too large");const E=f%g,M=g-E,F=Math.floor(f/g),U=F+1,q=Math.floor(p/g),Q=q+1,se=F-q,fe=U-Q;if(se!==fe)throw new _n("EC bytes mismatch");if(g!==M+E)throw new _n("RS blocks mismatch");if(f!==(q+se)*M+(Q+fe)*E)throw new _n("Total bytes mismatch");v<M?(N[0]=q,_[0]=se):(N[0]=Q,_[0]=fe)}static interleaveWithECBytes(f,p,g,v){if(f.getSizeInBytes()!==g)throw new _n("Number of bits and data bytes does not match");let N=0,_=0,E=0;const M=new Array;for(let U=0;U<v;++U){const q=new Int32Array(1),Q=new Int32Array(1);Ln.getNumDataBytesAndNumECBytesForBlockID(p,g,v,U,q,Q);const se=q[0],fe=new Uint8Array(se);f.toBytes(8*N,fe,0,se);const me=Ln.generateECBytes(fe,Q[0]);M.push(new kK(fe,me)),_=Math.max(_,se),E=Math.max(E,me.length),N+=q[0]}if(g!==N)throw new _n("Data bytes does not match offset");const F=new T;for(let U=0;U<_;++U)for(const q of M){const Q=q.getDataBytes();U<Q.length&&F.appendBits(Q[U],8)}for(let U=0;U<E;++U)for(const q of M){const Q=q.getErrorCorrectionBytes();U<Q.length&&F.appendBits(Q[U],8)}if(p!==F.getSizeInBytes())throw new _n("Interleaving error: "+p+" and "+F.getSizeInBytes()+" differ.");return F}static generateECBytes(f,p){const g=f.length,v=new Int32Array(g+p);for(let _=0;_<g;_++)v[_]=f[_]&255;new jw(Ve.QR_CODE_FIELD_256).encode(v,p);const N=new Uint8Array(p);for(let _=0;_<p;_++)N[_]=v[g+_];return N}static appendModeInfo(f,p){p.appendBits(f.getBits(),4)}static appendLengthInfo(f,p,g,v){const N=g.getCharacterCountBits(p);if(f>=1<<N)throw new _n(f+" is bigger than "+((1<<N)-1));v.appendBits(f,N)}static appendBytes(f,p,g,v){switch(p){case _t.NUMERIC:Ln.appendNumericBytes(f,g);break;case _t.ALPHANUMERIC:Ln.appendAlphanumericBytes(f,g);break;case _t.BYTE:Ln.append8BitBytes(f,g,v);break;case _t.KANJI:Ln.appendKanjiBytes(f,g);break;default:throw new _n("Invalid mode: "+p)}}static getDigit(f){return f.charCodeAt(0)-48}static isDigit(f){const p=Ln.getDigit(f);return p>=0&&p<=9}static appendNumericBytes(f,p){const g=f.length;let v=0;for(;v<g;){const N=Ln.getDigit(f.charAt(v));if(v+2<g){const _=Ln.getDigit(f.charAt(v+1)),E=Ln.getDigit(f.charAt(v+2));p.appendBits(N*100+_*10+E,10),v+=3}else if(v+1<g){const _=Ln.getDigit(f.charAt(v+1));p.appendBits(N*10+_,7),v+=2}else p.appendBits(N,4),v++}}static appendAlphanumericBytes(f,p){const g=f.length;let v=0;for(;v<g;){const N=Ln.getAlphanumericCode(f.charCodeAt(v));if(N===-1)throw new _n;if(v+1<g){const _=Ln.getAlphanumericCode(f.charCodeAt(v+1));if(_===-1)throw new _n;p.appendBits(N*45+_,11),v+=2}else p.appendBits(N,6),v++}}static append8BitBytes(f,p,g){let v;try{v=$.encode(f,g)}catch(N){throw new _n(N)}for(let N=0,_=v.length;N!==_;N++){const E=v[N];p.appendBits(E,8)}}static appendKanjiBytes(f,p){let g;try{g=$.encode(f,P.SJIS)}catch(N){throw new _n(N)}const v=g.length;for(let N=0;N<v;N+=2){const _=g[N]&255,E=g[N+1]&255,M=_<<8&4294967295|E;let F=-1;if(M>=33088&&M<=40956?F=M-33088:M>=57408&&M<=60351&&(F=M-49472),F===-1)throw new _n("Invalid byte sequence");const U=(F>>8)*192+(F&255);p.appendBits(U,13)}}static appendECI(f,p){p.appendBits(_t.ECI.getBits(),4),p.appendBits(f.getValue(),8)}}Ln.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ln.DEFAULT_BYTE_MODE_ENCODING=P.UTF8.getName();class md{write(f,p,g,v=null){if(f.length===0)throw new m("Found empty contents");if(p<0||g<0)throw new m("Requested dimensions are too small: "+p+"x"+g);let N=it.L,_=md.QUIET_ZONE_SIZE;v!==null&&(v.get(Fs.ERROR_CORRECTION)!==void 0&&(N=it.fromString(v.get(Fs.ERROR_CORRECTION).toString())),v.get(Fs.MARGIN)!==void 0&&(_=Number.parseInt(v.get(Fs.MARGIN).toString(),10)));const E=Ln.encode(f,N,v);return this.renderResult(E,p,g,_)}writeToDom(f,p,g,v,N=null){typeof f=="string"&&(f=document.querySelector(f));const _=this.write(p,g,v,N);f&&f.appendChild(_)}renderResult(f,p,g,v){const N=f.getMatrix();if(N===null)throw new wt;const _=N.getWidth(),E=N.getHeight(),M=_+v*2,F=E+v*2,U=Math.max(p,M),q=Math.max(g,F),Q=Math.min(Math.floor(U/M),Math.floor(q/F)),se=Math.floor((U-_*Q)/2),fe=Math.floor((q-E*Q)/2),me=this.createSVGElement(U,q);for(let Ne=0,ke=fe;Ne<E;Ne++,ke+=Q)for(let We=0,Ke=se;We<_;We++,Ke+=Q)if(N.get(We,Ne)===1){const Fe=this.createSvgRectElement(Ke,ke,Q,Q);me.appendChild(Fe)}return me}createSVGElement(f,p){const g=document.createElementNS(md.SVG_NS,"svg");return g.setAttributeNS(null,"height",f.toString()),g.setAttributeNS(null,"width",p.toString()),g}createSvgRectElement(f,p,g,v){const N=document.createElementNS(md.SVG_NS,"rect");return N.setAttributeNS(null,"x",f.toString()),N.setAttributeNS(null,"y",p.toString()),N.setAttributeNS(null,"height",g.toString()),N.setAttributeNS(null,"width",v.toString()),N.setAttributeNS(null,"fill","#000000"),N}}md.QUIET_ZONE_SIZE=4,md.SVG_NS="http://www.w3.org/2000/svg";class Vu{encode(f,p,g,v,N){if(f.length===0)throw new m("Found empty contents");if(p!==Z.QR_CODE)throw new m("Can only encode QR_CODE, but got "+p);if(g<0||v<0)throw new m(`Requested dimensions are too small: ${g}x${v}`);let _=it.L,E=Vu.QUIET_ZONE_SIZE;N!==null&&(N.get(Fs.ERROR_CORRECTION)!==void 0&&(_=it.fromString(N.get(Fs.ERROR_CORRECTION).toString())),N.get(Fs.MARGIN)!==void 0&&(E=Number.parseInt(N.get(Fs.MARGIN).toString(),10)));const M=Ln.encode(f,_,N);return Vu.renderResult(M,g,v,E)}static renderResult(f,p,g,v){const N=f.getMatrix();if(N===null)throw new wt;const _=N.getWidth(),E=N.getHeight(),M=_+v*2,F=E+v*2,U=Math.max(p,M),q=Math.max(g,F),Q=Math.min(Math.floor(U/M),Math.floor(q/F)),se=Math.floor((U-_*Q)/2),fe=Math.floor((q-E*Q)/2),me=new K(U,q);for(let Ne=0,ke=fe;Ne<E;Ne++,ke+=Q)for(let We=0,Ke=se;We<_;We++,Ke+=Q)N.get(We,Ne)===1&&me.setRegion(Ke,ke,Q,Q);return me}}Vu.QUIET_ZONE_SIZE=4;class EK{encode(f,p,g,v,N){let _;switch(p){case Z.QR_CODE:_=new Vu;break;default:throw new m("No encoder available for format "+p)}return _.encode(f,p,g,v,N)}}class fl extends G{constructor(f,p,g,v,N,_,E,M){if(super(_,E),this.yuvData=f,this.dataWidth=p,this.dataHeight=g,this.left=v,this.top=N,v+_>p||N+E>g)throw new m("Crop rectangle does not fit within image data.");M&&this.reverseHorizontal(_,E)}getRow(f,p){if(f<0||f>=this.getHeight())throw new m("Requested row is outside the image: "+f);const g=this.getWidth();(p==null||p.length<g)&&(p=new Uint8ClampedArray(g));const v=(f+this.top)*this.dataWidth+this.left;return j.arraycopy(this.yuvData,v,p,0,g),p}getMatrix(){const f=this.getWidth(),p=this.getHeight();if(f===this.dataWidth&&p===this.dataHeight)return this.yuvData;const g=f*p,v=new Uint8ClampedArray(g);let N=this.top*this.dataWidth+this.left;if(f===this.dataWidth)return j.arraycopy(this.yuvData,N,v,0,g),v;for(let _=0;_<p;_++){const E=_*f;j.arraycopy(this.yuvData,N,v,E,f),N+=this.dataWidth}return v}isCropSupported(){return!0}crop(f,p,g,v){return new fl(this.yuvData,this.dataWidth,this.dataHeight,this.left+f,this.top+p,g,v,!1)}renderThumbnail(){const f=this.getWidth()/fl.THUMBNAIL_SCALE_FACTOR,p=this.getHeight()/fl.THUMBNAIL_SCALE_FACTOR,g=new Int32Array(f*p),v=this.yuvData;let N=this.top*this.dataWidth+this.left;for(let _=0;_<p;_++){const E=_*f;for(let M=0;M<f;M++){const F=v[N+M*fl.THUMBNAIL_SCALE_FACTOR]&255;g[E+M]=4278190080|F*65793}N+=this.dataWidth*fl.THUMBNAIL_SCALE_FACTOR}return g}getThumbnailWidth(){return this.getWidth()/fl.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/fl.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(f,p){const g=this.yuvData;for(let v=0,N=this.top*this.dataWidth+this.left;v<p;v++,N+=this.dataWidth){const _=N+f/2;for(let E=N,M=N+f-1;E<_;E++,M--){const F=g[E];g[E]=g[M],g[M]=F}}}invert(){return new J(this)}}fl.THUMBNAIL_SCALE_FACTOR=2;class Sw extends G{constructor(f,p,g,v,N,_,E){if(super(p,g),this.dataWidth=v,this.dataHeight=N,this.left=_,this.top=E,f.BYTES_PER_ELEMENT===4){const M=p*g,F=new Uint8ClampedArray(M);for(let U=0;U<M;U++){const q=f[U],Q=q>>16&255,se=q>>7&510,fe=q&255;F[U]=(Q+se+fe)/4&255}this.luminances=F}else this.luminances=f;if(v===void 0&&(this.dataWidth=p),N===void 0&&(this.dataHeight=g),_===void 0&&(this.left=0),E===void 0&&(this.top=0),this.left+p>this.dataWidth||this.top+g>this.dataHeight)throw new m("Crop rectangle does not fit within image data.")}getRow(f,p){if(f<0||f>=this.getHeight())throw new m("Requested row is outside the image: "+f);const g=this.getWidth();(p==null||p.length<g)&&(p=new Uint8ClampedArray(g));const v=(f+this.top)*this.dataWidth+this.left;return j.arraycopy(this.luminances,v,p,0,g),p}getMatrix(){const f=this.getWidth(),p=this.getHeight();if(f===this.dataWidth&&p===this.dataHeight)return this.luminances;const g=f*p,v=new Uint8ClampedArray(g);let N=this.top*this.dataWidth+this.left;if(f===this.dataWidth)return j.arraycopy(this.luminances,N,v,0,g),v;for(let _=0;_<p;_++){const E=_*f;j.arraycopy(this.luminances,N,v,E,f),N+=this.dataWidth}return v}isCropSupported(){return!0}crop(f,p,g,v){return new Sw(this.luminances,g,v,this.dataWidth,this.dataHeight,this.left+f,this.top+p)}invert(){return new J(this)}}class p5 extends P{static forName(f){return this.getCharacterSetECIByName(f)}}class _w{}_w.ISO_8859_1=P.ISO8859_1;class x5{isCompact(){return this.compact}setCompact(f){this.compact=f}getSize(){return this.size}setSize(f){this.size=f}getLayers(){return this.layers}setLayers(f){this.layers=f}getCodeWords(){return this.codeWords}setCodeWords(f){this.codeWords=f}getMatrix(){return this.matrix}setMatrix(f){this.matrix=f}}class g5{static singletonList(f){return[f]}static min(f,p){return f.sort(p)[0]}}class TK{constructor(f){this.previous=f}getPrevious(){return this.previous}}class Hu extends TK{constructor(f,p,g){super(f),this.value=p,this.bitCount=g}appendTo(f,p){f.appendBits(this.value,this.bitCount)}add(f,p){return new Hu(this,f,p)}addBinaryShift(f,p){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Hu(this,f,p)}toString(){let f=this.value&(1<<this.bitCount)-1;return f|=1<<this.bitCount,"<"+k.toBinaryString(f|1<<this.bitCount).substring(1)+">"}}class Cw extends Hu{constructor(f,p,g){super(f,0,0),this.binaryShiftStart=p,this.binaryShiftByteCount=g}appendTo(f,p){for(let g=0;g<this.binaryShiftByteCount;g++)(g===0||g===31&&this.binaryShiftByteCount<=62)&&(f.appendBits(31,5),this.binaryShiftByteCount>62?f.appendBits(this.binaryShiftByteCount-31,16):g===0?f.appendBits(Math.min(this.binaryShiftByteCount,31),5):f.appendBits(this.binaryShiftByteCount-31,5)),f.appendBits(p[this.binaryShiftStart+g],8)}addBinaryShift(f,p){return new Cw(this,f,p)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function IK(W,f,p){return new Cw(W,f,p)}function Jh(W,f,p){return new Hu(W,f,p)}const PK=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Yo=0,Zx=1,oi=2,y5=3,hl=4,MK=new Hu(null,0,0),Aw=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function OK(W){for(let f of W)A.fill(f,-1);return W[Yo][hl]=0,W[Zx][hl]=0,W[Zx][Yo]=28,W[y5][hl]=0,W[oi][hl]=0,W[oi][Yo]=15,W}const b5=OK(A.createInt32Array(6,6));class ml{constructor(f,p,g,v){this.token=f,this.mode=p,this.binaryShiftByteCount=g,this.bitCount=v}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(f,p){let g=this.bitCount,v=this.token;if(f!==this.mode){let _=Aw[this.mode][f];v=Jh(v,_&65535,_>>16),g+=_>>16}let N=f===oi?4:5;return v=Jh(v,p,N),new ml(v,f,0,g+N)}shiftAndAppend(f,p){let g=this.token,v=this.mode===oi?4:5;return g=Jh(g,b5[this.mode][f],v),g=Jh(g,p,5),new ml(g,this.mode,0,this.bitCount+v+5)}addBinaryShiftChar(f){let p=this.token,g=this.mode,v=this.bitCount;if(this.mode===hl||this.mode===oi){let E=Aw[g][Yo];p=Jh(p,E&65535,E>>16),v+=E>>16,g=Yo}let N=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,_=new ml(p,g,this.binaryShiftByteCount+1,v+N);return _.binaryShiftByteCount===2078&&(_=_.endBinaryShift(f+1)),_}endBinaryShift(f){if(this.binaryShiftByteCount===0)return this;let p=this.token;return p=IK(p,f-this.binaryShiftByteCount,this.binaryShiftByteCount),new ml(p,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(f){let p=this.bitCount+(Aw[this.mode][f.mode]>>16);return this.binaryShiftByteCount<f.binaryShiftByteCount?p+=ml.calculateBinaryShiftCost(f)-ml.calculateBinaryShiftCost(this):this.binaryShiftByteCount>f.binaryShiftByteCount&&f.binaryShiftByteCount>0&&(p+=10),p<=f.bitCount}toBitArray(f){let p=[];for(let v=this.endBinaryShift(f.length).token;v!==null;v=v.getPrevious())p.unshift(v);let g=new T;for(const v of p)v.appendTo(g,f);return g}toString(){return B.format("%s bits=%d bytes=%d",PK[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(f){return f.binaryShiftByteCount>62?21:f.binaryShiftByteCount>31?20:f.binaryShiftByteCount>0?10:0}}ml.INITIAL_STATE=new ml(MK,Yo,0,0);function DK(W){const f=B.getCharCode(" "),p=B.getCharCode("."),g=B.getCharCode(",");W[Yo][f]=1;const v=B.getCharCode("Z"),N=B.getCharCode("A");for(let Q=N;Q<=v;Q++)W[Yo][Q]=Q-N+2;W[Zx][f]=1;const _=B.getCharCode("z"),E=B.getCharCode("a");for(let Q=E;Q<=_;Q++)W[Zx][Q]=Q-E+2;W[oi][f]=1;const M=B.getCharCode("9"),F=B.getCharCode("0");for(let Q=F;Q<=M;Q++)W[oi][Q]=Q-F+2;W[oi][g]=12,W[oi][p]=13;const U=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Q=0;Q<U.length;Q++)W[y5][B.getCharCode(U[Q])]=Q;const q=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Q=0;Q<q.length;Q++)B.getCharCode(q[Q])>0&&(W[hl][B.getCharCode(q[Q])]=Q);return W}const kw=DK(A.createInt32Array(5,256));class em{constructor(f){this.text=f}encode(){const f=B.getCharCode(" "),p=B.getCharCode(`
`);let g=g5.singletonList(ml.INITIAL_STATE);for(let N=0;N<this.text.length;N++){let _,E=N+1<this.text.length?this.text[N+1]:0;switch(this.text[N]){case B.getCharCode("\r"):_=E===p?2:0;break;case B.getCharCode("."):_=E===f?3:0;break;case B.getCharCode(","):_=E===f?4:0;break;case B.getCharCode(":"):_=E===f?5:0;break;default:_=0}_>0?(g=em.updateStateListForPair(g,N,_),N++):g=this.updateStateListForChar(g,N)}return g5.min(g,(N,_)=>N.getBitCount()-_.getBitCount()).toBitArray(this.text)}updateStateListForChar(f,p){const g=[];for(let v of f)this.updateStateForChar(v,p,g);return em.simplifyStates(g)}updateStateForChar(f,p,g){let v=this.text[p]&255,N=kw[f.getMode()][v]>0,_=null;for(let E=0;E<=hl;E++){let M=kw[E][v];if(M>0){if(_==null&&(_=f.endBinaryShift(p)),!N||E===f.getMode()||E===oi){const F=_.latchAndAppend(E,M);g.push(F)}if(!N&&b5[f.getMode()][E]>=0){const F=_.shiftAndAppend(E,M);g.push(F)}}}if(f.getBinaryShiftByteCount()>0||kw[f.getMode()][v]===0){let E=f.addBinaryShiftChar(p);g.push(E)}}static updateStateListForPair(f,p,g){const v=[];for(let N of f)this.updateStateForPair(N,p,g,v);return this.simplifyStates(v)}static updateStateForPair(f,p,g,v){let N=f.endBinaryShift(p);if(v.push(N.latchAndAppend(hl,g)),f.getMode()!==hl&&v.push(N.shiftAndAppend(hl,g)),g===3||g===4){let _=N.latchAndAppend(oi,16-g).latchAndAppend(oi,1);v.push(_)}if(f.getBinaryShiftByteCount()>0){let _=f.addBinaryShiftChar(p).addBinaryShiftChar(p+1);v.push(_)}}static simplifyStates(f){let p=[];for(const g of f){let v=!0;for(const N of p){if(N.isBetterThanOrEqualTo(g)){v=!1;break}g.isBetterThanOrEqualTo(N)&&(p=p.filter(_=>_!==N))}v&&p.push(g)}return p}}class rn{constructor(){}static encodeBytes(f){return rn.encode(f,rn.DEFAULT_EC_PERCENT,rn.DEFAULT_AZTEC_LAYERS)}static encode(f,p,g){let v=new em(f).encode(),N=k.truncDivision(v.getSize()*p,100)+11,_=v.getSize()+N,E,M,F,U,q;if(g!==rn.DEFAULT_AZTEC_LAYERS){if(E=g<0,M=Math.abs(g),M>(E?rn.MAX_NB_BITS_COMPACT:rn.MAX_NB_BITS))throw new m(B.format("Illegal value %s for layers",g));F=rn.totalBitsInLayer(M,E),U=rn.WORD_SIZE[M];let Fe=F-F%U;if(q=rn.stuffBits(v,U),q.getSize()+N>Fe)throw new m("Data to large for user specified layer");if(E&&q.getSize()>U*64)throw new m("Data to large for user specified layer")}else{U=0,q=null;for(let Fe=0;;Fe++){if(Fe>rn.MAX_NB_BITS)throw new m("Data too large for an Aztec code");if(E=Fe<=3,M=E?Fe+1:Fe,F=rn.totalBitsInLayer(M,E),_>F)continue;(q==null||U!==rn.WORD_SIZE[M])&&(U=rn.WORD_SIZE[M],q=rn.stuffBits(v,U));let Jt=F-F%U;if(!(E&&q.getSize()>U*64)&&q.getSize()+N<=Jt)break}}let Q=rn.generateCheckWords(q,F,U),se=q.getSize()/U,fe=rn.generateModeMessage(E,M,se),me=(E?11:14)+M*4,Ne=new Int32Array(me),ke;if(E){ke=me;for(let Fe=0;Fe<Ne.length;Fe++)Ne[Fe]=Fe}else{ke=me+1+2*k.truncDivision(k.truncDivision(me,2)-1,15);let Fe=k.truncDivision(me,2),Jt=k.truncDivision(ke,2);for(let $t=0;$t<Fe;$t++){let da=$t+k.truncDivision($t,15);Ne[Fe-$t-1]=Jt-da-1,Ne[Fe+$t]=Jt+da+1}}let We=new K(ke);for(let Fe=0,Jt=0;Fe<M;Fe++){let $t=(M-Fe)*4+(E?9:12);for(let da=0;da<$t;da++){let Ri=da*2;for(let ua=0;ua<2;ua++)Q.get(Jt+Ri+ua)&&We.set(Ne[Fe*2+ua],Ne[Fe*2+da]),Q.get(Jt+$t*2+Ri+ua)&&We.set(Ne[Fe*2+da],Ne[me-1-Fe*2-ua]),Q.get(Jt+$t*4+Ri+ua)&&We.set(Ne[me-1-Fe*2-ua],Ne[me-1-Fe*2-da]),Q.get(Jt+$t*6+Ri+ua)&&We.set(Ne[me-1-Fe*2-da],Ne[Fe*2+ua])}Jt+=$t*8}if(rn.drawModeMessage(We,E,ke,fe),E)rn.drawBullsEye(We,k.truncDivision(ke,2),5);else{rn.drawBullsEye(We,k.truncDivision(ke,2),7);for(let Fe=0,Jt=0;Fe<k.truncDivision(me,2)-1;Fe+=15,Jt+=16)for(let $t=k.truncDivision(ke,2)&1;$t<ke;$t+=2)We.set(k.truncDivision(ke,2)-Jt,$t),We.set(k.truncDivision(ke,2)+Jt,$t),We.set($t,k.truncDivision(ke,2)-Jt),We.set($t,k.truncDivision(ke,2)+Jt)}let Ke=new x5;return Ke.setCompact(E),Ke.setSize(ke),Ke.setLayers(M),Ke.setCodeWords(se),Ke.setMatrix(We),Ke}static drawBullsEye(f,p,g){for(let v=0;v<g;v+=2)for(let N=p-v;N<=p+v;N++)f.set(N,p-v),f.set(N,p+v),f.set(p-v,N),f.set(p+v,N);f.set(p-g,p-g),f.set(p-g+1,p-g),f.set(p-g,p-g+1),f.set(p+g,p-g),f.set(p+g,p-g+1),f.set(p+g,p+g-1)}static generateModeMessage(f,p,g){let v=new T;return f?(v.appendBits(p-1,2),v.appendBits(g-1,6),v=rn.generateCheckWords(v,28,4)):(v.appendBits(p-1,5),v.appendBits(g-1,11),v=rn.generateCheckWords(v,40,4)),v}static drawModeMessage(f,p,g,v){let N=k.truncDivision(g,2);if(p)for(let _=0;_<7;_++){let E=N-3+_;v.get(_)&&f.set(E,N-5),v.get(_+7)&&f.set(N+5,E),v.get(20-_)&&f.set(E,N+5),v.get(27-_)&&f.set(N-5,E)}else for(let _=0;_<10;_++){let E=N-5+_+k.truncDivision(_,5);v.get(_)&&f.set(E,N-7),v.get(_+10)&&f.set(N+7,E),v.get(29-_)&&f.set(E,N+7),v.get(39-_)&&f.set(N-7,E)}}static generateCheckWords(f,p,g){let v=f.getSize()/g,N=new jw(rn.getGF(g)),_=k.truncDivision(p,g),E=rn.bitsToWords(f,g,_);N.encode(E,_-v);let M=p%g,F=new T;F.appendBits(0,M);for(const U of Array.from(E))F.appendBits(U,g);return F}static bitsToWords(f,p,g){let v=new Int32Array(g),N,_;for(N=0,_=f.getSize()/p;N<_;N++){let E=0;for(let M=0;M<p;M++)E|=f.get(N*p+M)?1<<p-M-1:0;v[N]=E}return v}static getGF(f){switch(f){case 4:return Ve.AZTEC_PARAM;case 6:return Ve.AZTEC_DATA_6;case 8:return Ve.AZTEC_DATA_8;case 10:return Ve.AZTEC_DATA_10;case 12:return Ve.AZTEC_DATA_12;default:throw new m("Unsupported word size "+f)}}static stuffBits(f,p){let g=new T,v=f.getSize(),N=(1<<p)-2;for(let _=0;_<v;_+=p){let E=0;for(let M=0;M<p;M++)(_+M>=v||f.get(_+M))&&(E|=1<<p-1-M);(E&N)===N?(g.appendBits(E&N,p),_--):E&N?g.appendBits(E,p):(g.appendBits(E|1,p),_--)}return g}static totalBitsInLayer(f,p){return((p?88:112)+16*f)*f}}rn.DEFAULT_EC_PERCENT=33,rn.DEFAULT_AZTEC_LAYERS=0,rn.MAX_NB_BITS=32,rn.MAX_NB_BITS_COMPACT=4,rn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Jx{encode(f,p,g,v){return this.encodeWithHints(f,p,g,v,null)}encodeWithHints(f,p,g,v,N){let _=_w.ISO_8859_1,E=rn.DEFAULT_EC_PERCENT,M=rn.DEFAULT_AZTEC_LAYERS;return N!=null&&(N.has(Fs.CHARACTER_SET)&&(_=p5.forName(N.get(Fs.CHARACTER_SET).toString())),N.has(Fs.ERROR_CORRECTION)&&(E=k.parseInt(N.get(Fs.ERROR_CORRECTION).toString())),N.has(Fs.AZTEC_LAYERS)&&(M=k.parseInt(N.get(Fs.AZTEC_LAYERS).toString()))),Jx.encodeLayers(f,p,g,v,_,E,M)}static encodeLayers(f,p,g,v,N,_,E){if(p!==Z.AZTEC)throw new m("Can only encode AZTEC, but got "+p);let M=rn.encode(B.getBytes(f,N),_,E);return Jx.renderResult(M,g,v)}static renderResult(f,p,g){let v=f.getMatrix();if(v==null)throw new wt;let N=v.getWidth(),_=v.getHeight(),E=Math.max(p,N),M=Math.max(g,_),F=Math.min(E/N,M/_),U=(E-N*F)/2,q=(M-_*F)/2,Q=new K(E,M);for(let se=0,fe=q;se<_;se++,fe+=F)for(let me=0,Ne=U;me<N;me++,Ne+=F)v.get(me,se)&&Q.setRegion(Ne,fe,F,F);return Q}}s.AbstractExpandedDecoder=dl,s.ArgumentException=h,s.ArithmeticException=ae,s.AztecCode=x5,s.AztecCodeReader=Ue,s.AztecCodeWriter=Jx,s.AztecDecoder=Me,s.AztecDetector=Ce,s.AztecDetectorResult=St,s.AztecEncoder=rn,s.AztecHighLevelEncoder=em,s.AztecPoint=re,s.BarcodeFormat=Z,s.Binarizer=w,s.BinaryBitmap=x,s.BitArray=T,s.BitMatrix=K,s.BitSource=qh,s.BrowserAztecCodeReader=Qe,s.BrowserBarcodeReader=ud,s.BrowserCodeReader=he,s.BrowserDatamatrixCodeReader=je,s.BrowserMultiFormatReader=_K,s.BrowserPDF417Reader=CK,s.BrowserQRCodeReader=AK,s.BrowserQRCodeSvgWriter=md,s.CharacterSetECI=P,s.ChecksumException=b,s.Code128Reader=$e,s.Code39Reader=Xt,s.DataMatrixDecodedBitStreamParser=Di,s.DataMatrixReader=X,s.DecodeHintType=D,s.DecoderResult=le,s.DefaultGridSampler=Un,s.DetectorResult=De,s.EAN13Reader=Wt,s.EncodeHintType=Fs,s.Exception=u,s.FormatException=O,s.GenericGF=Ve,s.GenericGFPoly=ge,s.GlobalHistogramBinarizer=H,s.GridSampler=Lt,s.GridSamplerInstance=yn,s.HTMLCanvasElementLuminanceSource=ee,s.HybridBinarizer=Y,s.ITFReader=Ut,s.IllegalArgumentException=m,s.IllegalStateException=wt,s.InvertedLuminanceSource=J,s.LuminanceSource=G,s.MathUtils=qe,s.MultiFormatOneDReader=Wo,s.MultiFormatReader=m5,s.MultiFormatWriter=EK,s.NotFoundException=z,s.OneDReader=ht,s.PDF417DecodedBitStreamParser=Ae,s.PDF417DecoderErrorCorrection=o5,s.PDF417Reader=xr,s.PDF417ResultMetadata=d5,s.PerspectiveTransform=Dt,s.PlanarYUVLuminanceSource=fl,s.QRCodeByteMatrix=Qx,s.QRCodeDataMask=ii,s.QRCodeDecodedBitStreamParser=Zn,s.QRCodeDecoderErrorCorrectionLevel=it,s.QRCodeDecoderFormatInformation=Ot,s.QRCodeEncoder=Ln,s.QRCodeEncoderQRCode=hd,s.QRCodeMaskUtil=cs,s.QRCodeMatrixUtil=kt,s.QRCodeMode=_t,s.QRCodeReader=Go,s.QRCodeVersion=bt,s.QRCodeWriter=Vu,s.RGBLuminanceSource=Sw,s.RSS14Reader=Vn,s.RSSExpandedReader=Re,s.ReaderException=Xx,s.ReedSolomonDecoder=jt,s.ReedSolomonEncoder=jw,s.ReedSolomonException=nt,s.Result=be,s.ResultMetadataType=Te,s.ResultPoint=ue,s.StringUtils=B,s.UnsupportedOperationException=L,s.VideoInputDevice=ye,s.WhiteRectangleDetector=tn,s.WriterException=_n,s.ZXingArrays=A,s.ZXingCharset=p5,s.ZXingInteger=k,s.ZXingStandardCharsets=_w,s.ZXingStringBuilder=V,s.ZXingStringEncoding=$,s.ZXingSystem=j,s.createAbstractExpandedDecoder=dd,Object.defineProperty(s,"__esModule",{value:!0})})})(oC,oC.exports);var Fn=oC.exports;const QDe=Ii(Fn),ZDe=YR({__proto__:null,default:QDe},[Fn]);var CR=function(){function t(n,s,r){if(this.formatMap=new Map([[ot.QR_CODE,Fn.BarcodeFormat.QR_CODE],[ot.AZTEC,Fn.BarcodeFormat.AZTEC],[ot.CODABAR,Fn.BarcodeFormat.CODABAR],[ot.CODE_39,Fn.BarcodeFormat.CODE_39],[ot.CODE_93,Fn.BarcodeFormat.CODE_93],[ot.CODE_128,Fn.BarcodeFormat.CODE_128],[ot.DATA_MATRIX,Fn.BarcodeFormat.DATA_MATRIX],[ot.MAXICODE,Fn.BarcodeFormat.MAXICODE],[ot.ITF,Fn.BarcodeFormat.ITF],[ot.EAN_13,Fn.BarcodeFormat.EAN_13],[ot.EAN_8,Fn.BarcodeFormat.EAN_8],[ot.PDF_417,Fn.BarcodeFormat.PDF_417],[ot.RSS_14,Fn.BarcodeFormat.RSS_14],[ot.RSS_EXPANDED,Fn.BarcodeFormat.RSS_EXPANDED],[ot.UPC_A,Fn.BarcodeFormat.UPC_A],[ot.UPC_E,Fn.BarcodeFormat.UPC_E],[ot.UPC_EAN_EXTENSION,Fn.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!ZDe)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=s,this.logger=r;var i=this.createZXingFormats(n),l=new Map;l.set(Fn.DecodeHintType.POSSIBLE_FORMATS,i),l.set(Fn.DecodeHintType.TRY_HARDER,!1),this.hints=l}return t.prototype.decodeAsync=function(n){var s=this;return new Promise(function(r,i){try{r(s.decode(n))}catch(l){i(l)}})},t.prototype.decode=function(n){var s=new Fn.MultiFormatReader(this.verbose,this.hints),r=new Fn.HTMLCanvasElementLuminanceSource(n),i=new Fn.BinaryBitmap(new Fn.HybridBinarizer(r)),l=s.decode(i);return{text:l.text,format:XG.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var n=new Map;return this.formatMap.forEach(function(s,r,i){n.set(s,r)}),n},t.prototype.toHtml5QrcodeSupportedFormats=function(n){if(!this.reverseFormatMap.has(n))throw"reverseFormatMap doesn't have ".concat(n);return this.reverseFormatMap.get(n)},t.prototype.createZXingFormats=function(n){for(var s=[],r=0,i=n;r<i.length;r++){var l=i[r];this.formatMap.has(l)?s.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return s},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),JDe=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},eRe=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},AR=function(){function t(n,s,r){if(this.formatMap=new Map([[ot.QR_CODE,"qr_code"],[ot.AZTEC,"aztec"],[ot.CODABAR,"codabar"],[ot.CODE_39,"code_39"],[ot.CODE_93,"code_93"],[ot.CODE_128,"code_128"],[ot.DATA_MATRIX,"data_matrix"],[ot.ITF,"itf"],[ot.EAN_13,"ean_13"],[ot.EAN_8,"ean_8"],[ot.PDF_417,"pdf417"],[ot.UPC_A,"upc_a"],[ot.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=s,this.logger=r;var i=this.createBarcodeDetectorFormats(n);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var n=new BarcodeDetector({formats:["qr_code"]});return typeof n<"u"},t.prototype.decodeAsync=function(n){return JDe(this,void 0,void 0,function(){var s,r;return eRe(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(n)];case 1:if(s=i.sent(),!s||s.length===0)throw"No barcode or QR code detected.";return r=this.selectLargestBarcode(s),[2,{text:r.rawValue,format:XG.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(n){for(var s=null,r=0,i=0,l=n;i<l.length;i++){var o=l[i],c=o.boundingBox.width*o.boundingBox.height;c>r&&(r=c,s=o)}if(!s)throw"No largest barcode found";return s},t.prototype.createBarcodeDetectorFormats=function(n){for(var s=[],r=0,i=n;r<i.length;r++){var l=i[r];this.formatMap.has(l)?s.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:s}},t.prototype.toHtml5QrcodeSupportedFormats=function(n){if(!this.reverseFormatMap.has(n))throw"reverseFormatMap doesn't have ".concat(n);return this.reverseFormatMap.get(n)},t.prototype.createReverseFormatMap=function(){var n=new Map;return this.formatMap.forEach(function(s,r,i){n.set(s,r)}),n},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),kR=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},ER=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},tRe=function(){function t(n,s,r,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,s&&AR.isSupported()?(this.primaryDecoder=new AR(n,r,i),this.secondaryDecoder=new CR(n,r,i)):this.primaryDecoder=new CR(n,r,i)}return t.prototype.decodeAsync=function(n){return kR(this,void 0,void 0,function(){var s;return ER(this,function(r){switch(r.label){case 0:s=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(n)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(s),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(n){return kR(this,void 0,void 0,function(){var s,r;return ER(this,function(i){switch(i.label){case 0:s=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(n)];case 2:return[2,i.sent()];case 3:if(r=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(n)];throw r;case 4:return this.possiblyLogPerformance(s),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(n){if(this.verbose){var s=performance.now()-n;this.executionResults.push(s),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var n=0,s=0,r=this.executionResults;s<r.length;s++){var i=r[s];n+=i}var l=n/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),a5=function(){var t=function(n,s){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(r[l]=i[l])},t(n,s)};return function(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");t(n,s);function r(){this.constructor=n}n.prototype=s===null?Object.create(s):(r.prototype=s.prototype,new r)}}(),Zy=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},Jy=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},eK=function(){function t(n,s){this.name=n,this.track=s}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(n){var s={};s[this.name]=n;var r={advanced:[s]};return this.track.applyConstraints(r)},t.prototype.value=function(){var n=this.track.getSettings();if(this.name in n){var s=n[this.name];return s}return null},t}(),nRe=function(t){a5(n,t);function n(s,r){return t.call(this,s,r)||this}return n.prototype.min=function(){return this.getCapabilities().min},n.prototype.max=function(){return this.getCapabilities().max},n.prototype.step=function(){return this.getCapabilities().step},n.prototype.apply=function(s){var r={};r[this.name]=s;var i={advanced:[r]};return this.track.applyConstraints(i)},n.prototype.getCapabilities=function(){this.failIfNotSupported();var s=this.track.getCapabilities(),r=s[this.name];return{min:r.min,max:r.max,step:r.step}},n.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},n}(eK),sRe=function(t){a5(n,t);function n(s){return t.call(this,"zoom",s)||this}return n}(nRe),rRe=function(t){a5(n,t);function n(s){return t.call(this,"torch",s)||this}return n}(eK),aRe=function(){function t(n){this.track=n}return t.prototype.zoomFeature=function(){return new sRe(this.track)},t.prototype.torchFeature=function(){return new rRe(this.track)},t}(),iRe=function(){function t(n,s,r){this.isClosed=!1,this.parentElement=n,this.mediaStream=s,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),n.append(this.surface)}return t.prototype.createVideoElement=function(n){var s=document.createElement("video");return s.style.width="".concat(n,"px"),s.style.display="block",s.muted=!0,s.setAttribute("muted","true"),s.playsInline=!0,s},t.prototype.setupSurface=function(){var n=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var s=function(){var r=n.surface.clientWidth,i=n.surface.clientHeight;n.callbacks.onRenderSurfaceReady(r,i),n.surface.removeEventListener("playing",s)};this.surface.addEventListener("playing",s),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(n,s,r,i){return Zy(this,void 0,void 0,function(){var l,o;return Jy(this,function(c){switch(c.label){case 0:return l=new t(n,s,i),r.aspectRatio?(o={aspectRatio:r.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:c.sent(),c.label=2;case 2:return l.setupSurface(),[2,l]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(n){this.failIfClosed();var s=this,r=function(){setTimeout(n,200),s.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(n){return Zy(this,void 0,void 0,function(){return Jy(this,function(s){if("aspectRatio"in n)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(n)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var n=this;return new Promise(function(s,r){var i=n.mediaStream.getVideoTracks(),l=i.length,o=0;n.mediaStream.getVideoTracks().forEach(function(c){n.mediaStream.removeTrack(c),c.stop(),++o,o>=l&&(n.isClosed=!0,n.parentElement.removeChild(n.surface),s())})})},t.prototype.getCapabilities=function(){return new aRe(this.getFirstTrackOrFail())},t}(),lRe=function(){function t(n){this.mediaStream=n}return t.prototype.render=function(n,s,r){return Zy(this,void 0,void 0,function(){return Jy(this,function(i){return[2,iRe.create(n,this.mediaStream,s,r)]})})},t.create=function(n){return Zy(this,void 0,void 0,function(){var s,r;return Jy(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return s={audio:!1,video:n},[4,navigator.mediaDevices.getUserMedia(s)];case 1:return r=i.sent(),[2,new t(r)]}})})},t}(),TR=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},IR=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},oRe=function(){function t(){}return t.failIfNotSupported=function(){return TR(this,void 0,void 0,function(){return IR(this,function(n){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(n){return TR(this,void 0,void 0,function(){return IR(this,function(s){return[2,lRe.create(n)]})})},t}(),cRe=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},dRe=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},uRe=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var n=MediaStreamTrack;return MediaStreamTrack&&n.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var n=Af.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(n=Af.insecureContextCameraQueryError()),Promise.reject(n)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var n=location.host.split(":")[0];return n==="127.0.0.1"||n==="localhost"},t.getCamerasFromMediaDevices=function(){return cRe(this,void 0,void 0,function(){var n,s,r,i,l,o,c;return dRe(this,function(d){switch(d.label){case 0:return n=function(u){for(var h=u.getVideoTracks(),m=0,x=h;m<x.length;m++){var b=x[m];b.enabled=!1,b.stop(),u.removeTrack(b)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return s=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=d.sent(),i=[],l=0,o=r;l<o.length;l++)c=o[l],c.kind==="videoinput"&&i.push({id:c.deviceId,label:c.label});return n(s),[2,i]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(n,s){var r=function(l){for(var o=[],c=0,d=l;c<d.length;c++){var u=d[c];u.kind==="video"&&o.push({id:u.id,label:u.label})}n(o)},i=MediaStreamTrack;i.getSources(r)})},t}(),ds;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(ds||(ds={}));var fRe=function(){function t(){this.state=ds.NOT_STARTED,this.onGoingTransactionNewState=ds.UNKNOWN}return t.prototype.directTransition=function(n){this.failIfTransitionOngoing(),this.validateTransition(n),this.state=n},t.prototype.startTransition=function(n){return this.failIfTransitionOngoing(),this.validateTransition(n),this.onGoingTransactionNewState=n,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===ds.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var n=this.onGoingTransactionNewState;this.onGoingTransactionNewState=ds.UNKNOWN,this.directTransition(n)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===ds.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=ds.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==ds.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(n){switch(this.state){case ds.UNKNOWN:throw"Transition from unknown is not allowed";case ds.NOT_STARTED:this.failIfNewStateIs(n,[ds.PAUSED]);break;case ds.SCANNING:break;case ds.PAUSED:break}},t.prototype.failIfNewStateIs=function(n,s){for(var r=0,i=s;r<i.length;r++){var l=i[r];if(n===l)throw"Cannot transition from ".concat(this.state," to ").concat(n)}},t}(),hRe=function(){function t(n){this.stateManager=n}return t.prototype.startTransition=function(n){return this.stateManager.startTransition(n)},t.prototype.directTransition=function(n){this.stateManager.directTransition(n)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===ds.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==ds.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===ds.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===ds.PAUSED},t}(),mRe=function(){function t(){}return t.create=function(){return new hRe(new fRe)},t}(),pRe=function(){var t=function(n,s){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(r[l]=i[l])},t(n,s)};return function(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");t(n,s);function r(){this.constructor=n}n.prototype=s===null?Object.create(s):(r.prototype=s.prototype,new r)}}(),Ma=function(t){pRe(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.DEFAULT_WIDTH=300,n.DEFAULT_WIDTH_OFFSET=2,n.FILE_SCAN_MIN_HEIGHT=300,n.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,n.MIN_QR_BOX_SIZE=50,n.SHADED_LEFT=1,n.SHADED_RIGHT=2,n.SHADED_TOP=3,n.SHADED_BOTTOM=4,n.SHADED_REGION_ELEMENT_ID="qr-shaded-region",n.VERBOSE=!1,n.BORDER_SHADER_DEFAULT_COLOR="#ffffff",n.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",n}(Vi),xRe=function(){function t(n,s){this.logger=s,this.fps=Ma.SCAN_DEFAULT_FPS,n?(n.fps&&(this.fps=n.fps),this.disableFlip=n.disableFlip===!0,this.qrbox=n.qrbox,this.aspectRatio=n.aspectRatio,this.videoConstraints=n.videoConstraints):this.disableFlip=Ma.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?JG.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!Nl(this.qrbox)},t.create=function(n,s){return new t(n,s)},t}(),PR=function(){function t(n,s){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(n))throw"HTML Element with id=".concat(n," not found");this.elementId=n,this.verbose=!1;var r;typeof s=="boolean"?this.verbose=s===!0:s&&(r=s,this.verbose=r.verbose===!0,r.experimentalFeatures),this.logger=new ZG(this.verbose),this.qrcode=new tRe(this.getSupportedFormats(s),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=mRe.create()}return t.prototype.start=function(n,s,r,i){var l=this;if(!n)throw"cameraIdOrConfig is required";if(!r||typeof r!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;i?o=i:o=this.verbose?this.logger.log:function(){};var c=xRe.create(s,this.logger);this.clearElement();var d=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var u=d,h=document.getElementById(this.elementId);h.clientWidth?h.clientWidth:Ma.DEFAULT_WIDTH,h.style.position="relative",this.shouldScan=!0,this.element=h;var m=this,x=this.stateManagerProxy.startTransition(ds.SCANNING);return new Promise(function(b,w){var j=u?c.videoConstraints:m.createVideoConstraints(n);if(!j){x.cancel(),w("videoConstraints should be defined");return}var S={};(!u||c.aspectRatio)&&(S.aspectRatio=c.aspectRatio);var C={onRenderSurfaceReady:function(A,k){m.setupUi(A,k,c),m.isScanning=!0,m.foreverScan(c,r,o)}};oRe.failIfNotSupported().then(function(A){A.create(j).then(function(k){return k.render(l.element,S,C).then(function(T){m.renderedCamera=T,x.execute(),b(null)}).catch(function(T){x.cancel(),w(T)})}).catch(function(k){x.cancel(),w(Af.errorGettingUserMedia(k))})}).catch(function(A){x.cancel(),w(Af.cameraStreamingNotSupported())})})},t.prototype.pause=function(n){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(ds.PAUSED),this.showPausedState(),(Nl(n)||n!==!0)&&(n=!1),n&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var n=this,s=function(){n.stateManagerProxy.directTransition(ds.SCANNING),n.hidePausedState()};if(!this.renderedCamera.isPaused()){s();return}this.renderedCamera.resume(function(){s()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var n=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var s=this.stateManagerProxy.startTransition(ds.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=function(){if(n.element){var l=document.getElementById(Ma.SHADED_REGION_ELEMENT_ID);l&&n.element.removeChild(l)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),r(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),s.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(n,s){return this.scanFileV2(n,s).then(function(r){return r.decodedText})},t.prototype.scanFileV2=function(n,s){var r=this;if(!n||!(n instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Nl(s)&&(s=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,l){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(n);var o=new Image;o.onload=function(){var c=o.width,d=o.height,u=document.getElementById(r.elementId),h=u.clientWidth?u.clientWidth:Ma.DEFAULT_WIDTH,m=Math.max(u.clientHeight?u.clientHeight:d,Ma.FILE_SCAN_MIN_HEIGHT),x=r.computeCanvasDrawConfig(c,d,h,m);if(s){var b=r.createCanvasElement(h,m,"qr-canvas-visible");b.style.display="inline-block",u.appendChild(b);var w=b.getContext("2d");if(!w)throw"Unable to get 2d context from canvas";w.canvas.width=h,w.canvas.height=m,w.drawImage(o,0,0,c,d,x.x,x.y,x.width,x.height)}var j=Ma.FILE_SCAN_HIDDEN_CANVAS_PADDING,S=Math.max(o.width,x.width),C=Math.max(o.height,x.height),A=S+2*j,k=C+2*j,T=r.createCanvasElement(A,k);u.appendChild(T);var I=T.getContext("2d");if(!I)throw"Unable to get 2d context from canvas";I.canvas.width=A,I.canvas.height=k,I.drawImage(o,0,0,c,d,j,j,S,C);try{r.qrcode.decodeRobustlyAsync(T).then(function(D){i(SR.createFromQrcodeResult(D))}).catch(l)}catch(D){l("QR code parse error, error = ".concat(D))}},o.onerror=l,o.onabort=l,o.onstalled=l,o.onsuspend=l,o.src=URL.createObjectURL(n)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return uRe.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(n){if(n){if(!JG.isMediaStreamConstraintsValid(n,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(n)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(n){var s=[ot.QR_CODE,ot.AZTEC,ot.CODABAR,ot.CODE_39,ot.CODE_93,ot.CODE_128,ot.DATA_MATRIX,ot.MAXICODE,ot.ITF,ot.EAN_13,ot.EAN_8,ot.PDF_417,ot.RSS_14,ot.RSS_EXPANDED,ot.UPC_A,ot.UPC_E,ot.UPC_EAN_EXTENSION];if(!n||typeof n=="boolean"||!n.formatsToSupport)return s;if(!Array.isArray(n.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(n.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],i=0,l=n.formatsToSupport;i<l.length;i++){var o=l[i];YDe(o)?r.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(r.length===0)throw"None of formatsToSupport match supported values.";return r},t.prototype.getUseBarCodeDetectorIfSupported=function(n){if(Nl(n))return!0;if(!Nl(n.useBarCodeDetectorIfSupported))return n.useBarCodeDetectorIfSupported!==!1;if(Nl(n.experimentalFeatures))return!0;var s=n.experimentalFeatures;return Nl(s.useBarCodeDetectorIfSupported)?!0:s.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(n,s,r){var i=this,l=r.qrbox;this.validateQrboxConfig(l);var o=this.toQrdimensions(n,s,l),c=function(u){if(u<Ma.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ma.MIN_QR_BOX_SIZE,"px.")},d=function(u){return u>n&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),u=n),u};c(o.width),c(o.height),o.width=d(o.width)},t.prototype.validateQrboxConfig=function(n){if(typeof n!="number"&&typeof n!="function"&&(n.width===void 0||n.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(n,s,r){if(typeof r=="number")return{width:r,height:r};if(typeof r=="function")try{return r(n,s)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return r},t.prototype.setupUi=function(n,s,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(n,s,r);var i=Nl(r.qrbox)?{width:n,height:s}:r.qrbox;this.validateQrboxConfig(i);var l=this.toQrdimensions(n,s,i);l.height>s&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=r.isShadedBoxEnabled()&&l.height<=s,c={x:0,y:0,width:n,height:s},d=o?this.getShadedRegionBounds(n,s,l):c,u=this.createCanvasElement(d.width,d.height),h={willReadFrequently:!0},m=u.getContext("2d",h);m.canvas.width=d.width,m.canvas.height=d.height,this.element.append(u),o&&this.possiblyInsertShadingElement(this.element,n,s,l),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=m,this.canvasElement=u},t.prototype.createScannerPausedUiElement=function(n){var s=document.createElement("div");s.innerText=Af.scannerPaused(),s.style.display="none",s.style.position="absolute",s.style.top="0px",s.style.zIndex="1",s.style.background="rgba(9, 9, 9, 0.46)",s.style.color="#FFECEC",s.style.textAlign="center",s.style.width="100%",n.appendChild(s),this.scannerPausedUiElement=s},t.prototype.scanContext=function(n,s){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return n(i.text,SR.createFromQrcodeResult(i)),r.possiblyUpdateShaders(!0),!0}).catch(function(i){r.possiblyUpdateShaders(!1);var l=Af.codeParseError(i);return s(l,QG.createFrom(l)),!1})},t.prototype.foreverScan=function(n,s,r){var i=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),o=l.videoWidth/l.clientWidth,c=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*o,u=this.qrRegion.height*c,h=this.qrRegion.x*o,m=this.qrRegion.y*c;this.context.drawImage(l,h,m,d,u,0,0,this.qrRegion.width,this.qrRegion.height);var x=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(n,s,r)},i.getTimeoutFps(n.fps))};this.scanContext(s,r).then(function(b){!b&&n.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(s,r).finally(function(){x()})):x()}).catch(function(b){i.logger.logError("Error happend while scanning context",b),x()})}},t.prototype.createVideoConstraints=function(n){if(typeof n=="string")return{deviceId:{exact:n}};if(typeof n=="object"){var s="facingMode",r="deviceId",i={user:!0,environment:!0},l="exact",o=function(w){if(w in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(w,"'")},c=Object.keys(n);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var d=Object.keys(n)[0];if(d!==s&&d!==r)throw"Only '".concat(s,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(d===s){var u=n.facingMode;if(typeof u=="string"){if(o(u))return{facingMode:u}}else if(typeof u=="object")if(l in u){if(o(u["".concat(l)]))return{facingMode:{exact:u["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var h=typeof u;throw"Invalid type of 'facingMode' = ".concat(h)}}else{var m=n.deviceId;if(typeof m=="string")return{deviceId:m};if(typeof m=="object"){if(l in m)return{deviceId:{exact:m["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var x=typeof m;throw"Invalid type of 'deviceId' = ".concat(x)}}}var b=typeof n;throw"Invalid type of 'cameraIdOrConfig' = ".concat(b)},t.prototype.computeCanvasDrawConfig=function(n,s,r,i){if(n<=r&&s<=i){var l=(r-n)/2,o=(i-s)/2;return{x:l,y:o,width:n,height:s}}else{var c=n,d=s;return n>r&&(s=r/n*s,n=r),s>i&&(n=i/s*n,s=i),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(d)+" to ".concat(n,"X").concat(s,".")),this.computeCanvasDrawConfig(n,s,r,i)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var n=document.getElementById(this.elementId);n&&(n.innerHTML="")},t.prototype.possiblyUpdateShaders=function(n){this.qrMatch!==n&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(s){s.style.backgroundColor=n?Ma.BORDER_SHADER_MATCH_COLOR:Ma.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=n)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(n,s,r){var i=n,l=s,o=document.createElement("canvas");return o.style.width="".concat(i,"px"),o.style.height="".concat(l,"px"),o.style.display="none",o.id=Nl(r)?"qr-canvas":r,o},t.prototype.getShadedRegionBounds=function(n,s,r){if(r.width>n||r.height>s)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(n-r.width)/2,y:(s-r.height)/2,width:r.width,height:r.height}},t.prototype.possiblyInsertShadingElement=function(n,s,r,i){if(!(s-i.width<1||r-i.height<1)){var l=document.createElement("div");l.style.position="absolute";var o=(s-i.width)/2,c=(r-i.height)/2;if(l.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(Ma.SHADED_REGION_ELEMENT_ID),s-i.width<11||r-i.height<11)this.hasBorderShaders=!1;else{var d=5,u=40;this.insertShaderBorders(l,u,d,-d,null,0,!0),this.insertShaderBorders(l,u,d,-d,null,0,!1),this.insertShaderBorders(l,u,d,null,-d,0,!0),this.insertShaderBorders(l,u,d,null,-d,0,!1),this.insertShaderBorders(l,d,u+d,-d,null,-d,!0),this.insertShaderBorders(l,d,u+d,null,-d,-d,!0),this.insertShaderBorders(l,d,u+d,-d,null,-d,!1),this.insertShaderBorders(l,d,u+d,null,-d,-d,!1),this.hasBorderShaders=!0}n.append(l)}},t.prototype.insertShaderBorders=function(n,s,r,i,l,o,c){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=Ma.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(s,"px"),d.style.height="".concat(r,"px"),i!==null&&(d.style.top="".concat(i,"px")),l!==null&&(d.style.bottom="".concat(l,"px")),c?d.style.left="".concat(o,"px"):d.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),n.appendChild(d)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(n){return 1e3/n},t}(),i5="data:image/svg+xml;base64,",gRe=i5+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",yRe=i5+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",MR=i5+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",bRe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",OR=function(){function t(){}return t.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},t}(),vRe=function(){function t(){this.data=OR.createDefault();var n=localStorage.getItem(t.LOCAL_STORAGE_KEY);n?this.data=JSON.parse(n):this.reset()}return t.prototype.hasCameraPermissions=function(){return this.data.hasPermission},t.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},t.prototype.setHasPermission=function(n){this.data.hasPermission=n,this.flush()},t.prototype.setLastUsedCameraId=function(n){this.data.lastUsedCameraId=n,this.flush()},t.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},t.prototype.reset=function(){this.data=OR.createDefault(),this.flush()},t.prototype.flush=function(){localStorage.setItem(t.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},t.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",t}(),wRe=function(){function t(){this.infoDiv=document.createElement("div")}return t.prototype.renderInto=function(n){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=_R.poweredBy();var s=document.createElement("a");s.innerText="ScanApp",s.href="https://scanapp.org",s.target="new",s.style.color="white",this.infoDiv.appendChild(s);var r=document.createElement("br"),i=document.createElement("br");this.infoDiv.appendChild(r),this.infoDiv.appendChild(i);var l=document.createElement("a");l.innerText=_R.reportIssues(),l.href="https://github.com/mebjas/html5-qrcode/issues",l.target="new",l.style.color="white",this.infoDiv.appendChild(l),n.appendChild(this.infoDiv)},t.prototype.show=function(){this.infoDiv.style.display="block"},t.prototype.hide=function(){this.infoDiv.style.display="none"},t}(),NRe=function(){function t(n,s){this.isShowingInfoIcon=!0,this.onTapIn=n,this.onTapOut=s,this.infoIcon=document.createElement("img")}return t.prototype.renderInto=function(n){var s=this;this.infoIcon.alt="Info icon",this.infoIcon.src=MR,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(r){return s.onHoverIn()},this.infoIcon.onmouseout=function(r){return s.onHoverOut()},this.infoIcon.onclick=function(r){return s.onClick()},n.appendChild(this.infoIcon)},t.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},t.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},t.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=bRe,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=MR,this.infoIcon.style.opacity="0.6")},t}(),jRe=function(){function t(){var n=this;this.infoDiv=new wRe,this.infoIcon=new NRe(function(){n.infoDiv.show()},function(){n.infoDiv.hide()})}return t.prototype.renderInto=function(n){this.infoDiv.renderInto(n),this.infoIcon.renderInto(n)},t}(),SRe=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},_Re=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},DR=function(){function t(){}return t.hasPermissions=function(){return SRe(this,void 0,void 0,function(){var n,s,r,i;return _Re(this,function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(n=l.sent(),s=0,r=n;s<r.length;s++)if(i=r[s],i.kind==="videoinput"&&i.label)return[2,!0];return[2,!1]}})})},t}(),tc=function(){function t(n){this.supportedScanTypes=this.validateAndReturnScanTypes(n)}return t.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},t.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},t.prototype.isCameraScanRequired=function(){for(var n=0,s=this.supportedScanTypes;n<s.length;n++){var r=s[n];if(t.isCameraScanType(r))return!0}return!1},t.isCameraScanType=function(n){return n===Kc.SCAN_TYPE_CAMERA},t.isFileScanType=function(n){return n===Kc.SCAN_TYPE_FILE},t.prototype.validateAndReturnScanTypes=function(n){if(!n||n.length===0)return Vi.DEFAULT_SUPPORTED_SCAN_TYPE;var s=Vi.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(n.length>s)throw"Max ".concat(s," values expected for ")+"supportedScanTypes";for(var r=0,i=n;r<i.length;r++){var l=i[r];if(!Vi.DEFAULT_SUPPORTED_SCAN_TYPE.includes(l))throw"Unsupported scan type ".concat(l)}return n},t}(),za=function(){function t(){}return t.ALL_ELEMENT_CLASS="html5-qrcode-element",t.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",t.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",t.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",t.TORCH_BUTTON_ID="html5-qrcode-button-torch",t.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",t.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",t.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",t.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",t.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",t.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",t}(),mo=function(){function t(){}return t.createElement=function(n,s){var r=document.createElement(n);return r.id=s,r.classList.add(za.ALL_ELEMENT_CLASS),n==="button"&&r.setAttribute("type","button"),r},t}(),tK=function(t,n,s,r){function i(l){return l instanceof s?l:new s(function(o){o(l)})}return new(s||(s=Promise))(function(l,o){function c(h){try{u(r.next(h))}catch(m){o(m)}}function d(h){try{u(r.throw(h))}catch(m){o(m)}}function u(h){h.done?l(h.value):i(h.value).then(c,d)}u((r=r.apply(t,n||[])).next())})},nK=function(t,n){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,i,l,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(r=1,i&&(l=u[0]&2?i.return:u[0]?i.throw||((l=i.return)&&l.call(i),0):i.next)&&!(l=l.call(i,u[1])).done)return l;switch(i=0,l&&(u=[u[0]&2,l.value]),u[0]){case 0:case 1:l=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,i=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(u[0]===6||u[0]===2)){s=0;continue}if(u[0]===3&&(!l||u[1]>l[0]&&u[1]<l[3])){s.label=u[1];break}if(u[0]===6&&s.label<l[1]){s.label=l[1],l=u;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(u);break}l[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(t,s)}catch(h){u=[6,h],i=0}finally{r=l=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},RR=function(){function t(n,s,r){this.isTorchOn=!1,this.torchCapability=n,this.buttonController=s,this.onTorchActionFailureCallback=r}return t.prototype.isTorchEnabled=function(){return this.isTorchOn},t.prototype.flipState=function(){return tK(this,void 0,void 0,function(){var n,s;return nK(this,function(r){switch(r.label){case 0:this.buttonController.disable(),n=!this.isTorchOn,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.torchCapability.apply(n)];case 2:return r.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),n),[3,4];case 3:return s=r.sent(),this.propagateFailure(n,s),this.buttonController.enable(),[3,4];case 4:return[2]}})})},t.prototype.updateUiBasedOnLatestSettings=function(n,s){n===s?(this.buttonController.setText(s?hn.torchOffButton():hn.torchOnButton()),this.isTorchOn=s):this.propagateFailure(s),this.buttonController.enable()},t.prototype.propagateFailure=function(n,s){var r=n?hn.torchOnFailedMessage():hn.torchOffFailedMessage();s&&(r+="; Error = "+s),this.onTorchActionFailureCallback(r)},t.prototype.reset=function(){this.isTorchOn=!1},t}(),CRe=function(){function t(n,s){this.onTorchActionFailureCallback=s,this.torchButton=mo.createElement("button",za.TORCH_BUTTON_ID),this.torchController=new RR(n,this,s)}return t.prototype.render=function(n,s){var r=this;this.torchButton.innerText=hn.torchOnButton(),this.torchButton.style.display=s.display,this.torchButton.style.marginLeft=s.marginLeft;var i=this;this.torchButton.addEventListener("click",function(l){return tK(r,void 0,void 0,function(){return nK(this,function(o){switch(o.label){case 0:return[4,i.torchController.flipState()];case 1:return o.sent(),i.torchController.isTorchEnabled()?(i.torchButton.classList.remove(za.TORCH_BUTTON_CLASS_TORCH_OFF),i.torchButton.classList.add(za.TORCH_BUTTON_CLASS_TORCH_ON)):(i.torchButton.classList.remove(za.TORCH_BUTTON_CLASS_TORCH_ON),i.torchButton.classList.add(za.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),n.appendChild(this.torchButton)},t.prototype.updateTorchCapability=function(n){this.torchController=new RR(n,this,this.onTorchActionFailureCallback)},t.prototype.getTorchButton=function(){return this.torchButton},t.prototype.hide=function(){this.torchButton.style.display="none"},t.prototype.show=function(){this.torchButton.style.display="inline-block"},t.prototype.disable=function(){this.torchButton.disabled=!0},t.prototype.enable=function(){this.torchButton.disabled=!1},t.prototype.setText=function(n){this.torchButton.innerText=n},t.prototype.reset=function(){this.torchButton.innerText=hn.torchOnButton(),this.torchController.reset()},t.create=function(n,s,r,i){var l=new t(s,i);return l.render(n,r),l},t}(),ARe=function(){function t(n,s,r){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=s?"block":"none",n.appendChild(this.fileBasedScanRegion);var i=document.createElement("label");i.setAttribute("for",this.getFileScanInputId()),i.style.display="inline-block",this.fileBasedScanRegion.appendChild(i),this.fileSelectionButton=mo.createElement("button",za.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(c){i.click()}),i.append(this.fileSelectionButton),this.fileScanInput=mo.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",i.appendChild(this.fileScanInput);var l=this;this.fileScanInput.addEventListener("change",function(c){if(!(c==null||c.target==null)){var d=c.target;if(!(d.files&&d.files.length===0)){var u=d.files,h=u[0],m=h.name;l.setImageNameToButton(m),r(h)}}});var o=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(o),this.fileBasedScanRegion.addEventListener("dragenter",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(c){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),c.stopPropagation(),c.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(c){c.stopPropagation(),c.preventDefault(),l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder();var d=c.dataTransfer;if(d){var u=d.files;if(!u||u.length===0)return;for(var h=!1,m=0;m<u.length;++m){var x=u.item(m);if(x){var b=/image.*/;if(x.type.match(b)){h=!0;var w=x.name;l.setImageNameToButton(w),r(x),o.innerText=hn.dragAndDropMessage();break}}}h||(o.innerText=hn.dragAndDropMessageOnlyImages())}})}return t.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},t.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},t.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},t.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},t.prototype.createFileBasedScanRegion=function(){var n=document.createElement("div");return n.style.textAlign="center",n.style.margin="auto",n.style.width="80%",n.style.maxWidth="600px",n.style.border=this.fileBasedScanRegionDefaultBorder(),n.style.padding="10px",n.style.marginBottom="10px",n},t.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},t.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},t.prototype.createDragAndDropMessage=function(){var n=document.createElement("div");return n.innerText=hn.dragAndDropMessage(),n.style.fontWeight="400",n},t.prototype.setImageNameToButton=function(n){var s=20;if(n.length>s){var r=n.substring(0,8),i=n.length,l=n.substring(i-8,i);n="".concat(r,"....").concat(l)}var o=hn.fileSelectionChooseAnother()+" - "+n;this.fileSelectionButton.innerText=o},t.prototype.setInitialValueToButton=function(){var n=hn.fileSelectionChooseImage()+" - "+hn.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=n},t.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},t.create=function(n,s,r){var i=new t(n,s,r);return i},t}(),kRe=function(){function t(n){this.selectElement=mo.createElement("select",za.CAMERA_SELECTION_SELECT_ID),this.cameras=n,this.options=[]}return t.prototype.render=function(n){var s=document.createElement("span");s.style.marginRight="10px";var r=this.cameras.length;if(r===0)throw new Error("No cameras found");if(r===1)s.style.display="none";else{var i=hn.selectCamera();s.innerText="".concat(i," (").concat(this.cameras.length,")  ")}for(var l=1,o=0,c=this.cameras;o<c.length;o++){var d=c[o],u=d.id,h=d.label==null?u:d.label;(!h||h==="")&&(h=[hn.anonymousCameraPrefix(),l++].join(" "));var m=document.createElement("option");m.value=u,m.innerText=h,this.options.push(m),this.selectElement.appendChild(m)}s.appendChild(this.selectElement),n.appendChild(s)},t.prototype.disable=function(){this.selectElement.disabled=!0},t.prototype.isDisabled=function(){return this.selectElement.disabled===!0},t.prototype.enable=function(){this.selectElement.disabled=!1},t.prototype.getValue=function(){return this.selectElement.value},t.prototype.hasValue=function(n){for(var s=0,r=this.options;s<r.length;s++){var i=r[s];if(i.value===n)return!0}return!1},t.prototype.setValue=function(n){if(!this.hasValue(n))throw new Error("".concat(n," is not present in the camera list."));this.selectElement.value=n},t.prototype.hasSingleItem=function(){return this.cameras.length===1},t.prototype.numCameras=function(){return this.cameras.length},t.create=function(n,s){var r=new t(s);return r.render(n),r},t}(),ERe=function(){function t(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=mo.createElement("input",za.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return t.prototype.render=function(n,s){this.zoomElementContainer.style.display=s?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",n.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var r=hn.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(r),this.rangeText.style.marginRight="10px";var i=this;this.rangeInput.addEventListener("input",function(){return i.onValueChange()}),this.rangeInput.addEventListener("change",function(){return i.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},t.prototype.onValueChange=function(){var n=hn.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},t.prototype.setValues=function(n,s,r,i){this.rangeInput.min=n.toString(),this.rangeInput.max=s.toString(),this.rangeInput.step=i.toString(),this.rangeInput.value=r.toString(),this.onValueChange()},t.prototype.show=function(){this.zoomElementContainer.style.display="block"},t.prototype.hide=function(){this.zoomElementContainer.style.display="none"},t.prototype.setOnCameraZoomValueChangeCallback=function(n){this.onChangeCallback=n},t.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},t.create=function(n,s){var r=new t;return r.render(n,s),r},t}(),Oa;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Oa||(Oa={}));function TRe(t){return{fps:t.fps,qrbox:t.qrbox,aspectRatio:t.aspectRatio,disableFlip:t.disableFlip,videoConstraints:t.videoConstraints}}function IRe(t,n){return{formatsToSupport:t.formatsToSupport,useBarCodeDetectorIfSupported:t.useBarCodeDetectorIfSupported,experimentalFeatures:t.experimentalFeatures,verbose:n}}var PRe=function(){function t(n,s,r){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=n,this.config=this.createConfig(s),this.verbose=r===!0,!document.getElementById(n))throw"HTML Element with id=".concat(n," not found");this.scanTypeSelector=new tc(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new ZG(this.verbose),this.persistedDataManager=new vRe,s.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return t.prototype.render=function(n,s){var r=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(l,o){if(n)n(l,o);else{if(r.lastMatchFound===l)return;r.lastMatchFound=l,r.setHeaderMessage(hn.lastMatch(l),Oa.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(l,o){s&&s(l,o)};var i=document.getElementById(this.elementId);if(!i)throw"HTML Element with id=".concat(this.elementId," not found");i.innerHTML="",this.createBasicLayout(i),this.html5Qrcode=new PR(this.getScanRegionId(),IRe(this.config,this.verbose))},t.prototype.pause=function(n){(Nl(n)||n!==!0)&&(n=!1),this.getHtml5QrcodeOrFail().pause(n)},t.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},t.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},t.prototype.clear=function(){var n=this,s=function(){var r=document.getElementById(n.elementId);r&&(r.innerHTML="",n.resetBasicLayout(r))};return this.html5Qrcode?new Promise(function(r,i){if(!n.html5Qrcode){r();return}n.html5Qrcode.isScanning?n.html5Qrcode.stop().then(function(l){if(!n.html5Qrcode){r();return}n.html5Qrcode.clear(),s(),r()}).catch(function(l){n.verbose&&n.logger.logError("Unable to stop qrcode scanner",l),i(l)}):(n.html5Qrcode.clear(),s(),r())}):Promise.resolve()},t.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},t.prototype.applyVideoConstraints=function(n){return this.getHtml5QrcodeOrFail().applyVideoConstraints(n)},t.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},t.prototype.createConfig=function(n){return n?(n.fps||(n.fps=Vi.SCAN_DEFAULT_FPS),n.rememberLastUsedCamera!==!Vi.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(n.rememberLastUsedCamera=Vi.DEFAULT_REMEMBER_LAST_CAMERA_USED),n.supportedScanTypes||(n.supportedScanTypes=Vi.DEFAULT_SUPPORTED_SCAN_TYPE),n):{fps:Vi.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Vi.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Vi.DEFAULT_SUPPORTED_SCAN_TYPE}},t.prototype.createBasicLayout=function(n){n.style.position="relative",n.style.padding="0px",n.style.border="1px solid silver",this.createHeader(n);var s=document.createElement("div"),r=this.getScanRegionId();s.id=r,s.style.width="100%",s.style.minHeight="100px",s.style.textAlign="center",n.appendChild(s),tc.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var i=document.createElement("div"),l=this.getDashboardId();i.id=l,i.style.width="100%",n.appendChild(i),this.setupInitialDashboard(i)},t.prototype.resetBasicLayout=function(n){n.style.border="none"},t.prototype.setupInitialDashboard=function(n){this.createSection(n),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},t.prototype.createHeader=function(n){var s=document.createElement("div");s.style.textAlign="left",s.style.margin="0px",n.appendChild(s);var r=new jRe;r.renderInto(s);var i=document.createElement("div");i.id=this.getHeaderMessageContainerId(),i.style.display="none",i.style.textAlign="center",i.style.fontSize="14px",i.style.padding="2px 10px",i.style.margin="4px",i.style.borderTop="1px solid #f6f6f6",s.appendChild(i)},t.prototype.createSection=function(n){var s=document.createElement("div");s.id=this.getDashboardSectionId(),s.style.width="100%",s.style.padding="10px 0px 10px 0px",s.style.textAlign="left",n.appendChild(s)},t.prototype.createCameraListUi=function(n,s,r){var i=this;i.showHideScanTypeSwapLink(!1),i.setHeaderMessage(hn.cameraPermissionRequesting());var l=function(){r||i.createPermissionButton(n,s)};PR.getCameras().then(function(o){i.persistedDataManager.setHasPermission(!0),i.showHideScanTypeSwapLink(!0),i.resetHeaderMessage(),o&&o.length>0?(n.removeChild(s),i.renderCameraSelection(o)):(i.setHeaderMessage(hn.noCameraFound(),Oa.STATUS_WARNING),l())}).catch(function(o){i.persistedDataManager.setHasPermission(!1),r?r.disabled=!1:l(),i.setHeaderMessage(o,Oa.STATUS_WARNING),i.showHideScanTypeSwapLink(!0)})},t.prototype.createPermissionButton=function(n,s){var r=this,i=mo.createElement("button",this.getCameraPermissionButtonId());i.innerText=hn.cameraPermissionTitle(),i.addEventListener("click",function(){i.disabled=!0,r.createCameraListUi(n,s,i)}),s.appendChild(i)},t.prototype.createPermissionsUi=function(n,s){var r=this;if(tc.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){DR.hasPermissions().then(function(i){i?r.createCameraListUi(n,s):(r.persistedDataManager.setHasPermission(!1),r.createPermissionButton(n,s))}).catch(function(i){r.persistedDataManager.setHasPermission(!1),r.createPermissionButton(n,s)});return}this.createPermissionButton(n,s)},t.prototype.createSectionControlPanel=function(){var n=document.getElementById(this.getDashboardSectionId()),s=document.createElement("div");n.appendChild(s);var r=document.createElement("div");r.id=this.getDashboardSectionCameraScanRegionId(),r.style.display=tc.isCameraScanType(this.currentScanType)?"block":"none",s.appendChild(r);var i=document.createElement("div");i.style.textAlign="center",r.appendChild(i),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(r,i),this.renderFileScanUi(s)},t.prototype.renderFileScanUi=function(n){var s=tc.isFileScanType(this.currentScanType),r=this,i=function(l){if(!r.html5Qrcode)throw"html5Qrcode not defined";tc.isFileScanType(r.currentScanType)&&(r.setHeaderMessage(hn.loadingImage()),r.html5Qrcode.scanFileV2(l,!0).then(function(o){r.resetHeaderMessage(),r.qrCodeSuccessCallback(o.decodedText,o)}).catch(function(o){r.setHeaderMessage(o,Oa.STATUS_WARNING),r.qrCodeErrorCallback(o,QG.createFrom(o))}))};this.fileSelectionUi=ARe.create(n,s,i)},t.prototype.renderCameraSelection=function(n){var s=this,r=this,i=document.getElementById(this.getDashboardSectionCameraScanRegionId());i.style.textAlign="center";var l=ERe.create(i,!1),o=function(j){var S=j.zoomFeature();if(S.isSupported()){l.setOnCameraZoomValueChangeCallback(function(A){S.apply(A)});var C=1;s.config.defaultZoomValueIfSupported&&(C=s.config.defaultZoomValueIfSupported),C=XDe(C,S.min(),S.max()),l.setValues(S.min(),S.max(),C,S.step()),l.show()}},c=kRe.create(i,n),d=document.createElement("span"),u=mo.createElement("button",za.CAMERA_START_BUTTON_ID);u.innerText=hn.scanButtonStartScanningText(),d.appendChild(u);var h=mo.createElement("button",za.CAMERA_STOP_BUTTON_ID);h.innerText=hn.scanButtonStopScanningText(),h.style.display="none",h.disabled=!0,d.appendChild(h);var m,x=function(j){if(!j.torchFeature().isSupported()){m&&m.hide();return}m?m.updateTorchCapability(j.torchFeature()):m=CRe.create(d,j.torchFeature(),{display:"none",marginLeft:"5px"},function(S){r.setHeaderMessage(S,Oa.STATUS_WARNING)}),m.show()};i.appendChild(d);var b=function(j){j||(u.style.display="none"),u.innerText=hn.scanButtonStartScanningText(),u.style.opacity="1",u.disabled=!1,j&&(u.style.display="inline-block")};if(u.addEventListener("click",function(j){u.innerText=hn.scanButtonScanningStarting(),c.disable(),u.disabled=!0,u.style.opacity="0.5",s.scanTypeSelector.hasMoreThanOneScanType()&&r.showHideScanTypeSwapLink(!1),r.resetHeaderMessage();var S=c.getValue();r.persistedDataManager.setLastUsedCameraId(S),r.html5Qrcode.start(S,TRe(r.config),r.qrCodeSuccessCallback,r.qrCodeErrorCallback).then(function(C){h.disabled=!1,h.style.display="inline-block",b(!1);var A=r.html5Qrcode.getRunningTrackCameraCapabilities();s.config.showTorchButtonIfSupported===!0&&x(A),s.config.showZoomSliderIfSupported===!0&&o(A)}).catch(function(C){r.showHideScanTypeSwapLink(!0),c.enable(),b(!0),r.setHeaderMessage(C,Oa.STATUS_WARNING)})}),c.hasSingleItem()&&u.click(),h.addEventListener("click",function(j){if(!r.html5Qrcode)throw"html5Qrcode not defined";h.disabled=!0,r.html5Qrcode.stop().then(function(S){s.scanTypeSelector.hasMoreThanOneScanType()&&r.showHideScanTypeSwapLink(!0),c.enable(),u.disabled=!1,h.style.display="none",u.style.display="inline-block",m&&(m.reset(),m.hide()),l.removeOnCameraZoomValueChangeCallback(),l.hide(),r.insertCameraScanImageToScanRegion()}).catch(function(S){h.disabled=!1,r.setHeaderMessage(S,Oa.STATUS_WARNING)})}),r.persistedDataManager.getLastUsedCameraId()){var w=r.persistedDataManager.getLastUsedCameraId();c.hasValue(w)?(c.setValue(w),u.click()):r.persistedDataManager.resetLastUsedCameraId()}},t.prototype.createSectionSwap=function(){var n=this,s=hn.textIfCameraScanSelected(),r=hn.textIfFileScanSelected(),i=document.getElementById(this.getDashboardSectionId()),l=document.createElement("div");l.style.textAlign="center";var o=mo.createElement("span",this.getDashboardSectionSwapLinkId());o.style.textDecoration="underline",o.style.cursor="pointer",o.innerText=tc.isCameraScanType(this.currentScanType)?s:r,o.addEventListener("click",function(){if(!n.sectionSwapAllowed){n.verbose&&n.logger.logError("Section swap called when not allowed");return}n.resetHeaderMessage(),n.fileSelectionUi.resetValue(),n.sectionSwapAllowed=!1,tc.isCameraScanType(n.currentScanType)?(n.clearScanRegion(),n.getCameraScanRegion().style.display="none",n.fileSelectionUi.show(),o.innerText=r,n.currentScanType=Kc.SCAN_TYPE_FILE,n.insertFileScanImageToScanRegion()):(n.clearScanRegion(),n.getCameraScanRegion().style.display="block",n.fileSelectionUi.hide(),o.innerText=s,n.currentScanType=Kc.SCAN_TYPE_CAMERA,n.insertCameraScanImageToScanRegion(),n.startCameraScanIfPermissionExistsOnSwap()),n.sectionSwapAllowed=!0}),l.appendChild(o),i.appendChild(l)},t.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var n=this,s=this;if(this.persistedDataManager.hasCameraPermissions()){DR.hasPermissions().then(function(r){if(r){var i=document.getElementById(s.getCameraPermissionButtonId());if(!i)throw n.logger.logError("Permission button not found, fail;"),"Permission button not found";i.click()}else s.persistedDataManager.setHasPermission(!1)}).catch(function(r){s.persistedDataManager.setHasPermission(!1)});return}},t.prototype.resetHeaderMessage=function(){var n=document.getElementById(this.getHeaderMessageContainerId());n.style.display="none"},t.prototype.setHeaderMessage=function(n,s){s||(s=Oa.STATUS_DEFAULT);var r=this.getHeaderMessageDiv();switch(r.innerText=n,r.style.display="block",s){case Oa.STATUS_SUCCESS:r.style.background="rgba(106, 175, 80, 0.26)",r.style.color="#477735";break;case Oa.STATUS_WARNING:r.style.background="rgba(203, 36, 49, 0.14)",r.style.color="#cb2431";break;case Oa.STATUS_DEFAULT:default:r.style.background="rgba(0, 0, 0, 0)",r.style.color="rgb(17, 17, 17)";break}},t.prototype.showHideScanTypeSwapLink=function(n){this.scanTypeSelector.hasMoreThanOneScanType()&&(n!==!0&&(n=!1),this.sectionSwapAllowed=n,this.getDashboardSectionSwapLink().style.display=n?"inline-block":"none")},t.prototype.insertCameraScanImageToScanRegion=function(){var n=this,s=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){s.innerHTML="<br>",s.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(r){s.innerHTML="<br>",s.appendChild(n.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=gRe,this.cameraScanImage.alt=hn.cameraScanAltText()},t.prototype.insertFileScanImageToScanRegion=function(){var n=this,s=document.getElementById(this.getScanRegionId());if(this.fileScanImage){s.innerHTML="<br>",s.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(r){s.innerHTML="<br>",s.appendChild(n.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=yRe,this.fileScanImage.alt=hn.fileScanAltText()},t.prototype.clearScanRegion=function(){var n=document.getElementById(this.getScanRegionId());n.innerHTML=""},t.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},t.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},t.prototype.getDashboardSectionSwapLinkId=function(){return za.SCAN_TYPE_CHANGE_ANCHOR_ID},t.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},t.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},t.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},t.prototype.getCameraPermissionButtonId=function(){return za.CAMERA_PERMISSION_BUTTON_ID},t.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},t.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},t.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},t}();function MRe(){const[t,n]=y.useState(""),[s,r]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState(""),[d,u]=y.useState(null),[h,m]=y.useState(!1),x=y.useRef(null),b=y.useCallback(async k=>{if(!k){u(null);return}try{const T=await ne.get(`/inventory/items/${k.id}/qr`,{responseType:"blob"}),I=URL.createObjectURL(T.data);u(D=>(D&&URL.revokeObjectURL(D),I))}catch(T){console.error(T),u(null),xe.error("Unable to load QR image")}},[]),w=y.useCallback(async k=>{var I,D;const T=(k||"").trim();if(c(""),l(null),u(null),!T){c("Please scan or enter a QR number.");return}try{r(!0);const O=await MDe(T);l(O.data),await b(O.data)}catch(O){const R=((D=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:D.detail)||(O==null?void 0:O.message)||"No medicine found for this QR";c(R),xe.error(R)}finally{r(!1)}},[b]),j=y.useCallback(async k=>{k.preventDefault(),await w(t)},[t,w]),S=y.useCallback(async k=>{n(k),xe.success(`QR scanned: ${k}`),m(!1),await w(k)},[w]),C=y.useCallback(()=>{},[]);y.useEffect(()=>{if(!h){x.current&&(x.current.clear().catch(()=>{}),x.current=null);return}const k=new PRe("qr-reader",{fps:10,qrbox:250},!1);return x.current=k,k.render(S,C),()=>{x.current&&(x.current.clear().catch(()=>{}),x.current=null)}},[h,S,C]);const A=y.useCallback(async()=>{if(i)try{const T=(await ne.get(`/inventory/items/${i.id}/qr`,{responseType:"blob"})).data,I=URL.createObjectURL(T),D=document.createElement("a");D.href=I,D.download=`${i.code||"medicine"}_qr.png`,document.body.appendChild(D),D.click(),D.remove(),URL.revokeObjectURL(I)}catch(k){const T=(k==null?void 0:k.message)||"Unable to download QR image";xe.error(T)}},[i]);return y.useEffect(()=>()=>{d&&URL.revokeObjectURL(d)},[d]),a.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-slate-50 px-4 py-6 lg:px-8",children:a.jsxs("div",{className:"mx-auto flex max-w-5xl flex-col gap-6",children:[a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"flex items-center gap-2 text-2xl font-semibold tracking-tight text-slate-900",children:[a.jsx(oN,{className:"h-6 w-6 text-slate-700"}),"Medicine QR Lookup"]}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Scan medicine QR code with camera / scanner or enter QR number to instantly fetch medicine details."})]}),a.jsxs(Xe,{className:"flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1 text-xs font-medium text-white",children:[a.jsx(T1,{className:"h-3 w-3"}),"Live QR search"]})]}),a.jsxs(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx(st,{className:"text-base font-semibold text-slate-900",children:"Scan or Enter QR Number"}),a.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Keep the cursor inside the QR box and scan with your scanner or use the camera scanner below."})]}),a.jsx(Pe,{type:"button",variant:h?"outline":"default",size:"sm",onClick:()=>m(k=>!k),className:"inline-flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx(ute,{className:"h-4 w-4"}),"Stop Camera"]}):a.jsxs(a.Fragment,{children:[a.jsx(i4,{className:"h-4 w-4"}),"Use Camera Scanner"]})})]}),a.jsxs(ze,{className:"space-y-4",children:[a.jsxs("form",{onSubmit:j,className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-xs font-medium text-slate-600",children:"QR Number"}),a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(oN,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx(_e,{autoFocus:!0,value:t,onChange:k=>n(k.target.value),placeholder:"e.g., MED-000123 or scan with your QR scanner...",className:"pl-9 text-sm"})]}),a.jsx(Pe,{type:"submit",className:"w-full sm:w-auto",disabled:s,children:s?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(nn,{className:"h-4 w-4 animate-spin"}),"Searching..."]}):a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(ORe,{}),"Search"]})})]})]}),a.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-500",children:[a.jsx(Sp,{className:"mt-0.5 h-3 w-3"}),a.jsxs("p",{children:["For USB QR scanners: focus the box and scan. Most scanners type the code and press",a.jsx("span",{className:"mx-1 rounded bg-slate-100 px-1 py-0.5 font-semibold",children:"Enter"}),"automatically."]})]})]}),h&&a.jsxs("div",{className:"mt-3 rounded-2xl border border-dashed border-slate-200 bg-slate-100/60 px-3 py-3",children:[a.jsxs("p",{className:"mb-2 flex items-center gap-2 text-xs text-slate-600",children:[a.jsx(i4,{className:"h-3 w-3"}),"Point your medicine QR code at the camera. Once decoded, the medicine will load automatically."]}),a.jsx("div",{id:"qr-reader",className:"h-[280px] w-full overflow-hidden rounded-xl bg-black/90"})]}),o&&a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-red-100 bg-red-50 px-3 py-2 text-xs text-red-700",children:[a.jsx(Sp,{className:"h-3 w-3"}),o]})]})]}),i&&a.jsxs(Le,{className:"rounded-2xl border-slate-200 shadow-sm",children:[a.jsxs(Je,{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs(st,{className:"flex items-center gap-2 text-lg",children:[a.jsx(Ur,{className:"h-5 w-5 text-slate-700"}),a.jsx("span",{children:i.name})]}),a.jsxs("p",{className:"text-xs text-slate-500",children:["Code:"," ",a.jsx("span",{className:"font-mono text-slate-700",children:i.code}),i.qr_number&&a.jsxs(a.Fragment,{children:["  ","QR:"," ",a.jsx("span",{className:"font-mono text-slate-700",children:i.qr_number})]})]}),i.generic_name&&a.jsxs("p",{className:"text-xs text-slate-500",children:["Generic: ",i.generic_name]})]}),d&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-2",children:a.jsx("img",{src:d,alt:`QR for ${i.name}`,className:"h-28 w-28 object-contain"})}),a.jsxs(Pe,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:A,children:[a.jsx(oN,{className:"mr-1 h-3 w-3"}),"Download QR"]})]})]}),a.jsxs(ze,{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[a.jsx(no,{label:"FORM / STRENGTH",value:`${i.form||"-"}${i.strength?`  ${i.strength}`:""}`}),a.jsx(no,{label:"PACK",value:`${i.pack_size||"-"} ${i.unit||""}`}),a.jsx(no,{label:"MANUFACTURER",value:i.manufacturer||"-"}),a.jsx(no,{label:"THERAPEUTIC CLASS",value:i.class_name||"-"}),a.jsx(no,{label:"ATC CODE",value:i.atc_code||"-"}),a.jsx(no,{label:"HSN CODE",value:i.hsn_code||"-"}),a.jsx(no,{label:"MRP / PRICE",value:`${i.default_mrp||0} MRP  ${i.default_price||0} Price`}),a.jsx(no,{label:"TAX %",value:`${i.default_tax_percent||0}%`}),a.jsx(no,{label:"REORDER / MAX LEVEL",value:`${i.reorder_level||0} / ${i.max_level||0}`})]})]})]})})}function no({label:t,value:n}){return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2.5",children:[a.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wide text-slate-500",children:t}),a.jsx("p",{className:"mt-1 truncate text-sm text-slate-800",title:n,children:n||"-"})]})}function ORe(){return a.jsx(T1,{className:"h-4 w-4"})}function DRe(){const[t,n]=y.useState(""),[s,r]=y.useState(!1),[i,l]=y.useState(null),[o,c]=y.useState(""),[d,u]=y.useState(!1);y.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const h=async()=>{const w=t.trim();if(!w){xe.error("Please enter or scan a barcode number");return}r(!0),l(null),c("");try{const S=(await ODe(w)).data;l(S),await m(S.id)}catch(j){console.error("Failed to lookup item by barcode",j)}finally{r(!1)}},m=async w=>{u(!0);try{const j=await wR(w),S=URL.createObjectURL(j.data);c(S)}catch(j){console.error("Failed to fetch barcode image",j)}finally{u(!1)}},x=w=>{w.key==="Enter"&&(w.preventDefault(),h())},b=async()=>{if(i)try{const w=await wR(i.id),j=new Blob([w.data],{type:"image/png"}),S=URL.createObjectURL(j),C=document.createElement("a");C.href=S,C.download=`${i.code||"medicine"}_barcode.png`,document.body.appendChild(C),C.click(),C.remove(),URL.revokeObjectURL(S)}catch(w){console.error("Failed to download barcode image",w)}};return a.jsxs("div",{className:"p-4 md:p-6 max-w-6xl mx-auto space-y-4 md:space-y-6",children:[a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"flex items-center gap-2 text-slate-900",children:[a.jsx(d4,{className:"w-5 h-5"}),a.jsx("span",{children:"Medicine Barcode Lookup"}),a.jsx(Xe,{variant:"outline",className:"ml-2 text-xs",children:"Pharmacy Inventory"})]})}),a.jsxs(ze,{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2.5",children:[a.jsx(d4,{className:"w-4 h-4 text-slate-500 shrink-0"}),a.jsx(_e,{value:t,onChange:w=>n(w.target.value),onKeyDown:x,placeholder:"e.g. MD_1001",className:"border-0 bg-transparent shadow-none focus-visible:ring-0 text-base",autoFocus:!0})]}),a.jsxs(Pe,{onClick:h,className:"shrink-0 bg-slate-900 text-white rounded-2xl px-5",disabled:s,children:[a.jsx(jn,{className:"w-4 h-4 mr-2"}),s?"Searching...":"Search"]})]}),a.jsxs("p",{className:"text-xs md:text-sm text-slate-500 flex items-center gap-1.5",children:[a.jsx(Ms,{className:"w-3.5 h-3.5"}),"Keep the cursor inside the barcode box and scan with your barcode / QR scanner. Most scanners behave like a keyboard and press",a.jsx("span",{className:"inline-flex items-center rounded-md border border-slate-200 px-1.5 py-0.5 text-[11px] font-medium",children:"Enter"}),"automatically."]})]})]}),s&&a.jsx(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:a.jsxs(ze,{className:"p-4 md:p-6 space-y-4",children:[a.jsx(Ze,{className:"h-6 w-2/3"}),a.jsx(Ze,{className:"h-4 w-1/3"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsx(Ze,{className:"h-20"}),a.jsx(Ze,{className:"h-20"}),a.jsx(Ze,{className:"h-20"})]})]})}),!s&&i&&a.jsx(Le,{className:"rounded-3xl border-slate-200 shadow-sm overflow-hidden",children:a.jsxs(ze,{className:"p-4 md:p-6 space-y-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8",children:[a.jsxs("div",{className:"flex-1 space-y-1.5",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-slate-100",children:a.jsx(Ur,{className:"w-4 h-4 text-slate-600"})}),a.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:i.name})]}),a.jsxs("div",{className:"text-sm text-slate-500 space-x-2",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Code:"})," ",i.code]}),a.jsx("span",{className:"text-slate-300",children:""}),a.jsxs("span",{children:[a.jsx("span",{className:"font-medium text-slate-600",children:"Barcode:"})," ",i.qr_number]})]}),i.generic_name&&a.jsxs("p",{className:"text-sm text-slate-600",children:[a.jsx("span",{className:"font-medium",children:"Generic:"})," ",i.generic_name]})]}),a.jsxs("div",{className:"w-full md:w-64 lg:w-72 flex flex-col items-center gap-3",children:[a.jsxs("div",{className:"w-full h-32 md:h-36 rounded-2xl border border-dashed border-slate-200 bg-slate-50 flex items-center justify-center",children:[d&&a.jsx(Ze,{className:"w-40 h-20 rounded-md"}),!d&&o&&a.jsx("img",{src:o,alt:`Barcode for ${i.name}`,className:"max-h-full max-w-full object-contain"}),!d&&!o&&a.jsx("span",{className:"text-xs text-slate-400",children:"No barcode image"})]}),a.jsxs(Pe,{type:"button",variant:"outline",className:"w-full rounded-2xl",onClick:b,children:[a.jsx(Wd,{className:"w-4 h-4 mr-2"}),"Download Barcode"]})]})]}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3 lg:grid-cols-4 mt-3",children:[a.jsx(nc,{label:"Form / Strength",icon:a.jsx(Ur,{className:"w-4 h-4"}),value:`${i.form||"-"} ${i.strength?` ${i.strength}`:""}`}),a.jsx(nc,{label:"Pack",icon:a.jsx(r7,{className:"w-4 h-4"}),value:`${i.pack_size||1} ${i.unit||"unit"}`}),a.jsx(nc,{label:"Manufacturer",icon:a.jsx(w0,{className:"w-4 h-4"}),value:i.manufacturer||""}),a.jsx(nc,{label:"Therapeutic class",icon:a.jsx(w0,{className:"w-4 h-4"}),value:i.class_name||""}),a.jsx(nc,{label:"ATC code",icon:a.jsx(w0,{className:"w-4 h-4"}),value:i.atc_code||""}),a.jsx(nc,{label:"HSN code",icon:a.jsx(w0,{className:"w-4 h-4"}),value:i.hsn_code||""}),a.jsx(nc,{label:"MRP / Price",icon:a.jsx(_l,{className:"w-4 h-4"}),value:`${Number(i.default_mrp||0).toFixed(2)} MRP  ${Number(i.default_price||0).toFixed(2)} Price`}),a.jsx(nc,{label:"Reorder / Max level",icon:a.jsx(Ms,{className:"w-4 h-4"}),value:`${Number(i.reorder_level||0).toFixed(2)} / ${Number(i.max_level||0).toFixed(2)}`})]})]})})]})}function nc({label:t,icon:n,value:s}){return a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 flex flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500 uppercase tracking-wide",children:[a.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-100 text-slate-600",children:n}),t]}),a.jsx("div",{className:"text-sm text-slate-800 truncate",title:String(s),children:s||""})]})}function RRe(t={}){return ne.get("/pharmacy/rx",{params:t})}function sK(t){return ne.get(`/pharmacy/prescriptions/${t}`)}function LRe(t){return ne.post("/pharmacy/prescriptions",t)}function BRe(t,n){return ne.post(`/pharmacy/prescriptions/${t}/dispense`,n)}function FRe(t={}){return ne.get("/pharmacy/rx-queue",{params:t})}const F2=[{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],$Re=[{value:"ROUTINE",label:"Routine"},{value:"STAT",label:"STAT / Urgent"},{value:"PRN",label:"PRN / As needed"}];function rK(){const t=new Date,n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().slice(0,16)}const $2={type:"OPD",priority:"ROUTINE",datetime:rK(),patient:null,doctorId:"",visitNo:"",admissionNo:"",otCaseNo:"",notes:""},hg={item:null,item_name:"",strength:"",route:"PO",dose:"",frequency:"",duration_days:"",total_qty:"",instructions:"",is_prn:!1,is_stat:!1,requested_qty:""};function zRe(){var ct,Me,qe;const[t,n]=y.useState("list"),[s,r]=y.useState("ALL"),[i,l]=y.useState("ALL"),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,m]=y.useState([]),[x,b]=y.useState(null),[w,j]=y.useState($2),[S,C]=y.useState([]),[A,k]=y.useState(hg),[T,I]=y.useState(!1),[D,O]=y.useState(""),[R,P]=y.useState([]),[L,$]=y.useState(!1),[B,V]=y.useState(!1),[K,z]=y.useState([]),[H,Y]=y.useState(!1),[G,J]=y.useState(""),[ee,ye]=y.useState([]),[ie,he]=y.useState(!1),[be,we]=y.useState(!1);y.useEffect(()=>{(async()=>{var oe;try{Y(!0);const ue=await eA(),De=((oe=ue==null?void 0:ue.data)==null?void 0:oe.doctors)||[];z(De)}catch{}finally{Y(!1)}})()},[]),y.useEffect(()=>{Z()},[s,i]);async function Z(){try{u(!0);const oe={};s!=="ALL"&&(oe.type=s),i!=="ALL"&&(oe.status=i),o!=null&&o.trim()&&(oe.q=o.trim()),oe.limit=100;const ue=await RRe(oe);m((ue==null?void 0:ue.data)||[])}catch{}finally{u(!1)}}y.useEffect(()=>{if(!D||D.trim().length<2){P([]);return}let oe=!1;return(async()=>{var ue;try{$(!0);const De=await uG(D.trim());if(oe)return;P(((ue=De==null?void 0:De.data)==null?void 0:ue.items)||(De==null?void 0:De.data)||[]),V(!0)}catch{}finally{oe||$(!1)}})(),()=>{oe=!0}},[D]);function ce(oe){j(ue=>({...ue,patient:oe})),O(`${oe.uhid?`${oe.uhid}  `:""}${oe.first_name||""} ${oe.last_name||""}`.trim()),V(!1)}y.useEffect(()=>{if(!G||G.trim().length<2){ye([]);return}let oe=!1;return(async()=>{var ue;try{he(!0);const De=await t5({q:G.trim(),kind:"MEDICINE",limit:15});if(oe)return;const St=((ue=De==null?void 0:De.data)==null?void 0:ue.items)||(De==null?void 0:De.data)||[];ye(St),we(!0)}catch{}finally{oe||he(!1)}})(),()=>{oe=!0}},[G]);function Te(oe){k(ue=>({...ue,item:oe,item_name:oe.name||oe.item_name||""})),J(oe.name||oe.item_name||""),we(!1)}function le(){j({...$2,type:w.type||"OPD"}),C([]),k(hg),O("")}function de(oe){const ue=oe;j(De=>({...$2,type:ue,datetime:rK()})),C([]),k(hg),O(""),b(null),n("new")}function ge(oe){const ue=Number(oe.duration_days||0),De=(oe.frequency||"").trim();if(!ue||!De)return"";const tn=De.split("-").map(Lt=>Number(Lt||0)).reduce((Lt,Dt)=>Lt+(Number.isFinite(Dt)?Dt:0),0);return tn?String(tn*ue):""}function ae(){if(!A.item&&!A.item_name){xe.error("Select a medicine first");return}const oe=ge(A),ue=A.total_qty||oe;if(!ue){xe.error("Enter Total Qty or proper Frequency + Days");return}const De={...A,total_qty:ue,requested_qty:A.requested_qty||ue};C(St=>[...St,De]),k(hg),J(""),we(!1)}function Ve(oe){C(ue=>ue.filter((De,St)=>St!==oe))}async function nt(){var ue;if(!w.patient&&w.type!=="COUNTER"){xe.error("Select a patient");return}if(!w.doctorId&&w.type!=="COUNTER"){xe.error("Select a doctor");return}if(!S.length){xe.error("Add at least one medicine");return}const oe={type:w.type,priority:w.priority,rx_datetime:w.datetime,patient_id:((ue=w.patient)==null?void 0:ue.id)||null,doctor_user_id:w.doctorId||null,visit_id:w.type==="OPD"&&w.visitNo||null,ipd_admission_id:w.type==="IPD"&&w.admissionNo||null,ot_case_id:w.type==="OT"&&w.otCaseNo||null,notes:w.notes||"",lines:S.map(De=>{var Dt,Un;const St=ge(De),tn=De.total_qty||De.requested_qty||St||"",Lt=tn?Number(tn):null;return{item_id:((Dt=De.item)==null?void 0:Dt.id)||De.item_id||null,item_name:((Un=De.item)==null?void 0:Un.name)||De.item_name||"",strength:De.strength||null,route:De.route||null,dose:De.dose||null,frequency:De.frequency||null,duration_days:De.duration_days?Number(De.duration_days):null,requested_qty:Lt,total_qty:Lt,instructions:De.instructions||null,is_prn:!!De.is_prn,is_stat:!!De.is_stat}})};try{I(!0);const De=await LRe(oe);xe.success("Prescription created & sent to Pharmacy"),le(),n("list"),Z(),De!=null&&De.data&&b(De.data)}catch{}finally{I(!1)}}async function wt(oe){try{const ue=await sK(oe.id),De=(ue==null?void 0:ue.data)||oe;b(De),n("detail")}catch{}}const jt=y.useMemo(()=>x?x.lines||x.items||[]:[],[x]);return a.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Prescriptions"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Create and manage OPD, IPD, OT and Counter prescriptions linked to inventory & billing."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Mn,{value:w.type,onValueChange:oe=>j(ue=>({...ue,type:oe})),children:[a.jsx(An,{className:"w-[140px] bg-white border-slate-200 rounded-full",children:a.jsx(On,{placeholder:"Rx Type"})}),a.jsx(kn,{children:F2.map(oe=>a.jsx(Et,{value:oe.value,children:oe.label},oe.value))})]}),a.jsxs(Pe,{className:"rounded-full",onClick:()=>de(w.type||"OPD"),children:[a.jsx(Nn,{className:"w-4 h-4 mr-2"}),"New Prescription"]})]})]}),a.jsxs(_o,{value:t,onValueChange:n,children:[a.jsxs(Ll,{className:"mb-4",children:[a.jsx(dn,{value:"list",children:"Queue / History"}),a.jsx(dn,{value:"new",children:"New Rx"}),a.jsx(dn,{value:"detail",disabled:!x,children:"Selected Rx"})]}),a.jsx(mn,{value:"list",className:"space-y-3",children:a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Filter by"}),a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[a.jsx("button",{type:"button",onClick:()=>r("ALL"),className:`px-2.5 py-1 rounded-full text-xs border ${s==="ALL"?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:"All Types"}),F2.map(oe=>a.jsxs("button",{type:"button",onClick:()=>r(oe.value),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${s===oe.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[a.jsx(Ur,{className:"w-3 h-3"}),oe.label]},oe.value))]})]}),a.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[a.jsxs("div",{className:"relative flex-1 md:w-64",children:[a.jsx(jn,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(_e,{value:o,onChange:oe=>c(oe.target.value),placeholder:"Search UHID / name / Rx no...",className:"pl-8 text-sm bg-white border-slate-200 rounded-full",onKeyDown:oe=>{oe.key==="Enter"&&Z()}})]}),a.jsxs(Mn,{value:i,onValueChange:l,children:[a.jsx(An,{className:"w-[130px] bg-white border-slate-200 rounded-full text-xs",children:a.jsx(On,{placeholder:"Status"})}),a.jsxs(kn,{children:[a.jsx(Et,{value:"ALL",children:"All status"}),a.jsx(Et,{value:"DRAFT",children:"Draft"}),a.jsx(Et,{value:"PENDING",children:"Pending"}),a.jsx(Et,{value:"PARTIAL",children:"Partial"}),a.jsx(Et,{value:"DISPENSED",children:"Dispensed"}),a.jsx(Et,{value:"CANCELLED",children:"Cancelled"})]})]}),a.jsx(Pe,{variant:"outline",size:"icon",className:"rounded-full border-slate-200",onClick:Z,children:a.jsx(Ai,{className:"w-4 h-4"})})]})]})}),a.jsx(ze,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx("div",{className:"max-h-[420px] overflow-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-xs text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Rx No"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Type / Doctor"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Items"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Created"}),a.jsx("th",{className:"text-left px-3 py-2.5 font-medium",children:"Status"}),a.jsx("th",{className:"text-right px-3 py-2.5 font-medium",children:"Actions"})]})}),a.jsxs("tbody",{children:[d&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"Loading prescriptions..."})}),!d&&!h.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-xs text-slate-500",children:"No prescriptions found for the selected filters."})}),!d&&h.map(oe=>{var re,Ce;const ue=(oe.status||"").toUpperCase()||"PENDING",De=oe.type||oe.rx_type||"OPD",St=oe.created_at||oe.rx_datetime||oe.bill_date||null,tn=St?String(St).slice(0,16).replace("T"," "):"",Lt=oe.patient||oe.patient_name||oe.patient_uhid||"",Dt=typeof Lt=="string"?Lt:`${Lt.first_name||""} ${Lt.last_name||""}`.trim(),Un=((re=oe.items)==null?void 0:re.length)||((Ce=oe.lines)==null?void 0:Ce.length)||oe.item_count||"",yn=oe.doctor_name||oe.doctor||oe.doctor_display||"";return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 transition-colors",children:[a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs font-medium text-slate-900",children:oe.rx_number||`RX-${oe.id}`}),oe.uhid&&a.jsxs("span",{className:"text-[11px] text-slate-500",children:["UHID: ",oe.uhid]})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] font-medium text-slate-700",children:a.jsx(ps,{className:"w-3 h-3"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-slate-900",children:Dt||""}),oe.patient_uhid&&a.jsx("div",{className:"text-[11px] text-slate-500",children:oe.patient_uhid})]})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Xe,{variant:"outline",className:"border-slate-200 text-[11px] px-1.5 py-0.5",children:De}),yn&&a.jsxs("span",{className:"text-[11px] text-slate-600 flex items-center gap-1",children:[a.jsx(un,{className:"w-3 h-3"}),yn]})]}),oe.context_label&&a.jsx("span",{className:"text-[11px] text-slate-500",children:oe.context_label})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:Un}),a.jsx("td",{className:"px-3 py-2.5 align-middle text-xs text-slate-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ys,{className:"w-3 h-3 text-slate-400"}),a.jsx("span",{children:tn})]})}),a.jsx("td",{className:"px-3 py-2.5 align-middle",children:a.jsx(URe,{status:ue})}),a.jsx("td",{className:"px-3 py-2.5 align-middle text-right",children:a.jsxs(Pe,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs rounded-full border-slate-200",onClick:()=>wt(oe),children:[a.jsx(_r,{className:"w-3 h-3 mr-1"}),"View"]})})]},oe.id)})]})]})})})})]})}),a.jsx(mn,{value:"new",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.5fr)_minmax(0,2fr)]",children:[a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"flex items-center gap-2 text-sm font-semibold",children:[a.jsx(Ur,{className:"w-4 h-4 text-slate-500"}),"Prescription Details"]})}),a.jsxs(ze,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Prescription Type"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:F2.map(oe=>a.jsxs("button",{type:"button",onClick:()=>j(ue=>({...ue,type:oe.value})),className:`px-2.5 py-1 rounded-full text-xs border flex items-center gap-1.5 ${w.type===oe.value?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200"}`,children:[a.jsx(Ur,{className:"w-3 h-3"}),oe.label]},oe.value))})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Priority"}),a.jsxs(Mn,{value:w.priority,onValueChange:oe=>j(ue=>({...ue,priority:oe})),children:[a.jsx(An,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:a.jsx(On,{placeholder:"Select priority"})}),a.jsx(kn,{children:$Re.map(oe=>a.jsx(Et,{value:oe.value,children:oe.label},oe.value))})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Date & Time"}),a.jsx(_e,{type:"datetime-local",value:w.datetime,onChange:oe=>j(ue=>({...ue,datetime:oe.target.value})),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1.5 relative",children:[a.jsxs(Ye,{className:"text-xs text-slate-600 flex items-center gap-1.5",children:[a.jsx(ps,{className:"w-3 h-3"}),"Patient (UHID / name / phone)"]}),a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(_e,{value:D,onChange:oe=>{O(oe.target.value),V(!0)},placeholder:w.type==="COUNTER"?"Optional for counter sale":"Search patient...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsx(du,{children:B&&(R.length>0||L)&&a.jsxs(gt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[L&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching..."}),!L&&!R.length&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No patients found"}),!L&&R.map(oe=>a.jsxs("button",{type:"button",onClick:()=>ce(oe),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-slate-900",children:`${oe.first_name||""} ${oe.last_name||""}`.trim()||oe.name||`Patient #${oe.id}`}),oe.uhid&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID: ",oe.uhid]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:[oe.age?`${oe.age}y  `:"",oe.gender?`${oe.gender}  `:"",oe.phone||""]})]},oe.id))]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.type==="OPD"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"OPD Visit No (optional)"}),a.jsx(_e,{value:w.visitNo,onChange:oe=>j(ue=>({...ue,visitNo:oe.target.value})),placeholder:"e.g., OPD-2025-0001",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),w.type==="IPD"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Admission No"}),a.jsx(_e,{value:w.admissionNo,onChange:oe=>j(ue=>({...ue,admissionNo:oe.target.value})),placeholder:"IPD admission number",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),w.type==="OT"&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"OT Case No"}),a.jsx(_e,{value:w.otCaseNo,onChange:oe=>j(ue=>({...ue,otCaseNo:oe.target.value})),placeholder:"OT / procedure case ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs(Ye,{className:"text-xs text-slate-600 flex items-center gap-1",children:[a.jsx(un,{className:"w-3 h-3"}),"Consultant / Prescriber"]}),a.jsxs(Mn,{value:w.doctorId||"",onValueChange:oe=>j(ue=>({...ue,doctorId:oe})),children:[a.jsx(An,{className:"w-full bg-white border-slate-200 rounded-full h-9 text-xs",children:a.jsx(On,{placeholder:"Select doctor"})}),a.jsxs(kn,{children:[H&&a.jsx(Et,{value:"__loading",disabled:!0,children:"Loading..."}),!H&&(!K||!K.length)&&a.jsx(Et,{value:"__none",disabled:!0,children:"No doctors configured"}),!H&&(K==null?void 0:K.map(oe=>a.jsx(Et,{value:String(oe.id),children:oe.name||oe.full_name||oe.email},oe.id)))]})]})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-xs text-slate-600",children:"Clinical notes / instructions to pharmacist (optional)"}),a.jsx(mh,{value:w.notes,onChange:oe=>j(ue=>({...ue,notes:oe.target.value})),rows:3,className:"text-xs bg-white border-slate-200 resize-none rounded-xl",placeholder:"Eg: Allergic to penicillin, avoid NSAIDs, taper dose after 5 days, etc."})]})]})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsxs(Je,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(_r,{className:"w-4 h-4 text-slate-500"}),a.jsx(st,{className:"text-sm font-semibold",children:"Medicines & Instructions"})]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:S.length?`${S.length} lines`:"No lines added yet"})]}),a.jsxs(ze,{className:"space-y-3",children:[a.jsx("div",{className:"border border-dashed border-slate-200 rounded-xl p-3 bg-slate-50/60",children:a.jsxs("div",{className:"grid md:grid-cols-[minmax(0,2.3fr)_minmax(0,1.1fr)] gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"space-y-1 relative",children:[a.jsxs(Ye,{className:"text-[11px] text-slate-600 flex items-center gap-1.5",children:["Medicine",a.jsx("span",{className:"text-[10px] text-slate-400",children:"(linked to Inventory)"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"w-3.5 h-3.5 text-slate-400 absolute left-2 top-2.5"}),a.jsx(_e,{value:G,onChange:oe=>{J(oe.target.value),we(!0)},placeholder:"Search drug name, brand, generic...",className:"pl-7 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsx(du,{children:be&&(ee.length>0||ie)&&a.jsxs(gt.div,{initial:{opacity:0,y:-4},animate:{opacity:1,y:0},exit:{opacity:0,y:-4},className:"absolute z-20 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-52 overflow-auto text-xs",children:[ie&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"Searching medicines..."}),!ie&&!ee.length&&a.jsx("div",{className:"px-3 py-2 text-slate-500",children:"No items found"}),!ie&&ee.map(oe=>a.jsxs("button",{type:"button",onClick:()=>Te(oe),className:"w-full text-left px-3 py-1.5 hover:bg-slate-50 flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-slate-900",children:oe.name||oe.item_name}),oe.code&&a.jsx("span",{className:"text-[10px] text-slate-500",children:oe.code})]}),a.jsx("div",{className:"text-[11px] text-slate-500",children:oe.strength||oe.form||""})]},oe.id))]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Dose"}),a.jsx(_e,{value:A.dose,onChange:oe=>k(ue=>({...ue,dose:oe.target.value})),placeholder:"e.g. 500 mg",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Frequency"}),a.jsx(_e,{value:A.frequency,onChange:oe=>k(ue=>({...ue,frequency:oe.target.value})),placeholder:"e.g. 1-0-1",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Days"}),a.jsx(_e,{value:A.duration_days,onChange:oe=>k(ue=>({...ue,duration_days:oe.target.value,total_qty:ue.total_qty||ge({...ue,duration_days:oe.target.value})})),placeholder:"e.g. 5",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Route"}),a.jsx(_e,{value:A.route,onChange:oe=>k(ue=>({...ue,route:oe.target.value})),placeholder:"PO / IV / IM / etc",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Total Qty"}),a.jsx(_e,{value:A.total_qty,onChange:oe=>k(ue=>({...ue,total_qty:oe.target.value})),placeholder:ge(A)?`Suggested: ${ge(A)}`:"eg. 10",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Instructions to patient"}),a.jsx(_e,{value:A.instructions,onChange:oe=>k(ue=>({...ue,instructions:oe.target.value})),placeholder:"After food, morning & night, etc.",className:"h-8 text-[11px] bg-white border-slate-200 rounded-full"})]})]}),a.jsxs("div",{className:"flex flex-col justify-between gap-2",children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:a.jsx("p",{children:"Add medicine to this prescription. Quantity can be auto-estimated from frequency & days."})}),a.jsx("div",{className:"flex justify-end",children:a.jsxs(Pe,{type:"button",size:"sm",className:"h-9 px-3 rounded-full",onClick:ae,children:[a.jsx(Nn,{className:"w-3.5 h-3.5 mr-1"}),"Add line"]})})]})]})}),a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[280px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),a.jsxs("tbody",{children:[!S.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines added. Use the panel above to add medicines to this prescription."})}),S.map((oe,ue)=>{var De,St;return a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:ue+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:((De=oe.item)==null?void 0:De.name)||oe.item_name||"Unnamed medicine"}),oe.strength&&a.jsx("span",{className:"text-[10px] text-slate-500",children:oe.strength})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{children:[oe.dose||""," "," ",oe.frequency||""," "," ",oe.duration_days?`${oe.duration_days} days`:""]}),oe.instructions&&a.jsx("span",{className:"text-[10px] text-slate-500",children:oe.instructions})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:oe.route||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:oe.total_qty||ge(oe)||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right",children:a.jsx(Pe,{variant:"ghost",size:"sm",className:"h-7 px-2 text-[11px] text-slate-500 hover:text-red-600",onClick:()=>Ve(ue),children:"Remove"})})]},`${oe.item_id||((St=oe.item)==null?void 0:St.id)||ue}-${ue}`)})]})]})})}),a.jsxs("div",{className:"flex justify-between items-center pt-1",children:[a.jsxs(Pe,{type:"button",variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-slate-500",onClick:()=>{le(),n("list")},children:[a.jsx(Cb,{className:"w-3 h-3 mr-1"}),"Back to queue"]}),a.jsx(Pe,{type:"button",size:"sm",className:"h-9 px-4 rounded-full",onClick:nt,disabled:T,children:T?"Saving...":a.jsxs(a.Fragment,{children:[a.jsx(_r,{className:"w-3.5 h-3.5 mr-1"}),"Save & Send to Pharmacy"]})})]})]})]})]})}),a.jsx(mn,{value:"detail",children:x?a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsxs(Je,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(_r,{className:"w-4 h-4 text-slate-500"}),"Prescription #",x.rx_number||x.id]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-slate-500",children:[a.jsxs("span",{children:["Type:"," ",a.jsx(Xe,{variant:"outline",className:"px-1.5 py-0.5",children:x.type||x.rx_type||"OPD"})]}),x.priority&&a.jsxs("span",{children:["Priority: ",x.priority]}),x.doctor_name&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(un,{className:"w-3 h-3"}),x.doctor_name]})]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[a.jsxs("div",{children:["UHID:"," ",x.patient_uhid||((ct=x.patient)==null?void 0:ct.uhid)||""]}),a.jsxs("div",{children:["Patient:"," ",x.patient_name||`${((Me=x.patient)==null?void 0:Me.first_name)||""} ${((qe=x.patient)==null?void 0:qe.last_name)||""}`.trim()||""]})]})]}),a.jsx(ze,{className:"space-y-3",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[380px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Dose / Freq / Days"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Route"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"})]})}),a.jsxs("tbody",{children:[!jt.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found for this prescription."})}),jt.map((oe,ue)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:ue+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:oe.item_name||oe.medicine_name||"Unnamed medicine"}),oe.strength&&a.jsx("span",{className:"text-[10px] text-slate-500",children:oe.strength})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{children:[oe.dose||""," "," ",oe.frequency||""," "," ",oe.duration_days?`${oe.duration_days} days`:""]}),oe.instructions&&a.jsx("span",{className:"text-[10px] text-slate-500",children:oe.instructions})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:oe.route||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:oe.total_qty||oe.qty||oe.quantity||ge(oe)||""})]},oe.id||ue))]})]})})})})]}):a.jsx(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:a.jsx(ze,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to view details."})})})]})]})}function URe({status:t}){const n=(t||"").toUpperCase();let s=n,r="bg-slate-50 text-slate-700 border border-slate-200";return n==="PENDING"||n==="NEW"?(s="Pending",r="bg-amber-50 text-amber-700 border border-amber-200"):n==="PARTIAL"?(s="Partial",r="bg-blue-50 text-blue-700 border border-blue-200"):n==="DISPENSED"||n==="COMPLETED"?(s="Dispensed",r="bg-emerald-50 text-emerald-700 border border-emerald-200"):n==="CANCELLED"&&(s="Cancelled",r="bg-rose-50 text-rose-700 border border-rose-200"),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[11px] rounded-full ${r}`,children:s})}function z2(t={}){return ne.get("/pharmacy/billing",{params:t})}function U2(t){return ne.get(`/pharmacy/billing/${t}`)}function VRe(t,n){return ne.post(`/pharmacy/billing/${t}/status`,n)}function HRe(t={}){return ne.get("/pharmacy/billing/returns/list",{params:t})}function WRe(t){return ne.post("/pharmacy/billing/returns",t)}function qRe(t){return ne.post("/pharmacy/billing/ipd/consolidated",t)}async function V2(t){try{const n=await ne.get(`/pharmacy/billing/${t}/pdf`,{responseType:"blob"}),s=new Blob([n.data],{type:"application/pdf"}),r=window.URL.createObjectURL(s);window.open(r,"_blank","noopener,noreferrer")}catch(n){console.error("Failed to open pharmacy bill PDF",n)}}const GRe=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],KRe=[{value:"ALL",label:"All"},{value:"UNPAID",label:"Unpaid"},{value:"PARTIAL",label:"Partial"},{value:"PAID",label:"Paid"},{value:"CANCELLED",label:"Cancelled"}],YRe=[{value:"CASH",label:"Cash"},{value:"CARD",label:"Card"},{value:"UPI",label:"UPI"},{value:"NET_BANKING",label:"Net Banking"},{value:"OTHER",label:"Other"}];function br(t){const n=Number(t??0);return Number.isFinite(n)?`${n.toFixed(2)}`:"0.00"}function mg(t={}){const n=(t.type||t.bill_type||"").toUpperCase();if(n==="OPD"||n==="IPD"||n==="OT"||n==="COUNTER")return n;const s=(t.context_type||"").toUpperCase();return s==="OPD"?"OPD":s==="IPD"?"IPD":s==="PHARM_COUNTER"||s==="COUNTER"?"COUNTER":"OPD"}function H2(t){const n=(t||"").toUpperCase();return n?n==="PARTIALLY_PAID"?"PARTIAL":n==="DRAFT"?"UNPAID":n:"UNPAID"}function XRe(){var yn,re,Ce,Ue,Qe,ht,$e,Xt,Ut,en,Tn,Rs,Xl,Bt,Wt,si,Tt;const[t,n]=y.useState("bills"),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState("ALL"),[d,u]=y.useState("ALL"),[h,m]=y.useState(""),[x,b]=y.useState(""),[w,j]=y.useState(""),[S,C]=y.useState(null),[A,k]=y.useState(!1),[T,I]=y.useState(null),[D,O]=y.useState("CASH"),[R,P]=y.useState(""),[L,$]=y.useState(!1),[B,V]=y.useState([]),[K,z]=y.useState(!1),[H,Y]=y.useState(""),[G,J]=y.useState(null),[ee,ye]=y.useState([]),[ie,he]=y.useState(""),[be,we]=y.useState(!1),[Z,ce]=y.useState(""),[Te,le]=y.useState(""),[de,ge]=y.useState(!1),[ae,Ve]=y.useState([]),[nt,wt]=y.useState(null);y.useEffect(()=>{jt()},[d]),y.useEffect(()=>{t==="returns"&&Me(),t==="ipd"&&qe()},[t]);async function jt(){try{l(!0);const pe={limit:100};d!=="ALL"&&(pe.status=d),h.trim()&&(pe.q=h.trim()),x&&(pe.date_from=x),w&&(pe.date_to=w);const at=await z2(pe);r((at==null?void 0:at.data)||[])}catch{}finally{l(!1)}}async function ct(pe){try{const at=await U2(pe.id);C((at==null?void 0:at.data)||pe)}catch{}}async function Me(){try{z(!0);const pe=await HRe({limit:50});V((pe==null?void 0:pe.data)||[])}catch{}finally{z(!1)}}async function qe(){try{const pe=await z2({limit:100}),lt=((pe==null?void 0:pe.data)||[]).filter(qt=>mg(qt)==="IPD");Ve(lt)}catch{}}const oe=y.useMemo(()=>s!=null&&s.length?o==="ALL"?s:s.filter(pe=>mg(pe)===o):[],[s,o]);function ue(pe){const at=Number(pe.total_amount??pe.gross_total??pe.net_amount??0),lt=Number(pe.paid_amount??0),qt=Number(pe.balance_amount??at-lt)||0;I(pe),P(qt>0?String(qt.toFixed(2)):String(at.toFixed(2))),O("CASH"),k(!0)}async function De(){if(!T)return;const pe=Number(R);if(!pe||pe<=0){xe.error("Enter a valid payment amount");return}const at=Number(T.total_amount??T.gross_total??T.net_amount??0),qt=Number(T.paid_amount??0)+pe,Rt=Math.max(at-qt,0);let Ft="PARTIAL";Rt<=.01?Ft="PAID":qt<=.01&&(Ft="UNPAID");try{if($(!0),await VRe(T.id,{payment_status:Ft,paid_amount:pe,note:null}),xe.success("Payment recorded successfully"),k(!1),I(null),P(""),await jt(),S&&S.id===T.id){const Qn=await U2(S.id);C((Qn==null?void 0:Qn.data)||S)}}catch{}finally{$(!1)}}async function St(){if(!H.trim()){xe.error("Enter bill no / patient / UHID to search");return}try{const pe=await z2({q:H.trim(),limit:1}),at=(pe==null?void 0:pe.data)||[];if(!at.length){xe.error("No matching pharmacy bill found");return}const lt=at[0],qt=await U2(lt.id),Rt=(qt==null?void 0:qt.data)||lt,Qn=(Rt.items||Rt.lines||[]).map(bn=>({...bn,return_qty:""}));J(Rt),ye(Qn)}catch{}}function tn(pe,at){ye(lt=>lt.map((qt,Rt)=>Rt===pe?{...qt,return_qty:at}:qt))}async function Lt(){if(!G){xe.error("Select a source bill first");return}const pe=ee.filter(lt=>Number(lt.return_qty||0)>0);if(!pe.length){xe.error("Enter return quantity for at least one item");return}const at={source_invoice_id:G.id,reason:ie||null,lines:pe.map(lt=>({bill_line_id:lt.id,qty_to_return:Number(lt.return_qty||0)}))};try{we(!0),await WRe(at),xe.success("Return note created successfully"),he(""),J(null),ye([]),Y(""),Me()}catch{}finally{we(!1)}}async function Dt(){if(!Z&&!Te){xe.error("Enter Patient ID or Admission ID");return}const pe={};Z&&(pe.patient_id=Number(Z)),Te&&(pe.admission_id=Number(Te));try{ge(!0);const at=await qRe(pe),lt=(at==null?void 0:at.data)||at||null;if(!lt){xe.error("No consolidated data returned");return}wt(lt),xe.success("IPD consolidated pharmacy summary generated")}catch{}finally{ge(!1)}}const Un=y.useMemo(()=>S?S.items||S.lines||[]:[],[S]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between gap-3",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Billing Console"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Manage pharmacy invoices, payments, returns & IPD consolidated bills."})]})}),a.jsxs(_o,{value:t,onValueChange:n,children:[a.jsxs(Ll,{className:"mb-4",children:[a.jsx(dn,{value:"bills",children:"Bills"}),a.jsx(dn,{value:"returns",children:"Returns"}),a.jsx(dn,{value:"ipd",children:"IPD Consolidated"})]}),a.jsx(mn,{value:"bills",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.7fr)_minmax(0,1.3fr)]",children:[a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(cN,{className:"w-4 h-4 text-slate-500"}),"Pharmacy Bills"]}),a.jsx(Pe,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:jt,children:a.jsx(Ai,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[a.jsx(jn,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(_e,{value:h,onChange:pe=>m(pe.target.value),onKeyDown:pe=>{pe.key==="Enter"&&jt()},placeholder:"Search bill no / UHID / patient / phone",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(_e,{type:"date",value:x,onChange:pe=>b(pe.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),a.jsx(_e,{type:"date",value:w,onChange:pe=>j(pe.target.value),className:"h-9 text-[11px] bg-white border-slate-200 rounded-full w-[130px]"}),a.jsx(Pe,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:jt,children:"Apply"})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs(Mn,{value:o,onValueChange:c,children:[a.jsx(An,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(On,{placeholder:"Bill type"})}),a.jsx(kn,{children:GRe.map(pe=>a.jsx(Et,{value:pe.value,children:pe.label},pe.value))})]}),a.jsxs(Mn,{value:d,onValueChange:u,children:[a.jsx(An,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(On,{placeholder:"Status"})}),a.jsx(kn,{children:KRe.map(pe=>a.jsx(Et,{value:pe.value,children:pe.label},pe.value))})]})]})]})]})}),a.jsx(ze,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[480px]",children:a.jsxs("table",{className:"w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Paid / Balance"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading bills..."})}),!i&&!oe.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy bills found for selected filters."})}),!i&&oe.map(pe=>{var nr,rt,Oi;const at=Number(pe.total_amount??pe.gross_total??pe.net_amount??0),lt=Number(pe.paid_amount??0),qt=Number(pe.balance_amount??at-lt)||0,Rt=H2(pe.status),Ft=pe.bill_date||pe.created_at||pe.invoice_date||null,Qn=Ft?String(Ft).slice(0,16).replace("T"," "):"",bn=mg(pe),Ls=pe.patient_name||`${((nr=pe.patient)==null?void 0:nr.first_name)||""} ${((rt=pe.patient)==null?void 0:rt.last_name)||""}`.trim()||"",ls=pe.patient_uhid||((Oi=pe.patient)==null?void 0:Oi.uhid),Bs=Rt!=="PAID"&&Rt!=="CANCELLED"&&at>0;return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/70 cursor-pointer",onClick:()=>ct(pe),children:[a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:pe.bill_number||pe.invoice_number||`PB-${pe.id}`}),pe.rx_number&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["Rx: ",pe.rx_number]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:a.jsx(ps,{className:"w-3 h-3"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-900",children:Ls}),ls&&a.jsxs("div",{className:"text-[10px] text-slate-500",children:["UHID: ",ls]})]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx(Xe,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:bn}),a.jsx(W2,{status:Rt})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",children:a.jsx("div",{className:"text-[11px] text-slate-900",children:br(at)})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",children:a.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[a.jsxs("span",{className:"text-[11px] text-emerald-700",children:["Paid: ",br(lt)]}),a.jsxs("span",{className:"text-[11px] text-rose-700",children:["Bal: ",br(qt)]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(Ys,{className:"w-3 h-3 text-slate-400"}),a.jsx("span",{children:Qn})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",onClick:dl=>dl.stopPropagation(),children:a.jsxs("div",{className:"flex justify-end gap-1.5",children:[a.jsx(Pe,{variant:"outline",size:"icon",className:"h-7 w-7 rounded-full border-slate-200",onClick:()=>{const dl=pe.id||pe.invoice_id;dl&&V2(dl)},children:a.jsx(Wd,{className:"w-3 h-3"})}),Bs&&a.jsxs(Pe,{size:"sm",className:"h-7 px-3 rounded-full text-[11px]",onClick:()=>ue(pe),children:[a.jsx(_l,{className:"w-3 h-3 mr-1"}),"Collect"]})]})})]},pe.id)})]})]})})})})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(cN,{className:"w-4 h-4 text-slate-500"}),"Bill Details"]})}),a.jsx(ze,{className:"space-y-3 text-xs",children:S?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:S.patient_name||`${((yn=S.patient)==null?void 0:yn.first_name)||""} ${((re=S.patient)==null?void 0:re.last_name)||""}`.trim()||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",S.patient_uhid||((Ce=S.patient)==null?void 0:Ce.uhid)||""]}),a.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[a.jsx(Xe,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5",children:mg(S)}),S.location&&a.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(lN,{className:"w-3 h-3"}),S.location]})]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:[a.jsxs("div",{children:["Bill:"," ",S.bill_number||S.invoice_number||`PB-${S.id}`]}),a.jsxs("div",{children:["Date:"," ",((Qe=(Ue=S.bill_date||S.created_at||"")==null?void 0:Ue.toString())==null?void 0:Qe.slice(0,10))||""]}),a.jsx("div",{className:"mt-1",children:a.jsx(W2,{status:H2(S.status)})})]})]}),a.jsxs("div",{className:"border border-slate-100 rounded-xl px-3 py-2.5 flex flex-col gap-1.5 bg-slate-50/60",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Total"}),a.jsx("span",{className:"text-[12px] font-semibold text-slate-900",children:br(S.total_amount??S.gross_total??S.net_amount)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Paid"}),a.jsx("span",{className:"text-[11px] text-emerald-700",children:br(S.paid_amount)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Balance"}),a.jsx("span",{className:"text-[11px] text-rose-700",children:br(S.balance_amount??Number(S.total_amount??S.gross_total??S.net_amount??0)-Number(S.paid_amount??0))})]})]}),a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[260px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Rate"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[!Un.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),Un.map((pe,at)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:at+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:pe.item_name||pe.medicine_name||""}),pe.batch_no&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",pe.batch_no]})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:pe.qty||pe.quantity||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:br(pe.rate||pe.unit_price)}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:br(pe.amount||pe.line_total)})]},pe.id||at))]})]})})}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsxs(Pe,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>{const pe=S.id||S.invoice_id;pe&&V2(pe)},children:[a.jsx(Wd,{className:"w-3 h-3 mr-1"}),"Download PDF"]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(Pe,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>ue(S),children:[a.jsx(_l,{className:"w-3 h-3 mr-1"}),"Add Payment"]})})]})]}):a.jsx("div",{className:"py-10 text-center text-[11px] text-slate-500",children:"Select a pharmacy bill from the list to view details."})})]})]})}),a.jsx(mn,{value:"returns",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1.6fr)]",children:[a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(ji,{className:"w-4 h-4 text-slate-500"}),"New Pharmacy Return"]})}),a.jsxs(ze,{className:"space-y-3 text-xs",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Source bill (search by bill no / UHID / patient)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(jn,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(_e,{value:H,onChange:pe=>Y(pe.target.value),placeholder:"Eg. PB-0001, UHID, patient name",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsx(Pe,{size:"sm",className:"h-9 px-3 rounded-full text-[11px]",onClick:St,children:"Search"})]})]}),G&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1.5",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:G.patient_name||`${((ht=G.patient)==null?void 0:ht.first_name)||""} ${(($e=G.patient)==null?void 0:$e.last_name)||""}`.trim()||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",G.patient_uhid||((Xt=G.patient)==null?void 0:Xt.uhid)||""]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",G.bill_number||G.invoice_number||`PB-${G.id}`,a.jsx("br",{}),"Date:"," ",((en=(Ut=G.bill_date||G.created_at||"")==null?void 0:Ut.toString())==null?void 0:en.slice(0,10))||""]})]})}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Items & return quantity"}),a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[250px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Sold Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Return Qty"})]})}),a.jsxs("tbody",{children:[!ee.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No items found for this bill."})}),ee.map((pe,at)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:at+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:pe.item_name||pe.medicine_name||""}),pe.batch_no&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["Batch: ",pe.batch_no]})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:pe.qty||pe.quantity||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right",children:a.jsx(_e,{type:"number",min:"0",value:pe.return_qty??"",onChange:lt=>tn(at,lt.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},pe.id||at))]})]})})})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Reason for return"}),a.jsx(mh,{value:ie,onChange:pe=>he(pe.target.value),rows:3,className:"text-[11px] bg-white border-slate-200 rounded-xl resize-none",placeholder:"Eg. Patient mismatch, wrong strength, expiry, doctor changed prescription, etc."})]}),a.jsx("div",{className:"flex justify-end pt-1",children:a.jsx(Pe,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:Lt,disabled:be,children:be?"Creating return...":a.jsxs(a.Fragment,{children:[a.jsx(ji,{className:"w-3.5 h-3.5 mr-1"}),"Create Return Note"]})})})]})]})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(ji,{className:"w-4 h-4 text-slate-500"}),"Recent Pharmacy Returns"]})}),a.jsx(ze,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[420px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Return"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Source bill"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Refund"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),a.jsxs("tbody",{children:[K&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"Loading returns..."})}),!K&&!B.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No pharmacy returns found."})}),!K&&B.map(pe=>{var Ft,Qn;const at=Math.abs(Number(pe.net_amount??pe.total_amount??0)),lt=(pe.created_at||"").toString().slice(0,16).replace("T"," "),qt=pe.patient_name||`${((Ft=pe.patient)==null?void 0:Ft.first_name)||""} ${((Qn=pe.patient)==null?void 0:Qn.last_name)||""}`.trim()||"",Rt=pe.source_bill_number||pe.source_invoice_number||"";return a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:pe.return_number||pe.bill_number||`PR-${pe.id}`}),pe.reason&&a.jsx("span",{className:"text-[10px] text-slate-500",children:pe.reason})]})}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsx("div",{className:"text-[11px] text-slate-900",children:qt})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:Rt}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:br(at)}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:lt||""})]},pe.id)})]})]})})})})]})]})}),a.jsx(mn,{value:"ipd",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(lN,{className:"w-4 h-4 text-slate-500"}),"Generate IPD Pharmacy Summary"]})}),a.jsxs(ze,{className:"space-y-3 text-xs",children:[a.jsx("p",{className:"text-[11px] text-slate-500",children:"Generate consolidated pharmacy summary for all UNPAID / PARTIALLY_PAID IPD pharmacy invoices for a given admission. Use this for final IPD discharge billing."}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Patient ID (internal PK)"}),a.jsx(_e,{value:Z,onChange:pe=>ce(pe.target.value),placeholder:"Eg. 123 (required)",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"IPD Admission ID (optional filter)"}),a.jsx(_e,{value:Te,onChange:pe=>le(pe.target.value),placeholder:"Eg. 45  IPD admission table ID",className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsx(Pe,{size:"sm",className:"h-9 px-4 rounded-full text-[11px]",onClick:Dt,disabled:de,children:de?"Generating...":a.jsxs(a.Fragment,{children:[a.jsx(cN,{className:"w-3.5 h-3.5 mr-1"}),"Generate Summary"]})})}),nt&&a.jsxs("div",{className:"mt-3 border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-2",children:[a.jsx("div",{className:"flex items-start justify-between gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:nt.patient_name||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",nt.patient_uhid||""]}),nt.admission_id&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Admission ID: ",nt.admission_id]})]})}),a.jsxs("div",{className:"border border-slate-100 rounded-lg px-3 py-2 bg-white space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Gross Total"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:br(nt.total_amount)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Tax"}),a.jsx("span",{className:"text-[11px] text-slate-900",children:br(nt.total_tax)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[11px] text-slate-600",children:"Net Amount"}),a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:br(nt.net_amount)})]})]}),a.jsx("div",{className:"border border-slate-100 rounded-lg overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[220px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[!((Tn=nt.items)!=null&&Tn.length)&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No pharmacy items found in this summary."})}),(Rs=nt.items)==null?void 0:Rs.map((pe,at)=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-900",children:pe.medicine_name||""}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:pe.qty}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-slate-700",children:br(pe.amount)})]},at))]})]})})}),a.jsxs("p",{className:"text-[10px] text-slate-500",children:["Use this summary while generating the final IPD discharge invoice in the main Billing module. Each contributing pharmacy bill ID is available in ",a.jsx("code",{children:"sale_ids"})," if needed."]})]})]})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(lN,{className:"w-4 h-4 text-slate-500"}),"Recent IPD Pharmacy Bills"]})}),a.jsx(ze,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[420px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Bill"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Status"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Amount"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Date"})]})}),a.jsxs("tbody",{children:[!ae.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-6 text-center text-[11px] text-slate-500",children:"No IPD pharmacy bills found."})}),ae.map(pe=>{var Ft,Qn;const at=Number(pe.total_amount??pe.gross_total??pe.net_amount??0),lt=H2(pe.status),qt=(pe.bill_date||pe.created_at||"").toString().slice(0,16).replace("T"," "),Rt=pe.patient_name||`${((Ft=pe.patient)==null?void 0:Ft.first_name)||""} ${((Qn=pe.patient)==null?void 0:Qn.last_name)||""}`.trim()||"";return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>{const bn=pe.id||pe.invoice_id;bn&&V2(bn)},children:[a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsx("div",{className:"flex flex-col",children:a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:pe.bill_number||pe.invoice_number||`PB-${pe.id}`})})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:Rt}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsx(W2,{status:lt})}),a.jsx("td",{className:"px-3 py-2 align-top text-right text-[11px] text-slate-700",children:br(at)}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:qt||""})]},pe.id)})]})]})})})})]})]})})]})]}),a.jsx(rf,{open:A,onOpenChange:k,children:a.jsxs(_d,{className:"max-w-md rounded-2xl",children:[a.jsxs(Cd,{children:[a.jsxs(kd,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(_l,{className:"w-4 h-4 text-slate-600"}),"Collect Pharmacy Payment"]}),a.jsx(Ed,{className:"text-xs text-slate-500",children:"Record payment for this pharmacy invoice. You can add multiple payments later (partial payments supported)."})]}),T&&a.jsxs("div",{className:"space-y-3 text-xs",children:[a.jsxs("div",{className:"border border-slate-100 rounded-xl p-3 bg-slate-50/60 space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-900",children:T.patient_name||`${((Xl=T.patient)==null?void 0:Xl.first_name)||""} ${((Bt=T.patient)==null?void 0:Bt.last_name)||""}`.trim()||""}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",T.patient_uhid||((Wt=T.patient)==null?void 0:Wt.uhid)||""]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Bill:"," ",T.bill_number||T.invoice_number||`PB-${T.id}`,a.jsx("br",{}),"Date:"," ",((Tt=(si=T.bill_date||T.created_at||"")==null?void 0:si.toString())==null?void 0:Tt.slice(0,10))||""]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-dashed border-slate-200",children:[a.jsx("div",{className:"text-[11px] text-slate-600",children:"Total / Paid / Balance"}),a.jsxs("div",{className:"text-right text-[11px]",children:[a.jsx("div",{className:"text-slate-900",children:br(T.total_amount??T.gross_total??T.net_amount)}),a.jsx("div",{className:"text-emerald-700",children:br(T.paid_amount)}),a.jsx("div",{className:"text-rose-700",children:br(T.balance_amount??Number(T.total_amount??T.gross_total??T.net_amount??0)-Number(T.paid_amount??0))})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Payment mode"}),a.jsxs(Mn,{value:D,onValueChange:O,children:[a.jsx(An,{className:"w-full h-9 bg-white border-slate-200 rounded-full text-[11px]",children:a.jsx(On,{placeholder:"Select mode"})}),a.jsx(kn,{children:YRe.map(pe=>a.jsx(Et,{value:pe.value,children:pe.label},pe.value))})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(Ye,{className:"text-[11px] text-slate-600",children:"Amount"}),a.jsx(_e,{type:"number",min:"0",value:R,onChange:pe=>P(pe.target.value),className:"h-9 text-xs bg-white border-slate-200 rounded-full"})]})]})]}),a.jsxs(Ad,{className:"mt-3",children:[a.jsx(Pe,{variant:"outline",size:"sm",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>k(!1),children:"Cancel"}),a.jsx(Pe,{size:"sm",className:"h-8 px-4 rounded-full text-[11px]",onClick:De,disabled:L,children:L?"Saving...":a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-3 h-3 mr-1"}),"Save Payment"]})})]})]})})]})}function W2({status:t}){const n=(t||"").toUpperCase();let s=n||"",r="bg-slate-50 text-slate-700 border border-slate-200";return n==="UNPAID"||n==="PENDING"||n==="DRAFT"?(s="Unpaid",r="bg-amber-50 text-amber-700 border border-amber-200"):n==="PARTIAL"||n==="PARTIALLY_PAID"?(s="Partially paid",r="bg-blue-50 text-blue-700 border border-blue-200"):n==="PAID"?(s="Paid",r="bg-emerald-50 text-emerald-700 border border-emerald-200"):n==="CANCELLED"?(s="Cancelled",r="bg-rose-50 text-rose-700 border border-rose-200"):n==="FINALIZED"&&(s="Finalized",r="bg-slate-50 text-slate-700 border border-slate-300"),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${r}`,children:s})}function QRe(t){return ne.post("/pharmacy/prescriptions",t)}function ZRe(t={}){return ne.get("/pharmacy/prescriptions",{params:t})}function JRe(t,n){return ne.post(`/pharmacy/prescriptions/${t}/dispense`,n)}function e6e(t){return ne.post(`/pharmacy/prescriptions/${t}/bill`)}function t6e(t={}){return ne.get("/pharmacy/billing",{params:t})}function n6e(t={}){return ne.get("/pharmacy/billing/returns/list",{params:t})}function s6e(t){if(!t)return"";const n=new Date(t);return`${n.toLocaleDateString()} ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function r6e(){const[t,n]=y.useState(""),[s,r]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(!1),h=async()=>{try{u(!0);const x={context_type:"pharmacy"};t&&(x.q=t),s&&(x.date_from=s),i&&(x.date_to=i);const b=await t6e(x);c(b.data||[])}catch{}finally{u(!1)}};y.useEffect(()=>{h()},[]);const m=o.reduce((x,b)=>x+(b.total_amount||0),0);return a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(I1,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Counter Sales (OTC)"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View Pharmacy counter / OTC sales. (Future: add direct sale screen here.)"})]})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-2",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(_e,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:x=>n(x.target.value)})]}),a.jsx(_e,{type:"date",className:"h-9 w-32",value:s,onChange:x=>r(x.target.value)}),a.jsx(_e,{type:"date",className:"h-9 w-32",value:i,onChange:x=>l(x.target.value)}),a.jsxs(Pe,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:h,disabled:d,children:[d?a.jsx(nn,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Sales in view"," ",a.jsx(Xe,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:o.length})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Net amount"," ",a.jsxs("span",{className:"font-semibold text-slate-900",children:["",m.toFixed(2)]})]})]})]})}),a.jsxs(ze,{className:"pt-0",children:[a.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),a.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:a.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Sale"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),a.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[o.length===0&&!d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No counter sales found."})}),d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-8 text-center",children:a.jsx(nn,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&o.map(x=>a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[a.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(I1,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Sale #",x.id]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(Ys,{className:"h-3 w-3"}),a.jsx("span",{children:s6e(x.created_at)})]})]})}),a.jsxs("td",{className:"py-2.5 px-2 align-top",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:x.patient_name||""})]}),a.jsxs("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:[x.patient_uhid&&a.jsx(Xe,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:x.patient_uhid}),x.payment_mode&&a.jsx("span",{className:"capitalize",children:x.payment_mode})]})]}),a.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:a.jsxs("div",{className:"text-[11px] font-semibold text-slate-900",children:["",(x.total_amount||0).toFixed(2)]})})]},x.id))]})]})})]})]})]})}function a6e(t){if(!t)return"";const n=new Date(t);return`${n.toLocaleDateString()} ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function i6e(){const[t,n]=y.useState(""),[s,r]=y.useState(""),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(!1),h=async()=>{try{u(!0);const x={};t&&(x.q=t),s&&(x.date_from=s),i&&(x.date_to=i);const b=await n6e(x);c(b.data||[])}catch{}finally{u(!1)}};y.useEffect(()=>{h()},[]);const m=o.reduce((x,b)=>x+(b.total_amount||0),0);return a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(ji,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Returns"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"Shows Pharmacy bills treated as returns (negative amounts). Later you can connect this to a dedicated return workflow."})]})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-2",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(_e,{placeholder:"UHID / Name / Phone",className:"pl-7 h-9 w-40 sm:w-52",value:t,onChange:x=>n(x.target.value)})]}),a.jsx(_e,{type:"date",className:"h-9 w-32",value:s,onChange:x=>r(x.target.value)}),a.jsx(_e,{type:"date",className:"h-9 w-32",value:i,onChange:x=>l(x.target.value)}),a.jsxs(Pe,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:h,disabled:d,children:[d?a.jsx(nn,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):null,"Apply"]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1 text-right",children:[a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Returns in view"," ",a.jsx(Xe,{variant:"secondary",className:"ml-1 h-5 px-2 text-[10px]",children:o.length})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Total refund"," ",a.jsxs("span",{className:"font-semibold text-slate-900",children:["",m.toFixed(2)]})]})]})]})}),a.jsxs(ze,{className:"pt-0",children:[a.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),a.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:a.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-100 text-[11px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-2 pl-3 pr-2 text-left font-medium",children:"Return"}),a.jsx("th",{className:"py-2 px-2 text-left font-medium",children:"Patient"}),a.jsx("th",{className:"py-2 px-2 text-right font-medium",children:"Amount"})]})}),a.jsxs("tbody",{children:[o.length===0&&!d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-10 text-center text-xs text-slate-500",children:"No Pharmacy returns detected (no negative Pharmacy bills)."})}),d&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"py-8 text-center",children:a.jsx(nn,{className:"mx-auto h-4 w-4 animate-spin text-slate-400"})})}),!d&&o.map(x=>a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60",children:[a.jsx("td",{className:"py-2.5 pl-3 pr-2 align-top",children:a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ji,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsxs("span",{className:"font-medium text-[11px] text-slate-800",children:["Return #",x.id]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(Ys,{className:"h-3 w-3"}),a.jsx("span",{children:a6e(x.created_at)})]})]})}),a.jsxs("td",{className:"py-2.5 px-2 align-top",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:x.patient_name||""})]}),a.jsx("div",{className:"mt-0.5 text-[10px] text-slate-500 flex flex-wrap gap-1",children:x.patient_uhid&&a.jsx(Xe,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:x.patient_uhid})})]}),a.jsx("td",{className:"py-2.5 px-2 align-top text-right",children:a.jsxs("div",{className:"text-[11px] font-semibold text-red-600",children:["",(x.total_amount||0).toFixed(2)]})})]},x.id))]})]})})]})]})]})}const l6e=[{value:"ALL",label:"All types"},{value:"OPD",label:"OPD"},{value:"IPD",label:"IPD"},{value:"OT",label:"OT"},{value:"COUNTER",label:"Counter"}],gd="ALL_LOC";function o6e(t){const n=Number(t.requested_qty??t.total_qty??t.qty??t.quantity??0),s=Number(t.dispensed_qty??0),r=Math.max(n-s,0);return{requested:n,remaining:r}}function q2(t){const n=Number(t.duration_days||0),s=(t.frequency_code||t.frequency||"").trim();if(!n||!s)return"";const i=s.split("-").map(l=>Number(l||0)).reduce((l,o)=>l+(Number.isFinite(o)?o:0),0);return i?i*n:""}function c6e(){const[t,n]=y.useState("queue"),[s,r]=y.useState("ALL"),[i,l]=y.useState("PENDING"),[o,c]=y.useState(""),[d,u]=y.useState(!1),[h,m]=y.useState([]),[x,b]=y.useState(null),[w,j]=y.useState([]),[S,C]=y.useState(!1),[A,k]=y.useState([]),[T,I]=y.useState(gd);y.useEffect(()=>{async function B(){try{const V=await aw(),K=(V==null?void 0:V.data)||[];k(K),T||I(gd)}catch{}}B()},[]),y.useEffect(()=>{D()},[s,i,T]);async function D(){try{u(!0);const B={status:i==="ALL"?void 0:i,type:s==="ALL"?void 0:s,limit:100};o.trim()&&(B.q=o.trim()),T&&T!==gd&&(B.location_id=Number(T));const V=await FRe(B);m((V==null?void 0:V.data)||[])}catch{}finally{u(!1)}}async function O(B){try{const V=await sK(B.id),K=(V==null?void 0:V.data)||B;b(K);const z=(K.lines||K.items||[]).map(H=>{const{requested:Y,remaining:G}=o6e(H);return{...H,requested_qty:Y,remaining_qty:G||q2(H)||Y,dispense_qty:G||q2(H)||Y||""}});j(z),n("dispense")}catch{}}function R(B,V){j(K=>K.map((z,H)=>H===B?{...z,dispense_qty:V}:z))}async function P(){var z,H;if(!x)return;const B=w.filter(Y=>Number(Y.dispense_qty||0)>0);if(!B.length){xe.error("Enter quantity to dispense for at least one line");return}let V=x.location_id||null;if(T&&T!==gd&&(V=Number(T)),!V){xe.error("Select a pharmacy location before dispensing.");return}const K={lines:B.map(Y=>({line_id:Y.id,dispense_qty:Number(Y.dispense_qty||0)})),location_id:V,create_sale:!0,context_type:(x.type||x.rx_type||"OPD").toUpperCase()};try{C(!0);const Y=await BRe(x.id,K),G=(Y==null?void 0:Y.data)||{};G.sale_id||((z=G.sale)==null?void 0:z.id)||((H=G.pharmacy_sale)==null?void 0:H.id)||G.saleId||null?xe.success("Medicines dispensed and pharmacy bill created"):xe.success("Dispense recorded (no bill returned from server)"),await D(),b(null),j([]),n("queue")}catch(Y){console.error("Dispense error",Y)}finally{C(!1)}}const L=y.useMemo(()=>w||[],[w]),$=y.useMemo(()=>{if(!(A!=null&&A.length))return"No locations configured";if(!T||T===gd)return"All / Not linked";const B=Number(T),V=A.find(K=>K.id===B);return V?V.name||V.code||`Location #${V.id}`:`Location #${B}`},[A,T]);return a.jsxs("div",{className:"p-4 md:p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-slate-900",children:"Pharmacy Dispense"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Convert prescriptions to pharmacy sales with FEFO-linked inventory and billing."})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx(s7,{className:"w-4 h-4 text-slate-500"}),a.jsx("span",{className:"text-slate-500",children:"Location"}),a.jsxs(Mn,{value:T,onValueChange:B=>I(B||gd),children:[a.jsx(An,{className:"w-[200px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(On,{placeholder:"Select location"})}),a.jsxs(kn,{children:[a.jsx(Et,{value:gd,children:"All / Not linked"}),A.map(B=>a.jsx(Et,{value:String(B.id),children:B.name||B.code||`Location #${B.id}`},B.id))]})]})]})]}),a.jsxs(_o,{value:t,onValueChange:n,children:[a.jsxs(Ll,{className:"mb-4",children:[a.jsx(dn,{value:"queue",children:"Dispense Queue"}),a.jsx(dn,{value:"dispense",disabled:!x,children:"Selected Rx"})]}),a.jsx(mn,{value:"queue",className:"space-y-3",children:a.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,1.7fr)]",children:[a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(_r,{className:"w-4 h-4 text-slate-500"}),"Pending Prescriptions"]}),a.jsx(Pe,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full border-slate-200",onClick:D,children:a.jsx(Ai,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"relative flex-1",children:[a.jsx(jn,{className:"w-4 h-4 text-slate-400 absolute left-2.5 top-2.5"}),a.jsx(_e,{value:o,onChange:B=>c(B.target.value),onKeyDown:B=>{B.key==="Enter"&&D()},placeholder:"Search UHID / patient / Rx no...",className:"pl-8 h-9 text-xs bg-white border-slate-200 rounded-full"})]})}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Mn,{value:s,onValueChange:r,children:[a.jsx(An,{className:"w-[140px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(On,{placeholder:"Type"})}),a.jsx(kn,{children:l6e.map(B=>a.jsx(Et,{value:B.value,children:B.label},B.value))})]}),a.jsxs(Mn,{value:i,onValueChange:l,children:[a.jsx(An,{className:"w-[130px] bg-white border-slate-200 rounded-full h-8 text-[11px]",children:a.jsx(On,{placeholder:"Status"})}),a.jsxs(kn,{children:[a.jsx(Et,{value:"PENDING",children:"Pending only"}),a.jsx(Et,{value:"ALL",children:"All status"}),a.jsx(Et,{value:"PARTIAL",children:"Partial"}),a.jsx(Et,{value:"DISPENSED",children:"Dispensed"})]})]})]})]})]})}),a.jsx(ze,{className:"pt-0",children:a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[460px]",children:a.jsxs("table",{className:"w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Rx"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Patient"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Type / Doctor"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Items"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Time"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Action"})]})}),a.jsxs("tbody",{children:[d&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"Loading queue..."})}),!d&&!h.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:"No prescriptions waiting for dispense."})}),!d&&h.map(B=>{var ye,ie,he;const V=B.type||B.rx_type||"OPD",K=(B.status||"").toUpperCase()||"PENDING",z=B.created_at||B.rx_datetime||B.bill_date||null,H=z?String(z).slice(0,16).replace("T"," "):"",Y=B.patient_name||B.patient_full_name||B.patient_display||B.patient&&`${B.patient.first_name||""} ${B.patient.last_name||""}`.trim()||B.patient||"",G=B.patient_uhid||B.uhid||((ye=B.patient)==null?void 0:ye.uhid)||"",J=B.doctor_name||B.doctor||B.doctor_display||"",ee=((ie=B.items)==null?void 0:ie.length)||((he=B.lines)==null?void 0:he.length)||B.item_count||"";return a.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50/60 cursor-pointer",onClick:()=>O(B),children:[a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:B.rx_number||B.prescription_number||`RX-${B.id}`}),G&&a.jsxs("span",{className:"text-[10px] text-slate-500",children:["UHID:"," ",G]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-slate-100 flex items-center justify-center text-[11px] text-slate-700",children:a.jsx(ps,{className:"w-3 h-3"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] text-slate-900",children:Y||""}),G&&a.jsx("div",{className:"text-[10px] text-slate-500",children:G})]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx(Xe,{variant:"outline",className:"border-slate-200 text-[10px] px-1.5 py-0.5 w-max",children:V}),J&&a.jsxs("span",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(un,{className:"w-3 h-3"}),J]})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:ee}),a.jsx("td",{className:"px-3 py-2 align-middle text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ys,{className:"w-3 h-3 text-slate-400"}),a.jsx("span",{children:H})]})}),a.jsx("td",{className:"px-3 py-2 align-middle text-right",children:a.jsx(d6e,{status:K})})]},B.id)})]})]})})})})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(Ur,{className:"w-4 h-4 text-slate-500"}),"Selected Prescription"]})}),a.jsx(ze,{className:"space-y-3",children:x?a.jsx("div",{className:"space-y-3 text-xs",children:(()=>{var K;const B=x.patient_name||x.patient_full_name||x.patient_display||x.patient&&`${x.patient.first_name||""} ${x.patient.last_name||""}`.trim()||"",V=x.patient_uhid||x.uhid||((K=x.patient)==null?void 0:K.uhid)||"";return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-slate-900",children:B}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID:"," ",V]})]}),a.jsxs("div",{className:"text-right text-[11px] text-slate-500",children:["Rx No:"," ",x.rx_number||x.prescription_number||`RX-${x.id}`,a.jsx("br",{}),"Type:"," ",x.type||x.rx_type||"OPD"]})]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Items:"," ",(x.lines||x.items||[]).length||""]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Queue filter:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:$})]}),a.jsxs(Pe,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[11px]",onClick:()=>n("dispense"),children:[a.jsx(zr,{className:"w-3 h-3 mr-1"}),"Open for dispensing"]})]})})()}):a.jsx("div",{className:"py-8 text-center text-xs text-slate-500",children:"Click a prescription from the queue to start dispensing."})})]})]})}),a.jsx(mn,{value:"dispense",children:x?a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsxs(Je,{className:"pb-3 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs(st,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(zr,{className:"w-4 h-4 text-emerald-500"}),"Dispense Medicines"]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Rx:"," ",x.rx_number||x.prescription_number||`RX-${x.id}`," ",""," ",x.type||x.rx_type||"OPD"," ",""," ",x.patient_name||x.patient_full_name||x.patient_display||x.patient&&`${x.patient.first_name||""} ${x.patient.last_name||""}`.trim()||"",a.jsx("br",{}),"Queue filter:"," ",a.jsx("span",{className:"font-medium text-slate-700",children:$})]})]}),a.jsx(Pe,{variant:"ghost",size:"sm",className:"h-8 px-3 text-[11px]",onClick:()=>n("queue"),children:"Back to queue"})]}),a.jsxs(ze,{className:"space-y-3",children:[a.jsx("div",{className:"border border-slate-100 rounded-xl overflow-hidden bg-white",children:a.jsx(pa,{className:"max-h-[420px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50/80 sticky top-0 z-10",children:a.jsxs("tr",{className:"text-[11px] text-slate-500",children:[a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"#"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Medicine"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Instructions"}),a.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Prescribed Qty"}),a.jsx("th",{className:"text-right px-3 py-2 font-medium",children:"Dispense Qty"})]})}),a.jsxs("tbody",{children:[!L.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-[11px] text-slate-500",children:"No lines found in this prescription."})}),L.map((B,V)=>{const K=B.dose_text||B.dose||"",z=B.frequency_code||B.frequency||(Number.isFinite(B.times_per_day)?`${B.times_per_day} times/day`:""),H=B.duration_days?`${B.duration_days} days`:B.duration||"",Y=[K,z,H].filter(Boolean).join("  ")||"",G=[B.route,B.timing,B.instructions].filter(Boolean).join("  "),J=B.requested_qty??B.total_qty??B.qty??B.quantity??q2(B)??"";return a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-2 align-top text-slate-500",children:V+1}),a.jsx("td",{className:"px-3 py-2 align-top",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-900",children:B.item_name||B.medicine_name||"Unnamed medicine"}),(B.item_strength||B.strength)&&a.jsx("span",{className:"text-[10px] text-slate-500",children:B.item_strength||B.strength})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{children:Y}),G&&a.jsx("span",{className:"text-[10px] text-slate-500",children:G})]})}),a.jsx("td",{className:"px-3 py-2 align-top text-[11px] text-slate-700",children:J}),a.jsx("td",{className:"px-3 py-2 align-top text-right",children:a.jsx(_e,{type:"number",min:"0",value:B.dispense_qty??"",onChange:ee=>R(V,ee.target.value),className:"h-8 w-20 ml-auto text-[11px] text-right bg-white border-slate-200 rounded-full"})})]},B.id||V)})]})]})})}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsx("div",{className:"text-[11px] text-slate-500",children:"Only lines with a positive Dispense Qty will create sale items."}),a.jsx(Pe,{size:"sm",className:"h-9 px-4 rounded-full",onClick:P,disabled:S,children:S?"Dispensing...":a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-3.5 h-3.5 mr-1"}),"Confirm Dispense & Generate Bill"]})})]})]})]}):a.jsx(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:a.jsx(ze,{className:"py-8 text-center text-sm text-slate-500",children:"Select a prescription from the queue to dispense."})})})]})]})}function d6e({status:t}){const n=(t||"").toUpperCase();let s=n,r="bg-slate-50 text-slate-700 border border-slate-200";return n==="PENDING"||n==="NEW"||n==="DRAFT"?(s=n==="DRAFT"?"Draft":"Pending",r="bg-amber-50 text-amber-700 border border-amber-200"):n==="PARTIAL"||n==="PARTIALLY_DISPENSED"?(s="Partial",r="bg-blue-50 text-blue-700 border border-blue-200"):n==="DISPENSED"||n==="COMPLETED"?(s="Dispensed",r="bg-emerald-50 text-emerald-700 border border-emerald-200"):n==="CANCELLED"&&(s="Cancelled",r="bg-rose-50 text-rose-700 border border-rose-200"),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[10px] rounded-full ${r}`,children:s})}function G2(t){if(!t)return"";const n=new Date(t);return`${n.toLocaleDateString()} ${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function u6e(t){switch(t){case"ISSUED":return{label:"Issued",className:"bg-amber-50 text-amber-700 border border-amber-100",icon:Ms};case"PARTIALLY_DISPENSED":return{label:"Partial",className:"bg-blue-50 text-blue-700 border border-blue-100",icon:Ms};case"DISPENSED":return{label:"Dispensed",className:"bg-emerald-50 text-emerald-700 border border-emerald-100",icon:zr};case"CANCELLED":return{label:"Cancelled",className:"bg-red-50 text-red-700 border border-red-100",icon:Ab};default:return{label:t||"Unknown",className:"bg-slate-50 text-slate-700 border border-slate-100",icon:Ms}}}function f6e(){const[t,n]=y.useState("ALL"),[s,r]=y.useState("ACTIVE"),[i,l]=y.useState("all"),[o,c]=y.useState(""),[d,u]=y.useState(""),[h,m]=y.useState(""),[x,b]=y.useState([]),[w,j]=y.useState([]),[S,C]=y.useState(!1),[A,k]=y.useState(null),[T,I]=y.useState(null),[D,O]=y.useState(null);y.useEffect(()=>{aw().then(K=>{const z=K.data||[];b(z)}).catch(()=>{b([])})},[]);const R=async()=>{try{C(!0);const K={};t!=="ALL"&&(K.type=t),(s==="ISSUED"||s==="PARTIALLY_DISPENSED"||s==="DISPENSED"||s==="CANCELLED")&&(K.status=s),o.trim()&&(K.patient_id=o.trim()),d&&(K.from_date=d),h&&(K.to_date=h);const z=await ZRe(K);j(z.data||[])}catch{}finally{C(!1)}};y.useEffect(()=>{R()},[t,s]);const P=y.useMemo(()=>{let K=w||[];return s==="ACTIVE"&&(K=K.filter(z=>z.status==="ISSUED"||z.status==="PARTIALLY_DISPENSED")),i!=="all"&&(K=K.filter(z=>String(z.location_id)===String(i))),K},[w,s,i]);y.useEffect(()=>{if(!P.length){k(null);return}(!A||!P.some(K=>K.id===A))&&k(P[0].id)},[P,A]);const L=y.useMemo(()=>P.find(K=>K.id===A)||null,[P,A]),$=y.useMemo(()=>{const K=P.length,z=P.filter(Y=>Y.status==="ISSUED"||Y.status==="PARTIALLY_DISPENSED").length,H=P.filter(Y=>Y.status==="DISPENSED").length;return{total:K,active:z,completed:H}},[P]),B=async K=>{if(!K)return;const H=(K.lines||[]).filter(Y=>Y.status==="WAITING"||Y.status==="PARTIAL"||Y.status==="PARTIALLY_DISPENSED").map(Y=>{const G=Number(Y.requested_qty||0),J=Number(Y.dispensed_qty||0),ee=G-J;return{line_id:Y.id,quantity:ee}}).filter(Y=>Y.quantity>0);if(!H.length){xe.info("No pending quantity to dispense for this prescription");return}if(window.confirm(`Dispense all remaining quantities (${H.length} line(s)) for Rx #${K.prescription_number||K.id}?`))try{I(K.id),await JRe(K.id,{lines:H,remark:"Quick dispense all remaining from Rx Explorer"}),xe.success("Prescription dispensed (remaining quantities)"),await R()}catch{}finally{I(null)}},V=async K=>{if(K&&window.confirm(`Generate Pharmacy bill from dispensed lines for Rx #${K.prescription_number||K.id}?`))try{O(K.id);const H=(await e6e(K.id)).data;xe.success(`Pharmacy bill created: ${H.bill_number} (Net ${H.net_amount})`)}catch{}finally{O(null)}};return a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(Ur,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:"Pharmacy Rx Explorer (Inventory)"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:"View, filter, and dispense inventory-integrated prescriptions across OPD/IPD/Counter. Uses FEFO batches and auto-billing."})]})]}),a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-2",children:a.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-400"}),a.jsx(_e,{placeholder:"Patient ID (optional)",className:"pl-7 h-9 w-36 sm:w-40",value:o,onChange:K=>c(K.target.value)})]}),a.jsx(_e,{type:"date",className:"h-9 w-32",value:d,onChange:K=>u(K.target.value)}),a.jsx(_e,{type:"date",className:"h-9 w-32",value:h,onChange:K=>m(K.target.value)}),a.jsxs(Pe,{size:"sm",variant:"outline",className:"h-9 text-xs",onClick:R,disabled:S,children:[S?a.jsx(nn,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):a.jsx(cu,{className:"mr-1 h-3.5 w-3.5"}),"Apply"]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end text-[11px] text-slate-500",children:[a.jsxs("div",{children:["Total"," ",a.jsx(Xe,{variant:"secondary",className:"h-5 px-2 text-[10px]",children:$.total})]}),a.jsxs("div",{children:["Active"," ",a.jsx(Xe,{variant:"outline",className:"h-5 px-2 text-[10px]",children:$.active})]}),a.jsxs("div",{children:["Dispensed"," ",a.jsx(Xe,{variant:"outline",className:"h-5 px-2 text-[10px]",children:$.completed})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_o,{value:t,onValueChange:n,className:"hidden sm:block",children:a.jsxs(Ll,{className:"h-8",children:[a.jsx(dn,{value:"ALL",className:"text-[11px]",children:"All"}),a.jsx(dn,{value:"OPD",className:"text-[11px]",children:"OPD"}),a.jsx(dn,{value:"IPD",className:"text-[11px]",children:"IPD"}),a.jsx(dn,{value:"GENERAL",className:"text-[11px]",children:"General"})]})}),a.jsx("div",{className:"sm:hidden flex gap-1 text-[11px]",children:["ALL","OPD","IPD","GENERAL"].map(K=>a.jsx(Xe,{variant:t===K?"default":"outline",className:"cursor-pointer",onClick:()=>n(K),children:K},K))}),a.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-[11px]",children:[a.jsx(Xe,{variant:s==="ACTIVE"?"default":"outline",className:"cursor-pointer",onClick:()=>r("ACTIVE"),children:"Active"}),a.jsx(Xe,{variant:s==="ALL"?"default":"outline",className:"cursor-pointer",onClick:()=>r("ALL"),children:"All"}),a.jsx(Xe,{variant:s==="ISSUED"?"default":"outline",className:"cursor-pointer",onClick:()=>r("ISSUED"),children:"Issued"}),a.jsx(Xe,{variant:s==="PARTIALLY_DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>r("PARTIALLY_DISPENSED"),children:"Partial"}),a.jsx(Xe,{variant:s==="DISPENSED"?"default":"outline",className:"cursor-pointer",onClick:()=>r("DISPENSED"),children:"Dispensed"}),a.jsx(Xe,{variant:s==="CANCELLED"?"default":"outline",className:"cursor-pointer",onClick:()=>r("CANCELLED"),children:"Cancelled"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[a.jsxs("span",{className:"text-[11px] text-slate-500 flex items-center gap-1",children:[a.jsx(s7,{className:"h-3 w-3"}),"Location"]}),a.jsxs("select",{className:"h-8 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:i,onChange:K=>l(K.target.value),children:[a.jsx("option",{value:"all",children:"All locations"}),x.map(K=>a.jsx("option",{value:K.id,children:K.name},K.id))]})]})]})]})}),a.jsxs(ze,{className:"pt-0",children:[a.jsx("div",{className:"border-t border-slate-100 mt-2 mb-2"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(0,1.3fr)_minmax(0,2fr)] gap-3 lg:gap-4",children:[a.jsxs("div",{className:"border border-slate-100 rounded-2xl bg-slate-50/60 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 flex items-center justify-between",children:[a.jsxs("span",{className:"text-[11px] font-semibold text-slate-700 flex items-center gap-1",children:[a.jsx(Ur,{className:"h-3.5 w-3.5 text-slate-500"}),"Prescriptions"]}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[P.length," in view"]})]}),S&&a.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:a.jsx(nn,{className:"h-5 w-5 animate-spin text-slate-400"})}),!S&&P.length===0&&a.jsx("div",{className:"flex-1 flex items-center justify-center py-10",children:a.jsx("p",{className:"text-xs text-slate-500",children:"No prescriptions found for this filter."})}),!S&&P.length>0&&a.jsx("div",{className:"flex-1 overflow-y-auto max-h-[520px]",children:P.map(K=>{var G;const z=u6e(K.status),H=K.id===A,Y=K.status==="ISSUED"||K.status==="PARTIALLY_DISPENSED";return a.jsxs("button",{type:"button",onClick:()=>k(K.id),className:["w-full text-left px-3 py-2.5 border-b border-slate-100","flex flex-col gap-1.5 hover:bg-slate-100/70",H?"bg-slate-100/80":""].filter(Boolean).join(" "),children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("span",{className:"text-[11px] font-semibold text-slate-900",children:K.prescription_number||`Rx #${K.id}`}),a.jsx(Xe,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:K.type||""}),Y&&a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"})]}),a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(Ys,{className:"h-3 w-3"}),a.jsx("span",{children:G2(K.created_at)})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1",children:[a.jsxs("div",{className:["inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]",z.className].join(" "),children:[a.jsx(z.icon,{className:"h-3 w-3"}),a.jsx("span",{children:z.label})]}),a.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-1",children:[a.jsx(Ya,{className:"h-3 w-3"}),a.jsx("span",{children:K.location_name||""})]})]})]}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-700",children:[a.jsx(ps,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:K.patient_name||""})]}),K.doctor_name&&a.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[a.jsx(un,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:K.doctor_name})]})]}),a.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-[10px] text-slate-500",children:[a.jsxs("span",{children:[((G=K.lines)==null?void 0:G.length)||0," item(s)"]}),K.status==="DISPENSED"&&a.jsx("span",{children:" Fully dispensed"})]})]},K.id)})})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-3 sm:p-4 flex flex-col min-h-[260px]",children:[!L&&a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx("p",{className:"text-xs text-slate-500",children:"Select a prescription from the left to view details."})}),L&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:["Rx ",L.prescription_number||`#${L.id}`]}),a.jsx(Xe,{variant:"outline",className:"h-5 px-2 text-[10px]",children:L.type||""})]}),a.jsxs("div",{className:"text-[11px] text-slate-600 flex flex-wrap items-center gap-1",children:[a.jsx(ps,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:L.patient_name||""}),a.jsx("span",{className:"mx-1",children:""}),a.jsx(un,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:L.doctor_name||""}),a.jsx("span",{className:"mx-1",children:""}),a.jsx(Ya,{className:"h-3 w-3 text-slate-400"}),a.jsx("span",{children:L.location_name||""})]}),a.jsxs("div",{className:"text-[10px] text-slate-500 flex flex-wrap items-center gap-2",children:[a.jsxs("span",{children:["Created: ",G2(L.created_at)]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Updated: ",G2(L.updated_at)]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[a.jsxs(Pe,{size:"sm",variant:"outline",className:"h-8 text-[11px]",disabled:T===L.id||L.status==="DISPENSED"||L.status==="CANCELLED",onClick:()=>B(L),children:[T===L.id?a.jsx(nn,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):a.jsx(zr,{className:"mr-1 h-3.5 w-3.5"}),"Quick dispense remaining"]}),a.jsxs(Pe,{size:"sm",className:"h-8 text-[11px]",disabled:D===L.id,onClick:()=>V(L),children:[D===L.id?a.jsx(nn,{className:"mr-1 h-3.5 w-3.5 animate-spin"}):a.jsx(h6e,{className:"mr-1 h-3.5 w-3.5"}),"Generate bill"]})]})]}),a.jsx("div",{className:"flex-1 rounded-2xl border border-slate-100 bg-slate-50/60 p-2 sm:p-3 overflow-y-auto max-h-[360px]",children:a.jsxs("table",{className:"w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Req"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Disp"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Rem"}),a.jsx("th",{className:"py-1.5 pl-2 text-left font-medium",children:"Status"})]})}),a.jsxs("tbody",{children:[(L.lines||[]).map(K=>{const z=Number(K.requested_qty||0),H=Number(K.dispensed_qty||0),Y=z-H;return a.jsxs("tr",{className:"border-b border-slate-100",children:[a.jsxs("td",{className:"py-1.5 pr-2 align-top",children:[a.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:K.item_name||""}),a.jsxs("div",{className:"text-[10px] text-slate-500",children:[K.item_strength&&a.jsxs("span",{children:[K.item_strength,"  "]}),K.frequency_code||""," ",K.duration_days?` ${K.duration_days} day(s)`:""]})]}),a.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:z}),a.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:H}),a.jsx("td",{className:"py-1.5 px-2 align-top text-right text-[10px] text-slate-700",children:Y}),a.jsx("td",{className:"py-1.5 pl-2 align-top text-[10px]",children:a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-white px-2 py-0.5 border border-slate-200 text-slate-700",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),K.status]})})]},K.id)}),(!L.lines||L.lines.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"py-4 text-center text-[11px] text-slate-500",children:"No items found in this prescription."})})]})]})}),L.notes&&a.jsxs("div",{className:"mt-2 text-[11px] text-slate-600",children:[a.jsx("span",{className:"font-semibold",children:"Notes:"})," ",L.notes]})]})]})]})]})]})]})}function h6e(t){return a.jsxs("svg",{viewBox:"0 0 24 24",...t,children:[a.jsx("path",{d:"M6 6h15l-1.5 9h-12z",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),a.jsx("circle",{cx:"9",cy:"19",r:"1",fill:"currentColor"}),a.jsx("circle",{cx:"17",cy:"19",r:"1",fill:"currentColor"})]})}const K2=()=>({_id:Math.random().toString(36).slice(2),item:null,requestedQty:"",doseText:"",frequency:"",timing:"",durationDays:"",instructions:"",searchQ:"",searchResults:[],searching:!1,showDropdown:!1});function Y2(t){return t?t.name||t.item_name||t.brand_name||t.code||`#${t.id}`:""}function LR(t){if(!t)return"";const n=[];return t.code&&n.push(t.code),t.generic_name&&n.push(t.generic_name),t.form&&n.push(t.form),t.strength&&n.push(t.strength),t.pack_size&&n.push(`Pack: ${t.pack_size}`),t.manufacturer&&n.push(t.manufacturer),n.join("  ")}function uw({orderType:t,title:n,subtitle:s,variant:r="page",initialPatientId:i=null,initialPatient:l=null,lockPatient:o=!1,initialLocationId:c="",initialDoctorUserId:d="",initialVisitId:u="",initialIpdAdmissionId:h="",initialContextRef:m=""}){const x=y.useMemo(()=>{switch(t){case"OPD":return"OPD";case"IPD":return"IPD Ward";case"COUNTER":return"Counter / OTC";case"OT_CONSUMABLE":return"OT Consumables";default:return t||"Pharmacy"}},[t]),[b,w]=y.useState([]),[j,S]=y.useState(c||""),[C,A]=y.useState(i),[k,T]=y.useState(l),[I,D]=y.useState(d||""),[O,R]=y.useState(u||""),[P,L]=y.useState(h||""),[$,B]=y.useState(m||""),[V,K]=y.useState(""),[z,H]=y.useState([K2()]),[Y,G]=y.useState(!1);y.useEffect(()=>{i&&!C&&A(i)},[i,C]),y.useEffect(()=>{l&&!k&&T(l)},[l,k]),y.useEffect(()=>{let de=!0;return(async()=>{try{const ge=await aw();if(!de)return;const ae=ge.data||[];w(ae),!j&&ae.length===1&&S(String(ae[0].id))}catch{if(!de)return;w([])}})(),()=>{de=!1}},[]);const J=(de,ge)=>{H(ae=>ae.map(Ve=>Ve._id===de?{...Ve,...ge}:Ve))},ee=()=>H(de=>[...de,K2()]),ye=de=>{H(ge=>ge.length===1?ge:ge.filter(ae=>ae._id!==de))},ie=async(de,ge)=>{var ae;if(J(de,{searchQ:ge,item:null}),!ge||ge.length<2){J(de,{searchResults:[],showDropdown:!1});return}J(de,{searching:!0,showDropdown:!0});try{const Ve=await t5({q:ge,page_size:10}),nt=((ae=Ve.data)==null?void 0:ae.items)||Ve.data||[];J(de,{searchResults:nt})}catch{J(de,{searchResults:[]})}finally{J(de,{searching:!1})}},he=(de,ge)=>{J(de,{item:ge,searchQ:"",showDropdown:!1,searchResults:[]})},be=de=>{setTimeout(()=>{J(de,{showDropdown:!1})},150)},we=y.useMemo(()=>{const de=Number(j),ge=b.find(ae=>ae.id===de);return(ge==null?void 0:ge.name)||""},[b,j]),Z=y.useMemo(()=>z.filter(de=>de.item&&de.item.id&&Number(de.requestedQty||0)>0).map(de=>{const ge=Number(de.requestedQty||0),ae=de.durationDays?Number(de.durationDays):null;return{item_id:de.item.id,requested_qty:ge,dose_text:de.doseText||null,frequency_code:de.frequency||null,timing:de.timing||null,duration_days:ae,instructions:de.instructions||null}}),[z]),ce=Z.length>0,Te=async()=>{if(!C){xe.error("Please select a patient");return}if(!j){xe.error("Please select Pharmacy location");return}if(!ce){xe.error("Add at least one item with quantity");return}const de=[];V.trim()&&de.push(V.trim()),t==="COUNTER"&&$.trim()&&de.push(`Counter ref: ${$.trim()}`),t==="OT_CONSUMABLE"&&$.trim()&&de.push(`OT case: ${$.trim()}`);const ge={type:t,patient_id:C,location_id:Number(j),lines:Z};if(I.trim()){const ae=Number(I.trim());Number.isNaN(ae)||(ge.doctor_user_id=ae)}if(de.length>0&&(ge.notes=de.join(" | ")),t==="OPD"&&O.trim()){const ae=Number(O.trim());Number.isNaN(ae)||(ge.visit_id=ae)}if((t==="IPD"||t==="OT_CONSUMABLE")&&P.trim()){const ae=Number(P.trim());Number.isNaN(ae)||(ge.ipd_admission_id=ae)}try{G(!0);const Ve=(await QRe(ge)).data||{},nt=Ve.prescription_number||Ve.id||"created";xe.success(`Pharmacy order created (Rx ${nt})`),H([K2()]),K(""),B(m||""),u||R(""),h||L("")}catch{}finally{G(!1)}},le=a.jsxs(Le,{className:"border-slate-200 rounded-2xl shadow-sm",children:[a.jsx(Je,{className:"pb-3",children:a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xe,{variant:"outline",className:"h-6 px-2 text-[10px] uppercase tracking-wide",children:x}),a.jsx("span",{className:"text-xs text-slate-500",children:"Creates a PharmacyPrescription visible in the Pharmacy Rx Explorer."})]}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[a.jsx(Ya,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{children:"Location:"}),a.jsxs("select",{className:"h-7 rounded-xl border border-slate-200 bg-white px-2 text-[11px] text-slate-700",value:j,onChange:de=>S(de.target.value),children:[a.jsx("option",{value:"",children:"Select"}),b.map(de=>a.jsx("option",{value:de.id,children:de.name},de.id))]})]})]})}),a.jsxs(ze,{className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,1.6fr)_minmax(0,1.4fr)]",children:[a.jsx("div",{children:a.jsx(Le,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:a.jsxs(ze,{className:"p-3 sm:p-4 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ps,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Patient"})]}),!o&&a.jsx(Rb,{value:C,onChange:(de,ge)=>{A(de),T(ge)},label:"Select patient"}),o&&k&&a.jsxs("div",{className:"rounded-xl border bg-white px-3 py-2 text-xs text-slate-700",children:[a.jsxs("div",{className:"font-semibold text-slate-900",children:[k.first_name," ",k.last_name]}),a.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500 flex flex-wrap gap-1",children:[k.uhid&&a.jsxs(Xe,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",k.uhid]}),k.phone&&a.jsxs("span",{children:[" ",k.phone]}),a.jsx("span",{children:" Patient fixed from context"})]})]}),!o&&k&&a.jsxs("div",{className:"rounded-xl border bg-slate-50 px-3 py-2 text-[11px] text-slate-700",children:["Selected:"," ",a.jsxs("span",{className:"font-semibold",children:[k.first_name," ",k.last_name]})," ",k.uhid&&a.jsxs(a.Fragment,{children:[" UHID ",k.uhid]}),k.phone&&a.jsxs(a.Fragment,{children:["  ",k.phone]})]})]})})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Le,{className:"border-slate-200 rounded-2xl bg-slate-50/70",children:a.jsxs(ze,{className:"p-3 sm:p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(un,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Clinical context"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[t==="OPD"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OPD Visit ID (optional)"}),a.jsx(_e,{placeholder:"e.g., 1234",className:"h-8 text-xs",value:O,onChange:de=>R(de.target.value)})]}),(t==="IPD"||t==="OT_CONSUMABLE")&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"IPD Admission ID (optional)"}),a.jsx(_e,{placeholder:"e.g., 5678",className:"h-8 text-xs",value:P,onChange:de=>L(de.target.value)})]}),t==="COUNTER"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Counter ref / token (optional)"}),a.jsx(_e,{placeholder:"e.g., Token #15",className:"h-8 text-xs",value:$,onChange:de=>B(de.target.value)})]}),t==="OT_CONSUMABLE"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"OT case ref (optional)"}),a.jsx(_e,{placeholder:"e.g., OT-2025-001",className:"h-8 text-xs",value:$,onChange:de=>B(de.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Doctor user ID (optional)"}),a.jsx(_e,{placeholder:"e.g., 10",className:"h-8 text-xs",value:I,onChange:de=>D(de.target.value)}),a.jsx("p",{className:"text-[10px] text-slate-500",children:"Later you can auto-fill from logged-in doctor / visit."})]})]})]})}),k&&a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-700 flex flex-wrap items-center gap-2",children:[a.jsxs("span",{className:"font-semibold",children:[k.first_name," ",k.last_name]}),k.uhid&&a.jsxs(Xe,{variant:"outline",className:"h-4 px-1.5 text-[9px]",children:["UHID ",k.uhid]}),k.phone&&a.jsxs("span",{children:[" ",k.phone]})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50/70 p-2 sm:p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:"h-4 w-4 text-slate-500"}),a.jsx("span",{className:"text-xs font-semibold text-slate-800",children:"Order lines (medicines / consumables)"})]}),a.jsxs(Pe,{size:"sm",variant:"outline",className:"h-7 text-[11px]",onClick:ee,children:[a.jsx(Nn,{className:"mr-1 h-3.5 w-3.5"}),"Add line"]})]}),a.jsx("div",{className:"overflow-x-auto -mx-1 sm:mx-0",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200 text-[10px] uppercase tracking-wide text-slate-500",children:[a.jsx("th",{className:"py-1.5 pr-2 text-left font-medium",children:"Item"}),a.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Dose / Frequency"}),a.jsx("th",{className:"py-1.5 px-2 text-left font-medium",children:"Duration"}),a.jsx("th",{className:"py-1.5 px-2 text-right font-medium",children:"Qty"}),a.jsx("th",{className:"py-1.5 pl-2 text-right font-medium w-10"})]})}),a.jsx("tbody",{children:z.map(de=>a.jsxs("tr",{className:"border-b border-slate-100 align-top",children:[a.jsx("td",{className:"py-2 pr-2 min-w-[220px]",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),a.jsx(_e,{className:"pl-6 h-8 text-xs",placeholder:de.item?Y2(de.item):"Search item (name / code / generic)",value:de.item?Y2(de.item):de.searchQ,onChange:ge=>ie(de._id,ge.target.value),onFocus:()=>{var ge;return((ge=de.searchQ)==null?void 0:ge.length)>=2&&J(de._id,{showDropdown:!0})},onBlur:()=>be(de._id)}),de.showDropdown&&(de.searching||de.searchResults.length>0)&&a.jsxs("div",{className:"absolute z-30 mt-1 max-h-60 w-full overflow-auto rounded-xl border border-slate-200 bg-white shadow-lg",children:[de.searching&&a.jsxs("div",{className:"px-3 py-2 text-[11px] text-slate-500 flex items-center gap-2",children:[a.jsx(nn,{className:"h-3.5 w-3.5 animate-spin text-slate-400"}),"Searching"]}),!de.searching&&de.searchResults.length===0&&a.jsx("div",{className:"px-3 py-2 text-[11px] text-slate-500",children:"No items found."}),!de.searching&&de.searchResults.map(ge=>a.jsxs("button",{type:"button",className:"w-full px-3 py-1.5 text-left hover:bg-slate-50",onMouseDown:ae=>ae.preventDefault(),onClick:()=>he(de._id,ge),children:[a.jsx("div",{className:"font-medium text-[11px] text-slate-900",children:Y2(ge)}),a.jsx("div",{className:"text-[10px] text-slate-500",children:LR(ge)})]},ge.id))]})]}),de.item&&a.jsx("div",{className:"rounded-xl bg-white border border-slate-200 px-2 py-1 text-[10px] text-slate-600",children:LR(de.item)||"Selected from inventory"}),a.jsx(mh,{className:"h-14 text-[11px]",placeholder:"Special instructions (optional)",value:de.instructions,onChange:ge=>J(de._id,{instructions:ge.target.value})})]})}),a.jsx("td",{className:"py-2 px-2 min-w-[190px]",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx(_e,{className:"h-8 text-xs",placeholder:"Dose text (e.g., 1-0-1)",value:de.doseText,onChange:ge=>J(de._id,{doseText:ge.target.value})}),a.jsx(_e,{className:"h-8 text-xs",placeholder:"Frequency (e.g., TDS, BD, HS)",value:de.frequency,onChange:ge=>J(de._id,{frequency:ge.target.value})}),a.jsx(_e,{className:"h-8 text-xs",placeholder:"Timing (e.g., after food)",value:de.timing,onChange:ge=>J(de._id,{timing:ge.target.value})})]})}),a.jsxs("td",{className:"py-2 px-2 min-w-[120px]",children:[a.jsx(_e,{className:"h-8 text-xs",type:"number",min:0,placeholder:"Days",value:de.durationDays,onChange:ge=>J(de._id,{durationDays:ge.target.value})}),a.jsx("p",{className:"mt-1 text-[10px] text-slate-500",children:"Later you can auto-calc qty from dose  days."})]}),a.jsx("td",{className:"py-2 px-2 text-right align-top min-w-[80px]",children:a.jsx(_e,{className:"h-8 text-xs text-right",type:"number",min:0,placeholder:"Qty",value:de.requestedQty,onChange:ge=>J(de._id,{requestedQty:ge.target.value})})}),a.jsx("td",{className:"py-2 pl-2 pr-1 align-top text-right",children:a.jsx(Pe,{size:"icon",variant:"ghost",className:"h-7 w-7 text-slate-400 hover:text-red-600",onClick:()=>ye(de._id),children:a.jsx(Wr,{className:"h-4 w-4"})})})]},de._id))})]})}),a.jsxs("div",{className:"mt-1 text-[11px] text-slate-500 flex flex-wrap items-center gap-2",children:[a.jsxs("span",{children:["Valid lines:"," ",a.jsx("span",{className:"font-semibold",children:Z.length})]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["Location:"," ",a.jsx("span",{className:"font-semibold",children:we})]})]})]}),a.jsxs("div",{className:"grid gap-3 sm:grid-cols-[minmax(0,1.7fr)_minmax(0,1fr)] items-start",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Overall notes (optional)"}),a.jsx(mh,{className:"min-h-[60px] text-[11px]",placeholder:"Any clinical notes for Pharmacy",value:V,onChange:de=>K(de.target.value)})]}),a.jsxs("div",{className:"flex flex-col sm:items-end gap-2",children:[a.jsxs("div",{className:"text-[11px] text-slate-500",children:["This will create a"," ",a.jsx("span",{className:"font-semibold",children:"PharmacyPrescription"})," which appears in the Pharmacy Rx Explorer for dispensing & billing."]}),a.jsxs(Pe,{className:"h-9 px-4 text-[11px]",disabled:Y,onClick:Te,children:[Y?a.jsx(nn,{className:"mr-1 h-4 w-4 animate-spin"}):a.jsx(Ur,{className:"mr-1 h-4 w-4"}),"Save ",x," order"]})]})]})]})]});return r==="embedded"?le:a.jsxs("div",{className:"p-3 sm:p-4 lg:p-6 space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("div",{className:"inline-flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-white",children:a.jsx(Ur,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base sm:text-lg font-semibold tracking-tight text-slate-900",children:n}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:s})]})]}),le]})}function m6e(){return a.jsx(uw,{orderType:"IPD",title:"IPD Ward Medication Orders",subtitle:"Raise IPD ward medication orders linked to IPD admission. Orders flow to Pharmacy Rx Explorer with ward context."})}function p6e(){return a.jsx(uw,{orderType:"COUNTER",title:"Pharmacy Counter / OTC Orders",subtitle:"Create counter / OTC orders from Inventory medicines. Ideal for walk-in and quick sales via Rx  dispense  bill."})}function x6e(){return a.jsx(uw,{orderType:"OT_CONSUMABLE",title:"OT Consumables Orders",subtitle:"Order OT consumables (sutures, implants, disposables) against IPD admission / OT case. Orders go to Pharmacy / OT store via Rx queue."})}function g6e(){return a.jsx(uw,{orderType:"OPD",title:"OPD Medication Orders",subtitle:"Prescribe medicines for OPD visits from Inventory items. Orders appear in the Pharmacy Rx queue for dispensing and billing."})}function y6e(){const[t,n]=y.useState(null),[s,r]=y.useState(""),[i,l]=y.useState(""),[o]=y.useState("INR"),[c,d]=y.useState(null),[u,h]=y.useState([]),[m,x]=y.useState(!1),[b,w]=y.useState(!1),[j,S]=y.useState(null),C=y.useCallback(D=>{n(D||null)},[]),A=y.useCallback(async()=>{if(!t){h([]),d(null),r(""),l("");return}try{x(!0);const{data:D}=await Yce({doctor_user_id:t}),O=D||[];h(O);const R=O[0]||null;d(R||null),R?(r(R.base_fee!==null&&R.base_fee!==void 0?String(R.base_fee):""),l(R.followup_fee!==null&&R.followup_fee!==void 0?String(R.followup_fee):"")):(r(""),l(""))}catch(D){console.error(D),xe.error("Failed to load consultation fees")}finally{x(!1)}},[t]);y.useEffect(()=>{A()},[A]);const k=async D=>{var O,R,P;if((O=D==null?void 0:D.preventDefault)==null||O.call(D),!t){xe.error("Select doctor first");return}if(!s||Number(s)<=0){xe.error("Enter a valid base consultation fee");return}try{w(!0);const L={doctor_user_id:t,base_fee:Number(s),currency:o};if(i&&Number(i)>0&&(L.followup_fee=Number(i)),c!=null&&c.id)await LI({...L,id:c.id}),xe.success("Consultation fee updated");else{const{data:$}=await LI(L);xe.success("Consultation fee created"),d($)}A()}catch(L){console.error(L),xe.error(((P=(R=L==null?void 0:L.response)==null?void 0:R.data)==null?void 0:P.detail)||"Failed to save fee")}finally{w(!1)}},T=async D=>{var O,R;if(window.confirm("Delete this consultation fee?"))try{S(D.id),await Zce(D.id),xe.success("Fee deleted"),h(P=>P.filter(L=>L.id!==D.id)),(c==null?void 0:c.id)===D.id&&(d(null),r(""),l(""))}catch(P){console.error(P),xe.error(((R=(O=P==null?void 0:P.response)==null?void 0:O.data)==null?void 0:R.detail)||"Failed to delete fee")}finally{S(null)}},I=!!t;return a.jsx("div",{className:"min-h-[calc(100vh-5rem)] bg-slate-50 px-4 py-6 md:px-6",children:a.jsxs("div",{className:"mx-auto max-w-5xl space-y-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium uppercase tracking-[0.2em] text-emerald-700",children:"Billing Masters"}),a.jsx("h1",{className:"mt-1 text-2xl font-semibold text-slate-900",children:"Doctor Consultation Fees"}),a.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Configure standard consultation and follow-up fees for each doctor. These values can be reused during OPD billing and auto-pricing."})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-4",children:a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Configure Fee"})}),a.jsxs(ze,{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-[2fr,1.2fr,1.2fr] md:items-end",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:"Doctor"}),a.jsx(Hl,{value:t,onChange:C}),!t&&a.jsx("p",{className:"mt-1 text-[11px] text-amber-600",children:"Select a doctor to manage consultation fees."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Base consultation fee (",o,")"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:a.jsx(_l,{className:"h-4 w-4 text-slate-500"})}),a.jsx(_e,{type:"number",min:0,step:"50",value:s,onChange:D=>r(D.target.value),className:"h-9 text-sm"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-xs font-medium uppercase tracking-[0.16em] text-slate-500",children:["Follow-up fee (",o,") (optional)"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-slate-50",children:a.jsx(_l,{className:"h-4 w-4 text-slate-500"})}),a.jsx(_e,{type:"number",min:0,step:"50",value:i,onChange:D=>l(D.target.value),className:"h-9 text-sm"})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Used when visit is marked as a follow-up (if supported by billing rules)."})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(Pe,{type:"button",onClick:k,disabled:!I||b,className:"px-5",children:b?"Saving":c?"Update Fee":"Save Fee"})})]})]}),a.jsxs(Le,{className:"rounded-3xl border-slate-200 shadow-sm",children:[a.jsx(Je,{className:"border-b border-slate-100 pb-3",children:a.jsx(st,{className:"text-sm font-semibold text-slate-900",children:"Existing Fees"})}),a.jsxs(ze,{className:"pt-4",children:[m&&a.jsx("div",{className:"space-y-2",children:[1,2].map(D=>a.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-slate-50 px-3 py-3",children:[a.jsx(Ze,{className:"h-4 w-32"}),a.jsx(Ze,{className:"h-4 w-24"})]},D))}),!m&&(!u||u.length===0)&&a.jsx("p",{className:"py-6 text-sm text-slate-500",children:"No consultation fee configured yet for this doctor."}),!m&&u&&u.length>0&&a.jsx("div",{className:"space-y-2 text-sm",children:u.map(D=>a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold text-slate-900",children:D.doctor_name||"Selected doctor"}),a.jsx(Xe,{variant:"outline",className:"border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px]",children:D.is_active?"Active":"Inactive"})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"Standard OPD consultation pricing used during billing."})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-right text-xs text-slate-600",children:[a.jsxs("div",{className:"font-semibold text-slate-900",children:["Base:",a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(_l,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{children:D.base_fee})]})]}),a.jsxs("div",{children:["Follow-up:",D.followup_fee!=null?a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx(_l,{className:"h-3.5 w-3.5 text-slate-500"}),a.jsx("span",{children:D.followup_fee})]}):a.jsx("span",{className:"text-slate-400",children:"Not set"})]})]}),a.jsx(Pe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:text-rose-600",onClick:()=>T(D),disabled:j===D.id,children:a.jsx(Wr,{className:"h-4 w-4"})})]})]},D.id))})]})]})]})})}function b6e({active_only:t=!0}={}){const n={active_only:t};return ne.get("/lis/masters/departments",{params:n})}function v6e(t){return ne.post("/lis/masters/departments",t)}function w6e(t,n){return ne.put(`/lis/masters/departments/${t}`,n)}function N6e(t){return ne.delete(`/lis/masters/departments/${t}`)}function j6e({department_id:t,search:n,active_only:s=!0}={}){const r={};return t&&(r.department_id=t),n&&(r.search=n),r.active_only=s,ne.get("/lis/masters/services",{params:r})}function S6e(t){return ne.post("/lis/masters/services/bulk",{items:t})}function _6e(t,n){return ne.put(`/lis/masters/services/${t}`,n)}function C6e(t){return ne.delete(`/lis/masters/services/${t}`)}const A6e="#2563eb",X2={name:"",code:"",description:"",parent_id:"",is_active:!0},k6e={name:"",code:"",unit:"",normal_range:"",sample_type:"",method:"",comments_template:"",display_order:""};function E6e(){const{branding:t}=kh()||{},n=(t==null?void 0:t.primary_color)||A6e,s=et("lis.masters.departments.view"),r=et("lis.masters.departments.create"),i=et("lis.masters.departments.update"),l=et("lis.masters.departments.delete"),o=et("lis.masters.services.view"),c=et("lis.masters.services.create"),d=et("lis.masters.services.update"),u=et("lis.masters.services.delete"),[h,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(""),[S,C]=y.useState(null),[A,k]=y.useState(!1),[T,I]=y.useState(null),[D,O]=y.useState(X2),[R,P]=y.useState(!1),[L,$]=y.useState([]),[B,V]=y.useState([]),[K,z]=y.useState(!1),[H,Y]=y.useState(""),[G,J]=y.useState(!1),[ee,ye]=y.useState(null),[ie,he]=y.useState(null),[be,we]=y.useState(null),[Z,ce]=y.useState(!1),Te=y.useMemo(()=>h.filter(re=>!re.parent_id),[h]),le=y.useMemo(()=>{const re={};return h.forEach(Ce=>{Ce.parent_id&&(re[Ce.parent_id]||(re[Ce.parent_id]=[]),re[Ce.parent_id].push(Ce))}),re},[h]),de=y.useMemo(()=>{const re=w.trim().toLowerCase();return re?Te.filter(Ce=>[Ce.name,Ce.code].some(Ue=>(Ue||"").toString().toLowerCase().includes(re))):Te},[w,Te]),ge=y.useMemo(()=>h.find(re=>re.id===S)||null,[h,S]),ae=y.useMemo(()=>{const re=H.trim().toLowerCase();return L.filter(Ce=>!G&&!Ce.is_active?!1:re?[Ce.name,Ce.code,Ce.sample_type,Ce.method].some(Ue=>(Ue||"").toString().toLowerCase().includes(re)):!0)},[L,H,G]);y.useEffect(()=>{s&&Ve()},[s]),y.useEffect(()=>{if(!ge||!o){$([]),V([]);return}nt(ge.id)},[S,o]);async function Ve(){var re;try{b(!0);const Ce=await b6e({active_only:!0});m(Ce.data||[]),!S&&((re=Ce.data)!=null&&re.length)&&C(Ce.data[0].id)}catch(Ce){console.error("Failed to load lab departments",Ce),xe.error("Failed to load lab departments")}finally{b(!1)}}async function nt(re){try{z(!0);const Ce=await j6e({department_id:re,active_only:!G});$(Ce.data||[]),V([]),ye(null),he(null)}catch(Ce){console.error("Failed to load lab services",Ce),xe.error("Failed to load lab services")}finally{z(!1)}}function wt(re=null){I(null),O({...X2,parent_id:re||""}),k(!0)}function jt(re){I(re),O({name:re.name||"",code:re.code||"",description:re.description||"",parent_id:re.parent_id||"",is_active:re.is_active,display_order:re.display_order||""}),k(!0)}function ct(re){const{name:Ce,value:Ue,type:Qe,checked:ht}=re.target;O($e=>({...$e,[Ce]:Qe==="checkbox"?ht:Ue}))}async function Me(re){var Ue,Qe;if(re==null||re.preventDefault(),!D.name.trim()){xe.error("Department name is required");return}const Ce={name:D.name.trim(),code:((Ue=D.code)==null?void 0:Ue.trim())||null,description:((Qe=D.description)==null?void 0:Qe.trim())||null,parent_id:D.parent_id||null,is_active:D.is_active,display_order:D.display_order?Number(D.display_order):null};try{P(!0),T?(await w6e(T.id,Ce),xe.success("Department updated")):(await v6e(Ce),xe.success("Department created")),k(!1),I(null),O(X2),await Ve()}catch(ht){console.error("Failed to save department",ht),xe.error("Failed to save department")}finally{P(!1)}}async function qe(re){if(window.confirm(`Delete department "${re.name}"?`))try{await N6e(re.id),xe.success("Department deleted"),re.id===S&&C(null),await Ve()}catch(Ce){console.error("Failed to delete department",Ce),xe.error("Failed to delete department")}}function oe(){if(!ge){xe.error("Select a department first");return}V(re=>[...re,{...k6e}])}function ue(re,Ce,Ue){V(Qe=>{const ht=[...Qe];return ht[re]={...ht[re],[Ce]:Ue},ht})}async function De(){if(!ge)return;const re=B.map(Ce=>{var Ue,Qe,ht,$e,Xt,Ut;return{...Ce,name:(Ce.name||"").trim(),department_id:ge.id,code:((Ue=Ce.code)==null?void 0:Ue.trim())||null,unit:((Qe=Ce.unit)==null?void 0:Qe.trim())||"",normal_range:((ht=Ce.normal_range)==null?void 0:ht.trim())||"",sample_type:(($e=Ce.sample_type)==null?void 0:$e.trim())||null,method:((Xt=Ce.method)==null?void 0:Xt.trim())||null,comments_template:((Ut=Ce.comments_template)==null?void 0:Ut.trim())||null,display_order:Ce.display_order?Number(Ce.display_order):null}}).filter(Ce=>Ce.name);if(!re.length){xe.error("Add at least one service row with a name");return}try{ce(!0),await S6e(re),xe.success("Services saved"),await nt(ge.id)}catch(Ce){console.error("Failed to bulk-create services",Ce),xe.error("Failed to save services")}finally{ce(!1)}}function St(re){ye(re.id),he({...re,display_order:re.display_order??""})}function tn(){ye(null),he(null)}function Lt(re,Ce){he(Ue=>({...Ue,[re]:Ce}))}async function Dt(){var Ce,Ue,Qe,ht,$e,Xt,Ut;if(!ee||!ie)return;const re={name:((Ce=ie.name)==null?void 0:Ce.trim())||"",code:((Ue=ie.code)==null?void 0:Ue.trim())||null,unit:((Qe=ie.unit)==null?void 0:Qe.trim())||"",normal_range:((ht=ie.normal_range)==null?void 0:ht.trim())||"",sample_type:(($e=ie.sample_type)==null?void 0:$e.trim())||null,method:((Xt=ie.method)==null?void 0:Xt.trim())||null,comments_template:((Ut=ie.comments_template)==null?void 0:Ut.trim())||null,is_active:!!ie.is_active,display_order:ie.display_order?Number(ie.display_order):null};if(!re.name){xe.error("Service name is required");return}try{we(ee),await _6e(ee,re),xe.success("Service updated"),await nt(ge.id),tn()}catch(en){console.error("Failed to update service",en),xe.error("Failed to update service")}finally{we(null)}}async function Un(re){if(window.confirm(`Delete service "${re.name}"?`))try{await C6e(re.id),xe.success("Service deleted"),await nt(ge.id)}catch(Ce){console.error("Failed to delete service",Ce),xe.error("Failed to delete service")}}function yn(re){const Ce=le[re.id]||[],Ue=re.id===S;return a.jsxs("div",{className:"mb-1",children:[a.jsxs("div",{className:`group flex items-center justify-between rounded-xl px-3 py-2 text-sm cursor-pointer border transition-all ${Ue?"border-transparent":"border-transparent hover:border-slate-200"}`,style:{backgroundColor:Ue?`${n}12`:"transparent"},onClick:()=>C(re.id),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nh,{className:`h-3 w-3 text-slate-400 transition-transform ${Ce.length?"group-hover:translate-x-0.5":"opacity-0"}`}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-slate-800 flex items-center gap-1",children:[re.name,!re.is_active&&a.jsx("span",{className:"rounded-full bg-amber-50 px-2 py-0.5 text-[10px] font-semibold text-amber-700",children:"Inactive"})]}),re.code&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["Code: ",re.code]})]})]}),(i||l)&&a.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[i&&a.jsx("button",{type:"button",onClick:Qe=>{Qe.stopPropagation(),jt(re)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-slate-200 bg-white text-xs text-slate-600 hover:bg-slate-50",title:"Edit department",children:a.jsx(Xa,{className:"h-3 w-3"})}),l&&a.jsx("button",{type:"button",onClick:Qe=>{Qe.stopPropagation(),qe(re)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full border border-rose-100 bg-white text-xs text-rose-600 hover:bg-rose-50",title:"Delete department",children:a.jsx(Wr,{className:"h-3 w-3"})})]})]}),Ce.length>0&&a.jsx("div",{className:"ml-4 border-l border-dashed border-slate-200 pl-3",children:Ce.map(Qe=>yn(Qe))})]},re.id)}return!s&&!o?a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800",children:"You do not have permission to view LIS Masters."}):a.jsxs("div",{className:"flex h-full flex-col gap-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl",style:{backgroundColor:`${n}10`},children:a.jsx(Lc,{className:"h-5 w-5",style:{color:n}})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Laboratory Report Masters"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Configure LIS departments, sub-departments and test master services for NABH-compliant lab reports."})]})]}),a.jsx("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:a.jsxs("div",{className:"hidden items-center gap-1 rounded-full bg-slate-50 px-3 py-1 md:flex",children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-emerald-500"}),"Auto-sets ",a.jsx("span",{className:"font-semibold",children:"Unit"})," &",a.jsx("span",{className:"font-semibold",children:"Normal Range"})," to - when empty"]})})]}),a.jsxs("div",{className:"grid flex-1 gap-4 xl:grid-cols-[320px,1fr] lg:grid-cols-[280px,1fr]",children:[a.jsxs("div",{className:"flex flex-col rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",children:[a.jsxs("div",{className:"mb-3 flex items-center justify-between gap-2",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:"Departments & Sub-departments"}),r&&a.jsxs("button",{type:"button",onClick:()=>wt(null),className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-2.5 py-1 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800",children:[a.jsx(Nn,{className:"h-3 w-3"}),"Add"]})]}),a.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(jn,{className:"pointer-events-none absolute left-2.5 top-2.5 h-3.5 w-3.5 text-slate-400"}),a.jsx("input",{type:"text",className:"h-8 w-full rounded-full border border-slate-200 bg-slate-50 pl-8 pr-3 text-xs text-slate-700 placeholder:text-slate-400 focus:border-slate-300 focus:bg-white focus:outline-none focus:ring-2 focus:ring-slate-100",placeholder:"Search departments...",value:w,onChange:re=>j(re.target.value)})]}),a.jsx("button",{type:"button",onClick:Ve,className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-500 hover:bg-slate-50",title:"Refresh",children:a.jsx(dN,{className:"h-3.5 w-3.5"})})]}),a.jsx("div",{className:"scrollbar-thin flex-1 overflow-y-auto rounded-2xl bg-slate-50/60 p-2",children:x?a.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Loading departments"}):de.length?de.map(re=>yn(re)):a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 py-8 text-center text-xs text-slate-500",children:[a.jsx(Lc,{className:"h-4 w-4 text-slate-300"}),a.jsx("p",{children:"No departments yet."}),r&&a.jsxs("button",{type:"button",onClick:()=>wt(null),className:"mt-2 inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-slate-800",children:[a.jsx(Nn,{className:"h-3 w-3"}),"Add first department"]})]})}),ge&&r&&a.jsxs("button",{type:"button",onClick:()=>wt(ge.id),className:"mt-3 inline-flex w-full items-center justify-center gap-1 rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-1.5 text-[11px] font-medium text-slate-700 hover:bg-white",children:[a.jsx(Nn,{className:"h-3 w-3"}),"Add sub-department under ",a.jsx("span",{className:"font-semibold",children:ge.name})]})]}),a.jsxs("div",{className:"flex flex-col rounded-2xl border border-slate-100 bg-white p-3 shadow-sm",children:[a.jsxs("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-800",children:ge?`Services for ${ge.name}`:"Select a department"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"Add department-wise test master with units, normal ranges and method details."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Ai,{className:"pointer-events-none absolute left-2.5 top-2 h-3 w-3 text-slate-400"}),a.jsx("input",{type:"text",className:"h-8 w-40 rounded-full border border-slate-200 bg-slate-50 pl-7 pr-3 text-xs text-slate-700 placeholder:text-slate-400 focus:border-slate-300 focus:bg-white focus:outline-none focus:ring-2 focus:ring-slate-100",placeholder:"Filter services",value:H,onChange:re=>Y(re.target.value),disabled:!ge||!o})]}),a.jsxs("button",{type:"button",className:`inline-flex items-center gap-1 rounded-full border px-3 py-1.5 text-[11px] font-medium ${G?"border-slate-800 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-600"}`,onClick:()=>J(re=>!re),disabled:!ge||!o,children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-amber-400"}),"Inactive"]}),c&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",onClick:oe,disabled:!ge,className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white shadow-sm hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400",children:[a.jsx(Nn,{className:"h-3 w-3"}),"Add Row"]}),a.jsxs("button",{type:"button",onClick:De,disabled:!ge||!B.length||Z,className:"inline-flex items-center gap-1 rounded-full border border-emerald-600 bg-emerald-600 px-3 py-1.5 text-[11px] font-medium text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:border-emerald-400 disabled:bg-emerald-400",children:[Z?a.jsx(dN,{className:"h-3 w-3 animate-spin"}):a.jsx(c4,{className:"h-3 w-3"}),"Save All"]})]})]})]}),a.jsx("div",{className:"scrollbar-thin flex-1 overflow-auto rounded-2xl border border-slate-100",children:ge?K?a.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Loading services"}):a.jsxs("table",{className:"min-w-full border-separate border-spacing-0 text-xs",children:[a.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"#"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Service Name"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Code"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Unit"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Normal Range"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Sample Type"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Method"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Comments Template"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-left font-medium text-slate-600",children:"Active"}),a.jsx("th",{className:"border-b border-slate-200 px-3 py-2 text-right font-medium text-slate-600",children:"Actions"})]})}),a.jsxs("tbody",{children:[ae.map((re,Ce)=>{const Ue=ee===re.id,Qe=Ue?ie:re;return a.jsxs("tr",{className:Ce%2?"bg-slate-50/40":"bg-white",children:[a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-[11px] text-slate-500",children:Ce+1}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Qe==null?void 0:Qe.name)||"",onChange:ht=>Lt("name",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Qe==null?void 0:Qe.code)||"",onChange:ht=>Lt("code",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",placeholder:"-",value:(Qe==null?void 0:Qe.unit)||"",onChange:ht=>Lt("unit",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",placeholder:"-",value:(Qe==null?void 0:Qe.normal_range)||"",onChange:ht=>Lt("normal_range",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Qe==null?void 0:Qe.sample_type)||"",onChange:ht=>Lt("sample_type",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Qe==null?void 0:Qe.method)||"",onChange:ht=>Lt("method",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("textarea",{rows:1,className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-1 focus:ring-slate-200 disabled:bg-slate-50",value:(Qe==null?void 0:Qe.comments_template)||"",onChange:ht=>Lt("comments_template",ht.target.value),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-slate-200",checked:!!(Qe!=null&&Qe.is_active),onChange:ht=>Lt("is_active",ht.target.checked),disabled:!d||!Ue})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-right",children:a.jsxs("div",{className:"flex justify-end gap-1",children:[d&&a.jsx(a.Fragment,{children:Ue?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:Dt,disabled:be===re.id,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-600 text-white hover:bg-emerald-700 disabled:cursor-not-allowed disabled:bg-emerald-400",title:"Save",children:a.jsx(c4,{className:"h-3 w-3"})}),a.jsx("button",{type:"button",onClick:tn,className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200",title:"Cancel",children:a.jsx(Os,{className:"h-3 w-3"})})]}):a.jsx("button",{type:"button",onClick:()=>St(re),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-600 hover:bg-slate-200",title:"Edit",children:a.jsx(Xa,{className:"h-3 w-3"})})}),u&&a.jsx("button",{type:"button",onClick:()=>Un(re),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-rose-50 text-rose-600 hover:bg-rose-100",title:"Delete",children:a.jsx(Wr,{className:"h-3 w-3"})})]})})]},re.id)}),B.map((re,Ce)=>a.jsxs("tr",{className:"bg-emerald-50/40 text-[11px]",children:[a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-[11px] text-slate-500",children:ae.length+Ce+1}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Service name*",value:re.name,onChange:Ue=>ue(Ce,"name",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Code",value:re.code,onChange:Ue=>ue(Ce,"code",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"-",value:re.unit,onChange:Ue=>ue(Ce,"unit",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"-",value:re.normal_range,onChange:Ue=>ue(Ce,"normal_range",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Serum / Plasma...",value:re.sample_type,onChange:Ue=>ue(Ce,"sample_type",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Method",value:re.method,onChange:Ue=>ue(Ce,"method",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5",children:a.jsx("textarea",{rows:1,className:"w-full rounded-md border border-emerald-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-emerald-300 focus:outline-none focus:ring-1 focus:ring-emerald-200",placeholder:"Default comments",value:re.comments_template,onChange:Ue=>ue(Ce,"comments_template",Ue.target.value)})}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-center text-[11px] text-slate-500",children:"Yes"}),a.jsx("td",{className:"border-b border-slate-100 px-3 py-1.5 text-right",children:a.jsx("button",{type:"button",onClick:()=>V(Ue=>Ue.filter((Qe,ht)=>ht!==Ce)),className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-50 text-emerald-700 hover:bg-emerald-100",title:"Remove row",children:a.jsx(Os,{className:"h-3 w-3"})})})]},`draft-${Ce}`)),!ae.length&&!B.length&&a.jsx("tr",{children:a.jsxs("td",{colSpan:10,className:"px-3 py-5 text-center text-[11px] text-slate-500",children:["No services found for this department.",c&&a.jsxs(a.Fragment,{children:[" ","Click"," ",a.jsx("span",{className:"font-semibold",children:"Add Row"})," to start adding tests."]})]})})]})]}):a.jsx("div",{className:"flex h-full items-center justify-center text-xs text-slate-500",children:"Select a department on the left to view / add services."})})]})]}),A&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 p-4",children:a.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl",children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 px-4 py-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:T?"Edit Department":"Add Department"}),a.jsx("p",{className:"text-[11px] text-slate-500",children:D.parent_id?"This will be created as a sub-department.":"Top level department."})]}),a.jsx("button",{type:"button",onClick:()=>{k(!1),I(null)},className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200",children:a.jsx(Os,{className:"h-3 w-3"})})]}),a.jsxs("form",{onSubmit:Me,className:"space-y-3 px-4 py-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-[11px] font-medium text-slate-700",children:["Department name ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{name:"name",type:"text",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:D.name,onChange:ct,required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Code"}),a.jsx("input",{name:"code",type:"text",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:D.code,onChange:ct})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Display Order"}),a.jsx("input",{name:"display_order",type:"number",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:D.display_order||"",onChange:ct})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Parent Department (for sub-department)"}),a.jsxs("select",{name:"parent_id",className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:D.parent_id||"",onChange:ct,children:[a.jsx("option",{value:"",children:"None (Top level)"}),Te.map(re=>a.jsx("option",{value:re.id,children:re.name},re.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Description"}),a.jsx("textarea",{name:"description",rows:2,className:"w-full rounded-lg border border-slate-200 px-2.5 py-1.5 text-xs text-slate-800 focus:border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-100",value:D.description,onChange:ct})]}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsxs("label",{className:"flex items-center gap-2 text-[11px] text-slate-700",children:[a.jsx("input",{type:"checkbox",name:"is_active",className:"h-3.5 w-3.5 rounded border-slate-300 text-slate-900 focus:ring-slate-200",checked:D.is_active,onChange:ct}),"Active department"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>{k(!1),I(null)},className:"inline-flex items-center rounded-full border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:R,className:"inline-flex items-center gap-1 rounded-full bg-slate-900 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400",children:[R&&a.jsx(dN,{className:"h-3 w-3 animate-spin"}),T?"Update":"Save"]})]})]})]})]})})]})}const BR=t=>t?new Date(t).toLocaleString():"",FR=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function T6e(){const{id:t}=Tu(),n=Aa(),[s,r]=y.useState(!1),[i,l]=y.useState(null);y.useEffect(()=>{(async()=>{var h,m;r(!0);try{const{data:x}=await vde(t);l(x)}catch(x){console.error(x),xe.error(((m=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to load report")}finally{r(!1)}})()},[t]);const o=y.useMemo(()=>{if(!(i!=null&&i.sections))return[];const u=[];return i.sections.forEach(h=>{h.rows.forEach(m=>{u.push({department_name:h.department_name||"",sub_department_name:h.sub_department_name||"",...m})})}),u},[i]),c=async()=>{var u,h,m;try{const x=await ne.get(`/lab/orders/${t}/report-pdf`,{responseType:"blob"}),b=new Blob([x.data],{type:"application/pdf"}),w=URL.createObjectURL(b);window.open(w,"_blank")}catch(x){console.error("PDF download error",x);const b=(u=x==null?void 0:x.response)==null?void 0:u.status;b===401?xe.error("Session expired. Please login again."):b===403?xe.error("You do not have permission to view this report."):xe.error(((m=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:m.detail)||"Failed to download PDF")}};if(s&&!i)return a.jsx("div",{className:"p-6",children:"Loading report"});if(!i)return a.jsx("div",{className:"p-6",children:"Report not found"});const d=i.lab_no?FR(i.lab_no):FR(i.order_id);return a.jsxs("div",{className:"min-h-screen text-black print:bg-white bg-slate-50",children:[a.jsxs("div",{className:"border-b bg-white px-3 md:px-4 py-2 flex items-center justify-between print:hidden",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{className:"btn-ghost flex items-center gap-1 text-xs md:text-sm",onClick:()=>n(-1),children:[a.jsx(Cb,{className:"h-4 w-4"}),"Back"]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-2 text-xs md:text-sm font-medium",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Rc,{className:"h-4 w-4 text-slate-600"}),a.jsx("span",{children:"Lab Report"})]}),a.jsxs("span",{className:"text-[11px] text-gray-500",children:[i.patient_name,"  ",d]})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("button",{className:"btn flex items-center gap-2 text-xs md:text-sm",onClick:c,children:[a.jsx(Rc,{className:"h-4 w-4"}),"Download"]})})]}),a.jsxs("div",{className:"max-w-4xl mx-auto bg-white shadow-sm print:shadow-none my-3 md:my-4 print:my-0 px-3 md:px-6 py-4 md:py-6 print:p-4",children:[a.jsx("header",{className:"border-b pb-3 md:pb-4 mb-3 md:mb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[a.jsx("div",{children:a.jsx("h1",{className:"text-lg md:text-xl font-semibold tracking-wide",children:"LABORATORY REPORT"})}),a.jsxs("div",{className:"text-right text-[11px] md:text-xs",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Lab No:"})," ",d]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Patient:"})," ",i.patient_name||""]})]})]})}),a.jsx("section",{className:"mb-3 md:mb-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-[11px] md:text-xs",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Patient Name: "}),a.jsx("span",{children:i.patient_name||""})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"UHID: "}),a.jsx("span",{children:i.patient_uhid||""})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Gender: "}),a.jsx("span",{children:i.patient_gender||""})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Age: "}),a.jsx("span",{children:i.patient_age_text||""})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Patient Type: "}),a.jsx("span",{children:i.patient_type||""})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Received On: "}),a.jsx("span",{children:BR(i.received_on)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Reported On: "}),a.jsx("span",{children:BR(i.reported_on)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Referred By: "}),a.jsx("span",{children:i.referred_by||""})]})]})]})}),a.jsx("section",{className:"space-y-4",children:i.sections&&i.sections.length>0?i.sections.map((u,h)=>a.jsxs("div",{children:[a.jsx("div",{className:"bg-slate-100 border px-3 py-2 mb-1",children:a.jsxs("div",{className:"text-[11px] font-semibold text-slate-700",children:[u.department_name||"Department",u.sub_department_name?` / ${u.sub_department_name}`:""]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-[11px] border",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border px-2 py-1 text-left",children:"Test"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Result"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Unit"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Normal Range"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Flag"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Comments"})]})}),a.jsx("tbody",{children:u.rows.map((m,x)=>a.jsxs("tr",{children:[a.jsx("td",{className:"border px-2 py-1",children:m.service_name||""}),a.jsxs("td",{className:"border px-2 py-1",children:[m.result_value||"",m.flag?` (${m.flag})`:""]}),a.jsx("td",{className:"border px-2 py-1",children:m.unit||""}),a.jsx("td",{className:"border px-2 py-1",children:m.normal_range||""}),a.jsx("td",{className:"border px-2 py-1",children:m.flag||""}),a.jsx("td",{className:"border px-2 py-1",children:m.comments||""})]},x))})]})})]},`${u.department_id}-${u.sub_department_id}-${h}`)):a.jsx("div",{className:"text-xs text-gray-500",children:"No results available for this order."})}),a.jsxs("section",{className:"mt-5 md:mt-6",children:[a.jsx("h3",{className:"text-xs md:text-sm font-semibold mb-1",children:"Latest Results Summary"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-[11px] border",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border px-2 py-1 text-left",children:"Department"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Sub-Department"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Test"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Result"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Unit"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Normal Range"}),a.jsx("th",{className:"border px-2 py-1 text-left",children:"Flag"})]})}),a.jsx("tbody",{children:o.length>0?o.map((u,h)=>a.jsxs("tr",{children:[a.jsx("td",{className:"border px-2 py-1",children:u.department_name||""}),a.jsx("td",{className:"border px-2 py-1",children:u.sub_department_name||""}),a.jsx("td",{className:"border px-2 py-1",children:u.service_name||""}),a.jsx("td",{className:"border px-2 py-1",children:u.result_value||""}),a.jsx("td",{className:"border px-2 py-1",children:u.unit||""}),a.jsx("td",{className:"border px-2 py-1",children:u.normal_range||""}),a.jsx("td",{className:"border px-2 py-1",children:u.flag||""})]},h)):a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"border px-2 py-2 text-center text-gray-400",children:"No results to summarise."})})})]})})]}),a.jsxs("section",{className:"mt-6 md:mt-8 grid grid-cols-2 gap-6 text-[11px]",children:[a.jsx("div",{children:a.jsx("div",{className:"border-t pt-4 text-center",children:"Technician / Lab In-charge"})}),a.jsx("div",{children:a.jsx("div",{className:"border-t pt-4 text-center",children:"Pathologist / Authorized Signatory"})})]})]})]})}function I6e({value:t=[],onChange:n}){const[s,r]=y.useState(""),[i,l]=y.useState(!1),[o,c]=y.useState([]);y.useEffect(()=>{let m=!0;return l(!0),a9({q:s,active:!0,page_size:50}).then(x=>{m&&c(x.data||[])}).finally(()=>m&&l(!1)),()=>{m=!1}},[s]);const d=y.useMemo(()=>new Set(t||[]),[t]),u=y.useMemo(()=>o.filter(m=>d.has(m.id)),[o,d]),h=m=>{const x=new Set(d);x.has(m)?x.delete(m):x.add(m),n==null||n([...x])};return a.jsxs("div",{className:"space-y-2 text-black",children:[a.jsx("label",{className:"text-sm font-medium",children:"Select Tests"}),a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9",placeholder:"Search by code/name",value:s,onChange:m=>r(m.target.value)})]}),a.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:(o||[]).slice(0,10).map(m=>{const x=d.has(m.id);return a.jsxs("button",{type:"button",onClick:()=>h(m.id),className:["rounded-xl border p-3 text-left transition",x?"border-blue-500 bg-blue-50":"hover:bg-gray-50"].join(" "),children:[a.jsxs("div",{className:"font-medium",children:[m.code,"  ",m.name]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["",Number(m.price||0).toFixed(2)]})]},m.id)})}),u.length>0&&a.jsxs("div",{className:"rounded-xl border p-3",children:[a.jsx("div",{className:"text-xs font-medium mb-2",children:"Selected"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(m=>a.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs",children:[m.code,a.jsx("button",{onClick:()=>h(m.id),className:"ml-1 rounded-full p-0.5 hover:bg-blue-100",children:a.jsx(Os,{className:"h-3 w-3"})})]},m.id))})]}),i&&a.jsx("div",{className:"text-xs text-gray-500",children:"Loading"})]})}const $R=t=>t?new Date(t).toLocaleString():"",Q2=t=>t?`LAB-${String(t).padStart(6,"0")}`:"";function P6e(){const[t,n]=y.useState(""),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(!1),[d,u]=y.useState(null),[h,m]=y.useState([]),[x,b]=y.useState("routine"),[w,j]=y.useState("all"),[S,C]=y.useState("all"),[A,k]=y.useState(""),[T,I]=y.useState(""),D=Aa(),O=async()=>{l(!0);try{const{data:$}=await mde({page_size:200});r(Array.isArray($)?$:($==null?void 0:$.items)||[])}catch($){console.error($),xe.error("Failed to load orders")}finally{l(!1)}};y.useEffect(()=>{O()},[]);const R=async()=>{var $,B;if(!d||h.length===0){xe.error("Select patient and at least one test");return}try{const{data:V}=await hde({patient_id:d,priority:x,test_ids:h});xe.success("Order created"),c(!1),u(null),m([]),b("routine");const K=(V==null?void 0:V.id)||(V==null?void 0:V.order_id);K?D(`/lab/orders/${K}`):O()}catch(V){console.error(V),xe.error(((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||"Create failed")}},P=y.useMemo(()=>s.filter($=>{var V,K,z,H;const B=(t||"").trim().toLowerCase();if(B){const Y=((V=$.patient)==null?void 0:V.full_name)||((K=$.patient)==null?void 0:K.first_name)||""+((z=$.patient)==null?void 0:z.last_name)||"",G=((H=$.patient)==null?void 0:H.uhid)||"",J=Q2($.id);if(!`${Y} ${G} ${J}`.toLowerCase().includes(B))return!1}if(w!=="all"&&($.status||"").toLowerCase()!==w||S!=="all"&&($.priority||"").toLowerCase()!==S)return!1;if(A||T){const Y=$.created_at||$.createdAt;if(!Y)return!1;const G=new Date(Y).setHours(0,0,0,0);if(A){const J=new Date(A).setHours(0,0,0,0);if(G<J)return!1}if(T){const J=new Date(T).setHours(0,0,0,0);if(G>J)return!1}}return!0}),[s,t,w,S,A,T]),L=P.length;return a.jsxs("div",{className:"p-3 md:p-6 text-black space-y-4",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Lc,{className:"h-5 w-5 text-sky-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Lab Orders"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Create, track, and finalize LIS orders (NABH aligned)"})]})]}),a.jsx(ta,{anyOf:["lab.orders.create","orders.lab.create"],children:a.jsxs("button",{className:"btn-primary flex items-center gap-1 text-sm",onClick:()=>c(!0),children:[a.jsx(Nn,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"New Lab Order"}),a.jsx("span",{className:"sm:hidden",children:"New"})]})})]}),a.jsxs("section",{className:"rounded-xl border bg-white p-3 md:p-4 space-y-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[a.jsxs("div",{className:"relative flex-1 max-w-xl",children:[a.jsx(jn,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),a.jsx("input",{className:"input pl-9 text-sm",placeholder:"Search by UHID, patient name, or Lab No (e.g., LAB-000123)",value:t,onChange:$=>n($.target.value)})]}),a.jsxs("button",{type:"button",onClick:O,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[a.jsx(Ai,{className:"h-4 w-4"}),"Refresh"]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 md:gap-3 text-xs",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"Status"}),a.jsxs("select",{className:"input h-8 text-xs",value:w,onChange:$=>j($.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"ordered",children:"Ordered"}),a.jsx("option",{value:"collected",children:"Collected"}),a.jsx("option",{value:"in_progress",children:"In Progress"}),a.jsx("option",{value:"validated",children:"Validated"}),a.jsx("option",{value:"reported",children:"Reported"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"Priority"}),a.jsxs("select",{className:"input h-8 text-xs",value:S,onChange:$=>C($.target.value),children:[a.jsx("option",{value:"all",children:"All"}),a.jsx("option",{value:"routine",children:"Routine"}),a.jsx("option",{value:"urgent",children:"Urgent"}),a.jsx("option",{value:"stat",children:"STAT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"From Date"}),a.jsx("input",{type:"date",className:"input h-8 text-xs",value:A,onChange:$=>k($.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-[11px] text-gray-500 mb-1",children:"To Date"}),a.jsx("input",{type:"date",className:"input h-8 text-xs",value:T,onChange:$=>I($.target.value)})]}),a.jsx("div",{className:"flex items-end",children:a.jsx("button",{type:"button",className:"text-[11px] text-gray-500 underline",onClick:()=>{j("all"),C("all"),k(""),I("")},children:"Clear filters"})})]})]}),a.jsxs("section",{className:"rounded-xl border bg-white p-2 md:p-0",children:[a.jsxs("div",{className:"space-y-2 md:hidden",children:[i&&a.jsx("div",{className:"px-3 py-4 text-xs text-gray-500",children:"Loading"}),!i&&P.length===0&&a.jsx("div",{className:"px-3 py-6 text-xs text-gray-500 text-center",children:"No lab orders found."}),!i&&P.map($=>a.jsxs("div",{className:"border rounded-xl p-3 flex flex-col gap-2 bg-slate-50/60",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-800",children:Q2($.id)}),a.jsx(B1,{status:$.status})]}),a.jsx("div",{className:"text-xs",children:a.jsx(Op,{patient:$.patient,patientId:$.patient_id})}),a.jsxs("div",{className:"flex justify-between text-[11px] text-gray-600",children:[a.jsxs("div",{children:[a.jsxs("div",{children:["Priority:"," ",a.jsx("span",{className:"font-medium capitalize",children:$.priority||"routine"})]}),a.jsxs("div",{children:["Created:"," ",a.jsx("span",{children:$R($.created_at||$.createdAt)})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("button",{className:"btn-ghost text-xs px-2 py-1",onClick:()=>D(`/lab/orders/${$.id}`),children:"Open"})})]})]},$.id))]}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Lab No"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Patient"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Priority"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs",children:"Created"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-3 text-sm text-gray-500",colSpan:6,children:"Loading"})}),!i&&P.map($=>a.jsxs("tr",{className:"border-t hover:bg-slate-50/80",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx(J3,{order:{...$,display_no:Q2($.id)},to:`/lab/orders/${$.id}`})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(Op,{patient:$.patient,patientId:$.patient_id})}),a.jsx("td",{className:"px-3 py-2 capitalize text-xs",children:$.priority||"routine"}),a.jsx("td",{className:"px-3 py-2",children:a.jsx(B1,{status:$.status})}),a.jsx("td",{className:"px-3 py-2 text-xs",children:$R($.created_at||$.createdAt)}),a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsx(Zi,{to:`/lab/orders/${$.id}`,className:"btn-ghost text-xs",children:"View"})})]},$.id)),!i&&P.length===0&&a.jsx("tr",{children:a.jsx("td",{className:"px-3 py-6 text-center text-gray-500",colSpan:6,children:"No orders"})})]}),a.jsx("tfoot",{children:a.jsx("tr",{children:a.jsxs("td",{className:"px-3 py-2 text-xs text-gray-500",colSpan:6,children:["Total: ",L]})})})]})})]}),o&&a.jsxs("div",{className:"fixed inset-0 z-40",children:[a.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>c(!1)}),a.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-xl bg-white shadow-xl p-4 overflow-y-auto",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"New Lab Order"}),a.jsxs("div",{className:"space-y-4 text-sm",children:[a.jsx(Rb,{value:d,onChange:u}),a.jsx(I6e,{value:h,onChange:m}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm block mb-1",children:"Priority"}),a.jsxs("select",{className:"input",value:x,onChange:$=>b($.target.value),children:[a.jsx("option",{value:"routine",children:"Routine"}),a.jsx("option",{value:"urgent",children:"Urgent"}),a.jsx("option",{value:"stat",children:"STAT"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{className:"btn-ghost",onClick:()=>c(!1),children:"Cancel"}),a.jsx("button",{className:"btn-primary",onClick:R,children:"Create"})]})]})]})]})]})}const Vh=(t={})=>{const n={};return Object.entries(t).forEach(([s,r])=>{r!=null&&r!==""&&(n[s]=r)}),n};function aK({active:t,search:n}={}){const s=Vh({active:t,search:n});return ne.get("/ot/specialities",{params:s})}function M6e(t){return ne.post("/ot/specialities",t)}function O6e(t,n){return ne.put(`/ot/specialities/${t}`,n)}function D6e(t){return ne.delete(`/ot/specialities/${t}`)}function iK({search:t,specialityId:n,isActive:s,limit:r}={}){const i=Vh({search:t,speciality_id:n,is_active:typeof s=="boolean"?s:void 0,limit:r});return ne.get("/ot/procedures",{params:i})}function R6e(t){return ne.post("/ot/procedures",t)}function L6e(t,n){return ne.put(`/ot/procedures/${t}`,n)}function B6e(t){return ne.delete(`/ot/procedures/${t}`)}function F6e({active:t,search:n,specialityId:s}={}){const r=Vh({active:t,search:n,speciality_id:s});return ne.get("/ot/theatres",{params:r})}function $6e({date:t,bedId:n,surgeonUserId:s,patientId:r,status:i}={}){const l=Vh({date:t,bed_id:n,surgeon_user_id:s,patient_id:r,status:i});return ne.get("/ot/schedule",{params:l})}function z6e(t){return ne.post("/ot/schedules",t)}function U6e(t,n){return ne.put(`/ot/schedules/${t}`,n)}function V6e(t){return ne.get(`/ot/cases/${t}`)}function H6e(t){return ne.get(`/ot/cases/${t}/preop-checklist`).then(n=>n.data)}function W6e(t,n){return ne.post(`/ot/cases/${t}/preop-checklist`,n).then(s=>s.data)}function q6e(t,n){return ne.put(`/ot/cases/${t}/preop-checklist`,n).then(s=>s.data)}function G6e(t){return ne.get(`/ot/cases/${t}/safety-checklist`)}function K6e(t,n){return ne.post(`/ot/cases/${t}/safety-checklist`,{...n,case_id:t})}function Y6e(t,n){return ne.put(`/ot/cases/${t}/safety-checklist`,n)}const X6e=t=>ne.get(`/ot/cases/${t}/anaesthesia-record`),Q6e=(t,n)=>ne.post(`/ot/cases/${t}/anaesthesia-record`,n),Z6e=(t,n)=>ne.put(`/ot/cases/${t}/anaesthesia-record`,n),J6e=t=>ne.get(`/ot/anaesthesia-records/${t}/vitals`),e8e=(t,n)=>ne.post(`/ot/anaesthesia-records/${t}/vitals`,n),t8e=t=>ne.delete(`/ot/anaesthesia-vitals/${t}`),n8e=t=>ne.get(`/ot/anaesthesia-records/${t}/drugs`),s8e=(t,n)=>ne.post(`/ot/anaesthesia-records/${t}/drugs`,n),r8e=t=>ne.delete(`/ot/anaesthesia-drugs/${t}`);function a8e(t){return ne.get(`/ot/cases/${t}/nursing-record`)}function i8e(t,n){return ne.post(`/ot/cases/${t}/nursing-record`,{...n,case_id:t,primary_nurse_id:n.primary_nurse_id??null})}function zR(t,n){return ne.put(`/ot/cases/${t}/nursing-record`,{...n,case_id:t,primary_nurse_id:n.primary_nurse_id??null})}function l8e(t){return ne.get(`/ot/cases/${t}/counts`)}function o8e(t,n){return ne.post(`/ot/cases/${t}/counts`,n)}function c8e(t,n){return ne.put(`/ot/cases/${t}/counts`,n)}function d8e(t){return ne.get(`/ot/cases/${t}/operation-note`)}function u8e(t,n){return ne.post(`/ot/cases/${t}/operation-note`,{...n,case_id:t})}function f8e(t,n){return ne.put(`/ot/cases/${t}/operation-note`,n)}function h8e(t){return ne.get(`/ot/cases/${t}/blood-transfusions`)}function m8e(t,n){return ne.post(`/ot/cases/${t}/blood-transfusions`,{...n,case_id:t})}function p8e(t){return ne.delete(`/ot/blood-transfusions/${t}`)}function x8e(t){return ne.get(`/ot/cases/${t}/pacu`)}function g8e(t,n){return ne.post(`/ot/cases/${t}/pacu`,{...n,case_id:t})}function y8e(t,n){return ne.put(`/ot/cases/${t}/pacu`,n)}function b8e({theatreId:t,caseId:n,date:s,fromDate:r,toDate:i,session:l}={}){const o=Vh({theatre_id:t,case_id:n,date:s,from_date:r,to_date:i,session:l});return ne.get("/ot/cleaning-logs",{params:o})}function v8e(t){return ne.post("/ot/cleaning-logs",t)}function w8e(t,n){return ne.put(`/ot/cleaning-logs/${t}`,n)}function N8e(t){return ne.delete(`/ot/cleaning-logs/${t}`)}function j8e({theatreId:t,date:n,fromDate:s,toDate:r}={}){const i=Vh({theatre_id:t,date:n,from_date:s,to_date:r});return ne.get("/ot/environment-logs",{params:i})}function S8e(t){return ne.post("/ot/environment-logs",t)}function _8e(t,n){return ne.put(`/ot/environment-logs/${t}`,n)}function C8e(t){return ne.delete(`/ot/environment-logs/${t}`)}function A8e(t,n={}){return ne.post(`/ot/schedule/${t}/open-case`,n)}function k8e({value:t,onChange:n,label:s="Patient",initialPatient:r=null,disabled:i=!1}){const[l,o]=y.useState(""),[c,d]=y.useState([]),[u,h]=y.useState(!1),[m,x]=y.useState(r||null);y.useEffect(()=>{r&&x(r)},[r]),y.useEffect(()=>{let j=!0;if(!l){d([]);return}return h(!0),Z3(l).then(S=>{j&&d(S.data||[])}).catch(()=>{j&&d([])}).finally(()=>{j&&h(!1)}),()=>{j=!1}},[l]),y.useEffect(()=>{if(!t){x(null);return}const j=c.find(S=>S.id===t);j&&x(j)},[t,c]);const b=j=>{x(j),o(""),d([]),n==null||n(j.id,j)},w=()=>{x(null),n==null||n(null,null)};return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:s}),!m&&a.jsxs(a.Fragment,{children:[a.jsx("input",{className:"input",placeholder:"Search by name / UHID / phone",value:l,disabled:i,onChange:j=>o(j.target.value)}),u&&a.jsx("div",{className:"text-xs text-slate-500",children:"Searching"}),c.length>0&&a.jsx("div",{className:"max-h-48 overflow-auto rounded-xl border bg-white text-sm",children:c.map(j=>a.jsx("button",{type:"button",onClick:()=>b(j),className:"flex w-full items-center justify-between px-3 py-2 text-left hover:bg-slate-50",children:a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:[j.first_name," ",j.last_name]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",j.uhid,"  ",j.phone]})]})},j.id))})]}),m&&a.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-xl border bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:[m.first_name," ",m.last_name]}),a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID: ",m.uhid,"  ",m.phone]})]}),!i&&a.jsx("button",{type:"button",onClick:w,className:"text-[11px] font-medium text-sky-700 hover:underline",children:"Change"})]})]})}function UR({value:t,onChange:n,label:s="Department  Doctor",initialDepartmentId:r=null,disabled:i=!1}){const[l,o]=y.useState([]),[c,d]=y.useState(""),[u,h]=y.useState([]),[m,x]=y.useState(!1),[b,w]=y.useState(!1),[j,S]=y.useState("");y.useEffect(()=>{let T=!0;return w(!0),t9().then(I=>{T&&o(I.data||[])}).catch(I=>{T&&(console.error("fetchDepartments error",I),xe.error("Failed to load departments"),o([]))}).finally(()=>{T&&w(!1)}),()=>{T=!1}},[]),y.useEffect(()=>{r&&!c&&d(String(r))},[r]),y.useEffect(()=>{let T=!0;if(S(""),h([]),!c)return;const I=Number(c);return x(!0),n9({departmentId:I,isDoctor:!0}).then(D=>{T&&h(D.data||[])}).catch(D=>{var R,P;if(!T)return;console.error("fetchDepartmentUsers error",D);const O=((P=(R=D==null?void 0:D.response)==null?void 0:R.data)==null?void 0:P.detail)||"Failed to load doctors";S(O),xe.error(O),h([])}).finally(()=>{T&&x(!1)}),()=>{T=!1}},[c]);const C=y.useMemo(()=>u.find(T=>T.id===t)||null,[u,t]),A=T=>{const I=T.target.value;d(I);const D=I?Number(I):null;n==null||n(null,{department_id:D})},k=T=>{const I=T.target.value,D=I?Number(I):null,O=c?Number(c):null;n==null||n(D,{department_id:O})};return a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:s}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[a.jsxs("select",{className:"input",value:c,onChange:A,disabled:b||i,children:[a.jsx("option",{value:"",children:b?"Loading departments":"Select department"}),l.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]}),a.jsxs("select",{className:"input",value:t||"",onChange:k,disabled:i||!c||m||u.length===0,children:[a.jsx("option",{value:"",children:m?"Loading doctors":c?u.length===0?"No doctors in this department":"Select doctor":"Select department first"}),u.map(T=>a.jsxs("option",{value:T.id,children:[T.name,T.email?` (${T.email})`:""]},T.id))]})]}),C&&a.jsxs("div",{className:"rounded-xl border bg-emerald-50 px-3 py-2 text-sm",children:["Selected:"," ",a.jsx("span",{className:"font-medium",children:C.name})]}),j&&a.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:j})]})}function lK({value:t,onChange:n}){const[s,r]=y.useState([]),[i,l]=y.useState(""),[o,c]=y.useState([]),[d,u]=y.useState(""),[h,m]=y.useState([]);return y.useEffect(()=>{Db().then(x=>r(x.data||[]))},[]),y.useEffect(()=>{c([]),u(""),m([]),i&&Sx({ward_id:i}).then(x=>c(x.data||[]))},[i]),y.useEffect(()=>{m([]),d&&el({room_id:d}).then(x=>m(x.data||[]))},[d]),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Allocate Bed (Ward  Room  Bed)"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("select",{className:"input",value:i,onChange:x=>l(x.target.value),children:[a.jsx("option",{value:"",children:"Select ward"}),s.map(x=>a.jsxs("option",{value:x.id,children:[x.code,"  ",x.name]},x.id))]}),a.jsxs("select",{className:"input",value:d,onChange:x=>u(x.target.value),disabled:!i,children:[a.jsx("option",{value:"",children:"Select room"}),o.map(x=>a.jsxs("option",{value:x.id,children:[x.number,"  ",x.type]},x.id))]}),a.jsxs("select",{className:"input",value:t||"",onChange:x=>n(Number(x.target.value)),disabled:!d,children:[a.jsx("option",{value:"",children:"Select bed"}),h.map(x=>a.jsxs("option",{value:x.id,children:[x.code," ",x.state!=="vacant"?` ${x.state}`:""]},x.id))]})]}),!!t&&(()=>{const x=h.find(b=>b.id===t);return x?a.jsxs("div",{className:"text-xs text-gray-500",children:["Selected: ",a.jsx("span",{className:"font-medium",children:x.code})," (",x.state,")"]}):null})()]})}const E8e=t=>t?(typeof t=="string"?new Date(t):t).toISOString().slice(0,10):"",VR=t=>t?String(t).slice(0,5):"",T8e={planned:"bg-blue-50 text-blue-700 border-blue-200",in_progress:"bg-amber-50 text-amber-700 border-amber-200",completed:"bg-emerald-50 text-emerald-700 border-emerald-200",cancelled:"bg-rose-50 text-rose-700 border-rose-200"},I8e={Elective:"bg-slate-50 text-slate-700 border-slate-200",Emergency:"bg-red-50 text-red-700 border-red-200"};function P8e({status:t}){if(!t)return null;const n=T8e[t]||"bg-slate-50 text-slate-700 border-slate-200",s=t.replace("_"," ").replace(/\b\w/g,r=>r.toUpperCase());return a.jsxs("span",{className:`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium ${n}`,children:[a.jsx("span",{className:"mr-1.5 h-1.5 w-1.5 rounded-full bg-current"}),s]})}function M8e({priority:t}){if(!t)return null;const n=I8e[t]||"bg-slate-50 text-slate-700 border-slate-200";return a.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium uppercase tracking-wide ${n}`,children:t})}function O8e({selectedBedId:t,onSelectBed:n}){return a.jsxs("div",{className:"flex h-full flex-col rounded-2xl border bg-white/80 backdrop-blur-sm",children:[a.jsxs("div",{className:"border-b px-4 py-3",children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"OT Location / Bed Filter"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Filter OT schedule by ward & bed, or leave blank to see all."})]}),a.jsxs("div",{className:"flex-1 space-y-3 px-3 py-3",children:[a.jsx(lK,{value:t?Number(t):null,onChange:s=>n(s||null)}),a.jsx("div",{className:"rounded-xl border border-slate-100 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:t?a.jsxs(a.Fragment,{children:["Showing cases for ",a.jsxs("span",{className:"font-semibold",children:["Bed #",t]}),"."]}):a.jsxs(a.Fragment,{children:["No specific bed selected  showing ",a.jsx("span",{className:"font-semibold",children:"all OT beds"})," for this day."]})})]})]})}function D8e({schedules:t,loading:n,date:s,bedId:r,onEdit:i,onOpenCase:l}){const o=r?`Bed #${r}  ${s}`:`All locations  ${s}`;return a.jsxs("div",{className:"flex h-full flex-col rounded-2xl border bg-white/90 backdrop-blur-sm",children:[a.jsx("div",{className:"flex items-center justify-between gap-3 border-b px-4 py-3",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:"OT Day Schedule"}),a.jsx("p",{className:"text-xs text-slate-500",children:o})]})}),a.jsx("div",{className:"flex-1 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[a.jsx("thead",{className:"sticky top-0 z-10 border-b bg-slate-50/90 backdrop-blur",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Time"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Location / Bed"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Patient"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Procedure"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Surgeon"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Priority"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),a.jsxs("tbody",{children:[n&&a.jsx(a.Fragment,{children:Array.from({length:4}).map((c,d)=>a.jsx("tr",{className:"animate-pulse border-b last:border-b-0",children:Array.from({length:8}).map((u,h)=>a.jsx("td",{className:"px-4 py-3",children:a.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},h))},d))}),!n&&t.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-xs text-slate-500",children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[a.jsx(Gs,{className:"h-5 w-5 text-slate-400"}),a.jsx("span",{children:"No cases scheduled for this day."})]})})}),!n&&t.map(c=>{var j,S,C,A,k,T,I;const d=[c.planned_start_time,c.planned_end_time].filter(Boolean).join("  "),u=((j=c.patient)==null?void 0:j.full_name)||[(S=c.patient)==null?void 0:S.first_name,(C=c.patient)==null?void 0:C.last_name].filter(Boolean).join(" "),h=((A=c.patient)==null?void 0:A.uhid)||c.patient_uhid,m=((k=c.surgeon)==null?void 0:k.full_name)||c.surgeon_name||null,x=((T=c.anaesthetist)==null?void 0:T.full_name)||c.anaesthetist_name||null,b=((I=c.primary_procedure)==null?void 0:I.name)||c.procedure_name,w=(c.procedures||[]).filter(D=>!D.is_primary).length;return a.jsxs("tr",{className:"border-b border-slate-100 last:border-b-0 hover:bg-slate-50/60",children:[a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-700",children:[a.jsx(Ys,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{children:d||""})]})}),a.jsx("td",{className:"px-4 py-2 align-top text-xs text-slate-700",children:c.bed_id?a.jsxs("div",{className:"font-medium text-slate-800",children:["Bed #",c.bed_id]}):a.jsx("div",{className:"font-medium text-slate-400",children:"No bed assigned"})}),a.jsxs("td",{className:"px-4 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ps,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"font-medium text-slate-800",children:u||(h?`UHID ${h}`:`UHID #${c.patient_id}`)})]}),h&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["UHID ",h]}),c.admission_id&&a.jsxs("div",{className:"text-[11px] text-slate-500",children:["IP #",c.admission_id]})]}),a.jsxs("td",{className:"max-w-xs px-4 py-2 align-top text-xs text-slate-700",children:[a.jsx("div",{className:"line-clamp-2 font-medium text-slate-900",children:b||""}),a.jsxs("div",{className:"mt-0.5 flex flex-wrap items-center gap-1",children:[c.side&&a.jsx("span",{className:"rounded-full bg-slate-100 px-1.5 py-0.5 text-[10px] uppercase tracking-wide text-slate-600",children:c.side}),w>0&&a.jsxs("span",{className:"rounded-full bg-sky-50 px-1.5 py-0.5 text-[10px] text-sky-700",children:["+",w," more"]})]})]}),a.jsxs("td",{className:"px-4 py-2 align-top text-xs text-slate-700",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(un,{className:"h-3.5 w-3.5 text-slate-400"}),a.jsx("span",{className:"font-medium text-slate-800",children:m||`Dr #${c.surgeon_user_id}`})]}),(x||c.anaesthetist_user_id)&&a.jsxs("div",{className:"mt-0.5 text-[11px] text-slate-500",children:["Anaes"," ",x||`#${c.anaesthetist_user_id}`]})]}),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsx(M8e,{priority:c.priority})}),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsx(P8e,{status:c.status})}),a.jsx("td",{className:"px-4 py-2 align-top",children:a.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[a.jsx("button",{type:"button",className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] font-medium text-slate-700 hover:border-sky-400 hover:text-sky-700",onClick:()=>i(c),children:"Edit"}),a.jsxs("button",{type:"button",onClick:()=>l(c),className:`inline-flex items-center gap-1 rounded-lg border px-2.5 py-1 text-[11px] font-medium ${c.case_id?"border-slate-200 bg-white text-slate-700 hover:border-sky-400 hover:text-sky-700":"border-emerald-600 bg-emerald-600 text-white hover:bg-emerald-700"}`,children:[a.jsx(or,{className:"h-3.5 w-3.5"}),c.case_id?"Details":"Open Case"]})]})})]},c.id)})]})]})})]})}function R8e({open:t,mode:n,onClose:s,onSaved:r,defaultDate:i,defaultBedId:l,editingSchedule:o}){const c=n==="edit",[d,u]=y.useState({date:i||"",planned_start_time:"",planned_end_time:"",patient_id:"",admission_id:"",bed_id:l||"",surgeon_user_id:"",anaesthetist_user_id:"",procedure_name:"",side:"",priority:"Elective",notes:"",primary_procedure_id:"",additional_procedure_ids:[]}),[h,m]=y.useState(!1),[x,b]=y.useState(null);if(y.useEffect(()=>{var k,T;t&&(u(c&&o?{date:o.date||i||"",planned_start_time:VR(o.planned_start_time),planned_end_time:VR(o.planned_end_time),patient_id:o.patient_id||"",admission_id:o.admission_id||"",bed_id:o.bed_id||l||"",surgeon_user_id:o.surgeon_user_id||"",anaesthetist_user_id:o.anaesthetist_user_id||"",procedure_name:o.procedure_name||((k=o.primary_procedure)==null?void 0:k.name)||"",side:o.side||"",priority:o.priority||"Elective",notes:o.notes||"",primary_procedure_id:o.primary_procedure_id||"",additional_procedure_ids:((T=o.procedures)==null?void 0:T.filter(I=>!I.is_primary).map(I=>I.procedure_id))||[]}:{date:i||"",planned_start_time:"",planned_end_time:"",patient_id:"",admission_id:"",bed_id:l||"",surgeon_user_id:"",anaesthetist_user_id:"",procedure_name:"",side:"",priority:"Elective",notes:"",primary_procedure_id:"",additional_procedure_ids:[]}),b(null),m(!1))},[t,c,o,l,i]),!t)return null;const w=(k,T)=>{u(I=>({...I,[k]:T}))},j=()=>d.date?d.planned_start_time?d.procedure_name?d.surgeon_user_id?null:"Please select surgeon":"Please enter procedure name":"Please enter start time":"Please select a date",S=async k=>{var I,D;k.preventDefault();const T=j();if(T){b(T);return}m(!0),b(null);try{const O={date:d.date,planned_start_time:d.planned_start_time,planned_end_time:d.planned_end_time||null,patient_id:d.patient_id?Number(d.patient_id):null,admission_id:d.admission_id?Number(d.admission_id):null,bed_id:d.bed_id?Number(d.bed_id):null,surgeon_user_id:d.surgeon_user_id?Number(d.surgeon_user_id):null,anaesthetist_user_id:d.anaesthetist_user_id?Number(d.anaesthetist_user_id):null,procedure_name:d.procedure_name,side:d.side||null,priority:d.priority||"Elective",notes:d.notes||null,primary_procedure_id:d.primary_procedure_id?Number(d.primary_procedure_id):null,additional_procedure_ids:(d.additional_procedure_ids||[]).map(R=>Number(R))};console.log(O,"bed no"),c&&(o!=null&&o.id)?await U6e(o.id,O):await z6e(O),r==null||r(),s()}catch(O){console.error("Failed to save OT schedule",O);const R=((D=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:D.detail)||(O==null?void 0:O.message)||"Failed to save OT schedule";b(R)}finally{m(!1)}},C=c?"Edit OT Schedule":"New OT Schedule",A=c?"Update timing and details of this OT booking.":"Create a new OT booking for the selected day.";return a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:a.jsxs("div",{className:"relative w-full max-w-3xl rounded-2xl bg-white shadow-xl",children:[a.jsxs("div",{className:"flex items-start justify-between border-b px-5 py-3.5",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:C}),a.jsx("p",{className:"text-xs text-slate-500",children:A})]}),a.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:a.jsx(Os,{className:"h-4 w-4"})})]}),a.jsxs("form",{onSubmit:S,children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4 px-5 py-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Date ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.date,onChange:k=>w("date",k.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Priority"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.priority,onChange:k=>w("priority",k.target.value),children:[a.jsx("option",{value:"Elective",children:"Elective"}),a.jsx("option",{value:"Emergency",children:"Emergency"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Start time ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.planned_start_time,onChange:k=>w("planned_start_time",k.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"End time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.planned_end_time,onChange:k=>w("planned_end_time",k.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx(k8e,{label:"Patient",value:d.patient_id?Number(d.patient_id):null,onChange:k=>u(T=>({...T,patient_id:k||""}))}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Admission ID (IP)"}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.admission_id,onChange:k=>w("admission_id",k.target.value),placeholder:"Optional"})]})]}),a.jsx(lK,{value:d.bed_id?Number(d.bed_id):null,onChange:k=>u(T=>({...T,bed_id:k||""}))})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(L8e,{primaryId:d.primary_procedure_id?Number(d.primary_procedure_id):null,additionalIds:d.additional_procedure_ids||[],onChange:k=>{u(T=>({...T,primary_procedure_id:k.primary_procedure_id??T.primary_procedure_id,additional_procedure_ids:k.additional_procedure_ids??T.additional_procedure_ids,procedure_name:k.primary_procedure_name&&!T.procedure_name?k.primary_procedure_name:T.procedure_name}))}}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Procedure name (display)"," ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.procedure_name,onChange:k=>w("procedure_name",k.target.value),placeholder:"E.g., Laparoscopic cholecystectomy"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Side"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.side,onChange:k=>w("side",k.target.value),children:[a.jsx("option",{value:"",children:"Not applicable"}),a.jsx("option",{value:"Right",children:"Right"}),a.jsx("option",{value:"Left",children:"Left"}),a.jsx("option",{value:"Bilateral",children:"Bilateral"}),a.jsx("option",{value:"Midline",children:"Midline"})]})]}),a.jsx(UR,{label:"Surgeon",value:d.surgeon_user_id?Number(d.surgeon_user_id):null,onChange:k=>u(T=>({...T,surgeon_user_id:k||""}))})]}),a.jsx(UR,{label:"Anaesthetist",value:d.anaesthetist_user_id?Number(d.anaesthetist_user_id):null,onChange:k=>u(T=>({...T,anaesthetist_user_id:k||""}))}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-2 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:d.notes,onChange:k=>w("notes",k.target.value),placeholder:"Any special requirements / remarks"})]})]})]}),x&&a.jsx("div",{className:"px-5 pb-2",children:a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:x})}),a.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[a.jsx("button",{type:"button",onClick:s,className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:h,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:h,children:[h&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),c?"Update Schedule":"Create Schedule"]})]})]})]})})}function L8e({primaryId:t,additionalIds:n,onChange:s}){const[r,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState("");y.useEffect(()=>{(async()=>{try{o(!0);const b=await iK({limit:500});i(b.data||[])}catch(b){console.error("Failed to load OT procedures",b)}finally{o(!1)}})()},[]);const u=y.useMemo(()=>{const x=c.trim().toLowerCase();return x?r.filter(b=>{const w=(b.name||"").toLowerCase(),j=(b.code||"").toLowerCase();return w.includes(x)||j.includes(x)}):r},[r,c]),h=x=>{var w;const b=x?Number(x):null;s({primary_procedure_id:b,additional_procedure_ids:n||[],primary_procedure_name:b&&((w=r.find(j=>j.id===b))==null?void 0:w.name)||""})},m=x=>{const b=new Set(n||[]);b.has(x)?b.delete(x):b.add(x),s({primary_procedure_id:t||null,additional_procedure_ids:Array.from(b)})};return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Procedures (from master)"}),a.jsxs("div",{className:"relative w-40",children:[a.jsx(jn,{className:"pointer-events-none absolute left-2 top-1.5 h-3.5 w-3.5 text-slate-400"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white pl-7 pr-1.5 py-1 text-[11px] text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search...",value:c,onChange:x=>d(x.target.value)})]})]}),a.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/60 p-2",children:[l&&a.jsx("div",{className:"text-[11px] text-slate-500",children:"Loading procedures..."}),!l&&u.length===0&&a.jsx("div",{className:"text-[11px] text-slate-500",children:"No procedures found."}),!l&&u.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] font-medium text-slate-600",children:[a.jsx(kb,{className:"h-3 w-3"}),"Primary procedure"]}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:t||"",onChange:x=>h(x.target.value),children:[a.jsx("option",{value:"",children:"Not selected"}),u.map(x=>a.jsx("option",{value:x.id,children:(x.code?x.code+"  ":"")+x.name},x.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-[11px] font-medium text-slate-600",children:"Additional procedures"}),a.jsx("div",{className:"max-h-32 space-y-1 overflow-auto rounded-lg border border-slate-100 bg-white p-1.5 text-[11px]",children:u.map(x=>{const b=(n||[]).includes(x.id);return a.jsxs("label",{className:"flex cursor-pointer items-center gap-1.5 rounded-md px-1 py-0.5 hover:bg-slate-50",children:[a.jsx("input",{type:"checkbox",className:"h-3 w-3 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:b,onChange:()=>m(x.id)}),a.jsx("span",{className:"truncate",children:(x.code?x.code+"  ":"")+x.name})]},x.id)})})]})]})]})]})}function B8e(){const t=et("ot.schedule.view"),n=et("ot.schedule.create"),s=et("ot.schedule.update"),[r,i]=y.useState(E8e(new Date)),[l,o]=y.useState(null),[c,d]=y.useState([]),[u,h]=y.useState(!1),[m,x]=y.useState(null),[b,w]=y.useState(!1),[j,S]=y.useState("create"),[C,A]=y.useState(null),k=Aa(),T=async()=>{if(r)try{h(!0),x(null);const R=await $6e({date:r,bedId:l||void 0});d(R.data||[])}catch(R){console.error("Failed to load OT schedule",R),x("Failed to load OT schedule")}finally{h(!1)}},I=async R=>{var P;try{if(R.case_id){k(`/ot/cases/${R.case_id}`);return}const L=await A8e(R.id),$=(P=L==null?void 0:L.data)==null?void 0:P.id;await T(),$?k(`/ot/cases/${$}`):console.warn("No case id returned from open-case response",L)}catch(L){console.error("Failed to open OT case",L)}};y.useEffect(()=>{t&&T()},[r,l,t]);const D=()=>{n&&(S("create"),A(null),w(!0))},O=R=>{s&&(S("edit"),A(R),w(!0))};return t?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Schedule (Beds)"}),a.jsx("p",{className:"text-xs text-slate-500",children:"View and manage OT bookings by date and bed / location, aligned with NABH OT records."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-1.5",children:[a.jsx(Gs,{className:"h-4 w-4 text-slate-500"}),a.jsx("input",{type:"date",className:"border-none bg-transparent text-xs text-slate-800 focus:outline-none",value:r,onChange:R=>i(R.target.value)})]}),a.jsxs("button",{type:"button",onClick:T,className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:border-sky-500 hover:text-sky-700",children:[a.jsx(cu,{className:"h-3.5 w-3.5"}),"Refresh"]}),n&&a.jsxs("button",{type:"button",onClick:D,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[a.jsx(Nn,{className:"h-3.5 w-3.5"}),"New Schedule"]})]})]}),m&&a.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-700",children:m}),a.jsxs("div",{className:"grid h-[calc(100vh-170px)] grid-cols-1 gap-3 md:grid-cols-[minmax(260px,0.32fr)_minmax(0,0.68fr)]",children:[a.jsx(O8e,{selectedBedId:l,onSelectBed:o}),a.jsx(D8e,{schedules:c,loading:u,date:r,bedId:l,onEdit:O,onOpenCase:I})]})]}),a.jsx(R8e,{open:b,mode:j,onClose:()=>w(!1),onSaved:T,defaultDate:r,defaultBedId:l,editingSchedule:C})]}):a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:"You do not have permission to view OT schedules."})})}const F8e=t=>t===!0||t==="true"||t===1||t==="1";function oK({open:t,title:n,subtitle:s,onClose:r,children:i}){return t?a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:a.jsxs("div",{className:"relative w-full max-w-2xl rounded-2xl bg-white shadow-xl",children:[a.jsxs("div",{className:"flex items-start justify-between border-b px-5 py-3.5",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold text-slate-900",children:n}),s&&a.jsx("p",{className:"text-xs text-slate-500",children:s})]}),a.jsx("button",{type:"button",onClick:r,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600",children:a.jsx(Os,{className:"h-4 w-4"})})]}),i]})}):null}function $8e(){const t=et("ot.masters.view")||et("ot.specialities.view"),n=et("ot.masters.manage")||et("ot.specialities.create")||et("ot.specialities.update"),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(""),[h,m]=y.useState(!1),[x,b]=y.useState(null),[w,j]=y.useState(!1),[S,C]=y.useState(null),[A,k]=y.useState({name:"",code:"",description:"",is_active:!0}),T=y.useMemo(()=>{const L=d.trim().toLowerCase();return L?s.filter($=>($.name||"").toLowerCase().includes(L)||($.code||"").toLowerCase().includes(L)):s},[s,d]),I=async()=>{if(t)try{l(!0),c(null);const L=await aK({});r(L.data||[])}catch(L){console.error("Failed to load OT specialities",L),c("Failed to load OT specialities")}finally{l(!1)}};y.useEffect(()=>{I()},[t]);const D=()=>{b(null),k({name:"",code:"",description:"",is_active:!0}),C(null),m(!0)},O=L=>{b(L),k({name:L.name||"",code:L.code||"",description:L.description||"",is_active:F8e(L.is_active)}),C(null),m(!0)},R=async L=>{var $,B;if(L.preventDefault(),!A.name){C("Please enter speciality name");return}if(!A.code){C("Please enter code");return}j(!0),C(null);try{const V={name:A.name,code:A.code,description:A.description||null,is_active:!!A.is_active};x?await O6e(x.id,V):await M6e(V),m(!1),b(null),I()}catch(V){console.error("Failed to save OT speciality",V);const K=((B=($=V==null?void 0:V.response)==null?void 0:$.data)==null?void 0:B.detail)||(V==null?void 0:V.message)||"Failed to save speciality";C(K)}finally{j(!1)}},P=async L=>{if(window.confirm(`Delete speciality "${L.name}"?`))try{await D6e(L.id),I()}catch($){console.error("Failed to delete OT speciality",$),alert("Failed to delete")}};return t?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[a.jsx(Zee,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"OT Specialities"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),a.jsx("input",{type:"text",className:"w-44 rounded-lg border border-slate-200 bg-white pl-7 pr-2 py-1.5 text-xs text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search...",value:d,onChange:L=>u(L.target.value)})]}),n&&a.jsxs("button",{type:"button",onClick:D,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[a.jsx(Nn,{className:"h-3.5 w-3.5"}),"New"]})]})]}),o&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),a.jsx("div",{className:"overflow-hidden rounded-2xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Code"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Name"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Active"}),a.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx(a.Fragment,{children:Array.from({length:4}).map((L,$)=>a.jsx("tr",{className:"animate-pulse border-t",children:Array.from({length:5}).map((B,V)=>a.jsx("td",{className:"px-4 py-2",children:a.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},V))},$))}),!i&&T.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-xs text-slate-500",children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[a.jsx(No,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{children:"No OT specialities found."})]})})}),!i&&T.map(L=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-4 py-2 text-xs font-medium text-slate-800",children:L.code}),a.jsx("td",{className:"px-4 py-2 text-xs text-slate-800",children:L.name}),a.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:L.description||""}),a.jsx("td",{className:"px-4 py-2 text-xs",children:a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${L.is_active?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:L.is_active?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-2 text-right text-xs",children:n&&a.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[a.jsxs("button",{type:"button",onClick:()=>O(L),className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-700 hover:border-sky-400 hover:text-sky-700",children:[a.jsx(Xa,{className:"h-3 w-3"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>P(L),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-1 text-[11px] text-rose-600 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3 w-3"}),"Delete"]})]})})]},L.id))]})]})})]}),a.jsx(oK,{open:h,title:x?"Edit OT Speciality":"New OT Speciality",subtitle:"Map OT workload by speciality for scheduling and reporting.",onClose:()=>m(!1),children:a.jsxs("form",{onSubmit:R,children:[a.jsxs("div",{className:"grid grid-cols-1 gap-3 px-5 py-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Code ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:A.code,onChange:L=>k($=>({...$,code:L.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Name ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:A.name,onChange:L=>k($=>({...$,name:L.target.value}))})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:A.description,onChange:L=>k($=>({...$,description:L.target.value}))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"ot_spec_active",type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!A.is_active,onChange:L=>k($=>({...$,is_active:L.target.checked}))}),a.jsx("label",{htmlFor:"ot_spec_active",className:"text-xs text-slate-700",children:"Active"})]}),S&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:S})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[a.jsx("button",{type:"button",onClick:()=>m(!1),className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:w,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:w,children:[w&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})})]}):a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT specialities."})}function z8e(){const t=et("ot.masters.view")||et("ot.procedures.view"),n=et("ot.masters.manage")||et("ot.procedures.create")||et("ot.procedures.update"),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null),[d,u]=y.useState(""),[h,m]=y.useState([]),[x,b]=y.useState(!1),[w,j]=y.useState(!1),[S,C]=y.useState(null),[A,k]=y.useState(!1),[T,I]=y.useState(null),[D,O]=y.useState({code:"",name:"",speciality_id:"",duration_hours:"",duration_minutes:"",rate_per_hour:"",description:"",is_active:!0}),R=y.useMemo(()=>{const z=d.trim().toLowerCase();return z?s.filter(H=>{var ee;const Y=(H.name||"").toLowerCase(),G=(H.code||"").toLowerCase(),J=(((ee=H.speciality)==null?void 0:ee.name)||"").toLowerCase();return Y.includes(z)||G.includes(z)||J.includes(z)}):s},[s,d]),P=async()=>{if(t)try{l(!0),c(null);const z=await iK({});r(z.data||[])}catch(z){console.error("Failed to load OT procedures",z),c("Failed to load OT procedures")}finally{l(!1)}},L=async()=>{try{b(!0);const z=await aK({});m(z.data||[])}catch(z){console.error("Failed to load OT specialities for procedures",z)}finally{b(!1)}};y.useEffect(()=>{t&&(P(),L())},[t]);const $=()=>{C(null),O({code:"",name:"",speciality_id:"",duration_hours:"",duration_minutes:"",rate_per_hour:"",description:"",is_active:!0}),I(null),j(!0)},B=z=>{const H=z.default_duration_min??null,Y=H!=null?Math.floor(H/60):"",G=H!=null?H%60:"";C(z),O({code:z.code||"",name:z.name||"",speciality_id:z.speciality_id||"",duration_hours:Y===0&&G===0?"":String(Y||""),duration_minutes:G===0&&Y===0?"":String(G||""),rate_per_hour:z.rate_per_hour!=null?String(z.rate_per_hour):"",description:z.description||"",is_active:!!z.is_active}),I(null),j(!0)},V=async z=>{var ye,ie;if(z.preventDefault(),!D.code)return I("Please enter procedure code");if(!D.name)return I("Please enter procedure name");const H=D.duration_hours?Number(D.duration_hours):0,Y=D.duration_minutes?Number(D.duration_minutes):0,G=H*60+Y,J=G>0?G:null,ee=D.rate_per_hour===""||D.rate_per_hour===null?null:Number(D.rate_per_hour);k(!0),I(null);try{const he={code:D.code,name:D.name,speciality_id:D.speciality_id?Number(D.speciality_id):null,default_duration_min:J,rate_per_hour:ee,description:D.description||null,is_active:!!D.is_active};S?await L6e(S.id,he):await R6e(he),j(!1),C(null),P()}catch(he){console.error("Failed to save OT procedure",he);const be=((ie=(ye=he==null?void 0:he.response)==null?void 0:ye.data)==null?void 0:ie.detail)||(he==null?void 0:he.message)||"Failed to save procedure";I(be)}finally{k(!1)}},K=async z=>{if(window.confirm(`Delete procedure "${z.name}"?`))try{await B6e(z.id),P()}catch(H){console.error("Failed to delete OT procedure",H),alert("Failed to delete procedure")}};return t?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[a.jsx(kb,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"OT Procedures"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(jn,{className:"absolute left-2 top-2 h-3.5 w-3.5 text-slate-400"}),a.jsx("input",{type:"text",className:"w-56 rounded-lg border border-slate-200 bg-white pl-7 pr-2 py-1.5 text-xs text-slate-800 placeholder:text-slate-400 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Search by code, name, speciality...",value:d,onChange:z=>u(z.target.value)})]}),n&&a.jsxs("button",{type:"button",onClick:$,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[a.jsx(Nn,{className:"h-3.5 w-3.5"}),"New"]})]})]}),o&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:o}),a.jsx("div",{className:"overflow-x-auto rounded-2xl border bg-white",children:a.jsxs("table",{className:"min-w-full text-left text-xs text-slate-700",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Code"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Name"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Speciality"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Default Duration"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Rate / hour"}),a.jsx("th",{className:"px-4 py-2 text-[11px] font-semibold text-slate-500",children:"Active"}),a.jsx("th",{className:"px-4 py-2 text-right text-[11px] font-semibold text-slate-500",children:"Actions"})]})}),a.jsxs("tbody",{children:[i&&a.jsx(a.Fragment,{children:Array.from({length:4}).map((z,H)=>a.jsx("tr",{className:"animate-pulse border-t",children:Array.from({length:7}).map((Y,G)=>a.jsx("td",{className:"px-4 py-2",children:a.jsx("div",{className:"h-3 w-3/4 rounded bg-slate-100"})},G))},H))}),!i&&R.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-xs text-slate-500",children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[a.jsx(No,{className:"h-4 w-4 text-amber-500"}),a.jsx("span",{children:"No OT procedures found."})]})})}),!i&&R.map(z=>{var G;const H=z.default_duration_min??null;let Y="";if(H!=null&&H>0){const J=Math.floor(H/60),ee=H%60;Y=J>0&&ee>0?`${J}h ${ee}min`:J>0?`${J}h`:`${ee}min`}return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-4 py-2 text-xs font-medium text-slate-800",children:z.code}),a.jsx("td",{className:"px-4 py-2 text-xs text-slate-800",children:z.name}),a.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:((G=z.speciality)==null?void 0:G.name)||z.speciality_id&&`#${z.speciality_id}`||""}),a.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:Y}),a.jsx("td",{className:"px-4 py-2 text-xs text-slate-600",children:z.rate_per_hour!=null?` ${Number(z.rate_per_hour).toFixed(2)}`:""}),a.jsx("td",{className:"px-4 py-2 text-xs",children:a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${z.is_active?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:z.is_active?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-2 text-right text-xs",children:n&&a.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[a.jsxs("button",{type:"button",onClick:()=>B(z),className:"inline-flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-700 hover:border-sky-400 hover:text-sky-700",children:[a.jsx(Xa,{className:"h-3 w-3"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>K(z),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-1 text-[11px] text-rose-600 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3 w-3"}),"Delete"]})]})})]},z.id)})]})]})})]}),a.jsx(oK,{open:w,title:S?"Edit OT Procedure":"New OT Procedure",subtitle:"Define procedures with default duration and hour-based rate for billing.",onClose:()=>j(!1),children:a.jsxs("form",{onSubmit:V,children:[a.jsxs("div",{className:"grid grid-cols-1 gap-3 px-5 py-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Code ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.code,onChange:z=>O(H=>({...H,code:z.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"text-xs font-medium text-slate-700",children:["Name ",a.jsx("span",{className:"text-rose-500",children:"*"})]}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.name,onChange:z=>O(H=>({...H,name:z.target.value}))})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default speciality (optional)"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.speciality_id,onChange:z=>O(H=>({...H,speciality_id:z.target.value})),children:[a.jsx("option",{value:"",children:"Not mapped"}),h.map(z=>a.jsx("option",{value:z.id,children:(z.code?`${z.code}  `:"")+z.name},z.id))]}),x&&a.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading specialities..."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default duration  hours"}),a.jsx("input",{type:"number",min:"0",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.duration_hours,onChange:z=>O(H=>({...H,duration_hours:z.target.value})),placeholder:"e.g., 2"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Default duration  minutes"}),a.jsx("input",{type:"number",min:"0",max:"59",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.duration_minutes,onChange:z=>O(H=>({...H,duration_minutes:z.target.value})),placeholder:"e.g., 30"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Rate per hour ()"}),a.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.rate_per_hour,onChange:z=>O(H=>({...H,rate_per_hour:z.target.value})),placeholder:"e.g., 5000"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Description / notes"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:D.description,onChange:z=>O(H=>({...H,description:z.target.value})),placeholder:"E.g., Includes surgeon charges only; anaesthesia separate."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"ot_proc_active",type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!D.is_active,onChange:z=>O(H=>({...H,is_active:z.target.checked}))}),a.jsx("label",{htmlFor:"ot_proc_active",className:"text-xs text-slate-700",children:"Active"})]}),T&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:T})]}),a.jsxs("div",{className:"flex items-center justify-end gap-2 border-t px-5 py-3",children:[a.jsx("button",{type:"button",onClick:()=>j(!1),className:"inline-flex items-center gap-1.5 rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50",disabled:A,children:"Cancel"}),a.jsxs("button",{type:"submit",className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",disabled:A,children:[A&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})})]}):a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT procedure masters."})}const U8e=[{id:"specialities",label:"Specialities"},{id:"procedures",label:"Procedures"}];function V8e(){const[t,n]=y.useState("specialities");return a.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[a.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Masters"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Configure OT specialities, theatres, equipment, and environment settings as per NABH."})]})}),a.jsx("div",{className:"flex gap-2 border-b border-slate-200",children:U8e.map(s=>{const r=s.id===t;return a.jsxs("button",{type:"button",onClick:()=>n(s.id),className:`relative px-3 py-1.5 text-xs font-medium transition-colors ${r?"text-sky-700":"text-slate-500 hover:text-slate-800"}`,children:[s.label,r&&a.jsx("span",{className:"absolute inset-x-0 bottom-0 h-0.5 rounded-full bg-sky-600"})]},s.id)})}),a.jsxs("div",{className:"flex-1 overflow-auto pt-2",children:[t==="specialities"&&a.jsx($8e,{}),t==="procedures"&&a.jsx(z8e,{})]})]})}const cK=[{value:"",label:"All sessions"},{value:"pre-list",label:"Pre-list"},{value:"between-cases",label:"Between cases"},{value:"end-of-day",label:"End of day"}],fw=t=>t?t.slice(0,10):"";function dK(){const[t,n]=y.useState("cleaning"),[s,r]=y.useState([]),[i,l]=y.useState(!1),[o,c]=y.useState(null);return y.useEffect(()=>{(async()=>{try{l(!0),c(null);const u=await F6e({});r(u.data||[])}catch(u){console.error("Failed to load OT theatres for logs",u),c("Failed to load OT theatres (for dropdowns)"),r([])}finally{l(!1)}})()},[]),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"OT Logs  Cleaning & Environment"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Statutory OT cleaning / turnover and environment monitoring logs (NABH)."}),o&&a.jsxs("p",{className:"mt-1 text-[11px] text-amber-600",children:[o,"  theatre names may not show."]})]}),a.jsxs("div",{className:"inline-flex rounded-full border border-slate-200 bg-slate-50 p-1 text-xs",children:[a.jsx("button",{type:"button",onClick:()=>n("cleaning"),className:`rounded-full px-3 py-1 font-medium transition ${t==="cleaning"?"bg-white text-sky-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Cleaning / Sterility"}),a.jsx("button",{type:"button",onClick:()=>n("environment"),className:`rounded-full px-3 py-1 font-medium transition ${t==="environment"?"bg-white text-sky-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Environment (T/H/P)"})]})]}),t==="cleaning"?a.jsx(H8e,{theatreOptions:s,theatresLoading:i}):a.jsx(q8e,{theatreOptions:s,theatresLoading:i})]})}function H8e({theatreOptions:t,theatresLoading:n}){const s=et("ot.logs.cleaning.view")||et("ot.logs.view")||et("ot.case.view"),r=et("ot.logs.cleaning.manage")||et("ot.logs.manage"),[i,l]=y.useState({theatreId:"",caseId:"",date:"",fromDate:"",toDate:"",session:""}),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,m]=y.useState(null),[x,b]=y.useState(!1),[w,j]=y.useState(null),[S,C]=y.useState(!1),A=y.useCallback(P=>{if(!P)return"";const L=t==null?void 0:t.find(B=>B.id===P);return L?`${L.code||`TH-${L.id}`}  ${L.name||""}`.trim():`#${P}`},[t]),k=y.useCallback(async()=>{if(s)try{u(!0),m(null);const P=await b8e({theatreId:i.theatreId||void 0,caseId:i.caseId||void 0,date:i.date||void 0,fromDate:i.fromDate||void 0,toDate:i.toDate||void 0,session:i.session||void 0});c(P.data||[])}catch(P){console.error("Failed to load cleaning logs",P),m("Failed to load cleaning logs"),c([])}finally{u(!1)}},[s,i]);y.useEffect(()=>{k()},[k]);const T=()=>{j(null),b(!1)},I=P=>{j(P),b(!0)},D=()=>{j(null),b(!0)},O=async P=>{if(r&&window.confirm("Delete this cleaning log entry?"))try{await N8e(P.id),await k()}catch(L){console.error("Failed to delete cleaning log",L),alert("Failed to delete cleaning log entry")}},R=async P=>{var L,$;if(r){C(!0);try{const B={theatre_id:P.theatre_id?Number(P.theatre_id):null,date:P.date||null,session:P.session||null,case_id:P.case_id?Number(P.case_id):null,method:P.method||null,done_by_user_id:P.done_by_user_id?Number(P.done_by_user_id):null,remarks:P.remarks||null};w!=null&&w.id?await w8e(w.id,B):await v8e(B),await k(),T()}catch(B){console.error("Failed to save cleaning log",B),alert((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to save cleaning log. Please check required fields.")}finally{C(!1)}}};return s?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(kb,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"OT Cleaning / Sterility Logs"})]}),r&&a.jsxs("button",{type:"button",onClick:D,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[a.jsx(Nn,{className:"h-3 w-3"}),"New cleaning log"]})]}),a.jsxs("div",{className:"mb-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] font-medium text-slate-600",children:[a.jsx(Ai,{className:"h-3 w-3"}),"Filters"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Theatre"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.theatreId,onChange:P=>l(L=>({...L,theatreId:P.target.value})),children:[a.jsx("option",{value:"",children:"All theatres"}),t==null?void 0:t.map(P=>a.jsx("option",{value:P.id,children:(P.code||`TH-${P.id}`)+(P.name?`  ${P.name}`:"")},P.id))]}),n&&a.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading theatres..."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Case ID"}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.caseId,onChange:P=>l(L=>({...L,caseId:P.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Date"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.date,onChange:P=>l(L=>({...L,date:P.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"From"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.fromDate,onChange:P=>l(L=>({...L,fromDate:P.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"To"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.toDate,onChange:P=>l(L=>({...L,toDate:P.target.value}))})]})]}),a.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[a.jsx("select",{className:"w-full max-w-xs rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.session,onChange:P=>l(L=>({...L,session:P.target.value})),children:cK.map(P=>a.jsx("option",{value:P.value,children:P.label},P.value))}),a.jsx("button",{type:"button",onClick:k,className:"rounded-lg border border-slate-300 bg-white px-3 py-1 text-[11px] font-medium text-slate-700 hover:bg-slate-100",children:"Apply"}),a.jsx("button",{type:"button",onClick:()=>l({theatreId:"",caseId:"",date:"",fromDate:"",toDate:"",session:""}),className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] text-slate-500 hover:bg-slate-100",children:"Clear"})]})]}),d&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading cleaning logs..."}),h&&a.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:h}),a.jsx("div",{className:"max-h-80 overflow-auto rounded-xl border bg-slate-50",children:a.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[a.jsx("thead",{className:"bg-slate-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-1.5",children:"Date"}),a.jsx("th",{className:"px-3 py-1.5",children:"Theatre"}),a.jsx("th",{className:"px-3 py-1.5",children:"Session"}),a.jsx("th",{className:"px-3 py-1.5",children:"Case ID"}),a.jsx("th",{className:"px-3 py-1.5",children:"Method"}),a.jsx("th",{className:"px-3 py-1.5",children:"Done by (user id)"}),a.jsx("th",{className:"px-3 py-1.5",children:"Remarks"}),r&&a.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[!d&&o.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:r?8:7,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No cleaning logs found for the selected filters."})}),!d&&o.map(P=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-1.5",children:fw(P.date)||""}),a.jsx("td",{className:"px-3 py-1.5",children:A(P.theatre_id)||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.session||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.case_id||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.method||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.done_by_user_id||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.remarks||""}),r&&a.jsx("td",{className:"px-3 py-1.5 text-right",children:a.jsxs("div",{className:"inline-flex gap-1",children:[a.jsxs("button",{type:"button",onClick:()=>I(P),className:"inline-flex items-center gap-1 rounded-lg border border-slate-300 bg-white px-2 py-0.5 text-[10px] text-slate-700 hover:bg-slate-100",children:[a.jsx(a7,{className:"h-3 w-3"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>O(P),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3 w-3"}),"Delete"]})]})})]},P.id))]})]})})]}),x&&a.jsx(W8e,{initial:w,onClose:T,onSave:R,saving:S,theatreOptions:t})]}):a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT cleaning logs."})}function W8e({initial:t,onClose:n,onSave:s,saving:r,theatreOptions:i}){const[l,o]=y.useState({theatre_id:(t==null?void 0:t.theatre_id)??"",date:t!=null&&t.date?fw(t.date):"",session:(t==null?void 0:t.session)??"",case_id:(t==null?void 0:t.case_id)??"",method:(t==null?void 0:t.method)??"",done_by_user_id:(t==null?void 0:t.done_by_user_id)??"",remarks:(t==null?void 0:t.remarks)??""}),c=(u,h)=>{o(m=>({...m,[u]:h}))},d=u=>{u.preventDefault(),s(l)};return a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 p-2",children:a.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-4 text-xs shadow-xl",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(kb,{className:"h-4 w-4 text-sky-600"}),a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t?"Edit cleaning log":"New cleaning log"})]}),a.jsx("button",{type:"button",onClick:n,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:a.jsx(Os,{className:"h-4 w-4"})})]}),a.jsxs("form",{onSubmit:d,className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Theatre *"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.theatre_id,required:!0,onChange:u=>c("theatre_id",u.target.value),children:[a.jsx("option",{value:"",children:"Select theatre"}),i==null?void 0:i.map(u=>a.jsx("option",{value:u.id,children:(u.code||`TH-${u.id}`)+(u.name?`  ${u.name}`:"")},u.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Date *"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.date,required:!0,onChange:u=>c("date",u.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Session"}),a.jsx("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.session,onChange:u=>c("session",u.target.value),children:cK.map(u=>a.jsx("option",{value:u.value,children:u.label||""},u.value))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Case ID (optional)"}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.case_id,onChange:u=>c("case_id",u.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Method / Type *"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",placeholder:"Mopping, fumigation, UV, etc.",value:l.method,required:!0,onChange:u=>c("method",u.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Done by (User ID) *"}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.done_by_user_id,required:!0,onChange:u=>c("done_by_user_id",u.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Remarks"}),a.jsx("textarea",{rows:2,className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.remarks,onChange:u=>c("remarks",u.target.value)})]}),a.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-[11px] text-slate-600 hover:bg-slate-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:r,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[r&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})]})})}function q8e({theatreOptions:t,theatresLoading:n}){const s=et("ot.logs.environment.view")||et("ot.logs.view")||et("ot.case.view"),r=et("ot.logs.environment.manage")||et("ot.logs.manage"),[i,l]=y.useState({theatreId:"",date:"",fromDate:"",toDate:""}),[o,c]=y.useState([]),[d,u]=y.useState(!1),[h,m]=y.useState(null),[x,b]=y.useState(!1),[w,j]=y.useState(null),[S,C]=y.useState(!1),A=y.useCallback(P=>{if(!P)return"";const L=t==null?void 0:t.find(B=>B.id===P);return L?`${L.code||`TH-${L.id}`}  ${L.name||""}`.trim():`#${P}`},[t]),k=y.useCallback(async()=>{if(s)try{u(!0),m(null);const P=await j8e({theatreId:i.theatreId||void 0,date:i.date||void 0,fromDate:i.fromDate||void 0,toDate:i.toDate||void 0});c(P.data||[])}catch(P){console.error("Failed to load environment logs",P),m("Failed to load environment logs"),c([])}finally{u(!1)}},[s,i]);y.useEffect(()=>{k()},[k]);const T=()=>{j(null),b(!1)},I=()=>{j(null),b(!0)},D=P=>{j(P),b(!0)},O=async P=>{if(r&&window.confirm("Delete this environment log entry?"))try{await C8e(P.id),await k()}catch(L){console.error("Failed to delete environment log",L),alert("Failed to delete environment log entry")}},R=async P=>{var L,$;if(r){C(!0);try{const B={theatre_id:P.theatre_id?Number(P.theatre_id):null,date:P.date||null,time:P.time||null,temperature_c:P.temperature_c===""?null:Number(P.temperature_c),humidity_percent:P.humidity_percent===""?null:Number(P.humidity_percent),pressure_diff_pa:P.pressure_diff_pa===""?null:Number(P.pressure_diff_pa),logged_by_user_id:P.logged_by_user_id?Number(P.logged_by_user_id):null};w!=null&&w.id?await _8e(w.id,B):await S8e(B),await k(),T()}catch(B){console.error("Failed to save environment log",B),alert((($=(L=B==null?void 0:B.response)==null?void 0:L.data)==null?void 0:$.detail)||"Failed to save environment log. Please check required fields.")}finally{C(!1)}}};return s?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(f3,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"OT Environment Logs (Temperature / Humidity / Pressure)"})]}),r&&a.jsxs("button",{type:"button",onClick:I,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700",children:[a.jsx(Nn,{className:"h-3 w-3"}),"New environment log"]})]}),a.jsxs("div",{className:"mb-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2",children:[a.jsxs("div",{className:"mb-1 flex items-center gap-2 text-[11px] font-medium text-slate-600",children:[a.jsx(Ai,{className:"h-3 w-3"}),"Filters"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Theatre"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.theatreId,onChange:P=>l(L=>({...L,theatreId:P.target.value})),children:[a.jsx("option",{value:"",children:"All theatres"}),t==null?void 0:t.map(P=>a.jsx("option",{value:P.id,children:(P.code||`TH-${P.id}`)+(P.name?`  ${P.name}`:"")},P.id))]}),n&&a.jsx("p",{className:"mt-0.5 text-[10px] text-slate-400",children:"Loading theatres..."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Date"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.date,onChange:P=>l(L=>({...L,date:P.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"From"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.fromDate,onChange:P=>l(L=>({...L,fromDate:P.target.value}))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"To"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px]",value:i.toDate,onChange:P=>l(L=>({...L,toDate:P.target.value}))})]})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:k,className:"rounded-lg border border-slate-300 bg-white px-3 py-1 text-[11px] font-medium text-slate-700 hover:bg-slate-100",children:"Apply"}),a.jsx("button",{type:"button",onClick:()=>l({theatreId:"",date:"",fromDate:"",toDate:""}),className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] text-slate-500 hover:bg-slate-100",children:"Clear"})]})]}),d&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading environment logs..."}),h&&a.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:h}),a.jsx("div",{className:"max-h-80 overflow-auto rounded-xl border bg-slate-50",children:a.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[a.jsx("thead",{className:"bg-slate-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-1.5",children:"Date"}),a.jsx("th",{className:"px-3 py-1.5",children:"Time"}),a.jsx("th",{className:"px-3 py-1.5",children:"Theatre"}),a.jsx("th",{className:"px-3 py-1.5",children:"Temp (C)"}),a.jsx("th",{className:"px-3 py-1.5",children:"Humidity (%)"}),a.jsx("th",{className:"px-3 py-1.5",children:"Pressure (Pa)"}),a.jsx("th",{className:"px-3 py-1.5",children:"Logged by (user id)"}),r&&a.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[!d&&o.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:r?8:7,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No environment logs found for the selected filters."})}),!d&&o.map(P=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-1.5",children:fw(P.date)||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.time?P.time.slice(0,5):""}),a.jsx("td",{className:"px-3 py-1.5",children:A(P.theatre_id)||""}),a.jsx("td",{className:"px-3 py-1.5",children:P.temperature_c!==null&&P.temperature_c!==void 0?P.temperature_c:""}),a.jsx("td",{className:"px-3 py-1.5",children:P.humidity_percent!==null&&P.humidity_percent!==void 0?P.humidity_percent:""}),a.jsx("td",{className:"px-3 py-1.5",children:P.pressure_diff_pa!==null&&P.pressure_diff_pa!==void 0?P.pressure_diff_pa:""}),a.jsx("td",{className:"px-3 py-1.5",children:P.logged_by_user_id||""}),r&&a.jsx("td",{className:"px-3 py-1.5 text-right",children:a.jsxs("div",{className:"inline-flex gap-1",children:[a.jsxs("button",{type:"button",onClick:()=>D(P),className:"inline-flex items-center gap-1 rounded-lg border border-slate-300 bg-white px-2 py-0.5 text-[10px] text-slate-700 hover:bg-slate-100",children:[a.jsx(a7,{className:"h-3 w-3"}),"Edit"]}),a.jsxs("button",{type:"button",onClick:()=>O(P),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[a.jsx(Wr,{className:"h-3 w-3"}),"Delete"]})]})})]},P.id))]})]})})]}),x&&a.jsx(G8e,{initial:w,onClose:T,onSave:R,saving:S,theatreOptions:t})]}):a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view environment logs."})}function G8e({initial:t,onClose:n,onSave:s,saving:r,theatreOptions:i}){const[l,o]=y.useState({theatre_id:(t==null?void 0:t.theatre_id)??"",date:t!=null&&t.date?fw(t.date):"",time:(t==null?void 0:t.time)??"",temperature_c:(t==null?void 0:t.temperature_c)!==null&&(t==null?void 0:t.temperature_c)!==void 0?String(t.temperature_c):"",humidity_percent:(t==null?void 0:t.humidity_percent)!==null&&(t==null?void 0:t.humidity_percent)!==void 0?String(t.humidity_percent):"",pressure_diff_pa:(t==null?void 0:t.pressure_diff_pa)!==null&&(t==null?void 0:t.pressure_diff_pa)!==void 0?String(t.pressure_diff_pa):"",logged_by_user_id:(t==null?void 0:t.logged_by_user_id)??""}),c=(u,h)=>{o(m=>({...m,[u]:h}))},d=u=>{u.preventDefault(),s(l)};return a.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/40 p-2",children:a.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-4 text-xs shadow-xl",children:[a.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(f3,{className:"h-4 w-4 text-sky-600"}),a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t?"Edit environment log":"New environment log"})]}),a.jsx("button",{type:"button",onClick:n,className:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",children:a.jsx(Os,{className:"h-4 w-4"})})]}),a.jsxs("form",{onSubmit:d,className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Theatre *"}),a.jsxs("select",{className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.theatre_id,required:!0,onChange:u=>c("theatre_id",u.target.value),children:[a.jsx("option",{value:"",children:"Select theatre"}),i==null?void 0:i.map(u=>a.jsx("option",{value:u.id,children:(u.code||`TH-${u.id}`)+(u.name?`  ${u.name}`:"")},u.id))]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Date *"}),a.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.date,required:!0,onChange:u=>c("date",u.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Time *"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.time,required:!0,onChange:u=>c("time",u.target.value)})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Temp (C)"}),a.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.temperature_c,onChange:u=>c("temperature_c",u.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Humidity (%)"}),a.jsx("input",{type:"number",step:"0.1",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.humidity_percent,onChange:u=>c("humidity_percent",u.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Pressure (Pa)"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.pressure_diff_pa,onChange:u=>c("pressure_diff_pa",u.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-slate-700",children:"Logged by (User ID) *"}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 px-2 py-1 text-[11px]",value:l.logged_by_user_id,required:!0,onChange:u=>c("logged_by_user_id",u.target.value)})]}),a.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:n,className:"rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-[11px] text-slate-600 hover:bg-slate-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:r,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-[11px] font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[r&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save"]})]})]})]})})}const uK=[{key:"allergy",label:"Allergy"},{key:"consent_form_signed",label:"Consent form signed"},{key:"written_high_risk_signed",label:"Written high risk form signed"},{key:"identity_bands_checked",label:"Identity bands checked"},{key:"npo",label:"Nill per mouth (NPO)"},{key:"pre_medication_given",label:"Pre-medication given"},{key:"test_dose_given",label:"Test dose given"},{key:"bowel_preparation",label:"Bowel preparation"},{key:"bladder_empty_time",label:"Bladder empty time"},{key:"serology_results",label:"Serology results"},{key:"blood_grouping",label:"Blood grouping"},{key:"blood_reservation",label:"Blood reservation"},{key:"patient_files_with_records",label:"Patient IP/OP files, ECG / X-ray with old records"},{key:"pre_anaesthetic_evaluation",label:"Pre-anaesthetic evaluation"},{key:"jewellery_nailpolish_removed",label:"Jewellery, nail polish, make-up removed"},{key:"prosthesis_dentures_wig_contactlens_removed",label:"Prosthesis / dentures / wig / contact lens removed"},{key:"sterile_preparation_done",label:"Sterile preparation done"}],t1=()=>({checklist:uK.reduce((t,n)=>(t[n.key]={handover:!1,receiving:!1,comments:""},t),{}),investigations:{hb:"",platelet:"",urea:"",creatinine:"",potassium:"",rbs:"",other:""},vitals:{temp:"",pulse:"",resp:"",bp:"",spo2:"",height:"",weight:""},shave_completed:null,nurse_signature:""}),K8e=t=>{const n=t1();if(!t||typeof t!="object")return n;const s={...n};return t.checklist&&typeof t.checklist=="object"&&(s.checklist={...n.checklist,...t.checklist}),"patient_identity_confirmed"in t&&(s.checklist.identity_bands_checked={...s.checklist.identity_bands_checked,handover:!!t.patient_identity_confirmed}),"consent_checked"in t&&(s.checklist.consent_form_signed={...s.checklist.consent_form_signed,handover:!!t.consent_checked}),"investigations_checked"in t&&(s.checklist.patient_files_with_records={...s.checklist.patient_files_with_records,handover:!!t.investigations_checked}),"blood_products_arranged"in t&&(s.checklist.blood_reservation={...s.checklist.blood_reservation,handover:!!t.blood_products_arranged}),"implants_available"in t&&(s.checklist.prosthesis_dentures_wig_contactlens_removed={...s.checklist.prosthesis_dentures_wig_contactlens_removed,handover:!!t.implants_available}),"site_marked"in t&&(s.checklist.pre_anaesthetic_evaluation={...s.checklist.pre_anaesthetic_evaluation,handover:!!t.site_marked}),t.fasting_status&&(s.checklist.npo={...s.checklist.npo,comments:t.fasting_status}),t.device_checks&&(s.checklist.pre_anaesthetic_evaluation={...s.checklist.pre_anaesthetic_evaluation,comments:t.device_checks}),t.notes&&(s.checklist.sterile_preparation_done={...s.checklist.sterile_preparation_done,comments:t.notes}),t.investigations&&(s.investigations={...n.investigations,...t.investigations}),t.vitals&&(s.vitals={...n.vitals,...t.vitals}),"shave_completed"in t&&(s.shave_completed=t.shave_completed),"nurse_signature"in t&&(s.nurse_signature=t.nurse_signature||""),s};function Y8e({caseId:t}){const n=et("ot.cases.view")||et("ot.preop_checklist.view"),s=et("ot.preop_checklist.update")||et("ot.preop_checklist.create")||et("ot.cases.update"),[r,i]=y.useState(null),[l,o]=y.useState(t1),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[m,x]=y.useState(null),b=async()=>{var k;if(n)try{d(!0),x(null);const T=await H6e(t);if(console.log("[PreOp] loaded record",T),!T){i(null),o(t1());return}i(T),o(K8e(T))}catch(T){((k=T==null?void 0:T.response)==null?void 0:k.status)===404?(i(null),o(t1())):(console.error("Failed to load Pre-op checklist",T),x("Failed to load Pre-op checklist"))}finally{d(!1)}};if(y.useEffect(()=>{b()},[t,n]),!n)return a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view pre-operative checklists."});const w=(k,T,I)=>{o(D=>({...D,checklist:{...D.checklist,[k]:{...D.checklist[k],[T]:I}}}))},j=(k,T)=>{o(I=>({...I,investigations:{...I.investigations,[k]:T}}))},S=(k,T)=>{o(I=>({...I,vitals:{...I.vitals,[k]:T}}))},C=async k=>{var T,I;if(k.preventDefault(),!!s){h(!0),x(null);try{const D={checklist:l.checklist,investigations:{...l.investigations},vitals:{...l.vitals},shave_completed:l.shave_completed,nurse_signature:l.nurse_signature||null,patient_identity_confirmed:!!l.checklist.identity_bands_checked.handover,consent_checked:!!l.checklist.consent_form_signed.handover,investigations_checked:!!l.checklist.patient_files_with_records.handover,blood_products_arranged:!!l.checklist.blood_reservation.handover,implants_available:!!l.checklist.prosthesis_dentures_wig_contactlens_removed.handover,site_marked:!!l.checklist.pre_anaesthetic_evaluation.handover,fasting_status:l.checklist.npo.comments||null,device_checks:l.checklist.pre_anaesthetic_evaluation.comments||null,notes:l.checklist.sterile_preparation_done.comments||null,completed:!1};r?await q6e(t,D):await W6e(t,D),await b()}catch(D){console.error("Failed to save Pre-op checklist",D);const O=((I=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:I.detail)||(D==null?void 0:D.message)||"Failed to save Pre-op checklist";x(O)}finally{h(!1)}}},A=(r==null?void 0:r.completed_at)||(r==null?void 0:r.updated_at)||(r==null?void 0:r.created_at);return a.jsxs("form",{onSubmit:C,className:"space-y-4 rounded-2xl border bg-white px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[a.jsx(Ate,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"Pre-operative checklist"})]}),A&&a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last saved: ",new Date(A).toLocaleString()]})]}),c&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading pre-op data..."}),m&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:m}),a.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-200",children:a.jsxs("table",{className:"min-w-full text-xs",children:[a.jsx("thead",{className:"bg-slate-50 text-[11px] font-semibold uppercase text-slate-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Item"}),a.jsx("th",{className:"px-3 py-2 text-center",children:"Handing over nurse"}),a.jsx("th",{className:"px-3 py-2 text-center",children:"Receiving nurse"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Comments"})]})}),a.jsx("tbody",{children:uK.map((k,T)=>{const I=l.checklist[k.key],D=T%2===0?"bg-white":"bg-slate-50/60";return a.jsxs("tr",{className:D,children:[a.jsx("td",{className:"px-3 py-1.5 text-slate-800",children:k.label}),a.jsx("td",{className:"px-3 py-1.5 text-center",children:a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!I.handover,disabled:!s,onChange:O=>w(k.key,"handover",O.target.checked)})}),a.jsx("td",{className:"px-3 py-1.5 text-center",children:a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!I.receiving,disabled:!s,onChange:O=>w(k.key,"receiving",O.target.checked)})}),a.jsx("td",{className:"px-3 py-1.5",children:a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Comments / remarks",value:I.comments||"",disabled:!s,onChange:O=>w(k.key,"comments",O.target.value)})})]},k.key)})})]})}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/60 p-3",children:[a.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Investigations"}),[["hb","HB"],["platelet","Platelet"],["urea","Urea"],["creatinine","Creatinine"],["potassium","Potassium"],["rbs","RBS"],["other","Others"]].map(([k,T])=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"w-24 text-[11px] font-medium text-slate-700",children:[T," :"]}),a.jsx("input",{type:"text",className:"flex-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.investigations[k],disabled:!s,onChange:I=>j(k,I.target.value)})]},k))]}),a.jsxs("div",{className:"space-y-2 rounded-xl border border-slate-200 bg-slate-50/60 p-3",children:[a.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-600",children:"Vitals"}),[["temp","Temp"],["pulse","Pulse"],["resp","Resp"],["bp","BP"],["spo2","SpO"],["height","Height"],["weight","Weight"]].map(([k,T])=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"w-24 text-[11px] font-medium text-slate-700",children:[T," :"]}),a.jsx("input",{type:"text",className:"flex-1 rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.vitals[k],disabled:!s,onChange:I=>S(k,I.target.value)})]},k))]})]}),a.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-xs font-medium text-slate-700",children:"Shave completed"}),a.jsxs("div",{className:"flex gap-3 text-xs",children:[a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.shave_completed==="yes",disabled:!s,onChange:()=>o(k=>({...k,shave_completed:"yes"}))}),a.jsx("span",{children:"Yes"})]}),a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.shave_completed==="no",disabled:!s,onChange:()=>o(k=>({...k,shave_completed:"no"}))}),a.jsx("span",{children:"No"})]})]}),a.jsx("p",{className:"text-[11px] text-slate-500",children:"(Body diagram marking can be handled in PDF / print layout.)"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Signature with name (nurse)"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"Name & signature",value:l.nurse_signature,disabled:!s,onChange:k=>o(T=>({...T,nurse_signature:k.target.value}))})]})]}),s&&a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Pre-op checklist"]})})]})}function X8e(t){if(!t)return null;const n=new Date(t);return Number.isNaN(n.getTime())?null:n}function Q8e(t){const n=X8e(t);return n?n.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function Z2(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const n=new Date(t);return Number.isNaN(n.getTime())?"":n.toISOString().slice(11,16)}const fK={identity_site_procedure_consent_confirmed:!1,site_marked:"",machine_and_medication_check_complete:!1,known_allergy:"",difficult_airway_or_aspiration_risk:"",blood_loss_risk_gt500ml_or_7mlkg:"",equipment_assistance_available:!1,iv_central_access_and_fluids_planned:!1},hK={team_members_introduced:!1,patient_name_procedure_incision_site_confirmed:!1,antibiotic_prophylaxis_given:"",surgeon_critical_steps:"",surgeon_case_duration_estimate:"",surgeon_anticipated_blood_loss:"",anaesthetist_patient_specific_concerns:"",sterility_confirmed:!1,equipment_issues_or_concerns:!1,essential_imaging_displayed:""},mK={procedure_name_confirmed:!1,counts_complete:!1,specimens_labelled_correctly:!1,equipment_problems_to_be_addressed:"",key_concerns_for_recovery_and_management:""},J2={sign_in_done:!1,sign_in_time:"",time_out_done:!1,time_out_time:"",sign_out_done:!1,sign_out_time:"",sign_in:fK,time_out:hK,sign_out:mK};function Z8e({caseId:t}){const n=et("ot.cases.view")||et("ot.safety.view"),s=et("ot.safety.manage")||et("ot.cases.update"),[r,i]=y.useState(null),[l,o]=y.useState(J2),[c,d]=y.useState(!1),[u,h]=y.useState(!1),[m,x]=y.useState(null),b=async()=>{var A;if(n)try{d(!0),x(null);const T=(await G6e(t)).data;if(!T){i(null),o(J2);return}i(T),o({sign_in_done:!!T.sign_in_done,sign_in_time:Z2(T.sign_in_time),time_out_done:!!T.time_out_done,time_out_time:Z2(T.time_out_time),sign_out_done:!!T.sign_out_done,sign_out_time:Z2(T.sign_out_time),sign_in:{...fK,...T.sign_in||{}},time_out:{...hK,...T.time_out||{}},sign_out:{...mK,...T.sign_out||{}}})}catch(k){((A=k==null?void 0:k.response)==null?void 0:A.status)===404?(i(null),o(J2)):(console.error("Failed to load Surgical Safety checklist",k),x("Failed to load Surgical Safety checklist"))}finally{d(!1)}};if(y.useEffect(()=>{b()},[t,n]),!n)return a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view Surgical Safety Checklist."});const w=(A,k)=>{o(T=>({...T,[A]:k}))},j=(A,k,T)=>{o(I=>({...I,[A]:{...I[A],[k]:T}}))},S=async A=>{var k,T;if(A.preventDefault(),!!s){h(!0),x(null);try{const I={sign_in_done:!!l.sign_in_done,sign_in_time:l.sign_in_time||null,time_out_done:!!l.time_out_done,time_out_time:l.time_out_time||null,sign_out_done:!!l.sign_out_done,sign_out_time:l.sign_out_time||null,sign_in:l.sign_in,time_out:l.time_out,sign_out:l.sign_out};r?await Y6e(t,I):await K6e(t,I),await b()}catch(I){console.error("Failed to save Surgical Safety checklist",I);const D=((T=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:T.detail)||(I==null?void 0:I.message)||"Failed to save Surgical Safety checklist";x(D)}finally{h(!1)}}},C=(r==null?void 0:r.updated_at)||(r==null?void 0:r.created_at);return a.jsxs("form",{onSubmit:S,className:"space-y-4 rounded-2xl border bg-white px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[a.jsx(Ji,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"WHO Surgical Safety Checklist"})]}),C&&a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",Q8e(C)]})]}),c&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading Surgical Safety data..."}),m&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:m}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[a.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Sign in (before induction)"}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.sign_in_done,disabled:!s,onChange:A=>w("sign_in_done",A.target.checked)}),a.jsx("span",{children:"Checklist completed"})]}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_in_time,disabled:!s,onChange:A=>w("sign_in_time",A.target.value)})]})]}),a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[a.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Time out (before skin incision)"}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.time_out_done,disabled:!s,onChange:A=>w("time_out_done",A.target.checked)}),a.jsx("span",{children:"Checklist completed"})]}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out_time,disabled:!s,onChange:A=>w("time_out_time",A.target.value)})]})]}),a.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[a.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Sign out (before patient leaves OT)"}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!l.sign_out_done,disabled:!s,onChange:A=>w("sign_out_done",A.target.checked)}),a.jsx("span",{children:"Checklist completed"})]}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx("label",{className:"text-[11px] text-slate-600",children:"Time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out_time,disabled:!s,onChange:A=>w("sign_out_time",A.target.value)})]})]})]}),a.jsxs("div",{className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 text-xs",children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before induction of anaesthesia"}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.identity_site_procedure_consent_confirmed,disabled:!s,onChange:A=>j("sign_in","identity_site_procedure_consent_confirmed",A.target.checked)}),a.jsx("span",{children:"Patient confirmed identity, site, procedure and consent"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsx("span",{className:"text-[11px] text-slate-700",children:"Is the site marked?"}),["yes","no","na"].map(A=>a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.site_marked===A,disabled:!s,onChange:()=>j("sign_in","site_marked",A)}),a.jsx("span",{className:"capitalize text-[11px]",children:A==="na"?"Not applicable":A})]},A))]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.machine_and_medication_check_complete,disabled:!s,onChange:A=>j("sign_in","machine_and_medication_check_complete",A.target.checked)}),a.jsx("span",{children:"Anaesthesia machine and medication check complete"})]}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("span",{className:"text-[11px] text-slate-700",children:"Does the patient have a known allergy?"}),["yes","no"].map(A=>a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.known_allergy===A,disabled:!s,onChange:()=>j("sign_in","known_allergy",A)}),a.jsx("span",{className:"capitalize text-[11px]",children:A})]},A))]}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("span",{className:"text-[11px] text-slate-700",children:"Difficult airway or aspiration risk?"}),["yes","no"].map(A=>a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.difficult_airway_or_aspiration_risk===A,disabled:!s,onChange:()=>j("sign_in","difficult_airway_or_aspiration_risk",A)}),a.jsx("span",{className:"capitalize text-[11px]",children:A})]},A))]}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("span",{className:"text-[11px] text-slate-700",children:"Risk of > 500 ml blood loss (7 ml/kg in children)?"}),["yes","no"].map(A=>a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.blood_loss_risk_gt500ml_or_7mlkg===A,disabled:!s,onChange:()=>j("sign_in","blood_loss_risk_gt500ml_or_7mlkg",A)}),a.jsx("span",{className:"capitalize text-[11px]",children:A})]},A))]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.equipment_assistance_available,disabled:!s,onChange:A=>j("sign_in","equipment_assistance_available",A.target.checked)}),a.jsx("span",{children:"Yes, and equipment / assistance available"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_in.iv_central_access_and_fluids_planned,disabled:!s,onChange:A=>j("sign_in","iv_central_access_and_fluids_planned",A.target.checked)}),a.jsx("span",{children:"Yes, and two IV / central access and fluids planned"})]})]}),a.jsxs("div",{className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 text-xs",children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before skin incision"}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.team_members_introduced,disabled:!s,onChange:A=>j("time_out","team_members_introduced",A.target.checked)}),a.jsx("span",{children:"All team members (nurse, anaesthetist, surgeon) have introduced themselves by name and role"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.patient_name_procedure_incision_site_confirmed,disabled:!s,onChange:A=>j("time_out","patient_name_procedure_incision_site_confirmed",A.target.checked)}),a.jsx("span",{children:"Patient name, procedure, and incision site confirmed aloud"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsx("span",{className:"text-[11px] text-slate-700",children:"Has antibiotic prophylaxis been given in last 60 minutes?"}),["yes","no","na"].map(A=>a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.antibiotic_prophylaxis_given===A,disabled:!s,onChange:()=>j("time_out","antibiotic_prophylaxis_given",A)}),a.jsx("span",{className:"capitalize text-[11px]",children:A==="na"?"Not applicable":A})]},A))]}),a.jsxs("div",{className:"mt-1 grid gap-2 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  critical or non-routine steps"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_critical_steps,disabled:!s,onChange:A=>j("time_out","surgeon_critical_steps",A.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  expected case duration"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_case_duration_estimate,disabled:!s,onChange:A=>j("time_out","surgeon_case_duration_estimate",A.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon  anticipated blood loss"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.surgeon_anticipated_blood_loss,disabled:!s,onChange:A=>j("time_out","surgeon_anticipated_blood_loss",A.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Anaesthetist  patient-specific concerns"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.time_out.anaesthetist_patient_specific_concerns,disabled:!s,onChange:A=>j("time_out","anaesthetist_patient_specific_concerns",A.target.value)})]}),a.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.sterility_confirmed,disabled:!s,onChange:A=>j("time_out","sterility_confirmed",A.target.checked)}),a.jsx("span",{children:"Sterility (including indicators) confirmed"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.equipment_issues_or_concerns,disabled:!s,onChange:A=>j("time_out","equipment_issues_or_concerns",A.target.checked)}),a.jsx("span",{children:"Any equipment issues or concerns"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsx("span",{className:"text-[11px] text-slate-700",children:"Essential imaging displayed?"}),["yes","no","na"].map(A=>a.jsxs("label",{className:"inline-flex items-center gap-1.5",children:[a.jsx("input",{type:"radio",className:"h-3.5 w-3.5 border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.time_out.essential_imaging_displayed===A,disabled:!s,onChange:()=>j("time_out","essential_imaging_displayed",A)}),a.jsx("span",{className:"capitalize text-[11px]",children:A==="na"?"Not applicable":A})]},A))]})]})]}),a.jsxs("div",{className:"space-y-2 rounded-2xl border border-slate-200 bg-slate-50/60 p-3 text-xs",children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Before patient leaves operating room"}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.procedure_name_confirmed,disabled:!s,onChange:A=>j("sign_out","procedure_name_confirmed",A.target.checked)}),a.jsx("span",{children:"Nurse verbally confirms the name of the procedure"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.counts_complete,disabled:!s,onChange:A=>j("sign_out","counts_complete",A.target.checked)}),a.jsx("span",{children:"Completion of instrument, sponge and needle counts"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:l.sign_out.specimens_labelled_correctly,disabled:!s,onChange:A=>j("sign_out","specimens_labelled_correctly",A.target.checked)}),a.jsx("span",{children:"Specimen labelling / read specimen labels aloud (including patient name)"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"Whether there are any equipment problems to be addressed"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2 py-1 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out.equipment_problems_to_be_addressed||"",disabled:!s,onChange:A=>j("sign_out","equipment_problems_to_be_addressed",A.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:"To Surgeon, Anaesthetist and Nurse  key concerns for recovery and management of this patient"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2 py-1.5 text-[11px] text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:l.sign_out.key_concerns_for_recovery_and_management||"",disabled:!s,onChange:A=>j("sign_out","key_concerns_for_recovery_and_management",A.target.value)})]})]}),s&&a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Safety checklist"]})})]})}const HR={anaesthesia_type:"",asa_grade:"",airway_assessment:"",comorbidities:"",allergies:"",preop_pulse:"",preop_bp:"",preop_rr:"",preop_temp_c:"",preop_cvs:"",preop_rs:"",preop_cns:"",preop_pa:"",preop_veins:"",preop_spine:"",airway_teeth_status:"",airway_denture:"",airway_neck_movements:"",airway_mallampati_class:"",difficult_airway_anticipated:!1,risk_factors:"",anaesthetic_plan_detail:"",preop_instructions:"",preoxygenation:!1,cricoid_pressure:!1,induction_route:"",intubation_done:!1,intubation_route:"",intubation_state:"",intubation_technique:"",tube_type:"",tube_size:"",tube_fixed_at:"",cuff_used:!1,cuff_medium:"",bilateral_breath_sounds:"",added_sounds:"",laryngoscopy_grade:"",airway_devices:[],ventilation_mode_baseline:"",ventilator_vt:"",ventilator_rate:"",ventilator_peep:"",breathing_system:"",monitors:{},lines:{},tourniquet_used:!1,patient_position:"",eyes_taped:!1,eyes_covered_with_foil:!1,pressure_points_padded:!1,iv_fluids_plan:"",blood_components_plan:"",regional_block_type:"",regional_position:"",regional_approach:"",regional_space_depth:"",regional_needle_type:"",regional_drug_dose:"",regional_level:"",regional_complications:"",block_adequacy:"",sedation_needed:!1,conversion_to_ga:!1,notes:""},WR={time:"",hr:"",bp:"",spo2:"",rr:"",temp_c:"",etco2:"",ventilation_mode:"",peak_airway_pressure:"",cvp_pcwp:"",st_segment:"",urine_output_ml:"",blood_loss_ml:"",comments:""},qR={time:"",drug_name:"",dose:"",route:"",remarks:""};function J8e({caseId:t}){const[n,s]=y.useState("preop"),[r,i]=y.useState(HR),[l,o]=y.useState({id:null,created_at:null}),[c,d]=y.useState(!0),[u,h]=y.useState(!1),[m,x]=y.useState(null),[b,w]=y.useState(null),[j,S]=y.useState([]),[C,A]=y.useState(WR),[k,T]=y.useState(!1),[I,D]=y.useState([]),[O,R]=y.useState(qR),[P,L]=y.useState(!1);y.useEffect(()=>{let Z=!0;return(async()=>{var Te;d(!0),x(null);try{const de=(await X6e(t)).data;if(!Z)return;if(i(ge=>({...ge,...de})),o({id:de.id,created_at:de.created_at}),de.id){const[ge,ae]=await Promise.all([J6e(de.id),n8e(de.id)]);if(!Z)return;S(ge.data||[]),D(ae.data||[])}}catch(le){((Te=le==null?void 0:le.response)==null?void 0:Te.status)===404?(i(HR),o({id:null,created_at:null}),S([]),D([])):(console.error("Anaesthesia load error",le),x("Unable to load anaesthesia record. Please try again."))}finally{Z&&d(!1)}})(),()=>{Z=!1}},[t]);const $=y.useMemo(()=>m?a.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:[a.jsx(Ms,{className:"h-4 w-4"}),a.jsx("span",{children:m})]}):b?a.jsxs("div",{className:"mb-3 flex items-center gap-2 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:[a.jsx(zr,{className:"h-4 w-4"}),a.jsx("span",{children:b})]}):null,[m,b]),B=(Z,ce)=>{i(Te=>({...Te,[Z]:ce}))},V=Z=>{i(ce=>({...ce,[Z]:!ce[Z]}))},K=Z=>{i(ce=>{var Te;return{...ce,monitors:{...ce.monitors||{},[Z]:!((Te=ce.monitors)!=null&&Te[Z])}}})},z=Z=>{i(ce=>{var Te;return{...ce,lines:{...ce.lines||{},[Z]:!((Te=ce.lines)!=null&&Te[Z])}}})},H=Z=>{i(ce=>{const Te=ce.airway_devices||[];return Te.includes(Z)?{...ce,airway_devices:Te.filter(le=>le!==Z)}:{...ce,airway_devices:[...Te,Z]}})},Y=async()=>{h(!0),x(null),w(null);try{const Z={...r};if(l.id)await Z6e(t,Z);else{const ce=await Q6e(t,Z);o({id:ce.data.id,created_at:ce.data.created_at})}w("Anaesthesia record saved.")}catch(Z){console.error("Save anaesthesia record error",Z),x("Unable to save anaesthesia record.")}finally{h(!1)}},G=async()=>{if(!l.id){x("Save the anaesthesia record before adding vitals.");return}if(!C.time){x("Time is required for vitals (HH:MM).");return}T(!0),x(null),w(null);try{const Z={...C,hr:C.hr?Number(C.hr):null,spo2:C.spo2?Number(C.spo2):null,rr:C.rr?Number(C.rr):null,temp_c:C.temp_c?Number(C.temp_c):null,etco2:C.etco2?Number(C.etco2):null,peak_airway_pressure:C.peak_airway_pressure?Number(C.peak_airway_pressure):null,cvp_pcwp:C.cvp_pcwp?Number(C.cvp_pcwp):null,urine_output_ml:C.urine_output_ml?Number(C.urine_output_ml):null,blood_loss_ml:C.blood_loss_ml?Number(C.blood_loss_ml):null},ce=await e8e(l.id,Z);S(Te=>[...Te,ce.data]),A(WR),w("Vitals entry added.")}catch(Z){console.error("Add vital error",Z),x("Unable to add vitals entry.")}finally{T(!1)}},J=async Z=>{if(window.confirm("Delete this vitals entry?")){T(!0),x(null),w(null);try{await t8e(Z),S(ce=>ce.filter(Te=>Te.id!==Z)),w("Vitals entry deleted.")}catch(ce){console.error("Delete vital error",ce),x("Unable to delete vitals entry.")}finally{T(!1)}}},ee=async()=>{if(!l.id){x("Save the anaesthesia record before adding drug log.");return}if(!O.time||!O.drug_name){x("Drug time and name are required.");return}L(!0),x(null),w(null);try{const Z=await s8e(l.id,O);D(ce=>[...ce,Z.data]),R(qR),w("Drug log entry added.")}catch(Z){console.error("Add drug error",Z),x("Unable to add drug log entry.")}finally{L(!1)}},ye=async Z=>{if(window.confirm("Delete this drug entry?")){L(!0),x(null),w(null);try{await r8e(Z),D(ce=>ce.filter(Te=>Te.id!==Z)),w("Drug log entry deleted.")}catch(ce){console.error("Delete drug error",ce),x("Unable to delete drug entry.")}finally{L(!1)}}},ie=()=>a.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 shadow-sm",children:[a.jsxs("h3",{className:"mb-1 flex items-center gap-2 text-sm font-semibold text-slate-800",children:[a.jsx(_r,{className:"h-4 w-4"}),"Pre-anaesthetic assessment"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[a.jsx(Nt,{label:"ASA Grade",value:r.asa_grade,onChange:Z=>B("asa_grade",Z)}),a.jsx(Nt,{label:"Anaesthesia type",value:r.anaesthesia_type,onChange:Z=>B("anaesthesia_type",Z)}),a.jsx(Nt,{label:"Co-morbidities",value:r.comorbidities,onChange:Z=>B("comorbidities",Z)}),a.jsx(Nt,{label:"Allergies",value:r.allergies,onChange:Z=>B("allergies",Z)})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3 text-xs",children:[a.jsx(Nt,{label:"Pulse",value:r.preop_pulse,onChange:Z=>B("preop_pulse",Z)}),a.jsx(Nt,{label:"BP",value:r.preop_bp,onChange:Z=>B("preop_bp",Z)}),a.jsx(Nt,{label:"RR",value:r.preop_rr,onChange:Z=>B("preop_rr",Z)}),a.jsx(Nt,{label:"Temp (C)",value:r.preop_temp_c,onChange:Z=>B("preop_temp_c",Z)})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[a.jsx(Nt,{label:"CVS",value:r.preop_cvs,onChange:Z=>B("preop_cvs",Z)}),a.jsx(Nt,{label:"RS",value:r.preop_rs,onChange:Z=>B("preop_rs",Z)}),a.jsx(Nt,{label:"CNS",value:r.preop_cns,onChange:Z=>B("preop_cns",Z)}),a.jsx(Nt,{label:"PA",value:r.preop_pa,onChange:Z=>B("preop_pa",Z)}),a.jsx(Nt,{label:"Veins",value:r.preop_veins,onChange:Z=>B("preop_veins",Z)}),a.jsx(Nt,{label:"Spine",value:r.preop_spine,onChange:Z=>B("preop_spine",Z)})]})]}),a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 shadow-sm",children:[a.jsxs("h3",{className:"mb-1 flex items-center gap-2 text-sm font-semibold text-slate-800",children:[a.jsx(or,{className:"h-4 w-4"}),"Airway & risk"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[a.jsx(Nt,{label:"Teeth",placeholder:"Intact / Loose",value:r.airway_teeth_status,onChange:Z=>B("airway_teeth_status",Z)}),a.jsx(Nt,{label:"Denture",placeholder:"Present / Absent",value:r.airway_denture,onChange:Z=>B("airway_denture",Z)}),a.jsx(Nt,{label:"Neck movements",value:r.airway_neck_movements,onChange:Z=>B("airway_neck_movements",Z)}),a.jsx(Nt,{label:"Mallampati class",placeholder:"Class 1 / 2 / 3 / 4",value:r.airway_mallampati_class,onChange:Z=>B("airway_mallampati_class",Z)})]}),a.jsx("div",{className:"flex items-center gap-2 text-xs",children:a.jsxs("label",{className:"inline-flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",className:"h-3 w-3 rounded border-slate-300",checked:r.difficult_airway_anticipated||!1,onChange:()=>V("difficult_airway_anticipated")}),a.jsx("span",{children:"Difficult airway anticipated"})]})}),a.jsx(xg,{label:"Risk factors",value:r.risk_factors,onChange:Z=>B("risk_factors",Z)}),a.jsx(xg,{label:"Anaesthetic plan",value:r.anaesthetic_plan_detail,onChange:Z=>B("anaesthetic_plan_detail",Z)}),a.jsx(xg,{label:"Pre-op instructions",value:r.preop_instructions,onChange:Z=>B("preop_instructions",Z)})]})]}),he=()=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs shadow-sm",children:[a.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-800",children:"Induction & intubation"}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsx(Ta,{label:"Preoxygenation",checked:r.preoxygenation,onChange:()=>V("preoxygenation")}),a.jsx(Ta,{label:"Cricoid pressure",checked:r.cricoid_pressure,onChange:()=>V("cricoid_pressure")})]}),a.jsx(vl,{label:"Induction",value:r.induction_route,onChange:Z=>B("induction_route",Z),options:["","Intravenous","Inhalational","Rapid sequence"]}),a.jsx(Ta,{label:"Intubation done",checked:r.intubation_done,onChange:()=>V("intubation_done")}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx(vl,{label:"Route",value:r.intubation_route,onChange:Z=>B("intubation_route",Z),options:["","Oral","Nasal"]}),a.jsx(vl,{label:"State",value:r.intubation_state,onChange:Z=>B("intubation_state",Z),options:["","Awake","Anaesthetised"]}),a.jsx(vl,{label:"Technique",value:r.intubation_technique,onChange:Z=>B("intubation_technique",Z),options:["","Visual","Blind","Fibreoptic","Retrograde"]}),a.jsx(Nt,{label:"Laryngoscopy grade",placeholder:"I / II / III / IV",value:r.laryngoscopy_grade,onChange:Z=>B("laryngoscopy_grade",Z)})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx(Nt,{label:"Tube type",value:r.tube_type,onChange:Z=>B("tube_type",Z)}),a.jsx(Nt,{label:"Size",value:r.tube_size,onChange:Z=>B("tube_size",Z)}),a.jsx(Nt,{label:"Fixed at",value:r.tube_fixed_at,onChange:Z=>B("tube_fixed_at",Z)}),a.jsx(vl,{label:"Cuff medium",value:r.cuff_medium,onChange:Z=>B("cuff_medium",Z),options:["","Air","Saline","Not inflated"]})]}),a.jsx(Ta,{label:"Cuff used",checked:r.cuff_used,onChange:()=>V("cuff_used")}),a.jsx(Nt,{label:"Bilateral breath sounds",value:r.bilateral_breath_sounds,onChange:Z=>B("bilateral_breath_sounds",Z)}),a.jsx(Nt,{label:"Added sounds",value:r.added_sounds,onChange:Z=>B("added_sounds",Z)})]}),a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs shadow-sm",children:[a.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-800",children:"Airway devices & monitors"}),a.jsx("div",{className:"mb-2 text-[11px] font-medium text-slate-500",children:"Airway devices"}),a.jsx("div",{className:"grid grid-cols-2 gap-1",children:["Face mask","LMA/ILMA","Oral airway","Throat pack","NG tube","Other"].map(Z=>a.jsx(Ta,{label:Z,checked:(r.airway_devices||[]).includes(Z),onChange:()=>H(Z)},Z))}),a.jsx("div",{className:"mt-3 text-[11px] font-medium text-slate-500",children:"Monitors"}),a.jsx("div",{className:"grid grid-cols-2 gap-1",children:[["ecg","ECG"],["nibp","NIBP"],["pulse_oximeter","Pulse oximeter"],["capnograph","Capnograph"],["agent_monitor","Agent monitor"],["pns","PNS"],["temperature","Temperature"],["urinary_catheter","Urinary catheter"],["ibp","IBP"],["cvp","CVP"],["precordial_steth","Precordial steth"],["oesophageal_steth","Oesophageal steth"]].map(([Z,ce])=>{var Te;return a.jsx(Ta,{label:ce,checked:((Te=r.monitors)==null?void 0:Te[Z])||!1,onChange:()=>K(Z)},Z)})})]}),a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs shadow-sm",children:[a.jsx("h3",{className:"mb-1 text-sm font-semibold text-slate-800",children:"Ventilation & block"}),a.jsx(vl,{label:"Ventilation mode",value:r.ventilation_mode_baseline,onChange:Z=>B("ventilation_mode_baseline",Z),options:["","Spontaneous","Controlled","Manual","Ventilator"]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsx(Nt,{label:"Vt (ml)",value:r.ventilator_vt,onChange:Z=>B("ventilator_vt",Z)}),a.jsx(Nt,{label:"Rate (f)",value:r.ventilator_rate,onChange:Z=>B("ventilator_rate",Z)}),a.jsx(Nt,{label:"PEEP (cmHO)",value:r.ventilator_peep,onChange:Z=>B("ventilator_peep",Z)})]}),a.jsx(vl,{label:"Breathing system",value:r.breathing_system,onChange:Z=>B("breathing_system",Z),options:["","Mapleson A","Mapleson D","Mapleson F","Circle system","Other"]}),a.jsx("div",{className:"mt-2 text-[11px] font-medium text-slate-500",children:"Position & protection"}),a.jsx(vl,{label:"Patient position",value:r.patient_position,onChange:Z=>B("patient_position",Z),options:["","Supine","Lateral","Prone","Lithotomy","Other"]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(Ta,{label:"Eyes taped",checked:r.eyes_taped,onChange:()=>V("eyes_taped")}),a.jsx(Ta,{label:"Eyes covered with foil",checked:r.eyes_covered_with_foil,onChange:()=>V("eyes_covered_with_foil")}),a.jsx(Ta,{label:"Pressure points padded",checked:r.pressure_points_padded,onChange:()=>V("pressure_points_padded")})]}),a.jsx("div",{className:"mt-2 text-[11px] font-medium text-slate-500",children:"Lines & tourniquet"}),a.jsx("div",{className:"grid grid-cols-2 gap-1",children:[["peripheral_iv","Peripheral IV"],["central_line","Central line"],["arterial_line","Arterial line"]].map(([Z,ce])=>{var Te;return a.jsx(Ta,{label:ce,checked:((Te=r.lines)==null?void 0:Te[Z])||!1,onChange:()=>z(Z)},Z)})}),a.jsx(Ta,{label:"Tourniquet used",checked:r.tourniquet_used,onChange:()=>V("tourniquet_used")}),a.jsx(Nt,{label:"IV fluids plan",value:r.iv_fluids_plan,onChange:Z=>B("iv_fluids_plan",Z)}),a.jsx(Nt,{label:"Blood & components plan",value:r.blood_components_plan,onChange:Z=>B("blood_components_plan",Z)}),a.jsx("div",{className:"mt-2 text-[11px] font-medium text-slate-500",children:"Regional block"}),a.jsx(vl,{label:"Type",value:r.regional_block_type,onChange:Z=>B("regional_block_type",Z),options:["","Spinal","Epidural","Nerve block","Combined","None"]}),a.jsx(Nt,{label:"Position",value:r.regional_position,onChange:Z=>B("regional_position",Z)}),a.jsx(Nt,{label:"Approach",value:r.regional_approach,onChange:Z=>B("regional_approach",Z)}),a.jsx(Nt,{label:"Space & depth",value:r.regional_space_depth,onChange:Z=>B("regional_space_depth",Z)}),a.jsx(Nt,{label:"Needle type",value:r.regional_needle_type,onChange:Z=>B("regional_needle_type",Z)}),a.jsx(Nt,{label:"Drug injected / dose",value:r.regional_drug_dose,onChange:Z=>B("regional_drug_dose",Z)}),a.jsx(Nt,{label:"Level of anaesthesia",value:r.regional_level,onChange:Z=>B("regional_level",Z)}),a.jsx(Nt,{label:"Complications",value:r.regional_complications,onChange:Z=>B("regional_complications",Z)}),a.jsx(vl,{label:"Adequacy of block",value:r.block_adequacy,onChange:Z=>B("block_adequacy",Z),options:["","Excellent","Adequate","Poor"]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(Ta,{label:"Sedation needed",checked:r.sedation_needed,onChange:()=>V("sedation_needed")}),a.jsx(Ta,{label:"Conversion to GA",checked:r.conversion_to_ga,onChange:()=>V("conversion_to_ga")})]})]})]}),a.jsx(xg,{label:"Intra-op summary / notes",value:r.notes||"",onChange:Z=>B("notes",Z)})]}),be=()=>a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs shadow-sm",children:[a.jsxs("h3",{className:"mb-2 flex items-center gap-2 text-sm font-semibold text-slate-800",children:[a.jsx(or,{className:"h-4 w-4"}),"Intra-op vitals log"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-6",children:[a.jsx(Nt,{label:"Time (HH:MM)",value:C.time,onChange:Z=>A(ce=>({...ce,time:Z}))}),a.jsx(Nt,{label:"HR",value:C.hr,onChange:Z=>A(ce=>({...ce,hr:Z}))}),a.jsx(Nt,{label:"BP",value:C.bp,onChange:Z=>A(ce=>({...ce,bp:Z}))}),a.jsx(Nt,{label:"SpO",value:C.spo2,onChange:Z=>A(ce=>({...ce,spo2:Z}))}),a.jsx(Nt,{label:"RR",value:C.rr,onChange:Z=>A(ce=>({...ce,rr:Z}))}),a.jsx(Nt,{label:"Temp C",value:C.temp_c,onChange:Z=>A(ce=>({...ce,temp_c:Z}))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-6",children:[a.jsx(Nt,{label:"ETCO",value:C.etco2,onChange:Z=>A(ce=>({...ce,etco2:Z}))}),a.jsx(Nt,{label:"Vent mode",value:C.ventilation_mode,onChange:Z=>A(ce=>({...ce,ventilation_mode:Z}))}),a.jsx(Nt,{label:"Peak P (cmHO)",value:C.peak_airway_pressure,onChange:Z=>A(ce=>({...ce,peak_airway_pressure:Z}))}),a.jsx(Nt,{label:"CVP / PCWP",value:C.cvp_pcwp,onChange:Z=>A(ce=>({...ce,cvp_pcwp:Z}))}),a.jsx(Nt,{label:"Urine (ml)",value:C.urine_output_ml,onChange:Z=>A(ce=>({...ce,urine_output_ml:Z}))}),a.jsx(Nt,{label:"Blood loss (ml)",value:C.blood_loss_ml,onChange:Z=>A(ce=>({...ce,blood_loss_ml:Z}))})]}),a.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-end",children:[a.jsx("div",{className:"flex-1",children:a.jsx(Nt,{label:"ST segment / comments",value:C.st_segment||C.comments,onChange:Z=>A(ce=>({...ce,st_segment:Z,comments:Z}))})}),a.jsx("button",{type:"button",onClick:G,disabled:k,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-xs font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:"Add vitals"})]}),a.jsx("div",{className:"mt-3 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50 text-slate-600",children:a.jsxs("tr",{children:[a.jsx(_s,{children:"Time"}),a.jsx(_s,{children:"HR"}),a.jsx(_s,{children:"BP"}),a.jsx(_s,{children:"SpO"}),a.jsx(_s,{children:"RR"}),a.jsx(_s,{children:"Temp"}),a.jsx(_s,{children:"ETCO"}),a.jsx(_s,{children:"Vent"}),a.jsx(_s,{children:"Peak P"}),a.jsx(_s,{children:"CVP/PCWP"}),a.jsx(_s,{children:"Urine"}),a.jsx(_s,{children:"Blood loss"}),a.jsx(_s,{children:"Comments"}),a.jsx(_s,{})]})}),a.jsx("tbody",{children:j.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:14,className:"py-3 text-center text-slate-500",children:"No vitals logged yet."})}):j.map(Z=>a.jsxs("tr",{className:"border-t",children:[a.jsx(Cs,{children:Z.time}),a.jsx(Cs,{children:Z.hr}),a.jsx(Cs,{children:Z.bp}),a.jsx(Cs,{children:Z.spo2}),a.jsx(Cs,{children:Z.rr}),a.jsx(Cs,{children:Z.temp_c}),a.jsx(Cs,{children:Z.etco2}),a.jsx(Cs,{children:Z.ventilation_mode}),a.jsx(Cs,{children:Z.peak_airway_pressure}),a.jsx(Cs,{children:Z.cvp_pcwp}),a.jsx(Cs,{children:Z.urine_output_ml}),a.jsx(Cs,{children:Z.blood_loss_ml}),a.jsx(Cs,{children:Z.comments}),a.jsx(Cs,{children:a.jsx("button",{onClick:()=>J(Z.id),className:"text-xs text-red-500 hover:underline",children:"Delete"})})]},Z.id))})]})})]}),we=()=>a.jsxs("div",{className:"space-y-3 rounded-2xl border bg-white p-4 text-xs shadow-sm",children:[a.jsxs("h3",{className:"mb-2 flex items-center gap-2 text-sm font-semibold text-slate-800",children:[a.jsx(u4,{className:"h-4 w-4"}),"Anaesthesia drug log"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-5",children:[a.jsx(Nt,{label:"Time (HH:MM)",value:O.time,onChange:Z=>R(ce=>({...ce,time:Z}))}),a.jsx(Nt,{label:"Drug name",value:O.drug_name,onChange:Z=>R(ce=>({...ce,drug_name:Z}))}),a.jsx(Nt,{label:"Dose",value:O.dose,onChange:Z=>R(ce=>({...ce,dose:Z}))}),a.jsx(Nt,{label:"Route",value:O.route,onChange:Z=>R(ce=>({...ce,route:Z}))}),a.jsx(Nt,{label:"Remarks",value:O.remarks,onChange:Z=>R(ce=>({...ce,remarks:Z}))})]}),a.jsx("button",{type:"button",onClick:ee,disabled:P,className:"inline-flex items-center justify-center rounded-full bg-slate-900 px-4 py-2 text-xs font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:"Add drug"}),a.jsx("div",{className:"mt-3 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{className:"bg-slate-50 text-slate-600",children:a.jsxs("tr",{children:[a.jsx(_s,{children:"Time"}),a.jsx(_s,{children:"Drug"}),a.jsx(_s,{children:"Dose"}),a.jsx(_s,{children:"Route"}),a.jsx(_s,{children:"Remarks"}),a.jsx(_s,{})]})}),a.jsx("tbody",{children:I.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-3 text-center text-slate-500",children:"No drugs logged yet."})}):I.map(Z=>a.jsxs("tr",{className:"border-t",children:[a.jsx(Cs,{children:Z.time}),a.jsx(Cs,{children:Z.drug_name}),a.jsx(Cs,{children:Z.dose}),a.jsx(Cs,{children:Z.route}),a.jsx(Cs,{children:Z.remarks}),a.jsx(Cs,{children:a.jsx("button",{onClick:()=>ye(Z.id),className:"text-xs text-red-500 hover:underline",children:"Delete"})})]},Z.id))})]})})]});return c?a.jsx("div",{className:"rounded-2xl border bg-white p-6 text-sm text-slate-600",children:"Loading anaesthesia record"}):a.jsxs("div",{className:"space-y-4",children:[$,a.jsxs("div",{className:"flex flex-wrap gap-2 rounded-full bg-slate-100 p-1 text-xs",children:[a.jsx(pg,{active:n==="preop",onClick:()=>s("preop"),icon:_r,children:"Pre-op record"}),a.jsx(pg,{active:n==="intra",onClick:()=>s("intra"),icon:Rte,children:"Intra-op setup"}),a.jsx(pg,{active:n==="vitals",onClick:()=>s("vitals"),icon:or,children:"Vitals log"}),a.jsx(pg,{active:n==="drugs",onClick:()=>s("drugs"),icon:u4,children:"Drug log"}),a.jsx("div",{className:"ml-auto flex items-center text-[11px] text-slate-500",children:l.id?"Record created":"No record yet"})]}),n==="preop"&&ie(),n==="intra"&&he(),n==="vitals"&&be(),n==="drugs"&&we(),a.jsx("div",{className:"sticky bottom-0 mt-4 flex justify-end border-t bg-slate-50/80 px-2 py-3 backdrop-blur",children:a.jsx("button",{type:"button",onClick:Y,disabled:u,className:"inline-flex items-center rounded-full bg-slate-900 px-5 py-2 text-xs font-semibold text-white shadow hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60",children:u?"Saving":"Save anaesthesia record"})})]})}function pg({active:t,onClick:n,children:s,icon:r}){return a.jsxs("button",{type:"button",onClick:n,className:"inline-flex items-center gap-1 rounded-full px-3 py-1.5 transition "+(t?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-white/60"),children:[r&&a.jsx(r,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:s})]})}function Nt({label:t,value:n,onChange:s,placeholder:r}){return a.jsxs("label",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:t}),a.jsx("input",{className:"h-8 rounded-md border border-slate-200 bg-slate-50 px-2 text-xs text-slate-900 outline-none ring-0 focus:border-slate-400",value:n??"",placeholder:r,onChange:i=>s(i.target.value)})]})}function xg({label:t,value:n,onChange:s,placeholder:r}){return a.jsxs("label",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:t}),a.jsx("textarea",{className:"min-h-[70px] rounded-md border border-slate-200 bg-slate-50 px-2 py-1.5 text-xs text-slate-900 outline-none ring-0 focus:border-slate-400",value:n??"",placeholder:r,onChange:i=>s(i.target.value)})]})}function Ta({label:t,checked:n,onChange:s}){return a.jsxs("label",{className:"inline-flex items-center gap-1.5 text-[11px] text-slate-700",children:[a.jsx("input",{type:"checkbox",className:"h-3 w-3 rounded border-slate-300 text-slate-900 focus:ring-0",checked:!!n,onChange:s}),a.jsx("span",{children:t})]})}function vl({label:t,value:n,onChange:s,options:r}){return a.jsxs("label",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:t}),a.jsx("select",{className:"h-8 rounded-md border border-slate-200 bg-slate-50 px-2 text-xs text-slate-900 outline-none ring-0 focus:border-slate-400",value:n??"",onChange:i=>s(i.target.value),children:r.map(i=>a.jsx("option",{value:i,children:i||""},i))})]})}function _s({children:t}){return a.jsx("th",{className:"px-2 py-1 text-left text-[11px] font-semibold uppercase tracking-wide",children:t})}function Cs({children:t}){return a.jsx("td",{className:"px-2 py-1 align-top text-[11px] text-slate-700",children:t})}function eLe({caseId:t}){const n=et("ot.case.view")||et("ot.operation_notes.view"),s=et("ot.operation_notes.manage")||et("ot.case.update"),[r,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[m,x]=y.useState({diagnosis_pre:"",diagnosis_post:"",procedure_performed:"",findings:"",steps:"",complications:"",drains:"",blood_loss_ml:"",post_op_orders:""}),b=async()=>{var S;if(n)try{o(!0),h(null);const C=await d8e(t);if(C.data){const A=C.data;i(A),x({diagnosis_pre:A.preop_diagnosis||"",diagnosis_post:A.postop_diagnosis||"",procedure_performed:A.indication||"",findings:A.findings||"",steps:A.procedure_steps||"",complications:A.complications||"",drains:A.drains_details||"",blood_loss_ml:A.blood_loss_ml??"",post_op_orders:A.postop_instructions||""})}else i(null)}catch(C){((S=C==null?void 0:C.response)==null?void 0:S.status)===404?i(null):(console.error("Failed to load Operation note",C),h("Failed to load Operation note"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,n]),!n)return a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view Operation notes."});const w=(S,C)=>{x(A=>({...A,[S]:C}))},j=async S=>{var C,A;if(S.preventDefault(),!!s){d(!0),h(null);try{const k={surgeon_user_id:null,preop_diagnosis:m.diagnosis_pre||null,postop_diagnosis:m.diagnosis_post||null,indication:m.procedure_performed||null,findings:m.findings||null,procedure_steps:m.steps||null,blood_loss_ml:m.blood_loss_ml===""?null:Number(m.blood_loss_ml),complications:m.complications||null,drains_details:m.drains||null,postop_instructions:m.post_op_orders||null};r?await f8e(t,k):await u8e(t,k),await b()}catch(k){console.error("Failed to save Operation note",k);const T=((A=(C=k==null?void 0:k.response)==null?void 0:C.data)==null?void 0:A.detail)||(k==null?void 0:k.message)||"Failed to save Operation note";h(T)}finally{d(!1)}}};return a.jsxs("form",{onSubmit:j,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[a.jsx(Rc,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"Operation notes"})]}),r&&a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(r==null?void 0:r.updated_at)||(r==null?void 0:r.created_at)||""]})]}),l&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading Operation notes..."}),u&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Pre-op diagnosis"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.diagnosis_pre,disabled:!s,onChange:S=>w("diagnosis_pre",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Post-op diagnosis"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.diagnosis_post,disabled:!s,onChange:S=>w("diagnosis_post",S.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Procedure performed / indication"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.procedure_performed,disabled:!s,onChange:S=>w("procedure_performed",S.target.value)})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Findings"}),a.jsx("textarea",{rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.findings,disabled:!s,onChange:S=>w("findings",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Steps / technique"}),a.jsx("textarea",{rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.steps,disabled:!s,onChange:S=>w("steps",S.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Complications"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.complications,disabled:!s,onChange:S=>w("complications",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Drains / tubes"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.drains,disabled:!s,onChange:S=>w("drains",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Approx. blood loss (ml)"}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.blood_loss_ml,disabled:!s,onChange:S=>w("blood_loss_ml",S.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Immediate post-op orders"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.post_op_orders,disabled:!s,onChange:S=>w("post_op_orders",S.target.value)})]}),s&&a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save Operation note"]})})]})}function GR(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const n=new Date(t);return isNaN(n.getTime())?"":n.toISOString().slice(11,16)}function tLe({caseId:t}){const n=et("ot.cases.view")||et("ot.pacu.view"),s=et("ot.pacu.manage")||et("ot.case.update"),[r,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[m,x]=y.useState({arrival_time:"",departure_time:"",pain_score:"",nausea_vomiting:"",airway_status:"",vitals_summary:"",complications:"",discharge_criteria_met:!1,notes:""}),b=async()=>{var S;if(n)try{o(!0),h(null);const C=await x8e(t);if(C.data){const A=C.data;i(A),x({arrival_time:GR(A.arrival_time),departure_time:GR(A.departure_time),pain_score:A.pain_score||"",nausea_vomiting:A.nausea_vomiting||"",airway_status:A.airway_status||"",vitals_summary:A.vitals_summary||"",complications:A.complications||"",discharge_criteria_met:!!A.discharge_criteria_met,notes:A.notes||""})}else i(null)}catch(C){((S=C==null?void 0:C.response)==null?void 0:S.status)===404?i(null):(console.error("Failed to load PACU record",C),h("Failed to load PACU record"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,n]),!n)return a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view PACU records."});const w=(S,C)=>{x(A=>({...A,[S]:C}))},j=async S=>{var C,A;if(S.preventDefault(),!!s){d(!0),h(null);try{const k={arrival_time:m.arrival_time||null,departure_time:m.departure_time||null,pain_score:m.pain_score||null,nausea_vomiting:m.nausea_vomiting||null,airway_status:m.airway_status||null,vitals_summary:m.vitals_summary||null,complications:m.complications||null,discharge_criteria_met:!!m.discharge_criteria_met,notes:m.notes||null};r?await y8e(t,k):await g8e(t,k),await b()}catch(k){console.error("Failed to save PACU record",k);let T="Failed to save PACU record";const I=(A=(C=k==null?void 0:k.response)==null?void 0:C.data)==null?void 0:A.detail;Array.isArray(I)?T=I.map(D=>D.msg).join(", "):typeof I=="string"?T=I:k!=null&&k.message&&(T=k.message),h(T)}finally{d(!1)}}};return a.jsxs("form",{onSubmit:j,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[a.jsx(Ps,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"PACU / Post-anaesthesia recovery"})]}),r&&a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(r==null?void 0:r.updated_at)||(r==null?void 0:r.created_at)||""]})]}),l&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading PACU record..."}),u&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Arrival time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.arrival_time,disabled:!s,onChange:S=>w("arrival_time",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Departure time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.departure_time,disabled:!s,onChange:S=>w("departure_time",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Pain score"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",placeholder:"e.g., 3/10",value:m.pain_score,disabled:!s,onChange:S=>w("pain_score",S.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Nausea / vomiting"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.nausea_vomiting,disabled:!s,onChange:S=>w("nausea_vomiting",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Airway status"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.airway_status,disabled:!s,onChange:S=>w("airway_status",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Vitals summary"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.vitals_summary,disabled:!s,onChange:S=>w("vitals_summary",S.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"PACU complications"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.complications,disabled:!s,onChange:S=>w("complications",S.target.value)})]}),a.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-800 hover:border-sky-400",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.discharge_criteria_met,disabled:!s,onChange:S=>w("discharge_criteria_met",S.target.checked)}),a.jsx("span",{children:"PACU discharge criteria met; patient shifted as per orders"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs text-slate-800 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",value:m.notes,disabled:!s,onChange:S=>w("notes",S.target.value)})]}),s&&a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save PACU record"]})})]})}function nLe(t){if(!t)return"";if(/^\d{2}:\d{2}$/.test(t))return t;const n=new Date(t);return isNaN(n.getTime())?"":n.toISOString().slice(11,16)}function sLe({caseId:t}){const n=et("ot.case.view")||et("ot.nursing.view"),s=et("ot.nursing.manage")||et("ot.case.update"),[r,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[m,x]=y.useState({scrub_nurse_name:"",circulating_nurse_name:"",positioning:"",skin_prep:"",catheterisation:"",diathermy_plate_site:"",counts_initial_done:!1,counts_closure_done:!1,antibiotics_time:"",warming_measures:"",notes:""}),b=async()=>{var S;if(n)try{o(!0),h(null);const C=await a8e(t);if(C.data){const A=C.data;i(A),x({scrub_nurse_name:A.scrub_nurse_name||"",circulating_nurse_name:A.circulating_nurse_name||"",positioning:A.positioning||"",skin_prep:A.skin_prep||"",catheterisation:A.catheterisation||"",diathermy_plate_site:A.diathermy_plate_site||"",counts_initial_done:!!A.counts_initial_done,counts_closure_done:!!A.counts_closure_done,antibiotics_time:nLe(A.antibiotics_time),warming_measures:A.warming_measures||"",notes:A.notes||""})}else i(null)}catch(C){((S=C==null?void 0:C.response)==null?void 0:S.status)===404?i(null):(console.error("Failed to load intra-op nursing record",C),h("Failed to load intra-op nursing record"))}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,n]),!n)return a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view intra-op nursing records."});const w=(S,C)=>{x(A=>({...A,[S]:C}))},j=async S=>{var A,k,T,I,D;if(S.preventDefault(),!s)return;d(!0),h(null);const C={primary_nurse_id:null,scrub_nurse_name:m.scrub_nurse_name||null,circulating_nurse_name:m.circulating_nurse_name||null,positioning:m.positioning||null,skin_prep:m.skin_prep||null,catheterisation:m.catheterisation||null,diathermy_plate_site:m.diathermy_plate_site||null,counts_initial_done:!!m.counts_initial_done,counts_closure_done:!!m.counts_closure_done,antibiotics_time:m.antibiotics_time||null,warming_measures:m.warming_measures||null,notes:m.notes||null};try{if(r)await zR(t,C);else try{await i8e(t,C)}catch(O){const R=(A=O==null?void 0:O.response)==null?void 0:A.status,P=(T=(k=O==null?void 0:O.response)==null?void 0:k.data)==null?void 0:T.detail;if(R===400&&typeof P=="string"&&P.toLowerCase().includes("already exists"))await zR(t,C);else throw O}await b()}catch(O){console.error("Failed to save intra-op nursing record",O);const R=((D=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:D.detail)||(O==null?void 0:O.message)||"Failed to save intra-op nursing record";h(R)}finally{d(!1)}};return a.jsxs("form",{onSubmit:j,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[a.jsx(_r,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"Intra-op nursing record"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[r&&a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(r==null?void 0:r.updated_at)||(r==null?void 0:r.created_at)||""]}),(r==null?void 0:r.primary_nurse)&&a.jsxs("span",{className:"rounded-full bg-sky-50 px-2 py-0.5 text-[11px] text-sky-700",children:["Primary nurse: ",r.primary_nurse.first_name," ",r.primary_nurse.last_name]})]})]}),l&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading intra-op nursing record..."}),u&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Scrub nurse"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.scrub_nurse_name,disabled:!s,onChange:S=>w("scrub_nurse_name",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Circulating nurse"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.circulating_nurse_name,disabled:!s,onChange:S=>w("circulating_nurse_name",S.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Patient positioning"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.positioning,disabled:!s,onChange:S=>w("positioning",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Skin preparation"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.skin_prep,disabled:!s,onChange:S=>w("skin_prep",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Catheterisation"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.catheterisation,disabled:!s,onChange:S=>w("catheterisation",S.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Diathermy plate site"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.diathermy_plate_site,disabled:!s,onChange:S=>w("diathermy_plate_site",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Prophylactic antibiotics time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.antibiotics_time,disabled:!s,onChange:S=>w("antibiotics_time",S.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Warming measures"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.warming_measures,disabled:!s,onChange:S=>w("warming_measures",S.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[a.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.counts_initial_done,disabled:!s,onChange:S=>w("counts_initial_done",S.target.checked)}),a.jsx("span",{children:"Initial sponge / instrument counts completed"})]}),a.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.counts_closure_done,disabled:!s,onChange:S=>w("counts_closure_done",S.target.checked)}),a.jsx("span",{children:"Final counts completed at closure"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.notes,disabled:!s,onChange:S=>w("notes",S.target.value)})]}),s&&a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save intra-op nursing record"]})})]})}function rLe({caseId:t}){const n=et("ot.case.view")||et("ot.counts.view"),s=et("ot.counts.manage")||et("ot.case.update"),[r,i]=y.useState(null),[l,o]=y.useState(!1),[c,d]=y.useState(!1),[u,h]=y.useState(null),[m,x]=y.useState({sponges_initial:"",sponges_added:"",sponges_final:"",instruments_initial:"",instruments_final:"",needles_initial:"",needles_final:"",discrepancy_text:"",xray_done:!1,resolved_by:"",notes:""}),b=k=>k===""||k===null||k===void 0?null:Number(k),w=async()=>{var k;if(n)try{o(!0),h(null);const I=(await l8e(t)).data;console.log("Counts record API data:",I),i(I),x({sponges_initial:I.sponges_initial??"",sponges_added:I.sponges_added??"",sponges_final:I.sponges_final??"",instruments_initial:I.instruments_initial??"",instruments_final:I.instruments_final??"",needles_initial:I.needles_initial??"",needles_final:I.needles_final??"",discrepancy_text:I.discrepancy_text||"",xray_done:!!I.xray_done,resolved_by:I.resolved_by||"",notes:I.notes||""})}catch(T){((k=T==null?void 0:T.response)==null?void 0:k.status)===404?(i(null),x(I=>({...I,sponges_initial:"",sponges_added:"",sponges_final:"",instruments_initial:"",instruments_final:"",needles_initial:"",needles_final:"",discrepancy_text:"",xray_done:!1,resolved_by:"",notes:""}))):(console.error("Failed to load counts record",T),h("Failed to load counts record"))}finally{o(!1)}};y.useEffect(()=>{i(null),w()},[t,n]);const j=(k,T)=>{x(I=>({...I,[k]:T}))},S=()=>({sponges_initial:b(m.sponges_initial),sponges_added:b(m.sponges_added),sponges_final:b(m.sponges_final),instruments_initial:b(m.instruments_initial),instruments_final:b(m.instruments_final),needles_initial:b(m.needles_initial),needles_final:b(m.needles_final),discrepancy_text:m.discrepancy_text||null,xray_done:!!m.xray_done,resolved_by:m.resolved_by||null,notes:m.notes||null}),C=async k=>{var I,D;if(k.preventDefault(),!s)return;d(!0),h(null);const T=S();try{if(r!=null&&r.id)await c8e(t,T);else{const O=await o8e(t,T);i(O.data)}await w()}catch(O){console.error("Failed to save counts record",O);const R=((D=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:D.detail)||(O==null?void 0:O.message)||"Failed to save counts record";h(R)}finally{d(!1)}},A=(k,T)=>a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:T}),a.jsx("input",{type:"number",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m[k],disabled:!s,onChange:I=>j(k,I.target.value)})]},k);return a.jsxs("form",{onSubmit:C,className:"space-y-3 rounded-2xl border bg-white px-4 py-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sky-800",children:[a.jsx(No,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"Sponge / instrument / needle count"})]}),r&&a.jsxs("span",{className:"rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] text-emerald-700",children:["Last updated: ",(r==null?void 0:r.updated_at)||(r==null?void 0:r.created_at)||""]})]}),l&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading counts record..."}),u&&a.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[A("sponges_initial","Sponges - initial"),A("sponges_added","Sponges - added during case"),A("sponges_final","Sponges - final count")]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[A("instruments_initial","Instruments - initial"),A("instruments_final","Instruments - final")]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[A("needles_initial","Needles - initial"),A("needles_final","Needles - final")]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Discrepancy (if any)"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.discrepancy_text,disabled:!s,onChange:k=>j("discrepancy_text",k.target.value)})]}),a.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs",children:[a.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500",checked:!!m.xray_done,disabled:!s,onChange:k=>j("xray_done",k.target.checked)}),a.jsx("span",{children:"Intra-op / post-op X-ray done for suspected retained item"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Discrepancy resolved by"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.resolved_by,disabled:!s,onChange:k=>j("resolved_by",k.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes / corrective action"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.notes,disabled:!s,onChange:k=>j("notes",k.target.value)})]})]}),s&&a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[c&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Save counts record"]})})]})}function aLe({caseId:t}){const n=et("ot.case.view")||et("ot.blood_transfusion.view"),s=et("ot.blood_transfusion.manage")||et("ot.case.update"),[r,i]=y.useState([]),[l,o]=y.useState(!1),[c,d]=y.useState(null),[u,h]=y.useState(!1),[m,x]=y.useState({component:"",units:"1",blood_group:"",bag_no:"",start_time:"",end_time:"",reaction:"",reaction_action:"",notes:""}),b=async()=>{if(n)try{o(!0),d(null);const C=await h8e(t);console.log("Blood transfusion API data:",C.data),i(C.data||[])}catch(C){console.error("Failed to load blood transfusions",C),d("Failed to load blood transfusion records")}finally{o(!1)}};if(y.useEffect(()=>{b()},[t,n]),!n)return a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-xs text-amber-800",children:"You do not have permission to view OT blood transfusions."});const w=(C,A)=>{x(k=>({...k,[C]:A}))},j=async C=>{var A,k;if(C.preventDefault(),!!s){h(!0);try{const T={component:m.component||null,units:m.units===""?null:Number(m.units||1),start_time:null,end_time:null,reaction:m.reaction||null,notes:m.notes||null};await m8e(t,T),x({component:"",units:"1",blood_group:"",bag_no:"",start_time:"",end_time:"",reaction:"",reaction_action:"",notes:""}),await b()}catch(T){console.error("Failed to add transfusion",T),alert(((k=(A=T==null?void 0:T.response)==null?void 0:A.data)==null?void 0:k.detail)||"Failed to add transfusion entry")}finally{h(!1)}}},S=async C=>{if(s&&window.confirm("Delete this transfusion record?"))try{await p8e(C),await b()}catch(A){console.error("Failed to delete transfusion",A),alert("Failed to delete transfusion entry")}};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"rounded-2xl border bg-white px-4 py-3 text-xs",children:[a.jsx("div",{className:"mb-2 flex items-center justify-between gap-2",children:a.jsxs("div",{className:"flex items-center gap-2 text-slate-800",children:[a.jsx(Bte,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"OT blood transfusion record"})]})}),l&&a.jsx("div",{className:"text-xs text-slate-500",children:"Loading transfusion records..."}),c&&a.jsx("div",{className:"mb-2 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:c}),a.jsx("div",{className:"max-h-64 overflow-auto rounded-xl border bg-slate-50",children:a.jsxs("table",{className:"min-w-full text-left text-[11px] text-slate-700",children:[a.jsx("thead",{className:"bg-slate-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-1.5",children:"Component"}),a.jsx("th",{className:"px-3 py-1.5",children:"Units"}),a.jsx("th",{className:"px-3 py-1.5",children:"Start"}),a.jsx("th",{className:"px-3 py-1.5",children:"End"}),a.jsx("th",{className:"px-3 py-1.5",children:"Reaction"}),a.jsx("th",{className:"px-3 py-1.5 text-right",children:"Actions"})]})}),a.jsxs("tbody",{children:[!l&&r.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-2 text-center text-[11px] text-slate-500",children:"No transfusions recorded for this case."})}),!l&&r.map(C=>a.jsxs("tr",{className:"border-t border-slate-100",children:[a.jsx("td",{className:"px-3 py-1.5",children:C.component||""}),a.jsx("td",{className:"px-3 py-1.5",children:C.units??""}),a.jsx("td",{className:"px-3 py-1.5",children:C.start_time||""}),a.jsx("td",{className:"px-3 py-1.5",children:C.end_time||""}),a.jsx("td",{className:"px-3 py-1.5",children:C.reaction||"None"}),a.jsx("td",{className:"px-3 py-1.5 text-right",children:s&&a.jsxs("button",{type:"button",onClick:()=>S(C.id),className:"inline-flex items-center gap-1 rounded-lg border border-rose-200 bg-white px-2 py-0.5 text-[10px] text-rose-600 hover:bg-rose-50",children:[a.jsx(Trash2,{className:"h-3 w-3"}),"Delete"]})})]},C.id))]})]})})]}),s&&a.jsxs("form",{onSubmit:j,className:"space-y-2 rounded-2xl border bg-white px-4 py-3 text-xs",children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Add transfusion entry"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Component"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.component,onChange:C=>w("component",C.target.value),placeholder:"PRBC / FFP / Platelets...",required:!0})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Units"}),a.jsx("input",{type:"number",min:"1",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.units,onChange:C=>w("units",C.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Blood group"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.blood_group,onChange:C=>w("blood_group",C.target.value),placeholder:"e.g., O+"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Bag number"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.bag_no,onChange:C=>w("bag_no",C.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Start time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.start_time,onChange:C=>w("start_time",C.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"End time"}),a.jsx("input",{type:"time",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.end_time,onChange:C=>w("end_time",C.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Reaction"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.reaction,onChange:C=>w("reaction",C.target.value),placeholder:"None / chills / rash / etc."})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Action taken"}),a.jsx("input",{type:"text",className:"w-full rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.reaction_action,onChange:C=>w("reaction_action",C.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-slate-700",children:"Notes"}),a.jsx("textarea",{rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-2.5 py-1.5 text-xs",value:m.notes,onChange:C=>w("notes",C.target.value)})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-1.5 rounded-xl border border-sky-600 bg-sky-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-sky-700 disabled:opacity-60",children:[u&&a.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-[2px] border-white border-b-transparent"}),"Add transfusion"]})})]})]})}const iLe=[{id:"preop",label:"Pre-op Checklist"},{id:"safety",label:"WHO Safety Checklist"},{id:"anaesthesia",label:"Anaesthesia"},{id:"nursing",label:"Nursing Notes"},{id:"counts",label:"Instrument & Sponge Counts"},{id:"blood",label:"Blood & Fluids"},{id:"notes",label:"Operation Notes"},{id:"pacu",label:"PACU / Recovery"},{id:"logs",label:"Audit Log"}];function hw(t){if(!t)return null;const n=new Date(t);return Number.isNaN(n.getTime())?null:n}function n1(t){const n=hw(t);return n?n.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):""}function cC(t){if(!t)return"";if(typeof t=="string"){const s=t.match(/^(\d{2}):(\d{2})/);if(s)return`${s[1]}:${s[2]}`}const n=hw(t);return n?n.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):""}function KR(t){return hw(t)?`${n1(t)}  ${cC(t)}`:""}function lLe(...t){return t.filter(Boolean).join("  ")}function oLe(t){if(!t)return"";const n=t.prefix||t.title,s=t.first_name||t.given_name,r=t.last_name||t.family_name;return[n,s,r].filter(Boolean).join(" ")||t.full_name||t.display_name||""}function cLe(t){if(!t)return null;const n=t.sex||t.gender||t.sex_label||null;let s=t.age_display||t.age||null;if(!s&&(t.age_years!=null||t.age_months!=null)){const r=t.age_years,i=t.age_months;r!=null&&i!=null?s=`${r}y ${i}m`:r!=null?s=`${r}y`:i!=null&&(s=`${i}m`)}if(!s&&t.dob){const r=hw(t.dob);if(r){const i=new Date;let l=i.getFullYear()-r.getFullYear();const o=i.getMonth()-r.getMonth();(o<0||o===0&&i.getDate()<r.getDate())&&l--,s=`${l}y`}}return s&&n?`${s} / ${n}`:s||n||null}function dLe(){var G,J,ee,ye,ie;const{caseId:t}=Tu(),n=Aa(),s=et("ot.cases.view"),[r,i]=y.useState("preop"),[l,o]=y.useState(null),[c,d]=y.useState(!1),[u,h]=y.useState(null),m=async()=>{var he;if(!(!s||!t))try{d(!0),h(null);const be=await V6e(t);o(be.data||null)}catch(be){console.error("Failed to load OT case",be);const we=(he=be==null?void 0:be.response)==null?void 0:he.status;h(we===404?"OT case not found. It may have been deleted or the reference is invalid.":we===403?"You do not have permission to view this OT case.":"Failed to load OT case. Please try again.")}finally{d(!1)}};y.useEffect(()=>{m()},[t,s]);const x=l==null?void 0:l.schedule,b=x==null?void 0:x.patient,w=(x==null?void 0:x.admission)||null,j=(x==null?void 0:x.bed)||null,S=(w==null?void 0:w.current_bed)||null,C=j||S,A=oLe(b),k=cLe(b),T=(x==null?void 0:x.reg_no)||(x==null?void 0:x.display_number)||(x==null?void 0:x.ot_number)||(x==null?void 0:x.schedule_code)||null,I=(b==null?void 0:b.uhid)||(b==null?void 0:b.uhid_number)||(x==null?void 0:x.patient_uhid)||null,D=(w==null?void 0:w.display_code)||(w==null?void 0:w.admission_code)||null,O=(x==null?void 0:x.op_no)||null,R=(w==null?void 0:w.admitted_at)||(w==null?void 0:w.admission_date)||null,P=C?lLe(C.ward_name,C.room_name,C.code):null,L=(l==null?void 0:l.final_procedure_name)||(x==null?void 0:x.procedure_name)||(x==null?void 0:x.primary_procedure_name)||"",$=(G=x==null?void 0:x.additional_procedures)!=null&&G.length?x.additional_procedures.map(he=>he.name||he.procedure_name).filter(Boolean).join(", "):null,B=(x==null?void 0:x.planned_start_time)||(x==null?void 0:x.planned_start)||null,V=(x==null?void 0:x.planned_end_time)||(x==null?void 0:x.planned_end)||null,K=l==null?void 0:l.actual_start_time,z=l==null?void 0:l.actual_end_time,H=(x==null?void 0:x.date)||B||V||null,Y=y.useMemo(()=>{if(!l)return null;const he=(x==null?void 0:x.status)||(l.outcome?"closed":"open"),be=String(he).toLowerCase(),we={planned:"bg-slate-100 text-slate-700",in_progress:"bg-sky-50 text-sky-700",completed:"bg-emerald-50 text-emerald-700",cancelled:"bg-rose-50 text-rose-700",open:"bg-emerald-50 text-emerald-700",closed:"bg-slate-100 text-slate-700"};return a.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-[11px] font-medium ${we[be]||"bg-slate-100 text-slate-700"}`,children:[a.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-current opacity-70"}),String(he).toUpperCase()]})},[l,x]);return s?a.jsxs("div",{className:"flex h-full flex-col gap-3 p-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"button",onClick:()=>n(-1),className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm hover:border-sky-400 hover:text-sky-700",children:a.jsx(Cb,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"mb-0.5 flex flex-wrap items-center gap-2",children:[a.jsx("h1",{className:"text-base font-semibold text-slate-900",children:"OT Case"}),Y,T&&a.jsxs("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] font-medium text-slate-700",children:[a.jsx(l4,{className:"mr-1 h-3 w-3"}),"OT Reg No: ",T]})]}),a.jsx("p",{className:"text-xs text-slate-500",children:"All OT documentation, checklists and notes for this procedure are linked to this case as per NABH OT standards."})]})]}),a.jsx("div",{className:"flex flex-col items-end gap-1 text-right",children:H&&a.jsxs("div",{className:"inline-flex items-center gap-1.5 rounded-full bg-slate-900 px-3 py-1 text-[11px] font-medium text-slate-50",children:[a.jsx(Gs,{className:"h-3.5 w-3.5"}),"OT Date: ",n1(H)]})})]}),u&&a.jsx("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-2 text-xs text-rose-700",children:u}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4",children:[a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-sky-50 text-sky-700",children:a.jsx(ps,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Patient"}),a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:A})]})]}),a.jsxs("dl",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(l4,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"UHID"})]}),a.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:I||""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(jp,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Age / Sex"})]}),a.jsx("dd",{className:"text-[11px] text-slate-900",children:k||""})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-emerald-50 text-emerald-700",children:a.jsx(Ps,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Admission / Visit"}),a.jsx("div",{className:"text-[11px] text-slate-500",children:"IP or OP details (if available)"})]})]}),a.jsxs("dl",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(_r,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"IP No"})]}),a.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:D||""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(_r,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"OP No"})]}),a.jsx("dd",{className:"text-[11px] font-medium text-slate-900",children:O||""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(Gs,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Date of Admission"})]}),a.jsx("dd",{className:"text-[11px] text-slate-900",children:R?n1(R):""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(Ps,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Bed Details"})]}),a.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:P||""})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-indigo-50 text-indigo-700",children:a.jsx(un,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Procedure & Team"}),a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:L})]})]}),$&&a.jsxs("div",{className:"mb-1 text-[11px] text-slate-500",children:["Additional: ",$]}),a.jsxs("dl",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(un,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Surgeon"})]}),a.jsxs("dd",{className:"text-[11px] text-right text-slate-900",children:["Dr. ",((J=x==null?void 0:x.surgeon)==null?void 0:J.full_name)||((ee=x==null?void 0:x.surgeon)==null?void 0:ee.name)||(x==null?void 0:x.surgeon_name)||(x!=null&&x.surgeon_user_id?`Doctor #${x.surgeon_user_id}`:"")]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(jp,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Anaesthetist"})]}),a.jsxs("dd",{className:"text-[11px] text-right text-slate-900",children:["Dr. ",((ye=x==null?void 0:x.anaesthetist)==null?void 0:ye.full_name)||((ie=x==null?void 0:x.anaesthetist)==null?void 0:ie.name)||(x==null?void 0:x.anaesthetist_name)||(x!=null&&x.anaesthetist_user_id?`Doctor #${x.anaesthetist_user_id}`:"")]})]})]})]}),a.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 text-xs shadow-sm",children:[a.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx("div",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-amber-50 text-amber-700",children:a.jsx(Ys,{className:"h-4 w-4"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:"Theatre & Timings"}),a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:P||""})]})]}),a.jsxs("dl",{className:"space-y-1.5",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(Ys,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Planned"})]}),a.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:B||V?a.jsxs(a.Fragment,{children:[H&&a.jsx("span",{className:"block",children:n1(H)}),a.jsxs("span",{children:[B?cC(B):""," ",""," ",V?cC(V):""]})]}):""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(Ys,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Actual Start"})]}),a.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:K?KR(K):""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("dt",{className:"flex items-center gap-1.5 text-slate-500",children:[a.jsx(Ys,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Actual End"})]}),a.jsx("dd",{className:"text-[11px] text-right text-slate-900",children:z?KR(z):""})]})]})]})]}),a.jsx("div",{className:"mt-1 flex gap-2 border-b border-slate-200 pt-1",children:iLe.map(he=>{const be=he.id===r;return a.jsxs("button",{type:"button",onClick:()=>i(he.id),className:`relative px-3 py-1.5 text-xs font-medium transition-colors ${be?"text-sky-700":"text-slate-500 hover:text-slate-800"}`,children:[he.label,be&&a.jsx("span",{className:"absolute inset-x-0 bottom-0 h-0.5 rounded-full bg-sky-600"})]},he.id)})}),a.jsxs("div",{className:"flex-1 overflow-auto pt-2 pb-4",children:[c&&!l&&a.jsx("div",{className:"rounded-2xl border bg-white px-4 py-4 text-xs text-slate-500",children:"Loading OT case..."}),!c&&!l&&!u&&a.jsx("div",{className:"rounded-2xl border bg-white px-4 py-4 text-xs text-slate-500",children:"OT case not loaded."}),l&&a.jsxs("div",{className:"space-y-3",children:[r==="preop"&&a.jsx(Y8e,{caseId:t}),r==="safety"&&a.jsx(Z8e,{caseId:t}),r==="anaesthesia"&&a.jsx(J8e,{caseId:t}),r==="nursing"&&a.jsx(sLe,{caseId:t}),r==="counts"&&a.jsx(rLe,{caseId:t}),r==="blood"&&a.jsx(aLe,{caseId:t}),r==="notes"&&a.jsx(eLe,{caseId:t}),r==="pacu"&&a.jsx(tLe,{caseId:t}),r==="logs"&&a.jsx(dK,{caseId:t})]})]})]}):a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800",children:"You do not have permission to view OT cases."})})}function uLe(){return y.useEffect(()=>{const n=async()=>{if(localStorage.getItem("access_token"))try{await qL()}catch(i){console.error("Auto token refresh failed",i)}};n();const s=setInterval(n,174e4);return()=>clearInterval(s)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(tZ,{children:[a.jsx(dt,{path:"/auth/login",element:a.jsx(pse,{})}),a.jsx(dt,{path:"/auth/register-admin",element:a.jsx(xse,{})}),a.jsx(dt,{path:"/auth/verify",element:a.jsx(gse,{})}),a.jsx(dt,{element:a.jsx(uce,{}),children:a.jsxs(dt,{element:a.jsx(tce,{children:a.jsx(dce,{})}),children:[a.jsx(dt,{path:"/admin",element:a.jsx(BD,{})}),a.jsx(dt,{path:"/dashboard",element:a.jsx(BD,{})}),a.jsx(dt,{path:"/admin/roles",element:a.jsx(Voe,{})}),a.jsx(dt,{path:"/admin/permissions",element:a.jsx(Hoe,{})}),a.jsx(dt,{path:"/admin/users",element:a.jsx(Woe,{})}),a.jsx(dt,{path:"/admin/departments",element:a.jsx(zoe,{})}),a.jsx(dt,{path:"/patients",element:a.jsx(dOe,{})}),a.jsx(dt,{path:"/patients/masters",element:a.jsx(fOe,{})}),a.jsx(dt,{path:"/opd/dashboard",element:a.jsx(aDe,{})}),a.jsx(dt,{path:"/opd/schedules",element:a.jsx(COe,{})}),a.jsx(dt,{path:"/opd/appointments",element:a.jsx(HOe,{})}),a.jsx(dt,{path:"/opd/queue",element:a.jsx(XOe,{})}),a.jsx(dt,{path:"/opd/triage",element:a.jsx(ZOe,{})}),a.jsx(dt,{path:"/opd/visit/:id",element:a.jsx(JOe,{})}),a.jsx(dt,{path:"/opd/followups",element:a.jsx(nDe,{})}),a.jsx(dt,{path:"/opd/no-shows",element:a.jsx(rDe,{})}),a.jsx(dt,{path:"/opd/doctor-fees",element:a.jsx(y6e,{})}),a.jsx(dt,{path:"/ipd/admissions",element:a.jsx(nde,{})}),a.jsx(dt,{path:"/ipd/admission/:id",element:a.jsx(ade,{})}),a.jsx(dt,{path:"/ipd/tracking",element:a.jsx(ide,{})}),a.jsx(dt,{path:"/ipd/my",element:a.jsx(lde,{})}),a.jsx(dt,{path:"/ipd/discharged",element:a.jsx(ode,{})}),a.jsx(dt,{path:"/ipd/bedboard",element:a.jsx(cde,{})}),a.jsx(dt,{path:"/ipd/masters",element:a.jsx(Sce,{})}),a.jsx(dt,{path:"/lab/orders",element:a.jsx(P6e,{})}),a.jsx(dt,{path:"/lab/orders/:id",element:a.jsx(jde,{})}),a.jsx(dt,{path:"/lab/masters",element:a.jsx(Sde,{})}),a.jsx(dt,{path:"/lab/service/masters",element:a.jsx(E6e,{})}),a.jsx(dt,{path:"/lab/orders/:id/print",element:a.jsx(T6e,{})}),a.jsx(dt,{path:"/ris/orders",element:a.jsx($de,{})}),a.jsx(dt,{path:"/ris/orders/:id",element:a.jsx(Vde,{})}),a.jsx(dt,{path:"/ris/masters",element:a.jsx(Ude,{})}),a.jsx(dt,{path:"/ot/schedule",element:a.jsx(B8e,{})}),a.jsx(dt,{path:"/ot/masters",element:a.jsx(V8e,{})}),a.jsx(dt,{path:"/ot/cases/:caseId",element:a.jsx(dLe,{})}),a.jsx(dt,{path:"/ot/logs",element:a.jsx(dK,{})}),a.jsx(dt,{path:"/billing",element:a.jsx(NOe,{})}),a.jsx(dt,{path:"/billing/invoices/:invoiceId",element:a.jsx(rue,{})}),a.jsx(dt,{path:"/emr",element:a.jsx(pue,{})}),a.jsx(dt,{path:"/templates",element:a.jsx(_ue,{})}),a.jsx(dt,{path:"/templates/new",element:a.jsx(GP,{mode:"create"})}),a.jsx(dt,{path:"/templates/:id/edit",element:a.jsx(GP,{mode:"edit"})}),a.jsx(dt,{path:"/templates/generate",element:a.jsx(m1e,{})}),a.jsx(dt,{path:"/templates/consents",element:a.jsx(p1e,{})}),a.jsx(dt,{path:"/settings/branding",element:a.jsx(_Oe,{})}),a.jsx(dt,{path:"/mis",element:a.jsx(RMe,{})}),a.jsx(dt,{path:"/pharmacy/inventory",element:a.jsx(KDe,{})}),a.jsx(dt,{path:"/pharmacy/qr-lookup",element:a.jsx(MRe,{})}),a.jsx(dt,{path:"/inventory/barcode-lookup",element:a.jsx(DRe,{})}),a.jsx(dt,{path:"/pharmacy/rx",element:a.jsx(zRe,{})}),a.jsx(dt,{path:"/pharmacy/dispense",element:a.jsx(c6e,{})}),a.jsx(dt,{path:"/pharmacy/billing",element:a.jsx(XRe,{})}),a.jsx(dt,{path:"/pharmacy/sales",element:a.jsx(r6e,{})}),a.jsx(dt,{path:"/pharmacy/returns",element:a.jsx(i6e,{})}),a.jsx(dt,{path:"/pharmacy/rx-explorer",element:a.jsx(f6e,{})}),a.jsx(dt,{path:"/opd/phramacy",element:a.jsx(g6e,{})}),a.jsx(dt,{path:"/ipd/phramacy",element:a.jsx(m6e,{})}),a.jsx(dt,{path:"/counter/phramacy",element:a.jsx(p6e,{})}),a.jsx(dt,{path:"/ot/phramacy",element:a.jsx(x6e,{})})]})}),a.jsx(dt,{path:"*",element:a.jsx(bL,{to:"/auth/login",replace:!0})})]}),a.jsx(pee,{position:"top-right",richColors:!0,closeButton:!0})]})}const fLe=y.createContext(null);function hLe({children:t,duration:n=3500}){const[s,r]=y.useState([]),i=y.useCallback(c=>{r(d=>d.filter(u=>u.id!==c))},[]),l=y.useCallback((c,d,u={})=>{const h=crypto.randomUUID(),m=u.duration??n;return r(x=>[...x,{id:h,type:c,message:d,duration:m}]),h},[n]),o=y.useMemo(()=>({success:(c,d)=>l("success",c,d),error:(c,d)=>l("error",c,d),warn:(c,d)=>l("warn",c,d),info:(c,d)=>l("info",c,d)}),[l]);return a.jsxs(fLe.Provider,{value:o,children:[t,a.jsx("div",{className:"fixed right-4 top-4 z-[9999] flex w-[min(92vw,380px)] flex-col gap-2",children:s.map(c=>a.jsx(mLe,{toast:c,onClose:()=>i(c.id)},c.id))})]})}function mLe({toast:t,onClose:n}){y.useEffect(()=>{const i=setTimeout(n,t.duration);return()=>clearTimeout(i)},[t.duration,n]);const s={success:"border-emerald-200 bg-emerald-50 text-emerald-800",error:"border-rose-200 bg-rose-50 text-rose-800",warn:"border-amber-200 bg-amber-50 text-amber-800",info:"border-blue-200 bg-blue-50 text-blue-800"}[t.type]??"border-gray-200 bg-white text-gray-800",r={success:zr,error:Ab,warn:No,info:Sp}[t.type]??Sp;return a.jsxs("div",{className:`flex items-start gap-3 rounded-xl border p-3 shadow-sm ${s}`,role:"status","aria-live":"polite",children:[a.jsx(r,{className:"mt-0.5 h-5 w-5"}),a.jsx("div",{className:"flex-1 text-sm",children:t.message}),a.jsx("button",{onClick:n,className:"opacity-70 hover:opacity-100","aria-label":"Close",children:a.jsx(Os,{className:"h-4 w-4"})})]})}ej.createRoot(document.getElementById("root")).render(a.jsx(Ge.StrictMode,{children:a.jsx(hLe,{children:a.jsx(cZ,{children:a.jsx(uLe,{})})})}));
